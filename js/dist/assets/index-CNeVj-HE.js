function ch(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function uh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Gd={exports:{}},go={},Kd={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vs=Symbol.for("react.element"),dh=Symbol.for("react.portal"),fh=Symbol.for("react.fragment"),ph=Symbol.for("react.strict_mode"),mh=Symbol.for("react.profiler"),hh=Symbol.for("react.provider"),gh=Symbol.for("react.context"),yh=Symbol.for("react.forward_ref"),vh=Symbol.for("react.suspense"),xh=Symbol.for("react.memo"),wh=Symbol.for("react.lazy"),Kc=Symbol.iterator;function jh(e){return e===null||typeof e!="object"?null:(e=Kc&&e[Kc]||e["@@iterator"],typeof e=="function"?e:null)}var Qd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yd=Object.assign,qd={};function Hr(e,t,n){this.props=e,this.context=t,this.refs=qd,this.updater=n||Qd}Hr.prototype.isReactComponent={};Hr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Hr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Xd(){}Xd.prototype=Hr.prototype;function _a(e,t,n){this.props=e,this.context=t,this.refs=qd,this.updater=n||Qd}var Ra=_a.prototype=new Xd;Ra.constructor=_a;Yd(Ra,Hr.prototype);Ra.isPureReactComponent=!0;var Qc=Array.isArray,Jd=Object.prototype.hasOwnProperty,Ia={current:null},Zd={key:!0,ref:!0,__self:!0,__source:!0};function ef(e,t,n){var r,s={},o=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)Jd.call(t,r)&&!Zd.hasOwnProperty(r)&&(s[r]=t[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var u=Array(a),d=0;d<a;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Vs,type:e,key:o,ref:i,props:s,_owner:Ia.current}}function Sh(e,t){return{$$typeof:Vs,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function za(e){return typeof e=="object"&&e!==null&&e.$$typeof===Vs}function Nh(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Yc=/\/+/g;function Bo(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Nh(""+e.key):t.toString(36)}function Sl(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Vs:case dh:i=!0}}if(i)return i=e,s=s(i),e=r===""?"."+Bo(i,0):r,Qc(s)?(n="",e!=null&&(n=e.replace(Yc,"$&/")+"/"),Sl(s,t,n,"",function(d){return d})):s!=null&&(za(s)&&(s=Sh(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Yc,"$&/")+"/")+e)),t.push(s)),1;if(i=0,r=r===""?".":r+":",Qc(e))for(var a=0;a<e.length;a++){o=e[a];var u=r+Bo(o,a);i+=Sl(o,t,n,u,s)}else if(u=jh(e),typeof u=="function")for(e=u.call(e),a=0;!(o=e.next()).done;)o=o.value,u=r+Bo(o,a++),i+=Sl(o,t,n,u,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function nl(e,t,n){if(e==null)return e;var r=[],s=0;return Sl(e,r,"","",function(o){return t.call(n,o,s++)}),r}function kh(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ht={current:null},Nl={transition:null},Ch={ReactCurrentDispatcher:ht,ReactCurrentBatchConfig:Nl,ReactCurrentOwner:Ia};function tf(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:nl,forEach:function(e,t,n){nl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return nl(e,function(){t++}),t},toArray:function(e){return nl(e,function(t){return t})||[]},only:function(e){if(!za(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};be.Component=Hr;be.Fragment=fh;be.Profiler=mh;be.PureComponent=_a;be.StrictMode=ph;be.Suspense=vh;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ch;be.act=tf;be.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Yd({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Ia.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in t)Jd.call(t,u)&&!Zd.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&a!==void 0?a[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var d=0;d<u;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Vs,type:e.type,key:s,ref:o,props:r,_owner:i}};be.createContext=function(e){return e={$$typeof:gh,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:hh,_context:e},e.Consumer=e};be.createElement=ef;be.createFactory=function(e){var t=ef.bind(null,e);return t.type=e,t};be.createRef=function(){return{current:null}};be.forwardRef=function(e){return{$$typeof:yh,render:e}};be.isValidElement=za;be.lazy=function(e){return{$$typeof:wh,_payload:{_status:-1,_result:e},_init:kh}};be.memo=function(e,t){return{$$typeof:xh,type:e,compare:t===void 0?null:t}};be.startTransition=function(e){var t=Nl.transition;Nl.transition={};try{e()}finally{Nl.transition=t}};be.unstable_act=tf;be.useCallback=function(e,t){return ht.current.useCallback(e,t)};be.useContext=function(e){return ht.current.useContext(e)};be.useDebugValue=function(){};be.useDeferredValue=function(e){return ht.current.useDeferredValue(e)};be.useEffect=function(e,t){return ht.current.useEffect(e,t)};be.useId=function(){return ht.current.useId()};be.useImperativeHandle=function(e,t,n){return ht.current.useImperativeHandle(e,t,n)};be.useInsertionEffect=function(e,t){return ht.current.useInsertionEffect(e,t)};be.useLayoutEffect=function(e,t){return ht.current.useLayoutEffect(e,t)};be.useMemo=function(e,t){return ht.current.useMemo(e,t)};be.useReducer=function(e,t,n){return ht.current.useReducer(e,t,n)};be.useRef=function(e){return ht.current.useRef(e)};be.useState=function(e){return ht.current.useState(e)};be.useSyncExternalStore=function(e,t,n){return ht.current.useSyncExternalStore(e,t,n)};be.useTransition=function(){return ht.current.useTransition()};be.version="18.3.1";Kd.exports=be;var c=Kd.exports;const zt=uh(c),bh=ch({__proto__:null,default:zt},[c]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eh=c,Lh=Symbol.for("react.element"),Ph=Symbol.for("react.fragment"),_h=Object.prototype.hasOwnProperty,Rh=Eh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ih={key:!0,ref:!0,__self:!0,__source:!0};function nf(e,t,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)_h.call(t,r)&&!Ih.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Lh,type:e,key:o,ref:i,props:s,_owner:Rh.current}}go.Fragment=Ph;go.jsx=nf;go.jsxs=nf;Gd.exports=go;var l=Gd.exports,Si={},rf={exports:{}},_t={},sf={exports:{}},lf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,N){var _=R.length;R.push(N);e:for(;0<_;){var P=_-1>>>1,V=R[P];if(0<s(V,N))R[P]=N,R[_]=V,_=P;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var N=R[0],_=R.pop();if(_!==N){R[0]=_;e:for(var P=0,V=R.length,G=V>>>1;P<G;){var Z=2*(P+1)-1,ee=R[Z],X=Z+1,se=R[X];if(0>s(ee,_))X<V&&0>s(se,ee)?(R[P]=se,R[X]=_,P=X):(R[P]=ee,R[Z]=_,P=Z);else if(X<V&&0>s(se,_))R[P]=se,R[X]=_,P=X;else break e}}return N}function s(R,N){var _=R.sortIndex-N.sortIndex;return _!==0?_:R.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var u=[],d=[],y=1,g=null,h=3,v=!1,w=!1,k=!1,S=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(R){for(var N=n(d);N!==null;){if(N.callback===null)r(d);else if(N.startTime<=R)r(d),N.sortIndex=N.expirationTime,t(u,N);else break;N=n(d)}}function j(R){if(k=!1,m(R),!w)if(n(u)!==null)w=!0,K(b);else{var N=n(d);N!==null&&fe(j,N.startTime-R)}}function b(R,N){w=!1,k&&(k=!1,p(T),T=-1),v=!0;var _=h;try{for(m(N),g=n(u);g!==null&&(!(g.expirationTime>N)||R&&!B());){var P=g.callback;if(typeof P=="function"){g.callback=null,h=g.priorityLevel;var V=P(g.expirationTime<=N);N=e.unstable_now(),typeof V=="function"?g.callback=V:g===n(u)&&r(u),m(N)}else r(u);g=n(u)}if(g!==null)var G=!0;else{var Z=n(d);Z!==null&&fe(j,Z.startTime-N),G=!1}return G}finally{g=null,h=_,v=!1}}var E=!1,I=null,T=-1,z=5,A=-1;function B(){return!(e.unstable_now()-A<z)}function le(){if(I!==null){var R=e.unstable_now();A=R;var N=!0;try{N=I(!0,R)}finally{N?F():(E=!1,I=null)}}else E=!1}var F;if(typeof f=="function")F=function(){f(le)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,ue=ge.port2;ge.port1.onmessage=le,F=function(){ue.postMessage(null)}}else F=function(){S(le,0)};function K(R){I=R,E||(E=!0,F())}function fe(R,N){T=S(function(){R(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){w||v||(w=!0,K(b))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(R){switch(h){case 1:case 2:case 3:var N=3;break;default:N=h}var _=h;h=N;try{return R()}finally{h=_}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,N){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var _=h;h=R;try{return N()}finally{h=_}},e.unstable_scheduleCallback=function(R,N,_){var P=e.unstable_now();switch(typeof _=="object"&&_!==null?(_=_.delay,_=typeof _=="number"&&0<_?P+_:P):_=P,R){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=_+V,R={id:y++,callback:N,priorityLevel:R,startTime:_,expirationTime:V,sortIndex:-1},_>P?(R.sortIndex=_,t(d,R),n(u)===null&&R===n(d)&&(k?(p(T),T=-1):k=!0,fe(j,_-P))):(R.sortIndex=V,t(u,R),w||v||(w=!0,K(b))),R},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(R){var N=h;return function(){var _=h;h=N;try{return R.apply(this,arguments)}finally{h=_}}}})(lf);sf.exports=lf;var zh=sf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ah=c,Pt=zh;function q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var of=new Set,ks={};function ur(e,t){Mr(e,t),Mr(e+"Capture",t)}function Mr(e,t){for(ks[e]=t,e=0;e<t.length;e++)of.add(t[e])}var vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ni=Object.prototype.hasOwnProperty,Th=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qc={},Xc={};function $h(e){return Ni.call(Xc,e)?!0:Ni.call(qc,e)?!1:Th.test(e)?Xc[e]=!0:(qc[e]=!0,!1)}function Mh(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Oh(e,t,n,r){if(t===null||typeof t>"u"||Mh(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function gt(e,t,n,r,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var at={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){at[e]=new gt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];at[t]=new gt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){at[e]=new gt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){at[e]=new gt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){at[e]=new gt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){at[e]=new gt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){at[e]=new gt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){at[e]=new gt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){at[e]=new gt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Aa=/[\-:]([a-z])/g;function Ta(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Aa,Ta);at[t]=new gt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Aa,Ta);at[t]=new gt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Aa,Ta);at[t]=new gt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){at[e]=new gt(e,1,!1,e.toLowerCase(),null,!1,!1)});at.xlinkHref=new gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){at[e]=new gt(e,1,!1,e.toLowerCase(),null,!0,!0)});function $a(e,t,n,r){var s=at.hasOwnProperty(t)?at[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Oh(t,n,s,r)&&(n=null),r||s===null?$h(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Sn=Ah.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rl=Symbol.for("react.element"),yr=Symbol.for("react.portal"),vr=Symbol.for("react.fragment"),Ma=Symbol.for("react.strict_mode"),ki=Symbol.for("react.profiler"),af=Symbol.for("react.provider"),cf=Symbol.for("react.context"),Oa=Symbol.for("react.forward_ref"),Ci=Symbol.for("react.suspense"),bi=Symbol.for("react.suspense_list"),Fa=Symbol.for("react.memo"),En=Symbol.for("react.lazy"),uf=Symbol.for("react.offscreen"),Jc=Symbol.iterator;function Jr(e){return e===null||typeof e!="object"?null:(e=Jc&&e[Jc]||e["@@iterator"],typeof e=="function"?e:null)}var Ge=Object.assign,Vo;function is(e){if(Vo===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Vo=t&&t[1]||""}return`
`+Vo+e}var Wo=!1;function Ho(e,t){if(!e||Wo)return"";Wo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var u=`
`+s[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=i&&0<=a);break}}}finally{Wo=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?is(e):""}function Fh(e){switch(e.tag){case 5:return is(e.type);case 16:return is("Lazy");case 13:return is("Suspense");case 19:return is("SuspenseList");case 0:case 2:case 15:return e=Ho(e.type,!1),e;case 11:return e=Ho(e.type.render,!1),e;case 1:return e=Ho(e.type,!0),e;default:return""}}function Ei(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vr:return"Fragment";case yr:return"Portal";case ki:return"Profiler";case Ma:return"StrictMode";case Ci:return"Suspense";case bi:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case cf:return(e.displayName||"Context")+".Consumer";case af:return(e._context.displayName||"Context")+".Provider";case Oa:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Fa:return t=e.displayName||null,t!==null?t:Ei(e.type)||"Memo";case En:t=e._payload,e=e._init;try{return Ei(e(t))}catch{}}return null}function Dh(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ei(t);case 8:return t===Ma?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Wn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function df(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Uh(e){var t=df(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function sl(e){e._valueTracker||(e._valueTracker=Uh(e))}function ff(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=df(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function $l(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Li(e,t){var n=t.checked;return Ge({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Zc(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Wn(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function pf(e,t){t=t.checked,t!=null&&$a(e,"checked",t,!1)}function Pi(e,t){pf(e,t);var n=Wn(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_i(e,t.type,n):t.hasOwnProperty("defaultValue")&&_i(e,t.type,Wn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function eu(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _i(e,t,n){(t!=="number"||$l(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var as=Array.isArray;function Pr(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Wn(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Ri(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(q(91));return Ge({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function tu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(q(92));if(as(n)){if(1<n.length)throw Error(q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Wn(n)}}function mf(e,t){var n=Wn(t.value),r=Wn(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function nu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function hf(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ii(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?hf(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ll,gf=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ll=ll||document.createElement("div"),ll.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ll.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Cs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ps={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Bh=["Webkit","ms","Moz","O"];Object.keys(ps).forEach(function(e){Bh.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ps[t]=ps[e]})});function yf(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ps.hasOwnProperty(e)&&ps[e]?(""+t).trim():t+"px"}function vf(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=yf(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Vh=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zi(e,t){if(t){if(Vh[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(q(62))}}function Ai(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ti=null;function Da(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $i=null,_r=null,Rr=null;function ru(e){if(e=Gs(e)){if(typeof $i!="function")throw Error(q(280));var t=e.stateNode;t&&(t=jo(t),$i(e.stateNode,e.type,t))}}function xf(e){_r?Rr?Rr.push(e):Rr=[e]:_r=e}function wf(){if(_r){var e=_r,t=Rr;if(Rr=_r=null,ru(e),t)for(e=0;e<t.length;e++)ru(t[e])}}function jf(e,t){return e(t)}function Sf(){}var Go=!1;function Nf(e,t,n){if(Go)return e(t,n);Go=!0;try{return jf(e,t,n)}finally{Go=!1,(_r!==null||Rr!==null)&&(Sf(),wf())}}function bs(e,t){var n=e.stateNode;if(n===null)return null;var r=jo(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(q(231,t,typeof n));return n}var Mi=!1;if(vn)try{var Zr={};Object.defineProperty(Zr,"passive",{get:function(){Mi=!0}}),window.addEventListener("test",Zr,Zr),window.removeEventListener("test",Zr,Zr)}catch{Mi=!1}function Wh(e,t,n,r,s,o,i,a,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(y){this.onError(y)}}var ms=!1,Ml=null,Ol=!1,Oi=null,Hh={onError:function(e){ms=!0,Ml=e}};function Gh(e,t,n,r,s,o,i,a,u){ms=!1,Ml=null,Wh.apply(Hh,arguments)}function Kh(e,t,n,r,s,o,i,a,u){if(Gh.apply(this,arguments),ms){if(ms){var d=Ml;ms=!1,Ml=null}else throw Error(q(198));Ol||(Ol=!0,Oi=d)}}function dr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function kf(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function su(e){if(dr(e)!==e)throw Error(q(188))}function Qh(e){var t=e.alternate;if(!t){if(t=dr(e),t===null)throw Error(q(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return su(s),e;if(o===r)return su(s),t;o=o.sibling}throw Error(q(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?e:t}function Cf(e){return e=Qh(e),e!==null?bf(e):null}function bf(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=bf(e);if(t!==null)return t;e=e.sibling}return null}var Ef=Pt.unstable_scheduleCallback,lu=Pt.unstable_cancelCallback,Yh=Pt.unstable_shouldYield,qh=Pt.unstable_requestPaint,Qe=Pt.unstable_now,Xh=Pt.unstable_getCurrentPriorityLevel,Ua=Pt.unstable_ImmediatePriority,Lf=Pt.unstable_UserBlockingPriority,Fl=Pt.unstable_NormalPriority,Jh=Pt.unstable_LowPriority,Pf=Pt.unstable_IdlePriority,yo=null,sn=null;function Zh(e){if(sn&&typeof sn.onCommitFiberRoot=="function")try{sn.onCommitFiberRoot(yo,e,void 0,(e.current.flags&128)===128)}catch{}}var Ht=Math.clz32?Math.clz32:ng,eg=Math.log,tg=Math.LN2;function ng(e){return e>>>=0,e===0?32:31-(eg(e)/tg|0)|0}var ol=64,il=4194304;function cs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Dl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=cs(a):(o&=i,o!==0&&(r=cs(o)))}else i=n&~s,i!==0?r=cs(i):o!==0&&(r=cs(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ht(t),s=1<<n,r|=e[n],t&=~s;return r}function rg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-Ht(o),a=1<<i,u=s[i];u===-1?(!(a&n)||a&r)&&(s[i]=rg(a,t)):u<=t&&(e.expiredLanes|=a),o&=~a}}function Fi(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function _f(){var e=ol;return ol<<=1,!(ol&4194240)&&(ol=64),e}function Ko(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ws(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ht(t),e[t]=n}function lg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Ht(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function Ba(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ht(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Ie=0;function Rf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var If,Va,zf,Af,Tf,Di=!1,al=[],An=null,Tn=null,$n=null,Es=new Map,Ls=new Map,Pn=[],og="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ou(e,t){switch(e){case"focusin":case"focusout":An=null;break;case"dragenter":case"dragleave":Tn=null;break;case"mouseover":case"mouseout":$n=null;break;case"pointerover":case"pointerout":Es.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ls.delete(t.pointerId)}}function es(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=Gs(t),t!==null&&Va(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function ig(e,t,n,r,s){switch(t){case"focusin":return An=es(An,e,t,n,r,s),!0;case"dragenter":return Tn=es(Tn,e,t,n,r,s),!0;case"mouseover":return $n=es($n,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return Es.set(o,es(Es.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Ls.set(o,es(Ls.get(o)||null,e,t,n,r,s)),!0}return!1}function $f(e){var t=er(e.target);if(t!==null){var n=dr(t);if(n!==null){if(t=n.tag,t===13){if(t=kf(n),t!==null){e.blockedOn=t,Tf(e.priority,function(){zf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function kl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ui(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ti=r,n.target.dispatchEvent(r),Ti=null}else return t=Gs(n),t!==null&&Va(t),e.blockedOn=n,!1;t.shift()}return!0}function iu(e,t,n){kl(e)&&n.delete(t)}function ag(){Di=!1,An!==null&&kl(An)&&(An=null),Tn!==null&&kl(Tn)&&(Tn=null),$n!==null&&kl($n)&&($n=null),Es.forEach(iu),Ls.forEach(iu)}function ts(e,t){e.blockedOn===t&&(e.blockedOn=null,Di||(Di=!0,Pt.unstable_scheduleCallback(Pt.unstable_NormalPriority,ag)))}function Ps(e){function t(s){return ts(s,e)}if(0<al.length){ts(al[0],e);for(var n=1;n<al.length;n++){var r=al[n];r.blockedOn===e&&(r.blockedOn=null)}}for(An!==null&&ts(An,e),Tn!==null&&ts(Tn,e),$n!==null&&ts($n,e),Es.forEach(t),Ls.forEach(t),n=0;n<Pn.length;n++)r=Pn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Pn.length&&(n=Pn[0],n.blockedOn===null);)$f(n),n.blockedOn===null&&Pn.shift()}var Ir=Sn.ReactCurrentBatchConfig,Ul=!0;function cg(e,t,n,r){var s=Ie,o=Ir.transition;Ir.transition=null;try{Ie=1,Wa(e,t,n,r)}finally{Ie=s,Ir.transition=o}}function ug(e,t,n,r){var s=Ie,o=Ir.transition;Ir.transition=null;try{Ie=4,Wa(e,t,n,r)}finally{Ie=s,Ir.transition=o}}function Wa(e,t,n,r){if(Ul){var s=Ui(e,t,n,r);if(s===null)ri(e,t,r,Bl,n),ou(e,r);else if(ig(s,e,t,n,r))r.stopPropagation();else if(ou(e,r),t&4&&-1<og.indexOf(e)){for(;s!==null;){var o=Gs(s);if(o!==null&&If(o),o=Ui(e,t,n,r),o===null&&ri(e,t,r,Bl,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else ri(e,t,r,null,n)}}var Bl=null;function Ui(e,t,n,r){if(Bl=null,e=Da(r),e=er(e),e!==null)if(t=dr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=kf(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Bl=e,null}function Mf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xh()){case Ua:return 1;case Lf:return 4;case Fl:case Jh:return 16;case Pf:return 536870912;default:return 16}default:return 16}}var Rn=null,Ha=null,Cl=null;function Of(){if(Cl)return Cl;var e,t=Ha,n=t.length,r,s="value"in Rn?Rn.value:Rn.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===s[o-r];r++);return Cl=s.slice(e,1<r?1-r:void 0)}function bl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function cl(){return!0}function au(){return!1}function Rt(e){function t(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?cl:au,this.isPropagationStopped=au,this}return Ge(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=cl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=cl)},persist:function(){},isPersistent:cl}),t}var Gr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ga=Rt(Gr),Hs=Ge({},Gr,{view:0,detail:0}),dg=Rt(Hs),Qo,Yo,ns,vo=Ge({},Hs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ka,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ns&&(ns&&e.type==="mousemove"?(Qo=e.screenX-ns.screenX,Yo=e.screenY-ns.screenY):Yo=Qo=0,ns=e),Qo)},movementY:function(e){return"movementY"in e?e.movementY:Yo}}),cu=Rt(vo),fg=Ge({},vo,{dataTransfer:0}),pg=Rt(fg),mg=Ge({},Hs,{relatedTarget:0}),qo=Rt(mg),hg=Ge({},Gr,{animationName:0,elapsedTime:0,pseudoElement:0}),gg=Rt(hg),yg=Ge({},Gr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vg=Rt(yg),xg=Ge({},Gr,{data:0}),uu=Rt(xg),wg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ng(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Sg[e])?!!t[e]:!1}function Ka(){return Ng}var kg=Ge({},Hs,{key:function(e){if(e.key){var t=wg[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=bl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?jg[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ka,charCode:function(e){return e.type==="keypress"?bl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Cg=Rt(kg),bg=Ge({},vo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),du=Rt(bg),Eg=Ge({},Hs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ka}),Lg=Rt(Eg),Pg=Ge({},Gr,{propertyName:0,elapsedTime:0,pseudoElement:0}),_g=Rt(Pg),Rg=Ge({},vo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ig=Rt(Rg),zg=[9,13,27,32],Qa=vn&&"CompositionEvent"in window,hs=null;vn&&"documentMode"in document&&(hs=document.documentMode);var Ag=vn&&"TextEvent"in window&&!hs,Ff=vn&&(!Qa||hs&&8<hs&&11>=hs),fu=" ",pu=!1;function Df(e,t){switch(e){case"keyup":return zg.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xr=!1;function Tg(e,t){switch(e){case"compositionend":return Uf(t);case"keypress":return t.which!==32?null:(pu=!0,fu);case"textInput":return e=t.data,e===fu&&pu?null:e;default:return null}}function $g(e,t){if(xr)return e==="compositionend"||!Qa&&Df(e,t)?(e=Of(),Cl=Ha=Rn=null,xr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ff&&t.locale!=="ko"?null:t.data;default:return null}}var Mg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Mg[e.type]:t==="textarea"}function Bf(e,t,n,r){xf(r),t=Vl(t,"onChange"),0<t.length&&(n=new Ga("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var gs=null,_s=null;function Og(e){Zf(e,0)}function xo(e){var t=Sr(e);if(ff(t))return e}function Fg(e,t){if(e==="change")return t}var Vf=!1;if(vn){var Xo;if(vn){var Jo="oninput"in document;if(!Jo){var hu=document.createElement("div");hu.setAttribute("oninput","return;"),Jo=typeof hu.oninput=="function"}Xo=Jo}else Xo=!1;Vf=Xo&&(!document.documentMode||9<document.documentMode)}function gu(){gs&&(gs.detachEvent("onpropertychange",Wf),_s=gs=null)}function Wf(e){if(e.propertyName==="value"&&xo(_s)){var t=[];Bf(t,_s,e,Da(e)),Nf(Og,t)}}function Dg(e,t,n){e==="focusin"?(gu(),gs=t,_s=n,gs.attachEvent("onpropertychange",Wf)):e==="focusout"&&gu()}function Ug(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xo(_s)}function Bg(e,t){if(e==="click")return xo(t)}function Vg(e,t){if(e==="input"||e==="change")return xo(t)}function Wg(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Kt=typeof Object.is=="function"?Object.is:Wg;function Rs(e,t){if(Kt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ni.call(t,s)||!Kt(e[s],t[s]))return!1}return!0}function yu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function vu(e,t){var n=yu(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=yu(n)}}function Hf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Hf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Gf(){for(var e=window,t=$l();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=$l(e.document)}return t}function Ya(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Hg(e){var t=Gf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Hf(n.ownerDocument.documentElement,n)){if(r!==null&&Ya(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=vu(n,o);var i=vu(n,r);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Gg=vn&&"documentMode"in document&&11>=document.documentMode,wr=null,Bi=null,ys=null,Vi=!1;function xu(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vi||wr==null||wr!==$l(r)||(r=wr,"selectionStart"in r&&Ya(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ys&&Rs(ys,r)||(ys=r,r=Vl(Bi,"onSelect"),0<r.length&&(t=new Ga("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=wr)))}function ul(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var jr={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionend:ul("Transition","TransitionEnd")},Zo={},Kf={};vn&&(Kf=document.createElement("div").style,"AnimationEvent"in window||(delete jr.animationend.animation,delete jr.animationiteration.animation,delete jr.animationstart.animation),"TransitionEvent"in window||delete jr.transitionend.transition);function wo(e){if(Zo[e])return Zo[e];if(!jr[e])return e;var t=jr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Kf)return Zo[e]=t[n];return e}var Qf=wo("animationend"),Yf=wo("animationiteration"),qf=wo("animationstart"),Xf=wo("transitionend"),Jf=new Map,wu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kn(e,t){Jf.set(e,t),ur(t,[e])}for(var ei=0;ei<wu.length;ei++){var ti=wu[ei],Kg=ti.toLowerCase(),Qg=ti[0].toUpperCase()+ti.slice(1);Kn(Kg,"on"+Qg)}Kn(Qf,"onAnimationEnd");Kn(Yf,"onAnimationIteration");Kn(qf,"onAnimationStart");Kn("dblclick","onDoubleClick");Kn("focusin","onFocus");Kn("focusout","onBlur");Kn(Xf,"onTransitionEnd");Mr("onMouseEnter",["mouseout","mouseover"]);Mr("onMouseLeave",["mouseout","mouseover"]);Mr("onPointerEnter",["pointerout","pointerover"]);Mr("onPointerLeave",["pointerout","pointerover"]);ur("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ur("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ur("onBeforeInput",["compositionend","keypress","textInput","paste"]);ur("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ur("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ur("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var us="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yg=new Set("cancel close invalid load scroll toggle".split(" ").concat(us));function ju(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Kh(r,t,void 0,e),e.currentTarget=null}function Zf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var a=r[i],u=a.instance,d=a.currentTarget;if(a=a.listener,u!==o&&s.isPropagationStopped())break e;ju(s,a,d),o=u}else for(i=0;i<r.length;i++){if(a=r[i],u=a.instance,d=a.currentTarget,a=a.listener,u!==o&&s.isPropagationStopped())break e;ju(s,a,d),o=u}}}if(Ol)throw e=Oi,Ol=!1,Oi=null,e}function Fe(e,t){var n=t[Qi];n===void 0&&(n=t[Qi]=new Set);var r=e+"__bubble";n.has(r)||(ep(t,e,2,!1),n.add(r))}function ni(e,t,n){var r=0;t&&(r|=4),ep(n,e,r,t)}var dl="_reactListening"+Math.random().toString(36).slice(2);function Is(e){if(!e[dl]){e[dl]=!0,of.forEach(function(n){n!=="selectionchange"&&(Yg.has(n)||ni(n,!1,e),ni(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[dl]||(t[dl]=!0,ni("selectionchange",!1,t))}}function ep(e,t,n,r){switch(Mf(t)){case 1:var s=cg;break;case 4:s=ug;break;default:s=Wa}n=s.bind(null,t,n,e),s=void 0,!Mi||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function ri(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;i=i.return}for(;a!==null;){if(i=er(a),i===null)return;if(u=i.tag,u===5||u===6){r=o=i;continue e}a=a.parentNode}}r=r.return}Nf(function(){var d=o,y=Da(n),g=[];e:{var h=Jf.get(e);if(h!==void 0){var v=Ga,w=e;switch(e){case"keypress":if(bl(n)===0)break e;case"keydown":case"keyup":v=Cg;break;case"focusin":w="focus",v=qo;break;case"focusout":w="blur",v=qo;break;case"beforeblur":case"afterblur":v=qo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=cu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=pg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Lg;break;case Qf:case Yf:case qf:v=gg;break;case Xf:v=_g;break;case"scroll":v=dg;break;case"wheel":v=Ig;break;case"copy":case"cut":case"paste":v=vg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=du}var k=(t&4)!==0,S=!k&&e==="scroll",p=k?h!==null?h+"Capture":null:h;k=[];for(var f=d,m;f!==null;){m=f;var j=m.stateNode;if(m.tag===5&&j!==null&&(m=j,p!==null&&(j=bs(f,p),j!=null&&k.push(zs(f,j,m)))),S)break;f=f.return}0<k.length&&(h=new v(h,w,null,n,y),g.push({event:h,listeners:k}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",h&&n!==Ti&&(w=n.relatedTarget||n.fromElement)&&(er(w)||w[xn]))break e;if((v||h)&&(h=y.window===y?y:(h=y.ownerDocument)?h.defaultView||h.parentWindow:window,v?(w=n.relatedTarget||n.toElement,v=d,w=w?er(w):null,w!==null&&(S=dr(w),w!==S||w.tag!==5&&w.tag!==6)&&(w=null)):(v=null,w=d),v!==w)){if(k=cu,j="onMouseLeave",p="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(k=du,j="onPointerLeave",p="onPointerEnter",f="pointer"),S=v==null?h:Sr(v),m=w==null?h:Sr(w),h=new k(j,f+"leave",v,n,y),h.target=S,h.relatedTarget=m,j=null,er(y)===d&&(k=new k(p,f+"enter",w,n,y),k.target=m,k.relatedTarget=S,j=k),S=j,v&&w)t:{for(k=v,p=w,f=0,m=k;m;m=pr(m))f++;for(m=0,j=p;j;j=pr(j))m++;for(;0<f-m;)k=pr(k),f--;for(;0<m-f;)p=pr(p),m--;for(;f--;){if(k===p||p!==null&&k===p.alternate)break t;k=pr(k),p=pr(p)}k=null}else k=null;v!==null&&Su(g,h,v,k,!1),w!==null&&S!==null&&Su(g,S,w,k,!0)}}e:{if(h=d?Sr(d):window,v=h.nodeName&&h.nodeName.toLowerCase(),v==="select"||v==="input"&&h.type==="file")var b=Fg;else if(mu(h))if(Vf)b=Vg;else{b=Ug;var E=Dg}else(v=h.nodeName)&&v.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=Bg);if(b&&(b=b(e,d))){Bf(g,b,n,y);break e}E&&E(e,h,d),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&_i(h,"number",h.value)}switch(E=d?Sr(d):window,e){case"focusin":(mu(E)||E.contentEditable==="true")&&(wr=E,Bi=d,ys=null);break;case"focusout":ys=Bi=wr=null;break;case"mousedown":Vi=!0;break;case"contextmenu":case"mouseup":case"dragend":Vi=!1,xu(g,n,y);break;case"selectionchange":if(Gg)break;case"keydown":case"keyup":xu(g,n,y)}var I;if(Qa)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else xr?Df(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(Ff&&n.locale!=="ko"&&(xr||T!=="onCompositionStart"?T==="onCompositionEnd"&&xr&&(I=Of()):(Rn=y,Ha="value"in Rn?Rn.value:Rn.textContent,xr=!0)),E=Vl(d,T),0<E.length&&(T=new uu(T,e,null,n,y),g.push({event:T,listeners:E}),I?T.data=I:(I=Uf(n),I!==null&&(T.data=I)))),(I=Ag?Tg(e,n):$g(e,n))&&(d=Vl(d,"onBeforeInput"),0<d.length&&(y=new uu("onBeforeInput","beforeinput",null,n,y),g.push({event:y,listeners:d}),y.data=I))}Zf(g,t)})}function zs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Vl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=bs(e,n),o!=null&&r.unshift(zs(e,o,s)),o=bs(e,t),o!=null&&r.push(zs(e,o,s))),e=e.return}return r}function pr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Su(e,t,n,r,s){for(var o=t._reactName,i=[];n!==null&&n!==r;){var a=n,u=a.alternate,d=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&d!==null&&(a=d,s?(u=bs(n,o),u!=null&&i.unshift(zs(n,u,a))):s||(u=bs(n,o),u!=null&&i.push(zs(n,u,a)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var qg=/\r\n?/g,Xg=/\u0000|\uFFFD/g;function Nu(e){return(typeof e=="string"?e:""+e).replace(qg,`
`).replace(Xg,"")}function fl(e,t,n){if(t=Nu(t),Nu(e)!==t&&n)throw Error(q(425))}function Wl(){}var Wi=null,Hi=null;function Gi(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ki=typeof setTimeout=="function"?setTimeout:void 0,Jg=typeof clearTimeout=="function"?clearTimeout:void 0,ku=typeof Promise=="function"?Promise:void 0,Zg=typeof queueMicrotask=="function"?queueMicrotask:typeof ku<"u"?function(e){return ku.resolve(null).then(e).catch(ey)}:Ki;function ey(e){setTimeout(function(){throw e})}function si(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Ps(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ps(t)}function Mn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Cu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Kr=Math.random().toString(36).slice(2),Zt="__reactFiber$"+Kr,As="__reactProps$"+Kr,xn="__reactContainer$"+Kr,Qi="__reactEvents$"+Kr,ty="__reactListeners$"+Kr,ny="__reactHandles$"+Kr;function er(e){var t=e[Zt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[xn]||n[Zt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Cu(e);e!==null;){if(n=e[Zt])return n;e=Cu(e)}return t}e=n,n=e.parentNode}return null}function Gs(e){return e=e[Zt]||e[xn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Sr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(q(33))}function jo(e){return e[As]||null}var Yi=[],Nr=-1;function Qn(e){return{current:e}}function De(e){0>Nr||(e.current=Yi[Nr],Yi[Nr]=null,Nr--)}function Me(e,t){Nr++,Yi[Nr]=e.current,e.current=t}var Hn={},ft=Qn(Hn),wt=Qn(!1),lr=Hn;function Or(e,t){var n=e.type.contextTypes;if(!n)return Hn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function jt(e){return e=e.childContextTypes,e!=null}function Hl(){De(wt),De(ft)}function bu(e,t,n){if(ft.current!==Hn)throw Error(q(168));Me(ft,t),Me(wt,n)}function tp(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(q(108,Dh(e)||"Unknown",s));return Ge({},n,r)}function Gl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Hn,lr=ft.current,Me(ft,e),Me(wt,wt.current),!0}function Eu(e,t,n){var r=e.stateNode;if(!r)throw Error(q(169));n?(e=tp(e,t,lr),r.__reactInternalMemoizedMergedChildContext=e,De(wt),De(ft),Me(ft,e)):De(wt),Me(wt,n)}var un=null,So=!1,li=!1;function np(e){un===null?un=[e]:un.push(e)}function ry(e){So=!0,np(e)}function Yn(){if(!li&&un!==null){li=!0;var e=0,t=Ie;try{var n=un;for(Ie=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}un=null,So=!1}catch(s){throw un!==null&&(un=un.slice(e+1)),Ef(Ua,Yn),s}finally{Ie=t,li=!1}}return null}var kr=[],Cr=0,Kl=null,Ql=0,At=[],Tt=0,or=null,pn=1,mn="";function Xn(e,t){kr[Cr++]=Ql,kr[Cr++]=Kl,Kl=e,Ql=t}function rp(e,t,n){At[Tt++]=pn,At[Tt++]=mn,At[Tt++]=or,or=e;var r=pn;e=mn;var s=32-Ht(r)-1;r&=~(1<<s),n+=1;var o=32-Ht(t)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,pn=1<<32-Ht(t)+s|n<<s|r,mn=o+e}else pn=1<<o|n<<s|r,mn=e}function qa(e){e.return!==null&&(Xn(e,1),rp(e,1,0))}function Xa(e){for(;e===Kl;)Kl=kr[--Cr],kr[Cr]=null,Ql=kr[--Cr],kr[Cr]=null;for(;e===or;)or=At[--Tt],At[Tt]=null,mn=At[--Tt],At[Tt]=null,pn=At[--Tt],At[Tt]=null}var Lt=null,Et=null,Ue=!1,Wt=null;function sp(e,t){var n=$t(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Lu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Lt=e,Et=Mn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Lt=e,Et=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=or!==null?{id:pn,overflow:mn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=$t(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Lt=e,Et=null,!0):!1;default:return!1}}function qi(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xi(e){if(Ue){var t=Et;if(t){var n=t;if(!Lu(e,t)){if(qi(e))throw Error(q(418));t=Mn(n.nextSibling);var r=Lt;t&&Lu(e,t)?sp(r,n):(e.flags=e.flags&-4097|2,Ue=!1,Lt=e)}}else{if(qi(e))throw Error(q(418));e.flags=e.flags&-4097|2,Ue=!1,Lt=e}}}function Pu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Lt=e}function pl(e){if(e!==Lt)return!1;if(!Ue)return Pu(e),Ue=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Gi(e.type,e.memoizedProps)),t&&(t=Et)){if(qi(e))throw lp(),Error(q(418));for(;t;)sp(e,t),t=Mn(t.nextSibling)}if(Pu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Et=Mn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Et=null}}else Et=Lt?Mn(e.stateNode.nextSibling):null;return!0}function lp(){for(var e=Et;e;)e=Mn(e.nextSibling)}function Fr(){Et=Lt=null,Ue=!1}function Ja(e){Wt===null?Wt=[e]:Wt.push(e)}var sy=Sn.ReactCurrentBatchConfig;function rs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,e))}return e}function ml(e,t){throw e=Object.prototype.toString.call(t),Error(q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _u(e){var t=e._init;return t(e._payload)}function op(e){function t(p,f){if(e){var m=p.deletions;m===null?(p.deletions=[f],p.flags|=16):m.push(f)}}function n(p,f){if(!e)return null;for(;f!==null;)t(p,f),f=f.sibling;return null}function r(p,f){for(p=new Map;f!==null;)f.key!==null?p.set(f.key,f):p.set(f.index,f),f=f.sibling;return p}function s(p,f){return p=Un(p,f),p.index=0,p.sibling=null,p}function o(p,f,m){return p.index=m,e?(m=p.alternate,m!==null?(m=m.index,m<f?(p.flags|=2,f):m):(p.flags|=2,f)):(p.flags|=1048576,f)}function i(p){return e&&p.alternate===null&&(p.flags|=2),p}function a(p,f,m,j){return f===null||f.tag!==6?(f=fi(m,p.mode,j),f.return=p,f):(f=s(f,m),f.return=p,f)}function u(p,f,m,j){var b=m.type;return b===vr?y(p,f,m.props.children,j,m.key):f!==null&&(f.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===En&&_u(b)===f.type)?(j=s(f,m.props),j.ref=rs(p,f,m),j.return=p,j):(j=zl(m.type,m.key,m.props,null,p.mode,j),j.ref=rs(p,f,m),j.return=p,j)}function d(p,f,m,j){return f===null||f.tag!==4||f.stateNode.containerInfo!==m.containerInfo||f.stateNode.implementation!==m.implementation?(f=pi(m,p.mode,j),f.return=p,f):(f=s(f,m.children||[]),f.return=p,f)}function y(p,f,m,j,b){return f===null||f.tag!==7?(f=sr(m,p.mode,j,b),f.return=p,f):(f=s(f,m),f.return=p,f)}function g(p,f,m){if(typeof f=="string"&&f!==""||typeof f=="number")return f=fi(""+f,p.mode,m),f.return=p,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case rl:return m=zl(f.type,f.key,f.props,null,p.mode,m),m.ref=rs(p,null,f),m.return=p,m;case yr:return f=pi(f,p.mode,m),f.return=p,f;case En:var j=f._init;return g(p,j(f._payload),m)}if(as(f)||Jr(f))return f=sr(f,p.mode,m,null),f.return=p,f;ml(p,f)}return null}function h(p,f,m,j){var b=f!==null?f.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return b!==null?null:a(p,f,""+m,j);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case rl:return m.key===b?u(p,f,m,j):null;case yr:return m.key===b?d(p,f,m,j):null;case En:return b=m._init,h(p,f,b(m._payload),j)}if(as(m)||Jr(m))return b!==null?null:y(p,f,m,j,null);ml(p,m)}return null}function v(p,f,m,j,b){if(typeof j=="string"&&j!==""||typeof j=="number")return p=p.get(m)||null,a(f,p,""+j,b);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case rl:return p=p.get(j.key===null?m:j.key)||null,u(f,p,j,b);case yr:return p=p.get(j.key===null?m:j.key)||null,d(f,p,j,b);case En:var E=j._init;return v(p,f,m,E(j._payload),b)}if(as(j)||Jr(j))return p=p.get(m)||null,y(f,p,j,b,null);ml(f,j)}return null}function w(p,f,m,j){for(var b=null,E=null,I=f,T=f=0,z=null;I!==null&&T<m.length;T++){I.index>T?(z=I,I=null):z=I.sibling;var A=h(p,I,m[T],j);if(A===null){I===null&&(I=z);break}e&&I&&A.alternate===null&&t(p,I),f=o(A,f,T),E===null?b=A:E.sibling=A,E=A,I=z}if(T===m.length)return n(p,I),Ue&&Xn(p,T),b;if(I===null){for(;T<m.length;T++)I=g(p,m[T],j),I!==null&&(f=o(I,f,T),E===null?b=I:E.sibling=I,E=I);return Ue&&Xn(p,T),b}for(I=r(p,I);T<m.length;T++)z=v(I,p,T,m[T],j),z!==null&&(e&&z.alternate!==null&&I.delete(z.key===null?T:z.key),f=o(z,f,T),E===null?b=z:E.sibling=z,E=z);return e&&I.forEach(function(B){return t(p,B)}),Ue&&Xn(p,T),b}function k(p,f,m,j){var b=Jr(m);if(typeof b!="function")throw Error(q(150));if(m=b.call(m),m==null)throw Error(q(151));for(var E=b=null,I=f,T=f=0,z=null,A=m.next();I!==null&&!A.done;T++,A=m.next()){I.index>T?(z=I,I=null):z=I.sibling;var B=h(p,I,A.value,j);if(B===null){I===null&&(I=z);break}e&&I&&B.alternate===null&&t(p,I),f=o(B,f,T),E===null?b=B:E.sibling=B,E=B,I=z}if(A.done)return n(p,I),Ue&&Xn(p,T),b;if(I===null){for(;!A.done;T++,A=m.next())A=g(p,A.value,j),A!==null&&(f=o(A,f,T),E===null?b=A:E.sibling=A,E=A);return Ue&&Xn(p,T),b}for(I=r(p,I);!A.done;T++,A=m.next())A=v(I,p,T,A.value,j),A!==null&&(e&&A.alternate!==null&&I.delete(A.key===null?T:A.key),f=o(A,f,T),E===null?b=A:E.sibling=A,E=A);return e&&I.forEach(function(le){return t(p,le)}),Ue&&Xn(p,T),b}function S(p,f,m,j){if(typeof m=="object"&&m!==null&&m.type===vr&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case rl:e:{for(var b=m.key,E=f;E!==null;){if(E.key===b){if(b=m.type,b===vr){if(E.tag===7){n(p,E.sibling),f=s(E,m.props.children),f.return=p,p=f;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===En&&_u(b)===E.type){n(p,E.sibling),f=s(E,m.props),f.ref=rs(p,E,m),f.return=p,p=f;break e}n(p,E);break}else t(p,E);E=E.sibling}m.type===vr?(f=sr(m.props.children,p.mode,j,m.key),f.return=p,p=f):(j=zl(m.type,m.key,m.props,null,p.mode,j),j.ref=rs(p,f,m),j.return=p,p=j)}return i(p);case yr:e:{for(E=m.key;f!==null;){if(f.key===E)if(f.tag===4&&f.stateNode.containerInfo===m.containerInfo&&f.stateNode.implementation===m.implementation){n(p,f.sibling),f=s(f,m.children||[]),f.return=p,p=f;break e}else{n(p,f);break}else t(p,f);f=f.sibling}f=pi(m,p.mode,j),f.return=p,p=f}return i(p);case En:return E=m._init,S(p,f,E(m._payload),j)}if(as(m))return w(p,f,m,j);if(Jr(m))return k(p,f,m,j);ml(p,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,f!==null&&f.tag===6?(n(p,f.sibling),f=s(f,m),f.return=p,p=f):(n(p,f),f=fi(m,p.mode,j),f.return=p,p=f),i(p)):n(p,f)}return S}var Dr=op(!0),ip=op(!1),Yl=Qn(null),ql=null,br=null,Za=null;function ec(){Za=br=ql=null}function tc(e){var t=Yl.current;De(Yl),e._currentValue=t}function Ji(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function zr(e,t){ql=e,Za=br=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(xt=!0),e.firstContext=null)}function Ot(e){var t=e._currentValue;if(Za!==e)if(e={context:e,memoizedValue:t,next:null},br===null){if(ql===null)throw Error(q(308));br=e,ql.dependencies={lanes:0,firstContext:e}}else br=br.next=e;return t}var tr=null;function nc(e){tr===null?tr=[e]:tr.push(e)}function ap(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,nc(t)):(n.next=s.next,s.next=n),t.interleaved=n,wn(e,r)}function wn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ln=!1;function rc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function gn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function On(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Pe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,wn(e,n)}return s=r.interleaved,s===null?(t.next=t,nc(r)):(t.next=s.next,s.next=t),r.interleaved=t,wn(e,n)}function El(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ba(e,n)}}function Ru(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Xl(e,t,n,r){var s=e.updateQueue;Ln=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,d=u.next;u.next=null,i===null?o=d:i.next=d,i=u;var y=e.alternate;y!==null&&(y=y.updateQueue,a=y.lastBaseUpdate,a!==i&&(a===null?y.firstBaseUpdate=d:a.next=d,y.lastBaseUpdate=u))}if(o!==null){var g=s.baseState;i=0,y=d=u=null,a=o;do{var h=a.lane,v=a.eventTime;if((r&h)===h){y!==null&&(y=y.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var w=e,k=a;switch(h=t,v=n,k.tag){case 1:if(w=k.payload,typeof w=="function"){g=w.call(v,g,h);break e}g=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=k.payload,h=typeof w=="function"?w.call(v,g,h):w,h==null)break e;g=Ge({},g,h);break e;case 2:Ln=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[a]:h.push(a))}else v={eventTime:v,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},y===null?(d=y=v,u=g):y=y.next=v,i|=h;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;h=a,a=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(y===null&&(u=g),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=y,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);ar|=i,e.lanes=i,e.memoizedState=g}}function Iu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(q(191,s));s.call(r)}}}var Ks={},ln=Qn(Ks),Ts=Qn(Ks),$s=Qn(Ks);function nr(e){if(e===Ks)throw Error(q(174));return e}function sc(e,t){switch(Me($s,t),Me(Ts,e),Me(ln,Ks),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ii(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ii(t,e)}De(ln),Me(ln,t)}function Ur(){De(ln),De(Ts),De($s)}function up(e){nr($s.current);var t=nr(ln.current),n=Ii(t,e.type);t!==n&&(Me(Ts,e),Me(ln,n))}function lc(e){Ts.current===e&&(De(ln),De(Ts))}var Ve=Qn(0);function Jl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var oi=[];function oc(){for(var e=0;e<oi.length;e++)oi[e]._workInProgressVersionPrimary=null;oi.length=0}var Ll=Sn.ReactCurrentDispatcher,ii=Sn.ReactCurrentBatchConfig,ir=0,We=null,et=null,st=null,Zl=!1,vs=!1,Ms=0,ly=0;function ct(){throw Error(q(321))}function ic(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kt(e[n],t[n]))return!1;return!0}function ac(e,t,n,r,s,o){if(ir=o,We=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ll.current=e===null||e.memoizedState===null?cy:uy,e=n(r,s),vs){o=0;do{if(vs=!1,Ms=0,25<=o)throw Error(q(301));o+=1,st=et=null,t.updateQueue=null,Ll.current=dy,e=n(r,s)}while(vs)}if(Ll.current=eo,t=et!==null&&et.next!==null,ir=0,st=et=We=null,Zl=!1,t)throw Error(q(300));return e}function cc(){var e=Ms!==0;return Ms=0,e}function Jt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?We.memoizedState=st=e:st=st.next=e,st}function Ft(){if(et===null){var e=We.alternate;e=e!==null?e.memoizedState:null}else e=et.next;var t=st===null?We.memoizedState:st.next;if(t!==null)st=t,et=e;else{if(e===null)throw Error(q(310));et=e,e={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},st===null?We.memoizedState=st=e:st=st.next=e}return st}function Os(e,t){return typeof t=="function"?t(e):t}function ai(e){var t=Ft(),n=t.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=e;var r=et,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,u=null,d=o;do{var y=d.lane;if((ir&y)===y)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var g={lane:y,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(a=u=g,i=r):u=u.next=g,We.lanes|=y,ar|=y}d=d.next}while(d!==null&&d!==o);u===null?i=r:u.next=a,Kt(r,t.memoizedState)||(xt=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,We.lanes|=o,ar|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ci(e){var t=Ft(),n=t.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);Kt(o,t.memoizedState)||(xt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function dp(){}function fp(e,t){var n=We,r=Ft(),s=t(),o=!Kt(r.memoizedState,s);if(o&&(r.memoizedState=s,xt=!0),r=r.queue,uc(hp.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||st!==null&&st.memoizedState.tag&1){if(n.flags|=2048,Fs(9,mp.bind(null,n,r,s,t),void 0,null),lt===null)throw Error(q(349));ir&30||pp(n,t,s)}return s}function pp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=We.updateQueue,t===null?(t={lastEffect:null,stores:null},We.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function mp(e,t,n,r){t.value=n,t.getSnapshot=r,gp(t)&&yp(e)}function hp(e,t,n){return n(function(){gp(t)&&yp(e)})}function gp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kt(e,n)}catch{return!0}}function yp(e){var t=wn(e,1);t!==null&&Gt(t,e,1,-1)}function zu(e){var t=Jt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Os,lastRenderedState:e},t.queue=e,e=e.dispatch=ay.bind(null,We,e),[t.memoizedState,e]}function Fs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=We.updateQueue,t===null?(t={lastEffect:null,stores:null},We.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function vp(){return Ft().memoizedState}function Pl(e,t,n,r){var s=Jt();We.flags|=e,s.memoizedState=Fs(1|t,n,void 0,r===void 0?null:r)}function No(e,t,n,r){var s=Ft();r=r===void 0?null:r;var o=void 0;if(et!==null){var i=et.memoizedState;if(o=i.destroy,r!==null&&ic(r,i.deps)){s.memoizedState=Fs(t,n,o,r);return}}We.flags|=e,s.memoizedState=Fs(1|t,n,o,r)}function Au(e,t){return Pl(8390656,8,e,t)}function uc(e,t){return No(2048,8,e,t)}function xp(e,t){return No(4,2,e,t)}function wp(e,t){return No(4,4,e,t)}function jp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Sp(e,t,n){return n=n!=null?n.concat([e]):null,No(4,4,jp.bind(null,t,e),n)}function dc(){}function Np(e,t){var n=Ft();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ic(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function kp(e,t){var n=Ft();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&ic(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Cp(e,t,n){return ir&21?(Kt(n,t)||(n=_f(),We.lanes|=n,ar|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,xt=!0),e.memoizedState=n)}function oy(e,t){var n=Ie;Ie=n!==0&&4>n?n:4,e(!0);var r=ii.transition;ii.transition={};try{e(!1),t()}finally{Ie=n,ii.transition=r}}function bp(){return Ft().memoizedState}function iy(e,t,n){var r=Dn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ep(e))Lp(t,n);else if(n=ap(e,t,n,r),n!==null){var s=mt();Gt(n,e,r,s),Pp(n,t,r)}}function ay(e,t,n){var r=Dn(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ep(e))Lp(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,Kt(a,i)){var u=t.interleaved;u===null?(s.next=s,nc(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=ap(e,t,s,r),n!==null&&(s=mt(),Gt(n,e,r,s),Pp(n,t,r))}}function Ep(e){var t=e.alternate;return e===We||t!==null&&t===We}function Lp(e,t){vs=Zl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Pp(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ba(e,n)}}var eo={readContext:Ot,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},cy={readContext:Ot,useCallback:function(e,t){return Jt().memoizedState=[e,t===void 0?null:t],e},useContext:Ot,useEffect:Au,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Pl(4194308,4,jp.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pl(4,2,e,t)},useMemo:function(e,t){var n=Jt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Jt();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=iy.bind(null,We,e),[r.memoizedState,e]},useRef:function(e){var t=Jt();return e={current:e},t.memoizedState=e},useState:zu,useDebugValue:dc,useDeferredValue:function(e){return Jt().memoizedState=e},useTransition:function(){var e=zu(!1),t=e[0];return e=oy.bind(null,e[1]),Jt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=We,s=Jt();if(Ue){if(n===void 0)throw Error(q(407));n=n()}else{if(n=t(),lt===null)throw Error(q(349));ir&30||pp(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,Au(hp.bind(null,r,o,e),[e]),r.flags|=2048,Fs(9,mp.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Jt(),t=lt.identifierPrefix;if(Ue){var n=mn,r=pn;n=(r&~(1<<32-Ht(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ms++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ly++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},uy={readContext:Ot,useCallback:Np,useContext:Ot,useEffect:uc,useImperativeHandle:Sp,useInsertionEffect:xp,useLayoutEffect:wp,useMemo:kp,useReducer:ai,useRef:vp,useState:function(){return ai(Os)},useDebugValue:dc,useDeferredValue:function(e){var t=Ft();return Cp(t,et.memoizedState,e)},useTransition:function(){var e=ai(Os)[0],t=Ft().memoizedState;return[e,t]},useMutableSource:dp,useSyncExternalStore:fp,useId:bp,unstable_isNewReconciler:!1},dy={readContext:Ot,useCallback:Np,useContext:Ot,useEffect:uc,useImperativeHandle:Sp,useInsertionEffect:xp,useLayoutEffect:wp,useMemo:kp,useReducer:ci,useRef:vp,useState:function(){return ci(Os)},useDebugValue:dc,useDeferredValue:function(e){var t=Ft();return et===null?t.memoizedState=e:Cp(t,et.memoizedState,e)},useTransition:function(){var e=ci(Os)[0],t=Ft().memoizedState;return[e,t]},useMutableSource:dp,useSyncExternalStore:fp,useId:bp,unstable_isNewReconciler:!1};function Bt(e,t){if(e&&e.defaultProps){t=Ge({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Zi(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ge({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ko={isMounted:function(e){return(e=e._reactInternals)?dr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=mt(),s=Dn(e),o=gn(r,s);o.payload=t,n!=null&&(o.callback=n),t=On(e,o,s),t!==null&&(Gt(t,e,s,r),El(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=mt(),s=Dn(e),o=gn(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=On(e,o,s),t!==null&&(Gt(t,e,s,r),El(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=mt(),r=Dn(e),s=gn(n,r);s.tag=2,t!=null&&(s.callback=t),t=On(e,s,r),t!==null&&(Gt(t,e,r,n),El(t,e,r))}};function Tu(e,t,n,r,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,i):t.prototype&&t.prototype.isPureReactComponent?!Rs(n,r)||!Rs(s,o):!0}function _p(e,t,n){var r=!1,s=Hn,o=t.contextType;return typeof o=="object"&&o!==null?o=Ot(o):(s=jt(t)?lr:ft.current,r=t.contextTypes,o=(r=r!=null)?Or(e,s):Hn),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ko,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function $u(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ko.enqueueReplaceState(t,t.state,null)}function ea(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},rc(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Ot(o):(o=jt(t)?lr:ft.current,s.context=Or(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Zi(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ko.enqueueReplaceState(s,s.state,null),Xl(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Br(e,t){try{var n="",r=t;do n+=Fh(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function ui(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ta(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var fy=typeof WeakMap=="function"?WeakMap:Map;function Rp(e,t,n){n=gn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){no||(no=!0,da=r),ta(e,t)},n}function Ip(e,t,n){n=gn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){ta(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){ta(e,t),typeof r!="function"&&(Fn===null?Fn=new Set([this]):Fn.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function Mu(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new fy;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=by.bind(null,e,t,n),t.then(e,e))}function Ou(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Fu(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=gn(-1,1),t.tag=2,On(n,t,1))),n.lanes|=1),e)}var py=Sn.ReactCurrentOwner,xt=!1;function pt(e,t,n,r){t.child=e===null?ip(t,null,n,r):Dr(t,e.child,n,r)}function Du(e,t,n,r,s){n=n.render;var o=t.ref;return zr(t,s),r=ac(e,t,n,r,o,s),n=cc(),e!==null&&!xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,jn(e,t,s)):(Ue&&n&&qa(t),t.flags|=1,pt(e,t,r,s),t.child)}function Uu(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!xc(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,zp(e,t,o,r,s)):(e=zl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Rs,n(i,r)&&e.ref===t.ref)return jn(e,t,s)}return t.flags|=1,e=Un(o,r),e.ref=t.ref,e.return=t,t.child=e}function zp(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(Rs(o,r)&&e.ref===t.ref)if(xt=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(xt=!0);else return t.lanes=e.lanes,jn(e,t,s)}return na(e,t,n,r,s)}function Ap(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Me(Lr,Ct),Ct|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Me(Lr,Ct),Ct|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Me(Lr,Ct),Ct|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Me(Lr,Ct),Ct|=r;return pt(e,t,s,n),t.child}function Tp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function na(e,t,n,r,s){var o=jt(n)?lr:ft.current;return o=Or(t,o),zr(t,s),n=ac(e,t,n,r,o,s),r=cc(),e!==null&&!xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,jn(e,t,s)):(Ue&&r&&qa(t),t.flags|=1,pt(e,t,n,s),t.child)}function Bu(e,t,n,r,s){if(jt(n)){var o=!0;Gl(t)}else o=!1;if(zr(t,s),t.stateNode===null)_l(e,t),_p(t,n,r),ea(t,n,r,s),r=!0;else if(e===null){var i=t.stateNode,a=t.memoizedProps;i.props=a;var u=i.context,d=n.contextType;typeof d=="object"&&d!==null?d=Ot(d):(d=jt(n)?lr:ft.current,d=Or(t,d));var y=n.getDerivedStateFromProps,g=typeof y=="function"||typeof i.getSnapshotBeforeUpdate=="function";g||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||u!==d)&&$u(t,i,r,d),Ln=!1;var h=t.memoizedState;i.state=h,Xl(t,r,i,s),u=t.memoizedState,a!==r||h!==u||wt.current||Ln?(typeof y=="function"&&(Zi(t,n,y,r),u=t.memoizedState),(a=Ln||Tu(t,n,a,r,h,u,d))?(g||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),i.props=r,i.state=u,i.context=d,r=a):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,cp(e,t),a=t.memoizedProps,d=t.type===t.elementType?a:Bt(t.type,a),i.props=d,g=t.pendingProps,h=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Ot(u):(u=jt(n)?lr:ft.current,u=Or(t,u));var v=n.getDerivedStateFromProps;(y=typeof v=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==g||h!==u)&&$u(t,i,r,u),Ln=!1,h=t.memoizedState,i.state=h,Xl(t,r,i,s);var w=t.memoizedState;a!==g||h!==w||wt.current||Ln?(typeof v=="function"&&(Zi(t,n,v,r),w=t.memoizedState),(d=Ln||Tu(t,n,d,r,h,w,u)||!1)?(y||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,w,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,w,u)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),i.props=r,i.state=w,i.context=u,r=d):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return ra(e,t,n,r,o,s)}function ra(e,t,n,r,s,o){Tp(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return s&&Eu(t,n,!1),jn(e,t,o);r=t.stateNode,py.current=t;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Dr(t,e.child,null,o),t.child=Dr(t,null,a,o)):pt(e,t,a,o),t.memoizedState=r.state,s&&Eu(t,n,!0),t.child}function $p(e){var t=e.stateNode;t.pendingContext?bu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&bu(e,t.context,!1),sc(e,t.containerInfo)}function Vu(e,t,n,r,s){return Fr(),Ja(s),t.flags|=256,pt(e,t,n,r),t.child}var sa={dehydrated:null,treeContext:null,retryLane:0};function la(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mp(e,t,n){var r=t.pendingProps,s=Ve.current,o=!1,i=(t.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Me(Ve,s&1),e===null)return Xi(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,o?(r=t.mode,o=t.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Eo(i,r,0,null),e=sr(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=la(n),t.memoizedState=sa,e):fc(t,i));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return my(e,t,i,r,a,s,n);if(o){o=r.fallback,i=t.mode,s=e.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Un(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Un(a,o):(o=sr(o,i,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,i=e.child.memoizedState,i=i===null?la(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~n,t.memoizedState=sa,r}return o=e.child,e=o.sibling,r=Un(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function fc(e,t){return t=Eo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function hl(e,t,n,r){return r!==null&&Ja(r),Dr(t,e.child,null,n),e=fc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function my(e,t,n,r,s,o,i){if(n)return t.flags&256?(t.flags&=-257,r=ui(Error(q(422))),hl(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=Eo({mode:"visible",children:r.children},s,0,null),o=sr(o,s,i,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Dr(t,e.child,null,i),t.child.memoizedState=la(i),t.memoizedState=sa,o);if(!(t.mode&1))return hl(e,t,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(q(419)),r=ui(o,r,void 0),hl(e,t,i,r)}if(a=(i&e.childLanes)!==0,xt||a){if(r=lt,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,wn(e,s),Gt(r,e,s,-1))}return vc(),r=ui(Error(q(421))),hl(e,t,i,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Ey.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,Et=Mn(s.nextSibling),Lt=t,Ue=!0,Wt=null,e!==null&&(At[Tt++]=pn,At[Tt++]=mn,At[Tt++]=or,pn=e.id,mn=e.overflow,or=t),t=fc(t,r.children),t.flags|=4096,t)}function Wu(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ji(e.return,t,n)}function di(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function Op(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(pt(e,t,r.children,n),r=Ve.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Wu(e,n,t);else if(e.tag===19)Wu(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Me(Ve,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Jl(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),di(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Jl(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}di(t,!0,n,null,o);break;case"together":di(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function _l(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function jn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ar|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(q(153));if(t.child!==null){for(e=t.child,n=Un(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Un(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function hy(e,t,n){switch(t.tag){case 3:$p(t),Fr();break;case 5:up(t);break;case 1:jt(t.type)&&Gl(t);break;case 4:sc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Me(Yl,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Me(Ve,Ve.current&1),t.flags|=128,null):n&t.child.childLanes?Mp(e,t,n):(Me(Ve,Ve.current&1),e=jn(e,t,n),e!==null?e.sibling:null);Me(Ve,Ve.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Op(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Me(Ve,Ve.current),r)break;return null;case 22:case 23:return t.lanes=0,Ap(e,t,n)}return jn(e,t,n)}var Fp,oa,Dp,Up;Fp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};oa=function(){};Dp=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,nr(ln.current);var o=null;switch(n){case"input":s=Li(e,s),r=Li(e,r),o=[];break;case"select":s=Ge({},s,{value:void 0}),r=Ge({},r,{value:void 0}),o=[];break;case"textarea":s=Ri(e,s),r=Ri(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Wl)}zi(n,r);var i;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ks.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var u=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==a&&(u!=null||a!=null))if(d==="style")if(a){for(i in a)!a.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&a[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(o||(o=[]),o.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ks.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Fe("scroll",e),o||a===u||(o=[])):(o=o||[]).push(d,u))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};Up=function(e,t,n,r){n!==r&&(t.flags|=4)};function ss(e,t){if(!Ue)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ut(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function gy(e,t,n){var r=t.pendingProps;switch(Xa(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(t),null;case 1:return jt(t.type)&&Hl(),ut(t),null;case 3:return r=t.stateNode,Ur(),De(wt),De(ft),oc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(pl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Wt!==null&&(ma(Wt),Wt=null))),oa(e,t),ut(t),null;case 5:lc(t);var s=nr($s.current);if(n=t.type,e!==null&&t.stateNode!=null)Dp(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(q(166));return ut(t),null}if(e=nr(ln.current),pl(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Zt]=t,r[As]=o,e=(t.mode&1)!==0,n){case"dialog":Fe("cancel",r),Fe("close",r);break;case"iframe":case"object":case"embed":Fe("load",r);break;case"video":case"audio":for(s=0;s<us.length;s++)Fe(us[s],r);break;case"source":Fe("error",r);break;case"img":case"image":case"link":Fe("error",r),Fe("load",r);break;case"details":Fe("toggle",r);break;case"input":Zc(r,o),Fe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Fe("invalid",r);break;case"textarea":tu(r,o),Fe("invalid",r)}zi(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&fl(r.textContent,a,e),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&fl(r.textContent,a,e),s=["children",""+a]):ks.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Fe("scroll",r)}switch(n){case"input":sl(r),eu(r,o,!0);break;case"textarea":sl(r),nu(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Wl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=hf(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[Zt]=t,e[As]=r,Fp(e,t,!1,!1),t.stateNode=e;e:{switch(i=Ai(n,r),n){case"dialog":Fe("cancel",e),Fe("close",e),s=r;break;case"iframe":case"object":case"embed":Fe("load",e),s=r;break;case"video":case"audio":for(s=0;s<us.length;s++)Fe(us[s],e);s=r;break;case"source":Fe("error",e),s=r;break;case"img":case"image":case"link":Fe("error",e),Fe("load",e),s=r;break;case"details":Fe("toggle",e),s=r;break;case"input":Zc(e,r),s=Li(e,r),Fe("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Ge({},r,{value:void 0}),Fe("invalid",e);break;case"textarea":tu(e,r),s=Ri(e,r),Fe("invalid",e);break;default:s=r}zi(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="style"?vf(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&gf(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Cs(e,u):typeof u=="number"&&Cs(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ks.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Fe("scroll",e):u!=null&&$a(e,o,u,i))}switch(n){case"input":sl(e),eu(e,r,!1);break;case"textarea":sl(e),nu(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Wn(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Pr(e,!!r.multiple,o,!1):r.defaultValue!=null&&Pr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Wl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ut(t),null;case 6:if(e&&t.stateNode!=null)Up(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(q(166));if(n=nr($s.current),nr(ln.current),pl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Zt]=t,(o=r.nodeValue!==n)&&(e=Lt,e!==null))switch(e.tag){case 3:fl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&fl(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Zt]=t,t.stateNode=r}return ut(t),null;case 13:if(De(Ve),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ue&&Et!==null&&t.mode&1&&!(t.flags&128))lp(),Fr(),t.flags|=98560,o=!1;else if(o=pl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(q(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(q(317));o[Zt]=t}else Fr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ut(t),o=!1}else Wt!==null&&(ma(Wt),Wt=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ve.current&1?tt===0&&(tt=3):vc())),t.updateQueue!==null&&(t.flags|=4),ut(t),null);case 4:return Ur(),oa(e,t),e===null&&Is(t.stateNode.containerInfo),ut(t),null;case 10:return tc(t.type._context),ut(t),null;case 17:return jt(t.type)&&Hl(),ut(t),null;case 19:if(De(Ve),o=t.memoizedState,o===null)return ut(t),null;if(r=(t.flags&128)!==0,i=o.rendering,i===null)if(r)ss(o,!1);else{if(tt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Jl(e),i!==null){for(t.flags|=128,ss(o,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Me(Ve,Ve.current&1|2),t.child}e=e.sibling}o.tail!==null&&Qe()>Vr&&(t.flags|=128,r=!0,ss(o,!1),t.lanes=4194304)}else{if(!r)if(e=Jl(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ss(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Ue)return ut(t),null}else 2*Qe()-o.renderingStartTime>Vr&&n!==1073741824&&(t.flags|=128,r=!0,ss(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(n=o.last,n!==null?n.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=Ve.current,Me(Ve,r?n&1|2:n&1),t):(ut(t),null);case 22:case 23:return yc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ct&1073741824&&(ut(t),t.subtreeFlags&6&&(t.flags|=8192)):ut(t),null;case 24:return null;case 25:return null}throw Error(q(156,t.tag))}function yy(e,t){switch(Xa(t),t.tag){case 1:return jt(t.type)&&Hl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ur(),De(wt),De(ft),oc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lc(t),null;case 13:if(De(Ve),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(q(340));Fr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return De(Ve),null;case 4:return Ur(),null;case 10:return tc(t.type._context),null;case 22:case 23:return yc(),null;case 24:return null;default:return null}}var gl=!1,dt=!1,vy=typeof WeakSet=="function"?WeakSet:Set,ce=null;function Er(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ke(e,t,r)}else n.current=null}function ia(e,t,n){try{n()}catch(r){Ke(e,t,r)}}var Hu=!1;function xy(e,t){if(Wi=Ul,e=Gf(),Ya(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,u=-1,d=0,y=0,g=e,h=null;t:for(;;){for(var v;g!==n||s!==0&&g.nodeType!==3||(a=i+s),g!==o||r!==0&&g.nodeType!==3||(u=i+r),g.nodeType===3&&(i+=g.nodeValue.length),(v=g.firstChild)!==null;)h=g,g=v;for(;;){if(g===e)break t;if(h===n&&++d===s&&(a=i),h===o&&++y===r&&(u=i),(v=g.nextSibling)!==null)break;g=h,h=g.parentNode}g=v}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Hi={focusedElem:e,selectionRange:n},Ul=!1,ce=t;ce!==null;)if(t=ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ce=e;else for(;ce!==null;){t=ce;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var k=w.memoizedProps,S=w.memoizedState,p=t.stateNode,f=p.getSnapshotBeforeUpdate(t.elementType===t.type?k:Bt(t.type,k),S);p.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(j){Ke(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,ce=e;break}ce=t.return}return w=Hu,Hu=!1,w}function xs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&ia(t,n,o)}s=s.next}while(s!==r)}}function Co(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function aa(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Bp(e){var t=e.alternate;t!==null&&(e.alternate=null,Bp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Zt],delete t[As],delete t[Qi],delete t[ty],delete t[ny])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Vp(e){return e.tag===5||e.tag===3||e.tag===4}function Gu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Vp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ca(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Wl));else if(r!==4&&(e=e.child,e!==null))for(ca(e,t,n),e=e.sibling;e!==null;)ca(e,t,n),e=e.sibling}function ua(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ua(e,t,n),e=e.sibling;e!==null;)ua(e,t,n),e=e.sibling}var ot=null,Vt=!1;function bn(e,t,n){for(n=n.child;n!==null;)Wp(e,t,n),n=n.sibling}function Wp(e,t,n){if(sn&&typeof sn.onCommitFiberUnmount=="function")try{sn.onCommitFiberUnmount(yo,n)}catch{}switch(n.tag){case 5:dt||Er(n,t);case 6:var r=ot,s=Vt;ot=null,bn(e,t,n),ot=r,Vt=s,ot!==null&&(Vt?(e=ot,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ot.removeChild(n.stateNode));break;case 18:ot!==null&&(Vt?(e=ot,n=n.stateNode,e.nodeType===8?si(e.parentNode,n):e.nodeType===1&&si(e,n),Ps(e)):si(ot,n.stateNode));break;case 4:r=ot,s=Vt,ot=n.stateNode.containerInfo,Vt=!0,bn(e,t,n),ot=r,Vt=s;break;case 0:case 11:case 14:case 15:if(!dt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&ia(n,t,i),s=s.next}while(s!==r)}bn(e,t,n);break;case 1:if(!dt&&(Er(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ke(n,t,a)}bn(e,t,n);break;case 21:bn(e,t,n);break;case 22:n.mode&1?(dt=(r=dt)||n.memoizedState!==null,bn(e,t,n),dt=r):bn(e,t,n);break;default:bn(e,t,n)}}function Ku(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new vy),t.forEach(function(r){var s=Ly.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Dt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,i=t,a=i;e:for(;a!==null;){switch(a.tag){case 5:ot=a.stateNode,Vt=!1;break e;case 3:ot=a.stateNode.containerInfo,Vt=!0;break e;case 4:ot=a.stateNode.containerInfo,Vt=!0;break e}a=a.return}if(ot===null)throw Error(q(160));Wp(o,i,s),ot=null,Vt=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ke(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Hp(t,e),t=t.sibling}function Hp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Dt(t,e),Xt(e),r&4){try{xs(3,e,e.return),Co(3,e)}catch(k){Ke(e,e.return,k)}try{xs(5,e,e.return)}catch(k){Ke(e,e.return,k)}}break;case 1:Dt(t,e),Xt(e),r&512&&n!==null&&Er(n,n.return);break;case 5:if(Dt(t,e),Xt(e),r&512&&n!==null&&Er(n,n.return),e.flags&32){var s=e.stateNode;try{Cs(s,"")}catch(k){Ke(e,e.return,k)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=n!==null?n.memoizedProps:o,a=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&pf(s,o),Ai(a,i);var d=Ai(a,o);for(i=0;i<u.length;i+=2){var y=u[i],g=u[i+1];y==="style"?vf(s,g):y==="dangerouslySetInnerHTML"?gf(s,g):y==="children"?Cs(s,g):$a(s,y,g,d)}switch(a){case"input":Pi(s,o);break;case"textarea":mf(s,o);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var v=o.value;v!=null?Pr(s,!!o.multiple,v,!1):h!==!!o.multiple&&(o.defaultValue!=null?Pr(s,!!o.multiple,o.defaultValue,!0):Pr(s,!!o.multiple,o.multiple?[]:"",!1))}s[As]=o}catch(k){Ke(e,e.return,k)}}break;case 6:if(Dt(t,e),Xt(e),r&4){if(e.stateNode===null)throw Error(q(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(k){Ke(e,e.return,k)}}break;case 3:if(Dt(t,e),Xt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ps(t.containerInfo)}catch(k){Ke(e,e.return,k)}break;case 4:Dt(t,e),Xt(e);break;case 13:Dt(t,e),Xt(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(hc=Qe())),r&4&&Ku(e);break;case 22:if(y=n!==null&&n.memoizedState!==null,e.mode&1?(dt=(d=dt)||y,Dt(t,e),dt=d):Dt(t,e),Xt(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!y&&e.mode&1)for(ce=e,y=e.child;y!==null;){for(g=ce=y;ce!==null;){switch(h=ce,v=h.child,h.tag){case 0:case 11:case 14:case 15:xs(4,h,h.return);break;case 1:Er(h,h.return);var w=h.stateNode;if(typeof w.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(k){Ke(r,n,k)}}break;case 5:Er(h,h.return);break;case 22:if(h.memoizedState!==null){Yu(g);continue}}v!==null?(v.return=h,ce=v):Yu(g)}y=y.sibling}e:for(y=null,g=e;;){if(g.tag===5){if(y===null){y=g;try{s=g.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=g.stateNode,u=g.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=yf("display",i))}catch(k){Ke(e,e.return,k)}}}else if(g.tag===6){if(y===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(k){Ke(e,e.return,k)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;y===g&&(y=null),g=g.return}y===g&&(y=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Dt(t,e),Xt(e),r&4&&Ku(e);break;case 21:break;default:Dt(t,e),Xt(e)}}function Xt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Vp(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Cs(s,""),r.flags&=-33);var o=Gu(e);ua(e,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=Gu(e);ca(e,a,i);break;default:throw Error(q(161))}}catch(u){Ke(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function wy(e,t,n){ce=e,Gp(e)}function Gp(e,t,n){for(var r=(e.mode&1)!==0;ce!==null;){var s=ce,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||gl;if(!i){var a=s.alternate,u=a!==null&&a.memoizedState!==null||dt;a=gl;var d=dt;if(gl=i,(dt=u)&&!d)for(ce=s;ce!==null;)i=ce,u=i.child,i.tag===22&&i.memoizedState!==null?qu(s):u!==null?(u.return=i,ce=u):qu(s);for(;o!==null;)ce=o,Gp(o),o=o.sibling;ce=s,gl=a,dt=d}Qu(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,ce=o):Qu(e)}}function Qu(e){for(;ce!==null;){var t=ce;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dt||Co(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!dt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Bt(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Iu(t,o,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Iu(t,i,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var y=d.memoizedState;if(y!==null){var g=y.dehydrated;g!==null&&Ps(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}dt||t.flags&512&&aa(t)}catch(h){Ke(t,t.return,h)}}if(t===e){ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,ce=n;break}ce=t.return}}function Yu(e){for(;ce!==null;){var t=ce;if(t===e){ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ce=n;break}ce=t.return}}function qu(e){for(;ce!==null;){var t=ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Co(4,t)}catch(u){Ke(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){Ke(t,s,u)}}var o=t.return;try{aa(t)}catch(u){Ke(t,o,u)}break;case 5:var i=t.return;try{aa(t)}catch(u){Ke(t,i,u)}}}catch(u){Ke(t,t.return,u)}if(t===e){ce=null;break}var a=t.sibling;if(a!==null){a.return=t.return,ce=a;break}ce=t.return}}var jy=Math.ceil,to=Sn.ReactCurrentDispatcher,pc=Sn.ReactCurrentOwner,Mt=Sn.ReactCurrentBatchConfig,Pe=0,lt=null,Ye=null,it=0,Ct=0,Lr=Qn(0),tt=0,Ds=null,ar=0,bo=0,mc=0,ws=null,vt=null,hc=0,Vr=1/0,cn=null,no=!1,da=null,Fn=null,yl=!1,In=null,ro=0,js=0,fa=null,Rl=-1,Il=0;function mt(){return Pe&6?Qe():Rl!==-1?Rl:Rl=Qe()}function Dn(e){return e.mode&1?Pe&2&&it!==0?it&-it:sy.transition!==null?(Il===0&&(Il=_f()),Il):(e=Ie,e!==0||(e=window.event,e=e===void 0?16:Mf(e.type)),e):1}function Gt(e,t,n,r){if(50<js)throw js=0,fa=null,Error(q(185));Ws(e,n,r),(!(Pe&2)||e!==lt)&&(e===lt&&(!(Pe&2)&&(bo|=n),tt===4&&_n(e,it)),St(e,r),n===1&&Pe===0&&!(t.mode&1)&&(Vr=Qe()+500,So&&Yn()))}function St(e,t){var n=e.callbackNode;sg(e,t);var r=Dl(e,e===lt?it:0);if(r===0)n!==null&&lu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&lu(n),t===1)e.tag===0?ry(Xu.bind(null,e)):np(Xu.bind(null,e)),Zg(function(){!(Pe&6)&&Yn()}),n=null;else{switch(Rf(r)){case 1:n=Ua;break;case 4:n=Lf;break;case 16:n=Fl;break;case 536870912:n=Pf;break;default:n=Fl}n=em(n,Kp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Kp(e,t){if(Rl=-1,Il=0,Pe&6)throw Error(q(327));var n=e.callbackNode;if(Ar()&&e.callbackNode!==n)return null;var r=Dl(e,e===lt?it:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=so(e,r);else{t=r;var s=Pe;Pe|=2;var o=Yp();(lt!==e||it!==t)&&(cn=null,Vr=Qe()+500,rr(e,t));do try{ky();break}catch(a){Qp(e,a)}while(!0);ec(),to.current=o,Pe=s,Ye!==null?t=0:(lt=null,it=0,t=tt)}if(t!==0){if(t===2&&(s=Fi(e),s!==0&&(r=s,t=pa(e,s))),t===1)throw n=Ds,rr(e,0),_n(e,r),St(e,Qe()),n;if(t===6)_n(e,r);else{if(s=e.current.alternate,!(r&30)&&!Sy(s)&&(t=so(e,r),t===2&&(o=Fi(e),o!==0&&(r=o,t=pa(e,o))),t===1))throw n=Ds,rr(e,0),_n(e,r),St(e,Qe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(q(345));case 2:Jn(e,vt,cn);break;case 3:if(_n(e,r),(r&130023424)===r&&(t=hc+500-Qe(),10<t)){if(Dl(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){mt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Ki(Jn.bind(null,e,vt,cn),t);break}Jn(e,vt,cn);break;case 4:if(_n(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var i=31-Ht(r);o=1<<i,i=t[i],i>s&&(s=i),r&=~o}if(r=s,r=Qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jy(r/1960))-r,10<r){e.timeoutHandle=Ki(Jn.bind(null,e,vt,cn),r);break}Jn(e,vt,cn);break;case 5:Jn(e,vt,cn);break;default:throw Error(q(329))}}}return St(e,Qe()),e.callbackNode===n?Kp.bind(null,e):null}function pa(e,t){var n=ws;return e.current.memoizedState.isDehydrated&&(rr(e,t).flags|=256),e=so(e,t),e!==2&&(t=vt,vt=n,t!==null&&ma(t)),e}function ma(e){vt===null?vt=e:vt.push.apply(vt,e)}function Sy(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!Kt(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function _n(e,t){for(t&=~mc,t&=~bo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ht(t),r=1<<n;e[n]=-1,t&=~r}}function Xu(e){if(Pe&6)throw Error(q(327));Ar();var t=Dl(e,0);if(!(t&1))return St(e,Qe()),null;var n=so(e,t);if(e.tag!==0&&n===2){var r=Fi(e);r!==0&&(t=r,n=pa(e,r))}if(n===1)throw n=Ds,rr(e,0),_n(e,t),St(e,Qe()),n;if(n===6)throw Error(q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Jn(e,vt,cn),St(e,Qe()),null}function gc(e,t){var n=Pe;Pe|=1;try{return e(t)}finally{Pe=n,Pe===0&&(Vr=Qe()+500,So&&Yn())}}function cr(e){In!==null&&In.tag===0&&!(Pe&6)&&Ar();var t=Pe;Pe|=1;var n=Mt.transition,r=Ie;try{if(Mt.transition=null,Ie=1,e)return e()}finally{Ie=r,Mt.transition=n,Pe=t,!(Pe&6)&&Yn()}}function yc(){Ct=Lr.current,De(Lr)}function rr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Jg(n)),Ye!==null)for(n=Ye.return;n!==null;){var r=n;switch(Xa(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Hl();break;case 3:Ur(),De(wt),De(ft),oc();break;case 5:lc(r);break;case 4:Ur();break;case 13:De(Ve);break;case 19:De(Ve);break;case 10:tc(r.type._context);break;case 22:case 23:yc()}n=n.return}if(lt=e,Ye=e=Un(e.current,null),it=Ct=t,tt=0,Ds=null,mc=bo=ar=0,vt=ws=null,tr!==null){for(t=0;t<tr.length;t++)if(n=tr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}tr=null}return e}function Qp(e,t){do{var n=Ye;try{if(ec(),Ll.current=eo,Zl){for(var r=We.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Zl=!1}if(ir=0,st=et=We=null,vs=!1,Ms=0,pc.current=null,n===null||n.return===null){tt=1,Ds=t,Ye=null;break}e:{var o=e,i=n.return,a=n,u=t;if(t=it,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,y=a,g=y.tag;if(!(y.mode&1)&&(g===0||g===11||g===15)){var h=y.alternate;h?(y.updateQueue=h.updateQueue,y.memoizedState=h.memoizedState,y.lanes=h.lanes):(y.updateQueue=null,y.memoizedState=null)}var v=Ou(i);if(v!==null){v.flags&=-257,Fu(v,i,a,o,t),v.mode&1&&Mu(o,d,t),t=v,u=d;var w=t.updateQueue;if(w===null){var k=new Set;k.add(u),t.updateQueue=k}else w.add(u);break e}else{if(!(t&1)){Mu(o,d,t),vc();break e}u=Error(q(426))}}else if(Ue&&a.mode&1){var S=Ou(i);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Fu(S,i,a,o,t),Ja(Br(u,a));break e}}o=u=Br(u,a),tt!==4&&(tt=2),ws===null?ws=[o]:ws.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var p=Rp(o,u,t);Ru(o,p);break e;case 1:a=u;var f=o.type,m=o.stateNode;if(!(o.flags&128)&&(typeof f.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Fn===null||!Fn.has(m)))){o.flags|=65536,t&=-t,o.lanes|=t;var j=Ip(o,a,t);Ru(o,j);break e}}o=o.return}while(o!==null)}Xp(n)}catch(b){t=b,Ye===n&&n!==null&&(Ye=n=n.return);continue}break}while(!0)}function Yp(){var e=to.current;return to.current=eo,e===null?eo:e}function vc(){(tt===0||tt===3||tt===2)&&(tt=4),lt===null||!(ar&268435455)&&!(bo&268435455)||_n(lt,it)}function so(e,t){var n=Pe;Pe|=2;var r=Yp();(lt!==e||it!==t)&&(cn=null,rr(e,t));do try{Ny();break}catch(s){Qp(e,s)}while(!0);if(ec(),Pe=n,to.current=r,Ye!==null)throw Error(q(261));return lt=null,it=0,tt}function Ny(){for(;Ye!==null;)qp(Ye)}function ky(){for(;Ye!==null&&!Yh();)qp(Ye)}function qp(e){var t=Zp(e.alternate,e,Ct);e.memoizedProps=e.pendingProps,t===null?Xp(e):Ye=t,pc.current=null}function Xp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=yy(n,t),n!==null){n.flags&=32767,Ye=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tt=6,Ye=null;return}}else if(n=gy(n,t,Ct),n!==null){Ye=n;return}if(t=t.sibling,t!==null){Ye=t;return}Ye=t=e}while(t!==null);tt===0&&(tt=5)}function Jn(e,t,n){var r=Ie,s=Mt.transition;try{Mt.transition=null,Ie=1,Cy(e,t,n,r)}finally{Mt.transition=s,Ie=r}return null}function Cy(e,t,n,r){do Ar();while(In!==null);if(Pe&6)throw Error(q(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(q(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(lg(e,o),e===lt&&(Ye=lt=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||yl||(yl=!0,em(Fl,function(){return Ar(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Mt.transition,Mt.transition=null;var i=Ie;Ie=1;var a=Pe;Pe|=4,pc.current=null,xy(e,n),Hp(n,e),Hg(Hi),Ul=!!Wi,Hi=Wi=null,e.current=n,wy(n),qh(),Pe=a,Ie=i,Mt.transition=o}else e.current=n;if(yl&&(yl=!1,In=e,ro=s),o=e.pendingLanes,o===0&&(Fn=null),Zh(n.stateNode),St(e,Qe()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(no)throw no=!1,e=da,da=null,e;return ro&1&&e.tag!==0&&Ar(),o=e.pendingLanes,o&1?e===fa?js++:(js=0,fa=e):js=0,Yn(),null}function Ar(){if(In!==null){var e=Rf(ro),t=Mt.transition,n=Ie;try{if(Mt.transition=null,Ie=16>e?16:e,In===null)var r=!1;else{if(e=In,In=null,ro=0,Pe&6)throw Error(q(331));var s=Pe;for(Pe|=4,ce=e.current;ce!==null;){var o=ce,i=o.child;if(ce.flags&16){var a=o.deletions;if(a!==null){for(var u=0;u<a.length;u++){var d=a[u];for(ce=d;ce!==null;){var y=ce;switch(y.tag){case 0:case 11:case 15:xs(8,y,o)}var g=y.child;if(g!==null)g.return=y,ce=g;else for(;ce!==null;){y=ce;var h=y.sibling,v=y.return;if(Bp(y),y===d){ce=null;break}if(h!==null){h.return=v,ce=h;break}ce=v}}}var w=o.alternate;if(w!==null){var k=w.child;if(k!==null){w.child=null;do{var S=k.sibling;k.sibling=null,k=S}while(k!==null)}}ce=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,ce=i;else e:for(;ce!==null;){if(o=ce,o.flags&2048)switch(o.tag){case 0:case 11:case 15:xs(9,o,o.return)}var p=o.sibling;if(p!==null){p.return=o.return,ce=p;break e}ce=o.return}}var f=e.current;for(ce=f;ce!==null;){i=ce;var m=i.child;if(i.subtreeFlags&2064&&m!==null)m.return=i,ce=m;else e:for(i=f;ce!==null;){if(a=ce,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Co(9,a)}}catch(b){Ke(a,a.return,b)}if(a===i){ce=null;break e}var j=a.sibling;if(j!==null){j.return=a.return,ce=j;break e}ce=a.return}}if(Pe=s,Yn(),sn&&typeof sn.onPostCommitFiberRoot=="function")try{sn.onPostCommitFiberRoot(yo,e)}catch{}r=!0}return r}finally{Ie=n,Mt.transition=t}}return!1}function Ju(e,t,n){t=Br(n,t),t=Rp(e,t,1),e=On(e,t,1),t=mt(),e!==null&&(Ws(e,1,t),St(e,t))}function Ke(e,t,n){if(e.tag===3)Ju(e,e,n);else for(;t!==null;){if(t.tag===3){Ju(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fn===null||!Fn.has(r))){e=Br(n,e),e=Ip(t,e,1),t=On(t,e,1),e=mt(),t!==null&&(Ws(t,1,e),St(t,e));break}}t=t.return}}function by(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=mt(),e.pingedLanes|=e.suspendedLanes&n,lt===e&&(it&n)===n&&(tt===4||tt===3&&(it&130023424)===it&&500>Qe()-hc?rr(e,0):mc|=n),St(e,t)}function Jp(e,t){t===0&&(e.mode&1?(t=il,il<<=1,!(il&130023424)&&(il=4194304)):t=1);var n=mt();e=wn(e,t),e!==null&&(Ws(e,t,n),St(e,n))}function Ey(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Jp(e,n)}function Ly(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(t),Jp(e,n)}var Zp;Zp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||wt.current)xt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return xt=!1,hy(e,t,n);xt=!!(e.flags&131072)}else xt=!1,Ue&&t.flags&1048576&&rp(t,Ql,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;_l(e,t),e=t.pendingProps;var s=Or(t,ft.current);zr(t,n),s=ac(null,t,r,e,s,n);var o=cc();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,jt(r)?(o=!0,Gl(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,rc(t),s.updater=ko,t.stateNode=s,s._reactInternals=t,ea(t,r,e,n),t=ra(null,t,r,!0,o,n)):(t.tag=0,Ue&&o&&qa(t),pt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(_l(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=_y(r),e=Bt(r,e),s){case 0:t=na(null,t,r,e,n);break e;case 1:t=Bu(null,t,r,e,n);break e;case 11:t=Du(null,t,r,e,n);break e;case 14:t=Uu(null,t,r,Bt(r.type,e),n);break e}throw Error(q(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Bt(r,s),na(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Bt(r,s),Bu(e,t,r,s,n);case 3:e:{if($p(t),e===null)throw Error(q(387));r=t.pendingProps,o=t.memoizedState,s=o.element,cp(e,t),Xl(t,r,null,n);var i=t.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Br(Error(q(423)),t),t=Vu(e,t,r,n,s);break e}else if(r!==s){s=Br(Error(q(424)),t),t=Vu(e,t,r,n,s);break e}else for(Et=Mn(t.stateNode.containerInfo.firstChild),Lt=t,Ue=!0,Wt=null,n=ip(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Fr(),r===s){t=jn(e,t,n);break e}pt(e,t,r,n)}t=t.child}return t;case 5:return up(t),e===null&&Xi(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,Gi(r,s)?i=null:o!==null&&Gi(r,o)&&(t.flags|=32),Tp(e,t),pt(e,t,i,n),t.child;case 6:return e===null&&Xi(t),null;case 13:return Mp(e,t,n);case 4:return sc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Dr(t,null,r,n):pt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Bt(r,s),Du(e,t,r,s,n);case 7:return pt(e,t,t.pendingProps,n),t.child;case 8:return pt(e,t,t.pendingProps.children,n),t.child;case 12:return pt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,Me(Yl,r._currentValue),r._currentValue=i,o!==null)if(Kt(o.value,i)){if(o.children===s.children&&!wt.current){t=jn(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=gn(-1,n&-n),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var y=d.pending;y===null?u.next=u:(u.next=y.next,y.next=u),d.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Ji(o.return,n,t),a.lanes|=n;break}u=u.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(q(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),Ji(i,n,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}pt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,zr(t,n),s=Ot(s),r=r(s),t.flags|=1,pt(e,t,r,n),t.child;case 14:return r=t.type,s=Bt(r,t.pendingProps),s=Bt(r.type,s),Uu(e,t,r,s,n);case 15:return zp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Bt(r,s),_l(e,t),t.tag=1,jt(r)?(e=!0,Gl(t)):e=!1,zr(t,n),_p(t,r,s),ea(t,r,s,n),ra(null,t,r,!0,e,n);case 19:return Op(e,t,n);case 22:return Ap(e,t,n)}throw Error(q(156,t.tag))};function em(e,t){return Ef(e,t)}function Py(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $t(e,t,n,r){return new Py(e,t,n,r)}function xc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _y(e){if(typeof e=="function")return xc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Oa)return 11;if(e===Fa)return 14}return 2}function Un(e,t){var n=e.alternate;return n===null?(n=$t(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function zl(e,t,n,r,s,o){var i=2;if(r=e,typeof e=="function")xc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case vr:return sr(n.children,s,o,t);case Ma:i=8,s|=8;break;case ki:return e=$t(12,n,t,s|2),e.elementType=ki,e.lanes=o,e;case Ci:return e=$t(13,n,t,s),e.elementType=Ci,e.lanes=o,e;case bi:return e=$t(19,n,t,s),e.elementType=bi,e.lanes=o,e;case uf:return Eo(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case af:i=10;break e;case cf:i=9;break e;case Oa:i=11;break e;case Fa:i=14;break e;case En:i=16,r=null;break e}throw Error(q(130,e==null?e:typeof e,""))}return t=$t(i,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function sr(e,t,n,r){return e=$t(7,e,r,t),e.lanes=n,e}function Eo(e,t,n,r){return e=$t(22,e,r,t),e.elementType=uf,e.lanes=n,e.stateNode={isHidden:!1},e}function fi(e,t,n){return e=$t(6,e,null,t),e.lanes=n,e}function pi(e,t,n){return t=$t(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ry(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ko(0),this.expirationTimes=Ko(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ko(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function wc(e,t,n,r,s,o,i,a,u){return e=new Ry(e,t,n,a,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=$t(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},rc(o),e}function Iy(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:yr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function tm(e){if(!e)return Hn;e=e._reactInternals;e:{if(dr(e)!==e||e.tag!==1)throw Error(q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(jt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(q(171))}if(e.tag===1){var n=e.type;if(jt(n))return tp(e,n,t)}return t}function nm(e,t,n,r,s,o,i,a,u){return e=wc(n,r,!0,e,s,o,i,a,u),e.context=tm(null),n=e.current,r=mt(),s=Dn(n),o=gn(r,s),o.callback=t??null,On(n,o,s),e.current.lanes=s,Ws(e,s,r),St(e,r),e}function Lo(e,t,n,r){var s=t.current,o=mt(),i=Dn(s);return n=tm(n),t.context===null?t.context=n:t.pendingContext=n,t=gn(o,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=On(s,t,i),e!==null&&(Gt(e,s,i,o),El(e,s,i)),i}function lo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Zu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function jc(e,t){Zu(e,t),(e=e.alternate)&&Zu(e,t)}function zy(){return null}var rm=typeof reportError=="function"?reportError:function(e){console.error(e)};function Sc(e){this._internalRoot=e}Po.prototype.render=Sc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(q(409));Lo(e,t,null,null)};Po.prototype.unmount=Sc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;cr(function(){Lo(null,e,null,null)}),t[xn]=null}};function Po(e){this._internalRoot=e}Po.prototype.unstable_scheduleHydration=function(e){if(e){var t=Af();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pn.length&&t!==0&&t<Pn[n].priority;n++);Pn.splice(n,0,e),n===0&&$f(e)}};function Nc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function _o(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ed(){}function Ay(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var d=lo(i);o.call(d)}}var i=nm(t,r,e,0,null,!1,!1,"",ed);return e._reactRootContainer=i,e[xn]=i.current,Is(e.nodeType===8?e.parentNode:e),cr(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=lo(u);a.call(d)}}var u=wc(e,0,!1,null,null,!1,!1,"",ed);return e._reactRootContainer=u,e[xn]=u.current,Is(e.nodeType===8?e.parentNode:e),cr(function(){Lo(t,u,n,r)}),u}function Ro(e,t,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var u=lo(i);a.call(u)}}Lo(t,i,e,s)}else i=Ay(n,t,e,s,r);return lo(i)}If=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=cs(t.pendingLanes);n!==0&&(Ba(t,n|1),St(t,Qe()),!(Pe&6)&&(Vr=Qe()+500,Yn()))}break;case 13:cr(function(){var r=wn(e,1);if(r!==null){var s=mt();Gt(r,e,1,s)}}),jc(e,1)}};Va=function(e){if(e.tag===13){var t=wn(e,134217728);if(t!==null){var n=mt();Gt(t,e,134217728,n)}jc(e,134217728)}};zf=function(e){if(e.tag===13){var t=Dn(e),n=wn(e,t);if(n!==null){var r=mt();Gt(n,e,t,r)}jc(e,t)}};Af=function(){return Ie};Tf=function(e,t){var n=Ie;try{return Ie=e,t()}finally{Ie=n}};$i=function(e,t,n){switch(t){case"input":if(Pi(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=jo(r);if(!s)throw Error(q(90));ff(r),Pi(r,s)}}}break;case"textarea":mf(e,n);break;case"select":t=n.value,t!=null&&Pr(e,!!n.multiple,t,!1)}};jf=gc;Sf=cr;var Ty={usingClientEntryPoint:!1,Events:[Gs,Sr,jo,xf,wf,gc]},ls={findFiberByHostInstance:er,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$y={bundleType:ls.bundleType,version:ls.version,rendererPackageName:ls.rendererPackageName,rendererConfig:ls.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Cf(e),e===null?null:e.stateNode},findFiberByHostInstance:ls.findFiberByHostInstance||zy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{yo=vl.inject($y),sn=vl}catch{}}_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ty;_t.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nc(t))throw Error(q(200));return Iy(e,t,null,n)};_t.createRoot=function(e,t){if(!Nc(e))throw Error(q(299));var n=!1,r="",s=rm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=wc(e,1,!1,null,null,n,!1,r,s),e[xn]=t.current,Is(e.nodeType===8?e.parentNode:e),new Sc(t)};_t.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(q(188)):(e=Object.keys(e).join(","),Error(q(268,e)));return e=Cf(t),e=e===null?null:e.stateNode,e};_t.flushSync=function(e){return cr(e)};_t.hydrate=function(e,t,n){if(!_o(t))throw Error(q(200));return Ro(null,e,t,!0,n)};_t.hydrateRoot=function(e,t,n){if(!Nc(e))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=rm;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=nm(t,null,e,1,n??null,s,!1,o,i),e[xn]=t.current,Is(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Po(t)};_t.render=function(e,t,n){if(!_o(t))throw Error(q(200));return Ro(null,e,t,!1,n)};_t.unmountComponentAtNode=function(e){if(!_o(e))throw Error(q(40));return e._reactRootContainer?(cr(function(){Ro(null,null,e,!1,function(){e._reactRootContainer=null,e[xn]=null})}),!0):!1};_t.unstable_batchedUpdates=gc;_t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!_o(n))throw Error(q(200));if(e==null||e._reactInternals===void 0)throw Error(q(38));return Ro(e,t,n,!1,r)};_t.version="18.3.1-next-f1338f8080-20240426";function sm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sm)}catch(e){console.error(e)}}sm(),rf.exports=_t;var kc=rf.exports,td=kc;Si.createRoot=td.createRoot,Si.hydrateRoot=td.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Us(){return Us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Us.apply(this,arguments)}var zn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(zn||(zn={}));const nd="popstate";function My(e){e===void 0&&(e={});function t(s,o){let{pathname:i="/",search:a="",hash:u=""}=fr(s.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),ha("",{pathname:i,search:a,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){let i=s.document.querySelector("base"),a="";if(i&&i.getAttribute("href")){let u=s.location.href,d=u.indexOf("#");a=d===-1?u:u.slice(0,d)}return a+"#"+(typeof o=="string"?o:oo(o))}function r(s,o){Cc(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return Fy(t,n,r,e)}function He(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Cc(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Oy(){return Math.random().toString(36).substr(2,8)}function rd(e,t){return{usr:e.state,key:e.key,idx:t}}function ha(e,t,n,r){return n===void 0&&(n=null),Us({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?fr(t):t,{state:n,key:t&&t.key||r||Oy()})}function oo(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function fr(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Fy(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,i=s.history,a=zn.Pop,u=null,d=y();d==null&&(d=0,i.replaceState(Us({},i.state,{idx:d}),""));function y(){return(i.state||{idx:null}).idx}function g(){a=zn.Pop;let S=y(),p=S==null?null:S-d;d=S,u&&u({action:a,location:k.location,delta:p})}function h(S,p){a=zn.Push;let f=ha(k.location,S,p);n&&n(f,S),d=y()+1;let m=rd(f,d),j=k.createHref(f);try{i.pushState(m,"",j)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;s.location.assign(j)}o&&u&&u({action:a,location:k.location,delta:1})}function v(S,p){a=zn.Replace;let f=ha(k.location,S,p);n&&n(f,S),d=y();let m=rd(f,d),j=k.createHref(f);i.replaceState(m,"",j),o&&u&&u({action:a,location:k.location,delta:0})}function w(S){let p=s.location.origin!=="null"?s.location.origin:s.location.href,f=typeof S=="string"?S:oo(S);return f=f.replace(/ $/,"%20"),He(p,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,p)}let k={get action(){return a},get location(){return e(s,i)},listen(S){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(nd,g),u=S,()=>{s.removeEventListener(nd,g),u=null}},createHref(S){return t(s,S)},createURL:w,encodeLocation(S){let p=w(S);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:h,replace:v,go(S){return i.go(S)}};return k}var sd;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(sd||(sd={}));function Dy(e,t,n){return n===void 0&&(n="/"),Uy(e,t,n)}function Uy(e,t,n,r){let s=typeof t=="string"?fr(t):t,o=Wr(s.pathname||"/",n);if(o==null)return null;let i=lm(e);By(i);let a=null;for(let u=0;a==null&&u<i.length;++u){let d=Zy(o);a=Xy(i[u],d)}return a}function lm(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,i,a)=>{let u={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};u.relativePath.startsWith("/")&&(He(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=Bn([r,u.relativePath]),y=n.concat(u);o.children&&o.children.length>0&&(He(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),lm(o.children,t,y,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:Yy(d,o.index),routesMeta:y})};return e.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))s(o,i);else for(let u of om(o.path))s(o,i,u)}),t}function om(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let i=om(r.join("/")),a=[];return a.push(...i.map(u=>u===""?o:[o,u].join("/"))),s&&a.push(...i),a.map(u=>e.startsWith("/")&&u===""?"/":u)}function By(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:qy(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Vy=/^:[\w-]+$/,Wy=3,Hy=2,Gy=1,Ky=10,Qy=-2,ld=e=>e==="*";function Yy(e,t){let n=e.split("/"),r=n.length;return n.some(ld)&&(r+=Qy),t&&(r+=Hy),n.filter(s=>!ld(s)).reduce((s,o)=>s+(Vy.test(o)?Wy:o===""?Gy:Ky),r)}function qy(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function Xy(e,t,n){let{routesMeta:r}=e,s={},o="/",i=[];for(let a=0;a<r.length;++a){let u=r[a],d=a===r.length-1,y=o==="/"?t:t.slice(o.length)||"/",g=ga({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},y),h=u.route;if(!g)return null;Object.assign(s,g.params),i.push({params:s,pathname:Bn([o,g.pathname]),pathnameBase:rv(Bn([o,g.pathnameBase])),route:h}),g.pathnameBase!=="/"&&(o=Bn([o,g.pathnameBase]))}return i}function ga(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Jy(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,y,g)=>{let{paramName:h,isOptional:v}=y;if(h==="*"){let k=a[g]||"";i=o.slice(0,o.length-k.length).replace(/(.)\/+$/,"$1")}const w=a[g];return v&&!w?d[h]=void 0:d[h]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:i,pattern:e}}function Jy(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Cc(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,u)=>(r.push({paramName:a,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function Zy(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Cc(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Wr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function ev(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?fr(e):e;return{pathname:n?n.startsWith("/")?n:tv(n,t):t,search:sv(r),hash:lv(s)}}function tv(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function mi(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nv(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function bc(e,t){let n=nv(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Ec(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=fr(e):(s=Us({},e),He(!s.pathname||!s.pathname.includes("?"),mi("?","pathname","search",s)),He(!s.pathname||!s.pathname.includes("#"),mi("#","pathname","hash",s)),He(!s.search||!s.search.includes("#"),mi("#","search","hash",s)));let o=e===""||s.pathname==="",i=o?"/":s.pathname,a;if(i==null)a=n;else{let g=t.length-1;if(!r&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),g-=1;s.pathname=h.join("/")}a=g>=0?t[g]:"/"}let u=ev(s,a),d=i&&i!=="/"&&i.endsWith("/"),y=(o||i===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||y)&&(u.pathname+="/"),u}const Bn=e=>e.join("/").replace(/\/\/+/g,"/"),rv=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),sv=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,lv=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ov(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const im=["post","put","patch","delete"];new Set(im);const iv=["get",...im];new Set(iv);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bs(){return Bs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bs.apply(this,arguments)}const Io=c.createContext(null),am=c.createContext(null),Nn=c.createContext(null),zo=c.createContext(null),kn=c.createContext({outlet:null,matches:[],isDataRoute:!1}),cm=c.createContext(null);function av(e,t){let{relative:n}=t===void 0?{}:t;Qr()||He(!1);let{basename:r,navigator:s}=c.useContext(Nn),{hash:o,pathname:i,search:a}=Ao(e,{relative:n}),u=i;return r!=="/"&&(u=i==="/"?r:Bn([r,i])),s.createHref({pathname:u,search:a,hash:o})}function Qr(){return c.useContext(zo)!=null}function It(){return Qr()||He(!1),c.useContext(zo).location}function um(e){c.useContext(Nn).static||c.useLayoutEffect(e)}function an(){let{isDataRoute:e}=c.useContext(kn);return e?Nv():cv()}function cv(){Qr()||He(!1);let e=c.useContext(Io),{basename:t,future:n,navigator:r}=c.useContext(Nn),{matches:s}=c.useContext(kn),{pathname:o}=It(),i=JSON.stringify(bc(s,n.v7_relativeSplatPath)),a=c.useRef(!1);return um(()=>{a.current=!0}),c.useCallback(function(d,y){if(y===void 0&&(y={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let g=Ec(d,JSON.parse(i),o,y.relative==="path");e==null&&t!=="/"&&(g.pathname=g.pathname==="/"?t:Bn([t,g.pathname])),(y.replace?r.replace:r.push)(g,y.state,y)},[t,r,i,o,e])}const uv=c.createContext(null);function dv(e){let t=c.useContext(kn).outlet;return t&&c.createElement(uv.Provider,{value:e},t)}function Ao(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=c.useContext(Nn),{matches:s}=c.useContext(kn),{pathname:o}=It(),i=JSON.stringify(bc(s,r.v7_relativeSplatPath));return c.useMemo(()=>Ec(e,JSON.parse(i),o,n==="path"),[e,i,o,n])}function fv(e,t){return pv(e,t)}function pv(e,t,n,r){Qr()||He(!1);let{navigator:s}=c.useContext(Nn),{matches:o}=c.useContext(kn),i=o[o.length-1],a=i?i.params:{};i&&i.pathname;let u=i?i.pathnameBase:"/";i&&i.route;let d=It(),y;if(t){var g;let S=typeof t=="string"?fr(t):t;u==="/"||(g=S.pathname)!=null&&g.startsWith(u)||He(!1),y=S}else y=d;let h=y.pathname||"/",v=h;if(u!=="/"){let S=u.replace(/^\//,"").split("/");v="/"+h.replace(/^\//,"").split("/").slice(S.length).join("/")}let w=Dy(e,{pathname:v}),k=vv(w&&w.map(S=>Object.assign({},S,{params:Object.assign({},a,S.params),pathname:Bn([u,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?u:Bn([u,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),o,n,r);return t&&k?c.createElement(zo.Provider,{value:{location:Bs({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:zn.Pop}},k):k}function mv(){let e=Sv(),t=ov(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return c.createElement(c.Fragment,null,c.createElement("h2",null,"Unexpected Application Error!"),c.createElement("h3",{style:{fontStyle:"italic"}},t),n?c.createElement("pre",{style:s},n):null,null)}const hv=c.createElement(mv,null);class gv extends c.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?c.createElement(kn.Provider,{value:this.props.routeContext},c.createElement(cm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function yv(e){let{routeContext:t,match:n,children:r}=e,s=c.useContext(Io);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),c.createElement(kn.Provider,{value:t},r)}function vv(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,a=(s=n)==null?void 0:s.errors;if(a!=null){let y=i.findIndex(g=>g.route.id&&(a==null?void 0:a[g.route.id])!==void 0);y>=0||He(!1),i=i.slice(0,Math.min(i.length,y+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let y=0;y<i.length;y++){let g=i[y];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(d=y),g.route.id){let{loaderData:h,errors:v}=n,w=g.route.loader&&h[g.route.id]===void 0&&(!v||v[g.route.id]===void 0);if(g.route.lazy||w){u=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((y,g,h)=>{let v,w=!1,k=null,S=null;n&&(v=a&&g.route.id?a[g.route.id]:void 0,k=g.route.errorElement||hv,u&&(d<0&&h===0?(kv("route-fallback"),w=!0,S=null):d===h&&(w=!0,S=g.route.hydrateFallbackElement||null)));let p=t.concat(i.slice(0,h+1)),f=()=>{let m;return v?m=k:w?m=S:g.route.Component?m=c.createElement(g.route.Component,null):g.route.element?m=g.route.element:m=y,c.createElement(yv,{match:g,routeContext:{outlet:y,matches:p,isDataRoute:n!=null},children:m})};return n&&(g.route.ErrorBoundary||g.route.errorElement||h===0)?c.createElement(gv,{location:n.location,revalidation:n.revalidation,component:k,error:v,children:f(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):f()},null)}var dm=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(dm||{}),fm=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(fm||{});function xv(e){let t=c.useContext(Io);return t||He(!1),t}function wv(e){let t=c.useContext(am);return t||He(!1),t}function jv(e){let t=c.useContext(kn);return t||He(!1),t}function pm(e){let t=jv(),n=t.matches[t.matches.length-1];return n.route.id||He(!1),n.route.id}function Sv(){var e;let t=c.useContext(cm),n=wv(),r=pm();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function Nv(){let{router:e}=xv(dm.UseNavigateStable),t=pm(fm.UseNavigateStable),n=c.useRef(!1);return um(()=>{n.current=!0}),c.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Bs({fromRouteId:t},o)))},[e,t])}const od={};function kv(e,t,n){od[e]||(od[e]=!0)}function Cv(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function ya(e){let{to:t,replace:n,state:r,relative:s}=e;Qr()||He(!1);let{future:o,static:i}=c.useContext(Nn),{matches:a}=c.useContext(kn),{pathname:u}=It(),d=an(),y=Ec(t,bc(a,o.v7_relativeSplatPath),u,s==="path"),g=JSON.stringify(y);return c.useEffect(()=>d(JSON.parse(g),{replace:n,state:r,relative:s}),[d,g,s,n,r]),null}function bv(e){return dv(e.context)}function Ut(e){He(!1)}function Ev(e){let{basename:t="/",children:n=null,location:r,navigationType:s=zn.Pop,navigator:o,static:i=!1,future:a}=e;Qr()&&He(!1);let u=t.replace(/^\/*/,"/"),d=c.useMemo(()=>({basename:u,navigator:o,static:i,future:Bs({v7_relativeSplatPath:!1},a)}),[u,a,o,i]);typeof r=="string"&&(r=fr(r));let{pathname:y="/",search:g="",hash:h="",state:v=null,key:w="default"}=r,k=c.useMemo(()=>{let S=Wr(y,u);return S==null?null:{location:{pathname:S,search:g,hash:h,state:v,key:w},navigationType:s}},[u,y,g,h,v,w,s]);return k==null?null:c.createElement(Nn.Provider,{value:d},c.createElement(zo.Provider,{children:n,value:k}))}function Lv(e){let{children:t,location:n}=e;return fv(va(t),n)}new Promise(()=>{});function va(e,t){t===void 0&&(t=[]);let n=[];return c.Children.forEach(e,(r,s)=>{if(!c.isValidElement(r))return;let o=[...t,s];if(r.type===c.Fragment){n.push.apply(n,va(r.props.children,o));return}r.type!==Ut&&He(!1),!r.props.index||!r.props.children||He(!1);let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=va(r.props.children,o)),n.push(i)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},io.apply(this,arguments)}function mm(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,o;for(o=0;o<r.length;o++)s=r[o],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Pv(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function _v(e,t){return e.button===0&&(!t||t==="_self")&&!Pv(e)}function xa(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function Rv(e,t){let n=xa(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(o=>{n.append(s,o)})}),n}const Iv=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],zv=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Av="6";try{window.__reactRouterVersion=Av}catch{}const Tv=c.createContext({isTransitioning:!1}),$v="startTransition",id=bh[$v];function Mv(e){let{basename:t,children:n,future:r,window:s}=e,o=c.useRef();o.current==null&&(o.current=My({window:s,v5Compat:!0}));let i=o.current,[a,u]=c.useState({action:i.action,location:i.location}),{v7_startTransition:d}=r||{},y=c.useCallback(g=>{d&&id?id(()=>u(g)):u(g)},[u,d]);return c.useLayoutEffect(()=>i.listen(y),[i,y]),c.useEffect(()=>Cv(r),[r]),c.createElement(Ev,{basename:t,children:n,location:a.location,navigationType:a.action,navigator:i,future:r})}const Ov=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Fv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hm=c.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:o,replace:i,state:a,target:u,to:d,preventScrollReset:y,viewTransition:g}=t,h=mm(t,Iv),{basename:v}=c.useContext(Nn),w,k=!1;if(typeof d=="string"&&Fv.test(d)&&(w=d,Ov))try{let m=new URL(window.location.href),j=d.startsWith("//")?new URL(m.protocol+d):new URL(d),b=Wr(j.pathname,v);j.origin===m.origin&&b!=null?d=b+j.search+j.hash:k=!0}catch{}let S=av(d,{relative:s}),p=Uv(d,{replace:i,state:a,target:u,preventScrollReset:y,relative:s,viewTransition:g});function f(m){r&&r(m),m.defaultPrevented||p(m)}return c.createElement("a",io({},h,{href:w||S,onClick:k||o?r:f,ref:n,target:u}))}),mr=c.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:s=!1,className:o="",end:i=!1,style:a,to:u,viewTransition:d,children:y}=t,g=mm(t,zv),h=Ao(u,{relative:g.relative}),v=It(),w=c.useContext(am),{navigator:k,basename:S}=c.useContext(Nn),p=w!=null&&Bv(h)&&d===!0,f=k.encodeLocation?k.encodeLocation(h).pathname:h.pathname,m=v.pathname,j=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;s||(m=m.toLowerCase(),j=j?j.toLowerCase():null,f=f.toLowerCase()),j&&S&&(j=Wr(j,S)||j);const b=f!=="/"&&f.endsWith("/")?f.length-1:f.length;let E=m===f||!i&&m.startsWith(f)&&m.charAt(b)==="/",I=j!=null&&(j===f||!i&&j.startsWith(f)&&j.charAt(f.length)==="/"),T={isActive:E,isPending:I,isTransitioning:p},z=E?r:void 0,A;typeof o=="function"?A=o(T):A=[o,E?"active":null,I?"pending":null,p?"transitioning":null].filter(Boolean).join(" ");let B=typeof a=="function"?a(T):a;return c.createElement(hm,io({},g,{"aria-current":z,className:A,ref:n,style:B,to:u,viewTransition:d}),typeof y=="function"?y(T):y)});var wa;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(wa||(wa={}));var ad;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ad||(ad={}));function Dv(e){let t=c.useContext(Io);return t||He(!1),t}function Uv(e,t){let{target:n,replace:r,state:s,preventScrollReset:o,relative:i,viewTransition:a}=t===void 0?{}:t,u=an(),d=It(),y=Ao(e,{relative:i});return c.useCallback(g=>{if(_v(g,n)){g.preventDefault();let h=r!==void 0?r:oo(d)===oo(y);u(e,{replace:h,state:s,preventScrollReset:o,relative:i,viewTransition:a})}},[d,u,y,r,s,n,e,o,i,a])}function gm(e){let t=c.useRef(xa(e)),n=c.useRef(!1),r=It(),s=c.useMemo(()=>Rv(r.search,n.current?null:t.current),[r.search]),o=an(),i=c.useCallback((a,u)=>{const d=xa(typeof a=="function"?a(s):a);n.current=!0,o("?"+d,u)},[o,s]);return[s,i]}function Bv(e,t){t===void 0&&(t={});let n=c.useContext(Tv);n==null&&He(!1);let{basename:r}=Dv(wa.useViewTransitionState),s=Ao(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=Wr(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Wr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return ga(s.pathname,i)!=null||ga(s.pathname,o)!=null}function ym(){const[e,t]=c.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("cozygen_gallery_pending")==="1"}catch{return!1}});return c.useEffect(()=>{const n=()=>t(!0),r=()=>t(!1),s=o=>{o.key==="cozygen_gallery_pending"&&t(o.newValue==="1")};return window.addEventListener("cozygen:gallery-pending",n),window.addEventListener("cozygen:gallery-viewed",r),window.addEventListener("storage",s),()=>{window.removeEventListener("cozygen:gallery-pending",n),window.removeEventListener("cozygen:gallery-viewed",r),window.removeEventListener("storage",s)}},[]),e}const ja="cozygen_token",ao="cozygen:auth-expired";function Lc(){try{return typeof window>"u"?null:localStorage.getItem(ja)}catch{return null}}function vm(e){try{if(typeof window>"u")return;e?localStorage.setItem(ja,e):localStorage.removeItem(ja)}catch{}}function Al(){vm(null)}function Qs(){const e=Lc();return e?{Authorization:`Bearer ${e}`}:{}}function Vv(e={}){if(Al(),!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent(ao,{detail:e}))}catch{window.dispatchEvent(new Event(ao))}}const Ys=async(e,t)=>{if(t.status===401){Vv({url:e,status:t.status});const r=new Error("unauthorized");throw r.unauthorized=!0,r.status=401,r}if(!t.ok)throw new Error(`${e} failed`);return(t.headers.get("content-type")||"").includes("application/json")?t.json():t.text()},Cn=async(e,t={})=>{const{signal:n}=t,r=await fetch(e,{headers:{...Qs()},credentials:"include",signal:n});return Ys(e,r)},qs=async(e,t,n={})=>{const{signal:r}=n,s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...Qs()},body:JSON.stringify(t),credentials:"include",signal:r});return Ys(e,s)};async function Wv(e={}){return Cn("/cozygen/workflows",e)}async function Hv(e,t={}){return Cn(`/cozygen/workflows/${encodeURIComponent(e)}`,t)}async function Gv(e,t={}){const{refresh:n=!1,cacheBust:r="",...s}=t||{},o=new URLSearchParams({type:String(e||"")});return n&&o.set("refresh","1"),r&&o.set("cache_bust",String(r)),Cn(`/cozygen/get_choices?${o.toString()}`,s)}async function Pc(e){const t=await fetch("/prompt",{method:"POST",headers:{"Content-Type":"application/json",...Qs()},body:JSON.stringify(e),credentials:"include"});return Ys("/prompt",t)}async function Kv(e){const t=new FormData;t.append("image",e);const n=await fetch("/cozygen/upload_image",{method:"POST",headers:{...Qs()},body:t,credentials:"include"});return Ys("/cozygen/upload_image",n)}async function xm(e="",t=1,n=50,r=!1,s=!1,o="all",i="",a={}){const{includeMeta:u=!1,...d}=a||{},y=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),show_hidden:r?"1":"0",recursive:s?"1":"0",kind:o});return u&&y.set("include_meta","1"),i&&y.set("cache_bust",String(i)),Cn(`/cozygen/api/gallery?${y.toString()}`,d)}async function Qv({filename:e="",subfolder:t=""}={},n={}){const r=new URLSearchParams({filename:String(e||""),subfolder:String(t||"")});return Cn(`/cozygen/api/gallery/prompt?${r.toString()}`,n)}async function Yv(){return Cn("/cozygen/api/aliases")}async function qv(e){return qs("/cozygen/api/aliases",e||{})}async function wm(e={}){return Cn("/cozygen/api/tags/categories",e)}async function co({q:e="",category:t="",sort:n="count",limit:r=80,offset:s=0}={},o={}){const i=new URLSearchParams({q:String(e||""),category:String(t||""),sort:String(n||"count"),limit:String(r||80),offset:String(s||0)});return Cn(`/cozygen/api/tags/search?${i.toString()}`,o)}async function hi(e=[],t={}){return qs("/cozygen/api/tags/validate",{tags:Array.isArray(e)?e:[]},t)}async function Xv(e,t={}){const n=new URLSearchParams;return e&&n.set("workflow",e),Cn(`/cozygen/api/workflow_presets?${n.toString()}`,t)}async function Jv(e,t,n={}){return qs("/cozygen/api/workflow_presets",{workflow:e,preset:t},n)}async function Zv(e,t,n={}){return qs("/cozygen/api/workflow_presets",{workflow:e,delete:t},n)}async function ex(e,t){return qs("/cozygen/api/login",{username:e,password:t})}async function tx(){return fetch("/cozygen/api/auth_status",{headers:{...Qs()},credentials:"include"}).then(e=>Ys("/cozygen/api/auth_status",e))}const nx=30*60*1e3,cd="cozygen_idle_logout",jm=c.createContext(null);function rx({children:e}){const[t,n]=c.useState(!1),[r,s]=c.useState(null),[o,i]=c.useState(!1),a=c.useRef(null),u=c.useCallback(async()=>{if(!Lc()){s(null),i(!1),n(!0);return}try{const v=await tx();s((v==null?void 0:v.user)||null),i(!!(v!=null&&v.default_credentials))}catch{Al(),s(null),i(!1)}finally{n(!0)}},[]);c.useEffect(()=>{u()},[u]);const d=c.useCallback(async(h,v)=>{const w=await ex(h,v);vm((w==null?void 0:w.token)||""),s((w==null?void 0:w.user)||h),i(!!(w!=null&&w.default_credentials));try{localStorage.removeItem(cd)}catch{}return w},[]),y=c.useCallback(()=>{Al(),s(null),i(!1)},[]);c.useEffect(()=>{if(typeof window>"u")return;const h=()=>{y(),n(!0)};return window.addEventListener(ao,h),()=>window.removeEventListener(ao,h)},[y]),c.useEffect(()=>{if(!t)return;const h=()=>{a.current&&clearTimeout(a.current);const w=setTimeout(()=>{Al(),s(null),i(!1);try{localStorage.setItem(cd,"1")}catch{}window.location.hash="#/login"},nx);a.current=w};h();const v=["pointerdown","keydown","visibilitychange"];return v.forEach(w=>window.addEventListener(w,h,{passive:!0})),()=>{a.current&&(clearTimeout(a.current),a.current=null),v.forEach(w=>window.removeEventListener(w,h))}},[t]);const g=c.useMemo(()=>({ready:t,user:r,authed:!!r,defaultCreds:o,login:d,logout:y,refresh:u}),[t,r,o,d,y,u]);return l.jsx(jm.Provider,{value:g,children:e})}function To(){const e=c.useContext(jm);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function sx({children:e}){return l.jsx(rx,{children:e})}const Sm="cozygen_last_render_payload";function Nm(e){if(e)try{if(typeof window>"u")return;window.localStorage.setItem(Sm,JSON.stringify(e))}catch{}}function km(){try{if(typeof window>"u")return null;const e=window.localStorage.getItem(Sm);return e?JSON.parse(e):null}catch{return null}}async function Cm(){const e=km();if(!e||!e.workflow)return{success:!1,error:"No previous render to repeat"};try{return window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!0}})),await Pc({prompt:e.workflow}),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),{success:!0}}catch(t){return console.error("Failed to requeue prompt",t),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),t!=null&&t.unauthorized?(window.location.hash="#/login",{success:!1,error:"Session expired"}):{success:!1,error:"Failed to queue prompt"}}}function bm(){const e=km();return!!(e&&e.workflow)}function $o(e,t=!1){const n=()=>typeof window>"u"||!window.matchMedia?t:window.matchMedia(e).matches,[r,s]=c.useState(n);return c.useEffect(()=>{if(typeof window>"u"||!window.matchMedia)return;const o=window.matchMedia(e),i=()=>s(o.matches);return i(),typeof o.addEventListener=="function"?(o.addEventListener("change",i),()=>o.removeEventListener("change",i)):(o.addListener(i),()=>o.removeListener(i))},[e]),r}const Em=({size:e=32,className:t=""})=>l.jsxs("svg",{width:e,height:e,viewBox:"0 0 32 32",fill:"none",className:t,"aria-hidden":"true",children:[l.jsx("path",{d:"M8 24L20 4",stroke:"url(#logo-gradient)",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("path",{d:"M6 26C6 26 7 24 8 24C9 24 10 25 8 27C6 29 4 28 6 26Z",fill:"url(#logo-warm)"}),l.jsx("circle",{cx:"22",cy:"8",r:"2",fill:"url(#logo-spark)"}),l.jsx("circle",{cx:"26",cy:"12",r:"1.5",fill:"url(#logo-spark)",opacity:"0.8"}),l.jsx("circle",{cx:"24",cy:"16",r:"1",fill:"url(#logo-spark)",opacity:"0.6"}),l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"logo-gradient",x1:"8",y1:"24",x2:"20",y2:"4",gradientUnits:"userSpaceOnUse",children:[l.jsx("stop",{stopColor:"#FF9F7A"}),l.jsx("stop",{offset:"0.5",stopColor:"#9F8CFF"}),l.jsx("stop",{offset:"1",stopColor:"#44E1C5"})]}),l.jsxs("linearGradient",{id:"logo-warm",x1:"4",y1:"24",x2:"10",y2:"28",gradientUnits:"userSpaceOnUse",children:[l.jsx("stop",{stopColor:"#FF9F7A"}),l.jsx("stop",{offset:"1",stopColor:"#FFD666"})]}),l.jsxs("radialGradient",{id:"logo-spark",cx:"0.3",cy:"0.3",r:"0.7",children:[l.jsx("stop",{stopColor:"#FFFFFF"}),l.jsx("stop",{offset:"0.5",stopColor:"#44E1C5"}),l.jsx("stop",{offset:"1",stopColor:"#9F8CFF"})]})]})]}),Be=({children:e,size:t=16,className:n="",...r})=>l.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,"aria-hidden":"true",...r,children:e}),lx=e=>l.jsxs(Be,{...e,children:[l.jsx("path",{d:"M3 10l9-7 9 7"}),l.jsx("path",{d:"M5 10v10h14V10"}),l.jsx("path",{d:"M9 20v-6h6v6"})]}),_c=e=>l.jsxs(Be,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),l.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor",stroke:"none"}),l.jsx("path",{d:"M21 15l-5-5L5 21"})]}),Gn=e=>l.jsxs(Be,{...e,children:[l.jsx("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"}),l.jsx("line",{x1:"7",y1:"7",x2:"7.01",y2:"7",strokeWidth:"3"})]}),Xs=e=>l.jsxs(Be,{...e,children:[l.jsx("path",{d:"M14 3H4a2 2 0 00-2 2v10l6 6h10a2 2 0 002-2V9l-6-6z"}),l.jsx("path",{d:"M14 3v6h6"}),l.jsx("path",{d:"M7 7h5"}),l.jsx("path",{d:"M7 11h7"})]}),Rc=e=>l.jsx(Be,{...e,children:l.jsx("path",{d:"M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"})}),Lm=e=>l.jsx(Be,{...e,children:l.jsx("polygon",{points:"5 3 19 12 5 21 5 3",fill:"currentColor",stroke:"none"})}),ud=e=>l.jsxs(Be,{...e,children:[l.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"}),l.jsx("polyline",{points:"16 17 21 12 16 7"}),l.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),Ic=e=>l.jsxs(Be,{...e,children:[l.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),l.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),l.jsx("line",{x1:"15",y1:"9",x2:"15",y2:"15"}),l.jsx("circle",{cx:"9",cy:"12",r:"1.5",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"10",r:"1.5",fill:"currentColor",stroke:"none"})]}),ox=e=>l.jsxs(Be,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"4"}),l.jsx("line",{x1:"3",y1:"9",x2:"6",y2:"9"})]}),dd=e=>l.jsxs(Be,{...e,children:[l.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"}),l.jsx("path",{d:"M2 10h20"})]}),fd=e=>l.jsx(Be,{...e,children:l.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"})}),pd=e=>l.jsxs(Be,{...e,children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),md=e=>l.jsxs(Be,{...e,children:[l.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),hd=e=>l.jsx(Be,{...e,children:l.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),gd=e=>l.jsxs(Be,{...e,children:[l.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),l.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),Sa=e=>l.jsxs(Be,{...e,children:[l.jsx("polyline",{points:"23 4 23 10 17 10"}),l.jsx("path",{d:"M20.49 15a9 9 0 11-2.12-9.36L23 10"})]}),Pm=e=>l.jsx(Be,{...e,children:l.jsx("polyline",{points:"15 18 9 12 15 6"})}),Mo=e=>l.jsx(Be,{...e,children:l.jsx("polyline",{points:"9 18 15 12 9 6"})}),Na=e=>l.jsxs(Be,{...e,children:[l.jsx("circle",{cx:"9",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"9",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"9",cy:"18",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"18",r:"1",fill:"currentColor",stroke:"none"})]}),on=e=>l.jsxs(Be,{...e,children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),yd=e=>l.jsxs(Be,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",strokeDasharray:"4 2"}),l.jsx("line",{x1:"9",y1:"12",x2:"15",y2:"12"})]}),ix=e=>l.jsxs(Be,{...e,children:[l.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),l.jsx("polyline",{points:"5 12 12 5 19 12"})]}),ax=e=>l.jsxs(Be,{...e,children:[l.jsx("circle",{cx:"6",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"12",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"18",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"})]}),cx=e=>l.jsxs(Be,{...e,children:[l.jsx("rect",{x:"9",y:"9",width:"10",height:"10",rx:"2"}),l.jsx("path",{d:"M7 15H6a2 2 0 01-2-2V6a2 2 0 012-2h7"})]}),vd=[{to:"/studio",label:"Studio",Icon:lx,end:!0},{to:"/controls",label:"Controls",Icon:Ic}],ux=[{to:"/gallery",label:"Gallery",Icon:_c},{to:"/tags",label:"Tag Library",Icon:Gn},{to:"/aliases",label:"Aliases",Icon:Xs}],os=({isActive:e})=>["slim-nav-link btn-touch",e?"is-active":null].filter(Boolean).join(" ");function dx({isMobileAlignedNav:e=!1}){const[t,n]=c.useState(!1),{pathname:r}=It(),s=ym(),{logout:o,user:i}=To(),[a,u]=c.useState(!1),d=$o("(min-width: 768px)"),y=()=>n(j=>!j),g=()=>n(!1),h=r==="/login",v=d&&!e,w=!h&&v,k=v,S=!d||e;c.useEffect(()=>{const j=b=>{var I;const E=!!((I=b==null?void 0:b.detail)!=null&&I.active);u(E)};return window.addEventListener("cozygen:render-state",j),()=>window.removeEventListener("cozygen:render-state",j)},[]);const p=async()=>{if(a)return;if(r==="/controls"||r==="/compose"){try{window.dispatchEvent(new Event("cozygen:request-render"))}catch{}return}if(!bm()){alert("No previous render found yet. Render once from Studio first.");return}u(!0);const E=await Cm();u(!1),E!=null&&E.success||alert((E==null?void 0:E.error)||"Failed to render.")},f=()=>{try{o()}catch{}window.location.hash="#/login"},m=[...vd,...ux];return l.jsxs("header",{className:"top-bar",children:[l.jsx("div",{className:"top-bar-shell",children:l.jsxs("div",{className:"brand-row",children:[l.jsxs(hm,{to:"/studio",className:"brand-mark",onClick:g,children:[l.jsx(Em,{size:28,className:"brand-logo"}),l.jsx("span",{className:"brand-text",children:"CozyGen"})]}),v?l.jsx("nav",{className:"desktop-nav","aria-label":"Main navigation",children:m.map(j=>l.jsx(mr,{to:j.to,end:j.end,className:os,children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[l.jsx(j.Icon,{size:16}),l.jsx("span",{children:j.label}),j.to==="/gallery"&&s?l.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})},j.to))}):null,l.jsx("div",{className:"flex-1"}),w?l.jsxs("button",{type:"button",className:`desktop-render-btn ${a?"is-busy":""}`,onClick:p,title:a?"Rendering":"Render","aria-busy":a,"aria-disabled":a,disabled:a,children:[l.jsx("span",{className:"render-icon",children:a?l.jsx("span",{className:"render-spinner","aria-hidden":"true"}):l.jsx(Lm,{size:16})}),l.jsx("span",{className:"render-label",children:a?"Rendering":"Render"})]}):null,k?l.jsxs("button",{type:"button",className:"desktop-logout-btn",onClick:f,title:"Sign out",children:[l.jsx("span",{className:"logout-icon",children:l.jsx(ud,{size:16})}),l.jsx("span",{className:"logout-label",children:"Logout"}),i?l.jsxs("span",{className:"logout-user",children:["@",i]}):null]}):null,S?l.jsx("button",{type:"button",className:`mobile-menu-toggle btn-touch ${t?"is-active":""}`,onClick:y,"aria-expanded":t,"aria-controls":"cozygen-mobile-nav","aria-label":t?"Close menu":"Open menu",children:l.jsx("span",{className:"mobile-menu-icon",children:l.jsx("span",{})})}):null]})}),S?l.jsxs("div",{id:"cozygen-mobile-nav",className:`mobile-nav-drawer ${t?"is-open":""}`,role:"menu",children:[l.jsx("div",{className:"mobile-nav-section",children:vd.map(j=>l.jsx(mr,{to:j.to,end:j.end,className:os,onClick:g,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(j.Icon,{size:16}),l.jsx("span",{children:j.label})]})},j.to))}),l.jsxs("div",{className:"mobile-nav-section secondary",children:[l.jsx(mr,{to:"/gallery",className:os,onClick:g,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(_c,{size:16}),l.jsx("span",{children:"Gallery"}),s?l.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})}),l.jsx(mr,{to:"/tags",className:os,onClick:g,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(Gn,{size:16}),l.jsx("span",{children:"Tag Library"})]})}),l.jsx(mr,{to:"/aliases",className:os,onClick:g,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(Xs,{size:16}),l.jsx("span",{children:"Aliases"})]})}),l.jsx("button",{type:"button",className:"slim-nav-link btn-touch text-left",onClick:()=>{g(),f()},role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(ud,{size:16}),l.jsx("span",{children:"Logout"}),i?l.jsxs("span",{className:"text-[rgba(159,178,215,0.75)] text-xs",children:["@",i]}):null]})})]})]}):null]})}const xd=[{to:"/controls",label:"Controls",Icon:Ic},{to:"/compose",label:"Compose",Icon:Rc},{to:"/gallery",label:"Gallery",Icon:_c}],fx=[{to:"/aliases",label:"Aliases",Icon:Xs},{to:"/tags",label:"Tags",Icon:Gn}],px=({isActive:e})=>["bottom-nav-link",e?"is-active":""].filter(Boolean).join(" ");function mx(){const e=It(),t=an(),n=ym(),[r,s]=zt.useState(!1),[o,i]=zt.useState(!1),[a,u]=zt.useState(!1),[d,y]=zt.useState({}),g=$o("(min-width: 768px)"),h=zt.useRef(null),v=zt.useRef(null),w=e.pathname==="/controls",k=e.pathname==="/compose",S=async()=>{if(!(typeof window>"u")&&!o)if(s(!0),setTimeout(()=>s(!1),400),w||k)try{window.dispatchEvent(new CustomEvent("cozygen:request-render"))}catch{}else{if(!bm())return;const f=await Cm();f.success||console.warn("Requeue failed:",f.error)}};zt.useEffect(()=>{const f=m=>{var b;const j=!!((b=m==null?void 0:m.detail)!=null&&b.active);i(j),j&&(s(!0),setTimeout(()=>s(!1),400))};return window.addEventListener("cozygen:render-state",f),()=>window.removeEventListener("cozygen:render-state",f)},[]),zt.useEffect(()=>{if(!a||g)return;const f=m=>{h.current&&h.current.contains(m.target)||v.current&&v.current.contains(m.target)||u(!1)};return window.addEventListener("pointerdown",f),()=>window.removeEventListener("pointerdown",f)},[a,g]),zt.useEffect(()=>{if(!a||g||!v.current)return;const f=v.current.getBoundingClientRect(),m=f.left+f.width/2,j=window.innerHeight-f.top+8;y({left:`${Math.min(window.innerWidth-80,Math.max(40,m))}px`,bottom:`${j}px`,top:"auto"})},[a,g]),zt.useEffect(()=>{g&&u(!1)},[g]);const p=g?[...xd,...fx]:xd;return l.jsxs(l.Fragment,{children:[l.jsxs("nav",{className:"bottom-nav","aria-label":"Bottom navigation",children:[p.map(f=>l.jsxs(mr,{to:f.to,end:f.end,className:px,children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(f.Icon,{size:20})}),l.jsxs("span",{className:"bottom-nav-label",children:[f.label,f.to==="/gallery"&&n?l.jsx("span",{className:"badge-dot pulse","aria-hidden":"true"}):null]})]},f.to)),g?null:l.jsxs("button",{ref:v,type:"button",className:"bottom-nav-link",onClick:()=>u(f=>!f),"aria-expanded":a,"aria-label":"Open library",children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(Gn,{size:20})}),l.jsx("span",{className:"bottom-nav-label",children:"Library"})]},"library"),l.jsxs("button",{type:"button",className:`bottom-nav-link is-action ${r?"is-flash":""} ${o?"is-rendering":""}`,onClick:S,"aria-label":"Render","aria-busy":o,"aria-disabled":o,disabled:o,children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(Lm,{size:20})}),l.jsx("span",{className:"bottom-nav-label",children:"Render"})]},"render")]}),g?null:l.jsxs("div",{ref:h,className:`library-popover ${a?"is-open":""}`,style:d,children:[l.jsxs("button",{type:"button",className:"library-popover-btn",onClick:()=>{u(!1),t("/aliases")},children:[l.jsx(Xs,{size:18}),l.jsx("span",{children:"Aliases"})]}),l.jsxs("button",{type:"button",className:"library-popover-btn",onClick:()=>{u(!1),t("/tags")},children:[l.jsx(Gn,{size:18}),l.jsx("span",{children:"Tags"})]})]})]})}function hx(e,t){if(!t||t<=0)return null;const n=Number(e)||0,r=Number(t)||0,s=Math.round(n/r*100);return Number.isFinite(s)?Math.max(0,Math.min(100,s)):null}function gx({busy:e=!1,progressValue:t=0,progressMax:n=0,statusText:r="Idle",statusPhase:s="idle",primaryLabel:o="Render",onPrimary:i,primaryDisabled:a=!1,onLogs:u,logsLabel:d="Logs"}){const y=hx(t,n),g=s==="queued"?"rgba(255, 143, 112, 0.95)":s==="running"?"rgba(68, 225, 197, 0.95)":s==="finished"?"rgba(92, 255, 154, 0.95)":s==="error"?"rgba(255, 143, 112, 0.95)":"rgba(159, 178, 215, 0.55)",v={idle:"Idle",queued:"Queued",running:"Running",finished:"Finished",error:"Error"}[s]||"Status",w=e||a;return l.jsxs("div",{className:"dock-bar-inner",children:[l.jsx("button",{type:"button",onClick:i,disabled:w,className:"dock-primary-btn",children:e?"Rendering":o}),l.jsxs("div",{className:"dock-status-row",children:[l.jsxs("span",{className:"dock-status-left",children:[l.jsx("span",{className:"dock-status-dot",style:{background:g}}),l.jsx("span",{className:"dock-status-label",children:v})]}),l.jsxs("span",{className:"dock-status-right",children:[y!=null&&e?l.jsxs("span",{className:"dock-progress",children:[l.jsx("span",{className:"dock-progress-bar","aria-hidden":"true",children:l.jsx("span",{className:"dock-progress-fill",style:{width:`${y}%`}})}),l.jsxs("span",{children:[y,"%"]})]}):null,l.jsx("span",{className:"dock-status-text",children:r||(e?"Working":"Idle")}),u?l.jsx("button",{type:"button",className:"dock-logs-btn",onClick:u,children:d}):null]})]})]})}const _m="jpg,jpeg,png,webp,gif,bmp,tif,tiff",zc=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),Rm=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);async function gi({subfolder:e="",page:t=1,perPage:n=50,exts:r=_m,signal:s}={}){const o=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),exts:r}),i=await fetch(`/cozygen/input?${o.toString()}`,{signal:s});if(!i.ok)throw new Error(`Input list failed: ${i.status}`);return i.json()}const uo=e=>`/cozygen/input/file?path=${encodeURIComponent(e)}`,ka="output::",Oo=(e="")=>e.replace(/\\/g,"/").replace(/^\/+/,"").replace(/\/+$/,""),Im=(e="")=>{const t=e.replace(/\\/g,"/").split("/").filter(Boolean);return t[t.length-1]||""},yx=({subfolder:e="",filename:t=""}={})=>{const n=Im(t);if(!n)return"";const r=Oo(e);return`${ka}${r}::${n}`},Ca=(e="")=>{if(typeof e!="string"||!e.startsWith(ka))return null;const t=e.slice(ka.length);if(!t)return null;const n=t.lastIndexOf("::"),r=n===-1?t:t.slice(n+2);return r?{subfolder:n===-1?"":t.slice(0,n),filename:r}:null},fo=({filename:e="",subfolder:t="",type:n="output"}={})=>{const r=Im(e);return r?`/view?${new URLSearchParams({filename:r,subfolder:Oo(t),type:n||"output"}).toString()}`:""},ba=(e="")=>e.split("/").slice(0,-1).join("/"),vx=e=>{if(typeof e!="string"||!e)return e!=null&&e.path?ba(e.path):"";const t=Ca(e);return t?Oo(t.subfolder):ba(e)},wd=(e=[])=>e.map(t=>{const n=t.rel_path||t.name||"",r=t.name||n||"Untitled",s=!!t.is_dir,o=s?"":uo(n);return{...t,name:r,rel_path:n,is_dir:s,is_image:!s&&zc(r),is_video:!s&&Rm(r),source:"input",preview_url:o}}),xx=(e=[])=>e.map(t=>{const n=t.filename||"",r=t.subfolder||"",s=t.type==="directory",o=s?r||n:[r,n].filter(Boolean).join("/"),i=n||r||o||"Untitled",a=s?"":fo({filename:n,subfolder:r,type:t.type});return{...t,name:i,rel_path:o,is_dir:s,is_image:!s&&zc(n),is_video:!s&&Rm(n),source:"output",preview_url:a}}),qn={get(e,t){try{return(typeof window<"u"?JSON.parse(localStorage.getItem(e)):null)??t}catch{return t}},set(e,t){try{typeof window<"u"&&localStorage.setItem(e,JSON.stringify(t))}catch{}}};function wx({input:e,value:t,onFormChange:n}){var W;const r=((W=e==null?void 0:e.inputs)==null?void 0:W.param_name)||"Image Input",s=(e==null?void 0:e.class_type)||"CozyGenImageInput",o=`cg_last_input_cwd::${r}`,i=`cg_last_picker_source::${r}`,[a,u]=c.useState(""),[d,y]=c.useState(!1),[g,h]=c.useState(!1),[v,w]=c.useState(qn.get(o,"")),[k,S]=c.useState(1),[p,f]=c.useState(50),[m,j]=c.useState([]),[b,E]=c.useState(1),[I,T]=c.useState(!1),[z,A]=c.useState(""),[B,le]=c.useState([]),[F,ge]=c.useState(!0),ue=c.useRef(null),[K,fe]=c.useState(()=>qn.get(i,"inputs")==="outputs"?"outputs":"inputs"),R=K,N=c.useCallback(M=>{const O=M==="outputs"?"outputs":"inputs";fe(O),qn.set(i,O),w(""),S(1)},[]),_=c.useMemo(()=>{if(a)try{const M=new URL(a,window.location.origin);return(M.searchParams.get("path")||M.searchParams.get("filename")||M.pathname.split("/").pop()||"").split("/").pop()||"No file selected."}catch{}if(!t)return"No file selected.";if(typeof t=="string"){const M=Ca(t);return M!=null&&M.filename?M.filename.split("/").pop():t.split("/").pop()}return t!=null&&t.path?t.path.split("/").pop():"No file selected."},[a,t]);c.useEffect(()=>{if(typeof t=="string"&&t){const M=Ca(t);M!=null&&M.filename?u(fo({filename:M.filename,subfolder:M.subfolder,type:"output"})):u(uo(t)),y(!1)}else t!=null&&t.url?(u(t.url),y(!1)):(u(""),y(!1))},[t]);const P=c.useCallback(async M=>{const O=await Kv(M),te=`/view?filename=${O.filename}&type=input`;u(te),y(!1),qn.set(o,""),s==="CozyGenImageInput"?n(r,O.filename):n(r,{source:"Upload",path:O.filename,url:te})},[s,n,r]),V=c.useCallback(()=>{u(""),y(!1),s==="CozyGenImageInput"?n(r,""):n(r,{source:"Upload",path:"",url:""})},[s,n,r]),G=c.useCallback(()=>{const O=vx(t)||qn.get(o,"");w(O),S(1),h(!0)},[t]),Z=c.useCallback(()=>{h(!1)},[]);c.useEffect(()=>{if(g){if(R!=="inputs"){le([]);return}(async()=>{try{const M=await gi({subfolder:"",page:1,perPage:0,exts:""});le((M.items||[]).filter(O=>O.is_dir))}catch{}})()}},[g,R]),c.useEffect(()=>{if(!g)return;let M=!1;ue.current&&ue.current.abort();const O=new AbortController;ue.current=O;async function te(){T(!0);try{if(R==="outputs"){const H=await xm(v,k,p,!1,!1,"all","",{signal:O.signal});if(M)return;const ve=xx(H&&H.items||[]);M||(j(ve),E(H&&H.total_pages||1))}else{const ve=await gi({subfolder:v,page:k,perPage:p,exts:F?_m:"",signal:O.signal}),Ne=(ve.items||[]).some(je=>!je.is_dir);if(F&&!Ne){const je=await gi({subfolder:v,page:k,perPage:p,exts:"",signal:O.signal});M||(j(wd(je.items||[])),E(je.total_pages||1),ge(!1));return}M||(j(wd(ve.items||[])),E(ve.total_pages||1))}}catch(H){if((H==null?void 0:H.name)==="AbortError")return;console.error(R==="outputs"?"Failed to load output directory":"Failed to load input directory",H),M||(j([]),E(1))}finally{M||T(!1)}}return te(),()=>{M=!0,ue.current===O&&(ue.current=null),O.abort()}},[g,v,k,p,F,R]);const ee=c.useDeferredValue(z),X=c.useMemo(()=>{const M=ee.trim().toLowerCase();let O=m;return F&&(O=O.filter(te=>{if(te.is_dir)return!0;const H=te.name||te.filename||te.rel_path||"";return zc(String(H))})),M?O.filter(te=>(te.name||te.filename||te.rel_path||"").toLowerCase().includes(M)):O},[m,ee,F]),se=c.useCallback(M=>{if(!M)return;const O=typeof M=="object"?M:null;if(((O==null?void 0:O.source)||"inputs")==="output"){const Ne=yx({subfolder:(O==null?void 0:O.subfolder)||"",filename:(O==null?void 0:O.filename)||(O==null?void 0:O.name)||""});if(!Ne)return;const je=(O==null?void 0:O.preview_url)||fo({filename:O==null?void 0:O.filename,subfolder:O==null?void 0:O.subfolder,type:O==null?void 0:O.type});u(je),y(!1),qn.set(o,Oo((O==null?void 0:O.subfolder)||"")),s==="CozyGenImageInput"?n(r,Ne):n(r,{source:"OutputGallery",path:Ne,url:je}),h(!1);return}const H=typeof M=="string"?M:(O==null?void 0:O.rel_path)||(O==null?void 0:O.path)||"";if(!H)return;const ve=(O==null?void 0:O.preview_url)||uo(H);u(ve),y(!1),qn.set(o,ba(H)),s==="CozyGenImageInput"?n(r,H):n(r,{source:"Server",path:H,url:ve}),h(!1)},[s,n,r]);return{param:r,previewUrl:a,imgReady:d,setImgReady:y,displayName:_,serverOpen:g,openServer:G,closeServer:Z,cwd:v,setCwd:w,page:k,setPage:S,perPage:p,setPerPage:f,totalPages:b,loading:I,search:z,setSearch:A,topDirs:B,imagesOnly:F,setImagesOnly:ge,shownEntries:X,pickerSource:R,setPickerSource:N,handleUpload:P,clearImage:V,selectServer:se}}function Nt({open:e,onClose:t,title:n,children:r,footer:s,variant:o="sheet",className:i="",contentClassName:a="",shouldCloseOnOverlayClick:u=!0,shouldCloseOnEsc:d=!0}){const y=c.useRef(!1),g=c.useRef(null),h=c.useRef(null),v=S=>S?Array.from(S.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(p=>!p.hasAttribute("disabled")&&p.getAttribute("aria-hidden")!=="true"):[],w=c.useMemo(()=>["bottom-sheet-content",o==="fullscreen"?"is-fullscreen":"is-sheet",a].filter(Boolean).join(" "),[a,o]),k=c.useMemo(()=>["bottom-sheet-overlay",i].filter(Boolean).join(" "),[i]);return c.useEffect(()=>{if(!e||!d)return;const S=p=>{p.key==="Escape"&&(t==null||t())};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[e,t,d]),c.useEffect(()=>{if(!e||typeof document>"u")return;const S=g.current;h.current=document.activeElement;const p=()=>{var b;const j=v(S)[0]||S;(b=j==null?void 0:j.focus)==null||b.call(j)},f=m=>{if(m.key!=="Tab"||!S)return;const j=v(S);if(!j.length){m.preventDefault(),S.focus();return}const b=j[0],E=j[j.length-1],I=document.activeElement;m.shiftKey&&I===b?(m.preventDefault(),E.focus()):!m.shiftKey&&I===E&&(m.preventDefault(),b.focus())};return requestAnimationFrame(p),S==null||S.addEventListener("keydown",f),()=>{var j;S==null||S.removeEventListener("keydown",f);const m=h.current;m&&document.contains(m)&&((j=m.focus)==null||j.call(m))}},[e]),!e||typeof document>"u"?null:kc.createPortal(l.jsx("div",{className:k,role:"presentation",onPointerDown:S=>{y.current=S.target===S.currentTarget},onClick:S=>{u&&y.current&&S.target===S.currentTarget&&(t==null||t())},children:l.jsx("div",{ref:g,className:w,role:"dialog","aria-modal":"true","aria-label":n||"Sheet",onClick:S=>S.stopPropagation(),tabIndex:-1,children:l.jsxs("div",{className:"bottom-sheet-panel",children:[l.jsxs("header",{className:"bottom-sheet-head",children:[l.jsx("div",{className:"bottom-sheet-title",children:n||""}),l.jsx("button",{type:"button",className:"bottom-sheet-close",onClick:t,"aria-label":"Close",children:l.jsx(on,{size:16})})]}),l.jsx("div",{className:"bottom-sheet-body",children:r}),s?l.jsx("footer",{className:"bottom-sheet-foot",children:s}):null]})})}),document.body)}function jx({items:e=[],value:t,onChange:n,ariaLabel:r,role:s="tablist",className:o="",tabClassName:i="",size:a="md",layout:u="equal",wrap:d=!1}){const y=["segmented-tabs",a==="sm"?"is-compact":"",u==="auto"?"is-auto":"",u==="icon"?"is-icon":"",d?"is-wrap":"",o].filter(Boolean).join(" "),g=s==="tablist"?"tab":"button",h=c.useRef([]);c.useEffect(()=>{h.current=h.current.slice(0,e.length)},[e.length]);const v=c.useMemo(()=>e.map((m,j)=>m.disabled?null:j).filter(m=>m!==null),[e]),w=c.useMemo(()=>e.findIndex(m=>m.key===t&&!m.disabled),[e,t]),k=v.length?v[0]:-1,S=w>=0?w:k,p=m=>{var b;const j=h.current[m];(b=j==null?void 0:j.focus)==null||b.call(j)},f=(m,j)=>{var E;if(!e.length)return m;let b=m;for(let I=0;I<e.length;I+=1)if(b=(b+j+e.length)%e.length,!((E=e[b])!=null&&E.disabled))return b;return m};return l.jsx("div",{className:y,role:s,"aria-label":r,children:e.map((m,j)=>{const b=m.key===t,E=m.label?String(m.label):"";return l.jsxs("button",{type:"button",ref:I=>{h.current[j]=I},role:g,"aria-selected":s==="tablist"?b:void 0,"aria-pressed":s!=="tablist"?b:void 0,"aria-controls":s==="tablist"?m.controls:void 0,className:["segmented-tab",b?"is-active":"",m.icon&&!E?"is-icon":"",m.className||"",i].filter(Boolean).join(" "),onClick:()=>{m.disabled||n==null||n(m.key)},onKeyDown:I=>{if(s!=="tablist"||!["ArrowRight","ArrowLeft","Home","End"].includes(I.key)||(I.preventDefault(),!e.length))return;let T=j;I.key==="Home"?T=v.length?v[0]:T:I.key==="End"?T=v.length?v[v.length-1]:T:I.key==="ArrowRight"?T=f(T,1):I.key==="ArrowLeft"&&(T=f(T,-1));const z=e[T];!z||z.disabled||(n==null||n(z.key),p(T))},disabled:m.disabled,title:m.title||E||m.ariaLabel,"aria-label":m.ariaLabel,tabIndex:s==="tablist"?j===S?0:-1:void 0,children:[m.icon?l.jsx("span",{className:"segmented-tab-icon",children:m.icon}):null,E?l.jsx("span",{className:"segmented-tab-label",children:E}):null,m.badge?l.jsx("span",{className:"segmented-tab-badge",children:m.badge}):null]},m.key)})})}const Tr=c.memo(jx),Sx=(e=[])=>(e||[]).map(t=>typeof t=="string"||typeof t=="number"?{value:t,label:String(t)}:{value:(t==null?void 0:t.value)??(t==null?void 0:t.id)??"",label:(t==null?void 0:t.label)??(t==null?void 0:t.name)??String((t==null?void 0:t.value)??""),disabled:!!(t!=null&&t.disabled)}),Nx=(e,t)=>{if(!t)return e;const n=t.trim().toLowerCase();return n?e.filter(r=>{const s=String(r.label||"").toLowerCase(),o=String(r.value||"").toLowerCase();return s.includes(n)||o.includes(n)}):e};function kx({value:e,onChange:t,options:n,children:r,placeholder:s,emptyLabel:o="No matches",disabled:i=!1,size:a="md",className:u="",wrapperClassName:d="",searchable:y=!1,searchPlaceholder:g="Search options...",searchValue:h,onSearchChange:v,searchAriaLabel:w="Search options",...k}){const[S,p]=c.useState(""),f=typeof h=="string"?h:S,m=v||p,j=c.useMemo(()=>Sx(n),[n]),b=c.useMemo(()=>y?Nx(j,f):j,[j,f,y]),E=["ui-control","ui-select",a==="sm"?"is-compact":"",u].filter(Boolean).join(" "),I=()=>r||(b.length?b.map(z=>l.jsx("option",{value:z.value,disabled:z.disabled,children:z.label},String(z.value))):l.jsx("option",{value:"",disabled:!0,children:o})),T=l.jsxs("select",{...k,className:E,value:e??"",onChange:z=>t==null?void 0:t(z.target.value),disabled:i,children:[s?l.jsx("option",{value:"",children:s}):null,I()]});return y?l.jsxs("div",{className:d,children:[l.jsx("input",{type:"search",value:f,onChange:z=>m(z.target.value),placeholder:g,className:"ui-control ui-input is-compact","aria-label":w,disabled:i}),T]}):T}const qe=c.memo(kx);function Cx({open:e,cwd:t,setCwd:n,page:r,setPage:s,perPage:o,setPerPage:i,totalPages:a,topDirs:u,loading:d,imagesOnly:y,setImagesOnly:g,search:h,setSearch:v,shownEntries:w,onSelect:k,onClose:S,pickerSource:p,setPickerSource:f}){if(!e)return null;const m=p||"inputs",j=typeof f=="function",b=()=>{n(""),s(1)},E=B=>{j&&B!==m&&(f(B),n(""),s(1))},I=t.split("/").filter(Boolean),T=m==="outputs"?"Choose output":"Choose input",z=[{key:"",label:"Root"},...u.map(B=>({key:B.rel_path,label:B.name}))],A=B=>{n(B),s(1)};return l.jsx(Nt,{open:e,onClose:S,title:T,variant:"fullscreen",footer:l.jsxs("div",{className:"flex items-center gap-2 w-full",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",disabled:r<=1||d,onClick:()=>s(B=>Math.max(1,B-1)),children:"Prev"}),l.jsxs("div",{className:"text-xs text-center text-[rgba(159,178,215,0.75)] min-w-[92px]",children:[r," / ",a]}),l.jsx("button",{type:"button",className:"ui-button is-muted w-full",disabled:r>=a||d,onClick:()=>s(B=>B<a?B+1:B),children:"Next"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Location"}),l.jsxs("div",{className:"imagepicker-breadcrumb",children:[l.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:b,children:"Root"}),I.map((B,le)=>{const F=I.slice(0,le+1).join("/");return l.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:()=>{n(F),s(1)},children:B},F)})]})]}),j?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Source"}),l.jsx(Tr,{ariaLabel:"Source",value:m,onChange:E,size:"sm",items:[{key:"inputs",label:"Inputs"},{key:"outputs",label:"Outputs"}]})]}):null,l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Filters"}),l.jsxs("div",{className:"composer-filters",children:[l.jsxs("label",{className:"inline-flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:y,onChange:B=>{g(B.target.checked),s(1)}}),l.jsx("span",{className:"text-sm text-[rgba(159,178,215,0.85)]",children:"Images only"})]}),l.jsx("input",{type:"search",value:h,onChange:B=>v(B.target.value),placeholder:"Search files",className:"sheet-input ui-control ui-input","aria-label":"Search files"}),l.jsx(qe,{className:"sheet-select",value:o,onChange:B=>{const le=parseInt(B,10)||50;i(le),s(1)},"aria-label":"Items per page",size:"sm",options:[25,50,100]})]})]}),u.length>0?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Quick folders"}),l.jsx(Tr,{ariaLabel:"Quick folders",value:t,onChange:A,size:"sm",layout:"auto",wrap:!0,className:"imagepicker-chips",items:z})]}):null,l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Results"}),d?l.jsxs("div",{className:"sheet-hint",children:["Scanning ",m==="outputs"?"output":"input"," folders"]}):w.length===0?l.jsx("div",{className:"sheet-hint",children:"Nothing here yet. Try a different folder or turn off Images only."}):null,l.jsx("div",{className:"imagepicker-grid",children:!d&&w.map(B=>{const le=`${B.source||"input"}::${B.rel_path||B.name}`,F=B.is_dir?"":B.preview_url||(B.source==="output"?fo({filename:B.filename,subfolder:B.subfolder,type:B.type}):uo(B.rel_path||""));return l.jsx("button",{type:"button",className:`imagepicker-item ${B.is_dir?"is-dir":""}`,onClick:()=>{B.is_dir?(n(B.rel_path||""),s(1)):k(B)},children:B.is_dir?l.jsxs("div",{className:"imagepicker-dir-row",children:[l.jsx("div",{className:"imagepicker-dir-dot","aria-hidden":"true"}),l.jsx("div",{className:"imagepicker-name",children:B.name})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"imagepicker-thumb",children:F?l.jsx("img",{className:"imagepicker-img",alt:B.name,src:F}):l.jsx("div",{className:"imagepicker-img is-placeholder"})}),l.jsx("div",{className:"imagepicker-name",children:B.name})]})},le)})})]})]})})}function bx({open:e,onClose:t,title:n,url:r,kind:s="image"}){return r?l.jsx(Nt,{open:e,onClose:t,title:n||"Preview",variant:"fullscreen",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("a",{href:r,target:"_blank",rel:"noreferrer",className:"ui-button is-muted w-full text-center",children:"Open"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Close"})]}),children:l.jsx("div",{className:"url-viewer-stage",children:s==="video"?l.jsx("video",{src:r,controls:!0,className:"url-viewer-media",autoPlay:!0}):l.jsx("img",{src:r,alt:n||"Preview",className:"url-viewer-media"})})}):null}function Ex({input:e,value:t,onFormChange:n}){const{previewUrl:r,imgReady:s,setImgReady:o,displayName:i,serverOpen:a,openServer:u,closeServer:d,cwd:y,setCwd:g,page:h,setPage:v,perPage:w,setPerPage:k,totalPages:S,topDirs:p,loading:f,search:m,setSearch:j,imagesOnly:b,setImagesOnly:E,shownEntries:I,pickerSource:T,setPickerSource:z,handleUpload:A,clearImage:B,selectServer:le}=wx({input:e,value:t,onFormChange:n}),F=c.useRef(null),ge=c.useRef(null),[ue,K]=c.useState(0),[fe,R]=c.useState(!1);c.useEffect(()=>{const P=ge.current;if(!P)return;const V=Z=>{Z.preventDefault(),Z.stopPropagation()},G=async Z=>{var X,se;V(Z);const ee=(se=(X=Z.dataTransfer)==null?void 0:X.files)==null?void 0:se[0];ee&&(await A(ee),F.current&&(F.current.value=""),K(W=>W+1))};return["dragenter","dragover","dragleave","drop"].forEach(Z=>P.addEventListener(Z,Z==="drop"?G:V)),()=>{["dragenter","dragover","dragleave","drop"].forEach(Z=>P.removeEventListener(Z,Z==="drop"?G:V))}},[A]);const N=async P=>{var G;const V=(G=P.target.files)==null?void 0:G[0];V&&(await A(V),F.current&&(F.current.value=""),K(Z=>Z+1))},_=()=>{F.current&&F.current.click()};return l.jsxs("div",{className:"asset-card",children:[l.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[l.jsx("h3",{className:"text-sm font-semibold text-[#F8F4FF] truncate",children:i}),l.jsx("span",{className:"text-[11px] text-[#C3C7FFB3] truncate",children:"Image"})]}),l.jsx("div",{ref:ge,className:"mb-3 rounded-xl border border-dashed border-[rgba(255,255,255,0.14)] bg-[rgba(255,255,255,0.02)] flex items-center justify-center min-h-[140px] sm:min-h-[180px] overflow-hidden",children:r?l.jsx("button",{type:"button",className:"asset-preview-btn",onClick:()=>R(!0),"aria-label":`Preview ${i}`,title:"Open preview",children:l.jsx("img",{src:r,alt:i,className:`max-h-64 max-w-full object-contain transition-opacity ${s?"opacity-100":"opacity-0"}`,onLoad:()=>o(!0)})}):l.jsx("div",{className:"text-[11px] text-[#9DA3FFCC] text-center px-6",children:"Drop an image here, upload from your device, or choose one from your server."})}),l.jsx("input",{ref:F,type:"file",accept:"image/*",className:"hidden",onChange:N},ue),l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx("button",{type:"button",className:"ui-button is-primary is-compact",onClick:u,children:"Choose"}),l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:_,children:"Upload"}),l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:B,children:"Clear"})]}),l.jsx(Cx,{open:a,cwd:y,setCwd:g,page:h,setPage:v,perPage:w,setPerPage:k,totalPages:S,topDirs:p,loading:f,imagesOnly:b,setImagesOnly:E,search:m,setSearch:j,shownEntries:I,pickerSource:T,setPickerSource:z,onSelect:le,onClose:d}),l.jsx(bx,{open:fe,onClose:()=>R(!1),title:i||"Preview",url:r,kind:"image"})]})}function Lx({open:e,onClose:t,title:n,description:r,render:s,index:o=0,total:i=0,children:a}){const[u,d]=c.useState("idle"),y=c.useRef(null),g=c.useRef(null),h=w=>w?Array.from(w.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(k=>!k.hasAttribute("disabled")&&k.getAttribute("aria-hidden")!=="true"):[];if(c.useEffect(()=>{if(u==="queued"){const w=setTimeout(()=>d("idle"),1600);return()=>clearTimeout(w)}},[u]),c.useEffect(()=>{if(!e||typeof document>"u")return;const w=y.current;g.current=document.activeElement;const k=()=>{var m;const f=h(w)[0]||w;(m=f==null?void 0:f.focus)==null||m.call(f)},S=p=>{if(p.key==="Escape"){t==null||t();return}if(p.key!=="Tab"||!w)return;const f=h(w);if(!f.length){p.preventDefault(),w.focus();return}const m=f[0],j=f[f.length-1],b=document.activeElement;p.shiftKey&&b===m?(p.preventDefault(),j.focus()):!p.shiftKey&&b===j&&(p.preventDefault(),m.focus())};return requestAnimationFrame(k),w==null||w.addEventListener("keydown",S),()=>{var f;w==null||w.removeEventListener("keydown",S);const p=g.current;p&&document.contains(p)&&((f=p.focus)==null||f.call(p))}},[e,t]),!e)return null;const v=typeof s=="function"?s():a;return l.jsxs("div",{className:"spotlight-overlay",role:"dialog","aria-modal":"true",children:[l.jsx("div",{className:"spotlight-backdrop",onClick:t}),l.jsxs("div",{className:"spotlight-sheet",ref:y,tabIndex:-1,children:[l.jsxs("div",{className:"spotlight-header",children:[l.jsxs("div",{className:"spotlight-meta",children:[l.jsx("div",{className:"spotlight-kicker",children:"Focused control"}),l.jsx("div",{className:"spotlight-title",children:n||"Control"}),r?l.jsx("div",{className:"spotlight-hint",children:r}):null]}),l.jsx("button",{type:"button",className:"spotlight-close",onClick:t,"aria-label":"Close",children:l.jsx(on,{size:16})})]}),l.jsx("div",{className:"spotlight-body",children:v}),l.jsx("div",{className:"spotlight-footer",children:l.jsx("div",{className:"spotlight-footer-right",children:l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:t,"aria-label":"Close",children:"Close"})})})]})]})}function Px({open:e,onClose:t,title:n,value:r,onChange:s,placeholder:o="",description:i}){const a=n||"Edit",u=c.useMemo(()=>`sheet-textarea-${Math.random().toString(36).slice(2,9)}`,[]);return l.jsxs(Nt,{open:e,onClose:t,title:a,variant:"fullscreen",footer:l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Done"}),children:[i?l.jsx("div",{className:"text-[12px] text-[rgba(159,178,215,0.75)] mb-3",children:i}):null,l.jsx("textarea",{id:u,value:r??"",onChange:d=>s==null?void 0:s(d.target.value),placeholder:o,className:"sheet-textarea ui-control ui-textarea",rows:12})]})}function hn(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(2).replace(/\.?0+$/u,""):"1"}function _x(e=""){const t=String(e||"");if(!t.trim())return[];const n=[];let r=0;for(;r<t.length;){for(;r<t.length&&/[\s,]/.test(t[r]);)r++;if(r>=t.length)break;let s=r,o=r,i="tag",a="";const u=t[r]==="(";if(u&&(s=r,r++),t[r]==="$"){i="alias";const d=r;for(r++;r<t.length&&t[r]!=="$"&&t[r]!==","&&t[r]!==`
`;)a+=t[r],r++;t[r]==="$"&&r++,u||(s=d)}else{i="tag";const d=r;for(;r<t.length&&!(t[r]===","||t[r]==="$"||t[r]===`
`||u&&t[r]===":"||!u&&t[r]==="(");)a+=t[r],r++;a=a.trim(),u||(s=d)}if(u&&t[r]===":"){for(r++;r<t.length&&t[r]!==")"&&t[r]!==","&&t[r]!==`
`;)r++;t[r]===")"&&r++}o=r,a&&n.push({type:i,text:a,start:s,end:o})}return n}function jd(e="",t){if(!t||typeof t.start!="number"||typeof t.end!="number")return null;const r=String(e||"").slice(t.start,t.end);if(!r.startsWith("(")||!r.includes(":"))return null;const s=r.lastIndexOf(":");if(s===-1)return null;const o=r.slice(s+1);if(!o.endsWith(")"))return null;const i=o.slice(0,-1).trim();if(!/^\d+(\.\d+)?$/u.test(i))return null;const a=Number.parseFloat(i);return Number.isFinite(a)?{weight:a,wrapperStart:t.start,wrapperEnd:t.end}:null}function Sd(e="",t,n){const r=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return r;const s=n==null?null:Number(n),o=s===null||!Number.isFinite(s)||Math.abs(s-1)<1e-6,i=t.type==="alias"?`$${t.text}$`:t.text;if(o)return r.slice(0,t.start)+i+r.slice(t.end);const a=hn(s),u=`(${i}:${a})`;return r.slice(0,t.start)+u+r.slice(t.end)}function Nd(e="",t,n,r){var h;if(n===r||n===null||r===null||!(t!=null&&t.length))return e;const s=String(e||""),o=t.map(v=>({start:v.start,end:v.end,text:s.slice(v.start,v.end)})),i=o.slice(0,-1).map((v,w)=>{const k=o[w+1];return s.slice(v.end,k.start)}),a=o.length?s.slice(0,o[0].start):"",u=o.length?s.slice(o[o.length-1].end):"",d=[...o],[y]=d.splice(n,1);d.splice(r,0,y);let g=a+(((h=d[0])==null?void 0:h.text)||"");for(let v=1;v<d.length;v++)g+=(i[v-1]??", ")+d[v].text;return g+=u,g}function Rx(e="",t){const n=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return n;const r=n.slice(0,t.start).replace(/[\s,]*$/,""),s=n.slice(t.end).replace(/^[\s,]*/,"");return r?`${r}, ${s}`.trim():s.trim()}function hr(e="",t){if(!t||typeof t.index!="number"||typeof t.length!="number")return null;const n=String(e||""),r=t.index,s=t.index+t.length;if(r<=0||n[r-1]!=="("||n[s]!==":")return null;let o=s+1,i="";for(;o<n.length&&n[o]!==")";)if(i+=n[o],o+=1,i.length>12)return null;if(o>=n.length||n[o]!==")")return null;const a=i.trim();if(!/^\d+(\.\d+)?$/u.test(a))return null;const u=Number.parseFloat(a);return Number.isFinite(u)?{weight:u,wrapperStart:r-1,wrapperEnd:o+1}:null}function xl(e="",t,n){const r=String(e||"");if(!t||typeof t.index!="number"||typeof t.length!="number")return r;const s=t.index,o=t.index+t.length,i=hr(r,t),a=n==null?null:Number(n),u=a===null||!Number.isFinite(a)||Math.abs(a-1)<1e-6;if(i){if(u)return r.slice(0,i.wrapperStart)+r.slice(s,o)+r.slice(i.wrapperEnd);const y=hn(a);return r.slice(0,o+1)+y+r.slice(i.wrapperEnd-1)}if(u)return r;const d=hn(a);return r.slice(0,s)+"("+r.slice(s,o)+":"+d+")"+r.slice(o)}function wl(e,t,n){const r=Number(e);return Number.isFinite(r)?Math.max(t,Math.min(n,r)):t}function Ea({open:e,onClose:t,title:n="Alias strength",tokenLabel:r="",weight:s=1,onApply:o,onRemoveWeight:i,onDeleteToken:a}){const u=c.useMemo(()=>wl(s||1,.2,2),[s]),[d,y]=c.useState(u);c.useEffect(()=>{e&&y(u)},[e,u]);const g=hn(d);return l.jsx(Nt,{open:e,onClose:t,title:n,footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:t,children:"Cancel"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>{o==null||o(d),t==null||t()},children:"Done"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Alias"}),l.jsx("div",{className:"sheet-hint",children:r||""})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Strength"}),l.jsxs("div",{className:"flex items-center justify-between gap-3",children:[l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>y(h=>wl(h-.05,.2,2)),children:""}),l.jsxs("div",{className:"text-sm text-[rgba(237,242,255,0.92)] tabular-nums",children:[g,""]}),l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>y(h=>wl(h+.05,.2,2)),children:"+"})]}),l.jsx("input",{type:"range",min:.2,max:2,step:.05,value:d,onChange:h=>y(wl(h.target.value,.2,2)),className:"w-full","aria-label":"Alias strength"}),l.jsx("div",{className:"sheet-hint",children:"1.0 is normal. Increase to emphasize or reduce to soften."})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Actions"}),l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>y(1),children:"Reset to 1.0"}),l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>{i==null||i(),t==null||t()},children:"Remove strength"}),l.jsx("button",{type:"button",className:"ui-button is-danger is-compact",onClick:()=>{a==null||a(),t==null||t()},children:"Remove alias"})]})]})]})})}function Zn(e){const t=String(e||"").trim();if(!t)return"";const n=t.toLowerCase(),r={scifi:"Sci-Fi",sci:"Sci",ui:"UI",vfx:"VFX",hdr:"HDR",dof:"DoF",bokeh:"Bokeh",vhs:"VHS",jpeg:"JPEG",jpg:"JPG",png:"PNG",gif:"GIF",webp:"WebP",api:"API",nsfw:"NSFW",sfw:"SFW",sfx:"SFX",fx:"FX",lora:"LoRA",loras:"LoRAs",ip:"IP",egirl:"E-girl",i2v:"I2V",t2i:"T2I",img2img:"Img2Img",txt2img:"Txt2Img",tts:"TTS",asmr:"ASMR",ai:"AI",highleg:"High-Leg","one-piece":"One-Piece","three-quarter":"Three-Quarter"};return r[n]?r[n]:/^\d+$/.test(n)?n:n==="3d"?"3D":n==="2d"?"2D":n.length===1?n.toUpperCase():n.charAt(0).toUpperCase()+n.slice(1)}function Ix(e=""){const t=String(e||"").trim().toLowerCase();return t?t.startsWith("flirty_")?"flirty":t.startsWith("action_")||t.startsWith("dynamic_")||t.startsWith("stealth_")||t.startsWith("athletic_")||t.startsWith("running_")||t.startsWith("walking_")?"action":t.startsWith("sleepy_")||t.startsWith("relaxed_")||t.startsWith("reclining_")||t.startsWith("sitting_")||t.startsWith("kneeling_")?"rest":t.startsWith("happy_")||t.startsWith("sad_")||t.startsWith("angry_")||t.startsWith("nervous_")||t.startsWith("smug_")||t.startsWith("surprised_")||t.startsWith("scared_")||t.startsWith("tipsy_")?"emotion":t.startsWith("composed_")||t.startsWith("contemplative_")||t.startsWith("looking_")?"posed":"everyday":""}function zx(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return n==="lingerie"?"lingerie":n==="swimwear"||n==="swim"?"swimwear":n==="costumes"||n==="tech"?"costumes":n==="uniform"?"uniform":n==="formal"?"formal":n==="alt"?"alt":n==="casual"||n==="street"||n==="lounge"||n==="sporty"||n==="dress"?"everyday":n||"everyday"}function Ax(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return["fire","candlelight","embers"].includes(n)?"fire":["moonlight"].includes(n)?"night":["neon"].includes(n)?"neon":["studio","stage","sidelighting","dim"].includes(n)?"studio":["golden","sunbeam","dappled"].includes(n)?"natural":["lens","light"].includes(n)?"effects":n||"other"}function ds(e="",t=""){const n=String(e||"").trim(),r=String(t||"").trim().toLowerCase();if(!n)return"";if(r==="outfit")return zx(n)||"everyday";if(r==="pose")return Ix(n)||"everyday";if(r==="lighting")return Ax(n)||"effects";const s=n.indexOf("_");return s<=0?"":n.slice(0,s).trim()}function zm(e=""){const t=String(e||"").trim();return t?t.includes(":")?t.split(":").slice(1).join(":"):t:""}function Tl({token:e="",name:t=""}={}){const n=String(t||"").trim()||zm(e);if(!n)return"";let s=n.replace(/_(\d+)$/u,"").split("_").filter(Boolean);if(s.length===0)return n;const o=[];for(let g=0;g<s.length;g++){const h=s[g],v=s[g+1];if(h&&v&&h.toLowerCase()==="one"&&v.toLowerCase()==="piece"){o.push("one-piece"),g+=1;continue}if(h&&v&&h.toLowerCase()==="three"&&v.toLowerCase()==="quarter"){o.push("three-quarter"),g+=1;continue}o.push(h)}if(s=o,Array.from(new Set(s.map(g=>String(g).toLowerCase()))).length===1)return Zn(s[0]);const a=s[0],u=s.slice(1),d=Zn(a),y=u.map(Zn).join(" ").trim();return y?y.toLowerCase()===d.toLowerCase()?u.length===1&&String(u[0]).toLowerCase()===String(a).toLowerCase()?d||n:s.map(Zn).join(" ").trim()||n:`${d} - ${y}`:s.map(Zn).join(" ").trim()||n}function Ac(e){if(!e)return{subcategory:"",displayName:""};const t=e.name||"",n=e.token||"",r=zm(n)||t,s=ds(r,e.category)||"other",o=Tl({token:n,name:t})||n||t||"Alias";return{subcategory:s,displayName:o}}function fn(e=""){const t=String(e||"").trim();return t?t==="All"?"All":{action:"Actions",camera:"Camera",body:"Body",char:"Characters",mood:"Mood",outfit:"Outfits",pose:"Poses",prop:"Props",scene:"Scenes",weather:"Weather",style:"Style",hair:"Hair",lighting:"Lighting"}[t]||Zn(t):""}function Vn(e=""){const t=String(e||"").trim();return t?t==="All"?"All":t.split(/[_-]+/u).filter(Boolean).map(n=>Zn(n)).join(" ").trim():""}const Tx={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function $x({name:e,label:t,description:n,value:r,onChange:s,onEnter:o,disabled:i=!1,multiline:a=!1,aliasOptions:u=[],aliasCatalog:d=[],onOpenComposer:y}){var nt,Te;const g=c.useRef(null),h=c.useRef(null),v=c.useRef({start:null,end:null}),w=c.useRef(null),k=c.useRef(null),[S,p]=c.useState(null),[f,m]=c.useState(null),[j,b]=c.useState(!1),[E,I]=c.useState(""),T=c.useDeferredValue(E),[z,A]=c.useState("All"),[B,le]=c.useState("All"),[F]=c.useState([]),ge=c.useRef(null),[ue,K]=c.useState(!1),[fe,R]=c.useState(!1),[N,_]=c.useState(null),P=typeof r=="string"?r:String(r??"");c.useMemo(()=>Array.isArray(u)?u.filter(Boolean):[],[u]);const V=c.useMemo(()=>(Array.isArray(d)?d.filter(x=>x&&x.name):[]).map(x=>({...x,...Ac(x)})),[d]),G=c.useMemo(()=>V,[V]),Z=x=>{const L=x.target.value;s==null||s(L)},ee=x=>{if(!a&&x.key==="Enter"){x.preventDefault(),o==null||o(x.target.value,x);return}},X=c.useMemo(()=>{const x=new Map;return G.forEach(L=>{L!=null&&L.token&&x.set(String(L.token).toLowerCase(),L)}),x},[G]),se=c.useMemo(()=>{const x=new Set(["All"]);return V.forEach(L=>{L.category&&x.add(L.category)}),Array.from(x).sort((L,U)=>L.localeCompare(U))},[V]),W=c.useMemo(()=>{const x=new Set(["All"]);return G.forEach(L=>{(!z||z==="All"||L.category===z)&&L.subcategory&&x.add(L.subcategory)}),Array.from(x).sort((L,U)=>L.localeCompare(U))},[G,z]);c.useEffect(()=>{le("All")},[z]);const M=c.useMemo(()=>{const x=P||"";if(!x||!x.includes("$"))return[];const L=[],U=/\$([a-z0-9_:-]+)\$/gi;let Y;for(;Y=U.exec(x);)L.push({token:Y[1],index:Y.index,length:Y[0].length});return L},[P]),O=()=>{try{const x=g.current;x?v.current={start:x.selectionStart??null,end:x.selectionEnd??null}:v.current={start:null,end:null}}catch{v.current={start:null,end:null}}h.current&&h.current.scrollIntoView({block:"center",behavior:"smooth"}),b(!0)},te=c.useMemo(()=>{const x=T.trim().toLowerCase();return G.filter(L=>{var U,Y,pe,ae;return z!=="All"&&(L.category||"")!==z||B!=="All"&&(L.subcategory||"other")!==B?!1:x?((U=L.token)==null?void 0:U.toLowerCase().includes(x))||((Y=L.text)==null?void 0:Y.toLowerCase().includes(x))||((pe=L.name)==null?void 0:pe.toLowerCase().includes(x))||((ae=L.displayName)==null?void 0:ae.toLowerCase().includes(x)):!0}).sort((L,U)=>{const Y=(L.subcategory||"").toLowerCase(),pe=(U.subcategory||"").toLowerCase();return Y!==pe?Y.localeCompare(pe):L.token.localeCompare(U.token)})},[G,z,B,T]),[H,ve]=c.useState(30),Ne=c.useMemo(()=>te.slice(0,H),[te,H]);c.useEffect(()=>{ve(30)},[z,B,E,V]),c.useEffect(()=>{le("All")},[z]);const je=(x,{closeAfter:L=!0}={})=>{var Js,Zs;const U=g.current,Y=`$${x}$`,pe=P||"",ae=(Js=v.current)==null?void 0:Js.start,ke=(Zs=v.current)==null?void 0:Zs.end,Ce=(U==null?void 0:U.selectionStart)??(typeof ae=="number"?ae:pe.length),he=(U==null?void 0:U.selectionEnd)??(typeof ke=="number"?ke:pe.length),rt=pe.slice(0,Ce),Yt=pe.slice(he),Je=rt.match(/[^\s]$/),Ze=Yt.match(/^[^\s]/),yt=Je&&Je[0]!==","?", ":"",qt=Ze&&Ze[0]!==","?", ":"",qr=rt+yt+Y+qt+Yt;s==null||s(qr);const Xr=(rt+yt+Y+qt).length;v.current={start:Xr,end:Xr},L&&(b(!1),requestAnimationFrame(()=>{var el;(el=U==null?void 0:U.blur)==null||el.call(U)}))},Ee=x=>{const L=P||"",U=hr(L,x),Y=U?U.wrapperStart:x.index,pe=U?U.wrapperEnd:x.index+x.length,ae=L.slice(0,Y).replace(/[\s,]*$/,""),ke=L.slice(pe).replace(/^[\s,]*/,""),Ce=ae?`${ae} ${ke}`.trim():ke.trim();s==null||s(Ce)},_e=x=>{if(!x)return;const L=X.get(x.token.toLowerCase()),U=(L==null?void 0:L.displayName)||x.token,Y=hr(P||"",x);_({tokenObj:x,displayName:U,weight:(Y==null?void 0:Y.weight)??1}),R(!0),requestAnimationFrame(()=>{var pe,ae;return(ae=(pe=g.current)==null?void 0:pe.blur)==null?void 0:ae.call(pe)})},ne=c.useMemo(()=>(x,L)=>{var Yt;if(x===L||x===null||L===null||!(M!=null&&M.length))return;const U=P||"",Y=M.map(Je=>{const Ze=hr(U,Je),yt=Ze?Ze.wrapperStart:Je.index,qt=Ze?Ze.wrapperEnd:Je.index+Je.length;return{start:yt,end:qt,text:U.slice(yt,qt)||`$${Je.token}$`}}),pe=Y.slice(0,-1).map((Je,Ze)=>{const yt=Y[Ze+1];return U.slice(Je.end,yt.start)}),ae=Y.length?U.slice(0,Y[0].start):"",ke=Y.length?U.slice(Y[Y.length-1].end):"",Ce=[...Y],[he]=Ce.splice(x,1);Ce.splice(L,0,he);let rt=ae+(((Yt=Ce[0])==null?void 0:Yt.text)||"");for(let Je=1;Je<Ce.length;Je+=1)rt+=(pe[Je-1]??", ")+Ce[Je].text;rt+=ke,s==null||s(rt)},[s,M,P]),Re=(x,L)=>{p(L),w.current=x.currentTarget,x.dataTransfer.effectAllowed="move",x.dataTransfer.setData("text/plain",String(L)),requestAnimationFrame(()=>{w.current&&w.current.classList.add("is-dragging")})},Se=(x,L)=>{x.preventDefault(),x.dataTransfer.dropEffect="move",L!==f&&m(L)},ze=x=>{x!==f&&m(x)},J=x=>{S!==null&&x!==null&&S!==x&&ne(S,x),p(null),m(null),w.current=null},de=()=>{w.current&&w.current.classList.remove("is-dragging"),J(f)},me=(x,L)=>{x.preventDefault(),J(L)},ie=(x,L)=>{var pe,ae;if(!((ae=(pe=x.target)==null?void 0:pe.closest)==null?void 0:ae.call(pe,".token-chip-drag-handle")))return;const Y=x.touches[0];k.current={idx:L,startX:Y.clientX,startY:Y.clientY,moved:!1}},D=x=>{if(!k.current)return;const L=x.touches[0],U=Math.abs(L.clientX-k.current.startX),Y=Math.abs(L.clientY-k.current.startY);if(U<=10&&Y<=10)return;k.current.moved=!0,p(k.current.idx),x.preventDefault();const pe=h.current,ae=pe?pe.querySelectorAll(".token-chip-draggable"):document.querySelectorAll(".token-chip-draggable"),ke=L.clientX,Ce=L.clientY;for(let he=0;he<ae.length;he++){const rt=ae[he].getBoundingClientRect();if(ke>=rt.left&&ke<=rt.right&&Ce>=rt.top&&Ce<=rt.bottom){m(he);break}}},Q=()=>{var x;(x=k.current)!=null&&x.moved&&S!==null&&f!==null&&S!==f&&ne(S,f),k.current=null,p(null),m(null)},oe={id:e,name:e,value:P,onChange:Z,disabled:i,className:"ui-control ui-input pr-10 text-[13px] sm:text-sm",placeholder:"","aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0},ye=()=>{b(!1),requestAnimationFrame(()=>{var x,L;(L=(x=g.current)==null?void 0:x.blur)==null||L.call(x)})},Le=(()=>{const x=String(e||"").toLowerCase(),L=String(t||"").toLowerCase();return!!`${x} ${L}`.trim().includes("prompt")})(),Xe=()=>l.jsx(Nt,{open:j,onClose:ye,title:Le?"Insert alias":"Aliases",footer:l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:ye,children:"Done"}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Search"}),l.jsxs("div",{className:"composer-filters",children:[l.jsx("input",{ref:ge,type:"text",value:E,onChange:x=>I(x.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),l.jsx(qe,{value:z,onChange:A,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:["All",...se.filter(x=>x!=="All")].map(x=>({value:x,label:x==="All"?"Category: All":fn(x)}))}),W.length>2?l.jsx(qe,{value:B,onChange:le,className:"composer-subcategory-select",size:"sm",options:W.map(x=>({value:x,label:x==="All"?"All subcategories":Vn(x)}))}):null]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Results"}),l.jsx("div",{className:"composer-alias-list",children:te.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):l.jsxs(l.Fragment,{children:[Ne.map(x=>l.jsxs("button",{type:"button",onClick:()=>je(x.token,{closeAfter:!Le}),className:"composer-alias-item",style:Tx,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:x.displayName||x.token}),x.category?l.jsx("span",{className:"composer-alias-category",children:fn(x.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",x.token,"$"]}),l.jsx("div",{className:"composer-alias-text",children:x.text})]},x.key)),H<te.length?l.jsxs("button",{type:"button",onClick:()=>ve(x=>Math.min(x+30,te.length)),className:"ui-button is-muted w-full",children:["Show more (",te.length-H," left)"]}):null]})})]})]})});return a?l.jsxs("div",{className:"relative space-y-2",ref:h,children:[y&&!Le?l.jsxs("div",{className:"stringinput-toolbar",children:[l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>y(e),children:"Open composer"}),V.length?l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:O,children:"Aliases"}):null,l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>K(!0),children:"Expand"})]}):null,l.jsx("textarea",{ref:g,...oe,rows:3,wrap:"soft",onKeyDown:ee,className:oe.className+" resize-none min-h-[88px] max-h-[160px] leading-relaxed overflow-y-auto overflow-x-hidden break-words whitespace-pre-wrap",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"anywhere"}}),y&&Le?l.jsx("div",{className:"stringinput-underbar",children:l.jsxs("div",{className:"stringinput-underbar-actions",children:[l.jsx("button",{type:"button",className:"stringinput-action-link",onClick:()=>y(e),children:"Open composer"}),V.length?l.jsx("button",{type:"button",className:"stringinput-action-link",onClick:O,children:"Insert alias"}):null]})}):null,l.jsx(Px,{open:ue,onClose:()=>K(!1),title:t||e,value:P,onChange:s,description:n}),M.length?l.jsxs("div",{className:"stringinput-tokens",children:[l.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",l.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),l.jsx("div",{className:"stringinput-tokens-list",children:M.map((x,L)=>{var Ce;const U=X.get(x.token.toLowerCase()),Y=(U==null?void 0:U.displayName)||x.token,pe=S===L,ae=f===L&&S!==null&&S!==L,ke=((Ce=hr(P||"",x))==null?void 0:Ce.weight)??1;return l.jsxs("div",{className:`token-chip token-chip-draggable ${pe?"is-dragging":""} ${ae?"is-drop-target":""}`,title:`$${x.token}$`,role:"button",tabIndex:0,draggable:!0,onDragStart:he=>Re(he,L),onDragEnd:de,onDragEnter:()=>ze(L),onDragOver:he=>Se(he,L),onDrop:he=>me(he,L),onTouchStart:he=>ie(he,L),onTouchMove:D,onTouchEnd:Q,onClick:()=>{S===null&&_e(x)},onKeyDown:he=>{(he.key==="Enter"||he.key===" ")&&(he.preventDefault(),_e(x))},children:[l.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:l.jsx(Na,{size:14})}),l.jsx("span",{className:"token-chip-label",children:Y}),Math.abs(ke-1)>1e-6?l.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${hn(ke)}x`,children:["",hn(ke)]}):null,l.jsx("button",{type:"button",className:"token-chip-remove",onClick:he=>{he.stopPropagation(),Ee(x)},"aria-label":`Remove ${x.token}`,children:l.jsx(on,{size:12})})]},`${x.token}-${x.index}`)})})]}):null,l.jsx(Ea,{open:fe,onClose:()=>R(!1),title:"Alias strength",tokenLabel:N?`${N.displayName}  $${(nt=N.tokenObj)==null?void 0:nt.token}$`:"",weight:(N==null?void 0:N.weight)??1,onApply:x=>{N!=null&&N.tokenObj&&(s==null||s(xl(P||"",N.tokenObj,x)))},onRemoveWeight:()=>{N!=null&&N.tokenObj&&(s==null||s(xl(P||"",N.tokenObj,null)))},onDeleteToken:()=>{N!=null&&N.tokenObj&&Ee(N.tokenObj)}}),j?l.jsx(Xe,{}):null]}):l.jsxs("div",{className:"relative space-y-2",ref:h,children:[l.jsx("input",{...oe,type:"text",inputMode:"text",autoComplete:"off",onKeyDown:ee,className:oe.className+" min-h-[44px]",ref:g}),M.length?l.jsxs("div",{className:"stringinput-tokens",children:[l.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",l.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),l.jsx("div",{className:"stringinput-tokens-list",children:M.map((x,L)=>{var Ce;const U=X.get(x.token.toLowerCase()),Y=(U==null?void 0:U.displayName)||x.token,pe=S===L,ae=f===L&&S!==null&&S!==L,ke=((Ce=hr(P||"",x))==null?void 0:Ce.weight)??1;return l.jsxs("div",{className:`token-chip token-chip-draggable ${pe?"is-dragging":""} ${ae?"is-drop-target":""}`,title:`$${x.token}$`,onClick:()=>{S===null&&_e(x)},role:"button",tabIndex:0,draggable:!0,onDragStart:he=>Re(he,L),onDragEnd:de,onDragEnter:()=>ze(L),onDragOver:he=>Se(he,L),onDrop:he=>me(he,L),onTouchStart:he=>ie(he,L),onTouchMove:D,onTouchEnd:Q,onKeyDown:he=>{(he.key==="Enter"||he.key===" ")&&(he.preventDefault(),_e(x))},children:[l.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:l.jsx(Na,{size:14})}),l.jsx("span",{className:"token-chip-label",children:Y}),Math.abs(ke-1)>1e-6?l.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${hn(ke)}x`,children:["",hn(ke)]}):null,l.jsx("button",{type:"button",className:"token-chip-remove",onClick:he=>{he.stopPropagation(),Ee(x)},"aria-label":`Remove ${x.token}`,children:l.jsx(on,{size:12})})]},`${x.token}-${x.index}`)})})]}):null,l.jsx(Ea,{open:fe,onClose:()=>R(!1),title:"Alias strength",tokenLabel:N?`${N.displayName}  $${(Te=N.tokenObj)==null?void 0:Te.token}$`:"",weight:(N==null?void 0:N.weight)??1,onApply:x=>{N!=null&&N.tokenObj&&(s==null||s(xl(P||"",N.tokenObj,x)))},onRemoveWeight:()=>{N!=null&&N.tokenObj&&(s==null||s(xl(P||"",N.tokenObj,null)))},onDeleteToken:()=>{N!=null&&N.tokenObj&&Ee(N.tokenObj)}}),V.length?l.jsx("button",{type:"button",className:"stringinput-trailing ui-button is-ghost is-compact",onClick:()=>y?y(e):O(),title:y?"Open prompt composer":"Insert alias","aria-label":y?"Open prompt composer":"Insert alias",children:y?l.jsx(Rc,{size:16}):l.jsx(Gn,{size:16})}):null,l.jsx(Xe,{})]})}const kd=c.memo($x),Cd=e=>e==null?void 0:String(e).trim().replace(/[^A-Za-z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||void 0;function Mx({name:e,label:t,description:n,value:r,onChange:s,disabled:o=!1,min:i,max:a,step:u,isFloat:d=!1,inputId:y}){const g=u??(d?.01:1),h=y??Cd(e),v=S=>{if(S===""||S===null||S===void 0)return"";const p=d?parseFloat(S):parseInt(S,10);return Number.isNaN(p)?"":p},w=S=>{const p=S.target.value,f=v(p);s==null||s(f)},k=S=>{if(S.key!=="ArrowUp"&&S.key!=="ArrowDown")return;S.preventDefault();const p=typeof r=="number"?r:v(String(r??""))||0,f=S.key==="ArrowUp"?g:-g;let m=p+f;if(typeof i=="number"&&(m=Math.max(i,m)),typeof a=="number"&&(m=Math.min(a,m)),d){const j=typeof g=="number"?(String(g).split(".")[1]||"").length:2;m=parseFloat(m.toFixed(Math.max(j,2)))}s==null||s(m)};return l.jsxs("div",{className:"w-full flex items-center gap-2",children:[l.jsx("input",{id:h,name:e,type:"number",inputMode:d?"decimal":"numeric",value:r??"",onChange:w,onKeyDown:k,disabled:o,min:i,max:a,step:g,"aria-label":t||e,"aria-describedby":n?`${h||Cd(e)||e}-description`:void 0,className:"ui-control ui-input"}),typeof i=="number"||typeof a=="number"?l.jsxs("div",{className:"hidden sm:flex flex-col text-[10px] text-[#6A6FA8] text-right leading-tight",children:[typeof i=="number"&&l.jsxs("span",{children:["min ",i]}),typeof a=="number"&&l.jsxs("span",{children:["max ",a]})]}):null]})}const Ss=c.memo(Mx);function Ox({name:e,label:t,description:n,value:r,onChange:s,disabled:o=!1}){const i=!!r,a=()=>{o||s==null||s(!i)},u=d=>{(d.key===" "||d.key==="Enter")&&(d.preventDefault(),a())};return l.jsxs("button",{id:e,type:"button",role:"switch","aria-checked":i,"aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0,onClick:a,onKeyDown:u,disabled:o,className:`ui-switch ${i?"is-on":""}`,children:[l.jsx("span",{className:"ui-switch-track",children:l.jsx("span",{className:"ui-switch-knob"})}),l.jsx("span",{className:"ui-switch-state",children:i?"On":"Off"})]})}const bd=c.memo(Ox),Fx=/\.(safetensors|ckpt|pt|pth)$/i;function Tc(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const r=t.replace(/\\/g,"/").split("/").filter(Boolean).pop()||"";return Fx.test(r)}function Am(e){if(typeof e!="string")return{folder:"",base:""};const n=e.trim().replace(/\\/g,"/").split("/").filter(Boolean),s=(n.pop()||"").replace(/\.[^.]+$/,"");return{folder:n.join(" ").trim(),base:s}}function La(e){if(!Tc(e))return e;const{folder:t,base:n}=Am(e);if(!n)return e;if(!t)return n;const r=t.split(/\s+/).filter(Boolean),s=r[r.length-1]||"";if(s&&n.toLowerCase().startsWith(s.toLowerCase())){const o=n.slice(s.length);return o?`${t}${o}`:t}return`${t} ${n}`.trim()}function Dx(e,t){try{if(typeof window>"u"||!e)return null;const n=e.getItem(t);return n?JSON.parse(n):null}catch{return null}}function Fo(e,t,n){try{if(typeof window>"u"||!e)return;e.setItem(t,JSON.stringify(n))}catch{}}function Qt(){try{return typeof window>"u"?null:window.sessionStorage||null}catch{return null}}function Yr(){try{return typeof window>"u"?null:window.localStorage||null}catch{return null}}const Tm=750,yn=new Map,en=new Map,tn=new Map,$r=new Map,nn=new Map,rn=new Map;function $m(e){var t;if(en.has(e)&&(clearTimeout(en.get(e)),en.delete(e)),tn.has(e)){try{(t=window.cancelIdleCallback)==null||t.call(window,tn.get(e))}catch{}tn.delete(e)}yn.has(e)&&(Fo(Qt(),e,yn.get(e)),yn.delete(e))}function Ux(e){var r;if(en.has(e)&&(clearTimeout(en.get(e)),en.delete(e)),tn.has(e)){try{(r=window.cancelIdleCallback)==null||r.call(window,tn.get(e))}catch{}tn.delete(e)}const t=()=>{yn.has(e)&&(Fo(Qt(),e,yn.get(e)),yn.delete(e))},n=setTimeout(()=>{en.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const s=window.requestIdleCallback(()=>{tn.delete(e),t()},{timeout:2500});tn.set(e,s);return}}catch{}t()},Tm);en.set(e,n)}function Bx(){Array.from(en.values()).forEach(e=>clearTimeout(e)),en.clear(),Array.from(tn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),tn.clear(),Array.from(yn.entries()).forEach(([e,t])=>{Fo(Qt(),e,t)}),yn.clear(),Array.from(nn.values()).forEach(e=>clearTimeout(e)),nn.clear(),Array.from(rn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),rn.clear(),Array.from($r.entries()).forEach(([e,t])=>{try{const n=Qt();n&&n.setItem(e,t)}catch{}}),$r.clear()}if(typeof window<"u"&&!window.__cozygenFormStateFlush){const e=()=>Bx();window.addEventListener("beforeunload",e),window.addEventListener("pagehide",e),window.__cozygenFormStateFlush=!0}function Vx(e){var r;if(!e)return{};const t=`${e}_formData`,n=Dx(Qt(),t);if(n&&typeof n=="object")return n;try{const s=Yr();(r=s==null?void 0:s.removeItem)==null||r.call(s,t)}catch{}return{}}function po(e,t,n={}){var o;if(!e)return;const{immediate:r=!1}=n||{},s=`${e}_formData`;if(r){$m(s),Fo(Qt(),s,t||{});try{const i=Yr();(o=i==null?void 0:i.removeItem)==null||o.call(i,s)}catch{}return}yn.set(s,t||{}),Ux(s)}function Wx(e){e&&$m(`${e}_formData`)}function Hx(e,t,n=Tm){var o;if($r.set(e,t),nn.has(e)&&(clearTimeout(nn.get(e)),nn.delete(e)),rn.has(e)){try{(o=window.cancelIdleCallback)==null||o.call(window,rn.get(e))}catch{}rn.delete(e)}const r=()=>{const i=$r.get(e);$r.delete(e);try{const a=Qt();a&&a.setItem(e,i)}catch{}},s=setTimeout(()=>{nn.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const i=window.requestIdleCallback(()=>{rn.delete(e),r()},{timeout:2e3});rn.set(e,i);return}}catch{}r()},n);nn.set(e,s)}function Gx(e,t={}){var s,o;const{immediate:n=!1}=t||{},r="cozygen_last_param";if(n){if(nn.has(r)&&(clearTimeout(nn.get(r)),nn.delete(r)),rn.has(r)){try{(s=window.cancelIdleCallback)==null||s.call(window,rn.get(r))}catch{}rn.delete(r)}$r.delete(r);try{const i=Qt();i&&i.setItem(r,e||"");const a=Yr();(o=a==null?void 0:a.removeItem)==null||o.call(a,r)}catch{}return}Hx(r,e||"")}function Kx(){var t,n;const e="cozygen_last_param";try{const r=Qt(),s=((t=r==null?void 0:r.getItem)==null?void 0:t.call(r,e))||"";if(s)return s;const o=Yr();(n=o==null?void 0:o.removeItem)==null||n.call(o,e)}catch{}return""}function Mm(e,t){const n=e?String(e):"global",r=t?String(t):"";return`cozygen_dropdown_folder:${n}:${r}`}function Ed(e,t){var r,s;const n=Mm(e,t);try{const o=Qt(),i=((r=o==null?void 0:o.getItem)==null?void 0:r.call(o,n))||"";if(i)return i;const a=Yr();(s=a==null?void 0:a.removeItem)==null||s.call(a,n)}catch{}return""}function Qx(e,t,n){var s;const r=Mm(e,t);try{const o=Qt();o&&o.setItem(r,String(n||""));const i=Yr();(s=i==null?void 0:i.removeItem)==null||s.call(i,r)}catch{}}function Yx({workflowName:e,name:t,label:n,description:r,value:s,onChange:o,disabled:i=!1,options:a=[]}){const u=s??"",[d,y]=c.useState(()=>Ed(e,t)||"All");c.useEffect(()=>{const p=Ed(e,t);y(p||"All")},[e,t]);const g=c.useMemo(()=>(a||[]).map(p=>typeof p=="string"?{value:p,label:p}:{value:p.value??p.name??"",label:p.label??p.name??String(p.value??"")}),[a]),h=(p="")=>{if(typeof p!="string")return"Other";if(!p.includes("/"))return"root";const f=p.split("/");return f.slice(0,f.length-1).join("/")||"root"},v=c.useMemo(()=>{const p=new Set(["All"]);return g.forEach(f=>p.add(h(f.label))),Array.from(p).sort((f,m)=>f.localeCompare(m))},[g]);c.useEffect(()=>{v.includes(d)||y("All")},[v,d]),c.useEffect(()=>{Qx(e,t,d)},[e,t,d]);const w=c.useMemo(()=>{const p=f=>f.replace(/\.[^.]+$/,"");return g.filter(f=>{const m=h(f.label);return d==="All"||m===d}).map(f=>{const m=f.label||"";if(Tc(m)){const{base:E}=Am(m),I=La(m);return{...f,label:d==="All"?I:E||I}}if(d==="All")return f;const j=m.split("/"),b=p(j[j.length-1]||m);return{...f,label:b}}).sort((f,m)=>f.label.localeCompare(m.label))},[g,d]),k=c.useMemo(()=>u===""||u===null||u===void 0?!0:w.some(p=>String(p.value)===String(u)),[w,u]),S=p=>{const f=p&&p.target?p.target.value:p;o==null||o(f)};return l.jsxs("div",{className:"w-full space-y-2",children:[l.jsx("div",{className:"relative w-full",children:l.jsx(qe,{value:d,onChange:y,disabled:i,"aria-label":`Choose folder for ${n||t}`,size:"sm",options:v.map(p=>({value:p,label:p}))})}),l.jsx("div",{className:"relative w-full",children:l.jsx(qe,{id:t,name:t,value:u,onChange:S,disabled:i,"aria-label":n||t,"aria-describedby":r?`${t}-description`:void 0,placeholder:w.length>0&&(u===void 0||u==="")?"Select...":void 0,emptyLabel:"No matches",options:[...!k&&u!==""?[{value:u,label:La(String(u))}]:[],...w]},`${t||"field"}:${d}`)})]})}const Pa=c.memo(Yx);function Ld(e=[]){return e.map(t=>typeof t=="string"?{value:t,label:t}:{value:t.value??t.name??"",label:t.label??t.name??String(t.value??"")})}function Pd(e,t){if(!e)return null;const n=String(e);if(t==="high"){const r=n.match(/(.+)-high(\.[^.]*)?$/i);return r?r[1]:null}if(t==="low"){const r=n.match(/(.+)-low(\.[^.]*)?$/i);return r?r[1]:null}return null}function qx(e){return e?e.replace(/[_-]+/g," ").replace(/\s+/g," ").trim().replace(/^./,t=>t.toUpperCase()):""}const Xx=(...e)=>e.flat().map(n=>String(n??"").trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")).filter(Boolean).join("-")||"field";function Jx({name:e,label:t,description:n,highParam:r,lowParam:s,highChoices:o=[],lowChoices:i=[],formData:a={},onChangeParam:u,highStrengthParam:d,lowStrengthParam:y,strengthValue:g,onChangeStrength:h,highStrengthValue:v,lowStrengthValue:w,onChangeHighStrength:k,onChangeLowStrength:S,disabled:p=!1}){const f=c.useMemo(()=>Ld(o),[o]),m=c.useMemo(()=>Ld(i),[i]),j=c.useMemo(()=>{const X=new Map;m.forEach(W=>{const M=Pd(W.value,"low");M&&(X.has(M)||X.set(M,W))});const se=[];return f.forEach(W=>{const M=Pd(W.value,"high");if(!M)return;const O=X.get(M);O&&se.push({base:M,label:qx(M),highValue:W.value,lowValue:O.value})}),se.sort((W,M)=>W.label.localeCompare(M.label)),se},[f,m]),b=c.useMemo(()=>{const X=a[r],se=a[s];if(!X||!se)return"";const W=j.find(M=>M.highValue===X&&M.lowValue===se);return W?W.base:""},[a,r,s,j]),E=d||y||`${e}_strength`,I=c.useMemo(()=>Xx(e||"lora",E||"strength"),[e,E]),T=!!(d||y),z=!!(d&&y),A=(X,se=1)=>typeof X=="number"?X:se,B=A(typeof g=="number"?g:typeof v=="number"?v:typeof w=="number"?w:void 0,1),le=A(typeof v=="number"?v:void 0,B),F=A(typeof w=="number"?w:void 0,z?B:le),ge=z&&Math.abs(le-F)>1e-4,[ue,K]=c.useState(ge);c.useEffect(()=>{K(ge)},[ge,r,s]);const fe=X=>{if(!u)return;const se=j.find(W=>W.base===X);se&&(u(r,se.highValue),u(s,se.lowValue))};if(j.length===0)return l.jsxs("div",{className:"text-[11px] text-[#9DA3FFCC]",children:["No matching ",l.jsx("span",{className:"font-semibold",children:"-high"})," /"," ",l.jsx("span",{className:"font-semibold",children:"-low"})," LoRA pairs found."]});const R=`${I}-linked`,N=`${I}-high`,_=`${I}-low`,P=z?"Linked":"Strength",V=z?"Applies to high + low":d||y||"",G=(X,se)=>{const W=Array.isArray(X)?X:[X];let M=!1;W.forEach(O=>{if(O==="high"&&typeof k=="function"){k(se);return}if(O==="low"&&typeof S=="function"){S(se);return}typeof h=="function"&&!M&&(h(se),M=!0)})},Z=X=>{(d||!d&&!y)&&G("high",X),y&&G("low",X)},ee=()=>{z&&K(X=>{const se=!X;return se||Z(typeof le=="number"?le:typeof F=="number"?F:B),se})};return l.jsxs("div",{className:"space-y-2",children:[l.jsx(Pa,{name:`${e}_pair`,label:t,description:n,value:b||"",onChange:fe,disabled:p,options:j.map(X=>({value:X.base,label:X.label}))}),T&&l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-[10px] uppercase tracking-[0.16em] text-[#9DA3FFCC]",children:"Strength"}),z&&l.jsx("button",{type:"button",className:"text-[10px] font-semibold tracking-[0.12em] uppercase text-[#E5E7FF]",onClick:ee,disabled:p,children:ue?"Link values":"Split values"})]}),ue&&z?l.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-3",children:[l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:N,className:"lora-strength-label is-high",children:[l.jsx("span",{className:"lora-strength-label-pill",children:"High"}),l.jsxs("span",{className:"lora-strength-label-text",children:["High strength",d&&l.jsx("span",{className:"lora-strength-label-hint",children:d})]})]}),l.jsx(Ss,{name:`${E}_high`,label:"High strength",description:"",value:le,onChange:X=>G("high",X),disabled:p,isFloat:!0,min:0,max:2,step:.05,inputId:N})]}),l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:_,className:"lora-strength-label is-low",children:[l.jsx("span",{className:"lora-strength-label-pill",children:"Low"}),l.jsxs("span",{className:"lora-strength-label-text",children:["Low strength",y&&l.jsx("span",{className:"lora-strength-label-hint",children:y})]})]}),l.jsx(Ss,{name:`${E}_low`,label:"Low strength",description:"",value:F,onChange:X=>G("low",X),disabled:p,isFloat:!0,min:0,max:2,step:.05,inputId:_})]})]}):l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:R,className:"lora-strength-label is-linked",children:[l.jsx("span",{className:"lora-strength-label-pill",children:P}),l.jsxs("span",{className:"lora-strength-label-text",children:["LoRA strength",V&&l.jsx("span",{className:"lora-strength-label-hint",children:V})]})]}),l.jsx(Ss,{name:E,label:"LoRA strength",description:"",value:B,onChange:Z,disabled:p,isFloat:!0,min:0,max:2,step:.05,inputId:R})]})]})]})}function Zx(e,t){if(e.disabled!==t.disabled||e.name!==t.name||e.label!==t.label||e.description!==t.description||e.highParam!==t.highParam||e.lowParam!==t.lowParam||e.highStrengthParam!==t.highStrengthParam||e.lowStrengthParam!==t.lowStrengthParam||e.strengthValue!==t.strengthValue||e.highStrengthValue!==t.highStrengthValue||e.lowStrengthValue!==t.lowStrengthValue||e.highChoices!==t.highChoices||e.lowChoices!==t.lowChoices||e.onChangeParam!==t.onChangeParam||e.onChangeStrength!==t.onChangeStrength||e.onChangeHighStrength!==t.onChangeHighStrength||e.onChangeLowStrength!==t.onChangeLowStrength)return!1;const n=e.formData||{},r=t.formData||{};return!(n[e.highParam]!==r[t.highParam]||n[e.lowParam]!==r[t.lowParam])}const _d=c.memo(Jx,Zx);function ew({id:e,label:t,description:n,preview:r,expanded:s=!1,onToggle:o,children:i,trailing:a,className:u=""}){const d=typeof o=="function",y=e?`${e}-description`:void 0,g=e?`${e}-panel`:void 0,h=typeof t=="string"?t.trim().replace(/\s+/gu," ").replace(/:\s*$/u,""):t,v=typeof n=="string"?n.trim().replace(/\s+/gu," "):n,w=typeof r=="string"||typeof r=="number"?String(r):void 0,k=d?"button":"div",S=d?{type:"button",onClick:o,"aria-expanded":s,"aria-controls":g,"aria-describedby":v?y:void 0}:{};return l.jsxs("div",{className:["field-row",u].filter(Boolean).join(" "),children:[l.jsxs(k,{...S,className:["field-row-head",d?"is-collapsible":"is-static",s?"is-expanded":""].filter(Boolean).join(" "),children:[l.jsxs("div",{className:"field-row-main",children:[l.jsx("div",{className:"field-row-label",children:h}),v?l.jsx("div",{id:y,className:"field-row-description",children:v}):null]}),l.jsxs("div",{className:"field-row-trailing",children:[a?l.jsx("div",{className:"field-row-trailing-control",children:a}):null,r?l.jsx("div",{className:"field-row-preview",title:w,children:r}):null,d?l.jsx("div",{className:"field-row-chevron","aria-hidden":"true",children:l.jsx(Mo,{size:16})}):null]})]}),d&&s?l.jsx("div",{id:g,className:"field-row-body",children:i}):null]})}const yi=c.memo(ew),tw=16,nw=[" - "," ","-","_"],Om=e=>[...new Set(e.filter(Boolean))],mo=(e,t)=>{const n=String(e||"").trim(),r=nw.map(s=>`${n}${s}${t}`);return r.push(`${n}${t}`),Om(r)},Rd=(e,t)=>{const n=mo(`${e} Strength`,t),r=mo(e,t).map(s=>`${s} Strength`);return Om([...n,...r])},Id=e=>String(e||"").toLowerCase().replace(/[\s_-]+/g,""),jl=(e,t=[])=>{if(!e)return null;const n=Array.isArray(t)?t:[t];for(const s of n){if(!s)continue;const o=e.get(s);if(o)return{name:s,input:o}}const r=new Map;n.forEach(s=>{s&&r.set(Id(s),s)});for(const[s,o]of e.entries()){const i=Id(s);if(r.has(i))return{name:s,input:o}}return null},rw=Array.from({length:tw},(e,t)=>{const n=t+1,r=mo("Lora High",n),s=mo("Lora Low",n),o=Rd("Lora High",n),i=Rd("Lora Low",n);return{id:`video_lora_${n}`,label:`Video LoRA ${n}`,highParam:r[0],lowParam:s[0],highParamAliases:r,lowParamAliases:s,highStrengthParam:o[0],lowStrengthParam:i[0],highStrengthParamAliases:o,lowStrengthParamAliases:i}});function sw(e){var r,s;const t=((r=e==null?void 0:e.inputs)==null?void 0:r.param_type)||((s=e==null?void 0:e.inputs)==null?void 0:s.Param_type),n=String(t||"STRING").toUpperCase();return["NUMBER","FLOAT","INT"].includes(n)?"NUMBER":["BOOLEAN","BOOL"].includes(n)?"BOOLEAN":["DROPDOWN","CHOICE","SELECT"].includes(n)?"DROPDOWN":"STRING"}function lw(e){const t=(e==null?void 0:e.inputs)||{};return t.label||t.display_name||t.title||t.param_name||(e==null?void 0:e.title)||(e==null?void 0:e.class_type)||"Parameter"}function ow(e){const t=(e==null?void 0:e.inputs)||{};return t.description||t.help||t.tooltip||t.doc||""}function gr(e){const t=(e==null?void 0:e.inputs)||{};return t.param_name||t.name||t.key||t.id||`param_${(e==null?void 0:e.id)||"unknown"}`}function fs(e){const t=(e==null?void 0:e.inputs)||{},n=t.choices||t.options||[],r=t.default_value??t.value??t.default_choice??(n&&n.length?n[0]:"")??"";return{paramName:gr(e),label:lw(e),description:ow(e),paramType:sw(e),multiline:!!t.multiline,min:typeof t.min=="number"?t.min:void 0,max:typeof t.max=="number"?t.max:void 0,step:typeof t.step=="number"?t.step:void 0,choices:n,defaultValue:r}}function iw({inputs:e=[],formData:t={},onFormChange:n,workflowName:r,onParamEdited:s,onSpotlight:o,compactControls:i=!0,collapseAllKey:a=0,collapseAllCollapsed:u=!0,lastEditedParam:d="",spotlightName:y="",onCloseSpotlight:g=()=>{},onVisibleParamsChange:h=()=>{},aliasOptions:v=[],aliasCatalog:w=[],onOpenComposer:k}){const[S,p]=c.useState({}),[f,m]=c.useState(0),j=c.useRef(t);c.useEffect(()=>{j.current=t},[t]);const b=c.useCallback((N,_)=>{if((N==null?void 0:N.paramType)==="BOOLEAN")return _?"On":"Off";if(_==null||_==="")return"Empty";if(typeof _=="string"){const P=_.trim();if(!P)return"Empty";const V=240,G=140,Z=P.length>V?P.slice(0,V):P,X=/[\r\n\t]/.test(Z)||/\s{2,}/u.test(Z)?Z.replace(/\s+/gu," ").trim():Z;if(X.length>G)return`${X.slice(0,G)}`;const se=La(X);return P.length>V?`${se}`:se}return String(_)},[]),E=c.useCallback((N,_)=>{!n||!N||(n(N,_),s==null||s(N),p(P=>(P==null?void 0:P[N])===!1?P:{...P,[N]:!1}))},[n,s]),I=c.useCallback(N=>{N&&p(_=>({..._,[N]:!(_!=null&&_[N])}))},[]),T=c.useMemo(()=>e||[],[e]),z=c.useMemo(()=>{const N=new Map;return(T||[]).forEach(_=>{const P=gr(_);P&&N.set(P,V=>E(P,V))}),N},[E,T]),A=c.useMemo(()=>{const N=new Map;return(T||[]).forEach(_=>{const P=gr(_);P&&N.set(P,(V,G)=>{var Z,ee;E(P,V),(ee=(Z=G==null?void 0:G.target)==null?void 0:Z.blur)==null||ee.call(Z),y===P&&(g==null||g())})}),N},[E,g,y,T]),B=c.useMemo(()=>{const N=new Map;return(T||[]).forEach(_=>{const P=gr(_);P&&N.set(P,()=>I(P))}),N},[I,T]);c.useEffect(()=>{const N={};(e||[]).forEach(_=>{const P=gr(_);P&&(N[P]=u)}),d&&(N[d]=!1),p(N)},[a,u,e,d]);const le=c.useMemo(()=>{const N=new Map;return(e||[]).forEach(_=>{const P=gr(_);P&&N.set(P,_)}),N},[e]),F=c.useMemo(()=>{const N=[];return rw.forEach(_=>{const P=jl(le,_.highParamAliases||_.highParam),V=jl(le,_.lowParamAliases||_.lowParam);if(!P||!V)return;const G=P.input,Z=V.input,ee=fs(G),X=fs(Z);if(ee.paramType!=="DROPDOWN"||X.paramType!=="DROPDOWN")return;const se=ee.choices||[],W=X.choices||[];if(!se.length||!W.length)return;const M=jl(le,_.highStrengthParamAliases||_.highStrengthParam),O=jl(le,_.lowStrengthParamAliases||_.lowStrengthParam);N.push({..._,highParam:P.name,lowParam:V.name,highStrengthParam:M==null?void 0:M.name,lowStrengthParam:O==null?void 0:O.name,highInput:G,lowInput:Z,highCfg:ee,lowCfg:X})}),N},[le]),ge=c.useMemo(()=>{const N=new Map;return F.forEach(_=>{N.set(_.highParam,_)}),N},[F]),ue=c.useMemo(()=>{const N=new Set;return F.forEach(_=>{N.add(_.highParam),N.add(_.lowParam),_.highStrengthParam&&N.add(_.highStrengthParam),_.lowStrengthParam&&N.add(_.lowStrengthParam)}),N},[F]),K=c.useMemo(()=>{const N=[];return(T||[]).forEach(_=>{const P=fs(_),V=P.paramName,G=ge.get(V);if(G){N.push({name:V,label:G.label||P.label,description:P.description,render:Z=>{const ee=Z||j.current||{},X=G.highStrengthParam?ee[G.highStrengthParam]:void 0,se=G.lowStrengthParam?ee[G.lowStrengthParam]:void 0,W=X??se??1;return l.jsx(_d,{name:G.id||G.highParam,label:G.label||P.label,highParam:G.highParam,lowParam:G.lowParam,highChoices:G.highCfg.choices,lowChoices:G.lowCfg.choices,formData:ee,onChangeParam:E,highStrengthParam:G.highStrengthParam,lowStrengthParam:G.lowStrengthParam,strengthValue:W,highStrengthValue:X,lowStrengthValue:se,onChangeHighStrength:G.highStrengthParam?z.get(G.highStrengthParam):void 0,onChangeLowStrength:G.lowStrengthParam?z.get(G.lowStrengthParam):void 0,disabled:!1},`lora-${V}-${f}`)}});return}ue.has(V)||N.push({name:V,label:P.label,description:P.description,render:Z=>{const ee=Z||j.current||{},X={name:V,label:P.label,description:P.description,value:ee[V],defaultValue:P.defaultValue,disabled:!1};return P.paramType==="NUMBER"?l.jsx(Ss,{...X,onChange:z.get(V),min:P.min,max:P.max,step:P.step,isFloat:!0},`field-${V}-number-${f}`):P.paramType==="BOOLEAN"?l.jsx(bd,{...X,onChange:z.get(V)},`field-${V}-bool-${f}`):P.paramType==="DROPDOWN"?l.jsx(Pa,{...X,workflowName:r,onChange:z.get(V),options:P.choices||[]},`field-${V}-dropdown-${f}`):l.jsx(kd,{...X,aliasOptions:v,aliasCatalog:w,onOpenComposer:k,onChange:z.get(V),onEnter:A.get(V),multiline:P.multiline},`field-${V}-string-${f}`)}})}),N},[T,ge,ue,f,r,v,w,k,E,z,A,y,g]),fe=c.useMemo(()=>{const N=new Map;return K.forEach(_=>N.set(_.name,_)),N},[K]);c.useEffect(()=>{h==null||h(K.map(N=>N.name))},[K,h]);const R=c.useCallback(N=>{const _=K.map(ee=>ee.name),P=fe.get(N);if(!P)return;const V=_.indexOf(N),G=V>0?_[V-1]:null,Z=V>=0&&V<_.length-1?_[V+1]:null;m(ee=>ee+1),o==null||o({name:N,label:P.label,description:P.description,render:ee=>P.render(ee||j.current),order:_,index:V>=0?V:0,total:_.length,onPrev:G?()=>R(G):null,onNext:Z?()=>R(Z):null})},[fe,o,K]);return l.jsx("div",{className:"settings-list",children:T.map(N=>{const _=fs(N),P=_.paramName,V=ge.get(P);if(V){const{id:O,label:te,highParam:H,lowParam:ve,highStrengthParam:Ne,lowStrengthParam:je,highCfg:Ee,lowCfg:_e}=V,ne=Ne?t[Ne]:void 0,Re=je?t[je]:void 0,Se=ne??Re??1,ze=P?`param-${P}`:void 0,J=i?S[P]??!0:!!S[P],de=J?b(_,[t[H],t[ve]].filter(Boolean).join("  ")):null,me=(ie=t)=>{const D=Ne?ie==null?void 0:ie[Ne]:void 0,Q=je?ie==null?void 0:ie[je]:void 0,oe=D??Q??Se;return l.jsx(_d,{name:O||H,label:te||_.label,highParam:H,lowParam:ve,highChoices:Ee.choices,lowChoices:_e.choices,formData:ie,onChangeParam:E,highStrengthParam:Ne,lowStrengthParam:je,strengthValue:oe,highStrengthValue:D,lowStrengthValue:Q,onChangeHighStrength:Ne?z.get(Ne):void 0,onChangeLowStrength:je?z.get(je):void 0,disabled:!1},`lora-${P}`)};return l.jsx("div",{id:ze,"data-param-name":P,"data-param-label":te||_.label,"data-param-type":"lora_pair",className:"settings-row",children:l.jsx(yi,{id:P,label:te||_.label,description:_.description,preview:de,expanded:!J,onToggle:B.get(P),children:J?null:me(t)})},`lora_pair_${O||H}`)}if(ue.has(P))return null;const G=t[P],ee={name:P,label:_.label,description:_.description,value:G,disabled:!1,defaultValue:_.defaultValue},X=(O=t,te=!1)=>{const H={...ee,value:O==null?void 0:O[P]};return _.paramType==="NUMBER"?l.jsx(Ss,{...H,inputId:P,onChange:z.get(P),min:_.min,max:_.max,step:_.step,isFloat:!0},`field-${P}-number-${f}`):_.paramType==="BOOLEAN"?l.jsx(bd,{...H,onChange:z.get(P)},`field-${P}-bool-${f}`):_.paramType==="DROPDOWN"?l.jsx(Pa,{...H,workflowName:r,onChange:z.get(P),options:_.choices||[]},`field-${P}-dropdown-${f}`):l.jsx(kd,{...H,aliasOptions:v,aliasCatalog:w,onOpenComposer:k,onChange:z.get(P),onEnter:A.get(P),multiline:_.multiline||y===P||te},`field-${P}-string-${f}`)},se=P?`param-${P}`:void 0,W=i?S[P]??!0:!!S[P];if(_.paramType==="BOOLEAN")return l.jsx("div",{id:se,"data-param-name":P,"data-param-label":_.label,"data-param-type":"single",className:"settings-row",children:l.jsx(yi,{id:P,label:_.label,description:_.description,trailing:X(t,!0)})},P);const M=W?b(_,G):null;return l.jsx("div",{id:se,"data-param-name":P,"data-param-label":_.label,"data-param-type":"single",className:"settings-row",children:l.jsx(yi,{id:P,label:_.label,description:_.description,preview:M,expanded:!W,onToggle:B.get(P),children:W?null:X(t,!0)})},P)})})}function aw(e){return(e||[]).map(t=>{var n;if(["CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"].includes(t.class_type)){let r=t.class_type.replace("CozyGen","").replace("Input","").toUpperCase();return r==="CHOICE"&&(r="DROPDOWN"),{...t,inputs:{...t.inputs,param_type:r,Multiline:((n=t.inputs)==null?void 0:n.display_multiline)||!1}}}return t})}function cw({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:o=!1,collapseAllState:i=null,onSpotlight:a,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:y,aliasOptions:g=[],aliasCatalog:h=[],onOpenComposer:v}){const w=c.useMemo(()=>aw((t||[]).filter(k=>k.class_type!=="CozyGenImageInput")),[t]);return l.jsx("section",{className:"settings-surface scroll-mt-24",ref:s,children:l.jsx(iw,{workflowName:e,inputs:w,formData:n,onFormChange:r,compactControls:o,collapseAllKey:(i==null?void 0:i.key)??0,collapseAllCollapsed:(i==null?void 0:i.collapsed)??!0,onSpotlight:a,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:y,aliasOptions:g,aliasCatalog:h,onOpenComposer:v})})}function uw({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,parameterSectionRef:s,compactControls:o=!0,collapseAllState:i=null,onSpotlight:a,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:y,aliasOptions:g=[],aliasCatalog:h=[],onOpenComposer:v}){return l.jsx(cw,{workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:o,collapseAllState:i,onSpotlight:a,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:y,aliasOptions:g,aliasCatalog:h,onOpenComposer:v})}const zd=c.forwardRef(function({title:t,kicker:n,meta:r,defaultOpen:s=!0,variant:o="card",className:i="",bodyClassName:a,children:u},d){const y=o==="bare",g=(y?["collapsible-section","collapsible-section--bare",i]:["ui-panel","collapsible-card","sectioned-card",i]).filter(Boolean).join(" "),h=(y?["collapsible-section-body",a||"space-y-4"]:["collapsible-card-body",a||"space-y-4"]).filter(Boolean).join(" "),v=r!=null?l.jsx("div",{className:"collapsible-card-summary-meta",children:r}):null;return l.jsxs("details",{ref:d,className:g,open:s,children:[l.jsxs("summary",{className:y?"collapsible-section-summary":"collapsible-card-summary",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[n?l.jsx("span",{className:"ui-kicker",children:n}):null,l.jsx("span",{className:"text-sm font-semibold tracking-wide",children:t})]}),v,y?l.jsx("span",{className:"collapsible-section-chevron","aria-hidden":"true",children:l.jsx(Mo,{size:16})}):null]}),l.jsx("div",{className:h,children:u})]})});function Ad(e){try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return""}}function dw({open:e,onClose:t,logs:n=[],onClear:r}){const s=c.useMemo(()=>(n||[]).map(o=>`[${Ad(o.ts)}] ${String(o.level||"info").toUpperCase()} ${o.message}`).join(`
`),[n]);return l.jsx(Nt,{open:e,onClose:t,title:"Run logs",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>{var o,i;try{(i=(o=navigator.clipboard)==null?void 0:o.writeText)==null||i.call(o,s||"")}catch{}},children:"Copy"}),l.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:r,children:"Clear"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Close"})]}),children:l.jsx("pre",{className:"runlog-pre",children:n!=null&&n.length?n.map((o,i)=>l.jsxs("div",{className:`runlog-line is-${o.level||"info"}`,children:[l.jsx("span",{className:"runlog-ts",children:Ad(o.ts)}),l.jsx("span",{className:"runlog-msg",children:o.message})]},`${o.ts}-${i}`)):"No logs yet."})})}const bt=c.forwardRef(function({as:t,href:n,variant:r,size:s="md",iconOnly:o=!1,active:i=!1,pressed:a,className:u="",type:d,...y},g){const h=t||(n?"a":"button"),v=s==="sm"?"is-compact":s==="xs"?"is-tiny":s==="icon"?"is-icon":"",w=r?`is-${r}`:"",p=["ui-button",v,w,o?"is-icon":"",i?"is-active":"",u].filter(Boolean).join(" "),f={ref:g,className:p,"aria-pressed":a,...y};return h==="button"?l.jsx("button",{...f,type:d||"button"}):l.jsx(h,{...f,href:n})}),fw="cozygen_field_order_v1";function pw(e,t){if(!e)return t;try{const n=JSON.parse(e);return n&&typeof n=="object"?n:t}catch{return t}}function mw(){if(typeof window>"u")return{};try{return pw(window.localStorage.getItem(fw),{})}catch{return{}}}function hw(e){if(Array.isArray(e))return{order:e.filter(Boolean),hidden:{}};if(!e||typeof e!="object")return{order:[],hidden:{}};const t=Array.isArray(e.order)?e.order.filter(Boolean):[],n=e.hidden&&typeof e.hidden=="object"?e.hidden:{};return{order:t,hidden:n}}function gw(e){if(!e)return{order:[],hidden:{}};const n=mw()[e];return hw(n)}function yw(e,t){let n=Array.isArray(t)?t:[];if(!e||n.length===0)return n;const{order:r,hidden:s}=gw(e);if(r&&r.length){const o=new Map;n.forEach(a=>{var d;const u=(d=a==null?void 0:a.inputs)==null?void 0:d.param_name;u&&!o.has(u)&&o.set(u,a)});const i=[];r.forEach(a=>{const u=o.get(a);u&&(i.push(u),o.delete(a))}),n.forEach(a=>{var d;const u=(d=a==null?void 0:a.inputs)==null?void 0:d.param_name;if(!u){i.push(a);return}o.has(u)&&(i.push(a),o.delete(u))}),n=i}return n=n.filter(o=>{var a;const i=(a=o==null?void 0:o.inputs)==null?void 0:a.param_name;return i?!s[i]:!0}),n}function vw(){const[e,t]=c.useState([]),[n,r]=c.useState(null),[s,o]=c.useState(!0),[i,a]=c.useState(null);c.useEffect(()=>{let d=!1;async function y(){o(!0),a(null);try{const g=await Wv();if(d)return;const h=(g==null?void 0:g.workflows)||[];t(h);let v=null;try{if(v=typeof window<"u"?sessionStorage.getItem("selectedWorkflow"):null,typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{v=null}if(v&&h.includes(v))r(v);else if(h.length>0){r(h[0]);try{typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",h[0])}catch{}}else r(null)}catch(g){if(d)return;console.error("Failed to load workflows",g),a(g)}finally{d||o(!1)}}return y(),()=>{d=!0}},[]);const u=c.useCallback(d=>{r(d);try{if(typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",d),typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{}},[]);return{workflows:e,selectedWorkflow:n,selectWorkflow:u,loading:s,error:i}}const xw={clip_name1:"clip",clip_name2:"clip",unet_name:"unet",vae_name:"vae",sampler_name:"sampler",scheduler:"scheduler"},ww=["CozyGenDynamicInput","CozyGenImageInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"];function jw(e){const[t,n]=c.useState(null),[r,s]=c.useState([]),[o,i]=c.useState({}),[a,u]=c.useState(!1),[d,y]=c.useState(null);c.useEffect(()=>{if(!e){n(null),s([]),i({});return}let w=!1;const k=new AbortController;async function S(){u(!0),y(null);try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:workflow:load")}catch{}try{const p=await Hv(e,{signal:k.signal});if(w)return;for(const E in p){const I=p[E];I.class_type==="CozyGenImageInput"&&!I.inputs.param_name&&(I.inputs.param_name="Image Input"),p[E].id=E}n(p);const f=Object.values(p).filter(E=>ww.includes(E.class_type)),m=await Promise.all(f.map(async E=>{const I=E.class_type==="CozyGenDynamicInput"&&E.inputs.param_type==="DROPDOWN",T=E.class_type==="CozyGenChoiceInput";if(I||T){const z=E.inputs.param_name;let A=E.inputs.choice_type||E.properties&&E.properties.choice_type;if(!A&&I&&(A=xw[z]),A)try{const B=await Gv(A,{signal:k.signal,refresh:A==="loras"});E.inputs.choices=B.choices||[]}catch(B){(B==null?void 0:B.name)!=="AbortError"&&console.error(`Choices for ${z} failed`,B),E.inputs.choices=[]}}return E}));if(w)return;s(m);const j=Vx(e),b={};m.forEach(E=>{const I=E.inputs.param_name;if(!I)return;if(j[I]!==void 0){b[I]=j[I];return}let T;if(["CozyGenDynamicInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput"].includes(E.class_type)){if(T=E.inputs.default_value,E.class_type==="CozyGenIntInput"){const z=parseInt(T,10);T=Number.isNaN(z)?0:z}else if(E.class_type==="CozyGenFloatInput"){const z=parseFloat(T);T=Number.isNaN(z)?0:z}}else if(E.class_type==="CozyGenChoiceInput"){const z=E.inputs.choices||[];T=z.length?z[0]:""}else E.class_type,T="";b[I]=T}),i(b);try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:workflow:ready"),performance.measure(`cozygen:workflow:ready:${e||"unknown"}`,"cozygen:workflow:load","cozygen:workflow:ready"))}catch{}}catch(p){if(w)return;console.error("Failed to load workflow",p),y(p),n(null),s([])}finally{w||u(!1)}}return S(),()=>{Wx(e),w=!0,k.abort()}},[e]);const g=c.useMemo(()=>r.filter(w=>w.class_type==="CozyGenImageInput"),[r]),h=g[0]||null,v=c.useCallback((w,k)=>{i(S=>{const p={...S,[w]:k};return e&&po(e,p),p})},[e]);return{workflowData:t,dynamicInputs:r,imageInputs:g,primaryImageInput:h,formData:o,setFormData:i,handleFormChange:v,loading:a,error:d}}const Td="::";function Ns(e){const t={};return Object.entries(e||{}).forEach(([n,r])=>{const s=String(n||"").trim();if(!s||typeof r!="string")return;const o=r.trim();o&&(t[s]=o)}),t}function $c(e){const t=new Map;return Object.entries(Ns(e)).forEach(([n,r])=>{const s=n.toLowerCase();t.set(s,r),s.includes(Td)&&t.set(s.replace(Td,":"),r)}),t}function Fm(e,t){if(typeof e!="string"||!e.includes("$"))return e;const n=t instanceof Map?t:$c(t);return n.size?e.replace(/\$([a-z0-9_:-]+)\$/gi,(r,s)=>{const o=n.get(s.toLowerCase());return typeof o=="string"?o:r}):e}function Sw(e,t){const n=t instanceof Map?t:$c(t);if(!n.size||!e||typeof e!="object")return e;let r=!1;const s={};return Object.entries(e).forEach(([o,i])=>{if(typeof i=="string"){const a=Fm(i,n);s[o]=a,a!==i&&(r=!0)}else s[o]=i}),r?s:e}function Nw(e){return e?JSON.parse(JSON.stringify(e)):{}}function kw(e,t,n){const r=Nw(e),s={...n||{}};if(!t||!Array.isArray(t))return{workflow:r,formData:s};for(const o of t){if(!o||!o.id||!o.inputs||!r[o.id])continue;const i=o.inputs.param_name;if(!i||o.class_type==="CozyGenImageInput")continue;let a=s[i];const u=r[o.id];if(!u||!u.inputs)continue;const d=o.class_type;a===void 0&&(d==="CozyGenChoiceInput"?a=o.inputs.value??o.inputs.default_choice??(o.inputs.choices&&o.inputs.choices[0])??"":a=o.inputs.default_value),a===void 0&&(a=""),s[i]=a,d==="CozyGenFloatInput"||d==="CozyGenIntInput"||d==="CozyGenStringInput"||d==="CozyGenDynamicInput"?u.inputs.default_value=a:d==="CozyGenChoiceInput"&&(u.inputs.value=a)}return{workflow:r,formData:s}}function Mc(){const[e,t]=c.useState(()=>typeof document>"u"?!0:document.visibilityState!=="hidden");return c.useEffect(()=>{if(typeof document>"u")return;const n=()=>{t(document.visibilityState!=="hidden")};return document.addEventListener("visibilitychange",n),()=>document.removeEventListener("visibilitychange",n)},[]),e}function Cw({selectedWorkflow:e,workflowData:t,dynamicInputs:n,imageInputs:r,formData:s,setFormData:o,promptAliases:i=null}){const a=Mc(),[u,d]=c.useState(!1),[y,g]=c.useState(!1),[h,v]=c.useState(0),[w,k]=c.useState(0),[S,p]=c.useState("Idle"),[f,m]=c.useState("idle"),[j,b]=c.useState([]),E=c.useRef({ts:0,value:0,max:0}),I=c.useRef(null),T=c.useRef({value:0,max:0}),z=c.useRef(null),A=c.useRef(null),B=c.useRef(t),le=c.useRef(s),F=c.useRef(!1),ge=c.useRef(0),ue=c.useRef(0),K=c.useRef("idle"),fe=c.useRef(null),R=c.useRef(null);c.useEffect(()=>{B.current=t},[t]),c.useEffect(()=>{F.current=y},[y]),c.useEffect(()=>{ge.current=h},[h]),c.useEffect(()=>{ue.current=w},[w]),c.useEffect(()=>{K.current=f},[f]),c.useEffect(()=>{le.current=s},[s]);const N=()=>{fe.current&&(clearTimeout(fe.current),fe.current=null)},_=()=>{R.current&&(clearTimeout(R.current),R.current=null)},P=()=>{A.current&&(clearTimeout(A.current),A.current=null)},V=()=>{I.current&&(cancelAnimationFrame(I.current),I.current=null)},G=c.useCallback((O,te,H=null)=>{const ve={ts:Date.now(),level:O||"info",message:String(te||""),extra:H||null};b(Ne=>{const je=[...Ne||[],ve];return je.length>250?je.slice(je.length-250):je})},[]),Z=c.useCallback(()=>b([]),[]),ee=()=>{if(!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent("cozygen:queue-finished"))}catch{}},X=()=>{_(),R.current=setTimeout(()=>{F.current||(m("idle"),p("Idle"),v(0),k(0))},8e3)},se=c.useCallback(()=>{N(),d(!1),g(!1),v(0),k(0),p("Finished"),m("finished"),G("success","Finished"),X(),ee()},[G]),W=c.useCallback((O="Error")=>{N(),d(!1),g(!1),p(O),m("error"),G("error",O||"Error"),X()},[G]);c.useEffect(()=>{N(),!(!y||!w||w<=0||h<w)&&(fe.current=setTimeout(()=>{const O=F.current,te=ge.current,H=ue.current,ve=K.current;O&&H>0&&te>=H&&ve!=="finished"&&ve!=="error"&&se()},800))},[y,h,w,se]),c.useEffect(()=>{if(typeof window>"u"||!a&&!y)return;let O=!1,te=1e3;const H=()=>{if(O||!a&&!F.current)return;const ve=window.location.protocol==="https:"?"wss":"ws",Ne=window.location.host,je=Lc(),Ee=`${ve}://${Ne}/ws${je?`?token=${encodeURIComponent(je)}`:""}`,_e=new WebSocket(Ee);z.current=_e,_e.onopen=()=>{te=1e3},_e.onmessage=ne=>{var ze,J,de;if(typeof ne.data!="string")return;let Re;try{Re=JSON.parse(ne.data)}catch{return}const Se=Re.type;if(Se==="cozygen_batch_ready"){se();return}if(Se==="execution_success"||Se==="execution_finished"){F.current&&se();return}if(Se==="execution_error"||Se==="execution_interrupted"){G("error","Execution error"),W("Execution error");return}if(Se==="status"){const me=Re.data||{},ie=me.status||me,D=ie.exec_info||me.exec_info||ie;if(D&&F.current){const Q=D.queue_remaining??D.queue_pending??D.queue_remaining_items??0;(D.queue_running??D.running??0)===0&&Q===0&&se()}return}if(Se==="executing"){_(),m("running");const me=(ze=Re.data)==null?void 0:ze.node,ie=B.current;if(me&&ie&&ie[me]){const D=ie[me],Q=D.title||D.class_type||"Node";G("info",`Executing: ${Q}`,{nodeId:me}),p(`Executing: ${Q}`)}else G("info","Executing"),p("Executing");return}if(Se==="progress"){const me=((J=Re.data)==null?void 0:J.value)??0,ie=((de=Re.data)==null?void 0:de.max)??0;T.current={value:me,max:ie},I.current||(I.current=window.requestAnimationFrame(()=>{I.current=null;const ye=T.current;v(ye.value),k(ye.max)}));const D=Date.now(),Q=E.current;D-Q.ts>2500&&(me!==Q.value||ie!==Q.max)&&ie>0&&(E.current={ts:D,value:me,max:ie},G("info",`Progress: ${me}/${ie}`));return}},_e.onclose=()=>{O||!a&&!F.current||(P(),A.current=setTimeout(H,te),te=Math.min(Math.ceil(te*1.6),15e3))}};return H(),()=>{O=!0,N(),_(),P(),V(),z.current&&(z.current.onclose=null,z.current.close())}},[G,W,se,a,y]);const M=c.useCallback(async(O={})=>{if(!t)return;const{overrides:te=null,persistFormState:H=!0}=O||{};N(),_(),d(!0),g(!0),p("Queuing prompt"),m("queued"),v(0),k(0),G("info","Queuing prompt",{workflow:e||""});const ve=le.current||{},Ne=te?{...ve,...te||{}}:ve,je=Sw(Ne,i||{}),{workflow:Ee,formData:_e}=kw(t,n||[],je||{}),ne={..._e,...Ne};H&&e&&po(e,ne),H&&o(ne);const Re=r||[];for(const Se of Re){if(!Se||!Se.id||!Se.inputs)continue;const ze=Se.inputs.param_name;if(!ze)continue;const J=ne[ze];if(!J){alert(`Please upload or select an image for "${ze}" before generating.`),W("Missing image input");return}Ee[Se.id]&&Ee[Se.id].inputs&&(Ee[Se.id].inputs.image_filename=J)}try{let Se=Ee;if(i){const ze=J=>{if(typeof J=="string")return Fm(J,i);if(Array.isArray(J))return J.map(de=>ze(de));if(J&&typeof J=="object"){const de=Array.isArray(J)?[]:{};return Object.entries(J).forEach(([me,ie])=>{de[me]=ze(ie)}),de}return J};try{Se=ze(Ee)}catch{Se=Ee}}Nm({workflowName:e,workflow:Se,timestamp:Date.now()}),await Pc({prompt:Se}),G("info","Prompt queued")}catch(Se){console.error("Failed to queue prompt",Se),Se!=null&&Se.unauthorized?(G("error","Session expired. Please sign in again."),W("Session expired. Please sign in again."),window.location.hash="#/login"):(G("error","Error queuing prompt"),W("Error queuing prompt"))}},[t,n,r,i,e,o,W,G]);return{isLoading:u,progressValue:h,progressMax:w,statusText:S,statusPhase:f,handleGenerate:M,logEntries:j,clearLogs:Z}}const Dm="cozygen_prompt_aliases",Um="cozygen_alias_categories",Bm="cozygen_alias_category_list";function $d(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Dm);return e?JSON.parse(e)||{}:{}}catch{return{}}}function vi(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Dm,JSON.stringify(e||{}))}catch{}}function Md(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Um);return e?JSON.parse(e)||{}:{}}catch{return{}}}function xi(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Um,JSON.stringify(e||{}))}catch{}}function Od(){if(typeof window>"u")return[];try{const e=window.localStorage.getItem(Bm);return Array.isArray(JSON.parse(e))?JSON.parse(e):[]}catch{return[]}}function wi(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Bm,JSON.stringify(e||[]))}catch{}}function Vm(){const[e,t]=c.useState(()=>$d()),[n,r]=c.useState(()=>Md()),[s,o]=c.useState(()=>Od()),[i,a]=c.useState(!1),[u,d]=c.useState(!1),[y,g]=c.useState(null),h=c.useCallback(async()=>{a(!0),g(null);try{const S=await Yv(),p=Ns((S==null?void 0:S.items)||S||{}),f=(S==null?void 0:S.categories)||{},m=Array.isArray(S==null?void 0:S.categoryList)?S.categoryList:[];t(p),r(f),o(m),vi(p),xi(f),wi(m)}catch(S){console.error("Failed to load prompt aliases",S),g(S);const p=Ns($d()),f=Md(),m=Od();t(p),r(f),o(m)}finally{a(!1)}},[]),v=c.useCallback(async S=>{const p=(S==null?void 0:S.items)||S||{},f=(S==null?void 0:S.categories)||n||{},m=Array.isArray(S==null?void 0:S.categoryList)&&S.categoryList.length?S.categoryList:s.length?s:Array.from(new Set(Object.values(f).filter(Boolean))),j=Ns(p||{});d(!0),g(null);try{await qv({items:j,categories:f,categoryList:m}),t(j),r(f),o(m),vi(j),xi(f),wi(m)}catch(b){throw console.error("Failed to save prompt aliases",b),g(b),vi(j),xi(f),wi(m),b}finally{d(!1)}},[n,s]);c.useEffect(()=>{h()},[h]);const w=c.useMemo(()=>{const S=$c(e),p=new Map(S);return Object.entries(n||{}).forEach(([f,m])=>{const j=String(m||"").trim();j&&(e!=null&&e[f])&&p.set(`${j}:${f}`,e[f])}),p},[e,n]),k=c.useMemo(()=>{const S=new Set,p=[];return w.forEach((f,m)=>{let j=m.includes("::")?m.replace("::",":"):m;const b=j.split(":");b.length>=3&&b[0]&&b[1]&&b[0].toLowerCase()===b[1].toLowerCase()&&(j=[b[0],...b.slice(2)].join(":"));const E=j.toLowerCase();S.has(E)||(S.add(E),p.push(j))}),p},[w]);return{aliases:e,aliasCategories:n,categoryList:s,aliasLookup:w,aliasOptions:k,loading:i,saving:u,error:y,refreshAliases:h,persistAliases:v}}const Wm=c.createContext(null);function Hm(){const e=c.useContext(Wm);if(!e)throw new Error("useStudioContext must be used within a StudioProvider");return e}function bw({children:e}){const{workflows:t,selectedWorkflow:n,selectWorkflow:r,loading:s,error:o}=vw(),{workflowData:i,dynamicInputs:a,imageInputs:u,primaryImageInput:d,formData:y,setFormData:g,handleFormChange:h,loading:v,error:w}=jw(n),k=Vm(),S=c.useMemo(()=>{const le=[];return Object.entries(k.aliases||{}).forEach(([F,ge])=>{const ue=String(F).split("::"),K=ue.length>1,fe=k.aliasCategories&&k.aliasCategories[F]||(K?ue[0]:""),R=K?ue.slice(1).join("::"):F,N={key:F,name:R,category:fe,text:ge,token:fe?`${fe}:${R}`:R};le.push({...N,...Ac(N)})}),le},[k.aliases,k.aliasCategories]),p=c.useMemo(()=>yw(n,a),[n,a]),f=c.useMemo(()=>{const le=(p||a||[]).filter(R=>(R==null?void 0:R.class_type)!=="CozyGenImageInput"),F=/\b(checkpoint|ckpt|lora|model|vae|embedding|clip|sampler|scheduler|seed)\b/i,ge=R=>{const N=String((R==null?void 0:R.paramName)||"").toLowerCase(),_=String((R==null?void 0:R.label)||"").toLowerCase(),P=`${N} ${_}`,V=y==null?void 0:y[R==null?void 0:R.paramName],G=typeof V=="string"?V:"";let Z=0;return P.includes("prompt")&&(Z+=100),P.includes("negative")&&P.includes("prompt")&&(Z-=15),R!=null&&R.multiline&&(Z+=10),G.includes("$")&&(Z+=20),F.test(P)&&(Z-=200),Tc(G)&&(Z-=200),Z};if(typeof(y==null?void 0:y.prompt)=="string")return"prompt";const ue=le.map(R=>fs(R)).filter(R=>(R==null?void 0:R.paramType)==="STRING"&&(R==null?void 0:R.paramName));if(!ue.length)return"prompt";let K=ue[0],fe=ge(K);for(let R=1;R<ue.length;R+=1){const N=ue[R],_=ge(N);_>fe&&(K=N,fe=_)}return(K==null?void 0:K.paramName)||"prompt"},[a,y,p]),{isLoading:m,progressValue:j,progressMax:b,statusText:E,statusPhase:I,handleGenerate:T,logEntries:z,clearLogs:A}=Cw({selectedWorkflow:n,workflowData:i,dynamicInputs:a,imageInputs:u,formData:y,setFormData:g,promptAliases:k.aliasLookup});c.useEffect(()=>{if(I==="finished"&&!(typeof window>"u")){try{window.localStorage.setItem("cozygen_gallery_pending","1")}catch{}window.dispatchEvent(new Event("cozygen:gallery-pending"))}},[I]),c.useEffect(()=>{if(typeof window>"u")return;const le=I==="queued"||I==="running"||m;try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:le}}))}catch{}},[I,m]);const B=c.useMemo(()=>({workflows:t,selectedWorkflow:n,selectWorkflow:r,workflowsLoading:s,workflowsError:o,workflowData:i,dynamicInputs:a,orderedDynamicInputs:p,imageInputs:u,primaryImageInput:d,formData:y,setFormData:g,handleFormChange:h,workflowLoading:v,workflowError:w,promptFieldName:f,aliasOptions:k.aliasOptions,aliasCatalog:S,aliasLookup:k.aliasLookup,aliasCategories:k.aliasCategories,aliasLoading:k.loading,aliasSaving:k.saving,aliasError:k.error,refreshAliases:k.refreshAliases,persistAliases:k.persistAliases,isLoading:m,progressValue:j,progressMax:b,statusText:E,statusPhase:I,handleGenerate:T,logEntries:z,clearLogs:A}),[t,n,r,s,o,i,a,p,u,d,y,g,h,v,w,f,k.aliasOptions,k.aliasLookup,k.aliasCategories,S,k.loading,k.saving,k.error,k.refreshAliases,k.persistAliases,m,j,b,E,I,T,z,A]);return l.jsx(Wm.Provider,{value:B,children:e})}const Ew=c.memo(function({workflows:t=[],selectedWorkflow:n,onWorkflowChange:r,workflowData:s,presets:o=[],presetName:i="",onPresetNameChange:a,selectedPresetId:u="",onPresetSelect:d,onPresetSave:y,onPresetDelete:g,presetStatus:h}){const v=Array.isArray(t)?t:[],w=Array.isArray(o)?o:[],k=w.length,S=k?`${k} saved`:"No presets yet",p=$o("(min-width: 768px)"),[f,m]=c.useState(!1),[j,b]=c.useState(!1);c.useEffect(()=>{m(!1),b(!1)},[p]);const E=()=>{m(!1),b(!1)},I=()=>{if(!p){b(!0);return}m(A=>!A)},T=()=>{y(),E()},z=()=>{g(),E()};return l.jsxs("div",{className:"controls-context",children:[l.jsxs("div",{className:"controls-context-row",children:[l.jsxs("div",{className:"controls-context-field",children:[l.jsx("label",{className:"controls-context-label",htmlFor:"workflow-select",children:"Workflow"}),l.jsx(qe,{id:"workflow-select",value:n||"",onChange:r,className:"controls-context-select","aria-label":"Workflow",size:"sm",placeholder:"Select workflow...",options:v.map(A=>({value:A,label:A}))})]}),l.jsxs("div",{className:"controls-context-field",children:[l.jsx("label",{className:"controls-context-label",htmlFor:"preset-select",children:"Preset"}),l.jsx(qe,{id:"preset-select",value:u||"",onChange:d,className:"controls-context-select","aria-label":"Workflow preset",disabled:!s,size:"sm",placeholder:"Presets...",options:w.map(A=>({value:A.id,label:A.name}))})]}),l.jsx("div",{className:"controls-context-actions",children:l.jsxs("div",{className:"controls-context-menu",children:[l.jsx(bt,{variant:"ghost",size:"xs",onClick:I,"aria-haspopup":p?"menu":"dialog","aria-expanded":p?f:j,"aria-label":"Manage presets",children:"Manage presets"}),p&&f?l.jsxs("div",{className:"controls-context-menu-items",role:"menu",children:[l.jsxs("div",{className:"controls-context-menu-row",children:[l.jsx("input",{type:"text",value:i,onChange:A=>a(A.target.value),className:"controls-context-input ui-control ui-input is-compact",placeholder:"Preset name","aria-label":"Preset name",disabled:!s}),l.jsx("button",{type:"button",className:"controls-context-menu-btn",onClick:T,disabled:!s||!i.trim(),role:"menuitem",children:"Save"})]}),l.jsx("button",{type:"button",className:"controls-context-menu-btn is-danger",onClick:z,disabled:!s||!u,role:"menuitem",children:"Delete"})]}):null]})})]}),l.jsxs("div",{className:"controls-context-meta",children:[l.jsx("span",{children:S}),h?l.jsx("span",{className:"controls-context-status",children:h}):null]}),!p&&j?l.jsx(Nt,{open:j,onClose:E,title:"Manage presets",children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Preset"}),l.jsx(qe,{value:u||"",onChange:handlePresetSelect,className:"sheet-select","aria-label":"Select preset",size:"sm",options:[{value:"",label:"New preset"},...w.map(A=>({value:A.id,label:A.name}))]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Preset name"}),l.jsx("input",{type:"text",value:i,onChange:A=>a(A.target.value),className:"sheet-input ui-control ui-input",placeholder:"Preset name","aria-label":"Preset name",disabled:!s})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Actions"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:T,disabled:!s||!i.trim(),children:"Save"}),l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:z,disabled:!s||!u,children:"Delete"})]})]})]})}):null]})});function Lw(){const e=an(),{workflows:t=[],selectedWorkflow:n,selectWorkflow:r,workflowData:s,dynamicInputs:o=[],imageInputs:i=[],formData:a,setFormData:u,handleFormChange:d,aliasOptions:y,aliasCatalog:g,isLoading:h,progressValue:v,progressMax:w,statusText:k,statusPhase:S,handleGenerate:p,logEntries:f,clearLogs:m,promptFieldName:j,orderedDynamicInputs:b}=Hm(),E=c.useRef(null),I=c.useRef(null),[T,z]=c.useState(()=>Kx()),[A,B]=c.useState(null),le=(A==null?void 0:A.name)||"",F=c.useCallback(()=>B(null),[]),[ge,ue]=c.useState(!1),[K,fe]=c.useState([]),[R,N]=c.useState([]),[_,P]=c.useState(""),[V,G]=c.useState(""),[Z,ee]=c.useState(""),X=c.useRef(new Map),se=c.useCallback((J="")=>{const me=`?field=${encodeURIComponent(J||j||"prompt")}`;e(`/compose${me}`)},[e,j]),W=c.useCallback(J=>{!J||J===n||(n&&po(n,a||{},{immediate:!0}),P(""),G(""),ee(""),r(J))},[a,n,r]),M=c.useMemo(()=>{const de=[...b||[],...i||[]].map(me=>{var ie;return(ie=me==null?void 0:me.inputs)==null?void 0:ie.param_name}).filter(me=>me&&typeof me=="string");return new Set(de)},[b,i]),O=c.useCallback(J=>{G(J);const de=R.find(D=>D.id===J);if(P((de==null?void 0:de.name)||""),!J||!(de!=null&&de.values)||!n){J||ee("");return}const me=M,ie={};Object.entries(de.values).forEach(([D,Q])=>{(!me.size||me.has(D))&&(ie[D]=Q)}),u(D=>{const Q={...D,...ie};return po(n,Q,{immediate:!0}),Q}),ee(`Applied "${de.name}".`)},[M,R,n,u]),te=i||[],H=!!(s&&n),ve=te.length>0,Ne=c.useCallback((J,de)=>{const me=X.current;de&&J&&me.set(J,de);const ie=K.length?K:(de==null?void 0:de.order)||[],D=ie.length,Q=D>0?ie.indexOf(J):-1,oe=Q>0?ie[Q-1]:null,ye=Q>=0&&Q<D-1?ie[Q+1]:null,Le=oe?me.get(oe):null,Xe=ye?me.get(ye):null;return{...de,index:Q>=0?Q:0,total:D,onPrev:Le?()=>B(Ne(oe,Le)):null,onNext:Xe?()=>B(Ne(ye,Xe)):null,onRender:p}},[K,p]),je=c.useCallback(J=>{const de=J||[];fe(me=>me.length===de.length&&me.every((ie,D)=>ie===de[D])?me:de)},[]),Ee=c.useCallback(J=>{const de=J||"";z(de),Gx(de)},[]),_e=c.useCallback(J=>{J!=null&&J.name&&B(Ne(J.name,J))},[Ne]),ne=c.useCallback(async J=>{if(!J){N([]),G("");return}try{const de=await Xv(J),me=Array.isArray(de==null?void 0:de.presets)?de.presets:[];N(me),G(ie=>ie&&me.some(D=>D.id===ie)?ie:"")}catch(de){console.error("Failed to load workflow presets",de),N([]),ee("Presets unavailable.")}},[]);c.useEffect(()=>{ne(n)},[n,ne]);const Re=c.useCallback(async()=>{if(!n)return;const J=_.trim();if(!J){ee("Name a preset to save.");return}const de={},me=M;Object.entries(a||{}).forEach(([Q,oe])=>{(!me.size||me.has(Q))&&(de[Q]=oe)});const ie=R.find(Q=>Q.id===V),D=ie&&ie.name.toLowerCase()===J.toLowerCase()?ie.id:void 0;try{const Q=await Jv(n,{id:D,name:J,values:de}),oe=Array.isArray(Q==null?void 0:Q.presets)?Q.presets:[],ye=Q==null?void 0:Q.preset;N(oe),ye!=null&&ye.id&&G(ye.id),ee(`Saved "${J}".`)}catch(Q){console.error("Failed to save preset",Q),ee("Save failed.")}},[M,a,_,R,V,n]),Se=c.useCallback(async()=>{if(!(!n||!V))try{const J=await Zv(n,V),de=Array.isArray(J==null?void 0:J.presets)?J.presets:[];N(de),G(""),ee("Preset deleted.")}catch(J){console.error("Failed to delete preset",J),ee("Delete failed.")}},[V,n]),ze=c.useCallback(()=>{var J;return(J=A==null?void 0:A.render)==null?void 0:J.call(A,a)},[A,a]);return c.useEffect(()=>{const J=()=>{!H||h||p()};return window.addEventListener("cozygen:request-render",J),()=>window.removeEventListener("cozygen:request-render",J)},[p,H,h]),!t||t.length===0?l.jsx("div",{className:"page-shell",children:l.jsx("div",{className:"neon-card px-3 py-3 sm:px-4 sm:py-4",children:l.jsx("p",{className:"text-sm text-[#9DA3FFCC]",children:"No workflows found. Drop a workflow file in CozyGen and refresh."})})}):l.jsxs("div",{className:"page-shell page-stack has-dock controls-page",children:[l.jsxs("div",{className:"page-bar controls-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Controls"}),l.jsx("div",{className:"page-bar-actions",children:T?l.jsxs("span",{className:"controls-meta",children:["Last: ",T]}):null})]}),l.jsxs("section",{className:"controls-board",children:[l.jsxs(zd,{title:l.jsxs(l.Fragment,{children:[l.jsx(Ic,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Parameters"]}),bodyClassName:"control-shell controls-body",defaultOpen:!0,className:"controls-panel",children:[l.jsx(Ew,{workflows:t,selectedWorkflow:n,onWorkflowChange:W,workflowData:s,presets:R,presetName:_,onPresetNameChange:P,selectedPresetId:V,onPresetSelect:O,onPresetSave:Re,onPresetDelete:Se,presetStatus:Z}),s?l.jsx(uw,{workflowName:n,dynamicInputs:b,formData:a,onFormChange:d,parameterSectionRef:E,compactControls:!0,lastEditedParam:T,spotlightName:le,onCloseSpotlight:F,onVisibleParamsChange:je,aliasOptions:y,aliasCatalog:g,onOpenComposer:se,onParamEdited:Ee,onSpotlight:_e}):l.jsxs("div",{className:"empty-state-inline",children:[l.jsx("span",{className:"empty-state-arrow",children:l.jsx(ix,{size:20})}),l.jsx("span",{children:"Select a workflow above to get started"})]})]}),ve?l.jsx(zd,{ref:I,className:"scroll-mt-24 controls-panel controls-subpanel",title:l.jsxs(l.Fragment,{children:[l.jsx(ox,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Images"]}),defaultOpen:!1,variant:"bare",children:s?l.jsx("div",{className:"grid grid-cols-1 gap-3 lg:grid-cols-2",children:te.map(J=>l.jsx(Ex,{input:J,value:a[J.inputs.param_name]||"",onFormChange:d},J.id))}):null}):null]}),l.jsxs("div",{className:"controls-status-strip",children:[l.jsxs("div",{className:"controls-status-left",children:[l.jsx("span",{className:`controls-status-dot is-${S||"idle"}`,"aria-hidden":"true"}),l.jsxs("div",{className:"controls-status-text",children:[l.jsx("span",{className:"controls-status-phase",children:S||"idle"}),l.jsx("span",{className:"controls-status-msg",children:k||"Idle"})]})]}),l.jsxs("div",{className:"controls-status-right",children:[h&&w>0?l.jsx("div",{className:"controls-status-meter","aria-label":"Progress",children:l.jsx("div",{className:"controls-status-meter-fill",style:{width:`${Math.max(0,Math.min(100,Math.round((v||0)/w*100)))}%`}})}):null,l.jsx("button",{type:"button",className:"controls-status-btn",onClick:()=>ue(!0),children:"Logs"})]})]}),l.jsx("section",{className:"dock-panel",children:l.jsx(gx,{busy:h,progressValue:v,progressMax:w,statusText:k,statusPhase:S,primaryLabel:"Render",onPrimary:p,primaryDisabled:!H,onLogs:()=>ue(!0)})}),l.jsx(Lx,{open:!!A,onClose:F,title:A==null?void 0:A.label,description:A==null?void 0:A.description,render:ze,index:(A==null?void 0:A.index)??0,total:(A==null?void 0:A.total)??0,onPrev:(A==null?void 0:A.onPrev)||null,onNext:(A==null?void 0:A.onNext)||null,onRender:(A==null?void 0:A.onRender)||null,children:null}),l.jsx(dw,{open:ge,onClose:()=>ue(!1),logs:f,onClear:m})]})}function Pw(){return l.jsx("div",{className:"page-shell page-stack",children:l.jsxs("section",{className:"home-hero",children:[l.jsx("span",{className:"home-hero-orb is-warm","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-orb is-cool","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-spark","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-beam","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-ring","aria-hidden":"true"}),l.jsxs("div",{className:"home-hero-inner home-hero-full",children:[l.jsx("div",{className:"home-hero-kicker",children:"CozyGen Studio"}),l.jsx("h1",{className:"home-hero-title",children:"Creative studio for prompt-first storytelling"}),l.jsx("p",{className:"home-hero-description",children:"CozyGen is a quiet, cinematic workspace for people who sketch with wordsshape the mood, stage the scene, then send it down the render runway without losing your flow."}),l.jsxs("div",{className:"home-info-grid",children:[l.jsxs("article",{className:"home-info-card",children:[l.jsx("h3",{children:"Control as composition"}),l.jsx("p",{children:"Dial the palette, tempo, and texture in one place. The controls read like a creative brief, not a checklist."})]}),l.jsxs("article",{className:"home-info-card",children:[l.jsx("h3",{children:"Alias & tag storyboards"}),l.jsx("p",{children:"Save characters, atmospheres, and motifs as building blocks, then arrange them like panels in a storyboard."})]}),l.jsxs("article",{className:"home-info-card",children:[l.jsx("h3",{children:"Gallery inspiration"}),l.jsx("p",{children:"Pin your strongest frames, compare variations, and carry the aesthetic through to your next scene."})]}),l.jsxs("article",{className:"home-info-card",children:[l.jsx("h3",{children:"Render runway"}),l.jsx("p",{children:"Stack iterations like takes on a set. Keep composing while the queue runs in the background."})]})]})]})]})})}function _w({subfolder:e,crumbs:t=[],dirChips:n=[],onBack:r,onRoot:s,onCrumb:o,onSelectDir:i}){return l.jsxs("div",{className:"gallery-nav",children:[l.jsx("div",{className:"gallery-crumbs",role:"navigation","aria-label":"Gallery path",children:t.map((a,u)=>l.jsxs(c.Fragment,{children:[l.jsx("span",{className:"text-[#6A6FA8]",children:"/"}),l.jsx("button",{type:"button",className:"gallery-chip-btn",onClick:()=>o==null?void 0:o(a.path),"aria-current":u===t.length-1?"page":void 0,children:a.name})]},a.path||a.name||u))}),n.length>0?l.jsx("div",{className:"gallery-dir-chips",children:n.map(a=>l.jsx("button",{type:"button",className:"gallery-chip-btn",onClick:()=>i==null?void 0:i(a.subfolder),children:a.filename||a.subfolder||"Collection"},a.subfolder||a.filename))}):null]})}const Rw=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),Iw=({src:e,poster:t,autoPlay:n})=>{const r=c.useRef(null),s=Mc();return c.useEffect(()=>{const o=r.current;o&&(o.pause(),o.currentTime=0,o.load())},[e]),c.useEffect(()=>{const o=r.current;if(!o)return;let i;const a=()=>{const d=o.play();d&&typeof d.catch=="function"&&d.catch(()=>{})},u=()=>{o.pause()};return n?s?typeof window<"u"&&"IntersectionObserver"in window?(i=new IntersectionObserver(y=>{y.forEach(g=>{g.isIntersecting?a():u()})},{threshold:.65}),i.observe(o)):a():u():(u(),o.currentTime=0),()=>{i&&i.disconnect(),u()}},[n,e,s]),e?l.jsx("video",{ref:r,src:e,poster:t||void 0,muted:!0,playsInline:!0,loop:!0,preload:n?"metadata":"none",className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40"}):l.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})},Fd={contentVisibility:"auto",containIntrinsicSize:"260px 320px"};function zw({item:e,onSelect:t,variant:n="grid",autoPlay:r=!1}){if(!e)return null;const s=e.type==="directory",o=e.filename||"",i=e.subfolder||"",a=o||i||"Unknown",u=!!(e!=null&&e.meta&&(e.meta.model||e.meta.prompt||Array.isArray(e.meta.loras)&&e.meta.loras.length)),d=()=>{t&&t(e)},y=n==="feed"?768:384,g=!s&&o?`/cozygen/thumb?type=output&subfolder=${encodeURIComponent(i)}&filename=${encodeURIComponent(o)}&w=`:null,h=g?`${g}${y}`:null,v=g?n==="feed"?`${g}384 384w, ${g}768 768w`:`${g}192 192w, ${g}384 384w`:null,w=n==="feed"?"(max-width: 768px) 92vw, 768px":"(max-width: 640px) 45vw, (max-width: 1024px) 30vw, 240px",k=!s&&o?(()=>{const p=e.type&&e.type!=="directory"?e.type:"output",f=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(o)}&subfolder=${encodeURIComponent(i)}&type=${encodeURIComponent(p)}${f}`})():null,S=Rw(o);if(s)return l.jsx("button",{type:"button",onClick:d,className:"gallery-dir-tile",style:Fd,children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"h-7 w-7 rounded-lg bg-gradient-to-br from-[#6B5BFF] to-[#FF4F9A] opacity-80 group-hover:opacity-100 flex items-center justify-center text-[11px] text-white",children:""}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-[11px] font-medium text-[#E5E7FF] truncate",children:a}),l.jsx("div",{className:"text-[10px] text-[#9DA3FFCC] truncate",children:"Collection"})]})]})});if(n==="feed"){const p={contentVisibility:"auto",containIntrinsicSize:"520px 720px"};return l.jsxs("div",{className:"gallery-feed-item",style:p,children:[l.jsxs("button",{type:"button",onClick:d,className:"gallery-feed-media",children:[u?l.jsx("span",{className:"gallery-meta-badge",role:"img","aria-label":"Metadata available",title:"Metadata available",children:"i"}):null,l.jsx("div",{className:"relative w-full flex items-center justify-center bg-[#020312]",children:S?l.jsx(Iw,{src:k,poster:h,autoPlay:r}):h?l.jsx("img",{src:h,srcSet:v||void 0,sizes:w,alt:a,className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40",loading:"lazy",decoding:"async"}):l.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})}),l.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#05071680] opacity-0 group-hover:opacity-100 transition-opacity"}),S&&l.jsx("div",{className:"pointer-events-none absolute left-2 top-2 rounded-md bg-[#050716CC] px-2 py-[1px] text-[10px] text-[#CFFAFE] border border-[#3EF0FF80]",children:"Video"})]}),l.jsx("div",{className:"gallery-feed-meta",children:l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"gallery-feed-title",children:a}),i&&l.jsx("div",{className:"gallery-feed-subfolder",children:i})]})})]})}return l.jsxs("button",{type:"button",onClick:d,className:"gallery-tile",style:Fd,children:[l.jsxs("div",{className:"gallery-tile-media",children:[u?l.jsx("span",{className:"gallery-meta-badge",role:"img","aria-label":"Metadata available",title:"Metadata available",children:"i"}):null,h?l.jsx("img",{src:h,srcSet:v||void 0,sizes:w,alt:a,className:"gallery-tile-img",loading:"lazy",decoding:"async"}):l.jsx("div",{className:"gallery-tile-empty",children:"No preview"}),S&&l.jsx("div",{className:"gallery-badge",children:"Video"})]}),l.jsx("div",{className:"gallery-tile-caption",children:l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("div",{className:"gallery-tile-title",children:a}),S&&l.jsx("span",{className:"gallery-tile-flag",children:"Vid"})]})})]})}const Dd=c.memo(zw),Aw=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),Tw=e=>{if(!e)return"";const t=e.filename||"",n=e.subfolder||"",r=e.type||"output",s=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(t)}&subfolder=${encodeURIComponent(n)}&type=${encodeURIComponent(r)}${s}`};function $w({isOpen:e,media:t,onClose:n,onPrev:r,onNext:s,total:o=0,canPrev:i=!1,canNext:a=!1}){var le;const u=c.useRef(!1),d=c.useRef(null),[y,g]=c.useState(!1),[h,v]=c.useState(!1),w=c.useRef(null),k=c.useRef(null),S=F=>F?Array.from(F.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(ge=>!ge.hasAttribute("disabled")&&ge.getAttribute("aria-hidden")!=="true"):[];if(c.useEffect(()=>{if(!e)return;const F=ge=>{ge.key==="Escape"&&(n==null||n()),ge.key==="ArrowLeft"&&i&&(r==null||r()),ge.key==="ArrowRight"&&a&&(s==null||s())};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[e,n,s,r,i,a]),c.useEffect(()=>{e&&g(!1)},[e,t]),c.useEffect(()=>{if(!e||typeof document>"u")return;const F=w.current;k.current=document.activeElement;const ge=()=>{var R;const K=S(F),fe=d.current||K[0]||F;(R=fe==null?void 0:fe.focus)==null||R.call(fe)},ue=K=>{if(K.key!=="Tab"||!F)return;const fe=S(F);if(!fe.length){K.preventDefault(),F.focus();return}const R=fe[0],N=fe[fe.length-1],_=document.activeElement;K.shiftKey&&_===R?(K.preventDefault(),N.focus()):!K.shiftKey&&_===N&&(K.preventDefault(),R.focus())};return requestAnimationFrame(ge),F==null||F.addEventListener("keydown",ue),()=>{var fe;F==null||F.removeEventListener("keydown",ue);const K=k.current;K&&document.contains(K)&&((fe=K.focus)==null||fe.call(K))}},[e]),!t||!e||typeof document>"u")return null;const p=Tw(t),f=t.subfolder||"Gallery",m=Aw(t.filename),j=o>1,b=(t==null?void 0:t.meta)||{},E=[b!=null&&b.model?{label:"Model",value:b.model}:null,b!=null&&b.prompt?{label:"Prompt",value:b.prompt,isPrompt:!0}:null,Array.isArray(b==null?void 0:b.loras)&&b.loras.length?{label:"LoRAs",value:b.loras.join(", ")}:null].filter(Boolean),I=!!((le=t==null?void 0:t.meta)!=null&&le.has_prompt||E.length),T=typeof(t==null?void 0:t.filename)=="string"&&t.filename.toLowerCase().endsWith(".png"),z=I&&T,A=F=>{if(!(typeof window>"u"))try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:F}}))}catch{}},B=async()=>{if(!(!t||h||!z)){v(!0),A(!0);try{const F=await Qv({filename:t.filename,subfolder:t.subfolder||""}),ge=F==null?void 0:F.prompt;if(!ge)throw new Error("prompt_missing");Nm({workflowName:t.filename||"gallery",workflow:ge,timestamp:Date.now()}),await Pc({prompt:ge}),A(!1)}catch(F){if(A(!1),F!=null&&F.unauthorized){window.location.hash="#/login";return}alert("Unable to re-run this item. It may not include prompt metadata.")}finally{v(!1)}}};return kc.createPortal(l.jsx("div",{className:"react-modal-overlay",role:"presentation",onPointerDown:F=>{u.current=F.target===F.currentTarget},onClick:F=>{u.current&&F.target===F.currentTarget&&(n==null||n())},children:l.jsx("div",{className:"react-modal-content",ref:w,role:"dialog","aria-modal":"true","aria-label":"Preview",onClick:F=>F.stopPropagation(),tabIndex:-1,children:l.jsxs("div",{className:"media-viewer-panel",children:[l.jsxs("header",{className:"media-viewer-head",children:[l.jsxs("div",{className:"media-viewer-head-bar bottom-sheet-head",children:[l.jsxs("div",{className:"media-viewer-meta",children:[l.jsx("div",{className:"media-viewer-title",title:t.filename,children:t.filename}),l.jsxs("div",{className:"media-viewer-sub",children:[l.jsx("span",{className:"media-chip",children:f}),l.jsx("span",{className:`media-chip ${m?"is-clip":"is-still"}`,children:m?"Video":"Image"})]})]}),l.jsx("button",{ref:d,type:"button",className:"bottom-sheet-close media-viewer-close",onClick:n,"aria-label":"Close",children:l.jsx(on,{size:16})})]}),l.jsxs("div",{className:"media-viewer-actions",children:[z?l.jsx(bt,{variant:"ghost",size:"sm",onClick:B,disabled:h,"aria-label":"Re-run generation",children:h?"Re-running":"Re-run"}):null,E.length?l.jsx(bt,{variant:"ghost",size:"sm",onClick:()=>g(F=>!F),"aria-expanded":y,"aria-label":y?"Hide metadata":"Show metadata",children:y?"Hide metadata":"Metadata"}):null,l.jsx(bt,{as:"a",href:p,target:"_blank",rel:"noreferrer",variant:"ghost",size:"sm",children:"Open"})]})]}),y&&E.length?l.jsx("div",{className:"media-viewer-info","aria-label":"Generation metadata",children:E.map(F=>l.jsxs("div",{className:"media-info-row",children:[l.jsx("span",{className:"media-info-label",children:F.label}),l.jsx("span",{className:`media-info-value ${F.isPrompt?"is-prompt":""}`,children:F.value})]},F.label))}):null,l.jsxs("div",{className:"media-viewer-stage",children:[j?l.jsx("button",{type:"button",className:`media-stage-nav is-left ${i?"":"is-disabled"}`,onClick:r,"aria-label":"Previous",disabled:!i,children:l.jsx(Pm,{size:18})}):null,l.jsx("div",{className:"media-viewer-frame",children:m?l.jsx("video",{src:p,controls:!0,className:"media-viewer-media",autoPlay:!0,muted:!0,playsInline:!0}):l.jsx("img",{src:p,alt:t.filename,className:"media-viewer-media",decoding:"async"})}),j?l.jsx("button",{type:"button",className:`media-stage-nav is-right ${a?"":"is-disabled"}`,onClick:s,"aria-label":"Next",disabled:!a,children:l.jsx(Mo,{size:18})}):null]})]})})}),document.body)}const Mw=(e="")=>e.startsWith("."),Ow=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),Fw=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);function Dw(){const e=Mc(),t=(W,M="")=>{try{return typeof window<"u"&&localStorage.getItem(W)||M}catch{return M}},n=(W,M)=>{try{typeof window<"u"&&localStorage.setItem(W,M)}catch{}},[r,s]=c.useState(t("galleryPath","")),[o,i]=c.useState([]),[a,u]=c.useState(!1),[d,y]=c.useState(!1),[g,h]=c.useState(""),[v,w]=c.useState(1),[k,S]=c.useState(1),[p,f]=c.useState(()=>{const W=t("galleryPageSize","30"),M=parseInt(W,10);return Number.isFinite(M)?M:30}),[m,j]=c.useState("all"),[b,E]=c.useState(!1),[I,T]=c.useState(""),[z,A]=c.useState(()=>t("galleryRecursive","0")==="1"),[B,le]=c.useState(0);c.useEffect(()=>{let W=!1;const M=new AbortController;return(async()=>{u(!0),h("");try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:gallery:fetch")}catch{}try{const te=await xm(r,v,p,b,z,m,B,{signal:M.signal,includeMeta:!0});if(W)return;te&&te.items?(i(te.items),S(te.total_pages||1),h("")):(i([]),S(1));try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:gallery:ready"),performance.measure("cozygen:gallery:first-paint","cozygen:gallery:fetch","cozygen:gallery:ready"))}catch{}}catch(te){if((te==null?void 0:te.name)==="AbortError")return;console.error("Failed to load gallery",te),W||h("Unable to load gallery right now."),W||(i([]),S(1))}finally{!W&&!M.signal.aborted&&(u(!1),y(!0))}})(),n("galleryPath",r),n("galleryPageSize",String(p)),()=>{W=!0,M.abort()}},[r,v,p,B,b,z,m]);const F=c.useMemo(()=>{if(!r)return[];const W=r.replace(/\\/g,"/").split("/").filter(Boolean),M=[];for(let O=0;O<W.length;O++)M.push({name:W[O],path:W.slice(0,O+1).join("/")});return M},[r]),ge=c.useMemo(()=>o.filter(W=>W.type==="directory").map(W=>({filename:W.filename,subfolder:W.subfolder})),[o]),ue=c.useMemo(()=>{const W=(I||"").trim().toLowerCase();return o.filter(M=>{const O=(M.filename||"").toLowerCase();return!(!b&&Mw(O)||M.type!=="directory"&&(m==="image"&&!Ow(O)||m==="video"&&!Fw(O))||W&&!O.includes(W))})},[o,b,m,I]),K=c.useMemo(()=>ue.filter(W=>W.type!=="directory"),[ue]),fe=c.useCallback(()=>{if(!r)return;const W=r.replace(/\\/g,"/").lastIndexOf("/"),M=W===-1?"":r.slice(0,W);s(M),w(1)},[r]),R=c.useCallback(()=>{s(""),w(1)},[]),N=c.useCallback(W=>{s(W||""),w(1)},[]),_=c.useCallback(W=>{s(W),w(1)},[]),P=c.useCallback(W=>{const M=parseInt(String(W),10)||30;f(M),w(1)},[]),V=c.useCallback(W=>{j(W),w(1)},[]),G=c.useCallback(W=>{const M=!!W;A(M),w(1),n("galleryRecursive",M?"1":"0")},[]),Z=c.useCallback(W=>{T(W),w(1)},[]),ee=c.useCallback(()=>{le(W=>W+1)},[]),X=c.useRef(null),se=c.useCallback(()=>{X.current||(X.current=window.setTimeout(()=>{X.current=null,ee()},400))},[ee]);return c.useEffect(()=>{const W=()=>ee();return typeof window<"u"&&window.addEventListener&&window.addEventListener("cozygen:queue-finished",W),()=>{typeof window<"u"&&window.removeEventListener&&window.removeEventListener("cozygen:queue-finished",W)}},[ee]),c.useEffect(()=>{if(typeof window>"u"||!e)return;let W=!1,M,O,te=8e3;const H=()=>{O&&(clearTimeout(O),O=null)},ve=(je=8e3)=>{H(),O=window.setTimeout(()=>{W||(se(),ve(te))},je)};return(()=>{if(!("EventSource"in window)){ve();return}const je=new URLSearchParams({subfolder:r||"",recursive:z?"1":"0",show_hidden:b?"1":"0"});M=new EventSource(`/cozygen/api/gallery/stream?${je.toString()}`),M.onmessage=()=>{W||se()},M.onerror=()=>{M&&(M.close(),M=null),te=Math.min(Math.ceil(te*1.4),2e4),ve()}})(),()=>{W=!0,H(),X.current&&(clearTimeout(X.current),X.current=null),M&&(M.close(),M=null)}},[r,z,b,se,e]),c.useEffect(()=>{e&&ee()},[e,ee]),{path:r,items:o,loading:a,hasLoaded:d,error:g,page:v,totalPages:k,perPage:p,kind:m,showHidden:b,query:I,recursive:z,crumbs:F,dirChips:ge,filtered:ue,mediaItems:K,setPage:w,setPerPage:P,setShowHidden:E,setQuery:Z,setKind:V,setRecursive:G,goBack:fe,goRoot:R,goToPath:N,selectDir:_,refresh:ee}}function Uw(e){const[t,n]=c.useState(!1),[r,s]=c.useState(null);c.useEffect(()=>{if(!e||e.length===0){s(null),n(!1);return}s(v=>v==null?v:v>=e.length?e.length-1:v)},[e]);const o=c.useCallback(v=>{if(!e||!e.length||!v)return;const w=e.indexOf(v);w!==-1&&(s(w),n(!0))},[e]),i=c.useCallback(()=>{n(!1),s(null)},[]),a=c.useCallback(()=>{!e||!e.length||s(v=>v==null||v>=e.length-1?v:v+1)},[e]),u=c.useCallback(()=>{!e||!e.length||s(v=>v==null||v<=0?v:v-1)},[e]),d=r!=null&&r>=0&&e&&r<e.length?e[r]:null,y=(e==null?void 0:e.length)||0,g=r!==null&&r>0,h=r!==null&&r<y-1;return{viewerOpen:t,viewerIndex:r,currentMedia:d,total:y,canPrev:g,canNext:h,open:o,close:i,next:a,prev:u,setViewerOpen:n}}const Ud="cozygen_gallery_view_mode",Bd="cozygen_gallery_feed_autoplay";function Bw(e,t){const n=c.useRef(null),[r,s]=c.useState(0),[o,i]=c.useState({width:0,cols:0,top:0,viewport:typeof window<"u"&&window.innerHeight||800}),a=h=>{if(!h||typeof window>"u")return null;let v=h.parentElement;for(;v;){const w=window.getComputedStyle(v);if(w.overflowY==="auto"||w.overflowY==="scroll")return v;v=v.parentElement}return window};c.useEffect(()=>{if(!t)return;const h=n.current;if(!h||typeof window>"u"||typeof ResizeObserver>"u")return;const v=a(h)||window,w=()=>{const f=h.getBoundingClientRect(),m=f.width||h.clientWidth||1,j=Math.max(1,Math.floor(m/160)),b=v===window?window.scrollY||0:v.scrollTop||0,E=v===window?{top:0}:v.getBoundingClientRect(),I=v===window?f.top+(window.scrollY||0):f.top-E.top+b,T=v===window?window.innerHeight||800:v.clientHeight||800;i(z=>z.width===m&&z.cols===j&&z.top===I&&z.viewport===T?z:{width:m,cols:j,top:I,viewport:T}),s(b)};w();const k=new ResizeObserver(()=>w());k.observe(h),window.addEventListener("resize",w);let S=!1;const p=()=>{S||(S=!0,window.requestAnimationFrame(()=>{S=!1;const f=v===window?window.scrollY||0:v.scrollTop||0;s(f)}))};return v.addEventListener("scroll",p,{passive:!0}),()=>{k.disconnect(),window.removeEventListener("resize",w),v.removeEventListener("scroll",p)}},[t]);const u=t&&o.cols>0&&e.length>60,{visibleItems:d,topSpacer:y,bottomSpacer:g}=c.useMemo(()=>{if(!u)return{visibleItems:e,topSpacer:0,bottomSpacer:0};const h=o.width/o.cols,v=Math.max(180,Math.ceil(h*1.25)+32),w=Math.ceil(e.length/o.cols),k=Math.max(0,r-o.top),S=Math.max(0,Math.floor(k/v)-2),p=Math.min(w,Math.ceil((k+o.viewport)/v)+2),f=S*o.cols,m=Math.min(e.length,p*o.cols);return{visibleItems:e.slice(f,m),topSpacer:S*v,bottomSpacer:Math.max(0,(w-p)*v)}},[e,o,r,u]);return{containerRef:n,visibleItems:d,topSpacer:y,bottomSpacer:g,virtualized:u}}function Vw(){const{path:e,loading:t,hasLoaded:n,page:r,totalPages:s,perPage:o,kind:i,showHidden:a,recursive:u,error:d,crumbs:y,dirChips:g,filtered:h,mediaItems:v,setPage:w,setPerPage:k,setShowHidden:S,setKind:p,setRecursive:f,goBack:m,goRoot:j,goToPath:b,selectDir:E,refresh:I}=Dw(),{viewerOpen:T,currentMedia:z,total:A,canPrev:B,canNext:le,open:F,close:ge,next:ue,prev:K}=Uw(v),[fe,R]=c.useState(()=>{if(typeof window>"u")return"grid";const ne=window.localStorage.getItem(Ud);return ne==="feed"||ne==="grid"?ne:"grid"}),[N,_]=c.useState(()=>typeof window>"u"?!1:window.localStorage.getItem(Bd)==="true");c.useEffect(()=>{try{window.localStorage.setItem(Ud,fe)}catch{}},[fe]),c.useEffect(()=>{try{window.localStorage.setItem(Bd,N?"true":"false")}catch{}},[N]);const P=c.useCallback(ne=>{if(ne.type==="directory"){E(ne.subfolder);return}F(ne)},[F,E]),V=fe==="grid",[G,Z]=c.useState(!1),ee=c.useMemo(()=>[{key:"all",label:"All"},{key:"image",label:"Images"},{key:"video",label:"Videos"}],[]),X=c.useMemo(()=>[{key:"grid",ariaLabel:"Grid view",icon:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})},{key:"feed",ariaLabel:"Feed view",icon:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("rect",{x:"2",y:"1",width:"12",height:"5",rx:"1"}),l.jsx("rect",{x:"2",y:"8",width:"12",height:"5",rx:"1"})]})}],[]),se=ne=>ne.type==="directory"?`dir:${ne.subfolder||ne.filename}`:`${ne.subfolder||""}|${ne.filename}`;c.useEffect(()=>{try{window.localStorage.setItem("cozygen_gallery_pending","0")}catch{}window.dispatchEvent(new Event("cozygen:gallery-viewed"))},[]);const W=t&&!n,M=t&&n,O=`${h.length} items`,te=W?"Loading":O,H=!!d,{containerRef:ve,visibleItems:Ne,topSpacer:je,bottomSpacer:Ee,virtualized:_e}=Bw(h,V);return l.jsxs("div",{className:"page-shell gallery-shell",children:[l.jsx("div",{className:"screen-sticky gallery-header",children:l.jsxs("div",{className:"gallery-header-inner",children:[l.jsxs("div",{className:"page-bar gallery-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Gallery"}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx("span",{className:"gallery-status",children:te}),l.jsx(Tr,{ariaLabel:"View mode",value:fe,onChange:R,layout:"icon",size:"sm",items:X}),l.jsx(bt,{size:"xs",className:"gallery-filter-btn",onClick:()=>Z(!0),children:"Filters"})]})]}),l.jsx("div",{className:"gallery-nav-row",children:l.jsx(_w,{subfolder:e,crumbs:y,dirChips:g,onBack:m,onRoot:j,onCrumb:ne=>b(ne),onSelectDir:ne=>E(ne)})}),l.jsxs("div",{className:"gallery-toolbar",children:[l.jsx("div",{className:"gallery-toolbar-left",children:l.jsx(Tr,{ariaLabel:"Filter by type",value:i,onChange:p,size:"sm",items:ee})}),l.jsx("div",{className:"gallery-toolbar-right",children:l.jsxs("div",{className:"gallery-options",children:[l.jsx(bt,{size:"icon",active:u,pressed:u,onClick:()=>f(ne=>!ne),title:u?"Showing subfolders":"This folder only","aria-label":"Toggle subfolders",children:u?l.jsx(dd,{size:16}):l.jsx(fd,{size:16})}),l.jsx(bt,{size:"icon",active:a,pressed:a,onClick:()=>S(ne=>!ne),title:a?"Showing hidden":"Hiding hidden","aria-label":"Toggle hidden items",children:a?l.jsx(pd,{size:16}):l.jsx(md,{size:16})}),fe==="feed"&&l.jsx(bt,{size:"icon",active:N,pressed:N,onClick:()=>_(ne=>!ne),title:N?"Autoplay on":"Autoplay off","aria-label":"Toggle autoplay",children:N?l.jsx(hd,{size:16}):l.jsx(gd,{size:16})}),l.jsx(bt,{size:"icon",onClick:I,title:"Refresh","aria-label":"Refresh gallery",children:l.jsx(Sa,{size:16})})]})})]}),l.jsxs("div",{className:"gallery-pagination",children:[l.jsxs("div",{className:"gallery-pagination-info",children:[M?l.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):null,l.jsx("span",{className:W?"gallery-loading-text":"",children:te})]}),l.jsxs("div",{className:"gallery-pagination-controls",children:[l.jsx("button",{type:"button",className:"gallery-page-btn",onClick:()=>w(ne=>Math.max(1,ne-1)),disabled:r<=1||t,"aria-label":"Previous page",children:l.jsx(Pm,{size:16})}),l.jsxs("span",{className:"gallery-page-indicator",children:[r," / ",s]}),l.jsx("button",{type:"button",className:"gallery-page-btn",onClick:()=>w(ne=>ne<s?ne+1:ne),disabled:r>=s||t,"aria-label":"Next page",children:l.jsx(Mo,{size:16})}),l.jsx(qe,{value:o,onChange:ne=>k(parseInt(ne,10)||30),className:"gallery-page-size","aria-label":"Items per page",size:"sm",options:[15,30,60,120]})]})]})]})}),W&&h.length===0?l.jsx("div",{className:"gallery-grid-responsive",children:Array.from({length:8}).map((ne,Re)=>l.jsxs("div",{className:"gallery-skeleton-item",children:[l.jsx("div",{className:"gallery-skeleton-thumb skeleton"}),l.jsx("div",{className:"gallery-skeleton-label skeleton skeleton-text"})]},Re))}):H&&h.length===0?l.jsxs("div",{className:"gallery-empty",role:"alert",children:[l.jsx("div",{className:"gallery-empty-icon",children:l.jsx(yd,{size:48})}),l.jsx("div",{className:"gallery-empty-title",children:"Gallery unavailable"}),l.jsx("div",{className:"gallery-empty-desc",children:d}),l.jsx("button",{type:"button",className:"ui-button is-primary is-compact mt-4",onClick:I,children:"Retry"})]}):h.length===0?l.jsxs("div",{className:"gallery-empty",children:[l.jsx("div",{className:"gallery-empty-icon",children:l.jsx(yd,{size:48})}),l.jsx("div",{className:"gallery-empty-title",children:"No media found"}),l.jsx("div",{className:"gallery-empty-desc",children:i!=="all"?`No ${i}s match your filters. Try selecting "All" or adjusting your search.`:"This folder is empty. Render something new or navigate to a different folder."})]}):V?l.jsx("div",{className:"w-full overflow-hidden",children:l.jsxs("div",{className:"gallery-grid-responsive",ref:ve,children:[_e&&je>0?l.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${je}px`}}):null,Ne.map(ne=>l.jsx(Dd,{item:ne,onSelect:P,variant:"grid",autoPlay:!1},se(ne))),_e&&Ee>0?l.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${Ee}px`}}):null]})}):l.jsx("div",{className:"flex flex-col gap-6 items-center",children:v.map(ne=>l.jsx("div",{className:"w-full flex justify-center",children:l.jsx(Dd,{item:ne,onSelect:P,variant:"feed",autoPlay:N})},se(ne)))}),l.jsx($w,{isOpen:T,media:z,onClose:ge,onPrev:K,onNext:ue,total:A,canPrev:B,canNext:le}),l.jsx(Nt,{open:G,onClose:()=>Z(!1),title:"Gallery filters",footer:l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>Z(!1),children:"Done"}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Type"}),l.jsx(Tr,{ariaLabel:"Filter by type",value:i,onChange:p,size:"sm",items:ee})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Options"}),l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx("button",{type:"button",className:`ui-button is-compact ${u?"is-primary":"is-muted"}`,onClick:()=>f(ne=>!ne),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[u?l.jsx(dd,{size:14}):l.jsx(fd,{size:14}),l.jsx("span",{children:u?"Subfolders":"This folder"})]})}),l.jsx("button",{type:"button",className:`ui-button is-compact ${a?"is-primary":"is-muted"}`,onClick:()=>S(ne=>!ne),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[a?l.jsx(pd,{size:14}):l.jsx(md,{size:14}),l.jsx("span",{children:a?"Hidden on":"Hidden off"})]})}),fe==="feed"?l.jsx("button",{type:"button",className:`ui-button is-compact ${N?"is-primary":"is-muted"}`,onClick:()=>_(ne=>!ne),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[N?l.jsx(hd,{size:14}):l.jsx(gd,{size:14}),l.jsx("span",{children:N?"Autoplay":"No autoplay"})]})}):null,l.jsx("button",{type:"button",className:"ui-button is-compact is-ghost",onClick:I,children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[l.jsx(Sa,{size:14}),l.jsx("span",{children:"Refresh"})]})})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Page size"}),l.jsx(qe,{value:o,onChange:ne=>k(parseInt(ne,10)||30),className:"sheet-select","aria-label":"Items per page",size:"sm",options:[15,30,60,120]}),l.jsxs("div",{className:"sheet-hint",children:[M?l.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):null,l.jsxs("span",{children:[te,"  Page ",r," of ",s]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>w(ne=>Math.max(1,ne-1)),disabled:r<=1||t,children:"Prev"}),l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>w(ne=>ne<s?ne+1:ne),disabled:r>=s||t,children:"Next"})]})]})]})})]})}const ho="::",Ww={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function Hw(){return`alias-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,6)}`}function dn(e){return String(e||"").split(",").map(t=>t.trim()).filter(Boolean)}function Do(e){return(e||[]).map(t=>String(t||"").trim()).filter(Boolean).join(", ")}function Gw(e,t){const n=String(t||"").trim();if(!n)return String(e||"");const r=dn(e);return new Set(r.map(o=>o.toLowerCase())).has(n.toLowerCase())||r.push(n),Do(r)}function Kw(e,t){const n=String(t||"").trim().toLowerCase();if(!n)return String(e||"");const r=dn(e).filter(s=>s.toLowerCase()!==n);return Do(r)}function Qw(e,t,n){const r=String(t||"").trim().toLowerCase(),s=String(n||"").trim();if(!r||!s)return String(e||"");const o=dn(e).map(u=>u.toLowerCase()===r?s:u),i=new Set,a=[];return o.forEach(u=>{const d=String(u||"").trim().toLowerCase();!d||i.has(d)||(i.add(d),a.push(u))}),Do(a)}function ji(e,t={}){return Object.entries(Ns(e)).map(([n,r],s)=>{const[o,i]=String(n).includes(ho)?n.split(ho):["",n],a=i||n,u=t[n]||t[a]||o||"";return{id:`existing-${s}-${n}`,name:a,text:r,category:u}})}function Vd(e){const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.text)=="string"?n.text.trim():"";if(r&&s){const o=String((n==null?void 0:n.category)||"").trim(),i=o?`${o}${ho}${r}`:r;t[i]=s}}),t}function Wd(e){const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.category)=="string"?n.category.trim():"";if(r){const o=s?`${s}${ho}${r}`:r;t[o]=s}}),t}function Yw(){var Te;const e=an(),{aliases:t,aliasCategories:n,categoryList:r,loading:s,saving:o,error:i,persistAliases:a}=Vm(),[u,d]=c.useState(()=>ji(t,n)),[y,g]=c.useState(()=>Array.isArray(r)?r:[]),[h,v]=c.useState("All"),[w,k]=c.useState("All"),[S,p]=c.useState(""),f=c.useDeferredValue(S),[m,j]=c.useState(""),[b,E]=c.useState(!1),[I,T]=c.useState(!1),[z,A]=c.useState({loading:!1,invalid:[],suggestions:{}}),[B,le]=c.useState(!1),[F,ge]=c.useState(null),[ue,K]=c.useState(""),fe=c.useRef(null),R=c.useRef(null),[N,_]=c.useState(!1),[P,V]=c.useState(""),[G,Z]=c.useState(""),ee=$o("(min-width: 1024px)");c.useEffect(()=>{if(N)return;const x=ji(t,n||{});d(x),m&&!x.some(L=>L.id===m)&&(j(""),E(!1))},[n,N]),c.useEffect(()=>{N||Array.isArray(r)&&g(r)},[r,N]),c.useEffect(()=>{if(N)return;const x=ji(t,n||{});d(x),m&&!x.some(L=>L.id===m)&&(j(""),E(!1))},[t,n,m,N]);const X=c.useMemo(()=>Vd(u),[u]),se=()=>{const x={id:Hw(),name:"",text:"",category:""};d(L=>[...L,x]),j(x.id),K(""),_(!0),E(!0)},W=(x,L,U)=>{_(!0),d(Y=>Y.map((pe,ae)=>ae===x?{...pe,[L]:U}:pe))},M=x=>{_(!0),d(L=>{var Y;const U=L.filter((pe,ae)=>ae!==x);return(U.length===0||m===((Y=L[x])==null?void 0:Y.id))&&(j(""),E(!1)),U})},O=async()=>{K("");try{const x=new Map;if(u.forEach(U=>{dn((U==null?void 0:U.text)||"").forEach(pe=>{const ae=String(pe).toLowerCase();ae&&(x.has(ae)||x.set(ae,{tag:pe,rows:[]}),x.get(ae).rows.push(U.id))})}),x.size){const U=Array.from(x.values()).map(Y=>Y.tag);try{const Y=await hi(U),pe=Array.isArray(Y==null?void 0:Y.invalid)?Y.invalid:[],ae=new Set(pe.map(ke=>String(ke).toLowerCase()));if(ae.size){const ke=u.map(Ce=>{const rt=dn((Ce==null?void 0:Ce.text)||"").filter(Je=>ae.has(String(Je).toLowerCase()));if(!rt.length)return null;const Yt=Ce.category?`${Ce.category}:${Ce.name}`:Ce.name;return{id:Ce.id,token:Yt,friendlyName:Tl({name:Ce.name})||Ce.name||"Untitled",category:Ce.category||"",invalid:rt}}).filter(Boolean);ge({invalid:pe,invalidLower:Array.from(ae),rows:ke,suggestions:(Y==null?void 0:Y.suggestions)||{}}),le(!0),K("Fix invalid tags before saving.");return}}catch(Y){console.error("Unable to validate tags",Y),K("Unable to validate tags right now.");return}}const L=Wd(u);await a({items:X,categories:L,categoryList:y}),_(!1),K("Saved.")}catch{K("Unable to save right now.")}},te=c.useMemo(()=>{const x=f.trim().toLowerCase(),U=[...u.filter(Y=>{const pe=(Y.category||"").trim();if(h===""&&pe||h!=="All"&&h!==""&&pe!==h)return!1;const ae=ds(Y.name||"",Y.category||"");if(w!=="All"&&ae!==w)return!1;if(!x)return!0;const ke=pe?`${pe}:${Y.name}`:Y.name;return(Y.name||"").toLowerCase().includes(x)||(Y.text||"").toLowerCase().includes(x)||(pe||"").toLowerCase().includes(x)||(ke||"").toLowerCase().includes(x)})];return U.sort((Y,pe)=>(Y.name||"").localeCompare(pe.name||"")),U},[u,h,w,f]),H=te.find(x=>x.id===m)||u.find(x=>x.id===m)||null,ve=H?H.category?`${H.category}:${H.name}`:H.name||"alias":"",Ne=H&&(Tl({name:H.name})||H.name)||"Alias",je=ve?`$${ve}$`:"$alias$",Ee=te.length?te:u,_e=H?Ee.findIndex(x=>x.id===H.id):-1,ne=_e>0?Ee[_e-1]:null,Re=_e>=0&&_e<Ee.length-1?Ee[_e+1]:null,Se=x=>{x&&(j(x.id),E(!0),K(""))},ze=c.useMemo(()=>{const x=new Set(y||[]);return u.forEach(L=>{L.category&&x.add(L.category)}),Array.from(x).sort((L,U)=>L.localeCompare(U))},[u,y]),J=c.useMemo(()=>{const x=new Set;return u.forEach(L=>{const U=(L.category||"").trim();if(h===""&&U||h!=="All"&&h!==""&&U!==h)return;const Y=ds(L.name||"",L.category||"");Y&&x.add(Y)}),Array.from(x).sort((L,U)=>L.localeCompare(U))},[u,h]);c.useEffect(()=>{w!=="All"&&(J.includes(w)||k("All"))},[J,w]),c.useEffect(()=>{Z("")},[m]);const de=c.useMemo(()=>dn((H==null?void 0:H.text)||""),[H==null?void 0:H.text]),me=c.useMemo(()=>{const x=Array.isArray(z==null?void 0:z.invalid)?z.invalid:[];return new Set(x.map(L=>String(L).toLowerCase()))},[z]);c.useEffect(()=>{if(!H||!(b||ee))return;const x=de,L=[],U=new Set;if(x.forEach(ae=>{const ke=String(ae).toLowerCase();!ke||U.has(ke)||(U.add(ke),L.push(ae))}),!L.length){A({loading:!1,invalid:[],suggestions:{}});return}let Y=!1;const pe=window.setTimeout(async()=>{A(ae=>({...ae,loading:!0}));try{const ae=await hi(L);if(Y)return;A({loading:!1,invalid:Array.isArray(ae==null?void 0:ae.invalid)?ae.invalid:[],suggestions:(ae==null?void 0:ae.suggestions)||{}})}catch(ae){console.error("Failed to validate tags",ae),Y||A({loading:!1,invalid:[],suggestions:{}})}},260);return()=>{Y=!0,window.clearTimeout(pe)}},[b,ee,H,de]);const ie=x=>{var U,Y;const L=String(x||"");if(!L)return!1;try{return(Y=(U=navigator.clipboard)==null?void 0:U.writeText)==null||Y.call(U,L),!0}catch{return!1}},D=(x="")=>{const L=x?`?q=${encodeURIComponent(x)}`:"";e(`/tags${L}`)},Q=()=>{var Y;if(!H)return;const x=dn(G);if(!x.length){K("Enter a tag to add.");return}const L=u.findIndex(pe=>pe.id===H.id);if(L===-1)return;let U=((Y=u[L])==null?void 0:Y.text)||"";x.forEach(pe=>{U=Gw(U,pe)}),W(L,"text",U),Z(""),K(`Added ${x.length} tag${x.length===1?"":"s"}.`)},oe=async()=>{const x=P.trim();if(!x){K("Enter a category name.");return}const L=Array.from(new Set([...y||[],x]));g(L),V(""),K("Category added.");const U=Vd(u),Y=Wd(u);_(!0);try{await a({items:U,categories:Y,categoryList:L}),_(!1),K("Category saved.")}catch{K("Unable to save right now.")}},ye=x=>{x&&(j(x.id),E(!0),K(""))},Le=()=>{ee&&j(""),E(!1),K("")};c.useMemo(()=>{const x=u.length,L=te.length;return s&&x===0?"Loading":x===L?`${x} aliases`:`${L} of ${x} aliases`},[u.length,te.length,s]),c.useEffect(()=>{const x=L=>{var Ce,he;if(L.defaultPrevented)return;const U=L.target,Y=(U==null?void 0:U.tagName)||"",pe=["INPUT","TEXTAREA","SELECT"].includes(Y)||(U==null?void 0:U.isContentEditable),ae=String(L.key||"").toLowerCase(),ke=L.metaKey||L.ctrlKey;if(ke&&ae==="s"){L.preventDefault(),N&&!o&&O();return}if(ke&&ae==="n"){L.preventDefault(),se();return}if(!pe&&ae==="/"){L.preventDefault(),(he=(Ce=R.current)==null?void 0:Ce.focus)==null||he.call(Ce);return}ae==="escape"&&b&&!ee&&(L.preventDefault(),Le())};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[se,Le,N,b,O,ee,o]);const Xe=l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:Le,children:ee?"Clear selection":"Close"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:O,disabled:o||!N,children:o?"Saving":N?"Save":"Saved"})]}),nt=H?l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"alias-editor-toolbar",children:[l.jsxs("div",{className:"alias-editor-heading",children:[l.jsx("div",{className:"alias-editor-title",children:Ne}),l.jsx("div",{className:"alias-editor-meta",children:je})]}),l.jsxs("div",{className:"alias-editor-actions",children:[l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>Se(ne),disabled:!ne,title:"Previous alias",children:"Prev"}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>Se(Re),disabled:!Re,title:"Next alias",children:"Next"}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>{ve&&ie(je)?K("Token copied."):K("Copy not available on this browser.")},title:"Copy token",children:"Copy token"})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Token"}),l.jsx("div",{className:"composer-token",children:je}),ds(H.name||"",H.category||"")?l.jsxs("div",{className:"sheet-hint",children:["Subcategory: ",Vn(ds(H.name||"",H.category||""))]}):null]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Friendly name"}),l.jsx("div",{className:"composer-field",children:Ne})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Alias name"}),l.jsx("input",{ref:fe,type:"text",value:H.name||"",onChange:x=>{const L=u.findIndex(U=>U.id===H.id);L!==-1&&W(L,"name",x.target.value)},placeholder:"e.g. cherry_fruit",className:"sheet-input ui-control ui-input"})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Category"}),l.jsx(qe,{value:H.category||"",onChange:x=>{const L=u.findIndex(U=>U.id===H.id);L!==-1&&W(L,"category",x)},className:"sheet-select",size:"sm",options:[{value:"",label:"Uncategorized"},...ze.filter(Boolean).map(x=>({value:x,label:fn(x)}))]}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>T(!0),children:"Manage categories"})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Expands to"}),l.jsx("textarea",{value:H.text,onChange:x=>{const L=u.findIndex(U=>U.id===H.id);L!==-1&&W(L,"text",x.target.value)},placeholder:"Prompt text for this alias",className:"sheet-textarea ui-control ui-textarea is-compact",rows:6}),l.jsxs("div",{className:"tag-quick-add",children:[l.jsx("input",{type:"text",value:G,onChange:x=>Z(x.target.value),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),Q())},placeholder:"Add tags (comma separated)",className:"ui-control ui-input tag-quick-input","aria-label":"Add tags"}),l.jsx("button",{type:"button",className:"ui-button is-compact is-primary",onClick:Q,disabled:!G.trim(),children:"Add"})]}),l.jsxs("div",{className:"tag-editor-actions",children:[l.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>D(""),children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(Gn,{size:14}),"Open tag library"]})}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>{A(L=>({...L,loading:!0}));const x=dn(H.text||"");hi(x).then(L=>{A({loading:!1,invalid:Array.isArray(L==null?void 0:L.invalid)?L.invalid:[],suggestions:(L==null?void 0:L.suggestions)||{}})}).catch(()=>A({loading:!1,invalid:[],suggestions:{}}))},disabled:z.loading,title:"Validate against danbooru_tags.md",children:z.loading?"Validating":"Validate"})]}),de.length?l.jsx("div",{className:"tag-chip-list","aria-label":"Alias tags",children:de.map(x=>{const L=me.has(String(x).toLowerCase());return l.jsxs("span",{className:`tag-chip ${L?"is-invalid":""}`,children:[l.jsx("code",{className:"tag-chip-code",children:x}),l.jsx("button",{type:"button",className:"tag-chip-remove",onClick:()=>{const U=u.findIndex(Y=>Y.id===H.id);U!==-1&&W(U,"text",Kw(H.text||"",x))},"aria-label":`Remove ${x}`,title:"Remove",children:l.jsx(on,{size:12})})]},x)})}):l.jsx("div",{className:"sheet-hint",children:"Tip: Use the Tag library to add validated tags quickly."}),!z.loading&&Array.isArray(z.invalid)&&z.invalid.length?l.jsxs("div",{className:"tag-invalid-panel",role:"alert",children:[l.jsxs("div",{className:"tag-invalid-title",children:["Invalid tags (",z.invalid.length,")"]}),l.jsx("div",{className:"tag-invalid-body",children:z.invalid.map(x=>{var U;const L=((U=z==null?void 0:z.suggestions)==null?void 0:U[x])||[];return l.jsxs("div",{className:"tag-invalid-row",children:[l.jsxs("div",{className:"tag-invalid-tag",children:[l.jsx("code",{children:x}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>D(x),children:"Find"})]}),Array.isArray(L)&&L.length?l.jsx("div",{className:"tag-invalid-suggestions",children:L.slice(0,6).map(Y=>l.jsx("button",{type:"button",className:"tag-suggestion",onClick:()=>{const pe=u.findIndex(ae=>ae.id===H.id);pe!==-1&&W(pe,"text",Qw(H.text||"",x,Y))},title:`Replace ${x} with ${Y}`,children:Y},`${x}-${Y}`))}):l.jsx("div",{className:"sheet-hint",children:"No suggestions found for this tag."})]},x)})})]}):null]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("button",{type:"button",className:"ui-button is-danger",onClick:()=>{const x=u.findIndex(L=>L.id===H.id);x!==-1&&(M(x),E(!1))},children:"Delete alias"}),l.jsx("div",{className:"sheet-hint",children:"Deleting removes it from your library. Use Save changes to persist."})]})]}):l.jsx("div",{className:"alias-editor-empty",children:"Select an alias to edit, or create a new one."});return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"page-shell page-stack alias-page",children:[l.jsxs("div",{className:"page-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Aliases"}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx(bt,{size:"xs",onClick:()=>openTagLibrary({query:S||"",targetId:""}),title:"Browse danbooru tags",children:"Tags"}),l.jsx(bt,{size:"xs",variant:"primary",onClick:se,children:"Add"})]})]}),l.jsx("div",{className:"library-toolbar screen-sticky",children:l.jsxs("div",{className:"library-toolbar-inner",children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:R,type:"search",value:S,onChange:x=>p(x.target.value),className:"composer-search ui-control ui-input",placeholder:"Search aliases","aria-label":"Search aliases"}),l.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>p(""),disabled:!S,children:"Clear"})]}),l.jsx(qe,{className:"composer-subcategory-select",value:h,onChange:v,"aria-label":"Filter by category",size:"sm",options:[{value:"All",label:"Category: All"},{value:"",label:"Uncategorized"},...ze.filter(Boolean).map(x=>({value:x,label:fn(x)}))]}),l.jsx(qe,{className:"composer-subcategory-select",value:w,onChange:k,"aria-label":"Filter by subcategory",size:"sm",options:[{value:"All",label:"Subcategory: All"},...J.map(x=>({value:x,label:Vn(x)}))]}),N?l.jsx("button",{type:"button",className:"ui-button is-compact is-primary",onClick:O,disabled:o,children:o?"Saving":"Save changes"}):null]}),i?l.jsx("div",{className:"library-toolbar-status is-error",children:"Could not load aliases. Try again later."}):null,ue?l.jsx("div",{className:"library-toolbar-status",children:ue}):null]})}),l.jsxs("div",{className:"alias-layout",children:[l.jsx("div",{className:"alias-list",children:u.length===0&&!s?l.jsx("section",{className:"ui-panel text-center py-16",children:l.jsx("p",{className:"text-base text-[rgba(159,178,215,0.8)]",children:"No aliases yet. Add your first one."})}):l.jsxs("div",{className:"composer-alias-list",role:"list",children:[te.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases match your filters."}):null,te.map(x=>{const L=(x.category||"").trim(),U=L?`${L}:${x.name}`:x.name,Y=(x.text||"").slice(0,140)+((x.text||"").length>140?"":"");return l.jsxs("button",{type:"button",role:"listitem",className:`composer-alias-item ${m===x.id?"is-selected":""}`,onClick:()=>ye(x),style:Ww,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:Tl({name:x.name})||x.name||"Untitled"}),L?l.jsx("span",{className:"composer-alias-category",children:fn(L)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",U||"alias","$"]}),l.jsx("div",{className:"composer-alias-text",children:Y||""})]},x.id)})]})}),l.jsx("aside",{className:"alias-editor-panel",children:l.jsxs("div",{className:"alias-editor-card ui-panel",children:[nt,H?l.jsx("div",{className:"alias-editor-footer",children:Xe}):null]})})]})]}),l.jsx(Nt,{open:b&&!!H&&!ee,onClose:Le,title:"Alias",variant:"fullscreen",footer:Xe,children:nt}),l.jsx(Nt,{open:I,onClose:()=>{T(!1),V(""),K("")},title:"Categories",variant:"sheet",footer:l.jsx("div",{className:"sheet-hint",children:"Categories help you organize aliases and improve the Insert alias picker."}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Add category"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:P,onChange:x=>V(x.target.value),placeholder:"e.g. styles",className:"sheet-input ui-control ui-input"}),l.jsx("button",{type:"button",className:"ui-button is-primary is-compact",onClick:oe,children:"Add"})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Existing"}),ze.length===0?l.jsx("div",{className:"sheet-hint",children:"No categories yet."}):l.jsx(qe,{className:"sheet-select",value:"",onChange:x=>{x&&(v(x),T(!1))},size:"sm",placeholder:"Select a category",options:ze.filter(Boolean).map(x=>({value:x,label:fn(x)}))})]})]})}),l.jsx(Nt,{open:B,onClose:()=>le(!1),title:"Fix invalid tags",variant:"fullscreen",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>le(!1),children:"Close"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>{const x=new Set(((F==null?void 0:F.invalidLower)||[]).map(L=>String(L).toLowerCase()));if(!x.size){le(!1);return}d(L=>L.map(U=>{const pe=dn((U==null?void 0:U.text)||"").filter(ke=>!x.has(String(ke).toLowerCase())),ae=Do(pe);return ae===((U==null?void 0:U.text)||"")?U:{...U,text:ae}})),_(!0),le(!1),K("Removed invalid tags. Review and save again.")},children:"Remove invalid tags"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsx("div",{className:"sheet-section",children:l.jsxs("div",{className:"sheet-hint",children:["These aliases contain tags not found in ",l.jsx("code",{className:"font-mono",children:"danbooru_tags.md"}),". Fix them before saving."]})}),(Te=F==null?void 0:F.rows)!=null&&Te.length?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Aliases with issues"}),l.jsx("div",{className:"composer-alias-list",role:"list",children:F.rows.map(x=>l.jsxs("button",{type:"button",role:"listitem",className:"composer-alias-item",onClick:()=>{j(x.id),E(!0),le(!1)},children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:x.friendlyName}),x.category?l.jsx("span",{className:"composer-alias-category",children:fn(x.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",x.token,"$"]}),l.jsx("div",{className:"tag-invalid-inline",children:x.invalid.map(L=>l.jsx("span",{className:"tag-chip is-invalid",children:l.jsx("code",{className:"tag-chip-code",children:L})},`${x.id}-${L}`))})]},x.id))})]}):null]})})]})}const qw={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function Xw(e){var n,r;const t=String(e||"");if(!t)return!1;try{return(r=(n=navigator.clipboard)==null?void 0:n.writeText)==null||r.call(n,t),!0}catch{return!1}}function Jw({open:e,onClose:t,onSelectTag:n,initialQuery:r="",title:s="Tag library",contextTitle:o="",contextToken:i="",contextText:a="",contextTagCount:u=null,inline:d=!1}){const[y,g]=c.useState(r||""),[h,v]=c.useState(""),[w,k]=c.useState("count"),[S,p]=c.useState([]),[f,m]=c.useState([]),[j,b]=c.useState(0),[E,I]=c.useState(0),[T,z]=c.useState(!1),[A,B]=c.useState(!1),[le,F]=c.useState(""),[ge,ue]=c.useState(""),K=c.useRef(null),fe=c.useRef(null),[R,N]=c.useState([]),[_,P]=c.useState(!1),[V,G]=c.useState(null),[Z,ee]=c.useState(null),X=c.useRef(null),se=c.useRef(null),W=c.useRef(null),M=c.useRef(null),O=c.useRef(null),te=f.length<j,H=d||e,ve=c.useMemo(()=>R.join(", "),[R]),Ne=c.useMemo(()=>new Set(R.map(D=>D.toLowerCase())),[R]),je=c.useCallback(D=>{const Q=String(D||"").trim();Q&&N(oe=>new Set(oe.map(Le=>Le.toLowerCase())).has(Q.toLowerCase())?oe:[...oe,Q])},[]),Ee=c.useCallback(D=>{const Q=String(D||"").trim().toLowerCase();Q&&N(oe=>oe.filter(ye=>ye.toLowerCase()!==Q))},[]),_e=c.useCallback(()=>{N([]),ue("Cleared collected tags.")},[]),ne=c.useCallback(()=>{var Q,oe;if(!R.length){ue("No tags to copy.");return}if(Xw(ve)){ue(`Copied ${R.length} tag${R.length===1?"":"s"}.`);return}const D=W.current;if(D)try{D.value=ve,D.removeAttribute("readonly"),D.select(),D.setSelectionRange(0,ve.length);const ye=document.execCommand&&document.execCommand("copy");if(D.setAttribute("readonly","readonly"),(oe=(Q=window.getSelection())==null?void 0:Q.removeAllRanges)==null||oe.call(Q),ye){ue(`Copied ${R.length} tag${R.length===1?"":"s"}.`);return}}catch{}ue("Copy not available on this browser.")},[R,ve]),Re=c.useCallback((D,Q)=>{N(oe=>{const ye=[...oe],[Le]=ye.splice(D,1);return ye.splice(Q,0,Le),ye})},[]);c.useCallback((D,Q)=>{G(Q),M.current=D.target,D.dataTransfer.effectAllowed="move",D.dataTransfer.setData("text/plain",Q.toString()),requestAnimationFrame(()=>{M.current&&M.current.classList.add("is-dragging")})},[]),c.useCallback(()=>{M.current&&M.current.classList.remove("is-dragging"),V!==null&&Z!==null&&V!==Z&&Re(V,Z),G(null),ee(null),M.current=null},[V,Z,Re]),c.useCallback((D,Q)=>{D.preventDefault(),D.dataTransfer.dropEffect="move",ee(Q)},[]),c.useCallback(()=>{},[]),c.useCallback((D,Q)=>{const oe=D.touches[0];O.current={idx:Q,startX:oe.clientX,startY:oe.clientY,moved:!1}},[]),c.useCallback(D=>{if(!O.current)return;const Q=D.touches[0],oe=Math.abs(Q.clientX-O.current.startX),ye=Math.abs(Q.clientY-O.current.startY);if(oe>10||ye>10){O.current.moved=!0,G(O.current.idx),D.preventDefault();const Le=document.querySelectorAll(".collected-tag-chip"),Xe=Q.clientX,nt=Q.clientY;for(let Te=0;Te<Le.length;Te++){const x=Le[Te].getBoundingClientRect();if(Xe>=x.left&&Xe<=x.right&&nt>=x.top&&nt<=x.bottom){ee(Te);break}}}},[]),c.useCallback(()=>{var D;(D=O.current)!=null&&D.moved&&V!==null&&Z!==null&&V!==Z&&Re(V,Z),O.current=null,G(null),ee(null)},[V,Z,Re]);const Se=c.useCallback(async({nextQuery:D,nextCategory:Q,nextSort:oe}={})=>{const ye=typeof D=="string"?D:y,Le=typeof Q=="string"?Q:h,Xe=typeof oe=="string"?oe:w;z(!0),F(""),ue(""),I(0),K.current&&K.current.abort();const nt=new AbortController;K.current=nt;try{const Te=await co({q:ye,category:Le,sort:Xe,limit:80,offset:0},{signal:nt.signal});m((Te==null?void 0:Te.items)||[]),b(Number((Te==null?void 0:Te.total)||0))}catch(Te){if((Te==null?void 0:Te.name)==="AbortError")return;console.error("Failed to search tags",Te),F("Unable to load tags right now."),m([]),b(0)}finally{K.current===nt&&(K.current=null),z(!1)}},[h,y,w]),ze=c.useCallback(async()=>{if(T||A||!te)return;const D=E+80;B(!0),F(""),fe.current&&fe.current.abort();const Q=new AbortController;fe.current=Q;try{const oe=await co({q:y,category:h,sort:w,limit:80,offset:D},{signal:Q.signal}),ye=(oe==null?void 0:oe.items)||[];m(Le=>[...Le,...ye]),b(Number((oe==null?void 0:oe.total)||0)),I(D)}catch(oe){if((oe==null?void 0:oe.name)==="AbortError")return;console.error("Failed to load more tags",oe),F("Unable to load more tags.")}finally{fe.current===Q&&(fe.current=null),B(!1)}},[te,h,T,A,E,y,w]);c.useEffect(()=>{if(!H)return;F(""),ue("");let D=!1;return(async()=>{try{const Q=await wm();if(D)return;p(Array.isArray(Q==null?void 0:Q.categories)?Q.categories:[])}catch(Q){console.error("Failed to load tag categories",Q),D||p([])}})(),()=>{D=!0}},[H]),c.useEffect(()=>{H&&(g(r||""),v(""),k("count"),m([]),b(0),I(0),z(!1),B(!1),F(""),ue(""),N([]))},[r,H]),c.useEffect(()=>{if(!H)return;const D=window.setTimeout(()=>{Se()},220);return()=>window.clearTimeout(D)},[h,H,y,Se,w]),c.useEffect(()=>()=>{K.current&&K.current.abort(),fe.current&&fe.current.abort()},[]),c.useEffect(()=>{if(!H)return;const D=X.current;if(!D||typeof IntersectionObserver>"u")return;const Q=new IntersectionObserver(oe=>{const ye=oe[0];ye!=null&&ye.isIntersecting&&ze()},{threshold:.1});return Q.observe(D),()=>Q.disconnect()},[H,ze]);const J=c.useMemo(()=>d?null:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:t,children:"Done"}),l.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:()=>Se(),disabled:T||A,children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(Sa,{size:14}),"Refresh"]})})]}),[d,T,A,t,Se]),de=!!(n&&(o||i||a)),me=Number.isFinite(u)?`${u} tags`:"",ie=l.jsxs("div",{className:`sheet-stack ${d?"tag-library-page":""}`,children:[de?l.jsxs("div",{className:"tag-library-context",children:[l.jsxs("div",{className:"tag-library-context-head",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"sheet-label",children:"Adding to alias"}),l.jsx("div",{className:"tag-library-context-title",children:o||"Alias"}),i?l.jsx("div",{className:"tag-library-context-token",children:i}):null]}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:t,children:"Back"})]}),l.jsx("div",{className:"tag-library-context-preview",children:a||""}),me?l.jsx("div",{className:"tag-library-context-meta",children:me}):null]}):null,l.jsxs("div",{className:"sheet-section",children:[d?null:l.jsx("div",{className:"sheet-label",children:"Browse"}),l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:se,type:"search",value:y,onChange:D=>g(D.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),l.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>g(""),disabled:!y,children:"Clear"})]}),l.jsx(qe,{value:h,onChange:v,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:[{value:"",label:"Category: All"},...S.map(D=>({value:D.key,label:`${Vn(D.key)} (${Number(D.actual||D.count||0).toLocaleString()})`}))]}),l.jsx(qe,{value:w,onChange:k,className:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]})]}),ge?l.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:ge}):null,le?l.jsx("div",{className:"text-xs text-[#FF8F70]",children:le}):null]}),l.jsx("div",{className:"composer-alias-list tag-library-grid",role:"list",children:T?l.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):f.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):l.jsxs(l.Fragment,{children:[f.map(D=>l.jsx("div",{className:"tag-library-row",role:"listitem",style:qw,children:l.jsxs("button",{type:"button",className:`composer-alias-item tag-library-item ${!n&&Ne.has(String(D.tag||"").toLowerCase())?"is-collected":""}`,onClick:()=>{if(n){n(String(D.tag||"")),ue(`Added: ${D.tag}`);return}const Q=String(D.tag||"");Ne.has(Q.toLowerCase())?(Ee(Q),ue(`Removed: ${D.tag}`)):(je(Q),ue(`Added: ${D.tag}`))},children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name tag-library-name",children:l.jsx("code",{className:"tag-library-code",children:D.tag})}),D.category?l.jsx("span",{className:"composer-alias-category",children:Vn(D.category)}):null]}),l.jsx("div",{className:"composer-alias-token",children:Number(D.count||0).toLocaleString()})]})},`${D.tag}-${D.category}`)),l.jsx("div",{ref:X,className:"composer-sentinel"}),A?l.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]});return H?d?l.jsxs("section",{className:"tag-library-surface",children:[s?l.jsx("div",{className:"sheet-label tag-library-page-title",children:s}):null,ie,n?null:l.jsxs("div",{className:"tag-collection-bar","aria-live":"polite",children:[l.jsxs("div",{className:"tag-collection-bar-main",children:[l.jsx("div",{className:"tag-collection-bar-title",children:"Tags"}),l.jsx("div",{className:"tag-collection-bar-count","aria-live":"polite",children:R.length===0?"No tags selected":`${R.length} selected`})]}),l.jsx("button",{type:"button",className:"tag-collection-menu-btn",onClick:()=>P(!0),"aria-label":"Manage collected tags",children:l.jsx(ax,{size:16})}),l.jsx("textarea",{ref:W,value:ve,onChange:D=>{const Q=D.target.value.split(",").map(Le=>Le.trim()).filter(Boolean),oe=new Set,ye=[];Q.forEach(Le=>{const Xe=Le.toLowerCase();oe.has(Xe)||(oe.add(Xe),ye.push(Le))}),N(ye)},className:"sr-only","aria-label":"Collected tags text"})]}),n?null:l.jsx(Nt,{open:_,onClose:()=>P(!1),title:"Collected tags",variant:"sheet",shouldCloseOnOverlayClick:!0,children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsxs("div",{className:"sheet-label",children:["Tags (",R.length,")"]}),l.jsxs("div",{className:"tag-collection-codeblock",children:[l.jsx("pre",{className:"tag-collection-pre",children:ve||""}),l.jsx("button",{type:"button",className:"tag-collection-copy-btn",onClick:ne,disabled:R.length===0,"aria-label":"Copy collected tags",children:l.jsx(cx,{size:16})}),l.jsx("textarea",{ref:W,value:ve,readOnly:!0,className:"sr-only","aria-label":"Collected tags text"})]}),R.length?l.jsx("div",{className:"tag-collection-chips",children:R.map((D,Q)=>l.jsxs("span",{className:"collected-tag-chip",onClick:()=>Ee(D),role:"button",tabIndex:0,onKeyDown:oe=>{oe.target===oe.currentTarget&&(oe.key==="Enter"||oe.key===" ")&&(oe.preventDefault(),Ee(D))},children:[l.jsx("code",{className:"collected-tag-code",children:D}),l.jsx("button",{type:"button",className:"collected-tag-remove","aria-label":`Remove ${D}`,onClick:oe=>{oe.stopPropagation(),Ee(D)},children:l.jsx(on,{size:12})})]},`${D}-${Q}`))}):l.jsx("div",{className:"sheet-hint",children:"No tags collected yet."})]}),l.jsxs("div",{className:"sheet-section flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>P(!1),children:"Close"}),l.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:_e,disabled:R.length===0,children:"Clear"})]})]})})]}):l.jsx(Nt,{open:e,onClose:t,title:s,variant:"fullscreen",contentClassName:"tag-library-sheet",footer:J,shouldCloseOnOverlayClick:!1,children:ie}):null}function Zw(){const e=an(),[t]=gm(),n=t.get("q")||"",r=c.useMemo(()=>n?`Tag Library  ${n}`:"Tag Library",[n]);return l.jsxs("div",{className:"page-shell page-stack",children:[l.jsxs("div",{className:"page-bar",children:[l.jsx("h1",{className:"page-bar-title",children:r}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx(bt,{size:"xs",onClick:()=>e("/aliases"),children:"Aliases"}),l.jsx(bt,{size:"xs",onClick:()=>e("/compose"),children:"Composer"})]})]}),l.jsx(Jw,{inline:!0,initialQuery:n,title:"Browse",onSelectTag:null})]})}const Hd={contentVisibility:"auto",containIntrinsicSize:"260px 140px"};function e0({open:e=!1,onClose:t,value:n="",onChange:r,aliasOptions:s=[],aliasCatalog:o=[],fieldLabel:i="Prompt",variant:a="sheet"}){var Wc,Hc,Gc;const u=c.useRef(null),d=c.useRef(null),y=c.useRef(null),g=c.useRef(null),[h,v]=c.useState(n),[w,k]=c.useState(""),S=c.useDeferredValue(w),[p,f]=c.useState("All"),[m,j]=c.useState("All"),[b,E]=c.useState(30),[I,T]=c.useState("compose"),[z,A]=c.useState(null),[B,le]=c.useState(null),[F,ge]=c.useState(null),ue=c.useRef(null),K=c.useRef(null),[fe,R]=c.useState(!1),[N,_]=c.useState(null),P=c.useRef(null),V=c.useRef(null),[G,Z]=c.useState(""),[ee,X]=c.useState(""),[se,W]=c.useState("count"),[M,O]=c.useState([]),[te,H]=c.useState([]),[ve,Ne]=c.useState(0),[je,Ee]=c.useState(0),[_e,ne]=c.useState(!1),[Re,Se]=c.useState(!1),[ze,J]=c.useState(""),de=c.useRef(null),me=c.useRef(null),[ie,D]=c.useState([]),[Q,oe]=c.useState(""),[ye,Le]=c.useState([]),[Xe,nt]=c.useState(""),Te=c.useMemo(()=>{if(!h)return{text:"",parts:[]};const C=new Map;if((o||[]).forEach(Oe=>{if(!Oe)return;const we=String(Oe.token||"").trim().toLowerCase(),kt=typeof Oe.text=="string"?Oe.text.trim():"";!we||!kt||C.set(we,kt)}),!C.size||!h.includes("$"))return{text:h,parts:[{text:h,isAlias:!1}]};const $=[],re=/\$([a-z0-9_:-]+)\$/gi;let xe=0,$e;for(;($e=re.exec(h))!==null;){const Oe=$e.index;Oe>xe&&$.push({text:h.slice(xe,Oe),isAlias:!1});const we=String($e[1]||"").toLowerCase(),kt=C.get(we);typeof kt=="string"?$.push({text:kt,isAlias:!0}):$.push({text:$e[0],isAlias:!1}),xe=re.lastIndex}return xe<h.length&&$.push({text:h.slice(xe),isAlias:!1}),{text:$.map(Oe=>Oe.text).join(""),parts:$}},[o,h]);c.useEffect(()=>{e&&(v(n),T("compose"),k(""),f("All"),j("All"),E(30),A(null),le(null),ge(null),R(!1),_(null),qr(""),Z(""),X(""),W("count"),H([]),Ne(0),Ee(0),ne(!1),Se(!1),J(""))},[e,n]),c.useEffect(()=>{if(z===null||typeof document>"u")return;const C=document.querySelector("main.app-content"),$={htmlOverscroll:document.documentElement.style.overscrollBehavior,bodyOverscroll:document.body.style.overscrollBehavior,bodyOverflow:document.body.style.overflow,scrollOverflow:C==null?void 0:C.style.overflow,scrollTouch:C==null?void 0:C.style.touchAction,scrollOverscroll:C==null?void 0:C.style.overscrollBehavior};return document.documentElement.style.overscrollBehavior="none",document.body.style.overscrollBehavior="none",document.body.style.overflow="hidden",C&&(C.style.overflow="hidden",C.style.touchAction="none",C.style.overscrollBehavior="none"),()=>{document.documentElement.style.overscrollBehavior=$.htmlOverscroll||"",document.body.style.overscrollBehavior=$.bodyOverscroll||"",document.body.style.overflow=$.bodyOverflow||"",C&&(C.style.overflow=$.scrollOverflow||"",C.style.touchAction=$.scrollTouch||"",C.style.overscrollBehavior=$.scrollOverscroll||"")}},[z]);const x=c.useMemo(()=>(Array.isArray(o)?o.filter(C=>C&&C.name):[]).map(C=>({...C,...Ac(C)})),[o]),L=c.useMemo(()=>{const C=new Map;return x.forEach($=>{$!=null&&$.token&&C.set(String($.token).toLowerCase(),$)}),C},[x]),U=c.useMemo(()=>{const C=new Set(["All"]);return x.forEach($=>{$.category&&C.add($.category)}),Array.from(C).sort(($,re)=>$.localeCompare(re))},[x]),Y=c.useMemo(()=>{const C=new Set(["All"]);return x.forEach($=>{(!p||p==="All"||$.category===p)&&$.subcategory&&C.add($.subcategory)}),Array.from(C).sort(($,re)=>$.localeCompare(re))},[x,p]),pe=c.useMemo(()=>["All",...U.filter(C=>C!=="All")],[U]),ae=c.useMemo(()=>["All",...Y.filter(C=>C!=="All")],[Y]),ke=c.useMemo(()=>{const C=S.trim().toLowerCase();return x.filter($=>{var re,xe,$e,Ae;return p!=="All"&&($.category||"")!==p||m!=="All"&&($.subcategory||"other")!==m?!1:C?((re=$.token)==null?void 0:re.toLowerCase().includes(C))||((xe=$.text)==null?void 0:xe.toLowerCase().includes(C))||(($e=$.name)==null?void 0:$e.toLowerCase().includes(C))||((Ae=$.displayName)==null?void 0:Ae.toLowerCase().includes(C)):!0}).sort(($,re)=>{const xe=($.subcategory||"").toLowerCase(),$e=(re.subcategory||"").toLowerCase();return xe!==$e?xe.localeCompare($e):$.token.localeCompare(re.token)})},[x,p,m,S]),Ce=c.useMemo(()=>ke.slice(0,b),[ke,b]);c.useEffect(()=>{E(30)},[p,m,w,x]),c.useEffect(()=>{j("All")},[p]),c.useEffect(()=>{const C=y.current;if(!C)return;const $=new IntersectionObserver(re=>{re[0].isIntersecting&&b<ke.length&&E($e=>Math.min($e+20,ke.length))},{threshold:.1});return $.observe(C),()=>$.disconnect()},[b,ke.length]);const he=c.useMemo(()=>typeof h!="string"?[]:_x(h),[h]);c.useEffect(()=>{if(!e||I!=="tags"||M.length>0)return;let C=!1;return(async()=>{try{const $=await wm();if(C)return;O(Array.isArray($==null?void 0:$.categories)?$.categories:[])}catch($){console.error("Failed to load tag categories",$),C||O([])}})(),()=>{C=!0}},[e,I,M.length]);const rt=c.useCallback(async({nextQuery:C,nextCategory:$,nextSort:re}={})=>{const xe=typeof C=="string"?C:G,$e=typeof $=="string"?$:ee,Ae=typeof re=="string"?re:se;ne(!0),J(""),Ee(0),de.current&&de.current.abort();const Oe=new AbortController;de.current=Oe;try{const we=await co({q:xe,category:$e,sort:Ae,limit:80,offset:0},{signal:Oe.signal});H((we==null?void 0:we.items)||[]),Ne(Number((we==null?void 0:we.total)||0))}catch(we){if((we==null?void 0:we.name)==="AbortError")return;console.error("Failed to search tags",we),J("Unable to load tags right now."),H([]),Ne(0)}finally{de.current===Oe&&(de.current=null),ne(!1)}},[ee,G,se]),Yt=c.useCallback(async()=>{if(_e||Re||te.length>=ve)return;const C=je+80;Se(!0),J(""),me.current&&me.current.abort();const $=new AbortController;me.current=$;try{const re=await co({q:G,category:ee,sort:se,limit:80,offset:C},{signal:$.signal}),xe=(re==null?void 0:re.items)||[];H($e=>[...$e,...xe]),Ne(Number((re==null?void 0:re.total)||0)),Ee(C)}catch(re){if((re==null?void 0:re.name)==="AbortError")return;console.error("Failed to load more tags",re),J("Unable to load more tags.")}finally{me.current===$&&(me.current=null),Se(!1)}},[ee,_e,Re,je,G,se,te.length,ve]);c.useEffect(()=>{if(!e||I!=="tags")return;const C=window.setTimeout(()=>{rt()},220);return()=>window.clearTimeout(C)},[e,I,G,ee,se,rt]),c.useEffect(()=>()=>{de.current&&de.current.abort(),me.current&&me.current.abort()},[]),c.useEffect(()=>{if(!e||I!=="tags")return;const C=V.current;if(!C||typeof IntersectionObserver>"u")return;const $=new IntersectionObserver(re=>{const xe=re[0];xe!=null&&xe.isIntersecting&&Yt()},{threshold:.1});return $.observe(C),()=>$.disconnect()},[e,I,Yt]);const Je=ve?`${te.length.toLocaleString()} / ${ve.toLocaleString()}`:`${te.length.toLocaleString()}`,Ze=c.useCallback(C=>{v($=>{const xe=typeof C=="function"?C(typeof $=="string"?$:""):String(C||"");return a==="page"&&(r==null||r(xe)),xe})},[r,a]),yt=c.useCallback(C=>{const $=String(C||"").trim();if($&&(Ze(re=>{const xe=re.length,$e=re.length,Ae=re.slice(0,xe),Oe=re.slice($e),we=Ae.match(/[^\s]$/),kt=Oe.match(/^[^\s]/),ih=we&&we[0]!==","?", ":"",ah=kt&&kt[0]!==","?", ":"";return Ae+ih+$+ah+Oe}),u.current))try{u.current.blur()}catch{}},[Ze]),[qt,qr]=c.useState(""),Xr=c.useCallback(()=>{const C=String(qt||"").trim();if(!C)return;const re=C.split(",").map(xe=>xe.trim()).filter(Boolean).join(", ");re&&(yt(re),qr(""),T("compose"))},[qt,yt]),Js=c.useCallback(()=>{D([]),oe("Cleared collected tags.")},[]),Zs=c.useCallback(C=>{const $=String(C||"").trim().toLowerCase();$&&D(re=>re.filter(xe=>xe.toLowerCase()!==$))},[]),el=c.useCallback(()=>{if(!ie.length){oe("No tags to apply.");return}yt(ie.join(", ")),oe(`Applied ${ie.length} tag${ie.length===1?"":"s"}.`),D([]),T("compose")},[ie,yt]),Gm=c.useCallback(C=>{const $=String(C||"").trim();$&&D(re=>{const xe=$.toLowerCase();return re.some(Ae=>Ae.toLowerCase()===xe)?(oe(`Removed: ${$}`),re.filter(Ae=>Ae.toLowerCase()!==xe)):(oe(`Selected: ${$}`),[...re,$])})},[]),Km=c.useCallback(C=>{const $=String(C||"").trim();$&&Le(re=>{const xe=$.toLowerCase();return re.some(Ae=>Ae.toLowerCase()===xe)?(nt(`Removed: ${$}`),re.filter(Ae=>Ae.toLowerCase()!==xe)):(nt(`Selected: ${$}`),[...re,$])})},[]),Qm=c.useCallback(()=>{Le([]),nt("Cleared selected aliases.")},[]),Ym=c.useCallback(C=>{const $=String(C||"").trim().toLowerCase();$&&Le(re=>re.filter(xe=>xe.toLowerCase()!==$))},[]),qm=c.useCallback(()=>{if(!ye.length){nt("No aliases to apply.");return}const C=ye.map($=>`$${$}$`).join(", ");yt(C),nt(`Applied ${ye.length} alias${ye.length===1?"":"es"}.`),Le([]),T("compose")},[ye,yt]),Oc=C=>{Ze($=>Rx($||"",C))},Fc=c.useCallback((C,$)=>{if(!(he!=null&&he.length))return;const re=C+$;re<0||re>=he.length||(Ze(xe=>Nd(xe||"",he,C,re)),ge(re))},[he,Ze]),Dc=C=>{if(!C)return;let $=C.text;if(C.type==="alias"){const xe=L.get(C.text.toLowerCase());$=(xe==null?void 0:xe.displayName)||C.text}const re=jd(h||"",C);_({element:C,displayName:$,weight:(re==null?void 0:re.weight)??1}),R(!0)},tl=c.useCallback((C,$)=>{C===$||C===null||$===null||he!=null&&he.length&&Ze(re=>Nd(re||"",he,C,$))},[he,Ze]),Xm=c.useCallback((C,$)=>{A($),ue.current=C.target,C.dataTransfer.effectAllowed="move",C.dataTransfer.setData("text/plain",$.toString()),requestAnimationFrame(()=>{ue.current&&ue.current.classList.add("is-dragging")})},[]),Jm=c.useCallback(()=>{ue.current&&ue.current.classList.remove("is-dragging"),z!==null&&B!==null&&z!==B&&tl(z,B),A(null),le(null),ue.current=null},[z,B,tl]),Zm=c.useCallback((C,$)=>{C.preventDefault(),C.dataTransfer.dropEffect="move",$!==B&&le($)},[B]),eh=c.useCallback(()=>{},[]),th=c.useCallback((C,$)=>{var Ae,Oe;if(!((Oe=(Ae=C.target)==null?void 0:Ae.closest)==null?void 0:Oe.call(Ae,".composer-token-drag-handle")))return;const xe=C.touches[0],$e=window.setTimeout(()=>{K.current&&(K.current.active=!0,A($),le($))},240);K.current={idx:$,startX:xe.clientX,startY:xe.clientY,active:!1,timer:$e}},[]),nh=c.useCallback(C=>{if(!K.current)return;const $=C.touches[0],re=Math.abs($.clientX-K.current.startX),xe=Math.abs($.clientY-K.current.startY);if(!K.current.active){(re>8||xe>8)&&(window.clearTimeout(K.current.timer),K.current=null);return}C.preventDefault();const $e=document.querySelectorAll(".composer-token-draggable"),Ae=$.clientX,Oe=$.clientY;for(let we=0;we<$e.length;we++){const kt=$e[we].getBoundingClientRect();if(Ae>=kt.left&&Ae<=kt.right&&Oe>=kt.top&&Oe<=kt.bottom){le(we);break}}},[]),rh=c.useCallback(()=>{var C,$;(C=K.current)!=null&&C.timer&&window.clearTimeout(K.current.timer),($=K.current)!=null&&$.active&&z!==null&&B!==null&&z!==B&&tl(z,B),K.current=null,A(null),le(null)},[z,B,tl]),sh=c.useCallback(()=>{var C;(C=K.current)!=null&&C.timer&&window.clearTimeout(K.current.timer),K.current=null,A(null),le(null)},[]),lh=()=>{r==null||r(h),t==null||t()},Uc=()=>{t==null||t()},Uo=a==="page";if(!(Uo||e))return null;const Bc=l.jsxs("div",{className:`composer-shell ${Uo?"is-page":""}`,children:[l.jsx(Tr,{ariaLabel:"Composer tabs",value:I,onChange:T,items:[{key:"compose",label:"Compose",icon:l.jsx(Rc,{size:14})},{key:"aliases",label:"Aliases",icon:l.jsx(Xs,{size:14})},{key:"tags",label:"Tags",icon:l.jsx(Gn,{size:14})}]}),l.jsxs("div",{className:`composer-panel composer-panel-compose ${I==="compose"?"is-visible":""}`,children:[l.jsx("div",{className:"composer-editor",children:l.jsxs("div",{className:"composer-input-row",children:[l.jsx("input",{ref:u,type:"text",value:qt,onChange:C=>qr(C.target.value),onKeyDown:C=>{C.key==="Enter"&&(C.preventDefault(),Xr())},className:"composer-input ui-control ui-input is-compact",placeholder:"Add prompt text","aria-label":"Add prompt text"}),l.jsx("button",{type:"button",className:"composer-add-btn",onClick:Xr,disabled:!qt.trim(),"aria-label":"Add prompt text",children:"+"})]})}),l.jsxs("div",{className:"composer-tokens",children:[l.jsxs("div",{className:"composer-tokens-header",children:[l.jsxs("span",{className:"composer-tokens-label",children:["Elements",l.jsx("span",{className:"composer-tokens-count",children:he.length})]}),l.jsx("span",{className:"composer-tokens-hint",children:"Drag to reorder  Tap to adjust"})]}),he.length?l.jsx("div",{ref:g,className:`composer-tokens-list ${z!==null?"is-dragging":""}`,children:he.map((C,$)=>{let re=C.text;if(C.type==="alias"){const we=L.get(C.text.toLowerCase());re=(we==null?void 0:we.displayName)||C.text}const xe=z===$,$e=B===$&&z!==null&&z!==$,Ae=jd(h||"",C),Oe=(Ae==null?void 0:Ae.weight)??1;return l.jsxs("span",{className:`composer-token composer-token-draggable ${C.type==="alias"?"is-alias":"is-tag"} ${xe?"is-dragging":""} ${$e?"is-drop-target":""} ${F===$?"is-selected":""}`,title:C.type==="alias"?`Alias: $${C.text}$`:`Tag: ${C.text}`,role:"button",tabIndex:0,draggable:!0,onDragStart:we=>Xm(we,$),onDragEnd:Jm,onDragOver:we=>Zm(we,$),onDragLeave:eh,onTouchStart:we=>th(we,$),onTouchMove:nh,onTouchEnd:rh,onTouchCancel:sh,onClick:()=>{z===null&&(ge($),Dc(C))},onKeyDown:we=>{if(we.target===we.currentTarget&&(we.key==="Enter"||we.key===" ")){if(we.preventDefault(),z!==null)return;ge($),Dc(C)}},children:[l.jsx("span",{className:"composer-token-order",children:$+1}),l.jsx("span",{className:"composer-token-drag-handle","aria-hidden":"true",children:l.jsx(Na,{size:10})}),l.jsx("span",{className:"composer-token-name",children:re}),C.type==="alias"&&l.jsx("span",{className:"composer-token-type",children:"$"}),Math.abs(Oe-1)>1e-6&&l.jsxs("span",{className:"composer-token-weight",children:[hn(Oe),""]}),l.jsxs("div",{className:"composer-token-shift",role:"group","aria-label":"Reorder token",children:[l.jsx("button",{type:"button",className:"composer-token-shift-btn",onClick:we=>{we.stopPropagation(),Fc($,-1)},"aria-label":"Move up",disabled:$===0,children:""}),l.jsx("button",{type:"button",className:"composer-token-shift-btn",onClick:we=>{we.stopPropagation(),Fc($,1)},"aria-label":"Move down",disabled:$===he.length-1,children:""})]}),l.jsx("button",{type:"button",className:"composer-token-remove",onClick:we=>{we.stopPropagation(),Oc(C)},"aria-label":`Remove ${C.text}`,children:l.jsx(on,{size:9})})]},`${C.type}-${C.text}-${C.start}`)})}):l.jsx("div",{className:"composer-empty",children:"No elements yet."})]}),l.jsxs("div",{className:"composer-expanded",children:[l.jsxs("div",{className:"composer-expanded-header",children:[l.jsx("span",{className:"composer-expanded-label",children:"Expanded prompt"}),l.jsx("span",{className:"composer-expanded-meta",children:Te.text?`${Te.text.length} chars`:"Empty"})]}),l.jsx("div",{className:"composer-expanded-box","aria-label":"Expanded prompt",children:Te.text?Te.parts.map((C,$)=>C.isAlias?l.jsx("span",{className:"composer-expanded-alias",children:C.text},`alias-${$}`):l.jsx("span",{children:C.text},`text-${$}`)):"No prompt yet."})]})]}),l.jsxs("div",{className:`composer-panel composer-panel-aliases ${I==="aliases"?"is-visible":""}`,children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:d,type:"text",value:w,onChange:C=>k(C.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),l.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>k(""),disabled:!w,children:"Clear"})]}),l.jsx(qe,{value:p,onChange:f,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:pe.map(C=>({value:C,label:C==="All"?"Category: All":fn(C)}))}),ae.length>2&&l.jsx(qe,{value:m,onChange:j,className:"composer-subcategory-select",size:"sm",options:ae.map(C=>({value:C,label:C==="All"?"All subcategories":Vn(C)}))})]}),l.jsxs("div",{className:"composer-tag-collection-bar is-sticky",children:[l.jsxs("div",{children:[l.jsx("div",{className:"composer-tag-collection-label",children:ye.length?`${ye.length} selected`:"No aliases selected"}),Xe?l.jsx("div",{className:"composer-tag-collection-status",children:Xe}):null]}),l.jsxs("div",{className:"composer-tag-collection-actions",children:[l.jsx("button",{type:"button",className:"composer-tag-collection-btn",onClick:Qm,disabled:!ye.length,children:"Clear"}),l.jsx("button",{type:"button",className:"composer-tag-collection-btn is-primary",onClick:qm,disabled:!ye.length,children:"Apply"})]})]}),ye.length?l.jsxs("div",{className:"composer-collection-inline",role:"list",children:[ye.slice(0,3).map(C=>{const $=L.get(C.toLowerCase()),re=($==null?void 0:$.displayName)||C;return l.jsxs("button",{type:"button",className:"collected-tag-chip",onClick:()=>Ym(C),"aria-label":`Remove ${C}`,title:`$${C}$`,children:[l.jsx("code",{className:"collected-tag-code",children:re}),l.jsx(on,{size:12})]},C)}),ye.length>3?l.jsxs("div",{className:"collected-tag-chip tag-overflow-chip","aria-hidden":"true",children:["+",ye.length-3," more"]}):null]}):null,l.jsx("div",{className:"composer-alias-list",children:ke.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):l.jsxs(l.Fragment,{children:[Ce.map(C=>l.jsxs("button",{type:"button",onClick:()=>Km(C.token),className:`composer-alias-item ${ye.some($=>$.toLowerCase()===C.token.toLowerCase())?"is-collected":""}`,style:Hd,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:C.displayName||C.token}),C.category?l.jsx("span",{className:"composer-alias-category",children:fn(C.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",C.token,"$"]}),l.jsx("div",{className:"composer-alias-text",children:C.text})]},C.key)),b<ke.length&&l.jsx("div",{ref:y,className:"composer-sentinel"})]})})]}),l.jsxs("div",{className:`composer-panel composer-panel-tags ${I==="tags"?"is-visible":""}`,onClick:C=>C.stopPropagation(),children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:P,type:"search",value:G,onChange:C=>Z(C.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),l.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>Z(""),disabled:!G,children:"Clear"})]}),l.jsx(qe,{value:ee,onChange:X,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:[{value:"",label:"Category: All"},...M.map(C=>({value:C.key,label:`${Vn(C.key)} (${Number(C.actual||C.count||0).toLocaleString()})`}))]}),l.jsx(qe,{value:se,onChange:W,className:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]})]}),l.jsx("div",{className:"composer-tags-header",children:l.jsx("div",{className:"composer-tags-hint",children:l.jsx("span",{className:"ml-3 opacity-80",children:Je})})}),l.jsxs("div",{className:"composer-tag-collection-bar is-sticky",children:[l.jsxs("div",{children:[l.jsx("div",{className:"composer-tag-collection-label",children:ie.length?`${ie.length} selected`:"No tags selected"}),Q?l.jsx("div",{className:"composer-tag-collection-status",children:Q}):null]}),l.jsxs("div",{className:"composer-tag-collection-actions",children:[l.jsx("button",{type:"button",className:"composer-tag-collection-btn",onClick:Js,disabled:!ie.length,children:"Clear"}),l.jsx("button",{type:"button",className:"composer-tag-collection-btn is-primary",onClick:el,disabled:!ie.length,children:"Apply"})]})]}),ie.length?l.jsxs("div",{className:"composer-collection-inline",role:"list",children:[ie.slice(0,3).map(C=>l.jsxs("button",{type:"button",className:"collected-tag-chip",onClick:()=>Zs(C),"aria-label":`Remove ${C}`,children:[l.jsx("code",{className:"collected-tag-code",children:C}),l.jsx(on,{size:12})]},C)),ie.length>3?l.jsxs("div",{className:"collected-tag-chip tag-overflow-chip","aria-hidden":"true",children:["+",ie.length-3," more"]}):null]}):null,ze?l.jsx("div",{className:"composer-tags-error",children:ze}):null,l.jsx("div",{className:"composer-alias-list composer-tags-grid",role:"list",children:_e?l.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):te.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):l.jsxs(l.Fragment,{children:[te.map(C=>{const $=ie.some(re=>re.toLowerCase()===String(C.tag||"").toLowerCase());return l.jsxs("button",{type:"button",className:`composer-alias-item composer-tag-item ${$?"is-collected":""}`,onClick:re=>{re.stopPropagation(),Gm(C.tag)},style:Hd,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name composer-tag-name",children:l.jsx("code",{className:"composer-tag-code",children:C.tag})}),C.category?l.jsx("span",{className:"composer-alias-category",children:Vn(C.category)}):null]}),l.jsx("div",{className:"composer-alias-token composer-tag-count",children:Number(C.count||0).toLocaleString()})]},`${C.tag}-${C.category}`)}),te.length<ve&&l.jsx("div",{ref:V,className:"composer-sentinel"}),Re?l.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]})]}),Vc=l.jsx(Ea,{open:fe,onClose:()=>R(!1),title:((Wc=N==null?void 0:N.element)==null?void 0:Wc.type)==="alias"?"Alias strength":"Tag strength",tokenLabel:N?((Hc=N.element)==null?void 0:Hc.type)==="alias"?`${N.displayName}  $${(Gc=N.element)==null?void 0:Gc.text}$`:N.displayName:"",weight:(N==null?void 0:N.weight)??1,onApply:C=>{N!=null&&N.element&&Ze($=>Sd($||"",N.element,C))},onRemoveWeight:()=>{N!=null&&N.element&&Ze(C=>Sd(C||"",N.element,null))},onDeleteToken:()=>{N!=null&&N.element&&Oc(N.element)}}),oh=l.jsx("div",{className:"page-bar composer-bar",children:l.jsx("h1",{className:"page-bar-title",children:i||"Prompt"})});return Uo?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"page-shell page-stack",children:[oh,Bc]}),Vc]}):l.jsxs(l.Fragment,{children:[l.jsx(Nt,{open:e,onClose:Uc,title:"Composer",variant:"fullscreen",shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:Uc,children:"Cancel"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:lh,children:"Apply"})]}),children:Bc}),Vc]})}function t0(){const e=an(),[t]=gm(),{formData:n,handleFormChange:r,aliasOptions:s,aliasCatalog:o,promptFieldName:i,handleGenerate:a,workflowData:u,selectedWorkflow:d,isLoading:y}=Hm(),h=t.get("field")||i||"prompt",v=(n==null?void 0:n[h])||"";return c.useEffect(()=>{if(!(typeof document>"u"))return document.body.classList.add("no-pull-refresh"),document.documentElement.classList.add("no-pull-refresh"),()=>{document.body.classList.remove("no-pull-refresh"),document.documentElement.classList.remove("no-pull-refresh")}},[]),c.useEffect(()=>{const w=()=>{!u||!d||y||a()};return window.addEventListener("cozygen:request-render",w),()=>window.removeEventListener("cozygen:request-render",w)},[a,y,d,u]),l.jsx(e0,{open:!0,onClose:()=>e("/controls"),value:v,onChange:w=>r(h,w),aliasOptions:s,aliasCatalog:o,fieldLabel:h,variant:"page"})}function n0(){var p,f;const{authed:e,ready:t,login:n}=To(),r=an(),o=((f=(p=It().state)==null?void 0:p.from)==null?void 0:f.pathname)||"/studio",[i,a]=c.useState(""),[u,d]=c.useState(""),[y,g]=c.useState(""),[h,v]=c.useState(!1),[w,k]=c.useState(!1);c.useEffect(()=>{try{localStorage.getItem("cozygen_idle_logout")&&(k(!0),localStorage.removeItem("cozygen_idle_logout"))}catch{}},[]),c.useEffect(()=>{t&&e&&r(o,{replace:!0})},[t,e,o,r]);const S=async m=>{m.preventDefault(),g(""),v(!0);try{await n(i,u),r(o,{replace:!0})}catch(j){j!=null&&j.unauthorized?g("Invalid username or password."):g("Unable to sign in. Please try again.")}finally{v(!1)}};return l.jsx("div",{className:"login-shell",children:l.jsxs("div",{className:"neon-card login-card",children:[l.jsxs("div",{className:"login-brand",children:[l.jsx(Em,{size:34}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"login-title",children:"Sign in"}),l.jsx("div",{className:"login-subtitle",children:"Continue to CozyGen Studio"})]})]}),l.jsxs("form",{className:"login-form",onSubmit:S,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"login-username",className:"login-label",children:"Username"}),l.jsx("input",{id:"login-username",type:"text",className:"ui-control ui-input",value:i,onChange:m=>a(m.target.value),autoComplete:"username",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"login-password",className:"login-label",children:"Password"}),l.jsx("input",{id:"login-password",type:"password",className:"ui-control ui-input",value:u,onChange:m=>d(m.target.value),autoComplete:"current-password",required:!0})]}),y?l.jsx("div",{className:"ui-alert",children:y}):w?l.jsx("div",{className:"ui-alert is-warn",children:"You were signed out due to inactivity. Please sign in again."}):null,l.jsx("button",{type:"submit",disabled:h,className:"ui-button is-primary w-full",children:h?"Signing in":"Sign in"})]}),l.jsxs("p",{className:"login-footnote",children:["Access is protected by CozyGen auth. Set ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /"," ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server to enable."]})]})})}function r0({containerRef:e}){const{pathname:t,hash:n}=It();return c.useEffect(()=>{if(n)return;const r=e==null?void 0:e.current;if(r&&typeof r.scrollTo=="function"){r.scrollTo({top:0,left:0,behavior:"auto"});return}typeof window<"u"&&window.scrollTo(0,0)},[t,n,e]),null}function s0({children:e}){const{authed:t,ready:n}=To(),r=It();return n?t?e:l.jsx(ya,{to:"/login",state:{from:r},replace:!0}):l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-200",children:l.jsxs("div",{className:"page-loading",children:[l.jsx("span",{className:"loading-spinner lg","aria-hidden":"true"}),l.jsx("span",{className:"sr-only",children:"Checking session"})]})})}function l0(){const{pathname:e}=It(),t=an(),{defaultCreds:n,authed:r}=To(),s=e==="/login",o=c.useRef(null),i=!s,a=i;return c.useEffect(()=>{if(!r)return;const u=d=>{var h;const y=String(((h=d==null?void 0:d.detail)==null?void 0:h.fieldName)||"").trim(),g=y?`?field=${encodeURIComponent(y)}`:"";t(`/compose${g}`)};return window.addEventListener("cozygen:open-composer",u),()=>window.removeEventListener("cozygen:open-composer",u)},[r,t]),l.jsxs("div",{className:"app-shell",children:[!s&&l.jsx(dx,{isMobileAlignedNav:i}),!s&&r&&n&&l.jsxs("div",{className:"flex-shrink-0 bg-amber-500/10 text-amber-200 border-b border-amber-400/50 px-4 py-2 text-sm text-center",children:["Default CozyGen credentials are still in use. Change ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server."]}),l.jsx(r0,{containerRef:o}),l.jsxs("div",{className:"app-body",children:[l.jsx("main",{ref:o,className:s?"app-content is-login":"app-content",children:l.jsxs(Lv,{children:[l.jsx(Ut,{path:"/login",element:l.jsx(n0,{})}),l.jsxs(Ut,{element:l.jsx(s0,{children:l.jsx(bw,{children:l.jsx(bv,{})})}),children:[l.jsx(Ut,{path:"/",element:l.jsx(ya,{to:"/studio",replace:!0})}),l.jsx(Ut,{path:"/studio",element:l.jsx(Pw,{})}),l.jsx(Ut,{path:"/controls",element:l.jsx(Lw,{})}),l.jsx(Ut,{path:"/compose",element:l.jsx(t0,{})}),l.jsx(Ut,{path:"/gallery",element:l.jsx(Vw,{})}),l.jsx(Ut,{path:"/aliases",element:l.jsx(Yw,{})}),l.jsx(Ut,{path:"/tags",element:l.jsx(Zw,{})})]}),l.jsx(Ut,{path:"*",element:l.jsx(ya,{to:"/studio",replace:!0})})]})}),a?l.jsx(mx,{}):null]})]})}function o0(){return l.jsx(Mv,{children:l.jsx(sx,{children:l.jsx(l0,{})})})}Si.createRoot(document.getElementById("root")).render(l.jsx(zt.StrictMode,{children:l.jsx(o0,{})}));
