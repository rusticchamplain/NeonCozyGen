function dg(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const l=Object.getOwnPropertyDescriptor(r,s);l&&Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}})();function fg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Of={exports:{}},Qi={},Df={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wl=Symbol.for("react.element"),pg=Symbol.for("react.portal"),hg=Symbol.for("react.fragment"),mg=Symbol.for("react.strict_mode"),gg=Symbol.for("react.profiler"),vg=Symbol.for("react.provider"),yg=Symbol.for("react.context"),xg=Symbol.for("react.forward_ref"),wg=Symbol.for("react.suspense"),Sg=Symbol.for("react.memo"),jg=Symbol.for("react.lazy"),Fu=Symbol.iterator;function kg(e){return e===null||typeof e!="object"?null:(e=Fu&&e[Fu]||e["@@iterator"],typeof e=="function"?e:null)}var Bf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Uf=Object.assign,Vf={};function Ss(e,t,n){this.props=e,this.context=t,this.refs=Vf,this.updater=n||Bf}Ss.prototype.isReactComponent={};Ss.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ss.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Wf(){}Wf.prototype=Ss.prototype;function fc(e,t,n){this.props=e,this.context=t,this.refs=Vf,this.updater=n||Bf}var pc=fc.prototype=new Wf;pc.constructor=fc;Uf(pc,Ss.prototype);pc.isPureReactComponent=!0;var Ou=Array.isArray,Hf=Object.prototype.hasOwnProperty,hc={current:null},Gf={key:!0,ref:!0,__self:!0,__source:!0};function Kf(e,t,n){var r,s={},l=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(l=""+t.key),t)Hf.call(t,r)&&!Gf.hasOwnProperty(r)&&(s[r]=t[r]);var o=arguments.length-2;if(o===1)s.children=n;else if(1<o){for(var u=Array(o),d=0;d<o;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)s[r]===void 0&&(s[r]=o[r]);return{$$typeof:wl,type:e,key:l,ref:a,props:s,_owner:hc.current}}function Ng(e,t){return{$$typeof:wl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function mc(e){return typeof e=="object"&&e!==null&&e.$$typeof===wl}function Cg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Du=/\/+/g;function wa(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Cg(""+e.key):t.toString(36)}function ti(e,t,n,r,s){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(l){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case wl:case pg:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+wa(a,0):r,Ou(s)?(n="",e!=null&&(n=e.replace(Du,"$&/")+"/"),ti(s,t,n,"",function(d){return d})):s!=null&&(mc(s)&&(s=Ng(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Du,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",Ou(e))for(var o=0;o<e.length;o++){l=e[o];var u=r+wa(l,o);a+=ti(l,t,n,u,s)}else if(u=kg(e),typeof u=="function")for(e=u.call(e),o=0;!(l=e.next()).done;)l=l.value,u=r+wa(l,o++),a+=ti(l,t,n,u,s);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Il(e,t,n){if(e==null)return e;var r=[],s=0;return ti(e,r,"","",function(l){return t.call(n,l,s++)}),r}function Eg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rt={current:null},ni={transition:null},bg={ReactCurrentDispatcher:Rt,ReactCurrentBatchConfig:ni,ReactCurrentOwner:hc};function Qf(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:Il,forEach:function(e,t,n){Il(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Il(e,function(){t++}),t},toArray:function(e){return Il(e,function(t){return t})||[]},only:function(e){if(!mc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Fe.Component=Ss;Fe.Fragment=hg;Fe.Profiler=gg;Fe.PureComponent=fc;Fe.StrictMode=mg;Fe.Suspense=wg;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bg;Fe.act=Qf;Fe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Uf({},e.props),s=e.key,l=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,a=hc.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(u in t)Hf.call(t,u)&&!Gf.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&o!==void 0?o[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){o=Array(u);for(var d=0;d<u;d++)o[d]=arguments[d+2];r.children=o}return{$$typeof:wl,type:e.type,key:s,ref:l,props:r,_owner:a}};Fe.createContext=function(e){return e={$$typeof:yg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:vg,_context:e},e.Consumer=e};Fe.createElement=Kf;Fe.createFactory=function(e){var t=Kf.bind(null,e);return t.type=e,t};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(e){return{$$typeof:xg,render:e}};Fe.isValidElement=mc;Fe.lazy=function(e){return{$$typeof:jg,_payload:{_status:-1,_result:e},_init:Eg}};Fe.memo=function(e,t){return{$$typeof:Sg,type:e,compare:t===void 0?null:t}};Fe.startTransition=function(e){var t=ni.transition;ni.transition={};try{e()}finally{ni.transition=t}};Fe.unstable_act=Qf;Fe.useCallback=function(e,t){return Rt.current.useCallback(e,t)};Fe.useContext=function(e){return Rt.current.useContext(e)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(e){return Rt.current.useDeferredValue(e)};Fe.useEffect=function(e,t){return Rt.current.useEffect(e,t)};Fe.useId=function(){return Rt.current.useId()};Fe.useImperativeHandle=function(e,t,n){return Rt.current.useImperativeHandle(e,t,n)};Fe.useInsertionEffect=function(e,t){return Rt.current.useInsertionEffect(e,t)};Fe.useLayoutEffect=function(e,t){return Rt.current.useLayoutEffect(e,t)};Fe.useMemo=function(e,t){return Rt.current.useMemo(e,t)};Fe.useReducer=function(e,t,n){return Rt.current.useReducer(e,t,n)};Fe.useRef=function(e){return Rt.current.useRef(e)};Fe.useState=function(e){return Rt.current.useState(e)};Fe.useSyncExternalStore=function(e,t,n){return Rt.current.useSyncExternalStore(e,t,n)};Fe.useTransition=function(){return Rt.current.useTransition()};Fe.version="18.3.1";Df.exports=Fe;var c=Df.exports;const Zt=fg(c),Lg=dg({__proto__:null,default:Zt},[c]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pg=c,zg=Symbol.for("react.element"),_g=Symbol.for("react.fragment"),Rg=Object.prototype.hasOwnProperty,Ig=Pg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ag={key:!0,ref:!0,__self:!0,__source:!0};function Yf(e,t,n){var r,s={},l=null,a=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)Rg.call(t,r)&&!Ag.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:zg,type:e,key:l,ref:a,props:s,_owner:Ig.current}}Qi.Fragment=_g;Qi.jsx=Yf;Qi.jsxs=Yf;Of.exports=Qi;var i=Of.exports,Za={},qf={exports:{}},Qt={},Xf={exports:{}},Jf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(_,C){var $=_.length;_.push(C);e:for(;0<$;){var P=$-1>>>1,D=_[P];if(0<s(D,C))_[P]=C,_[$]=D,$=P;else break e}}function n(_){return _.length===0?null:_[0]}function r(_){if(_.length===0)return null;var C=_[0],$=_.pop();if($!==C){_[0]=$;e:for(var P=0,D=_.length,H=D>>>1;P<H;){var le=2*(P+1)-1,Z=_[le],ee=le+1,ce=_[ee];if(0>s(Z,$))ee<D&&0>s(ce,Z)?(_[P]=ce,_[ee]=$,P=ee):(_[P]=Z,_[le]=$,P=le);else if(ee<D&&0>s(ce,$))_[P]=ce,_[ee]=$,P=ee;else break e}}return C}function s(_,C){var $=_.sortIndex-C.sortIndex;return $!==0?$:_.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var u=[],d=[],m=1,v=null,g=3,y=!1,w=!1,j=!1,S=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(_){for(var C=n(d);C!==null;){if(C.callback===null)r(d);else if(C.startTime<=_)r(d),C.sortIndex=C.expirationTime,t(u,C);else break;C=n(d)}}function x(_){if(j=!1,p(_),!w)if(n(u)!==null)w=!0,ae(N);else{var C=n(d);C!==null&&de(x,C.startTime-_)}}function N(_,C){w=!1,j&&(j=!1,h(R),R=-1),y=!0;var $=g;try{for(p(C),v=n(u);v!==null&&(!(v.expirationTime>C)||_&&!I());){var P=v.callback;if(typeof P=="function"){v.callback=null,g=v.priorityLevel;var D=P(v.expirationTime<=C);C=e.unstable_now(),typeof D=="function"?v.callback=D:v===n(u)&&r(u),p(C)}else r(u);v=n(u)}if(v!==null)var H=!0;else{var le=n(d);le!==null&&de(x,le.startTime-C),H=!1}return H}finally{v=null,g=$,y=!1}}var k=!1,L=null,R=-1,T=5,z=-1;function I(){return!(e.unstable_now()-z<T)}function X(){if(L!==null){var _=e.unstable_now();z=_;var C=!0;try{C=L(!0,_)}finally{C?Y():(k=!1,L=null)}}else k=!1}var Y;if(typeof f=="function")Y=function(){f(X)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,ve=be.port2;be.port1.onmessage=X,Y=function(){ve.postMessage(null)}}else Y=function(){S(X,0)};function ae(_){L=_,k||(k=!0,Y())}function de(_,C){R=S(function(){_(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(_){_.callback=null},e.unstable_continueExecution=function(){w||y||(w=!0,ae(N))},e.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<_?Math.floor(1e3/_):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(_){switch(g){case 1:case 2:case 3:var C=3;break;default:C=g}var $=g;g=C;try{return _()}finally{g=$}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(_,C){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var $=g;g=_;try{return C()}finally{g=$}},e.unstable_scheduleCallback=function(_,C,$){var P=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?P+$:P):$=P,_){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=$+D,_={id:m++,callback:C,priorityLevel:_,startTime:$,expirationTime:D,sortIndex:-1},$>P?(_.sortIndex=$,t(d,_),n(u)===null&&_===n(d)&&(j?(h(R),R=-1):j=!0,de(x,$-P))):(_.sortIndex=D,t(u,_),w||y||(w=!0,ae(N))),_},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(_){var C=g;return function(){var $=g;g=C;try{return _.apply(this,arguments)}finally{g=$}}}})(Jf);Xf.exports=Jf;var Tg=Xf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mg=c,Kt=Tg;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zf=new Set,Zs={};function Tr(e,t){fs(e,t),fs(e+"Capture",t)}function fs(e,t){for(Zs[e]=t,e=0;e<t.length;e++)Zf.add(t[e])}var Fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eo=Object.prototype.hasOwnProperty,$g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bu={},Uu={};function Fg(e){return eo.call(Uu,e)?!0:eo.call(Bu,e)?!1:$g.test(e)?Uu[e]=!0:(Bu[e]=!0,!1)}function Og(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Dg(e,t,n,r){if(t===null||typeof t>"u"||Og(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function It(e,t,n,r,s,l,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=a}var jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){jt[e]=new It(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];jt[t]=new It(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){jt[e]=new It(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){jt[e]=new It(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){jt[e]=new It(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){jt[e]=new It(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){jt[e]=new It(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){jt[e]=new It(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){jt[e]=new It(e,5,!1,e.toLowerCase(),null,!1,!1)});var gc=/[\-:]([a-z])/g;function vc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(gc,vc);jt[t]=new It(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(gc,vc);jt[t]=new It(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(gc,vc);jt[t]=new It(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){jt[e]=new It(e,1,!1,e.toLowerCase(),null,!1,!1)});jt.xlinkHref=new It("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){jt[e]=new It(e,1,!1,e.toLowerCase(),null,!0,!0)});function yc(e,t,n,r){var s=jt.hasOwnProperty(t)?jt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Dg(t,n,s,r)&&(n=null),r||s===null?Fg(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Un=Mg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Al=Symbol.for("react.element"),Kr=Symbol.for("react.portal"),Qr=Symbol.for("react.fragment"),xc=Symbol.for("react.strict_mode"),to=Symbol.for("react.profiler"),ep=Symbol.for("react.provider"),tp=Symbol.for("react.context"),wc=Symbol.for("react.forward_ref"),no=Symbol.for("react.suspense"),ro=Symbol.for("react.suspense_list"),Sc=Symbol.for("react.memo"),Yn=Symbol.for("react.lazy"),np=Symbol.for("react.offscreen"),Vu=Symbol.iterator;function bs(e){return e===null||typeof e!="object"?null:(e=Vu&&e[Vu]||e["@@iterator"],typeof e=="function"?e:null)}var ct=Object.assign,Sa;function Ms(e){if(Sa===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Sa=t&&t[1]||""}return`
`+Sa+e}var ja=!1;function ka(e,t){if(!e||ja)return"";ja=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),l=r.stack.split(`
`),a=s.length-1,o=l.length-1;1<=a&&0<=o&&s[a]!==l[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==l[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==l[o]){var u=`
`+s[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=o);break}}}finally{ja=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ms(e):""}function Bg(e){switch(e.tag){case 5:return Ms(e.type);case 16:return Ms("Lazy");case 13:return Ms("Suspense");case 19:return Ms("SuspenseList");case 0:case 2:case 15:return e=ka(e.type,!1),e;case 11:return e=ka(e.type.render,!1),e;case 1:return e=ka(e.type,!0),e;default:return""}}function so(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Qr:return"Fragment";case Kr:return"Portal";case to:return"Profiler";case xc:return"StrictMode";case no:return"Suspense";case ro:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case tp:return(e.displayName||"Context")+".Consumer";case ep:return(e._context.displayName||"Context")+".Provider";case wc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Sc:return t=e.displayName||null,t!==null?t:so(e.type)||"Memo";case Yn:t=e._payload,e=e._init;try{return so(e(t))}catch{}}return null}function Ug(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return so(t);case 8:return t===xc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function dr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Vg(e){var t=rp(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,l.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Tl(e){e._valueTracker||(e._valueTracker=Vg(e))}function sp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=rp(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function hi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function lo(e,t){var n=t.checked;return ct({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Wu(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=dr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function lp(e,t){t=t.checked,t!=null&&yc(e,"checked",t,!1)}function io(e,t){lp(e,t);var n=dr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ao(e,t.type,n):t.hasOwnProperty("defaultValue")&&ao(e,t.type,dr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Hu(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function ao(e,t,n){(t!=="number"||hi(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var $s=Array.isArray;function ls(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+dr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function oo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return ct({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Gu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(J(92));if($s(n)){if(1<n.length)throw Error(J(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:dr(n)}}function ip(e,t){var n=dr(t.value),r=dr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Ku(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ap(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function co(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ap(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ml,op=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ml=Ml||document.createElement("div"),Ml.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ml.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function el(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Us={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wg=["Webkit","ms","Moz","O"];Object.keys(Us).forEach(function(e){Wg.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Us[t]=Us[e]})});function cp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Us.hasOwnProperty(e)&&Us[e]?(""+t).trim():t+"px"}function up(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=cp(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Hg=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uo(e,t){if(t){if(Hg[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function fo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var po=null;function jc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ho=null,is=null,as=null;function Qu(e){if(e=kl(e)){if(typeof ho!="function")throw Error(J(280));var t=e.stateNode;t&&(t=Zi(t),ho(e.stateNode,e.type,t))}}function dp(e){is?as?as.push(e):as=[e]:is=e}function fp(){if(is){var e=is,t=as;if(as=is=null,Qu(e),t)for(e=0;e<t.length;e++)Qu(t[e])}}function pp(e,t){return e(t)}function hp(){}var Na=!1;function mp(e,t,n){if(Na)return e(t,n);Na=!0;try{return pp(e,t,n)}finally{Na=!1,(is!==null||as!==null)&&(hp(),fp())}}function tl(e,t){var n=e.stateNode;if(n===null)return null;var r=Zi(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(J(231,t,typeof n));return n}var mo=!1;if(Fn)try{var Ls={};Object.defineProperty(Ls,"passive",{get:function(){mo=!0}}),window.addEventListener("test",Ls,Ls),window.removeEventListener("test",Ls,Ls)}catch{mo=!1}function Gg(e,t,n,r,s,l,a,o,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(m){this.onError(m)}}var Vs=!1,mi=null,gi=!1,go=null,Kg={onError:function(e){Vs=!0,mi=e}};function Qg(e,t,n,r,s,l,a,o,u){Vs=!1,mi=null,Gg.apply(Kg,arguments)}function Yg(e,t,n,r,s,l,a,o,u){if(Qg.apply(this,arguments),Vs){if(Vs){var d=mi;Vs=!1,mi=null}else throw Error(J(198));gi||(gi=!0,go=d)}}function Mr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function gp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Yu(e){if(Mr(e)!==e)throw Error(J(188))}function qg(e){var t=e.alternate;if(!t){if(t=Mr(e),t===null)throw Error(J(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var l=s.alternate;if(l===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===l.child){for(l=s.child;l;){if(l===n)return Yu(s),e;if(l===r)return Yu(s),t;l=l.sibling}throw Error(J(188))}if(n.return!==r.return)n=s,r=l;else{for(var a=!1,o=s.child;o;){if(o===n){a=!0,n=s,r=l;break}if(o===r){a=!0,r=s,n=l;break}o=o.sibling}if(!a){for(o=l.child;o;){if(o===n){a=!0,n=l,r=s;break}if(o===r){a=!0,r=l,n=s;break}o=o.sibling}if(!a)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?e:t}function vp(e){return e=qg(e),e!==null?yp(e):null}function yp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yp(e);if(t!==null)return t;e=e.sibling}return null}var xp=Kt.unstable_scheduleCallback,qu=Kt.unstable_cancelCallback,Xg=Kt.unstable_shouldYield,Jg=Kt.unstable_requestPaint,ft=Kt.unstable_now,Zg=Kt.unstable_getCurrentPriorityLevel,kc=Kt.unstable_ImmediatePriority,wp=Kt.unstable_UserBlockingPriority,vi=Kt.unstable_NormalPriority,ev=Kt.unstable_LowPriority,Sp=Kt.unstable_IdlePriority,Yi=null,Cn=null;function tv(e){if(Cn&&typeof Cn.onCommitFiberRoot=="function")try{Cn.onCommitFiberRoot(Yi,e,void 0,(e.current.flags&128)===128)}catch{}}var pn=Math.clz32?Math.clz32:sv,nv=Math.log,rv=Math.LN2;function sv(e){return e>>>=0,e===0?32:31-(nv(e)/rv|0)|0}var $l=64,Fl=4194304;function Fs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function yi(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,l=e.pingedLanes,a=n&268435455;if(a!==0){var o=a&~s;o!==0?r=Fs(o):(l&=a,l!==0&&(r=Fs(l)))}else a=n&~s,a!==0?r=Fs(a):l!==0&&(r=Fs(l));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,l=t&-t,s>=l||s===16&&(l&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-pn(t),s=1<<n,r|=e[n],t&=~s;return r}function lv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function iv(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,l=e.pendingLanes;0<l;){var a=31-pn(l),o=1<<a,u=s[a];u===-1?(!(o&n)||o&r)&&(s[a]=lv(o,t)):u<=t&&(e.expiredLanes|=o),l&=~o}}function vo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function jp(){var e=$l;return $l<<=1,!($l&4194240)&&($l=64),e}function Ca(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Sl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-pn(t),e[t]=n}function av(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-pn(n),l=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~l}}function Nc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-pn(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var qe=0;function kp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Np,Cc,Cp,Ep,bp,yo=!1,Ol=[],nr=null,rr=null,sr=null,nl=new Map,rl=new Map,Xn=[],ov="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xu(e,t){switch(e){case"focusin":case"focusout":nr=null;break;case"dragenter":case"dragleave":rr=null;break;case"mouseover":case"mouseout":sr=null;break;case"pointerover":case"pointerout":nl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rl.delete(t.pointerId)}}function Ps(e,t,n,r,s,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[s]},t!==null&&(t=kl(t),t!==null&&Cc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function cv(e,t,n,r,s){switch(t){case"focusin":return nr=Ps(nr,e,t,n,r,s),!0;case"dragenter":return rr=Ps(rr,e,t,n,r,s),!0;case"mouseover":return sr=Ps(sr,e,t,n,r,s),!0;case"pointerover":var l=s.pointerId;return nl.set(l,Ps(nl.get(l)||null,e,t,n,r,s)),!0;case"gotpointercapture":return l=s.pointerId,rl.set(l,Ps(rl.get(l)||null,e,t,n,r,s)),!0}return!1}function Lp(e){var t=Nr(e.target);if(t!==null){var n=Mr(t);if(n!==null){if(t=n.tag,t===13){if(t=gp(n),t!==null){e.blockedOn=t,bp(e.priority,function(){Cp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ri(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=xo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);po=r,n.target.dispatchEvent(r),po=null}else return t=kl(n),t!==null&&Cc(t),e.blockedOn=n,!1;t.shift()}return!0}function Ju(e,t,n){ri(e)&&n.delete(t)}function uv(){yo=!1,nr!==null&&ri(nr)&&(nr=null),rr!==null&&ri(rr)&&(rr=null),sr!==null&&ri(sr)&&(sr=null),nl.forEach(Ju),rl.forEach(Ju)}function zs(e,t){e.blockedOn===t&&(e.blockedOn=null,yo||(yo=!0,Kt.unstable_scheduleCallback(Kt.unstable_NormalPriority,uv)))}function sl(e){function t(s){return zs(s,e)}if(0<Ol.length){zs(Ol[0],e);for(var n=1;n<Ol.length;n++){var r=Ol[n];r.blockedOn===e&&(r.blockedOn=null)}}for(nr!==null&&zs(nr,e),rr!==null&&zs(rr,e),sr!==null&&zs(sr,e),nl.forEach(t),rl.forEach(t),n=0;n<Xn.length;n++)r=Xn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Xn.length&&(n=Xn[0],n.blockedOn===null);)Lp(n),n.blockedOn===null&&Xn.shift()}var os=Un.ReactCurrentBatchConfig,xi=!0;function dv(e,t,n,r){var s=qe,l=os.transition;os.transition=null;try{qe=1,Ec(e,t,n,r)}finally{qe=s,os.transition=l}}function fv(e,t,n,r){var s=qe,l=os.transition;os.transition=null;try{qe=4,Ec(e,t,n,r)}finally{qe=s,os.transition=l}}function Ec(e,t,n,r){if(xi){var s=xo(e,t,n,r);if(s===null)Ta(e,t,r,wi,n),Xu(e,r);else if(cv(s,e,t,n,r))r.stopPropagation();else if(Xu(e,r),t&4&&-1<ov.indexOf(e)){for(;s!==null;){var l=kl(s);if(l!==null&&Np(l),l=xo(e,t,n,r),l===null&&Ta(e,t,r,wi,n),l===s)break;s=l}s!==null&&r.stopPropagation()}else Ta(e,t,r,null,n)}}var wi=null;function xo(e,t,n,r){if(wi=null,e=jc(r),e=Nr(e),e!==null)if(t=Mr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=gp(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return wi=e,null}function Pp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zg()){case kc:return 1;case wp:return 4;case vi:case ev:return 16;case Sp:return 536870912;default:return 16}default:return 16}}var Zn=null,bc=null,si=null;function zp(){if(si)return si;var e,t=bc,n=t.length,r,s="value"in Zn?Zn.value:Zn.textContent,l=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[l-r];r++);return si=s.slice(e,1<r?1-r:void 0)}function li(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Dl(){return!0}function Zu(){return!1}function Yt(e){function t(n,r,s,l,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=l,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(l):l[o]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Dl:Zu,this.isPropagationStopped=Zu,this}return ct(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Dl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Dl)},persist:function(){},isPersistent:Dl}),t}var js={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lc=Yt(js),jl=ct({},js,{view:0,detail:0}),pv=Yt(jl),Ea,ba,_s,qi=ct({},jl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==_s&&(_s&&e.type==="mousemove"?(Ea=e.screenX-_s.screenX,ba=e.screenY-_s.screenY):ba=Ea=0,_s=e),Ea)},movementY:function(e){return"movementY"in e?e.movementY:ba}}),ed=Yt(qi),hv=ct({},qi,{dataTransfer:0}),mv=Yt(hv),gv=ct({},jl,{relatedTarget:0}),La=Yt(gv),vv=ct({},js,{animationName:0,elapsedTime:0,pseudoElement:0}),yv=Yt(vv),xv=ct({},js,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wv=Yt(xv),Sv=ct({},js,{data:0}),td=Yt(Sv),jv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Nv[e])?!!t[e]:!1}function Pc(){return Cv}var Ev=ct({},jl,{key:function(e){if(e.key){var t=jv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=li(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?kv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pc,charCode:function(e){return e.type==="keypress"?li(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?li(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),bv=Yt(Ev),Lv=ct({},qi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nd=Yt(Lv),Pv=ct({},jl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pc}),zv=Yt(Pv),_v=ct({},js,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rv=Yt(_v),Iv=ct({},qi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Av=Yt(Iv),Tv=[9,13,27,32],zc=Fn&&"CompositionEvent"in window,Ws=null;Fn&&"documentMode"in document&&(Ws=document.documentMode);var Mv=Fn&&"TextEvent"in window&&!Ws,_p=Fn&&(!zc||Ws&&8<Ws&&11>=Ws),rd=" ",sd=!1;function Rp(e,t){switch(e){case"keyup":return Tv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ip(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Yr=!1;function $v(e,t){switch(e){case"compositionend":return Ip(t);case"keypress":return t.which!==32?null:(sd=!0,rd);case"textInput":return e=t.data,e===rd&&sd?null:e;default:return null}}function Fv(e,t){if(Yr)return e==="compositionend"||!zc&&Rp(e,t)?(e=zp(),si=bc=Zn=null,Yr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _p&&t.locale!=="ko"?null:t.data;default:return null}}var Ov={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ld(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ov[e.type]:t==="textarea"}function Ap(e,t,n,r){dp(r),t=Si(t,"onChange"),0<t.length&&(n=new Lc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hs=null,ll=null;function Dv(e){Hp(e,0)}function Xi(e){var t=Jr(e);if(sp(t))return e}function Bv(e,t){if(e==="change")return t}var Tp=!1;if(Fn){var Pa;if(Fn){var za="oninput"in document;if(!za){var id=document.createElement("div");id.setAttribute("oninput","return;"),za=typeof id.oninput=="function"}Pa=za}else Pa=!1;Tp=Pa&&(!document.documentMode||9<document.documentMode)}function ad(){Hs&&(Hs.detachEvent("onpropertychange",Mp),ll=Hs=null)}function Mp(e){if(e.propertyName==="value"&&Xi(ll)){var t=[];Ap(t,ll,e,jc(e)),mp(Dv,t)}}function Uv(e,t,n){e==="focusin"?(ad(),Hs=t,ll=n,Hs.attachEvent("onpropertychange",Mp)):e==="focusout"&&ad()}function Vv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Xi(ll)}function Wv(e,t){if(e==="click")return Xi(t)}function Hv(e,t){if(e==="input"||e==="change")return Xi(t)}function Gv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mn=typeof Object.is=="function"?Object.is:Gv;function il(e,t){if(mn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!eo.call(t,s)||!mn(e[s],t[s]))return!1}return!0}function od(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cd(e,t){var n=od(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=od(n)}}function $p(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$p(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Fp(){for(var e=window,t=hi();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=hi(e.document)}return t}function _c(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Kv(e){var t=Fp(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&$p(n.ownerDocument.documentElement,n)){if(r!==null&&_c(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,l=Math.min(r.start,s);r=r.end===void 0?l:Math.min(r.end,s),!e.extend&&l>r&&(s=r,r=l,l=s),s=cd(n,l);var a=cd(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Qv=Fn&&"documentMode"in document&&11>=document.documentMode,qr=null,wo=null,Gs=null,So=!1;function ud(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;So||qr==null||qr!==hi(r)||(r=qr,"selectionStart"in r&&_c(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Gs&&il(Gs,r)||(Gs=r,r=Si(wo,"onSelect"),0<r.length&&(t=new Lc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=qr)))}function Bl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Xr={animationend:Bl("Animation","AnimationEnd"),animationiteration:Bl("Animation","AnimationIteration"),animationstart:Bl("Animation","AnimationStart"),transitionend:Bl("Transition","TransitionEnd")},_a={},Op={};Fn&&(Op=document.createElement("div").style,"AnimationEvent"in window||(delete Xr.animationend.animation,delete Xr.animationiteration.animation,delete Xr.animationstart.animation),"TransitionEvent"in window||delete Xr.transitionend.transition);function Ji(e){if(_a[e])return _a[e];if(!Xr[e])return e;var t=Xr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Op)return _a[e]=t[n];return e}var Dp=Ji("animationend"),Bp=Ji("animationiteration"),Up=Ji("animationstart"),Vp=Ji("transitionend"),Wp=new Map,dd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function gr(e,t){Wp.set(e,t),Tr(t,[e])}for(var Ra=0;Ra<dd.length;Ra++){var Ia=dd[Ra],Yv=Ia.toLowerCase(),qv=Ia[0].toUpperCase()+Ia.slice(1);gr(Yv,"on"+qv)}gr(Dp,"onAnimationEnd");gr(Bp,"onAnimationIteration");gr(Up,"onAnimationStart");gr("dblclick","onDoubleClick");gr("focusin","onFocus");gr("focusout","onBlur");gr(Vp,"onTransitionEnd");fs("onMouseEnter",["mouseout","mouseover"]);fs("onMouseLeave",["mouseout","mouseover"]);fs("onPointerEnter",["pointerout","pointerover"]);fs("onPointerLeave",["pointerout","pointerover"]);Tr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Os="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Os));function fd(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Yg(r,t,void 0,e),e.currentTarget=null}function Hp(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],u=o.instance,d=o.currentTarget;if(o=o.listener,u!==l&&s.isPropagationStopped())break e;fd(s,o,d),l=u}else for(a=0;a<r.length;a++){if(o=r[a],u=o.instance,d=o.currentTarget,o=o.listener,u!==l&&s.isPropagationStopped())break e;fd(s,o,d),l=u}}}if(gi)throw e=go,gi=!1,go=null,e}function Ze(e,t){var n=t[Eo];n===void 0&&(n=t[Eo]=new Set);var r=e+"__bubble";n.has(r)||(Gp(t,e,2,!1),n.add(r))}function Aa(e,t,n){var r=0;t&&(r|=4),Gp(n,e,r,t)}var Ul="_reactListening"+Math.random().toString(36).slice(2);function al(e){if(!e[Ul]){e[Ul]=!0,Zf.forEach(function(n){n!=="selectionchange"&&(Xv.has(n)||Aa(n,!1,e),Aa(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ul]||(t[Ul]=!0,Aa("selectionchange",!1,t))}}function Gp(e,t,n,r){switch(Pp(t)){case 1:var s=dv;break;case 4:s=fv;break;default:s=Ec}n=s.bind(null,t,n,e),s=void 0,!mo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Ta(e,t,n,r,s){var l=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;o!==null;){if(a=Nr(o),a===null)return;if(u=a.tag,u===5||u===6){r=l=a;continue e}o=o.parentNode}}r=r.return}mp(function(){var d=l,m=jc(n),v=[];e:{var g=Wp.get(e);if(g!==void 0){var y=Lc,w=e;switch(e){case"keypress":if(li(n)===0)break e;case"keydown":case"keyup":y=bv;break;case"focusin":w="focus",y=La;break;case"focusout":w="blur",y=La;break;case"beforeblur":case"afterblur":y=La;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=ed;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=mv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=zv;break;case Dp:case Bp:case Up:y=yv;break;case Vp:y=Rv;break;case"scroll":y=pv;break;case"wheel":y=Av;break;case"copy":case"cut":case"paste":y=wv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=nd}var j=(t&4)!==0,S=!j&&e==="scroll",h=j?g!==null?g+"Capture":null:g;j=[];for(var f=d,p;f!==null;){p=f;var x=p.stateNode;if(p.tag===5&&x!==null&&(p=x,h!==null&&(x=tl(f,h),x!=null&&j.push(ol(f,x,p)))),S)break;f=f.return}0<j.length&&(g=new y(g,w,null,n,m),v.push({event:g,listeners:j}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",y=e==="mouseout"||e==="pointerout",g&&n!==po&&(w=n.relatedTarget||n.fromElement)&&(Nr(w)||w[On]))break e;if((y||g)&&(g=m.window===m?m:(g=m.ownerDocument)?g.defaultView||g.parentWindow:window,y?(w=n.relatedTarget||n.toElement,y=d,w=w?Nr(w):null,w!==null&&(S=Mr(w),w!==S||w.tag!==5&&w.tag!==6)&&(w=null)):(y=null,w=d),y!==w)){if(j=ed,x="onMouseLeave",h="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(j=nd,x="onPointerLeave",h="onPointerEnter",f="pointer"),S=y==null?g:Jr(y),p=w==null?g:Jr(w),g=new j(x,f+"leave",y,n,m),g.target=S,g.relatedTarget=p,x=null,Nr(m)===d&&(j=new j(h,f+"enter",w,n,m),j.target=p,j.relatedTarget=S,x=j),S=x,y&&w)t:{for(j=y,h=w,f=0,p=j;p;p=Vr(p))f++;for(p=0,x=h;x;x=Vr(x))p++;for(;0<f-p;)j=Vr(j),f--;for(;0<p-f;)h=Vr(h),p--;for(;f--;){if(j===h||h!==null&&j===h.alternate)break t;j=Vr(j),h=Vr(h)}j=null}else j=null;y!==null&&pd(v,g,y,j,!1),w!==null&&S!==null&&pd(v,S,w,j,!0)}}e:{if(g=d?Jr(d):window,y=g.nodeName&&g.nodeName.toLowerCase(),y==="select"||y==="input"&&g.type==="file")var N=Bv;else if(ld(g))if(Tp)N=Hv;else{N=Vv;var k=Uv}else(y=g.nodeName)&&y.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(N=Wv);if(N&&(N=N(e,d))){Ap(v,N,n,m);break e}k&&k(e,g,d),e==="focusout"&&(k=g._wrapperState)&&k.controlled&&g.type==="number"&&ao(g,"number",g.value)}switch(k=d?Jr(d):window,e){case"focusin":(ld(k)||k.contentEditable==="true")&&(qr=k,wo=d,Gs=null);break;case"focusout":Gs=wo=qr=null;break;case"mousedown":So=!0;break;case"contextmenu":case"mouseup":case"dragend":So=!1,ud(v,n,m);break;case"selectionchange":if(Qv)break;case"keydown":case"keyup":ud(v,n,m)}var L;if(zc)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Yr?Rp(e,n)&&(R="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(_p&&n.locale!=="ko"&&(Yr||R!=="onCompositionStart"?R==="onCompositionEnd"&&Yr&&(L=zp()):(Zn=m,bc="value"in Zn?Zn.value:Zn.textContent,Yr=!0)),k=Si(d,R),0<k.length&&(R=new td(R,e,null,n,m),v.push({event:R,listeners:k}),L?R.data=L:(L=Ip(n),L!==null&&(R.data=L)))),(L=Mv?$v(e,n):Fv(e,n))&&(d=Si(d,"onBeforeInput"),0<d.length&&(m=new td("onBeforeInput","beforeinput",null,n,m),v.push({event:m,listeners:d}),m.data=L))}Hp(v,t)})}function ol(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Si(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,l=s.stateNode;s.tag===5&&l!==null&&(s=l,l=tl(e,n),l!=null&&r.unshift(ol(e,l,s)),l=tl(e,t),l!=null&&r.push(ol(e,l,s))),e=e.return}return r}function Vr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pd(e,t,n,r,s){for(var l=t._reactName,a=[];n!==null&&n!==r;){var o=n,u=o.alternate,d=o.stateNode;if(u!==null&&u===r)break;o.tag===5&&d!==null&&(o=d,s?(u=tl(n,l),u!=null&&a.unshift(ol(n,u,o))):s||(u=tl(n,l),u!=null&&a.push(ol(n,u,o)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var Jv=/\r\n?/g,Zv=/\u0000|\uFFFD/g;function hd(e){return(typeof e=="string"?e:""+e).replace(Jv,`
`).replace(Zv,"")}function Vl(e,t,n){if(t=hd(t),hd(e)!==t&&n)throw Error(J(425))}function ji(){}var jo=null,ko=null;function No(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Co=typeof setTimeout=="function"?setTimeout:void 0,ey=typeof clearTimeout=="function"?clearTimeout:void 0,md=typeof Promise=="function"?Promise:void 0,ty=typeof queueMicrotask=="function"?queueMicrotask:typeof md<"u"?function(e){return md.resolve(null).then(e).catch(ny)}:Co;function ny(e){setTimeout(function(){throw e})}function Ma(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),sl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);sl(t)}function lr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function gd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ks=Math.random().toString(36).slice(2),wn="__reactFiber$"+ks,cl="__reactProps$"+ks,On="__reactContainer$"+ks,Eo="__reactEvents$"+ks,ry="__reactListeners$"+ks,sy="__reactHandles$"+ks;function Nr(e){var t=e[wn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[On]||n[wn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=gd(e);e!==null;){if(n=e[wn])return n;e=gd(e)}return t}e=n,n=e.parentNode}return null}function kl(e){return e=e[wn]||e[On],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function Zi(e){return e[cl]||null}var bo=[],Zr=-1;function vr(e){return{current:e}}function et(e){0>Zr||(e.current=bo[Zr],bo[Zr]=null,Zr--)}function Je(e,t){Zr++,bo[Zr]=e.current,e.current=t}var fr={},Lt=vr(fr),Ot=vr(!1),zr=fr;function ps(e,t){var n=e.type.contextTypes;if(!n)return fr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},l;for(l in n)s[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Dt(e){return e=e.childContextTypes,e!=null}function ki(){et(Ot),et(Lt)}function vd(e,t,n){if(Lt.current!==fr)throw Error(J(168));Je(Lt,t),Je(Ot,n)}function Kp(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(J(108,Ug(e)||"Unknown",s));return ct({},n,r)}function Ni(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fr,zr=Lt.current,Je(Lt,e),Je(Ot,Ot.current),!0}function yd(e,t,n){var r=e.stateNode;if(!r)throw Error(J(169));n?(e=Kp(e,t,zr),r.__reactInternalMemoizedMergedChildContext=e,et(Ot),et(Lt),Je(Lt,e)):et(Ot),Je(Ot,n)}var zn=null,ea=!1,$a=!1;function Qp(e){zn===null?zn=[e]:zn.push(e)}function ly(e){ea=!0,Qp(e)}function yr(){if(!$a&&zn!==null){$a=!0;var e=0,t=qe;try{var n=zn;for(qe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}zn=null,ea=!1}catch(s){throw zn!==null&&(zn=zn.slice(e+1)),xp(kc,yr),s}finally{qe=t,$a=!1}}return null}var es=[],ts=0,Ci=null,Ei=0,en=[],tn=0,_r=null,Rn=1,In="";function Sr(e,t){es[ts++]=Ei,es[ts++]=Ci,Ci=e,Ei=t}function Yp(e,t,n){en[tn++]=Rn,en[tn++]=In,en[tn++]=_r,_r=e;var r=Rn;e=In;var s=32-pn(r)-1;r&=~(1<<s),n+=1;var l=32-pn(t)+s;if(30<l){var a=s-s%5;l=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Rn=1<<32-pn(t)+s|n<<s|r,In=l+e}else Rn=1<<l|n<<s|r,In=e}function Rc(e){e.return!==null&&(Sr(e,1),Yp(e,1,0))}function Ic(e){for(;e===Ci;)Ci=es[--ts],es[ts]=null,Ei=es[--ts],es[ts]=null;for(;e===_r;)_r=en[--tn],en[tn]=null,In=en[--tn],en[tn]=null,Rn=en[--tn],en[tn]=null}var Gt=null,Ht=null,nt=!1,fn=null;function qp(e,t){var n=nn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function xd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Gt=e,Ht=lr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Gt=e,Ht=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=_r!==null?{id:Rn,overflow:In}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=nn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Gt=e,Ht=null,!0):!1;default:return!1}}function Lo(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Po(e){if(nt){var t=Ht;if(t){var n=t;if(!xd(e,t)){if(Lo(e))throw Error(J(418));t=lr(n.nextSibling);var r=Gt;t&&xd(e,t)?qp(r,n):(e.flags=e.flags&-4097|2,nt=!1,Gt=e)}}else{if(Lo(e))throw Error(J(418));e.flags=e.flags&-4097|2,nt=!1,Gt=e}}}function wd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Gt=e}function Wl(e){if(e!==Gt)return!1;if(!nt)return wd(e),nt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!No(e.type,e.memoizedProps)),t&&(t=Ht)){if(Lo(e))throw Xp(),Error(J(418));for(;t;)qp(e,t),t=lr(t.nextSibling)}if(wd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ht=lr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ht=null}}else Ht=Gt?lr(e.stateNode.nextSibling):null;return!0}function Xp(){for(var e=Ht;e;)e=lr(e.nextSibling)}function hs(){Ht=Gt=null,nt=!1}function Ac(e){fn===null?fn=[e]:fn.push(e)}var iy=Un.ReactCurrentBatchConfig;function Rs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,e));var s=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(a){var o=s.refs;a===null?delete o[l]:o[l]=a},t._stringRef=l,t)}if(typeof e!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,e))}return e}function Hl(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sd(e){var t=e._init;return t(e._payload)}function Jp(e){function t(h,f){if(e){var p=h.deletions;p===null?(h.deletions=[f],h.flags|=16):p.push(f)}}function n(h,f){if(!e)return null;for(;f!==null;)t(h,f),f=f.sibling;return null}function r(h,f){for(h=new Map;f!==null;)f.key!==null?h.set(f.key,f):h.set(f.index,f),f=f.sibling;return h}function s(h,f){return h=cr(h,f),h.index=0,h.sibling=null,h}function l(h,f,p){return h.index=p,e?(p=h.alternate,p!==null?(p=p.index,p<f?(h.flags|=2,f):p):(h.flags|=2,f)):(h.flags|=1048576,f)}function a(h){return e&&h.alternate===null&&(h.flags|=2),h}function o(h,f,p,x){return f===null||f.tag!==6?(f=Wa(p,h.mode,x),f.return=h,f):(f=s(f,p),f.return=h,f)}function u(h,f,p,x){var N=p.type;return N===Qr?m(h,f,p.props.children,x,p.key):f!==null&&(f.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Yn&&Sd(N)===f.type)?(x=s(f,p.props),x.ref=Rs(h,f,p),x.return=h,x):(x=fi(p.type,p.key,p.props,null,h.mode,x),x.ref=Rs(h,f,p),x.return=h,x)}function d(h,f,p,x){return f===null||f.tag!==4||f.stateNode.containerInfo!==p.containerInfo||f.stateNode.implementation!==p.implementation?(f=Ha(p,h.mode,x),f.return=h,f):(f=s(f,p.children||[]),f.return=h,f)}function m(h,f,p,x,N){return f===null||f.tag!==7?(f=Lr(p,h.mode,x,N),f.return=h,f):(f=s(f,p),f.return=h,f)}function v(h,f,p){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Wa(""+f,h.mode,p),f.return=h,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Al:return p=fi(f.type,f.key,f.props,null,h.mode,p),p.ref=Rs(h,null,f),p.return=h,p;case Kr:return f=Ha(f,h.mode,p),f.return=h,f;case Yn:var x=f._init;return v(h,x(f._payload),p)}if($s(f)||bs(f))return f=Lr(f,h.mode,p,null),f.return=h,f;Hl(h,f)}return null}function g(h,f,p,x){var N=f!==null?f.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return N!==null?null:o(h,f,""+p,x);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Al:return p.key===N?u(h,f,p,x):null;case Kr:return p.key===N?d(h,f,p,x):null;case Yn:return N=p._init,g(h,f,N(p._payload),x)}if($s(p)||bs(p))return N!==null?null:m(h,f,p,x,null);Hl(h,p)}return null}function y(h,f,p,x,N){if(typeof x=="string"&&x!==""||typeof x=="number")return h=h.get(p)||null,o(f,h,""+x,N);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Al:return h=h.get(x.key===null?p:x.key)||null,u(f,h,x,N);case Kr:return h=h.get(x.key===null?p:x.key)||null,d(f,h,x,N);case Yn:var k=x._init;return y(h,f,p,k(x._payload),N)}if($s(x)||bs(x))return h=h.get(p)||null,m(f,h,x,N,null);Hl(f,x)}return null}function w(h,f,p,x){for(var N=null,k=null,L=f,R=f=0,T=null;L!==null&&R<p.length;R++){L.index>R?(T=L,L=null):T=L.sibling;var z=g(h,L,p[R],x);if(z===null){L===null&&(L=T);break}e&&L&&z.alternate===null&&t(h,L),f=l(z,f,R),k===null?N=z:k.sibling=z,k=z,L=T}if(R===p.length)return n(h,L),nt&&Sr(h,R),N;if(L===null){for(;R<p.length;R++)L=v(h,p[R],x),L!==null&&(f=l(L,f,R),k===null?N=L:k.sibling=L,k=L);return nt&&Sr(h,R),N}for(L=r(h,L);R<p.length;R++)T=y(L,h,R,p[R],x),T!==null&&(e&&T.alternate!==null&&L.delete(T.key===null?R:T.key),f=l(T,f,R),k===null?N=T:k.sibling=T,k=T);return e&&L.forEach(function(I){return t(h,I)}),nt&&Sr(h,R),N}function j(h,f,p,x){var N=bs(p);if(typeof N!="function")throw Error(J(150));if(p=N.call(p),p==null)throw Error(J(151));for(var k=N=null,L=f,R=f=0,T=null,z=p.next();L!==null&&!z.done;R++,z=p.next()){L.index>R?(T=L,L=null):T=L.sibling;var I=g(h,L,z.value,x);if(I===null){L===null&&(L=T);break}e&&L&&I.alternate===null&&t(h,L),f=l(I,f,R),k===null?N=I:k.sibling=I,k=I,L=T}if(z.done)return n(h,L),nt&&Sr(h,R),N;if(L===null){for(;!z.done;R++,z=p.next())z=v(h,z.value,x),z!==null&&(f=l(z,f,R),k===null?N=z:k.sibling=z,k=z);return nt&&Sr(h,R),N}for(L=r(h,L);!z.done;R++,z=p.next())z=y(L,h,R,z.value,x),z!==null&&(e&&z.alternate!==null&&L.delete(z.key===null?R:z.key),f=l(z,f,R),k===null?N=z:k.sibling=z,k=z);return e&&L.forEach(function(X){return t(h,X)}),nt&&Sr(h,R),N}function S(h,f,p,x){if(typeof p=="object"&&p!==null&&p.type===Qr&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case Al:e:{for(var N=p.key,k=f;k!==null;){if(k.key===N){if(N=p.type,N===Qr){if(k.tag===7){n(h,k.sibling),f=s(k,p.props.children),f.return=h,h=f;break e}}else if(k.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Yn&&Sd(N)===k.type){n(h,k.sibling),f=s(k,p.props),f.ref=Rs(h,k,p),f.return=h,h=f;break e}n(h,k);break}else t(h,k);k=k.sibling}p.type===Qr?(f=Lr(p.props.children,h.mode,x,p.key),f.return=h,h=f):(x=fi(p.type,p.key,p.props,null,h.mode,x),x.ref=Rs(h,f,p),x.return=h,h=x)}return a(h);case Kr:e:{for(k=p.key;f!==null;){if(f.key===k)if(f.tag===4&&f.stateNode.containerInfo===p.containerInfo&&f.stateNode.implementation===p.implementation){n(h,f.sibling),f=s(f,p.children||[]),f.return=h,h=f;break e}else{n(h,f);break}else t(h,f);f=f.sibling}f=Ha(p,h.mode,x),f.return=h,h=f}return a(h);case Yn:return k=p._init,S(h,f,k(p._payload),x)}if($s(p))return w(h,f,p,x);if(bs(p))return j(h,f,p,x);Hl(h,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,f!==null&&f.tag===6?(n(h,f.sibling),f=s(f,p),f.return=h,h=f):(n(h,f),f=Wa(p,h.mode,x),f.return=h,h=f),a(h)):n(h,f)}return S}var ms=Jp(!0),Zp=Jp(!1),bi=vr(null),Li=null,ns=null,Tc=null;function Mc(){Tc=ns=Li=null}function $c(e){var t=bi.current;et(bi),e._currentValue=t}function zo(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function cs(e,t){Li=e,Tc=ns=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ft=!0),e.firstContext=null)}function sn(e){var t=e._currentValue;if(Tc!==e)if(e={context:e,memoizedValue:t,next:null},ns===null){if(Li===null)throw Error(J(308));ns=e,Li.dependencies={lanes:0,firstContext:e}}else ns=ns.next=e;return t}var Cr=null;function Fc(e){Cr===null?Cr=[e]:Cr.push(e)}function eh(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Fc(t)):(n.next=s.next,s.next=n),t.interleaved=n,Dn(e,r)}function Dn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var qn=!1;function Oc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function th(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ir(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Dn(e,n)}return s=r.interleaved,s===null?(t.next=t,Fc(r)):(t.next=s.next,s.next=t),r.interleaved=t,Dn(e,n)}function ii(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nc(e,n)}}function jd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?s=l=a:l=l.next=a,n=n.next}while(n!==null);l===null?s=l=t:l=l.next=t}else s=l=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Pi(e,t,n,r){var s=e.updateQueue;qn=!1;var l=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var u=o,d=u.next;u.next=null,a===null?l=d:a.next=d,a=u;var m=e.alternate;m!==null&&(m=m.updateQueue,o=m.lastBaseUpdate,o!==a&&(o===null?m.firstBaseUpdate=d:o.next=d,m.lastBaseUpdate=u))}if(l!==null){var v=s.baseState;a=0,m=d=u=null,o=l;do{var g=o.lane,y=o.eventTime;if((r&g)===g){m!==null&&(m=m.next={eventTime:y,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var w=e,j=o;switch(g=t,y=n,j.tag){case 1:if(w=j.payload,typeof w=="function"){v=w.call(y,v,g);break e}v=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=j.payload,g=typeof w=="function"?w.call(y,v,g):w,g==null)break e;v=ct({},v,g);break e;case 2:qn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,g=s.effects,g===null?s.effects=[o]:g.push(o))}else y={eventTime:y,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},m===null?(d=m=y,u=v):m=m.next=y,a|=g;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;g=o,o=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(m===null&&(u=v),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else l===null&&(s.shared.lanes=0);Ir|=a,e.lanes=a,e.memoizedState=v}}function kd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(J(191,s));s.call(r)}}}var Nl={},En=vr(Nl),ul=vr(Nl),dl=vr(Nl);function Er(e){if(e===Nl)throw Error(J(174));return e}function Dc(e,t){switch(Je(dl,t),Je(ul,e),Je(En,Nl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:co(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=co(t,e)}et(En),Je(En,t)}function gs(){et(En),et(ul),et(dl)}function nh(e){Er(dl.current);var t=Er(En.current),n=co(t,e.type);t!==n&&(Je(ul,e),Je(En,n))}function Bc(e){ul.current===e&&(et(En),et(ul))}var it=vr(0);function zi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Fa=[];function Uc(){for(var e=0;e<Fa.length;e++)Fa[e]._workInProgressVersionPrimary=null;Fa.length=0}var ai=Un.ReactCurrentDispatcher,Oa=Un.ReactCurrentBatchConfig,Rr=0,at=null,mt=null,vt=null,_i=!1,Ks=!1,fl=0,ay=0;function Ct(){throw Error(J(321))}function Vc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!mn(e[n],t[n]))return!1;return!0}function Wc(e,t,n,r,s,l){if(Rr=l,at=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ai.current=e===null||e.memoizedState===null?dy:fy,e=n(r,s),Ks){l=0;do{if(Ks=!1,fl=0,25<=l)throw Error(J(301));l+=1,vt=mt=null,t.updateQueue=null,ai.current=py,e=n(r,s)}while(Ks)}if(ai.current=Ri,t=mt!==null&&mt.next!==null,Rr=0,vt=mt=at=null,_i=!1,t)throw Error(J(300));return e}function Hc(){var e=fl!==0;return fl=0,e}function yn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?at.memoizedState=vt=e:vt=vt.next=e,vt}function ln(){if(mt===null){var e=at.alternate;e=e!==null?e.memoizedState:null}else e=mt.next;var t=vt===null?at.memoizedState:vt.next;if(t!==null)vt=t,mt=e;else{if(e===null)throw Error(J(310));mt=e,e={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},vt===null?at.memoizedState=vt=e:vt=vt.next=e}return vt}function pl(e,t){return typeof t=="function"?t(e):t}function Da(e){var t=ln(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=mt,s=r.baseQueue,l=n.pending;if(l!==null){if(s!==null){var a=s.next;s.next=l.next,l.next=a}r.baseQueue=s=l,n.pending=null}if(s!==null){l=s.next,r=r.baseState;var o=a=null,u=null,d=l;do{var m=d.lane;if((Rr&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var v={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(o=u=v,a=r):u=u.next=v,at.lanes|=m,Ir|=m}d=d.next}while(d!==null&&d!==l);u===null?a=r:u.next=o,mn(r,t.memoizedState)||(Ft=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do l=s.lane,at.lanes|=l,Ir|=l,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ba(e){var t=ln(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,l=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do l=e(l,a.action),a=a.next;while(a!==s);mn(l,t.memoizedState)||(Ft=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function rh(){}function sh(e,t){var n=at,r=ln(),s=t(),l=!mn(r.memoizedState,s);if(l&&(r.memoizedState=s,Ft=!0),r=r.queue,Gc(ah.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||vt!==null&&vt.memoizedState.tag&1){if(n.flags|=2048,hl(9,ih.bind(null,n,r,s,t),void 0,null),yt===null)throw Error(J(349));Rr&30||lh(n,t,s)}return s}function lh(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ih(e,t,n,r){t.value=n,t.getSnapshot=r,oh(t)&&ch(e)}function ah(e,t,n){return n(function(){oh(t)&&ch(e)})}function oh(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!mn(e,n)}catch{return!0}}function ch(e){var t=Dn(e,1);t!==null&&hn(t,e,1,-1)}function Nd(e){var t=yn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pl,lastRenderedState:e},t.queue=e,e=e.dispatch=uy.bind(null,at,e),[t.memoizedState,e]}function hl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=at.updateQueue,t===null?(t={lastEffect:null,stores:null},at.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function uh(){return ln().memoizedState}function oi(e,t,n,r){var s=yn();at.flags|=e,s.memoizedState=hl(1|t,n,void 0,r===void 0?null:r)}function ta(e,t,n,r){var s=ln();r=r===void 0?null:r;var l=void 0;if(mt!==null){var a=mt.memoizedState;if(l=a.destroy,r!==null&&Vc(r,a.deps)){s.memoizedState=hl(t,n,l,r);return}}at.flags|=e,s.memoizedState=hl(1|t,n,l,r)}function Cd(e,t){return oi(8390656,8,e,t)}function Gc(e,t){return ta(2048,8,e,t)}function dh(e,t){return ta(4,2,e,t)}function fh(e,t){return ta(4,4,e,t)}function ph(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hh(e,t,n){return n=n!=null?n.concat([e]):null,ta(4,4,ph.bind(null,t,e),n)}function Kc(){}function mh(e,t){var n=ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Vc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function gh(e,t){var n=ln();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Vc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function vh(e,t,n){return Rr&21?(mn(n,t)||(n=jp(),at.lanes|=n,Ir|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ft=!0),e.memoizedState=n)}function oy(e,t){var n=qe;qe=n!==0&&4>n?n:4,e(!0);var r=Oa.transition;Oa.transition={};try{e(!1),t()}finally{qe=n,Oa.transition=r}}function yh(){return ln().memoizedState}function cy(e,t,n){var r=or(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xh(e))wh(t,n);else if(n=eh(e,t,n,r),n!==null){var s=_t();hn(n,e,r,s),Sh(n,t,r)}}function uy(e,t,n){var r=or(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xh(e))wh(t,s);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var a=t.lastRenderedState,o=l(a,n);if(s.hasEagerState=!0,s.eagerState=o,mn(o,a)){var u=t.interleaved;u===null?(s.next=s,Fc(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=eh(e,t,s,r),n!==null&&(s=_t(),hn(n,e,r,s),Sh(n,t,r))}}function xh(e){var t=e.alternate;return e===at||t!==null&&t===at}function wh(e,t){Ks=_i=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Sh(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nc(e,n)}}var Ri={readContext:sn,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},dy={readContext:sn,useCallback:function(e,t){return yn().memoizedState=[e,t===void 0?null:t],e},useContext:sn,useEffect:Cd,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,oi(4194308,4,ph.bind(null,t,e),n)},useLayoutEffect:function(e,t){return oi(4194308,4,e,t)},useInsertionEffect:function(e,t){return oi(4,2,e,t)},useMemo:function(e,t){var n=yn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=cy.bind(null,at,e),[r.memoizedState,e]},useRef:function(e){var t=yn();return e={current:e},t.memoizedState=e},useState:Nd,useDebugValue:Kc,useDeferredValue:function(e){return yn().memoizedState=e},useTransition:function(){var e=Nd(!1),t=e[0];return e=oy.bind(null,e[1]),yn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=at,s=yn();if(nt){if(n===void 0)throw Error(J(407));n=n()}else{if(n=t(),yt===null)throw Error(J(349));Rr&30||lh(r,t,n)}s.memoizedState=n;var l={value:n,getSnapshot:t};return s.queue=l,Cd(ah.bind(null,r,l,e),[e]),r.flags|=2048,hl(9,ih.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=yn(),t=yt.identifierPrefix;if(nt){var n=In,r=Rn;n=(r&~(1<<32-pn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=fl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ay++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},fy={readContext:sn,useCallback:mh,useContext:sn,useEffect:Gc,useImperativeHandle:hh,useInsertionEffect:dh,useLayoutEffect:fh,useMemo:gh,useReducer:Da,useRef:uh,useState:function(){return Da(pl)},useDebugValue:Kc,useDeferredValue:function(e){var t=ln();return vh(t,mt.memoizedState,e)},useTransition:function(){var e=Da(pl)[0],t=ln().memoizedState;return[e,t]},useMutableSource:rh,useSyncExternalStore:sh,useId:yh,unstable_isNewReconciler:!1},py={readContext:sn,useCallback:mh,useContext:sn,useEffect:Gc,useImperativeHandle:hh,useInsertionEffect:dh,useLayoutEffect:fh,useMemo:gh,useReducer:Ba,useRef:uh,useState:function(){return Ba(pl)},useDebugValue:Kc,useDeferredValue:function(e){var t=ln();return mt===null?t.memoizedState=e:vh(t,mt.memoizedState,e)},useTransition:function(){var e=Ba(pl)[0],t=ln().memoizedState;return[e,t]},useMutableSource:rh,useSyncExternalStore:sh,useId:yh,unstable_isNewReconciler:!1};function un(e,t){if(e&&e.defaultProps){t=ct({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function _o(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ct({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var na={isMounted:function(e){return(e=e._reactInternals)?Mr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=_t(),s=or(e),l=Mn(r,s);l.payload=t,n!=null&&(l.callback=n),t=ir(e,l,s),t!==null&&(hn(t,e,s,r),ii(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=_t(),s=or(e),l=Mn(r,s);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=ir(e,l,s),t!==null&&(hn(t,e,s,r),ii(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=_t(),r=or(e),s=Mn(n,r);s.tag=2,t!=null&&(s.callback=t),t=ir(e,s,r),t!==null&&(hn(t,e,r,n),ii(t,e,r))}};function Ed(e,t,n,r,s,l,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,a):t.prototype&&t.prototype.isPureReactComponent?!il(n,r)||!il(s,l):!0}function jh(e,t,n){var r=!1,s=fr,l=t.contextType;return typeof l=="object"&&l!==null?l=sn(l):(s=Dt(t)?zr:Lt.current,r=t.contextTypes,l=(r=r!=null)?ps(e,s):fr),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=na,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=l),t}function bd(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&na.enqueueReplaceState(t,t.state,null)}function Ro(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Oc(e);var l=t.contextType;typeof l=="object"&&l!==null?s.context=sn(l):(l=Dt(t)?zr:Lt.current,s.context=ps(e,l)),s.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(_o(e,t,l,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&na.enqueueReplaceState(s,s.state,null),Pi(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function vs(e,t){try{var n="",r=t;do n+=Bg(r),r=r.return;while(r);var s=n}catch(l){s=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:s,digest:null}}function Ua(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Io(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hy=typeof WeakMap=="function"?WeakMap:Map;function kh(e,t,n){n=Mn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ai||(Ai=!0,Vo=r),Io(e,t)},n}function Nh(e,t,n){n=Mn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Io(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Io(e,t),typeof r!="function"&&(ar===null?ar=new Set([this]):ar.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Ld(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new hy;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Ly.bind(null,e,t,n),t.then(e,e))}function Pd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function zd(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Mn(-1,1),t.tag=2,ir(n,t,1))),n.lanes|=1),e)}var my=Un.ReactCurrentOwner,Ft=!1;function zt(e,t,n,r){t.child=e===null?Zp(t,null,n,r):ms(t,e.child,n,r)}function _d(e,t,n,r,s){n=n.render;var l=t.ref;return cs(t,s),r=Wc(e,t,n,r,l,s),n=Hc(),e!==null&&!Ft?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Bn(e,t,s)):(nt&&n&&Rc(t),t.flags|=1,zt(e,t,r,s),t.child)}function Rd(e,t,n,r,s){if(e===null){var l=n.type;return typeof l=="function"&&!tu(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,Ch(e,t,l,r,s)):(e=fi(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&s)){var a=l.memoizedProps;if(n=n.compare,n=n!==null?n:il,n(a,r)&&e.ref===t.ref)return Bn(e,t,s)}return t.flags|=1,e=cr(l,r),e.ref=t.ref,e.return=t,t.child=e}function Ch(e,t,n,r,s){if(e!==null){var l=e.memoizedProps;if(il(l,r)&&e.ref===t.ref)if(Ft=!1,t.pendingProps=r=l,(e.lanes&s)!==0)e.flags&131072&&(Ft=!0);else return t.lanes=e.lanes,Bn(e,t,s)}return Ao(e,t,n,r,s)}function Eh(e,t,n){var r=t.pendingProps,s=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(ss,Wt),Wt|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Je(ss,Wt),Wt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,Je(ss,Wt),Wt|=r}else l!==null?(r=l.baseLanes|n,t.memoizedState=null):r=n,Je(ss,Wt),Wt|=r;return zt(e,t,s,n),t.child}function bh(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ao(e,t,n,r,s){var l=Dt(n)?zr:Lt.current;return l=ps(t,l),cs(t,s),n=Wc(e,t,n,r,l,s),r=Hc(),e!==null&&!Ft?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Bn(e,t,s)):(nt&&r&&Rc(t),t.flags|=1,zt(e,t,n,s),t.child)}function Id(e,t,n,r,s){if(Dt(n)){var l=!0;Ni(t)}else l=!1;if(cs(t,s),t.stateNode===null)ci(e,t),jh(t,n,r),Ro(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=sn(d):(d=Dt(n)?zr:Lt.current,d=ps(t,d));var m=n.getDerivedStateFromProps,v=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";v||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||u!==d)&&bd(t,a,r,d),qn=!1;var g=t.memoizedState;a.state=g,Pi(t,r,a,s),u=t.memoizedState,o!==r||g!==u||Ot.current||qn?(typeof m=="function"&&(_o(t,n,m,r),u=t.memoizedState),(o=qn||Ed(t,n,o,r,g,u,d))?(v||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=d,r=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,th(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:un(t.type,o),a.props=d,v=t.pendingProps,g=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=sn(u):(u=Dt(n)?zr:Lt.current,u=ps(t,u));var y=n.getDerivedStateFromProps;(m=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==v||g!==u)&&bd(t,a,r,u),qn=!1,g=t.memoizedState,a.state=g,Pi(t,r,a,s);var w=t.memoizedState;o!==v||g!==w||Ot.current||qn?(typeof y=="function"&&(_o(t,n,y,r),w=t.memoizedState),(d=qn||Ed(t,n,d,r,g,w,u)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,w,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,w,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),a.props=r,a.state=w,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),r=!1)}return To(e,t,n,r,l,s)}function To(e,t,n,r,s,l){bh(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&yd(t,n,!1),Bn(e,t,l);r=t.stateNode,my.current=t;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=ms(t,e.child,null,l),t.child=ms(t,null,o,l)):zt(e,t,o,l),t.memoizedState=r.state,s&&yd(t,n,!0),t.child}function Lh(e){var t=e.stateNode;t.pendingContext?vd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&vd(e,t.context,!1),Dc(e,t.containerInfo)}function Ad(e,t,n,r,s){return hs(),Ac(s),t.flags|=256,zt(e,t,n,r),t.child}var Mo={dehydrated:null,treeContext:null,retryLane:0};function $o(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ph(e,t,n){var r=t.pendingProps,s=it.current,l=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Je(it,s&1),e===null)return Po(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,l?(r=t.mode,l=t.child,a={mode:"hidden",children:a},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=a):l=la(a,r,0,null),e=Lr(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=$o(n),t.memoizedState=Mo,e):Qc(t,a));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return gy(e,t,a,r,o,s,n);if(l){l=r.fallback,a=t.mode,s=e.child,o=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=cr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),o!==null?l=cr(o,l):(l=Lr(l,a,n,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,a=e.child.memoizedState,a=a===null?$o(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},l.memoizedState=a,l.childLanes=e.childLanes&~n,t.memoizedState=Mo,r}return l=e.child,e=l.sibling,r=cr(l,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Qc(e,t){return t=la({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Gl(e,t,n,r){return r!==null&&Ac(r),ms(t,e.child,null,n),e=Qc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function gy(e,t,n,r,s,l,a){if(n)return t.flags&256?(t.flags&=-257,r=Ua(Error(J(422))),Gl(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,s=t.mode,r=la({mode:"visible",children:r.children},s,0,null),l=Lr(l,s,a,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,t.mode&1&&ms(t,e.child,null,a),t.child.memoizedState=$o(a),t.memoizedState=Mo,l);if(!(t.mode&1))return Gl(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var o=r.dgst;return r=o,l=Error(J(419)),r=Ua(l,r,void 0),Gl(e,t,a,r)}if(o=(a&e.childLanes)!==0,Ft||o){if(r=yt,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==l.retryLane&&(l.retryLane=s,Dn(e,s),hn(r,e,s,-1))}return eu(),r=Ua(Error(J(421))),Gl(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Py.bind(null,e),s._reactRetry=t,null):(e=l.treeContext,Ht=lr(s.nextSibling),Gt=t,nt=!0,fn=null,e!==null&&(en[tn++]=Rn,en[tn++]=In,en[tn++]=_r,Rn=e.id,In=e.overflow,_r=t),t=Qc(t,r.children),t.flags|=4096,t)}function Td(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),zo(e.return,t,n)}function Va(e,t,n,r,s){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=s)}function zh(e,t,n){var r=t.pendingProps,s=r.revealOrder,l=r.tail;if(zt(e,t,r.children,n),r=it.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Td(e,n,t);else if(e.tag===19)Td(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Je(it,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&zi(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Va(t,!1,s,n,l);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&zi(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Va(t,!0,n,null,l);break;case"together":Va(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ci(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Bn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ir|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,n=cr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=cr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function vy(e,t,n){switch(t.tag){case 3:Lh(t),hs();break;case 5:nh(t);break;case 1:Dt(t.type)&&Ni(t);break;case 4:Dc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Je(bi,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Je(it,it.current&1),t.flags|=128,null):n&t.child.childLanes?Ph(e,t,n):(Je(it,it.current&1),e=Bn(e,t,n),e!==null?e.sibling:null);Je(it,it.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return zh(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Je(it,it.current),r)break;return null;case 22:case 23:return t.lanes=0,Eh(e,t,n)}return Bn(e,t,n)}var _h,Fo,Rh,Ih;_h=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Fo=function(){};Rh=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Er(En.current);var l=null;switch(n){case"input":s=lo(e,s),r=lo(e,r),l=[];break;case"select":s=ct({},s,{value:void 0}),r=ct({},r,{value:void 0}),l=[];break;case"textarea":s=oo(e,s),r=oo(e,r),l=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ji)}uo(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var o=s[d];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Zs.hasOwnProperty(d)?l||(l=[]):(l=l||[]).push(d,null));for(d in r){var u=r[d];if(o=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==o&&(u!=null||o!=null))if(d==="style")if(o){for(a in o)!o.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&o[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(l||(l=[]),l.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(l=l||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(l=l||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Zs.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ze("scroll",e),l||o===u||(l=[])):(l=l||[]).push(d,u))}n&&(l=l||[]).push("style",n);var d=l;(t.updateQueue=d)&&(t.flags|=4)}};Ih=function(e,t,n,r){n!==r&&(t.flags|=4)};function Is(e,t){if(!nt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Et(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function yy(e,t,n){var r=t.pendingProps;switch(Ic(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(t),null;case 1:return Dt(t.type)&&ki(),Et(t),null;case 3:return r=t.stateNode,gs(),et(Ot),et(Lt),Uc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Wl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,fn!==null&&(Go(fn),fn=null))),Fo(e,t),Et(t),null;case 5:Bc(t);var s=Er(dl.current);if(n=t.type,e!==null&&t.stateNode!=null)Rh(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(J(166));return Et(t),null}if(e=Er(En.current),Wl(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[wn]=t,r[cl]=l,e=(t.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(s=0;s<Os.length;s++)Ze(Os[s],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":Wu(r,l),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Ze("invalid",r);break;case"textarea":Gu(r,l),Ze("invalid",r)}uo(n,l),s=null;for(var a in l)if(l.hasOwnProperty(a)){var o=l[a];a==="children"?typeof o=="string"?r.textContent!==o&&(l.suppressHydrationWarning!==!0&&Vl(r.textContent,o,e),s=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(l.suppressHydrationWarning!==!0&&Vl(r.textContent,o,e),s=["children",""+o]):Zs.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ze("scroll",r)}switch(n){case"input":Tl(r),Hu(r,l,!0);break;case"textarea":Tl(r),Ku(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=ji)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ap(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[wn]=t,e[cl]=r,_h(e,t,!1,!1),t.stateNode=e;e:{switch(a=fo(n,r),n){case"dialog":Ze("cancel",e),Ze("close",e),s=r;break;case"iframe":case"object":case"embed":Ze("load",e),s=r;break;case"video":case"audio":for(s=0;s<Os.length;s++)Ze(Os[s],e);s=r;break;case"source":Ze("error",e),s=r;break;case"img":case"image":case"link":Ze("error",e),Ze("load",e),s=r;break;case"details":Ze("toggle",e),s=r;break;case"input":Wu(e,r),s=lo(e,r),Ze("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=ct({},r,{value:void 0}),Ze("invalid",e);break;case"textarea":Gu(e,r),s=oo(e,r),Ze("invalid",e);break;default:s=r}uo(n,s),o=s;for(l in o)if(o.hasOwnProperty(l)){var u=o[l];l==="style"?up(e,u):l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&op(e,u)):l==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&el(e,u):typeof u=="number"&&el(e,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Zs.hasOwnProperty(l)?u!=null&&l==="onScroll"&&Ze("scroll",e):u!=null&&yc(e,l,u,a))}switch(n){case"input":Tl(e),Hu(e,r,!1);break;case"textarea":Tl(e),Ku(e);break;case"option":r.value!=null&&e.setAttribute("value",""+dr(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?ls(e,!!r.multiple,l,!1):r.defaultValue!=null&&ls(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ji)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Et(t),null;case 6:if(e&&t.stateNode!=null)Ih(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(J(166));if(n=Er(dl.current),Er(En.current),Wl(t)){if(r=t.stateNode,n=t.memoizedProps,r[wn]=t,(l=r.nodeValue!==n)&&(e=Gt,e!==null))switch(e.tag){case 3:Vl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Vl(r.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[wn]=t,t.stateNode=r}return Et(t),null;case 13:if(et(it),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(nt&&Ht!==null&&t.mode&1&&!(t.flags&128))Xp(),hs(),t.flags|=98560,l=!1;else if(l=Wl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(J(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(J(317));l[wn]=t}else hs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Et(t),l=!1}else fn!==null&&(Go(fn),fn=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||it.current&1?gt===0&&(gt=3):eu())),t.updateQueue!==null&&(t.flags|=4),Et(t),null);case 4:return gs(),Fo(e,t),e===null&&al(t.stateNode.containerInfo),Et(t),null;case 10:return $c(t.type._context),Et(t),null;case 17:return Dt(t.type)&&ki(),Et(t),null;case 19:if(et(it),l=t.memoizedState,l===null)return Et(t),null;if(r=(t.flags&128)!==0,a=l.rendering,a===null)if(r)Is(l,!1);else{if(gt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=zi(e),a!==null){for(t.flags|=128,Is(l,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)l=n,e=r,l.flags&=14680066,a=l.alternate,a===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,l.type=a.type,e=a.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Je(it,it.current&1|2),t.child}e=e.sibling}l.tail!==null&&ft()>ys&&(t.flags|=128,r=!0,Is(l,!1),t.lanes=4194304)}else{if(!r)if(e=zi(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Is(l,!0),l.tail===null&&l.tailMode==="hidden"&&!a.alternate&&!nt)return Et(t),null}else 2*ft()-l.renderingStartTime>ys&&n!==1073741824&&(t.flags|=128,r=!0,Is(l,!1),t.lanes=4194304);l.isBackwards?(a.sibling=t.child,t.child=a):(n=l.last,n!==null?n.sibling=a:t.child=a,l.last=a)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=ft(),t.sibling=null,n=it.current,Je(it,r?n&1|2:n&1),t):(Et(t),null);case 22:case 23:return Zc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Wt&1073741824&&(Et(t),t.subtreeFlags&6&&(t.flags|=8192)):Et(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function xy(e,t){switch(Ic(t),t.tag){case 1:return Dt(t.type)&&ki(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return gs(),et(Ot),et(Lt),Uc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Bc(t),null;case 13:if(et(it),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));hs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return et(it),null;case 4:return gs(),null;case 10:return $c(t.type._context),null;case 22:case 23:return Zc(),null;case 24:return null;default:return null}}var Kl=!1,bt=!1,wy=typeof WeakSet=="function"?WeakSet:Set,he=null;function rs(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ut(e,t,r)}else n.current=null}function Oo(e,t,n){try{n()}catch(r){ut(e,t,r)}}var Md=!1;function Sy(e,t){if(jo=xi,e=Fp(),_c(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var a=0,o=-1,u=-1,d=0,m=0,v=e,g=null;t:for(;;){for(var y;v!==n||s!==0&&v.nodeType!==3||(o=a+s),v!==l||r!==0&&v.nodeType!==3||(u=a+r),v.nodeType===3&&(a+=v.nodeValue.length),(y=v.firstChild)!==null;)g=v,v=y;for(;;){if(v===e)break t;if(g===n&&++d===s&&(o=a),g===l&&++m===r&&(u=a),(y=v.nextSibling)!==null)break;v=g,g=v.parentNode}v=y}n=o===-1||u===-1?null:{start:o,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ko={focusedElem:e,selectionRange:n},xi=!1,he=t;he!==null;)if(t=he,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,he=e;else for(;he!==null;){t=he;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var j=w.memoizedProps,S=w.memoizedState,h=t.stateNode,f=h.getSnapshotBeforeUpdate(t.elementType===t.type?j:un(t.type,j),S);h.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(x){ut(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,he=e;break}he=t.return}return w=Md,Md=!1,w}function Qs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var l=s.destroy;s.destroy=void 0,l!==void 0&&Oo(t,n,l)}s=s.next}while(s!==r)}}function ra(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Do(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ah(e){var t=e.alternate;t!==null&&(e.alternate=null,Ah(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[wn],delete t[cl],delete t[Eo],delete t[ry],delete t[sy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Th(e){return e.tag===5||e.tag===3||e.tag===4}function $d(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Th(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Bo(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ji));else if(r!==4&&(e=e.child,e!==null))for(Bo(e,t,n),e=e.sibling;e!==null;)Bo(e,t,n),e=e.sibling}function Uo(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Uo(e,t,n),e=e.sibling;e!==null;)Uo(e,t,n),e=e.sibling}var wt=null,dn=!1;function Qn(e,t,n){for(n=n.child;n!==null;)Mh(e,t,n),n=n.sibling}function Mh(e,t,n){if(Cn&&typeof Cn.onCommitFiberUnmount=="function")try{Cn.onCommitFiberUnmount(Yi,n)}catch{}switch(n.tag){case 5:bt||rs(n,t);case 6:var r=wt,s=dn;wt=null,Qn(e,t,n),wt=r,dn=s,wt!==null&&(dn?(e=wt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):wt.removeChild(n.stateNode));break;case 18:wt!==null&&(dn?(e=wt,n=n.stateNode,e.nodeType===8?Ma(e.parentNode,n):e.nodeType===1&&Ma(e,n),sl(e)):Ma(wt,n.stateNode));break;case 4:r=wt,s=dn,wt=n.stateNode.containerInfo,dn=!0,Qn(e,t,n),wt=r,dn=s;break;case 0:case 11:case 14:case 15:if(!bt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var l=s,a=l.destroy;l=l.tag,a!==void 0&&(l&2||l&4)&&Oo(n,t,a),s=s.next}while(s!==r)}Qn(e,t,n);break;case 1:if(!bt&&(rs(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){ut(n,t,o)}Qn(e,t,n);break;case 21:Qn(e,t,n);break;case 22:n.mode&1?(bt=(r=bt)||n.memoizedState!==null,Qn(e,t,n),bt=r):Qn(e,t,n);break;default:Qn(e,t,n)}}function Fd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new wy),t.forEach(function(r){var s=zy.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function on(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var l=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:wt=o.stateNode,dn=!1;break e;case 3:wt=o.stateNode.containerInfo,dn=!0;break e;case 4:wt=o.stateNode.containerInfo,dn=!0;break e}o=o.return}if(wt===null)throw Error(J(160));Mh(l,a,s),wt=null,dn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){ut(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$h(t,e),t=t.sibling}function $h(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(on(t,e),vn(e),r&4){try{Qs(3,e,e.return),ra(3,e)}catch(j){ut(e,e.return,j)}try{Qs(5,e,e.return)}catch(j){ut(e,e.return,j)}}break;case 1:on(t,e),vn(e),r&512&&n!==null&&rs(n,n.return);break;case 5:if(on(t,e),vn(e),r&512&&n!==null&&rs(n,n.return),e.flags&32){var s=e.stateNode;try{el(s,"")}catch(j){ut(e,e.return,j)}}if(r&4&&(s=e.stateNode,s!=null)){var l=e.memoizedProps,a=n!==null?n.memoizedProps:l,o=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{o==="input"&&l.type==="radio"&&l.name!=null&&lp(s,l),fo(o,a);var d=fo(o,l);for(a=0;a<u.length;a+=2){var m=u[a],v=u[a+1];m==="style"?up(s,v):m==="dangerouslySetInnerHTML"?op(s,v):m==="children"?el(s,v):yc(s,m,v,d)}switch(o){case"input":io(s,l);break;case"textarea":ip(s,l);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!l.multiple;var y=l.value;y!=null?ls(s,!!l.multiple,y,!1):g!==!!l.multiple&&(l.defaultValue!=null?ls(s,!!l.multiple,l.defaultValue,!0):ls(s,!!l.multiple,l.multiple?[]:"",!1))}s[cl]=l}catch(j){ut(e,e.return,j)}}break;case 6:if(on(t,e),vn(e),r&4){if(e.stateNode===null)throw Error(J(162));s=e.stateNode,l=e.memoizedProps;try{s.nodeValue=l}catch(j){ut(e,e.return,j)}}break;case 3:if(on(t,e),vn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sl(t.containerInfo)}catch(j){ut(e,e.return,j)}break;case 4:on(t,e),vn(e);break;case 13:on(t,e),vn(e),s=e.child,s.flags&8192&&(l=s.memoizedState!==null,s.stateNode.isHidden=l,!l||s.alternate!==null&&s.alternate.memoizedState!==null||(Xc=ft())),r&4&&Fd(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(bt=(d=bt)||m,on(t,e),bt=d):on(t,e),vn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!m&&e.mode&1)for(he=e,m=e.child;m!==null;){for(v=he=m;he!==null;){switch(g=he,y=g.child,g.tag){case 0:case 11:case 14:case 15:Qs(4,g,g.return);break;case 1:rs(g,g.return);var w=g.stateNode;if(typeof w.componentWillUnmount=="function"){r=g,n=g.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(j){ut(r,n,j)}}break;case 5:rs(g,g.return);break;case 22:if(g.memoizedState!==null){Dd(v);continue}}y!==null?(y.return=g,he=y):Dd(v)}m=m.sibling}e:for(m=null,v=e;;){if(v.tag===5){if(m===null){m=v;try{s=v.stateNode,d?(l=s.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(o=v.stateNode,u=v.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=cp("display",a))}catch(j){ut(e,e.return,j)}}}else if(v.tag===6){if(m===null)try{v.stateNode.nodeValue=d?"":v.memoizedProps}catch(j){ut(e,e.return,j)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===e)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===e)break e;for(;v.sibling===null;){if(v.return===null||v.return===e)break e;m===v&&(m=null),v=v.return}m===v&&(m=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:on(t,e),vn(e),r&4&&Fd(e);break;case 21:break;default:on(t,e),vn(e)}}function vn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Th(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(el(s,""),r.flags&=-33);var l=$d(e);Uo(e,l,s);break;case 3:case 4:var a=r.stateNode.containerInfo,o=$d(e);Bo(e,o,a);break;default:throw Error(J(161))}}catch(u){ut(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function jy(e,t,n){he=e,Fh(e)}function Fh(e,t,n){for(var r=(e.mode&1)!==0;he!==null;){var s=he,l=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Kl;if(!a){var o=s.alternate,u=o!==null&&o.memoizedState!==null||bt;o=Kl;var d=bt;if(Kl=a,(bt=u)&&!d)for(he=s;he!==null;)a=he,u=a.child,a.tag===22&&a.memoizedState!==null?Bd(s):u!==null?(u.return=a,he=u):Bd(s);for(;l!==null;)he=l,Fh(l),l=l.sibling;he=s,Kl=o,bt=d}Od(e)}else s.subtreeFlags&8772&&l!==null?(l.return=s,he=l):Od(e)}}function Od(e){for(;he!==null;){var t=he;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:bt||ra(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!bt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:un(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&kd(t,l,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}kd(t,a,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var v=m.dehydrated;v!==null&&sl(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}bt||t.flags&512&&Do(t)}catch(g){ut(t,t.return,g)}}if(t===e){he=null;break}if(n=t.sibling,n!==null){n.return=t.return,he=n;break}he=t.return}}function Dd(e){for(;he!==null;){var t=he;if(t===e){he=null;break}var n=t.sibling;if(n!==null){n.return=t.return,he=n;break}he=t.return}}function Bd(e){for(;he!==null;){var t=he;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ra(4,t)}catch(u){ut(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){ut(t,s,u)}}var l=t.return;try{Do(t)}catch(u){ut(t,l,u)}break;case 5:var a=t.return;try{Do(t)}catch(u){ut(t,a,u)}}}catch(u){ut(t,t.return,u)}if(t===e){he=null;break}var o=t.sibling;if(o!==null){o.return=t.return,he=o;break}he=t.return}}var ky=Math.ceil,Ii=Un.ReactCurrentDispatcher,Yc=Un.ReactCurrentOwner,rn=Un.ReactCurrentBatchConfig,Ve=0,yt=null,pt=null,St=0,Wt=0,ss=vr(0),gt=0,ml=null,Ir=0,sa=0,qc=0,Ys=null,$t=null,Xc=0,ys=1/0,Pn=null,Ai=!1,Vo=null,ar=null,Ql=!1,er=null,Ti=0,qs=0,Wo=null,ui=-1,di=0;function _t(){return Ve&6?ft():ui!==-1?ui:ui=ft()}function or(e){return e.mode&1?Ve&2&&St!==0?St&-St:iy.transition!==null?(di===0&&(di=jp()),di):(e=qe,e!==0||(e=window.event,e=e===void 0?16:Pp(e.type)),e):1}function hn(e,t,n,r){if(50<qs)throw qs=0,Wo=null,Error(J(185));Sl(e,n,r),(!(Ve&2)||e!==yt)&&(e===yt&&(!(Ve&2)&&(sa|=n),gt===4&&Jn(e,St)),Bt(e,r),n===1&&Ve===0&&!(t.mode&1)&&(ys=ft()+500,ea&&yr()))}function Bt(e,t){var n=e.callbackNode;iv(e,t);var r=yi(e,e===yt?St:0);if(r===0)n!==null&&qu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&qu(n),t===1)e.tag===0?ly(Ud.bind(null,e)):Qp(Ud.bind(null,e)),ty(function(){!(Ve&6)&&yr()}),n=null;else{switch(kp(r)){case 1:n=kc;break;case 4:n=wp;break;case 16:n=vi;break;case 536870912:n=Sp;break;default:n=vi}n=Gh(n,Oh.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Oh(e,t){if(ui=-1,di=0,Ve&6)throw Error(J(327));var n=e.callbackNode;if(us()&&e.callbackNode!==n)return null;var r=yi(e,e===yt?St:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Mi(e,r);else{t=r;var s=Ve;Ve|=2;var l=Bh();(yt!==e||St!==t)&&(Pn=null,ys=ft()+500,br(e,t));do try{Ey();break}catch(o){Dh(e,o)}while(!0);Mc(),Ii.current=l,Ve=s,pt!==null?t=0:(yt=null,St=0,t=gt)}if(t!==0){if(t===2&&(s=vo(e),s!==0&&(r=s,t=Ho(e,s))),t===1)throw n=ml,br(e,0),Jn(e,r),Bt(e,ft()),n;if(t===6)Jn(e,r);else{if(s=e.current.alternate,!(r&30)&&!Ny(s)&&(t=Mi(e,r),t===2&&(l=vo(e),l!==0&&(r=l,t=Ho(e,l))),t===1))throw n=ml,br(e,0),Jn(e,r),Bt(e,ft()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(J(345));case 2:jr(e,$t,Pn);break;case 3:if(Jn(e,r),(r&130023424)===r&&(t=Xc+500-ft(),10<t)){if(yi(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){_t(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Co(jr.bind(null,e,$t,Pn),t);break}jr(e,$t,Pn);break;case 4:if(Jn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-pn(r);l=1<<a,a=t[a],a>s&&(s=a),r&=~l}if(r=s,r=ft()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ky(r/1960))-r,10<r){e.timeoutHandle=Co(jr.bind(null,e,$t,Pn),r);break}jr(e,$t,Pn);break;case 5:jr(e,$t,Pn);break;default:throw Error(J(329))}}}return Bt(e,ft()),e.callbackNode===n?Oh.bind(null,e):null}function Ho(e,t){var n=Ys;return e.current.memoizedState.isDehydrated&&(br(e,t).flags|=256),e=Mi(e,t),e!==2&&(t=$t,$t=n,t!==null&&Go(t)),e}function Go(e){$t===null?$t=e:$t.push.apply($t,e)}function Ny(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],l=s.getSnapshot;s=s.value;try{if(!mn(l(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Jn(e,t){for(t&=~qc,t&=~sa,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-pn(t),r=1<<n;e[n]=-1,t&=~r}}function Ud(e){if(Ve&6)throw Error(J(327));us();var t=yi(e,0);if(!(t&1))return Bt(e,ft()),null;var n=Mi(e,t);if(e.tag!==0&&n===2){var r=vo(e);r!==0&&(t=r,n=Ho(e,r))}if(n===1)throw n=ml,br(e,0),Jn(e,t),Bt(e,ft()),n;if(n===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jr(e,$t,Pn),Bt(e,ft()),null}function Jc(e,t){var n=Ve;Ve|=1;try{return e(t)}finally{Ve=n,Ve===0&&(ys=ft()+500,ea&&yr())}}function Ar(e){er!==null&&er.tag===0&&!(Ve&6)&&us();var t=Ve;Ve|=1;var n=rn.transition,r=qe;try{if(rn.transition=null,qe=1,e)return e()}finally{qe=r,rn.transition=n,Ve=t,!(Ve&6)&&yr()}}function Zc(){Wt=ss.current,et(ss)}function br(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ey(n)),pt!==null)for(n=pt.return;n!==null;){var r=n;switch(Ic(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ki();break;case 3:gs(),et(Ot),et(Lt),Uc();break;case 5:Bc(r);break;case 4:gs();break;case 13:et(it);break;case 19:et(it);break;case 10:$c(r.type._context);break;case 22:case 23:Zc()}n=n.return}if(yt=e,pt=e=cr(e.current,null),St=Wt=t,gt=0,ml=null,qc=sa=Ir=0,$t=Ys=null,Cr!==null){for(t=0;t<Cr.length;t++)if(n=Cr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,l=n.pending;if(l!==null){var a=l.next;l.next=s,r.next=a}n.pending=r}Cr=null}return e}function Dh(e,t){do{var n=pt;try{if(Mc(),ai.current=Ri,_i){for(var r=at.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}_i=!1}if(Rr=0,vt=mt=at=null,Ks=!1,fl=0,Yc.current=null,n===null||n.return===null){gt=1,ml=t,pt=null;break}e:{var l=e,a=n.return,o=n,u=t;if(t=St,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=o,v=m.tag;if(!(m.mode&1)&&(v===0||v===11||v===15)){var g=m.alternate;g?(m.updateQueue=g.updateQueue,m.memoizedState=g.memoizedState,m.lanes=g.lanes):(m.updateQueue=null,m.memoizedState=null)}var y=Pd(a);if(y!==null){y.flags&=-257,zd(y,a,o,l,t),y.mode&1&&Ld(l,d,t),t=y,u=d;var w=t.updateQueue;if(w===null){var j=new Set;j.add(u),t.updateQueue=j}else w.add(u);break e}else{if(!(t&1)){Ld(l,d,t),eu();break e}u=Error(J(426))}}else if(nt&&o.mode&1){var S=Pd(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),zd(S,a,o,l,t),Ac(vs(u,o));break e}}l=u=vs(u,o),gt!==4&&(gt=2),Ys===null?Ys=[l]:Ys.push(l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var h=kh(l,u,t);jd(l,h);break e;case 1:o=u;var f=l.type,p=l.stateNode;if(!(l.flags&128)&&(typeof f.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(ar===null||!ar.has(p)))){l.flags|=65536,t&=-t,l.lanes|=t;var x=Nh(l,o,t);jd(l,x);break e}}l=l.return}while(l!==null)}Vh(n)}catch(N){t=N,pt===n&&n!==null&&(pt=n=n.return);continue}break}while(!0)}function Bh(){var e=Ii.current;return Ii.current=Ri,e===null?Ri:e}function eu(){(gt===0||gt===3||gt===2)&&(gt=4),yt===null||!(Ir&268435455)&&!(sa&268435455)||Jn(yt,St)}function Mi(e,t){var n=Ve;Ve|=2;var r=Bh();(yt!==e||St!==t)&&(Pn=null,br(e,t));do try{Cy();break}catch(s){Dh(e,s)}while(!0);if(Mc(),Ve=n,Ii.current=r,pt!==null)throw Error(J(261));return yt=null,St=0,gt}function Cy(){for(;pt!==null;)Uh(pt)}function Ey(){for(;pt!==null&&!Xg();)Uh(pt)}function Uh(e){var t=Hh(e.alternate,e,Wt);e.memoizedProps=e.pendingProps,t===null?Vh(e):pt=t,Yc.current=null}function Vh(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=xy(n,t),n!==null){n.flags&=32767,pt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{gt=6,pt=null;return}}else if(n=yy(n,t,Wt),n!==null){pt=n;return}if(t=t.sibling,t!==null){pt=t;return}pt=t=e}while(t!==null);gt===0&&(gt=5)}function jr(e,t,n){var r=qe,s=rn.transition;try{rn.transition=null,qe=1,by(e,t,n,r)}finally{rn.transition=s,qe=r}return null}function by(e,t,n,r){do us();while(er!==null);if(Ve&6)throw Error(J(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(av(e,l),e===yt&&(pt=yt=null,St=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ql||(Ql=!0,Gh(vi,function(){return us(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=rn.transition,rn.transition=null;var a=qe;qe=1;var o=Ve;Ve|=4,Yc.current=null,Sy(e,n),$h(n,e),Kv(ko),xi=!!jo,ko=jo=null,e.current=n,jy(n),Jg(),Ve=o,qe=a,rn.transition=l}else e.current=n;if(Ql&&(Ql=!1,er=e,Ti=s),l=e.pendingLanes,l===0&&(ar=null),tv(n.stateNode),Bt(e,ft()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ai)throw Ai=!1,e=Vo,Vo=null,e;return Ti&1&&e.tag!==0&&us(),l=e.pendingLanes,l&1?e===Wo?qs++:(qs=0,Wo=e):qs=0,yr(),null}function us(){if(er!==null){var e=kp(Ti),t=rn.transition,n=qe;try{if(rn.transition=null,qe=16>e?16:e,er===null)var r=!1;else{if(e=er,er=null,Ti=0,Ve&6)throw Error(J(331));var s=Ve;for(Ve|=4,he=e.current;he!==null;){var l=he,a=l.child;if(he.flags&16){var o=l.deletions;if(o!==null){for(var u=0;u<o.length;u++){var d=o[u];for(he=d;he!==null;){var m=he;switch(m.tag){case 0:case 11:case 15:Qs(8,m,l)}var v=m.child;if(v!==null)v.return=m,he=v;else for(;he!==null;){m=he;var g=m.sibling,y=m.return;if(Ah(m),m===d){he=null;break}if(g!==null){g.return=y,he=g;break}he=y}}}var w=l.alternate;if(w!==null){var j=w.child;if(j!==null){w.child=null;do{var S=j.sibling;j.sibling=null,j=S}while(j!==null)}}he=l}}if(l.subtreeFlags&2064&&a!==null)a.return=l,he=a;else e:for(;he!==null;){if(l=he,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Qs(9,l,l.return)}var h=l.sibling;if(h!==null){h.return=l.return,he=h;break e}he=l.return}}var f=e.current;for(he=f;he!==null;){a=he;var p=a.child;if(a.subtreeFlags&2064&&p!==null)p.return=a,he=p;else e:for(a=f;he!==null;){if(o=he,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:ra(9,o)}}catch(N){ut(o,o.return,N)}if(o===a){he=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,he=x;break e}he=o.return}}if(Ve=s,yr(),Cn&&typeof Cn.onPostCommitFiberRoot=="function")try{Cn.onPostCommitFiberRoot(Yi,e)}catch{}r=!0}return r}finally{qe=n,rn.transition=t}}return!1}function Vd(e,t,n){t=vs(n,t),t=kh(e,t,1),e=ir(e,t,1),t=_t(),e!==null&&(Sl(e,1,t),Bt(e,t))}function ut(e,t,n){if(e.tag===3)Vd(e,e,n);else for(;t!==null;){if(t.tag===3){Vd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ar===null||!ar.has(r))){e=vs(n,e),e=Nh(t,e,1),t=ir(t,e,1),e=_t(),t!==null&&(Sl(t,1,e),Bt(t,e));break}}t=t.return}}function Ly(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=_t(),e.pingedLanes|=e.suspendedLanes&n,yt===e&&(St&n)===n&&(gt===4||gt===3&&(St&130023424)===St&&500>ft()-Xc?br(e,0):qc|=n),Bt(e,t)}function Wh(e,t){t===0&&(e.mode&1?(t=Fl,Fl<<=1,!(Fl&130023424)&&(Fl=4194304)):t=1);var n=_t();e=Dn(e,t),e!==null&&(Sl(e,t,n),Bt(e,n))}function Py(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Wh(e,n)}function zy(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(t),Wh(e,n)}var Hh;Hh=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ot.current)Ft=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ft=!1,vy(e,t,n);Ft=!!(e.flags&131072)}else Ft=!1,nt&&t.flags&1048576&&Yp(t,Ei,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ci(e,t),e=t.pendingProps;var s=ps(t,Lt.current);cs(t,n),s=Wc(null,t,r,e,s,n);var l=Hc();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dt(r)?(l=!0,Ni(t)):l=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Oc(t),s.updater=na,t.stateNode=s,s._reactInternals=t,Ro(t,r,e,n),t=To(null,t,r,!0,l,n)):(t.tag=0,nt&&l&&Rc(t),zt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ci(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=Ry(r),e=un(r,e),s){case 0:t=Ao(null,t,r,e,n);break e;case 1:t=Id(null,t,r,e,n);break e;case 11:t=_d(null,t,r,e,n);break e;case 14:t=Rd(null,t,r,un(r.type,e),n);break e}throw Error(J(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:un(r,s),Ao(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:un(r,s),Id(e,t,r,s,n);case 3:e:{if(Lh(t),e===null)throw Error(J(387));r=t.pendingProps,l=t.memoizedState,s=l.element,th(e,t),Pi(t,r,null,n);var a=t.memoizedState;if(r=a.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){s=vs(Error(J(423)),t),t=Ad(e,t,r,n,s);break e}else if(r!==s){s=vs(Error(J(424)),t),t=Ad(e,t,r,n,s);break e}else for(Ht=lr(t.stateNode.containerInfo.firstChild),Gt=t,nt=!0,fn=null,n=Zp(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(hs(),r===s){t=Bn(e,t,n);break e}zt(e,t,r,n)}t=t.child}return t;case 5:return nh(t),e===null&&Po(t),r=t.type,s=t.pendingProps,l=e!==null?e.memoizedProps:null,a=s.children,No(r,s)?a=null:l!==null&&No(r,l)&&(t.flags|=32),bh(e,t),zt(e,t,a,n),t.child;case 6:return e===null&&Po(t),null;case 13:return Ph(e,t,n);case 4:return Dc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ms(t,null,r,n):zt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:un(r,s),_d(e,t,r,s,n);case 7:return zt(e,t,t.pendingProps,n),t.child;case 8:return zt(e,t,t.pendingProps.children,n),t.child;case 12:return zt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,l=t.memoizedProps,a=s.value,Je(bi,r._currentValue),r._currentValue=a,l!==null)if(mn(l.value,a)){if(l.children===s.children&&!Ot.current){t=Bn(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var o=l.dependencies;if(o!==null){a=l.child;for(var u=o.firstContext;u!==null;){if(u.context===r){if(l.tag===1){u=Mn(-1,n&-n),u.tag=2;var d=l.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),zo(l.return,n,t),o.lanes|=n;break}u=u.next}}else if(l.tag===10)a=l.type===t.type?null:l.child;else if(l.tag===18){if(a=l.return,a===null)throw Error(J(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),zo(a,n,t),a=l.sibling}else a=l.child;if(a!==null)a.return=l;else for(a=l;a!==null;){if(a===t){a=null;break}if(l=a.sibling,l!==null){l.return=a.return,a=l;break}a=a.return}l=a}zt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,cs(t,n),s=sn(s),r=r(s),t.flags|=1,zt(e,t,r,n),t.child;case 14:return r=t.type,s=un(r,t.pendingProps),s=un(r.type,s),Rd(e,t,r,s,n);case 15:return Ch(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:un(r,s),ci(e,t),t.tag=1,Dt(r)?(e=!0,Ni(t)):e=!1,cs(t,n),jh(t,r,s),Ro(t,r,s,n),To(null,t,r,!0,e,n);case 19:return zh(e,t,n);case 22:return Eh(e,t,n)}throw Error(J(156,t.tag))};function Gh(e,t){return xp(e,t)}function _y(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nn(e,t,n,r){return new _y(e,t,n,r)}function tu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ry(e){if(typeof e=="function")return tu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===wc)return 11;if(e===Sc)return 14}return 2}function cr(e,t){var n=e.alternate;return n===null?(n=nn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function fi(e,t,n,r,s,l){var a=2;if(r=e,typeof e=="function")tu(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Qr:return Lr(n.children,s,l,t);case xc:a=8,s|=8;break;case to:return e=nn(12,n,t,s|2),e.elementType=to,e.lanes=l,e;case no:return e=nn(13,n,t,s),e.elementType=no,e.lanes=l,e;case ro:return e=nn(19,n,t,s),e.elementType=ro,e.lanes=l,e;case np:return la(n,s,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ep:a=10;break e;case tp:a=9;break e;case wc:a=11;break e;case Sc:a=14;break e;case Yn:a=16,r=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=nn(a,n,t,s),t.elementType=e,t.type=r,t.lanes=l,t}function Lr(e,t,n,r){return e=nn(7,e,r,t),e.lanes=n,e}function la(e,t,n,r){return e=nn(22,e,r,t),e.elementType=np,e.lanes=n,e.stateNode={isHidden:!1},e}function Wa(e,t,n){return e=nn(6,e,null,t),e.lanes=n,e}function Ha(e,t,n){return t=nn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Iy(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ca(0),this.expirationTimes=Ca(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ca(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function nu(e,t,n,r,s,l,a,o,u){return e=new Iy(e,t,n,o,u),t===1?(t=1,l===!0&&(t|=8)):t=0,l=nn(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oc(l),e}function Ay(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Kh(e){if(!e)return fr;e=e._reactInternals;e:{if(Mr(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var n=e.type;if(Dt(n))return Kp(e,n,t)}return t}function Qh(e,t,n,r,s,l,a,o,u){return e=nu(n,r,!0,e,s,l,a,o,u),e.context=Kh(null),n=e.current,r=_t(),s=or(n),l=Mn(r,s),l.callback=t??null,ir(n,l,s),e.current.lanes=s,Sl(e,s,r),Bt(e,r),e}function ia(e,t,n,r){var s=t.current,l=_t(),a=or(s);return n=Kh(n),t.context===null?t.context=n:t.pendingContext=n,t=Mn(l,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ir(s,t,a),e!==null&&(hn(e,s,a,l),ii(e,s,a)),a}function $i(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Wd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ru(e,t){Wd(e,t),(e=e.alternate)&&Wd(e,t)}function Ty(){return null}var Yh=typeof reportError=="function"?reportError:function(e){console.error(e)};function su(e){this._internalRoot=e}aa.prototype.render=su.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));ia(e,t,null,null)};aa.prototype.unmount=su.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ar(function(){ia(null,e,null,null)}),t[On]=null}};function aa(e){this._internalRoot=e}aa.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ep();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Xn.length&&t!==0&&t<Xn[n].priority;n++);Xn.splice(n,0,e),n===0&&Lp(e)}};function lu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function oa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Hd(){}function My(e,t,n,r,s){if(s){if(typeof r=="function"){var l=r;r=function(){var d=$i(a);l.call(d)}}var a=Qh(t,r,e,0,null,!1,!1,"",Hd);return e._reactRootContainer=a,e[On]=a.current,al(e.nodeType===8?e.parentNode:e),Ar(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var o=r;r=function(){var d=$i(u);o.call(d)}}var u=nu(e,0,!1,null,null,!1,!1,"",Hd);return e._reactRootContainer=u,e[On]=u.current,al(e.nodeType===8?e.parentNode:e),Ar(function(){ia(t,u,n,r)}),u}function ca(e,t,n,r,s){var l=n._reactRootContainer;if(l){var a=l;if(typeof s=="function"){var o=s;s=function(){var u=$i(a);o.call(u)}}ia(t,a,e,s)}else a=My(n,t,e,s,r);return $i(a)}Np=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Fs(t.pendingLanes);n!==0&&(Nc(t,n|1),Bt(t,ft()),!(Ve&6)&&(ys=ft()+500,yr()))}break;case 13:Ar(function(){var r=Dn(e,1);if(r!==null){var s=_t();hn(r,e,1,s)}}),ru(e,1)}};Cc=function(e){if(e.tag===13){var t=Dn(e,134217728);if(t!==null){var n=_t();hn(t,e,134217728,n)}ru(e,134217728)}};Cp=function(e){if(e.tag===13){var t=or(e),n=Dn(e,t);if(n!==null){var r=_t();hn(n,e,t,r)}ru(e,t)}};Ep=function(){return qe};bp=function(e,t){var n=qe;try{return qe=e,t()}finally{qe=n}};ho=function(e,t,n){switch(t){case"input":if(io(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Zi(r);if(!s)throw Error(J(90));sp(r),io(r,s)}}}break;case"textarea":ip(e,n);break;case"select":t=n.value,t!=null&&ls(e,!!n.multiple,t,!1)}};pp=Jc;hp=Ar;var $y={usingClientEntryPoint:!1,Events:[kl,Jr,Zi,dp,fp,Jc]},As={findFiberByHostInstance:Nr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Fy={bundleType:As.bundleType,version:As.version,rendererPackageName:As.rendererPackageName,rendererConfig:As.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Un.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vp(e),e===null?null:e.stateNode},findFiberByHostInstance:As.findFiberByHostInstance||Ty,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yl.isDisabled&&Yl.supportsFiber)try{Yi=Yl.inject(Fy),Cn=Yl}catch{}}Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$y;Qt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lu(t))throw Error(J(200));return Ay(e,t,null,n)};Qt.createRoot=function(e,t){if(!lu(e))throw Error(J(299));var n=!1,r="",s=Yh;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=nu(e,1,!1,null,null,n,!1,r,s),e[On]=t.current,al(e.nodeType===8?e.parentNode:e),new su(t)};Qt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=vp(t),e=e===null?null:e.stateNode,e};Qt.flushSync=function(e){return Ar(e)};Qt.hydrate=function(e,t,n){if(!oa(t))throw Error(J(200));return ca(null,e,t,!0,n)};Qt.hydrateRoot=function(e,t,n){if(!lu(e))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,s=!1,l="",a=Yh;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Qh(t,null,e,1,n??null,s,!1,l,a),e[On]=t.current,al(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new aa(t)};Qt.render=function(e,t,n){if(!oa(t))throw Error(J(200));return ca(null,e,t,!1,n)};Qt.unmountComponentAtNode=function(e){if(!oa(e))throw Error(J(40));return e._reactRootContainer?(Ar(function(){ca(null,null,e,!1,function(){e._reactRootContainer=null,e[On]=null})}),!0):!1};Qt.unstable_batchedUpdates=Jc;Qt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!oa(n))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return ca(e,t,n,!1,r)};Qt.version="18.3.1-next-f1338f8080-20240426";function qh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qh)}catch(e){console.error(e)}}qh(),qf.exports=Qt;var iu=qf.exports,Gd=iu;Za.createRoot=Gd.createRoot,Za.hydrateRoot=Gd.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gl(){return gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gl.apply(this,arguments)}var tr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(tr||(tr={}));const Kd="popstate";function Oy(e){e===void 0&&(e={});function t(s,l){let{pathname:a="/",search:o="",hash:u=""}=$r(s.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),Ko("",{pathname:a,search:o,hash:u},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(s,l){let a=s.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let u=s.location.href,d=u.indexOf("#");o=d===-1?u:u.slice(0,d)}return o+"#"+(typeof l=="string"?l:Fi(l))}function r(s,l){au(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(l)+")")}return By(t,n,r,e)}function ot(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function au(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Dy(){return Math.random().toString(36).substr(2,8)}function Qd(e,t){return{usr:e.state,key:e.key,idx:t}}function Ko(e,t,n,r){return n===void 0&&(n=null),gl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?$r(t):t,{state:n,key:t&&t.key||r||Dy()})}function Fi(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function $r(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function By(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:l=!1}=r,a=s.history,o=tr.Pop,u=null,d=m();d==null&&(d=0,a.replaceState(gl({},a.state,{idx:d}),""));function m(){return(a.state||{idx:null}).idx}function v(){o=tr.Pop;let S=m(),h=S==null?null:S-d;d=S,u&&u({action:o,location:j.location,delta:h})}function g(S,h){o=tr.Push;let f=Ko(j.location,S,h);n&&n(f,S),d=m()+1;let p=Qd(f,d),x=j.createHref(f);try{a.pushState(p,"",x)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(x)}l&&u&&u({action:o,location:j.location,delta:1})}function y(S,h){o=tr.Replace;let f=Ko(j.location,S,h);n&&n(f,S),d=m();let p=Qd(f,d),x=j.createHref(f);a.replaceState(p,"",x),l&&u&&u({action:o,location:j.location,delta:0})}function w(S){let h=s.location.origin!=="null"?s.location.origin:s.location.href,f=typeof S=="string"?S:Fi(S);return f=f.replace(/ $/,"%20"),ot(h,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,h)}let j={get action(){return o},get location(){return e(s,a)},listen(S){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Kd,v),u=S,()=>{s.removeEventListener(Kd,v),u=null}},createHref(S){return t(s,S)},createURL:w,encodeLocation(S){let h=w(S);return{pathname:h.pathname,search:h.search,hash:h.hash}},push:g,replace:y,go(S){return a.go(S)}};return j}var Yd;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Yd||(Yd={}));function Uy(e,t,n){return n===void 0&&(n="/"),Vy(e,t,n)}function Vy(e,t,n,r){let s=typeof t=="string"?$r(t):t,l=xs(s.pathname||"/",n);if(l==null)return null;let a=Xh(e);Wy(a);let o=null;for(let u=0;o==null&&u<a.length;++u){let d=tx(l);o=Zy(a[u],d)}return o}function Xh(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(l,a,o)=>{let u={relativePath:o===void 0?l.path||"":o,caseSensitive:l.caseSensitive===!0,childrenIndex:a,route:l};u.relativePath.startsWith("/")&&(ot(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=ur([r,u.relativePath]),m=n.concat(u);l.children&&l.children.length>0&&(ot(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Xh(l.children,t,m,d)),!(l.path==null&&!l.index)&&t.push({path:d,score:Xy(d,l.index),routesMeta:m})};return e.forEach((l,a)=>{var o;if(l.path===""||!((o=l.path)!=null&&o.includes("?")))s(l,a);else for(let u of Jh(l.path))s(l,a,u)}),t}function Jh(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),l=n.replace(/\?$/,"");if(r.length===0)return s?[l,""]:[l];let a=Jh(r.join("/")),o=[];return o.push(...a.map(u=>u===""?l:[l,u].join("/"))),s&&o.push(...a),o.map(u=>e.startsWith("/")&&u===""?"/":u)}function Wy(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Jy(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Hy=/^:[\w-]+$/,Gy=3,Ky=2,Qy=1,Yy=10,qy=-2,qd=e=>e==="*";function Xy(e,t){let n=e.split("/"),r=n.length;return n.some(qd)&&(r+=qy),t&&(r+=Ky),n.filter(s=>!qd(s)).reduce((s,l)=>s+(Hy.test(l)?Gy:l===""?Qy:Yy),r)}function Jy(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function Zy(e,t,n){let{routesMeta:r}=e,s={},l="/",a=[];for(let o=0;o<r.length;++o){let u=r[o],d=o===r.length-1,m=l==="/"?t:t.slice(l.length)||"/",v=Qo({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},m),g=u.route;if(!v)return null;Object.assign(s,v.params),a.push({params:s,pathname:ur([l,v.pathname]),pathnameBase:lx(ur([l,v.pathnameBase])),route:g}),v.pathnameBase!=="/"&&(l=ur([l,v.pathnameBase]))}return a}function Qo(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=ex(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let l=s[0],a=l.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:r.reduce((d,m,v)=>{let{paramName:g,isOptional:y}=m;if(g==="*"){let j=o[v]||"";a=l.slice(0,l.length-j.length).replace(/(.)\/+$/,"$1")}const w=o[v];return y&&!w?d[g]=void 0:d[g]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:l,pathnameBase:a,pattern:e}}function ex(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),au(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,u)=>(r.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function tx(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return au(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function xs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function nx(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?$r(e):e;return{pathname:n?n.startsWith("/")?n:rx(n,t):t,search:ix(r),hash:ax(s)}}function rx(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Ga(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sx(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function ou(e,t){let n=sx(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function cu(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=$r(e):(s=gl({},e),ot(!s.pathname||!s.pathname.includes("?"),Ga("?","pathname","search",s)),ot(!s.pathname||!s.pathname.includes("#"),Ga("#","pathname","hash",s)),ot(!s.search||!s.search.includes("#"),Ga("#","search","hash",s)));let l=e===""||s.pathname==="",a=l?"/":s.pathname,o;if(a==null)o=n;else{let v=t.length-1;if(!r&&a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),v-=1;s.pathname=g.join("/")}o=v>=0?t[v]:"/"}let u=nx(s,o),d=a&&a!=="/"&&a.endsWith("/"),m=(l||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||m)&&(u.pathname+="/"),u}const ur=e=>e.join("/").replace(/\/\/+/g,"/"),lx=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ix=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ax=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ox(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Zh=["post","put","patch","delete"];new Set(Zh);const cx=["get",...Zh];new Set(cx);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vl(){return vl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vl.apply(this,arguments)}const ua=c.createContext(null),em=c.createContext(null),Vn=c.createContext(null),da=c.createContext(null),Wn=c.createContext({outlet:null,matches:[],isDataRoute:!1}),tm=c.createContext(null);function ux(e,t){let{relative:n}=t===void 0?{}:t;Ns()||ot(!1);let{basename:r,navigator:s}=c.useContext(Vn),{hash:l,pathname:a,search:o}=fa(e,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:ur([r,a])),s.createHref({pathname:u,search:o,hash:l})}function Ns(){return c.useContext(da)!=null}function qt(){return Ns()||ot(!1),c.useContext(da).location}function nm(e){c.useContext(Vn).static||c.useLayoutEffect(e)}function Ln(){let{isDataRoute:e}=c.useContext(Wn);return e?Cx():dx()}function dx(){Ns()||ot(!1);let e=c.useContext(ua),{basename:t,future:n,navigator:r}=c.useContext(Vn),{matches:s}=c.useContext(Wn),{pathname:l}=qt(),a=JSON.stringify(ou(s,n.v7_relativeSplatPath)),o=c.useRef(!1);return nm(()=>{o.current=!0}),c.useCallback(function(d,m){if(m===void 0&&(m={}),!o.current)return;if(typeof d=="number"){r.go(d);return}let v=cu(d,JSON.parse(a),l,m.relative==="path");e==null&&t!=="/"&&(v.pathname=v.pathname==="/"?t:ur([t,v.pathname])),(m.replace?r.replace:r.push)(v,m.state,m)},[t,r,a,l,e])}const fx=c.createContext(null);function px(e){let t=c.useContext(Wn).outlet;return t&&c.createElement(fx.Provider,{value:e},t)}function fa(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=c.useContext(Vn),{matches:s}=c.useContext(Wn),{pathname:l}=qt(),a=JSON.stringify(ou(s,r.v7_relativeSplatPath));return c.useMemo(()=>cu(e,JSON.parse(a),l,n==="path"),[e,a,l,n])}function hx(e,t){return mx(e,t)}function mx(e,t,n,r){Ns()||ot(!1);let{navigator:s}=c.useContext(Vn),{matches:l}=c.useContext(Wn),a=l[l.length-1],o=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=qt(),m;if(t){var v;let S=typeof t=="string"?$r(t):t;u==="/"||(v=S.pathname)!=null&&v.startsWith(u)||ot(!1),m=S}else m=d;let g=m.pathname||"/",y=g;if(u!=="/"){let S=u.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(S.length).join("/")}let w=Uy(e,{pathname:y}),j=wx(w&&w.map(S=>Object.assign({},S,{params:Object.assign({},o,S.params),pathname:ur([u,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?u:ur([u,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),l,n,r);return t&&j?c.createElement(da.Provider,{value:{location:vl({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:tr.Pop}},j):j}function gx(){let e=Nx(),t=ox(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return c.createElement(c.Fragment,null,c.createElement("h2",null,"Unexpected Application Error!"),c.createElement("h3",{style:{fontStyle:"italic"}},t),n?c.createElement("pre",{style:s},n):null,null)}const vx=c.createElement(gx,null);class yx extends c.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?c.createElement(Wn.Provider,{value:this.props.routeContext},c.createElement(tm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function xx(e){let{routeContext:t,match:n,children:r}=e,s=c.useContext(ua);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),c.createElement(Wn.Provider,{value:t},r)}function wx(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var l;if(!n)return null;if(n.errors)e=n.matches;else if((l=r)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=(s=n)==null?void 0:s.errors;if(o!=null){let m=a.findIndex(v=>v.route.id&&(o==null?void 0:o[v.route.id])!==void 0);m>=0||ot(!1),a=a.slice(0,Math.min(a.length,m+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<a.length;m++){let v=a[m];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(d=m),v.route.id){let{loaderData:g,errors:y}=n,w=v.route.loader&&g[v.route.id]===void 0&&(!y||y[v.route.id]===void 0);if(v.route.lazy||w){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((m,v,g)=>{let y,w=!1,j=null,S=null;n&&(y=o&&v.route.id?o[v.route.id]:void 0,j=v.route.errorElement||vx,u&&(d<0&&g===0?(Ex("route-fallback"),w=!0,S=null):d===g&&(w=!0,S=v.route.hydrateFallbackElement||null)));let h=t.concat(a.slice(0,g+1)),f=()=>{let p;return y?p=j:w?p=S:v.route.Component?p=c.createElement(v.route.Component,null):v.route.element?p=v.route.element:p=m,c.createElement(xx,{match:v,routeContext:{outlet:m,matches:h,isDataRoute:n!=null},children:p})};return n&&(v.route.ErrorBoundary||v.route.errorElement||g===0)?c.createElement(yx,{location:n.location,revalidation:n.revalidation,component:j,error:y,children:f(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):f()},null)}var rm=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(rm||{}),sm=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(sm||{});function Sx(e){let t=c.useContext(ua);return t||ot(!1),t}function jx(e){let t=c.useContext(em);return t||ot(!1),t}function kx(e){let t=c.useContext(Wn);return t||ot(!1),t}function lm(e){let t=kx(),n=t.matches[t.matches.length-1];return n.route.id||ot(!1),n.route.id}function Nx(){var e;let t=c.useContext(tm),n=jx(),r=lm();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function Cx(){let{router:e}=Sx(rm.UseNavigateStable),t=lm(sm.UseNavigateStable),n=c.useRef(!1);return nm(()=>{n.current=!0}),c.useCallback(function(s,l){l===void 0&&(l={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,vl({fromRouteId:t},l)))},[e,t])}const Xd={};function Ex(e,t,n){Xd[e]||(Xd[e]=!0)}function bx(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Yo(e){let{to:t,replace:n,state:r,relative:s}=e;Ns()||ot(!1);let{future:l,static:a}=c.useContext(Vn),{matches:o}=c.useContext(Wn),{pathname:u}=qt(),d=Ln(),m=cu(t,ou(o,l.v7_relativeSplatPath),u,s==="path"),v=JSON.stringify(m);return c.useEffect(()=>d(JSON.parse(v),{replace:n,state:r,relative:s}),[d,v,s,n,r]),null}function Lx(e){return px(e.context)}function cn(e){ot(!1)}function Px(e){let{basename:t="/",children:n=null,location:r,navigationType:s=tr.Pop,navigator:l,static:a=!1,future:o}=e;Ns()&&ot(!1);let u=t.replace(/^\/*/,"/"),d=c.useMemo(()=>({basename:u,navigator:l,static:a,future:vl({v7_relativeSplatPath:!1},o)}),[u,o,l,a]);typeof r=="string"&&(r=$r(r));let{pathname:m="/",search:v="",hash:g="",state:y=null,key:w="default"}=r,j=c.useMemo(()=>{let S=xs(m,u);return S==null?null:{location:{pathname:S,search:v,hash:g,state:y,key:w},navigationType:s}},[u,m,v,g,y,w,s]);return j==null?null:c.createElement(Vn.Provider,{value:d},c.createElement(da.Provider,{children:n,value:j}))}function zx(e){let{children:t,location:n}=e;return hx(qo(t),n)}new Promise(()=>{});function qo(e,t){t===void 0&&(t=[]);let n=[];return c.Children.forEach(e,(r,s)=>{if(!c.isValidElement(r))return;let l=[...t,s];if(r.type===c.Fragment){n.push.apply(n,qo(r.props.children,l));return}r.type!==cn&&ot(!1),!r.props.index||!r.props.children||ot(!1);let a={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=qo(r.props.children,l)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oi(){return Oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Oi.apply(this,arguments)}function im(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function _x(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Rx(e,t){return e.button===0&&(!t||t==="_self")&&!_x(e)}function Xo(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function Ix(e,t){let n=Xo(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(l=>{n.append(s,l)})}),n}const Ax=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Tx=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Mx="6";try{window.__reactRouterVersion=Mx}catch{}const $x=c.createContext({isTransitioning:!1}),Fx="startTransition",Jd=Lg[Fx];function Ox(e){let{basename:t,children:n,future:r,window:s}=e,l=c.useRef();l.current==null&&(l.current=Oy({window:s,v5Compat:!0}));let a=l.current,[o,u]=c.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},m=c.useCallback(v=>{d&&Jd?Jd(()=>u(v)):u(v)},[u,d]);return c.useLayoutEffect(()=>a.listen(m),[a,m]),c.useEffect(()=>bx(r),[r]),c.createElement(Px,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:a,future:r})}const Dx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Bx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,am=c.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:l,replace:a,state:o,target:u,to:d,preventScrollReset:m,viewTransition:v}=t,g=im(t,Ax),{basename:y}=c.useContext(Vn),w,j=!1;if(typeof d=="string"&&Bx.test(d)&&(w=d,Dx))try{let p=new URL(window.location.href),x=d.startsWith("//")?new URL(p.protocol+d):new URL(d),N=xs(x.pathname,y);x.origin===p.origin&&N!=null?d=N+x.search+x.hash:j=!0}catch{}let S=ux(d,{relative:s}),h=Vx(d,{replace:a,state:o,target:u,preventScrollReset:m,relative:s,viewTransition:v});function f(p){r&&r(p),p.defaultPrevented||h(p)}return c.createElement("a",Oi({},g,{href:w||S,onClick:j||l?r:f,ref:n,target:u}))}),Wr=c.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:s=!1,className:l="",end:a=!1,style:o,to:u,viewTransition:d,children:m}=t,v=im(t,Tx),g=fa(u,{relative:v.relative}),y=qt(),w=c.useContext(em),{navigator:j,basename:S}=c.useContext(Vn),h=w!=null&&Wx(g)&&d===!0,f=j.encodeLocation?j.encodeLocation(g).pathname:g.pathname,p=y.pathname,x=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;s||(p=p.toLowerCase(),x=x?x.toLowerCase():null,f=f.toLowerCase()),x&&S&&(x=xs(x,S)||x);const N=f!=="/"&&f.endsWith("/")?f.length-1:f.length;let k=p===f||!a&&p.startsWith(f)&&p.charAt(N)==="/",L=x!=null&&(x===f||!a&&x.startsWith(f)&&x.charAt(f.length)==="/"),R={isActive:k,isPending:L,isTransitioning:h},T=k?r:void 0,z;typeof l=="function"?z=l(R):z=[l,k?"active":null,L?"pending":null,h?"transitioning":null].filter(Boolean).join(" ");let I=typeof o=="function"?o(R):o;return c.createElement(am,Oi({},v,{"aria-current":T,className:z,ref:n,style:I,to:u,viewTransition:d}),typeof m=="function"?m(R):m)});var Jo;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Jo||(Jo={}));var Zd;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Zd||(Zd={}));function Ux(e){let t=c.useContext(ua);return t||ot(!1),t}function Vx(e,t){let{target:n,replace:r,state:s,preventScrollReset:l,relative:a,viewTransition:o}=t===void 0?{}:t,u=Ln(),d=qt(),m=fa(e,{relative:a});return c.useCallback(v=>{if(Rx(v,n)){v.preventDefault();let g=r!==void 0?r:Fi(d)===Fi(m);u(e,{replace:g,state:s,preventScrollReset:l,relative:a,viewTransition:o})}},[d,u,m,r,s,n,e,l,a,o])}function om(e){let t=c.useRef(Xo(e)),n=c.useRef(!1),r=qt(),s=c.useMemo(()=>Ix(r.search,n.current?null:t.current),[r.search]),l=Ln(),a=c.useCallback((o,u)=>{const d=Xo(typeof o=="function"?o(s):o);n.current=!0,l("?"+d,u)},[l,s]);return[s,a]}function Wx(e,t){t===void 0&&(t={});let n=c.useContext($x);n==null&&ot(!1);let{basename:r}=Ux(Jo.useViewTransitionState),s=fa(e,{relative:t.relative});if(!n.isTransitioning)return!1;let l=xs(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=xs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Qo(s.pathname,a)!=null||Qo(s.pathname,l)!=null}function cm(){const[e,t]=c.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("cozygen_gallery_pending")==="1"}catch{return!1}});return c.useEffect(()=>{const n=()=>t(!0),r=()=>t(!1),s=l=>{l.key==="cozygen_gallery_pending"&&t(l.newValue==="1")};return window.addEventListener("cozygen:gallery-pending",n),window.addEventListener("cozygen:gallery-viewed",r),window.addEventListener("storage",s),()=>{window.removeEventListener("cozygen:gallery-pending",n),window.removeEventListener("cozygen:gallery-viewed",r),window.removeEventListener("storage",s)}},[]),e}const Zo="cozygen_token",Di="cozygen:auth-expired";function uu(){try{return typeof window>"u"?null:localStorage.getItem(Zo)}catch{return null}}function um(e){try{if(typeof window>"u")return;e?localStorage.setItem(Zo,e):localStorage.removeItem(Zo)}catch{}}function pi(){um(null)}function Cs(){const e=uu();return e?{Authorization:`Bearer ${e}`}:{}}function Hx(e={}){if(pi(),!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent(Di,{detail:e}))}catch{window.dispatchEvent(new Event(Di))}}const Cl=async(e,t)=>{if(t.status===401){Hx({url:e,status:t.status});const r=new Error("unauthorized");throw r.unauthorized=!0,r.status=401,r}if(!t.ok)throw new Error(`${e} failed`);return(t.headers.get("content-type")||"").includes("application/json")?t.json():t.text()},xr=async(e,t={})=>{const{signal:n}=t,r=await fetch(e,{headers:{...Cs()},credentials:"include",signal:n});return Cl(e,r)},Fr=async(e,t,n={})=>{const{signal:r}=n,s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...Cs()},body:JSON.stringify(t),credentials:"include",signal:r});return Cl(e,s)};async function Gx(e={}){return xr("/cozygen/workflows",e)}async function Kx(e,t={}){return xr(`/cozygen/workflows/${encodeURIComponent(e)}`,t)}async function ec(e,t={}){const{refresh:n=!1,cacheBust:r="",...s}=t||{},l=new URLSearchParams({type:String(e||"")});return n&&l.set("refresh","1"),r&&l.set("cache_bust",String(r)),xr(`/cozygen/get_choices?${l.toString()}`,s)}async function du(e){const t=await fetch("/prompt",{method:"POST",headers:{"Content-Type":"application/json",...Cs()},body:JSON.stringify(e),credentials:"include"});return Cl("/prompt",t)}async function Qx(e){const t=new FormData;t.append("image",e);const n=await fetch("/cozygen/upload_image",{method:"POST",headers:{...Cs()},body:t,credentials:"include"});return Cl("/cozygen/upload_image",n)}async function dm(e="",t=1,n=50,r=!1,s=!1,l="all",a="",o={}){const{includeMeta:u=!1,...d}=o||{},m=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),show_hidden:r?"1":"0",recursive:s?"1":"0",kind:l});return u&&m.set("include_meta","1"),a&&m.set("cache_bust",String(a)),xr(`/cozygen/api/gallery?${m.toString()}`,d)}async function Yx({filename:e="",subfolder:t=""}={},n={}){const r=new URLSearchParams({filename:String(e||""),subfolder:String(t||"")}),s=await fetch(`/cozygen/api/gallery/prompt?${r.toString()}`,{headers:{...Cs()},credentials:"include",signal:n==null?void 0:n.signal}),a=(s.headers.get("content-type")||"").includes("application/json")?await s.json():await s.text();if(!s.ok){const o=new Error((a==null?void 0:a.error)||"Prompt metadata not found");throw o.status=s.status,o.payload=a,o}return a}async function qx({filename:e="",subfolder:t=""}={},n={}){return Fr("/cozygen/api/gallery/delete",{filename:e,subfolder:t},n)}async function Xx(){return xr("/cozygen/api/aliases")}async function Jx(e){return Fr("/cozygen/api/aliases",e||{})}async function fm(e={}){return xr("/cozygen/api/tags/categories",e)}async function Bi({q:e="",category:t="",sort:n="count",minCount:r=0,limit:s=80,offset:l=0}={},a={}){const o=Number.isFinite(Number(r))?Math.max(0,Number(r)):0,u=new URLSearchParams({q:String(e||""),category:String(t||""),sort:String(n||"count"),limit:String(s||80),offset:String(l||0)});return o>0&&u.set("min_count",String(o)),xr(`/cozygen/api/tags/search?${u.toString()}`,a)}async function Ka(e=[],t={}){return Fr("/cozygen/api/tags/validate",{tags:Array.isArray(e)?e:[]},t)}async function Zx(e,t={}){const n=new URLSearchParams;return e&&n.set("workflow",e),xr(`/cozygen/api/workflow_presets?${n.toString()}`,t)}async function ew(e,t,n={}){return Fr("/cozygen/api/workflow_presets",{workflow:e,preset:t},n)}async function tw(e,t,n={}){return Fr("/cozygen/api/workflow_presets",{workflow:e,delete:t},n)}async function nw(e,t){return Fr("/cozygen/api/login",{username:e,password:t})}async function rw(){return fetch("/cozygen/api/auth_status",{headers:{...Cs()},credentials:"include"}).then(e=>Cl("/cozygen/api/auth_status",e))}async function sw(){return Fr("/cozygen/api/clear_cache",{})}const lw=30*60*1e3,ef="cozygen_idle_logout",pm=c.createContext(null);function iw({children:e}){const[t,n]=c.useState(!1),[r,s]=c.useState(null),[l,a]=c.useState(!1),o=c.useRef(null),u=c.useCallback(async()=>{if(!uu()){s(null),a(!1),n(!0);return}try{const y=await rw();s((y==null?void 0:y.user)||null),a(!!(y!=null&&y.default_credentials))}catch{pi(),s(null),a(!1)}finally{n(!0)}},[]);c.useEffect(()=>{u()},[u]);const d=c.useCallback(async(g,y)=>{const w=await nw(g,y);um((w==null?void 0:w.token)||""),s((w==null?void 0:w.user)||g),a(!!(w!=null&&w.default_credentials));try{localStorage.removeItem(ef)}catch{}return w},[]),m=c.useCallback(()=>{pi(),s(null),a(!1)},[]);c.useEffect(()=>{if(typeof window>"u")return;const g=()=>{m(),n(!0)};return window.addEventListener(Di,g),()=>window.removeEventListener(Di,g)},[m]),c.useEffect(()=>{if(!t)return;const g=()=>{o.current&&clearTimeout(o.current);const w=setTimeout(()=>{pi(),s(null),a(!1);try{localStorage.setItem(ef,"1")}catch{}window.location.hash="#/login"},lw);o.current=w};g();const y=["pointerdown","keydown","visibilitychange"];return y.forEach(w=>window.addEventListener(w,g,{passive:!0})),()=>{o.current&&(clearTimeout(o.current),o.current=null),y.forEach(w=>window.removeEventListener(w,g))}},[t]);const v=c.useMemo(()=>({ready:t,user:r,authed:!!r,defaultCreds:l,login:d,logout:m,refresh:u}),[t,r,l,d,m,u]);return i.jsx(pm.Provider,{value:v,children:e})}function pa(){const e=c.useContext(pm);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function aw({children:e}){return i.jsx(iw,{children:e})}const hm="cozygen_last_render_payload";function mm(e){if(e)try{if(typeof window>"u")return;window.localStorage.setItem(hm,JSON.stringify(e))}catch{}}function gm(){try{if(typeof window>"u")return null;const e=window.localStorage.getItem(hm);return e?JSON.parse(e):null}catch{return null}}async function vm(){const e=gm();if(!e||!e.workflow)return{success:!1,error:"No previous render to repeat"};try{return window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!0}})),await du({prompt:e.workflow}),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),{success:!0}}catch(t){return console.error("Failed to requeue prompt",t),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),t!=null&&t.unauthorized?(window.location.hash="#/login",{success:!1,error:"Session expired"}):{success:!1,error:"Failed to queue prompt"}}}function ym(){const e=gm();return!!(e&&e.workflow)}function fu(e,t=!1){const n=()=>typeof window>"u"||!window.matchMedia?t:window.matchMedia(e).matches,[r,s]=c.useState(n);return c.useEffect(()=>{if(typeof window>"u"||!window.matchMedia)return;const l=window.matchMedia(e),a=()=>s(l.matches);return a(),typeof l.addEventListener=="function"?(l.addEventListener("change",a),()=>l.removeEventListener("change",a)):(l.addListener(a),()=>l.removeListener(a))},[e]),r}const Q=c.forwardRef(function({as:t,href:n,variant:r,size:s="md",iconOnly:l=!1,active:a=!1,pressed:o,className:u="",type:d,...m},v){const g=t||(n?"a":"button"),y=s==="lg"?"is-lg":s==="sm"?"is-compact":s==="xs"?"is-tiny":s==="mini"?"is-mini":s==="icon"?"is-icon":"",w=r?`is-${r}`:"",h=["ui-button",y,w,l?"is-icon":"",a?"is-active":"",u].filter(Boolean).join(" "),f={ref:v,className:h,"aria-pressed":o,...m};return g==="button"?i.jsx("button",{...f,type:d||"button"}):i.jsx(g,{...f,href:n})}),xm=({size:e=32,className:t=""})=>i.jsxs("svg",{width:e,height:e,viewBox:"0 0 32 32",fill:"none",className:t,"aria-hidden":"true",children:[i.jsx("path",{d:"M8 24L20 4",stroke:"url(#logo-gradient)",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("path",{d:"M6 26C6 26 7 24 8 24C9 24 10 25 8 27C6 29 4 28 6 26Z",fill:"url(#logo-warm)"}),i.jsx("circle",{cx:"22",cy:"8",r:"2",fill:"url(#logo-spark)"}),i.jsx("circle",{cx:"26",cy:"12",r:"1.5",fill:"url(#logo-spark)",opacity:"0.8"}),i.jsx("circle",{cx:"24",cy:"16",r:"1",fill:"url(#logo-spark)",opacity:"0.6"}),i.jsxs("defs",{children:[i.jsxs("linearGradient",{id:"logo-gradient",x1:"8",y1:"24",x2:"20",y2:"4",gradientUnits:"userSpaceOnUse",children:[i.jsx("stop",{stopColor:"#FF9F7A"}),i.jsx("stop",{offset:"0.5",stopColor:"#9F8CFF"}),i.jsx("stop",{offset:"1",stopColor:"#44E1C5"})]}),i.jsxs("linearGradient",{id:"logo-warm",x1:"4",y1:"24",x2:"10",y2:"28",gradientUnits:"userSpaceOnUse",children:[i.jsx("stop",{stopColor:"#FF9F7A"}),i.jsx("stop",{offset:"1",stopColor:"#FFD666"})]}),i.jsxs("radialGradient",{id:"logo-spark",cx:"0.3",cy:"0.3",r:"0.7",children:[i.jsx("stop",{stopColor:"#FFFFFF"}),i.jsx("stop",{offset:"0.5",stopColor:"#44E1C5"}),i.jsx("stop",{offset:"1",stopColor:"#9F8CFF"})]})]})]}),st=({children:e,size:t=16,className:n="",...r})=>i.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,"aria-hidden":"true",...r,children:e}),ow=e=>i.jsxs(st,{...e,children:[i.jsx("path",{d:"M3 10l9-7 9 7"}),i.jsx("path",{d:"M5 10v10h14V10"}),i.jsx("path",{d:"M9 20v-6h6v6"})]}),pu=e=>i.jsxs(st,{...e,children:[i.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),i.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor",stroke:"none"}),i.jsx("path",{d:"M21 15l-5-5L5 21"})]}),pr=e=>i.jsxs(st,{...e,children:[i.jsx("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"}),i.jsx("line",{x1:"7",y1:"7",x2:"7.01",y2:"7",strokeWidth:"3"})]}),El=e=>i.jsxs(st,{...e,children:[i.jsx("path",{d:"M14 3H4a2 2 0 00-2 2v10l6 6h10a2 2 0 002-2V9l-6-6z"}),i.jsx("path",{d:"M14 3v6h6"}),i.jsx("path",{d:"M7 7h5"}),i.jsx("path",{d:"M7 11h7"})]}),hu=e=>i.jsx(st,{...e,children:i.jsx("path",{d:"M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"})}),wm=e=>i.jsx(st,{...e,children:i.jsx("polygon",{points:"5 3 19 12 5 21 5 3",fill:"currentColor",stroke:"none"})}),tf=e=>i.jsxs(st,{...e,children:[i.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"}),i.jsx("polyline",{points:"16 17 21 12 16 7"}),i.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),mu=e=>i.jsxs(st,{...e,children:[i.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),i.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),i.jsx("line",{x1:"15",y1:"9",x2:"15",y2:"15"}),i.jsx("circle",{cx:"9",cy:"12",r:"1.5",fill:"currentColor",stroke:"none"}),i.jsx("circle",{cx:"15",cy:"10",r:"1.5",fill:"currentColor",stroke:"none"})]}),cw=e=>i.jsxs(st,{...e,children:[i.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),i.jsx("circle",{cx:"12",cy:"12",r:"4"}),i.jsx("line",{x1:"3",y1:"9",x2:"6",y2:"9"})]}),tc=e=>i.jsxs(st,{...e,children:[i.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"}),i.jsx("path",{d:"M2 10h20"})]}),nf=e=>i.jsx(st,{...e,children:i.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"})}),rf=e=>i.jsxs(st,{...e,children:[i.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),i.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),sf=e=>i.jsxs(st,{...e,children:[i.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),i.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),lf=e=>i.jsx(st,{...e,children:i.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),af=e=>i.jsxs(st,{...e,children:[i.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),i.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),nc=e=>i.jsxs(st,{...e,children:[i.jsx("polyline",{points:"23 4 23 10 17 10"}),i.jsx("path",{d:"M20.49 15a9 9 0 11-2.12-9.36L23 10"})]}),Sm=e=>i.jsx(st,{...e,children:i.jsx("polyline",{points:"15 18 9 12 15 6"})}),ha=e=>i.jsx(st,{...e,children:i.jsx("polyline",{points:"9 18 15 12 9 6"})}),rc=e=>i.jsxs(st,{...e,children:[i.jsx("circle",{cx:"9",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),i.jsx("circle",{cx:"15",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),i.jsx("circle",{cx:"9",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),i.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),i.jsx("circle",{cx:"9",cy:"18",r:"1",fill:"currentColor",stroke:"none"}),i.jsx("circle",{cx:"15",cy:"18",r:"1",fill:"currentColor",stroke:"none"})]}),hr=e=>i.jsxs(st,{...e,children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),of=e=>i.jsxs(st,{...e,children:[i.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",strokeDasharray:"4 2"}),i.jsx("line",{x1:"9",y1:"12",x2:"15",y2:"12"})]}),uw=e=>i.jsxs(st,{...e,children:[i.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),i.jsx("polyline",{points:"5 12 12 5 19 12"})]}),dw=e=>i.jsxs(st,{...e,children:[i.jsx("circle",{cx:"6",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),i.jsx("circle",{cx:"12",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),i.jsx("circle",{cx:"18",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"})]}),fw=e=>i.jsxs(st,{...e,children:[i.jsx("rect",{x:"9",y:"9",width:"10",height:"10",rx:"2"}),i.jsx("path",{d:"M7 15H6a2 2 0 01-2-2V6a2 2 0 012-2h7"})]}),cf=[{to:"/studio",label:"Studio",Icon:ow,end:!0},{to:"/controls",label:"Controls",Icon:mu}],pw=[{to:"/gallery",label:"Gallery",Icon:pu},{to:"/tags",label:"Tag Library",Icon:pr},{to:"/aliases",label:"Aliases",Icon:El}],Ts=({isActive:e})=>["slim-nav-link btn-touch",e?"is-active":null].filter(Boolean).join(" ");function hw({isMobileAlignedNav:e=!1}){const[t,n]=c.useState(!1),{pathname:r}=qt(),s=cm(),{logout:l,user:a}=pa(),[o,u]=c.useState(!1),d=fu("(min-width: 768px)"),m=c.useRef(null),v=c.useRef(null),g=()=>n(k=>!k),y=()=>n(!1),w=r==="/login",j=d&&!e,S=!w&&j,h=j,f=!d||e;c.useEffect(()=>{const k=L=>{var T;const R=!!((T=L==null?void 0:L.detail)!=null&&T.active);u(R)};return window.addEventListener("cozygen:render-state",k),()=>window.removeEventListener("cozygen:render-state",k)},[]),c.useEffect(()=>{if(!t)return;const k=L=>{m.current&&!m.current.contains(L.target)&&v.current&&!v.current.contains(L.target)&&y()};return document.addEventListener("mousedown",k),document.addEventListener("touchstart",k),()=>{document.removeEventListener("mousedown",k),document.removeEventListener("touchstart",k)}},[t]);const p=async()=>{if(o)return;if(r==="/controls"||r==="/compose"){try{window.dispatchEvent(new Event("cozygen:request-render"))}catch{}return}if(!ym()){alert("No previous render found yet. Render once from Studio first.");return}u(!0);const R=await vm();u(!1),R!=null&&R.success||alert((R==null?void 0:R.error)||"Failed to render.")},x=()=>{try{l()}catch{}window.location.hash="#/login"},N=[...cf,...pw];return i.jsxs("header",{className:"top-bar",children:[i.jsx("div",{className:"top-bar-shell",children:i.jsxs("div",{className:"brand-row",children:[i.jsxs(am,{to:"/studio",className:"brand-mark",onClick:y,children:[i.jsx(xm,{size:28,className:"brand-logo"}),i.jsx("span",{className:"brand-text",children:"CozyGen"})]}),j?i.jsx("nav",{className:"desktop-nav","aria-label":"Main navigation",children:N.map(k=>i.jsx(Wr,{to:k.to,end:k.end,className:Ts,children:i.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[i.jsx(k.Icon,{size:16}),i.jsx("span",{children:k.label}),k.to==="/gallery"&&s?i.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})},k.to))}):null,i.jsx("div",{className:"flex-1"}),S?i.jsxs(Q,{variant:"primary",size:"sm",onClick:p,title:o?"Rendering":"Render","aria-busy":o,"aria-disabled":o,disabled:o,children:[i.jsx("span",{className:"inline-flex items-center justify-center",children:o?i.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):i.jsx(wm,{size:16})}),i.jsx("span",{children:o?"Rendering":"Render"})]}):null,h?i.jsxs(Q,{variant:"muted",size:"sm",onClick:x,title:"Sign out",children:[i.jsx("span",{className:"inline-flex items-center justify-center",children:i.jsx(tf,{size:16})}),i.jsx("span",{children:"Logout"}),a?i.jsxs("span",{className:"text-xs text-[#9DA3FFB3]",children:["@",a]}):null]}):null,f?i.jsx("button",{ref:v,type:"button",className:`mobile-menu-toggle btn-touch ${t?"is-active":""}`,onClick:g,"aria-expanded":t,"aria-controls":"cozygen-mobile-nav","aria-label":t?"Close menu":"Open menu",children:i.jsx("span",{className:"mobile-menu-icon",children:i.jsx("span",{})})}):null]})}),f?i.jsxs("div",{ref:m,id:"cozygen-mobile-nav",className:`mobile-nav-drawer ${t?"is-open":""}`,role:"menu",children:[i.jsxs("div",{className:"mobile-nav-section",children:[cf.map(k=>i.jsx(Wr,{to:k.to,end:k.end,className:Ts,onClick:y,role:"menuitem",children:i.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.jsx(k.Icon,{size:16}),i.jsx("span",{children:k.label})]})},k.to)),i.jsx(Wr,{to:"/gallery",className:Ts,onClick:y,role:"menuitem",children:i.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.jsx(pu,{size:16}),i.jsx("span",{children:"Gallery"}),s?i.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})})]}),i.jsxs("div",{className:"mobile-nav-section secondary",children:[i.jsx(Wr,{to:"/tags",className:Ts,onClick:y,role:"menuitem",children:i.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.jsx(pr,{size:16}),i.jsx("span",{children:"Tag Library"})]})}),i.jsx(Wr,{to:"/aliases",className:Ts,onClick:y,role:"menuitem",children:i.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.jsx(El,{size:16}),i.jsx("span",{children:"Aliases"})]})}),i.jsx("button",{type:"button",className:"slim-nav-link btn-touch text-left",onClick:()=>{y(),x()},role:"menuitem",children:i.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.jsx(tf,{size:16}),i.jsx("span",{children:"Logout"}),a?i.jsxs("span",{className:"text-[rgba(159,178,215,0.75)] text-xs",children:["@",a]}):null]})})]})]}):null]})}const uf=[{to:"/controls",label:"Controls",Icon:mu},{to:"/compose",label:"Compose",Icon:hu},{to:"/gallery",label:"Gallery",Icon:pu}],mw=[{to:"/aliases",label:"Aliases",Icon:El},{to:"/tags",label:"Tags",Icon:pr}],gw=({isActive:e})=>["bottom-nav-link",e?"is-active":""].filter(Boolean).join(" ");function vw(){const e=qt(),t=Ln(),n=cm(),[r,s]=Zt.useState(!1),[l,a]=Zt.useState(!1),[o,u]=Zt.useState(!1),[d,m]=Zt.useState({}),v=fu("(min-width: 768px)"),g=Zt.useRef(null),y=Zt.useRef(null),w=e.pathname==="/controls",j=e.pathname==="/compose",S=async()=>{if(!(typeof window>"u")&&!l)if(s(!0),setTimeout(()=>s(!1),400),w||j)try{window.dispatchEvent(new CustomEvent("cozygen:request-render"))}catch{}else{if(!ym())return;const f=await vm();f.success||console.warn("Requeue failed:",f.error)}};Zt.useEffect(()=>{const f=p=>{var N;const x=!!((N=p==null?void 0:p.detail)!=null&&N.active);a(x),x&&(s(!0),setTimeout(()=>s(!1),400))};return window.addEventListener("cozygen:render-state",f),()=>window.removeEventListener("cozygen:render-state",f)},[]),Zt.useEffect(()=>{if(!o||v)return;const f=p=>{g.current&&g.current.contains(p.target)||y.current&&y.current.contains(p.target)||u(!1)};return window.addEventListener("pointerdown",f),()=>window.removeEventListener("pointerdown",f)},[o,v]),Zt.useEffect(()=>{if(!o||v||!y.current)return;const f=y.current.getBoundingClientRect(),p=f.left+f.width/2,x=window.innerHeight-f.top+8;m({left:`${Math.min(window.innerWidth-80,Math.max(40,p))}px`,bottom:`${x}px`,top:"auto"})},[o,v]),Zt.useEffect(()=>{v&&u(!1)},[v]);const h=v?[...uf,...mw]:uf;return i.jsxs(i.Fragment,{children:[i.jsxs("nav",{className:"bottom-nav","aria-label":"Bottom navigation",children:[h.map(f=>i.jsxs(Wr,{to:f.to,end:f.end,className:gw,children:[i.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:i.jsx(f.Icon,{size:20})}),i.jsxs("span",{className:"bottom-nav-label",children:[f.label,f.to==="/gallery"&&n?i.jsx("span",{className:"badge-dot pulse","aria-hidden":"true"}):null]})]},f.to)),v?null:i.jsxs("button",{ref:y,type:"button",className:"bottom-nav-link",onClick:()=>u(f=>!f),"aria-expanded":o,"aria-label":"Open library",children:[i.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:i.jsx(pr,{size:20})}),i.jsx("span",{className:"bottom-nav-label",children:"Library"})]},"library"),i.jsxs("button",{type:"button",className:`bottom-nav-link is-action ${r?"is-flash":""} ${l?"is-rendering":""}`,onClick:S,"aria-label":"Render","aria-busy":l,"aria-disabled":l,disabled:l,children:[i.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:i.jsx(wm,{size:20})}),i.jsx("span",{className:"bottom-nav-label",children:"Render"})]},"render")]}),v?null:i.jsxs("div",{ref:g,className:`library-popover ${o?"is-open":""}`,style:d,children:[i.jsxs(Q,{size:"sm",variant:"ghost",className:"w-[120px] flex-col gap-1",onClick:()=>{u(!1),t("/aliases")},children:[i.jsx(El,{size:18}),i.jsx("span",{className:"text-[0.65rem]",children:"Aliases"})]}),i.jsxs(Q,{size:"sm",variant:"ghost",className:"w-[120px] flex-col gap-1",onClick:()=>{u(!1),t("/tags")},children:[i.jsx(pr,{size:18}),i.jsx("span",{className:"text-[0.65rem]",children:"Tags"})]})]})]})}function yw(e,t){if(!t||t<=0)return null;const n=Number(e)||0,r=Number(t)||0,s=Math.round(n/r*100);return Number.isFinite(s)?Math.max(0,Math.min(100,s)):null}function xw({busy:e=!1,progressValue:t=0,progressMax:n=0,statusText:r="Idle",statusPhase:s="idle",primaryLabel:l="Render",onPrimary:a,primaryDisabled:o=!1,onLogs:u,logsLabel:d="Logs"}){const m=yw(t,n),v=s==="queued"?"rgba(255, 143, 112, 0.95)":s==="running"?"rgba(68, 225, 197, 0.95)":s==="finished"?"rgba(92, 255, 154, 0.95)":s==="error"?"rgba(255, 143, 112, 0.95)":"rgba(159, 178, 215, 0.55)",y={idle:"Idle",queued:"Queued",running:"Running",finished:"Finished",error:"Error"}[s]||"Status",w=e||o;return i.jsxs("div",{className:"dock-bar-inner",children:[i.jsx(Q,{variant:"primary",size:"lg",className:"w-full",onClick:a,disabled:w,children:e?"Rendering":l}),i.jsxs("div",{className:"dock-status-row",children:[i.jsxs("span",{className:"dock-status-left",children:[i.jsx("span",{className:"dock-status-dot",style:{background:v}}),i.jsx("span",{className:"dock-status-label",children:y})]}),i.jsxs("span",{className:"dock-status-right",children:[m!=null&&e?i.jsxs("span",{className:"dock-progress",children:[i.jsx("span",{className:"dock-progress-bar","aria-hidden":"true",children:i.jsx("span",{className:"dock-progress-fill",style:{width:`${m}%`}})}),i.jsxs("span",{children:[m,"%"]})]}):null,i.jsx("span",{className:"dock-status-text",children:r||(e?"Working":"Idle")}),u?i.jsx(Q,{size:"xs",variant:"ghost",onClick:u,children:d}):null]})]})]})}const jm="jpg,jpeg,png,webp,gif,bmp,tif,tiff",gu=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),km=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);async function Qa({subfolder:e="",page:t=1,perPage:n=50,exts:r=jm,signal:s}={}){const l=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),exts:r}),a=await fetch(`/cozygen/input?${l.toString()}`,{signal:s});if(!a.ok)throw new Error(`Input list failed: ${a.status}`);return a.json()}const Ui=e=>`/cozygen/input/file?path=${encodeURIComponent(e)}`,sc="output::",ma=(e="")=>e.replace(/\\/g,"/").replace(/^\/+/,"").replace(/\/+$/,""),Nm=(e="")=>{const t=e.replace(/\\/g,"/").split("/").filter(Boolean);return t[t.length-1]||""},ww=({subfolder:e="",filename:t=""}={})=>{const n=Nm(t);if(!n)return"";const r=ma(e);return`${sc}${r}::${n}`},lc=(e="")=>{if(typeof e!="string"||!e.startsWith(sc))return null;const t=e.slice(sc.length);if(!t)return null;const n=t.lastIndexOf("::"),r=n===-1?t:t.slice(n+2);return r?{subfolder:n===-1?"":t.slice(0,n),filename:r}:null},Vi=({filename:e="",subfolder:t="",type:n="output"}={})=>{const r=Nm(e);return r?`/view?${new URLSearchParams({filename:r,subfolder:ma(t),type:n||"output"}).toString()}`:""},ic=(e="")=>e.split("/").slice(0,-1).join("/"),Sw=e=>{if(typeof e!="string"||!e)return e!=null&&e.path?ic(e.path):"";const t=lc(e);return t?ma(t.subfolder):ic(e)},df=(e=[])=>e.map(t=>{const n=t.rel_path||t.name||"",r=t.name||n||"Untitled",s=!!t.is_dir,l=s?"":Ui(n);return{...t,name:r,rel_path:n,is_dir:s,is_image:!s&&gu(r),is_video:!s&&km(r),source:"input",preview_url:l}}),jw=(e=[])=>e.map(t=>{const n=t.filename||"",r=t.subfolder||"",s=t.type==="directory",l=s?r||n:[r,n].filter(Boolean).join("/"),a=n||r||l||"Untitled",o=s?"":Vi({filename:n,subfolder:r,type:t.type});return{...t,name:a,rel_path:l,is_dir:s,is_image:!s&&gu(n),is_video:!s&&km(n),source:"output",preview_url:o}}),wr={get(e,t){try{return(typeof window<"u"?JSON.parse(localStorage.getItem(e)):null)??t}catch{return t}},set(e,t){try{typeof window<"u"&&localStorage.setItem(e,JSON.stringify(t))}catch{}}};function kw({input:e,value:t,onFormChange:n}){var W;const r=((W=e==null?void 0:e.inputs)==null?void 0:W.param_name)||"Image Input",s=(e==null?void 0:e.class_type)||"CozyGenImageInput",l=`cg_last_input_cwd::${r}`,a=`cg_last_picker_source::${r}`,[o,u]=c.useState(""),[d,m]=c.useState(!1),[v,g]=c.useState(!1),[y,w]=c.useState(wr.get(l,"")),[j,S]=c.useState(1),[h,f]=c.useState(50),[p,x]=c.useState([]),[N,k]=c.useState(1),[L,R]=c.useState(!1),[T,z]=c.useState(""),[I,X]=c.useState([]),[Y,be]=c.useState(!0),ve=c.useRef(null),[ae,de]=c.useState(()=>wr.get(a,"inputs")==="outputs"?"outputs":"inputs"),_=ae,C=c.useCallback(O=>{const U=O==="outputs"?"outputs":"inputs";de(U),wr.set(a,U),w(""),S(1)},[]),$=c.useMemo(()=>{if(o)try{const O=new URL(o,window.location.origin);return(O.searchParams.get("path")||O.searchParams.get("filename")||O.pathname.split("/").pop()||"").split("/").pop()||"No file selected."}catch{}if(!t)return"No file selected.";if(typeof t=="string"){const O=lc(t);return O!=null&&O.filename?O.filename.split("/").pop():t.split("/").pop()}return t!=null&&t.path?t.path.split("/").pop():"No file selected."},[o,t]);c.useEffect(()=>{if(typeof t=="string"&&t){const O=lc(t);O!=null&&O.filename?u(Vi({filename:O.filename,subfolder:O.subfolder,type:"output"})):u(Ui(t)),m(!1)}else t!=null&&t.url?(u(t.url),m(!1)):(u(""),m(!1))},[t]);const P=c.useCallback(async O=>{const U=await Qx(O),ue=`/view?filename=${U.filename}&type=input`;u(ue),m(!1),wr.set(l,""),s==="CozyGenImageInput"?n(r,U.filename):n(r,{source:"Upload",path:U.filename,url:ue})},[s,n,r]),D=c.useCallback(()=>{u(""),m(!1),s==="CozyGenImageInput"?n(r,""):n(r,{source:"Upload",path:"",url:""})},[s,n,r]),H=c.useCallback(()=>{const U=Sw(t)||wr.get(l,"");w(U),S(1),g(!0)},[t]),le=c.useCallback(()=>{g(!1)},[]);c.useEffect(()=>{if(v){if(_!=="inputs"){X([]);return}(async()=>{try{const O=await Qa({subfolder:"",page:1,perPage:0,exts:""});X((O.items||[]).filter(U=>U.is_dir))}catch{}})()}},[v,_]),c.useEffect(()=>{if(!v)return;let O=!1;ve.current&&ve.current.abort();const U=new AbortController;ve.current=U;async function ue(){R(!0);try{if(_==="outputs"){const xe=await dm(y,j,h,!1,!1,"all","",{signal:U.signal});if(O)return;const ze=jw(xe&&xe.items||[]);O||(x(ze),k(xe&&xe.total_pages||1))}else{const ze=await Qa({subfolder:y,page:j,perPage:h,exts:Y?jm:"",signal:U.signal}),Ae=(ze.items||[]).some(Le=>!Le.is_dir);if(Y&&!Ae){const Le=await Qa({subfolder:y,page:j,perPage:h,exts:"",signal:U.signal});O||(x(df(Le.items||[])),k(Le.total_pages||1),be(!1));return}O||(x(df(ze.items||[])),k(ze.total_pages||1))}}catch(xe){if((xe==null?void 0:xe.name)==="AbortError")return;console.error(_==="outputs"?"Failed to load output directory":"Failed to load input directory",xe),O||(x([]),k(1))}finally{O||R(!1)}}return ue(),()=>{O=!0,ve.current===U&&(ve.current=null),U.abort()}},[v,y,j,h,Y,_]);const Z=c.useDeferredValue(T),ee=c.useMemo(()=>{const O=Z.trim().toLowerCase();let U=p;return Y&&(U=U.filter(ue=>{if(ue.is_dir)return!0;const xe=ue.name||ue.filename||ue.rel_path||"";return gu(String(xe))})),O?U.filter(ue=>(ue.name||ue.filename||ue.rel_path||"").toLowerCase().includes(O)):U},[p,Z,Y]),ce=c.useCallback(O=>{if(!O)return;const U=typeof O=="object"?O:null;if(((U==null?void 0:U.source)||"inputs")==="output"){const Ae=ww({subfolder:(U==null?void 0:U.subfolder)||"",filename:(U==null?void 0:U.filename)||(U==null?void 0:U.name)||""});if(!Ae)return;const Le=(U==null?void 0:U.preview_url)||Vi({filename:U==null?void 0:U.filename,subfolder:U==null?void 0:U.subfolder,type:U==null?void 0:U.type});u(Le),m(!1),wr.set(l,ma((U==null?void 0:U.subfolder)||"")),s==="CozyGenImageInput"?n(r,Ae):n(r,{source:"OutputGallery",path:Ae,url:Le}),g(!1);return}const xe=typeof O=="string"?O:(U==null?void 0:U.rel_path)||(U==null?void 0:U.path)||"";if(!xe)return;const ze=(U==null?void 0:U.preview_url)||Ui(xe);u(ze),m(!1),wr.set(l,ic(xe)),s==="CozyGenImageInput"?n(r,xe):n(r,{source:"Server",path:xe,url:ze}),g(!1)},[s,n,r]);return{param:r,previewUrl:o,imgReady:d,setImgReady:m,displayName:$,serverOpen:v,openServer:H,closeServer:le,cwd:y,setCwd:w,page:j,setPage:S,perPage:h,setPerPage:f,totalPages:N,loading:L,search:T,setSearch:z,topDirs:I,imagesOnly:Y,setImagesOnly:be,shownEntries:ee,pickerSource:_,setPickerSource:C,handleUpload:P,clearImage:D,selectServer:ce}}function Ut({open:e,onClose:t,title:n,children:r,footer:s,variant:l="sheet",className:a="",contentClassName:o="",shouldCloseOnOverlayClick:u=!0,shouldCloseOnEsc:d=!0}){const m=c.useRef(!1),v=c.useRef(null),g=c.useRef(null),y=S=>S?Array.from(S.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(h=>!h.hasAttribute("disabled")&&h.getAttribute("aria-hidden")!=="true"):[],w=c.useMemo(()=>["bottom-sheet-content",l==="fullscreen"?"is-fullscreen":"is-sheet",o].filter(Boolean).join(" "),[o,l]),j=c.useMemo(()=>["bottom-sheet-overlay",a].filter(Boolean).join(" "),[a]);return c.useEffect(()=>{if(!e||!d)return;const S=h=>{h.key==="Escape"&&(t==null||t())};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[e,t,d]),c.useEffect(()=>{if(!e||typeof document>"u")return;const S=v.current;g.current=document.activeElement;const h=()=>{var N;const x=y(S)[0]||S;(N=x==null?void 0:x.focus)==null||N.call(x)},f=p=>{if(p.key!=="Tab"||!S)return;const x=y(S);if(!x.length){p.preventDefault(),S.focus();return}const N=x[0],k=x[x.length-1],L=document.activeElement;p.shiftKey&&L===N?(p.preventDefault(),k.focus()):!p.shiftKey&&L===k&&(p.preventDefault(),N.focus())};return requestAnimationFrame(h),S==null||S.addEventListener("keydown",f),()=>{var x;S==null||S.removeEventListener("keydown",f);const p=g.current;p&&document.contains(p)&&((x=p.focus)==null||x.call(p))}},[e]),!e||typeof document>"u"?null:iu.createPortal(i.jsx("div",{className:j,role:"presentation",onPointerDown:S=>{m.current=S.target===S.currentTarget},onClick:S=>{u&&m.current&&S.target===S.currentTarget&&(t==null||t())},children:i.jsx("div",{ref:v,className:w,role:"dialog","aria-modal":"true","aria-label":n||"Sheet",onClick:S=>S.stopPropagation(),tabIndex:-1,children:i.jsxs("div",{className:"bottom-sheet-panel",children:[i.jsxs("header",{className:"bottom-sheet-head",children:[i.jsx("div",{className:"bottom-sheet-title",children:n||""}),i.jsx("button",{type:"button",className:"bottom-sheet-close",onClick:t,"aria-label":"Close",children:i.jsx(hr,{size:16})})]}),i.jsx("div",{className:"bottom-sheet-body",children:r}),s?i.jsx("footer",{className:"bottom-sheet-foot",children:s}):null]})})}),document.body)}function Nw({items:e=[],value:t,onChange:n,ariaLabel:r,role:s="tablist",className:l="",tabClassName:a="",size:o="md",layout:u="equal",wrap:d=!1}){const m=["segmented-tabs",o==="sm"?"is-compact":"",u==="auto"?"is-auto":"",u==="icon"?"is-icon":"",d?"is-wrap":"",l].filter(Boolean).join(" "),v=s==="tablist"?"tab":"button",g=c.useRef([]);c.useEffect(()=>{g.current=g.current.slice(0,e.length)},[e.length]);const y=c.useMemo(()=>e.map((p,x)=>p.disabled?null:x).filter(p=>p!==null),[e]),w=c.useMemo(()=>e.findIndex(p=>p.key===t&&!p.disabled),[e,t]),j=y.length?y[0]:-1,S=w>=0?w:j,h=p=>{var N;const x=g.current[p];(N=x==null?void 0:x.focus)==null||N.call(x)},f=(p,x)=>{var k;if(!e.length)return p;let N=p;for(let L=0;L<e.length;L+=1)if(N=(N+x+e.length)%e.length,!((k=e[N])!=null&&k.disabled))return N;return p};return i.jsx("div",{className:m,role:s,"aria-label":r,children:e.map((p,x)=>{const N=p.key===t,k=p.label?String(p.label):"";return i.jsxs("button",{type:"button",ref:L=>{g.current[x]=L},role:v,"aria-selected":s==="tablist"?N:void 0,"aria-pressed":s!=="tablist"?N:void 0,"aria-controls":s==="tablist"?p.controls:void 0,className:["segmented-tab",N?"is-active":"",p.icon&&!k?"is-icon":"",p.className||"",a].filter(Boolean).join(" "),onClick:()=>{p.disabled||n==null||n(p.key)},onKeyDown:L=>{if(s!=="tablist"||!["ArrowRight","ArrowLeft","Home","End"].includes(L.key)||(L.preventDefault(),!e.length))return;let R=x;L.key==="Home"?R=y.length?y[0]:R:L.key==="End"?R=y.length?y[y.length-1]:R:L.key==="ArrowRight"?R=f(R,1):L.key==="ArrowLeft"&&(R=f(R,-1));const T=e[R];!T||T.disabled||(n==null||n(T.key),h(R))},disabled:p.disabled,title:p.title||k||p.ariaLabel,"aria-label":p.ariaLabel,tabIndex:s==="tablist"?x===S?0:-1:void 0,children:[p.icon?i.jsx("span",{className:"segmented-tab-icon",children:p.icon}):null,k?i.jsx("span",{className:"segmented-tab-label",children:k}):null,p.badge?i.jsx("span",{className:"segmented-tab-badge",children:p.badge}):null]},p.key)})})}const Pr=c.memo(Nw),Cw=(e=[])=>(e||[]).map(t=>typeof t=="string"||typeof t=="number"?{value:t,label:String(t)}:{value:(t==null?void 0:t.value)??(t==null?void 0:t.id)??"",label:(t==null?void 0:t.label)??(t==null?void 0:t.name)??String((t==null?void 0:t.value)??""),disabled:!!(t!=null&&t.disabled)}),Ew=(e,t)=>{if(!t)return e;const n=t.trim().toLowerCase();return n?e.filter(r=>{const s=String(r.label||"").toLowerCase(),l=String(r.value||"").toLowerCase();return s.includes(n)||l.includes(n)}):e};function bw({value:e,onChange:t,options:n,children:r,placeholder:s,emptyLabel:l="No matches",disabled:a=!1,size:o="md",className:u="",wrapperClassName:d="",searchable:m=!1,searchThreshold:v=0,searchPlaceholder:g="Search options...",searchValue:y,onSearchChange:w,searchAriaLabel:j="Search options",...S}){const[h,f]=c.useState(""),p=typeof y=="string"?y:h,x=w||f,N=c.useMemo(()=>Cw(n),[n]),k=m||typeof v=="number"&&v>0&&N.length>v,L=c.useMemo(()=>k?Ew(N,p):N,[N,p,k]),R=["ui-control","ui-select",o==="sm"?"is-compact":"",u,k?"":d].filter(Boolean).join(" "),T=()=>r||(L.length?L.map(I=>i.jsx("option",{value:I.value,disabled:I.disabled,children:I.label},String(I.value))):i.jsx("option",{value:"",disabled:!0,children:l})),z=i.jsxs("select",{...S,className:R,value:e??"",onChange:I=>t==null?void 0:t(I.target.value),disabled:a,children:[s?i.jsx("option",{value:"",children:s}):null,T()]});return k?i.jsxs("div",{className:["ui-select-stack",d].filter(Boolean).join(" "),children:[i.jsx("input",{type:"search",value:p,onChange:I=>x(I.target.value),placeholder:g,className:"ui-control ui-input is-compact","aria-label":j,disabled:a}),z]}):z}const rt=c.memo(bw);function Lw({open:e,cwd:t,setCwd:n,page:r,setPage:s,perPage:l,setPerPage:a,totalPages:o,topDirs:u,loading:d,imagesOnly:m,setImagesOnly:v,search:g,setSearch:y,shownEntries:w,onSelect:j,onClose:S,pickerSource:h,setPickerSource:f}){if(!e)return null;const p=h||"inputs",x=typeof f=="function",N=()=>{n(""),s(1)},k=I=>{x&&I!==p&&(f(I),n(""),s(1))},L=t.split("/").filter(Boolean),R=p==="outputs"?"Choose output":"Choose input",T=[{key:"",label:"Root"},...u.map(I=>({key:I.rel_path,label:I.name}))],z=I=>{n(I),s(1)};return i.jsx(Ut,{open:e,onClose:S,title:R,variant:"fullscreen",footer:i.jsxs("div",{className:"flex items-center gap-2 w-full",children:[i.jsx(Q,{variant:"muted",className:"w-full",disabled:r<=1||d,onClick:()=>s(I=>Math.max(1,I-1)),children:"Prev"}),i.jsxs("div",{className:"text-xs text-center text-[rgba(159,178,215,0.75)] min-w-[92px]",children:[r," / ",o]}),i.jsx(Q,{variant:"muted",className:"w-full",disabled:r>=o||d,onClick:()=>s(I=>I<o?I+1:I),children:"Next"})]}),children:i.jsxs("div",{className:"sheet-stack",children:[i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Location"}),i.jsxs("div",{className:"imagepicker-breadcrumb",children:[i.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:N,children:"Root"}),L.map((I,X)=>{const Y=L.slice(0,X+1).join("/");return i.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:()=>{n(Y),s(1)},children:I},Y)})]})]}),x?i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Source"}),i.jsx(Pr,{ariaLabel:"Source",value:p,onChange:k,size:"sm",items:[{key:"inputs",label:"Inputs"},{key:"outputs",label:"Outputs"}]})]}):null,i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Filters"}),i.jsxs("div",{className:"composer-filters",children:[i.jsxs("label",{className:"inline-flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:m,onChange:I=>{v(I.target.checked),s(1)}}),i.jsx("span",{className:"text-sm text-[rgba(159,178,215,0.85)]",children:"Images only"})]}),i.jsx("input",{type:"search",value:g,onChange:I=>y(I.target.value),placeholder:"Search files",className:"sheet-input ui-control ui-input","aria-label":"Search files"}),i.jsx(rt,{value:l,onChange:I=>{const X=parseInt(I,10)||50;a(X),s(1)},"aria-label":"Items per page",size:"sm",options:[25,50,100]})]})]}),u.length>0?i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Quick folders"}),i.jsx(Pr,{ariaLabel:"Quick folders",value:t,onChange:z,size:"sm",layout:"auto",wrap:!0,className:"imagepicker-chips",items:T})]}):null,i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Results"}),d?i.jsxs("div",{className:"sheet-hint",children:["Scanning ",p==="outputs"?"output":"input"," folders"]}):w.length===0?i.jsx("div",{className:"sheet-hint",children:"Nothing here yet. Try a different folder or turn off Images only."}):null,i.jsx("div",{className:"imagepicker-grid",children:!d&&w.map(I=>{const X=`${I.source||"input"}::${I.rel_path||I.name}`,Y=I.is_dir?"":I.preview_url||(I.source==="output"?Vi({filename:I.filename,subfolder:I.subfolder,type:I.type}):Ui(I.rel_path||""));return i.jsx("button",{type:"button",className:`imagepicker-item ${I.is_dir?"is-dir":""}`,onClick:()=>{I.is_dir?(n(I.rel_path||""),s(1)):j(I)},children:I.is_dir?i.jsxs("div",{className:"imagepicker-dir-row",children:[i.jsx("div",{className:"imagepicker-dir-dot","aria-hidden":"true"}),i.jsx("div",{className:"imagepicker-name",children:I.name})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"imagepicker-thumb",children:Y?i.jsx("img",{className:"imagepicker-img",alt:I.name,src:Y}):i.jsx("div",{className:"imagepicker-img is-placeholder"})}),i.jsx("div",{className:"imagepicker-name",children:I.name})]})},X)})})]})]})})}function Pw({open:e,onClose:t,title:n,url:r,kind:s="image"}){return r?i.jsx(Ut,{open:e,onClose:t,title:n||"Preview",variant:"fullscreen",footer:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Q,{href:r,target:"_blank",rel:"noreferrer",variant:"muted",className:"w-full text-center",children:"Open"}),i.jsx(Q,{variant:"primary",className:"w-full",onClick:t,children:"Close"})]}),children:i.jsx("div",{className:"url-viewer-stage",children:s==="video"?i.jsx("video",{src:r,controls:!0,className:"url-viewer-media",autoPlay:!0}):i.jsx("img",{src:r,alt:n||"Preview",className:"url-viewer-media"})})}):null}function zw({input:e,value:t,onFormChange:n}){const{previewUrl:r,imgReady:s,setImgReady:l,displayName:a,serverOpen:o,openServer:u,closeServer:d,cwd:m,setCwd:v,page:g,setPage:y,perPage:w,setPerPage:j,totalPages:S,topDirs:h,loading:f,search:p,setSearch:x,imagesOnly:N,setImagesOnly:k,shownEntries:L,pickerSource:R,setPickerSource:T,handleUpload:z,clearImage:I,selectServer:X}=kw({input:e,value:t,onFormChange:n}),Y=c.useRef(null),be=c.useRef(null),[ve,ae]=c.useState(0),[de,_]=c.useState(!1);c.useEffect(()=>{const P=be.current;if(!P)return;const D=le=>{le.preventDefault(),le.stopPropagation()},H=async le=>{var ee,ce;D(le);const Z=(ce=(ee=le.dataTransfer)==null?void 0:ee.files)==null?void 0:ce[0];Z&&(await z(Z),Y.current&&(Y.current.value=""),ae(W=>W+1))};return["dragenter","dragover","dragleave","drop"].forEach(le=>P.addEventListener(le,le==="drop"?H:D)),()=>{["dragenter","dragover","dragleave","drop"].forEach(le=>P.removeEventListener(le,le==="drop"?H:D))}},[z]);const C=async P=>{var H;const D=(H=P.target.files)==null?void 0:H[0];D&&(await z(D),Y.current&&(Y.current.value=""),ae(le=>le+1))},$=()=>{Y.current&&Y.current.click()};return i.jsxs("div",{className:"ui-card",children:[i.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[i.jsx("h3",{className:"text-sm font-semibold text-[#F8F4FF] truncate",children:a}),i.jsx("span",{className:"text-[11px] text-[#C3C7FFB3] truncate",children:"Image"})]}),i.jsx("div",{ref:be,className:"mb-3 rounded-xl border border-dashed border-[rgba(255,255,255,0.14)] bg-[rgba(255,255,255,0.02)] flex items-center justify-center min-h-[140px] sm:min-h-[180px] overflow-hidden",children:r?i.jsx(Q,{variant:"bare",className:"w-full h-full",onClick:()=>_(!0),"aria-label":`Preview ${a}`,title:"Open preview",children:i.jsx("img",{src:r,alt:a,className:`max-h-64 max-w-full object-contain transition-opacity ${s?"opacity-100":"opacity-0"}`,onLoad:()=>l(!0)})}):i.jsx("div",{className:"text-[11px] text-[#9DA3FFCC] text-center px-6",children:"Drop an image here, upload from your device, or choose one from your server."})}),i.jsx("input",{ref:Y,type:"file",accept:"image/*",className:"hidden",onChange:C},ve),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx(Q,{size:"sm",variant:"primary",onClick:u,children:"Choose"}),i.jsx(Q,{size:"sm",variant:"muted",onClick:$,children:"Upload"}),i.jsx(Q,{size:"sm",variant:"ghost",onClick:I,children:"Clear"})]}),i.jsx(Lw,{open:o,cwd:m,setCwd:v,page:g,setPage:y,perPage:w,setPerPage:j,totalPages:S,topDirs:h,loading:f,imagesOnly:N,setImagesOnly:k,search:p,setSearch:x,shownEntries:L,pickerSource:R,setPickerSource:T,onSelect:X,onClose:d}),i.jsx(Pw,{open:de,onClose:()=>_(!1),title:a||"Preview",url:r,kind:"image"})]})}function _w({open:e,onClose:t,title:n,description:r,render:s,index:l=0,total:a=0,children:o}){const[u,d]=c.useState("idle"),m=c.useRef(null),v=c.useRef(null),g=w=>w?Array.from(w.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(j=>!j.hasAttribute("disabled")&&j.getAttribute("aria-hidden")!=="true"):[];if(c.useEffect(()=>{if(u==="queued"){const w=setTimeout(()=>d("idle"),1600);return()=>clearTimeout(w)}},[u]),c.useEffect(()=>{if(!e||typeof document>"u")return;const w=m.current;v.current=document.activeElement;const j=()=>{var p;const f=g(w)[0]||w;(p=f==null?void 0:f.focus)==null||p.call(f)},S=h=>{if(h.key==="Escape"){t==null||t();return}if(h.key!=="Tab"||!w)return;const f=g(w);if(!f.length){h.preventDefault(),w.focus();return}const p=f[0],x=f[f.length-1],N=document.activeElement;h.shiftKey&&N===p?(h.preventDefault(),x.focus()):!h.shiftKey&&N===x&&(h.preventDefault(),p.focus())};return requestAnimationFrame(j),w==null||w.addEventListener("keydown",S),()=>{var f;w==null||w.removeEventListener("keydown",S);const h=v.current;h&&document.contains(h)&&((f=h.focus)==null||f.call(h))}},[e,t]),!e)return null;const y=typeof s=="function"?s():o;return i.jsxs("div",{className:"spotlight-overlay",role:"dialog","aria-modal":"true",children:[i.jsx("div",{className:"spotlight-backdrop",onClick:t}),i.jsxs("div",{className:"spotlight-sheet",ref:m,tabIndex:-1,children:[i.jsxs("div",{className:"spotlight-header",children:[i.jsxs("div",{className:"spotlight-meta",children:[i.jsx("div",{className:"spotlight-kicker",children:"Focused control"}),i.jsx("div",{className:"spotlight-title",children:n||"Control"}),r?i.jsx("div",{className:"spotlight-hint",children:r}):null]}),i.jsx("button",{type:"button",className:"spotlight-close",onClick:t,"aria-label":"Close",children:i.jsx(hr,{size:16})})]}),i.jsx("div",{className:"spotlight-body",children:y}),i.jsx("div",{className:"spotlight-footer",children:i.jsx("div",{className:"spotlight-footer-right",children:i.jsx(Q,{size:"sm",variant:"muted",onClick:t,"aria-label":"Close",children:"Close"})})})]})]})}const ac=c.forwardRef(function({title:t,kicker:n,meta:r,defaultOpen:s=!0,variant:l="card",className:a="",bodyClassName:o,children:u},d){const m=l==="bare",v=(m?["collapsible-section","collapsible-section--bare",a]:["ui-panel","collapsible-card",a]).filter(Boolean).join(" "),g=(m?["collapsible-section-body",o||"space-y-4"]:["collapsible-card-body",o||"space-y-4"]).filter(Boolean).join(" "),y=r!=null?i.jsx("div",{className:"collapsible-card-summary-meta",children:r}):null;return i.jsxs("details",{ref:d,className:v,open:s,children:[i.jsxs("summary",{className:m?"collapsible-section-summary":"collapsible-card-summary",children:[i.jsxs("div",{className:"flex flex-col gap-1",children:[n?i.jsx("span",{className:"ui-kicker",children:n}):null,i.jsx("span",{className:"text-sm font-semibold tracking-wide",children:t})]}),y,m?i.jsx("span",{className:"collapsible-section-chevron","aria-hidden":"true",children:i.jsx(ha,{size:16})}):null]}),i.jsx("div",{className:g,children:u})]})}),Rw=/\.(safetensors|ckpt|pt|pth)$/i,Iw=/\.([a-z0-9]{2,16})$/i,Aw=e=>/[a-z]/i.test(e),ga=e=>e.replace(/\\/g,"/"),Cm=e=>{const{folder:t,base:n}=Tw(e);if(!n)return e;if(!t)return n;const r=t.split(/\s+/).filter(Boolean),s=r[r.length-1]||"";if(s&&n.toLowerCase().startsWith(s.toLowerCase())){const l=n.slice(s.length);return l?`${t}${l}`:t}return`${t} ${n}`.trim()};function Em(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const r=ga(t).split("/").filter(Boolean).pop()||"";return Rw.test(r)}function ws(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const s=(ga(t).split("/").filter(Boolean).pop()||"").match(Iw);return s?Aw(s[1]):!1}function va(e){if(typeof e!="string")return{folderPath:"",base:"",filename:""};const t=ga(e.trim());if(!t)return{folderPath:"",base:"",filename:""};const n=t.split("/").filter(Boolean),r=n.pop()||"",s=r.replace(/\.[^.]+$/,"");return{folderPath:n.join("/"),base:s,filename:r}}function Tw(e){if(typeof e!="string")return{folder:"",base:""};const n=ga(e.trim()).split("/").filter(Boolean),s=(n.pop()||"").replace(/\.[^.]+$/,"");return{folder:n.join(" ").trim(),base:s}}function Mw(e){return Em(e)?Cm(e):e}function $w(e){return ws(e)?Cm(e):e}function xn(e){if(!ws(e))return e;const{base:t}=va(e);return t||$w(e)}const Fw=(e="")=>{if(!e||e==="root")return"root";const t=e.split("/").filter(Boolean);return t[t.length-1]||e},Ow=c.memo(function({workflows:t=[],selectedWorkflow:n,onWorkflowChange:r,workflowData:s,presets:l=[],presetName:a="",onPresetNameChange:o,selectedPresetId:u="",onPresetSelect:d,onPresetSave:m,onPresetDelete:v,presetStatus:g}){const y=Array.isArray(t)?t:[],w=Array.isArray(l)?l:[],[j,S]=c.useState("All"),h=c.useMemo(()=>y.map(z=>{const I=String(z||"");if(!ws(I))return{value:I,isFile:!1,base:"",folderPath:""};const{folderPath:X,base:Y}=va(I);return{value:I,isFile:!0,base:Y,folderPath:X||"root"}}),[y]),f=c.useMemo(()=>{const z=new Set(["All"]);return h.forEach(I=>{I.isFile&&I.folderPath&&z.add(I.folderPath)}),Array.from(z).sort((I,X)=>I.localeCompare(X))},[h]),p=f.length>2;c.useEffect(()=>{if(!p){j!=="All"&&S("All");return}f.includes(j)||S("All")},[p,j,f]);const x=c.useMemo(()=>{const z=new Map;return h.forEach(I=>{if(!I.isFile||!I.base)return;const X=I.base.toLowerCase();z.set(X,(z.get(X)||0)+1)}),z},[h]),N=c.useMemo(()=>{const z=[],I=p&&j==="All";return h.forEach(X=>{if(!X.isFile){z.push({value:X.value,label:X.value});return}if(p&&j!=="All"&&X.folderPath!==j)return;let Y=X.base||xn(X.value)||X.value;if(I&&X.base){const be=X.base.toLowerCase();x.get(be)>1&&(Y=`${Y} (${Fw(X.folderPath)})`)}z.push({value:X.value,label:Y})}),z},[h,j,x,p]),k=c.useMemo(()=>n?N.some(z=>String(z.value)===String(n)):!0,[N,n]),L=c.useMemo(()=>!n||k?N:[{value:n,label:xn(String(n))},...N],[k,n,N]),R=()=>{m()},T=()=>{v()};return i.jsxs(ac,{title:i.jsxs(i.Fragment,{children:[i.jsx(tc,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Workflow"]}),bodyClassName:"control-shell controls-body",defaultOpen:!1,className:"controls-panel",children:[i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"workflow-select",children:"Workflow"}),p?i.jsx(rt,{value:j,onChange:S,wrapperClassName:"mb-2","aria-label":"Workflow folder filter",size:"sm",options:f.map(z=>({value:z,label:z}))}):null,i.jsx(rt,{id:"workflow-select",value:n||"",onChange:r,"aria-label":"Workflow",size:"sm",placeholder:"Select workflow...",options:L})]}),i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"preset-select",children:"Preset"}),i.jsx(rt,{id:"preset-select",value:u||"",onChange:d,"aria-label":"Workflow preset",disabled:!s,size:"sm",placeholder:"Select preset...",options:w.map(z=>({value:z.id,label:z.name}))})]}),i.jsxs("div",{className:"flex flex-col gap-1.5",children:[i.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"preset-name-input",children:"Preset name"}),i.jsx("input",{id:"preset-name-input",type:"text",value:a,onChange:z=>o(z.target.value),className:"ui-control ui-input",placeholder:"Name for new preset...","aria-label":"Preset name",disabled:!s})]}),i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{className:"flex gap-2 flex-wrap",children:[i.jsx(Q,{size:"sm",variant:"primary",onClick:R,disabled:!s||!a.trim(),children:"Save preset"}),i.jsx(Q,{size:"sm",variant:"muted",onClick:T,disabled:!s||!u,children:"Delete preset"})]}),g?i.jsx("div",{className:"text-xs text-[#6D8BFF]",children:g}):null]})]})});function Dw({open:e,onClose:t,title:n,value:r,onChange:s,placeholder:l="",description:a}){const o=n||"Edit",u=c.useMemo(()=>`sheet-textarea-${Math.random().toString(36).slice(2,9)}`,[]);return i.jsxs(Ut,{open:e,onClose:t,title:o,variant:"fullscreen",footer:i.jsx(Q,{variant:"primary",className:"w-full",onClick:t,children:"Done"}),children:[a?i.jsx("div",{className:"text-[12px] text-[rgba(159,178,215,0.75)] mb-3",children:a}):null,i.jsx("textarea",{id:u,value:r??"",onChange:d=>s==null?void 0:s(d.target.value),placeholder:l,className:"sheet-textarea ui-control ui-textarea",rows:12})]})}function An(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(2).replace(/\.?0+$/u,""):"1"}function Bw(e=""){const t=String(e||"");if(!t.trim())return[];const n=[];let r=0;for(;r<t.length;){for(;r<t.length&&/[\s,]/.test(t[r]);)r++;if(r>=t.length)break;let s=r,l=r,a="tag",o="";const u=t[r]==="(";if(u&&(s=r,r++),t[r]==="$"){a="alias";const d=r;for(r++;r<t.length&&t[r]!=="$"&&t[r]!==","&&t[r]!==`
`;)o+=t[r],r++;t[r]==="$"&&r++,u||(s=d)}else{a="tag";const d=r;for(;r<t.length&&!(t[r]===","||t[r]==="$"||t[r]===`
`||u&&t[r]===":"||!u&&t[r]==="(");)o+=t[r],r++;o=o.trim(),u||(s=d)}if(u&&t[r]===":"){for(r++;r<t.length&&t[r]!==")"&&t[r]!==","&&t[r]!==`
`;)r++;t[r]===")"&&r++}l=r,o&&n.push({type:a,text:o,start:s,end:l})}return n}function ff(e="",t){if(!t||typeof t.start!="number"||typeof t.end!="number")return null;const r=String(e||"").slice(t.start,t.end);if(!r.startsWith("(")||!r.includes(":"))return null;const s=r.lastIndexOf(":");if(s===-1)return null;const l=r.slice(s+1);if(!l.endsWith(")"))return null;const a=l.slice(0,-1).trim();if(!/^\d+(\.\d+)?$/u.test(a))return null;const o=Number.parseFloat(a);return Number.isFinite(o)?{weight:o,wrapperStart:t.start,wrapperEnd:t.end}:null}function pf(e="",t,n){const r=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return r;const s=n==null?null:Number(n),l=s===null||!Number.isFinite(s)||Math.abs(s-1)<1e-6,a=t.type==="alias"?`$${t.text}$`:t.text;if(l)return r.slice(0,t.start)+a+r.slice(t.end);const o=An(s),u=`(${a}:${o})`;return r.slice(0,t.start)+u+r.slice(t.end)}function hf(e="",t,n,r){var g;if(n===r||n===null||r===null||!(t!=null&&t.length))return e;const s=String(e||""),l=t.map(y=>({start:y.start,end:y.end,text:s.slice(y.start,y.end)})),a=l.slice(0,-1).map((y,w)=>{const j=l[w+1];return s.slice(y.end,j.start)}),o=l.length?s.slice(0,l[0].start):"",u=l.length?s.slice(l[l.length-1].end):"",d=[...l],[m]=d.splice(n,1);d.splice(r,0,m);let v=o+(((g=d[0])==null?void 0:g.text)||"");for(let y=1;y<d.length;y++)v+=(a[y-1]??", ")+d[y].text;return v+=u,v}function Uw(e="",t){const n=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return n;const r=n.slice(0,t.start).replace(/[\s,]*$/,""),s=n.slice(t.end).replace(/^[\s,]*/,"");return r?`${r}, ${s}`.trim():s.trim()}function Hr(e="",t){if(!t||typeof t.index!="number"||typeof t.length!="number")return null;const n=String(e||""),r=t.index,s=t.index+t.length;if(r<=0||n[r-1]!=="("||n[s]!==":")return null;let l=s+1,a="";for(;l<n.length&&n[l]!==")";)if(a+=n[l],l+=1,a.length>12)return null;if(l>=n.length||n[l]!==")")return null;const o=a.trim();if(!/^\d+(\.\d+)?$/u.test(o))return null;const u=Number.parseFloat(o);return Number.isFinite(u)?{weight:u,wrapperStart:r-1,wrapperEnd:l+1}:null}function ql(e="",t,n){const r=String(e||"");if(!t||typeof t.index!="number"||typeof t.length!="number")return r;const s=t.index,l=t.index+t.length,a=Hr(r,t),o=n==null?null:Number(n),u=o===null||!Number.isFinite(o)||Math.abs(o-1)<1e-6;if(a){if(u)return r.slice(0,a.wrapperStart)+r.slice(s,l)+r.slice(a.wrapperEnd);const m=An(o);return r.slice(0,l+1)+m+r.slice(a.wrapperEnd-1)}if(u)return r;const d=An(o);return r.slice(0,s)+"("+r.slice(s,l)+":"+d+")"+r.slice(l)}function Xl(e,t,n){const r=Number(e);return Number.isFinite(r)?Math.max(t,Math.min(n,r)):t}function oc({open:e,onClose:t,title:n="Alias strength",tokenLabel:r="",weight:s=1,onApply:l,onRemoveWeight:a,onDeleteToken:o}){const u=c.useMemo(()=>Xl(s||1,.2,2),[s]),[d,m]=c.useState(u);c.useEffect(()=>{e&&m(u)},[e,u]);const v=An(d);return i.jsx(Ut,{open:e,onClose:t,title:n,footer:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:t,children:"Cancel"}),i.jsx(Q,{variant:"primary",className:"w-full",onClick:()=>{l==null||l(d),t==null||t()},children:"Done"})]}),children:i.jsxs("div",{className:"sheet-stack token-strength-sheet",children:[i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Alias"}),i.jsx("div",{className:"sheet-hint",children:r||""})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Strength"}),i.jsxs("div",{className:"token-strength-row",children:[i.jsx(Q,{size:"sm",variant:"muted",onClick:()=>m(g=>Xl(g-.05,.2,2)),children:""}),i.jsxs("div",{className:"token-strength-value tabular-nums",children:[v,""]}),i.jsx(Q,{size:"sm",variant:"muted",onClick:()=>m(g=>Xl(g+.05,.2,2)),children:"+"})]}),i.jsx("input",{type:"range",min:.2,max:2,step:.05,value:d,onChange:g=>m(Xl(g.target.value,.2,2)),className:"ui-range","aria-label":"Alias strength"}),i.jsx("div",{className:"sheet-hint token-strength-hint",children:"1.0 is normal. Increase to emphasize or reduce to soften."})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Actions"}),i.jsxs("div",{className:"token-strength-actions",children:[i.jsx(Q,{size:"sm",variant:"ghost",onClick:()=>m(1),children:"Reset"}),i.jsx("span",{className:"token-strength-divider","aria-hidden":"true",children:"|"}),i.jsx(Q,{size:"sm",variant:"danger",onClick:()=>{o==null||o(),t==null||t()},children:"Delete"})]})]})]})})}function kr(e){const t=String(e||"").trim();if(!t)return"";const n=t.toLowerCase(),r={scifi:"Sci-Fi",sci:"Sci",ui:"UI",vfx:"VFX",hdr:"HDR",dof:"DoF",bokeh:"Bokeh",vhs:"VHS",jpeg:"JPEG",jpg:"JPG",png:"PNG",gif:"GIF",webp:"WebP",api:"API",nsfw:"NSFW",sfw:"SFW",sfx:"SFX",fx:"FX",lora:"LoRA",loras:"LoRAs",ip:"IP",egirl:"E-girl",i2v:"I2V",t2i:"T2I",img2img:"Img2Img",txt2img:"Txt2Img",tts:"TTS",asmr:"ASMR",ai:"AI",highleg:"High-Leg","one-piece":"One-Piece","three-quarter":"Three-Quarter"};return r[n]?r[n]:/^\d+$/.test(n)?n:n==="3d"?"3D":n==="2d"?"2D":n.length===1?n.toUpperCase():n.charAt(0).toUpperCase()+n.slice(1)}function Vw(e=""){const t=String(e||"").trim().toLowerCase();return t?t.startsWith("flirty_")?"flirty":t.startsWith("action_")||t.startsWith("dynamic_")||t.startsWith("stealth_")||t.startsWith("athletic_")||t.startsWith("running_")||t.startsWith("walking_")?"action":t.startsWith("sleepy_")||t.startsWith("relaxed_")||t.startsWith("reclining_")||t.startsWith("sitting_")||t.startsWith("kneeling_")?"rest":t.startsWith("happy_")||t.startsWith("sad_")||t.startsWith("angry_")||t.startsWith("nervous_")||t.startsWith("smug_")||t.startsWith("surprised_")||t.startsWith("scared_")||t.startsWith("tipsy_")?"emotion":t.startsWith("composed_")||t.startsWith("contemplative_")||t.startsWith("looking_")?"posed":"everyday":""}function Ww(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return n==="lingerie"?"lingerie":n==="swimwear"||n==="swim"?"swimwear":n==="costumes"||n==="tech"?"costumes":n==="uniform"?"uniform":n==="formal"?"formal":n==="alt"?"alt":n==="casual"||n==="street"||n==="lounge"||n==="sporty"||n==="dress"?"everyday":n||"everyday"}function Hw(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return["fire","candlelight","embers"].includes(n)?"fire":["moonlight"].includes(n)?"night":["neon"].includes(n)?"neon":["studio","stage","sidelighting","dim"].includes(n)?"studio":["golden","sunbeam","dappled"].includes(n)?"natural":["lens","light"].includes(n)?"effects":n||"other"}function Ds(e="",t=""){const n=String(e||"").trim(),r=String(t||"").trim().toLowerCase();if(!n)return"";if(r==="outfit")return Ww(n)||"everyday";if(r==="pose")return Vw(n)||"everyday";if(r==="lighting")return Hw(n)||"effects";const s=n.indexOf("_");return s<=0?"":n.slice(0,s).trim()}function bm(e=""){const t=String(e||"").trim();return t?t.includes(":")?t.split(":").slice(1).join(":"):t:""}function Lm({token:e="",name:t=""}={}){const n=String(t||"").trim()||bm(e);if(!n)return"";let s=n.replace(/_(\d+)$/u,"").split("_").filter(Boolean);if(s.length===0)return n;const l=[];for(let v=0;v<s.length;v++){const g=s[v],y=s[v+1];if(g&&y&&g.toLowerCase()==="one"&&y.toLowerCase()==="piece"){l.push("one-piece"),v+=1;continue}if(g&&y&&g.toLowerCase()==="three"&&y.toLowerCase()==="quarter"){l.push("three-quarter"),v+=1;continue}l.push(g)}if(s=l,Array.from(new Set(s.map(v=>String(v).toLowerCase()))).length===1)return kr(s[0]);const o=s[0],u=s.slice(1),d=kr(o),m=u.map(kr).join(" ").trim();return m?m.toLowerCase()===d.toLowerCase()?u.length===1&&String(u[0]).toLowerCase()===String(o).toLowerCase()?d||n:s.map(kr).join(" ").trim()||n:`${d} - ${m}`:s.map(kr).join(" ").trim()||n}function vu(e){if(!e)return{subcategory:"",displayName:""};const t=e.name||"",n=e.token||"",r=bm(n)||t,s=Ds(r,e.category)||"other",l=Lm({token:n,name:t})||n||t||"Alias";return{subcategory:s,displayName:l}}function Tn(e=""){const t=String(e||"").trim();return t?t==="All"?"All":{action:"Actions",camera:"Camera",body:"Body",char:"Characters",mood:"Mood",outfit:"Outfits",pose:"Poses",prop:"Props",scene:"Scenes",weather:"Weather",style:"Style",hair:"Hair",lighting:"Lighting"}[t]||kr(t):""}function mr(e=""){const t=String(e||"").trim();return t?t==="All"?"All":t.split(/[_-]+/u).filter(Boolean).map(n=>kr(n)).join(" ").trim():""}function mf({open:e,onClose:t,isPromptLike:n,pickerSearch:r,onSearchChange:s,pickerSearchRef:l,categories:a,pickerCategory:o,onCategoryChange:u,subcategories:d,pickerSubcategory:m,onSubcategoryChange:v,filteredAliases:g,visibleAliases:y,visibleCount:w,onShowMore:j,listItemVisibilityStyles:S,onInsertAlias:h}){return i.jsx(Ut,{open:e,onClose:t,title:n?"Insert alias":"Aliases",footer:i.jsx(Q,{variant:"primary",className:"w-full",onClick:t,children:"Done"}),children:i.jsxs("div",{className:"sheet-stack",children:[i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Search"}),i.jsxs("div",{className:"composer-filters",children:[i.jsx("input",{ref:l,type:"text",value:r,onChange:f=>s(f.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),i.jsx(rt,{value:o,onChange:u,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:["All",...a.filter(f=>f!=="All")].map(f=>({value:f,label:f==="All"?"Category: All":Tn(f)}))}),d.length>2?i.jsx(rt,{value:m,onChange:v,wrapperClassName:"composer-subcategory-select",size:"sm",searchThreshold:0,options:d.map(f=>({value:f,label:f==="All"?"All subcategories":mr(f)}))}):null]})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Results"}),i.jsx("div",{className:"composer-alias-list",children:g.length===0?i.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):i.jsxs(i.Fragment,{children:[y.map(f=>i.jsxs("button",{type:"button",onClick:()=>h(f.token,{closeAfter:!n}),className:"composer-alias-item",style:S,children:[i.jsxs("div",{className:"composer-alias-header",children:[i.jsx("div",{className:"composer-alias-name",children:f.displayName||f.token}),f.category?i.jsx("span",{className:"composer-alias-category",children:Tn(f.category)}):null]}),i.jsxs("div",{className:"composer-alias-token",children:["$",f.token,"$"]}),i.jsx("div",{className:"composer-alias-text",children:f.text})]},f.key)),w<g.length?i.jsxs(Q,{variant:"muted",className:"w-full",onClick:j,children:["Show more (",g.length-w," left)"]}):null]})})]})]})})}const gf={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function Gw({name:e,label:t,description:n,value:r,onChange:s,onEnter:l,disabled:a=!1,multiline:o=!1,aliasOptions:u=[],aliasCatalog:d=[],onOpenComposer:m}){var tt,kt;const v=c.useRef(null),g=c.useRef(null),y=c.useRef({start:null,end:null}),w=c.useRef(null),j=c.useRef(null),[S,h]=c.useState(null),[f,p]=c.useState(null),[x,N]=c.useState(!1),[k,L]=c.useState(""),R=c.useDeferredValue(k),[T,z]=c.useState("All"),[I,X]=c.useState("All"),[Y]=c.useState([]),be=c.useRef(null),[ve,ae]=c.useState(!1),[de,_]=c.useState(!1),[C,$]=c.useState(null),P=typeof r=="string"?r:String(r??"");c.useMemo(()=>Array.isArray(u)?u.filter(Boolean):[],[u]);const D=c.useMemo(()=>(Array.isArray(d)?d.filter(B=>B&&B.name):[]).map(B=>({...B,...vu(B)})),[d]),H=c.useMemo(()=>D,[D]),le=B=>{const q=B.target.value;s==null||s(q)},Z=B=>{if(!o&&B.key==="Enter"){B.preventDefault(),l==null||l(B.target.value,B);return}},ee=c.useMemo(()=>{const B=new Map;return H.forEach(q=>{q!=null&&q.token&&B.set(String(q.token).toLowerCase(),q)}),B},[H]),ce=c.useMemo(()=>{const B=new Set(["All"]);return D.forEach(q=>{q.category&&B.add(q.category)}),Array.from(B).sort((q,ge)=>q.localeCompare(ge))},[D]),W=c.useMemo(()=>{const B=new Set(["All"]);return H.forEach(q=>{(!T||T==="All"||q.category===T)&&q.subcategory&&B.add(q.subcategory)}),Array.from(B).sort((q,ge)=>q.localeCompare(ge))},[H,T]);c.useEffect(()=>{X("All")},[T]);const O=c.useMemo(()=>{const B=P||"";if(!B||!B.includes("$"))return[];const q=[],ge=/\$([a-z0-9_:-]+)\$/gi;let je;for(;je=ge.exec(B);)q.push({token:je[1],index:je.index,length:je[0].length});return q},[P]),U=()=>{try{const B=v.current;B?y.current={start:B.selectionStart??null,end:B.selectionEnd??null}:y.current={start:null,end:null}}catch{y.current={start:null,end:null}}g.current&&g.current.scrollIntoView({block:"center",behavior:"smooth"}),N(!0)},ue=c.useMemo(()=>{const B=R.trim().toLowerCase();return H.filter(q=>{var ge,je,Re,We;return T!=="All"&&(q.category||"")!==T||I!=="All"&&(q.subcategory||"other")!==I?!1:B?((ge=q.token)==null?void 0:ge.toLowerCase().includes(B))||((je=q.text)==null?void 0:je.toLowerCase().includes(B))||((Re=q.name)==null?void 0:Re.toLowerCase().includes(B))||((We=q.displayName)==null?void 0:We.toLowerCase().includes(B)):!0}).sort((q,ge)=>{const je=(q.subcategory||"").toLowerCase(),Re=(ge.subcategory||"").toLowerCase();return je!==Re?je.localeCompare(Re):q.token.localeCompare(ge.token)})},[H,T,I,R]),[xe,ze]=c.useState(30),Ae=c.useMemo(()=>ue.slice(0,xe),[ue,xe]);c.useEffect(()=>{ze(30)},[T,I,k,D]),c.useEffect(()=>{X("All")},[T]);const Le=(B,{closeAfter:q=!0}={})=>{var Te,dt;const ge=v.current,je=`$${B}$`,Re=P||"",We=(Te=y.current)==null?void 0:Te.start,Oe=(dt=y.current)==null?void 0:dt.end,Qe=(ge==null?void 0:ge.selectionStart)??(typeof We=="number"?We:Re.length),F=(ge==null?void 0:ge.selectionEnd)??(typeof Oe=="number"?Oe:Re.length),se=Re.slice(0,Qe),b=Re.slice(F),A=se.match(/[^\s]$/),K=b.match(/^[^\s]/),re=A&&A[0]!==","?", ":"",we=K&&K[0]!==","?", ":"",oe=se+re+je+we+b;s==null||s(oe);const fe=(se+re+je+we).length;y.current={start:fe,end:fe},q&&(N(!1),requestAnimationFrame(()=>{var At;(At=ge==null?void 0:ge.blur)==null||At.call(ge)}))},_e=B=>{const q=P||"",ge=Hr(q,B),je=ge?ge.wrapperStart:B.index,Re=ge?ge.wrapperEnd:B.index+B.length,We=q.slice(0,je).replace(/[\s,]*$/,""),Oe=q.slice(Re).replace(/^[\s,]*/,""),Qe=We?`${We} ${Oe}`.trim():Oe.trim();s==null||s(Qe)},Ue=B=>{if(!B)return;const q=ee.get(B.token.toLowerCase()),ge=(q==null?void 0:q.displayName)||B.token,je=Hr(P||"",B);$({tokenObj:B,displayName:ge,weight:(je==null?void 0:je.weight)??1}),_(!0),requestAnimationFrame(()=>{var Re,We;return(We=(Re=v.current)==null?void 0:Re.blur)==null?void 0:We.call(Re)})},Ge=c.useMemo(()=>(B,q)=>{var b;if(B===q||B===null||q===null||!(O!=null&&O.length))return;const ge=P||"",je=O.map(A=>{const K=Hr(ge,A),re=K?K.wrapperStart:A.index,we=K?K.wrapperEnd:A.index+A.length;return{start:re,end:we,text:ge.slice(re,we)||`$${A.token}$`}}),Re=je.slice(0,-1).map((A,K)=>{const re=je[K+1];return ge.slice(A.end,re.start)}),We=je.length?ge.slice(0,je[0].start):"",Oe=je.length?ge.slice(je[je.length-1].end):"",Qe=[...je],[F]=Qe.splice(B,1);Qe.splice(q,0,F);let se=We+(((b=Qe[0])==null?void 0:b.text)||"");for(let A=1;A<Qe.length;A+=1)se+=(Re[A-1]??", ")+Qe[A].text;se+=Oe,s==null||s(se)},[s,O,P]),V=(B,q)=>{h(q),w.current=B.currentTarget,B.dataTransfer.effectAllowed="move",B.dataTransfer.setData("text/plain",String(q)),requestAnimationFrame(()=>{w.current&&w.current.classList.add("is-dragging")})},Se=(B,q)=>{B.preventDefault(),B.dataTransfer.dropEffect="move",q!==f&&p(q)},Ye=B=>{B!==f&&p(B)},te=B=>{S!==null&&B!==null&&S!==B&&Ge(S,B),h(null),p(null),w.current=null},me=()=>{w.current&&w.current.classList.remove("is-dragging"),te(f)},ye=(B,q)=>{B.preventDefault(),te(q)},Ne=(B,q)=>{var Re,We;if(!((We=(Re=B.target)==null?void 0:Re.closest)==null?void 0:We.call(Re,".token-chip-drag-handle")))return;const je=B.touches[0];j.current={idx:q,startX:je.clientX,startY:je.clientY,moved:!1}},Pe=B=>{if(!j.current)return;const q=B.touches[0],ge=Math.abs(q.clientX-j.current.startX),je=Math.abs(q.clientY-j.current.startY);if(ge<=10&&je<=10)return;j.current.moved=!0,h(j.current.idx),B.preventDefault();const Re=g.current,We=Re?Re.querySelectorAll(".token-chip-draggable"):document.querySelectorAll(".token-chip-draggable"),Oe=q.clientX,Qe=q.clientY;for(let F=0;F<We.length;F++){const se=We[F].getBoundingClientRect();if(Oe>=se.left&&Oe<=se.right&&Qe>=se.top&&Qe<=se.bottom){p(F);break}}},ie=()=>{var B;(B=j.current)!=null&&B.moved&&S!==null&&f!==null&&S!==f&&Ge(S,f),j.current=null,h(null),p(null)},Me={id:e,name:e,value:P,onChange:le,disabled:a,className:"ui-control ui-input pr-10 text-[13px] sm:text-sm",placeholder:"","aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0},Ke=()=>{N(!1),requestAnimationFrame(()=>{var B,q;(q=(B=v.current)==null?void 0:B.blur)==null||q.call(B)})},lt=(()=>{const B=String(e||"").toLowerCase(),q=String(t||"").toLowerCase();return!!`${B} ${q}`.trim().includes("prompt")})();return o?i.jsxs("div",{className:"relative space-y-2",ref:g,children:[m&&!lt?i.jsxs("div",{className:"stringinput-toolbar",children:[i.jsx(Q,{size:"sm",variant:"muted",onClick:()=>m(e),children:"Open composer"}),D.length?i.jsx(Q,{size:"sm",variant:"ghost",onClick:U,children:"Aliases"}):null,i.jsx(Q,{size:"sm",variant:"ghost",onClick:()=>ae(!0),children:"Expand"})]}):null,i.jsx("textarea",{ref:v,...Me,rows:3,wrap:"soft",onKeyDown:Z,className:Me.className+" resize-none min-h-[88px] max-h-[160px] leading-relaxed overflow-y-auto overflow-x-hidden break-words whitespace-pre-wrap",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"anywhere"}}),m&&lt?i.jsx("div",{className:"stringinput-underbar",children:i.jsxs("div",{className:"stringinput-underbar-actions",children:[i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>m(e),children:"Open composer"}),D.length?i.jsx(Q,{size:"xs",variant:"ghost",onClick:U,children:"Insert alias"}):null]})}):null,i.jsx(Dw,{open:ve,onClose:()=>ae(!1),title:t||e,value:P,onChange:s,description:n}),O.length?i.jsxs("div",{className:"stringinput-tokens",children:[i.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",i.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),i.jsx("div",{className:"stringinput-tokens-list",children:O.map((B,q)=>{var Qe;const ge=ee.get(B.token.toLowerCase()),je=(ge==null?void 0:ge.displayName)||B.token,Re=S===q,We=f===q&&S!==null&&S!==q,Oe=((Qe=Hr(P||"",B))==null?void 0:Qe.weight)??1;return i.jsxs("div",{className:`ui-chip is-clickable token-chip token-chip-draggable ${Re?"is-dragging":""} ${We?"is-drop-target":""}`,title:`$${B.token}$`,role:"button",tabIndex:0,draggable:!0,onDragStart:F=>V(F,q),onDragEnd:me,onDragEnter:()=>Ye(q),onDragOver:F=>Se(F,q),onDrop:F=>ye(F,q),onTouchStart:F=>Ne(F,q),onTouchMove:Pe,onTouchEnd:ie,onClick:()=>{S===null&&Ue(B)},onKeyDown:F=>{(F.key==="Enter"||F.key===" ")&&(F.preventDefault(),Ue(B))},children:[i.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:i.jsx(rc,{size:14})}),i.jsx("span",{className:"token-chip-label",children:je}),Math.abs(Oe-1)>1e-6?i.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${An(Oe)}x`,children:["",An(Oe)]}):null,i.jsx(Q,{size:"mini",variant:"danger",onClick:F=>{F.stopPropagation(),_e(B)},"aria-label":`Remove ${B.token}`,children:i.jsx(hr,{size:12})})]},`${B.token}-${B.index}`)})})]}):null,i.jsx(oc,{open:de,onClose:()=>_(!1),title:"Alias strength",tokenLabel:C?`${C.displayName}  $${(tt=C.tokenObj)==null?void 0:tt.token}$`:"",weight:(C==null?void 0:C.weight)??1,onApply:B=>{C!=null&&C.tokenObj&&(s==null||s(ql(P||"",C.tokenObj,B)))},onRemoveWeight:()=>{C!=null&&C.tokenObj&&(s==null||s(ql(P||"",C.tokenObj,null)))},onDeleteToken:()=>{C!=null&&C.tokenObj&&_e(C.tokenObj)}}),x?i.jsx(mf,{open:x,onClose:Ke,isPromptLike:lt,pickerSearch:k,onSearchChange:L,pickerSearchRef:be,categories:ce,pickerCategory:T,onCategoryChange:z,subcategories:W,pickerSubcategory:I,onSubcategoryChange:X,filteredAliases:ue,visibleAliases:Ae,visibleCount:xe,onShowMore:()=>ze(B=>Math.min(B+30,ue.length)),listItemVisibilityStyles:gf,onInsertAlias:Le}):null]}):i.jsxs("div",{className:"relative space-y-2",ref:g,children:[i.jsx("input",{...Me,type:"text",inputMode:"text",autoComplete:"off",onKeyDown:Z,className:Me.className+" min-h-[44px]",ref:v}),O.length?i.jsxs("div",{className:"stringinput-tokens",children:[i.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",i.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),i.jsx("div",{className:"stringinput-tokens-list",children:O.map((B,q)=>{var Qe;const ge=ee.get(B.token.toLowerCase()),je=(ge==null?void 0:ge.displayName)||B.token,Re=S===q,We=f===q&&S!==null&&S!==q,Oe=((Qe=Hr(P||"",B))==null?void 0:Qe.weight)??1;return i.jsxs("div",{className:`ui-chip is-clickable token-chip token-chip-draggable ${Re?"is-dragging":""} ${We?"is-drop-target":""}`,title:`$${B.token}$`,onClick:()=>{S===null&&Ue(B)},role:"button",tabIndex:0,draggable:!0,onDragStart:F=>V(F,q),onDragEnd:me,onDragEnter:()=>Ye(q),onDragOver:F=>Se(F,q),onDrop:F=>ye(F,q),onTouchStart:F=>Ne(F,q),onTouchMove:Pe,onTouchEnd:ie,onKeyDown:F=>{(F.key==="Enter"||F.key===" ")&&(F.preventDefault(),Ue(B))},children:[i.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:i.jsx(rc,{size:14})}),i.jsx("span",{className:"token-chip-label",children:je}),Math.abs(Oe-1)>1e-6?i.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${An(Oe)}x`,children:["",An(Oe)]}):null,i.jsx(Q,{size:"mini",variant:"danger",onClick:F=>{F.stopPropagation(),_e(B)},"aria-label":`Remove ${B.token}`,children:i.jsx(hr,{size:12})})]},`${B.token}-${B.index}`)})})]}):null,i.jsx(oc,{open:de,onClose:()=>_(!1),title:"Alias strength",tokenLabel:C?`${C.displayName}  $${(kt=C.tokenObj)==null?void 0:kt.token}$`:"",weight:(C==null?void 0:C.weight)??1,onApply:B=>{C!=null&&C.tokenObj&&(s==null||s(ql(P||"",C.tokenObj,B)))},onRemoveWeight:()=>{C!=null&&C.tokenObj&&(s==null||s(ql(P||"",C.tokenObj,null)))},onDeleteToken:()=>{C!=null&&C.tokenObj&&_e(C.tokenObj)}}),D.length?i.jsx(Q,{size:"sm",variant:"ghost",className:"stringinput-trailing",onClick:()=>m?m(e):U(),title:m?"Open prompt composer":"Insert alias","aria-label":m?"Open prompt composer":"Insert alias",children:m?i.jsx(hu,{size:16}):i.jsx(pr,{size:16})}):null,i.jsx(mf,{open:x,onClose:Ke,isPromptLike:lt,pickerSearch:k,onSearchChange:L,pickerSearchRef:be,categories:ce,pickerCategory:T,onCategoryChange:z,subcategories:W,pickerSubcategory:I,onSubcategoryChange:X,filteredAliases:ue,visibleAliases:Ae,visibleCount:xe,onShowMore:()=>ze(B=>Math.min(B+30,ue.length)),listItemVisibilityStyles:gf,onInsertAlias:Le})]})}const Pm=c.memo(Gw),vf=e=>e==null?void 0:String(e).trim().replace(/[^A-Za-z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||void 0;function Kw({name:e,label:t,description:n,value:r,onChange:s,disabled:l=!1,min:a,max:o,step:u,isFloat:d=!1,inputId:m}){const v=u??(d?.01:1),g=m??vf(e),y=S=>{if(S===""||S===null||S===void 0)return"";const h=d?parseFloat(S):parseInt(S,10);return Number.isNaN(h)?"":h},w=S=>{const h=S.target.value,f=y(h);s==null||s(f)},j=S=>{if(S.key!=="ArrowUp"&&S.key!=="ArrowDown")return;S.preventDefault();const h=typeof r=="number"?r:y(String(r??""))||0,f=S.key==="ArrowUp"?v:-v;let p=h+f;if(typeof a=="number"&&(p=Math.max(a,p)),typeof o=="number"&&(p=Math.min(o,p)),d){const x=typeof v=="number"?(String(v).split(".")[1]||"").length:2;p=parseFloat(p.toFixed(Math.max(x,2)))}s==null||s(p)};return i.jsxs("div",{className:"w-full flex items-center gap-2",children:[i.jsx("input",{id:g,name:e,type:"number",inputMode:d?"decimal":"numeric",value:r??"",onChange:w,onKeyDown:j,disabled:l,min:a,max:o,step:v,"aria-label":t||e,"aria-describedby":n?`${g||vf(e)||e}-description`:void 0,className:"ui-control ui-input"}),typeof a=="number"||typeof o=="number"?i.jsxs("div",{className:"hidden sm:flex flex-col text-[10px] text-[#6A6FA8] text-right leading-tight",children:[typeof a=="number"&&i.jsxs("span",{children:["min ",a]}),typeof o=="number"&&i.jsxs("span",{children:["max ",o]})]}):null]})}const Xs=c.memo(Kw);function Qw({name:e,label:t,description:n,value:r,onChange:s,disabled:l=!1}){const a=!!r,o=()=>{l||s==null||s(!a)},u=d=>{(d.key===" "||d.key==="Enter")&&(d.preventDefault(),o())};return i.jsxs("button",{id:e,type:"button",role:"switch","aria-checked":a,"aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0,onClick:o,onKeyDown:u,disabled:l,className:`ui-switch ${a?"is-on":""}`,children:[i.jsx("span",{className:"ui-switch-track",children:i.jsx("span",{className:"ui-switch-knob"})}),i.jsx("span",{className:"ui-switch-state",children:a?"On":"Off"})]})}const zm=c.memo(Qw);function Yw(e,t){try{if(typeof window>"u"||!e)return null;const n=e.getItem(t);return n?JSON.parse(n):null}catch{return null}}function ya(e,t,n){try{if(typeof window>"u"||!e)return;e.setItem(t,JSON.stringify(n))}catch{}}function gn(){try{return typeof window>"u"?null:window.sessionStorage||null}catch{return null}}function Es(){try{return typeof window>"u"?null:window.localStorage||null}catch{return null}}const _m=750,$n=new Map,Sn=new Map,jn=new Map,ds=new Map,kn=new Map,Nn=new Map;function Rm(e){var t;if(Sn.has(e)&&(clearTimeout(Sn.get(e)),Sn.delete(e)),jn.has(e)){try{(t=window.cancelIdleCallback)==null||t.call(window,jn.get(e))}catch{}jn.delete(e)}$n.has(e)&&(ya(gn(),e,$n.get(e)),$n.delete(e))}function qw(e){var r;if(Sn.has(e)&&(clearTimeout(Sn.get(e)),Sn.delete(e)),jn.has(e)){try{(r=window.cancelIdleCallback)==null||r.call(window,jn.get(e))}catch{}jn.delete(e)}const t=()=>{$n.has(e)&&(ya(gn(),e,$n.get(e)),$n.delete(e))},n=setTimeout(()=>{Sn.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const s=window.requestIdleCallback(()=>{jn.delete(e),t()},{timeout:2500});jn.set(e,s);return}}catch{}t()},_m);Sn.set(e,n)}function Xw(){Array.from(Sn.values()).forEach(e=>clearTimeout(e)),Sn.clear(),Array.from(jn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),jn.clear(),Array.from($n.entries()).forEach(([e,t])=>{ya(gn(),e,t)}),$n.clear(),Array.from(kn.values()).forEach(e=>clearTimeout(e)),kn.clear(),Array.from(Nn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),Nn.clear(),Array.from(ds.entries()).forEach(([e,t])=>{try{const n=gn();n&&n.setItem(e,t)}catch{}}),ds.clear()}if(typeof window<"u"&&!window.__cozygenFormStateFlush){const e=()=>Xw();window.addEventListener("beforeunload",e),window.addEventListener("pagehide",e),window.__cozygenFormStateFlush=!0}function Jw(e){var r;if(!e)return{};const t=`${e}_formData`,n=Yw(gn(),t);if(n&&typeof n=="object")return n;try{const s=Es();(r=s==null?void 0:s.removeItem)==null||r.call(s,t)}catch{}return{}}function Wi(e,t,n={}){var l;if(!e)return;const{immediate:r=!1}=n||{},s=`${e}_formData`;if(r){Rm(s),ya(gn(),s,t||{});try{const a=Es();(l=a==null?void 0:a.removeItem)==null||l.call(a,s)}catch{}return}$n.set(s,t||{}),qw(s)}function Zw(e){e&&Rm(`${e}_formData`)}function e0(e,t,n=_m){var l;if(ds.set(e,t),kn.has(e)&&(clearTimeout(kn.get(e)),kn.delete(e)),Nn.has(e)){try{(l=window.cancelIdleCallback)==null||l.call(window,Nn.get(e))}catch{}Nn.delete(e)}const r=()=>{const a=ds.get(e);ds.delete(e);try{const o=gn();o&&o.setItem(e,a)}catch{}},s=setTimeout(()=>{kn.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const a=window.requestIdleCallback(()=>{Nn.delete(e),r()},{timeout:2e3});Nn.set(e,a);return}}catch{}r()},n);kn.set(e,s)}function t0(e,t={}){var s,l;const{immediate:n=!1}=t||{},r="cozygen_last_param";if(n){if(kn.has(r)&&(clearTimeout(kn.get(r)),kn.delete(r)),Nn.has(r)){try{(s=window.cancelIdleCallback)==null||s.call(window,Nn.get(r))}catch{}Nn.delete(r)}ds.delete(r);try{const a=gn();a&&a.setItem(r,e||"");const o=Es();(l=o==null?void 0:o.removeItem)==null||l.call(o,r)}catch{}return}e0(r,e||"")}function n0(){var t,n;const e="cozygen_last_param";try{const r=gn(),s=((t=r==null?void 0:r.getItem)==null?void 0:t.call(r,e))||"";if(s)return s;const l=Es();(n=l==null?void 0:l.removeItem)==null||n.call(l,e)}catch{}return""}function Im(e,t){const n=e?String(e):"global",r=t?String(t):"";return`cozygen_dropdown_folder:${n}:${r}`}function yf(e,t){var r,s;const n=Im(e,t);try{const l=gn(),a=((r=l==null?void 0:l.getItem)==null?void 0:r.call(l,n))||"";if(a)return a;const o=Es();(s=o==null?void 0:o.removeItem)==null||s.call(o,n)}catch{}return""}function r0(e,t,n){var s;const r=Im(e,t);try{const l=gn();l&&l.setItem(r,String(n||""));const a=Es();(s=a==null?void 0:a.removeItem)==null||s.call(a,r)}catch{}}function s0({workflowName:e,name:t,label:n,description:r,value:s,onChange:l,disabled:a=!1,options:o=[]}){const u=s??"",[d,m]=c.useState(()=>yf(e,t)||"All");c.useEffect(()=>{const x=yf(e,t);m(x||"All")},[e,t]);const v=c.useMemo(()=>(o||[]).map(x=>typeof x=="string"?{value:x,label:x}:{value:x.value??x.name??"",label:x.label??x.name??String(x.value??"")}),[o]),g=x=>{const N=typeof(x==null?void 0:x.value)=="string"||typeof(x==null?void 0:x.value)=="number"?String(x.value):"",k=typeof(x==null?void 0:x.label)=="string"||typeof(x==null?void 0:x.label)=="number"?String(x.label):"";return ws(N)?N:ws(k)?k:""},y=c.useMemo(()=>v.map(x=>{const N=g(x);if(!N)return{opt:x,path:"",base:"",folderPath:""};const{folderPath:k,base:L}=va(N);return{opt:x,path:N,base:L,folderPath:k||"root"}}),[v]),w=c.useMemo(()=>{const x=new Set(["All"]);return y.forEach(({path:N,folderPath:k})=>{N&&x.add(k||"root")}),Array.from(x).sort((N,k)=>N.localeCompare(k))},[y]),j=w.length>2;c.useEffect(()=>{if(!j){d!=="All"&&m("All");return}w.includes(d)||m("All")},[w,d,j]),c.useEffect(()=>{r0(e,t,d)},[e,t,d]);const S=c.useMemo(()=>{const x=new Map;return y.forEach(({base:N})=>{if(!N)return;const k=N.toLowerCase();x.set(k,(x.get(k)||0)+1)}),x},[y]),h=c.useMemo(()=>{const x=[],N=j&&d==="All";return y.forEach(({opt:k,path:L,base:R,folderPath:T})=>{if(!L){x.push(k);return}const z=T||"root";if(j&&d!=="All"&&z!==d)return;let I=R||xn(L)||k.label;if(N&&R){const X=R.toLowerCase();if(S.get(X)>1){const Y=z==="root"?"root":z.split("/").pop()||z;I=`${I} (${Y})`}}x.push({...k,label:I})}),x.sort((k,L)=>String(k.label||"").localeCompare(String(L.label||"")))},[y,S,d,j]),f=c.useMemo(()=>u===""||u===null||u===void 0?!0:h.some(x=>String(x.value)===String(u)),[h,u]),p=x=>{const N=x&&x.target?x.target.value:x;l==null||l(N)};return i.jsxs("div",{className:"w-full space-y-2",children:[j?i.jsx("div",{className:"relative w-full",children:i.jsx(rt,{value:d,onChange:m,disabled:a,"aria-label":`Choose folder for ${n||t}`,size:"sm",options:w.map(x=>({value:x,label:x}))})}):null,i.jsx("div",{className:"relative w-full",children:i.jsx(rt,{id:t,name:t,value:u,onChange:p,disabled:a,"aria-label":n||t,"aria-describedby":r?`${t}-description`:void 0,placeholder:h.length>0&&(u===void 0||u==="")?"Select...":void 0,emptyLabel:"No matches",options:[...!f&&u!==""?[{value:u,label:xn(String(u))}]:[],...h]},`${t||"field"}:${d}`)})]})}const yu=c.memo(s0);function xf(e=[]){return e.map(t=>typeof t=="string"?{value:t,label:t}:{value:t.value??t.name??"",label:t.label??t.name??String(t.value??"")})}function wf(e,t){if(!e)return null;const n=String(e);if(t==="high"){const r=n.match(/(.+)-high(\.[^.]*)?$/i);return r?r[1]:null}if(t==="low"){const r=n.match(/(.+)-low(\.[^.]*)?$/i);return r?r[1]:null}return null}function l0(e){return e?e.replace(/[_-]+/g," ").replace(/\s+/g," ").trim().replace(/^./,t=>t.toUpperCase()):""}const i0=(...e)=>e.flat().map(n=>String(n??"").trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")).filter(Boolean).join("-")||"field";function a0({name:e,label:t,description:n,highParam:r,lowParam:s,highChoices:l=[],lowChoices:a=[],formData:o={},onChangeParam:u,highStrengthParam:d,lowStrengthParam:m,strengthValue:v,onChangeStrength:g,highStrengthValue:y,lowStrengthValue:w,onChangeHighStrength:j,onChangeLowStrength:S,disabled:h=!1}){const f=c.useMemo(()=>xf(l),[l]),p=c.useMemo(()=>xf(a),[a]),x=c.useMemo(()=>{const ee=new Map;p.forEach(W=>{const O=wf(W.value,"low");O&&(ee.has(O)||ee.set(O,W))});const ce=[];return f.forEach(W=>{const O=wf(W.value,"high");if(!O)return;const U=ee.get(O);U&&ce.push({base:O,label:l0(O),highValue:W.value,lowValue:U.value})}),ce.sort((W,O)=>W.label.localeCompare(O.label)),ce},[f,p]),N=c.useMemo(()=>{const ee=o[r],ce=o[s];if(!ee||!ce)return"";const W=x.find(O=>O.highValue===ee&&O.lowValue===ce);return W?W.base:""},[o,r,s,x]),k=d||m||`${e}_strength`,L=c.useMemo(()=>i0(e||"lora",k||"strength"),[e,k]),R=!!(d||m),T=!!(d&&m),z=(ee,ce=1)=>typeof ee=="number"?ee:ce,I=z(typeof v=="number"?v:typeof y=="number"?y:typeof w=="number"?w:void 0,1),X=z(typeof y=="number"?y:void 0,I),Y=z(typeof w=="number"?w:void 0,T?I:X),be=T&&Math.abs(X-Y)>1e-4,[ve,ae]=c.useState(be);c.useEffect(()=>{ae(be)},[be,r,s]);const de=ee=>{if(!u)return;const ce=x.find(W=>W.base===ee);ce&&(u(r,ce.highValue),u(s,ce.lowValue))};if(x.length===0)return i.jsxs("div",{className:"text-[11px] text-[#9DA3FFCC]",children:["No matching ",i.jsx("span",{className:"font-semibold",children:"-high"})," /"," ",i.jsx("span",{className:"font-semibold",children:"-low"})," LoRA pairs found."]});const _=`${L}-linked`,C=`${L}-high`,$=`${L}-low`,P=T?"Linked":"Strength",D=T?"Applies to high + low":d||m||"",H=(ee,ce)=>{const W=Array.isArray(ee)?ee:[ee];let O=!1;W.forEach(U=>{if(U==="high"&&typeof j=="function"){j(ce);return}if(U==="low"&&typeof S=="function"){S(ce);return}typeof g=="function"&&!O&&(g(ce),O=!0)})},le=ee=>{(d||!d&&!m)&&H("high",ee),m&&H("low",ee)},Z=()=>{T&&ae(ee=>{const ce=!ee;return ce||le(typeof X=="number"?X:typeof Y=="number"?Y:I),ce})};return i.jsxs("div",{className:"space-y-2",children:[i.jsx(yu,{name:`${e}_pair`,label:t,description:n,value:N||"",onChange:de,disabled:h,options:x.map(ee=>({value:ee.base,label:ee.label}))}),R&&i.jsxs("div",{className:"space-y-1.5",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-[10px] uppercase tracking-[0.16em] text-[#9DA3FFCC]",children:"Strength"}),T&&i.jsx("button",{type:"button",className:"text-[10px] font-semibold tracking-[0.12em] uppercase text-[#E5E7FF]",onClick:Z,disabled:h,children:ve?"Link values":"Split values"})]}),ve&&T?i.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-3",children:[i.jsxs("div",{className:"flex-1 max-w-[220px]",children:[i.jsxs("label",{htmlFor:C,className:"lora-strength-label is-high",children:[i.jsx("span",{className:"lora-strength-label-pill",children:"High"}),i.jsxs("span",{className:"lora-strength-label-text",children:["High strength",d&&i.jsx("span",{className:"lora-strength-label-hint",children:d})]})]}),i.jsx(Xs,{name:`${k}_high`,label:"High strength",description:"",value:X,onChange:ee=>H("high",ee),disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:C})]}),i.jsxs("div",{className:"flex-1 max-w-[220px]",children:[i.jsxs("label",{htmlFor:$,className:"lora-strength-label is-low",children:[i.jsx("span",{className:"lora-strength-label-pill",children:"Low"}),i.jsxs("span",{className:"lora-strength-label-text",children:["Low strength",m&&i.jsx("span",{className:"lora-strength-label-hint",children:m})]})]}),i.jsx(Xs,{name:`${k}_low`,label:"Low strength",description:"",value:Y,onChange:ee=>H("low",ee),disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:$})]})]}):i.jsxs("div",{className:"flex-1 max-w-[220px]",children:[i.jsxs("label",{htmlFor:_,className:"lora-strength-label is-linked",children:[i.jsx("span",{className:"lora-strength-label-pill",children:P}),i.jsxs("span",{className:"lora-strength-label-text",children:["LoRA strength",D&&i.jsx("span",{className:"lora-strength-label-hint",children:D})]})]}),i.jsx(Xs,{name:k,label:"LoRA strength",description:"",value:I,onChange:le,disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:_})]})]})]})}function o0(e,t){if(e.disabled!==t.disabled||e.name!==t.name||e.label!==t.label||e.description!==t.description||e.highParam!==t.highParam||e.lowParam!==t.lowParam||e.highStrengthParam!==t.highStrengthParam||e.lowStrengthParam!==t.lowStrengthParam||e.strengthValue!==t.strengthValue||e.highStrengthValue!==t.highStrengthValue||e.lowStrengthValue!==t.lowStrengthValue||e.highChoices!==t.highChoices||e.lowChoices!==t.lowChoices||e.onChangeParam!==t.onChangeParam||e.onChangeStrength!==t.onChangeStrength||e.onChangeHighStrength!==t.onChangeHighStrength||e.onChangeLowStrength!==t.onChangeLowStrength)return!1;const n=e.formData||{},r=t.formData||{};return!(n[e.highParam]!==r[t.highParam]||n[e.lowParam]!==r[t.lowParam])}const Am=c.memo(a0,o0),c0=16,u0=[" - "," ","-","_"],Tm=e=>[...new Set(e.filter(Boolean))],Hi=(e,t)=>{const n=String(e||"").trim(),r=u0.map(s=>`${n}${s}${t}`);return r.push(`${n}${t}`),Tm(r)},Sf=(e,t)=>{const n=Hi(`${e} Strength`,t),r=Hi(e,t).map(s=>`${s} Strength`);return Tm([...n,...r])},jf=e=>String(e||"").toLowerCase().replace(/[\s_-]+/g,""),Jl=(e,t=[])=>{if(!e)return null;const n=Array.isArray(t)?t:[t];for(const s of n){if(!s)continue;const l=e.get(s);if(l)return{name:s,input:l}}const r=new Map;n.forEach(s=>{s&&r.set(jf(s),s)});for(const[s,l]of e.entries()){const a=jf(s);if(r.has(a))return{name:s,input:l}}return null},d0=Array.from({length:c0},(e,t)=>{const n=t+1,r=Hi("Lora High",n),s=Hi("Lora Low",n),l=Sf("Lora High",n),a=Sf("Lora Low",n);return{id:`video_lora_${n}`,label:`Video LoRA ${n}`,highParam:r[0],lowParam:s[0],highParamAliases:r,lowParamAliases:s,highStrengthParam:l[0],lowStrengthParam:a[0],highStrengthParamAliases:l,lowStrengthParamAliases:a}}),f0=e=>{var r,s;const t=((r=e==null?void 0:e.inputs)==null?void 0:r.param_type)||((s=e==null?void 0:e.inputs)==null?void 0:s.Param_type),n=String(t||"STRING").toUpperCase();return["NUMBER","FLOAT","INT"].includes(n)?"NUMBER":["BOOLEAN","BOOL"].includes(n)?"BOOLEAN":["DROPDOWN","CHOICE","SELECT"].includes(n)?"DROPDOWN":"STRING"},p0=e=>{const t=(e==null?void 0:e.inputs)||{};return t.label||t.display_name||t.title||t.param_name||(e==null?void 0:e.title)||(e==null?void 0:e.class_type)||"Parameter"},h0=e=>{const t=(e==null?void 0:e.inputs)||{};return t.description||t.help||t.tooltip||t.doc||""},Gr=e=>{const t=(e==null?void 0:e.inputs)||{};return t.param_name||t.name||t.key||t.id||`param_${(e==null?void 0:e.id)||"unknown"}`},Bs=e=>{const t=(e==null?void 0:e.inputs)||{},n=t.choices||t.options||[],r=t.default_value??t.value??t.default_choice??(n&&n.length?n[0]:"")??"";return{paramName:Gr(e),label:p0(e),description:h0(e),paramType:f0(e),multiline:!!t.multiline,min:typeof t.min=="number"?t.min:void 0,max:typeof t.max=="number"?t.max:void 0,step:typeof t.step=="number"?t.step:void 0,choices:n,defaultValue:r}},m0=(e,t)=>{if((e==null?void 0:e.paramType)==="BOOLEAN")return t?"On":"Off";if(t==null||t==="")return"Empty";if(typeof t=="string"){const n=t.trim();if(!n)return"Empty";const r=240,s=140,l=n.length>r?n.slice(0,r):n,o=/[\r\n\t]/.test(l)||/\s{2,}/u.test(l)?l.replace(/\s+/gu," ").trim():l;if(o.length>s)return`${o.slice(0,s)}`;const u=Mw(o);return n.length>r?`${u}`:u}return String(t)};function g0({id:e,label:t,description:n,preview:r,expanded:s=!1,onToggle:l,children:a,trailing:o,className:u=""}){const d=typeof l=="function",m=e?`${e}-description`:void 0,v=e?`${e}-panel`:void 0,g=typeof t=="string"?t.trim().replace(/\s+/gu," ").replace(/:\s*$/u,""):t,y=typeof n=="string"?n.trim().replace(/\s+/gu," "):n,w=typeof r=="string"||typeof r=="number"?String(r):void 0,j=d?"button":"div",S=d?{type:"button",onClick:l,"aria-expanded":s,"aria-controls":v,"aria-describedby":y?m:void 0}:{};return i.jsxs("div",{className:["field-row",u].filter(Boolean).join(" "),children:[i.jsxs(j,{...S,className:["field-row-head",d?"is-collapsible":"is-static",s?"is-expanded":""].filter(Boolean).join(" "),children:[i.jsxs("div",{className:"field-row-main",children:[i.jsx("div",{className:"field-row-label",children:g}),y?i.jsx("div",{id:m,className:"field-row-description",children:y}):null]}),i.jsxs("div",{className:"field-row-trailing",children:[o?i.jsx("div",{className:"field-row-trailing-control",children:o}):null,r?i.jsx("div",{className:"field-row-preview",title:w,children:r}):null,d?i.jsx("div",{className:"field-row-chevron","aria-hidden":"true",children:i.jsx(ha,{size:16})}):null]})]}),d&&s?i.jsx("div",{id:v,className:"field-row-body",children:a}):null]})}const cc=c.memo(g0);function v0({paramName:e,cfg:t,formData:n,loraPair:r,collapsed:s,onToggle:l,formatPreview:a,onChangeParam:o,changeHandlers:u}){const{id:d,label:m,highParam:v,lowParam:g,highStrengthParam:y,lowStrengthParam:w,highCfg:j,lowCfg:S}=r,h=y?n[y]:void 0,f=w?n[w]:void 0,p=h??f??1,x=s?a(t,[n[v],n[g]].filter(Boolean).join("  ")):null,N=e?`param-${e}`:void 0;return i.jsx("div",{id:N,"data-param-name":e,"data-param-label":m||t.label,"data-param-type":"lora_pair",className:"settings-row",children:i.jsx(cc,{id:e,label:m||t.label,description:t.description,preview:x,expanded:!s,onToggle:l,children:s?null:i.jsx(Am,{name:d||v,label:m||t.label,highParam:v,lowParam:g,highChoices:j.choices,lowChoices:S.choices,formData:n,onChangeParam:o,highStrengthParam:y,lowStrengthParam:w,strengthValue:p,highStrengthValue:h,lowStrengthValue:f,onChangeHighStrength:y?u.get(y):void 0,onChangeLowStrength:w?u.get(w):void 0,disabled:!1},`lora-${e}`)})})}function y0({paramName:e,cfg:t,formData:n,workflowName:r,spotlightName:s,spotlightRenderKey:l,aliasOptions:a,aliasCatalog:o,onOpenComposer:u,changeHandlers:d,enterHandlers:m,collapsed:v,previewValue:g,onToggle:y}){const w=n[e],j={name:e,label:t.label,description:t.description,value:w,disabled:!1,defaultValue:t.defaultValue},S=(f=n,p=!1)=>{const x={...j,value:f==null?void 0:f[e]};return t.paramType==="NUMBER"?i.jsx(Xs,{...x,inputId:e,onChange:d.get(e),min:t.min,max:t.max,step:t.step,isFloat:!0},`field-${e}-number-${l}`):t.paramType==="BOOLEAN"?i.jsx(zm,{...x,onChange:d.get(e)},`field-${e}-bool-${l}`):t.paramType==="DROPDOWN"?i.jsx(yu,{...x,workflowName:r,onChange:d.get(e),options:t.choices||[]},`field-${e}-dropdown-${l}`):i.jsx(Pm,{...x,aliasOptions:a,aliasCatalog:o,onOpenComposer:u,onChange:d.get(e),onEnter:m.get(e),multiline:t.multiline||s===e||p},`field-${e}-string-${l}`)},h=e?`param-${e}`:void 0;return t.paramType==="BOOLEAN"?i.jsx("div",{id:h,"data-param-name":e,"data-param-label":t.label,"data-param-type":"single",className:"settings-row",children:i.jsx(cc,{id:e,label:t.label,description:t.description,trailing:S(n,!0)})}):i.jsx("div",{id:h,"data-param-name":e,"data-param-label":t.label,"data-param-type":"single",className:"settings-row",children:i.jsx(cc,{id:e,label:t.label,description:t.description,preview:g,expanded:!v,onToggle:y,children:v?null:S(n,!0)})})}function x0({inputs:e=[],formData:t={},onFormChange:n,workflowName:r,onParamEdited:s,onSpotlight:l,compactControls:a=!0,collapseAllKey:o=0,collapseAllCollapsed:u=!0,lastEditedParam:d="",spotlightName:m="",onCloseSpotlight:v=()=>{},onVisibleParamsChange:g=()=>{},aliasOptions:y=[],aliasCatalog:w=[],onOpenComposer:j}){const[S,h]=c.useState({}),[f,p]=c.useState(0),x=c.useRef(t);c.useEffect(()=>{x.current=t},[t]);const N=c.useCallback((C,$)=>m0(C,$),[]),k=c.useCallback((C,$)=>{!n||!C||(n(C,$),s==null||s(C),h(P=>(P==null?void 0:P[C])===!1?P:{...P,[C]:!1}))},[n,s]),L=c.useCallback(C=>{C&&h($=>({...$,[C]:!($!=null&&$[C])}))},[]),R=c.useMemo(()=>e||[],[e]),T=c.useMemo(()=>{const C=new Map;return(R||[]).forEach($=>{const P=Gr($);P&&C.set(P,D=>k(P,D))}),C},[k,R]),z=c.useMemo(()=>{const C=new Map;return(R||[]).forEach($=>{const P=Gr($);P&&C.set(P,(D,H)=>{var le,Z;k(P,D),(Z=(le=H==null?void 0:H.target)==null?void 0:le.blur)==null||Z.call(le),m===P&&(v==null||v())})}),C},[k,v,m,R]),I=c.useMemo(()=>{const C=new Map;return(R||[]).forEach($=>{const P=Gr($);P&&C.set(P,()=>L(P))}),C},[L,R]);c.useEffect(()=>{const C={};(e||[]).forEach($=>{const P=Gr($);P&&(C[P]=u)}),d&&(C[d]=!1),h(C)},[o,u,e,d]);const X=c.useMemo(()=>{const C=new Map;return(e||[]).forEach($=>{const P=Gr($);P&&C.set(P,$)}),C},[e]),Y=c.useMemo(()=>{const C=[];return d0.forEach($=>{const P=Jl(X,$.highParamAliases||$.highParam),D=Jl(X,$.lowParamAliases||$.lowParam);if(!P||!D)return;const H=P.input,le=D.input,Z=Bs(H),ee=Bs(le);if(Z.paramType!=="DROPDOWN"||ee.paramType!=="DROPDOWN")return;const ce=Z.choices||[],W=ee.choices||[];if(!ce.length||!W.length)return;const O=Jl(X,$.highStrengthParamAliases||$.highStrengthParam),U=Jl(X,$.lowStrengthParamAliases||$.lowStrengthParam);C.push({...$,highParam:P.name,lowParam:D.name,highStrengthParam:O==null?void 0:O.name,lowStrengthParam:U==null?void 0:U.name,highInput:H,lowInput:le,highCfg:Z,lowCfg:ee})}),C},[X]),be=c.useMemo(()=>{const C=new Map;return Y.forEach($=>{C.set($.highParam,$)}),C},[Y]),ve=c.useMemo(()=>{const C=new Set;return Y.forEach($=>{C.add($.highParam),C.add($.lowParam),$.highStrengthParam&&C.add($.highStrengthParam),$.lowStrengthParam&&C.add($.lowStrengthParam)}),C},[Y]),ae=c.useMemo(()=>{const C=[];return(R||[]).forEach($=>{const P=Bs($),D=P.paramName,H=be.get(D);if(H){C.push({name:D,label:H.label||P.label,description:P.description,render:le=>{const Z=le||x.current||{},ee=H.highStrengthParam?Z[H.highStrengthParam]:void 0,ce=H.lowStrengthParam?Z[H.lowStrengthParam]:void 0,W=ee??ce??1;return i.jsx(Am,{name:H.id||H.highParam,label:H.label||P.label,highParam:H.highParam,lowParam:H.lowParam,highChoices:H.highCfg.choices,lowChoices:H.lowCfg.choices,formData:Z,onChangeParam:k,highStrengthParam:H.highStrengthParam,lowStrengthParam:H.lowStrengthParam,strengthValue:W,highStrengthValue:ee,lowStrengthValue:ce,onChangeHighStrength:H.highStrengthParam?T.get(H.highStrengthParam):void 0,onChangeLowStrength:H.lowStrengthParam?T.get(H.lowStrengthParam):void 0,disabled:!1},`lora-${D}-${f}`)}});return}ve.has(D)||C.push({name:D,label:P.label,description:P.description,render:le=>{const Z=le||x.current||{},ee={name:D,label:P.label,description:P.description,value:Z[D],defaultValue:P.defaultValue,disabled:!1};return P.paramType==="NUMBER"?i.jsx(Xs,{...ee,onChange:T.get(D),min:P.min,max:P.max,step:P.step,isFloat:!0},`field-${D}-number-${f}`):P.paramType==="BOOLEAN"?i.jsx(zm,{...ee,onChange:T.get(D)},`field-${D}-bool-${f}`):P.paramType==="DROPDOWN"?i.jsx(yu,{...ee,workflowName:r,onChange:T.get(D),options:P.choices||[]},`field-${D}-dropdown-${f}`):i.jsx(Pm,{...ee,aliasOptions:y,aliasCatalog:w,onOpenComposer:j,onChange:T.get(D),onEnter:z.get(D),multiline:P.multiline},`field-${D}-string-${f}`)}})}),C},[R,be,ve,f,r,y,w,j,k,T,z,m,v]),de=c.useMemo(()=>{const C=new Map;return ae.forEach($=>C.set($.name,$)),C},[ae]);c.useEffect(()=>{g==null||g(ae.map(C=>C.name))},[ae,g]);const _=c.useCallback(C=>{const $=ae.map(Z=>Z.name),P=de.get(C);if(!P)return;const D=$.indexOf(C),H=D>0?$[D-1]:null,le=D>=0&&D<$.length-1?$[D+1]:null;p(Z=>Z+1),l==null||l({name:C,label:P.label,description:P.description,render:Z=>P.render(Z||x.current),order:$,index:D>=0?D:0,total:$.length,onPrev:H?()=>_(H):null,onNext:le?()=>_(le):null})},[de,l,ae]);return i.jsx("div",{className:"settings-list",children:R.map(C=>{const $=Bs(C),P=$.paramName,D=be.get(P);if(D){const Z=a?S[P]??!0:!!S[P];return i.jsx(v0,{paramName:P,cfg:$,formData:t,loraPair:D,collapsed:Z,onToggle:I.get(P),formatPreview:N,onChangeParam:k,changeHandlers:T},`lora_pair_${D.id||D.highParam}`)}if(ve.has(P))return null;const H=a?S[P]??!0:!!S[P],le=H?N($,t[P]):null;return i.jsx(y0,{paramName:P,cfg:$,formData:t,workflowName:r,spotlightName:m,spotlightRenderKey:f,aliasOptions:y,aliasCatalog:w,onOpenComposer:j,changeHandlers:T,enterHandlers:z,collapsed:H,previewValue:le,onToggle:I.get(P)},P)})})}function w0(e){return(e||[]).map(t=>{var n;if(["CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"].includes(t.class_type)){let r=t.class_type.replace("CozyGen","").replace("Input","").toUpperCase();return r==="CHOICE"&&(r="DROPDOWN"),{...t,inputs:{...t.inputs,param_type:r,Multiline:((n=t.inputs)==null?void 0:n.display_multiline)||!1}}}return t})}function S0({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:l=!1,collapseAllState:a=null,onSpotlight:o,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:v=[],aliasCatalog:g=[],onOpenComposer:y}){const w=c.useMemo(()=>w0((t||[]).filter(j=>j.class_type!=="CozyGenImageInput")),[t]);return i.jsx("section",{className:"settings-surface scroll-mt-24",ref:s,children:i.jsx(x0,{workflowName:e,inputs:w,formData:n,onFormChange:r,compactControls:l,collapseAllKey:(a==null?void 0:a.key)??0,collapseAllCollapsed:(a==null?void 0:a.collapsed)??!0,onSpotlight:o,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:v,aliasCatalog:g,onOpenComposer:y})})}function j0({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,parameterSectionRef:s,compactControls:l=!0,collapseAllState:a=null,onSpotlight:o,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:v=[],aliasCatalog:g=[],onOpenComposer:y}){return i.jsx(S0,{workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:l,collapseAllState:a,onSpotlight:o,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:v,aliasCatalog:g,onOpenComposer:y})}function kf(e){try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return""}}function k0({open:e,onClose:t,logs:n=[],onClear:r}){const s=c.useMemo(()=>(n||[]).map(l=>`[${kf(l.ts)}] ${String(l.level||"info").toUpperCase()} ${l.message}`).join(`
`),[n]);return i.jsx(Ut,{open:e,onClose:t,title:"Run logs",footer:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:()=>{var l,a;try{(a=(l=navigator.clipboard)==null?void 0:l.writeText)==null||a.call(l,s||"")}catch{}},children:"Copy"}),i.jsx(Q,{variant:"ghost",className:"w-full",onClick:r,children:"Clear"}),i.jsx(Q,{variant:"primary",className:"w-full",onClick:t,children:"Close"})]}),children:i.jsx("pre",{className:"runlog-pre",children:n!=null&&n.length?n.map((l,a)=>i.jsxs("div",{className:`runlog-line is-${l.level||"info"}`,children:[i.jsx("span",{className:"runlog-ts",children:kf(l.ts)}),i.jsx("span",{className:"runlog-msg",children:l.message})]},`${l.ts}-${a}`)):"No logs yet."})})}const N0="cozygen_field_order_v1";function C0(e,t){if(!e)return t;try{const n=JSON.parse(e);return n&&typeof n=="object"?n:t}catch{return t}}function E0(){if(typeof window>"u")return{};try{return C0(window.localStorage.getItem(N0),{})}catch{return{}}}function b0(e){if(Array.isArray(e))return{order:e.filter(Boolean),hidden:{}};if(!e||typeof e!="object")return{order:[],hidden:{}};const t=Array.isArray(e.order)?e.order.filter(Boolean):[],n=e.hidden&&typeof e.hidden=="object"?e.hidden:{};return{order:t,hidden:n}}function L0(e){if(!e)return{order:[],hidden:{}};const n=E0()[e];return b0(n)}function P0(e,t){let n=Array.isArray(t)?t:[];if(!e||n.length===0)return n;const{order:r,hidden:s}=L0(e);if(r&&r.length){const l=new Map;n.forEach(o=>{var d;const u=(d=o==null?void 0:o.inputs)==null?void 0:d.param_name;u&&!l.has(u)&&l.set(u,o)});const a=[];r.forEach(o=>{const u=l.get(o);u&&(a.push(u),l.delete(o))}),n.forEach(o=>{var d;const u=(d=o==null?void 0:o.inputs)==null?void 0:d.param_name;if(!u){a.push(o);return}l.has(u)&&(a.push(o),l.delete(u))}),n=a}return n=n.filter(l=>{var o;const a=(o=l==null?void 0:l.inputs)==null?void 0:o.param_name;return a?!s[a]:!0}),n}function z0(){const[e,t]=c.useState([]),[n,r]=c.useState(null),[s,l]=c.useState(!0),[a,o]=c.useState(null);c.useEffect(()=>{let d=!1;async function m(){l(!0),o(null);try{const v=await Gx();if(d)return;const g=(v==null?void 0:v.workflows)||[];t(g);let y=null;try{if(y=typeof window<"u"?sessionStorage.getItem("selectedWorkflow"):null,typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{y=null}if(y&&g.includes(y))r(y);else if(g.length>0){r(g[0]);try{typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",g[0])}catch{}}else r(null)}catch(v){if(d)return;console.error("Failed to load workflows",v),o(v)}finally{d||l(!1)}}return m(),()=>{d=!0}},[]);const u=c.useCallback(d=>{r(d);try{if(typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",d),typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{}},[]);return{workflows:e,selectedWorkflow:n,selectWorkflow:u,loading:s,error:a}}const _0={clip_name1:"clip",clip_name2:"clip",unet_name:"unet",vae_name:"vae",sampler_name:"sampler",scheduler:"scheduler"},R0=["CozyGenDynamicInput","CozyGenImageInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"];function I0(e){const[t,n]=c.useState(null),[r,s]=c.useState([]),[l,a]=c.useState({}),[o,u]=c.useState(!1),[d,m]=c.useState(null);c.useEffect(()=>{if(!e){n(null),s([]),a({});return}let w=!1;const j=new AbortController;async function S(){u(!0),m(null);try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:workflow:load")}catch{}try{const h=await Kx(e,{signal:j.signal});if(w)return;for(const k in h){const L=h[k];L.class_type==="CozyGenImageInput"&&!L.inputs.param_name&&(L.inputs.param_name="Image Input"),h[k].id=k}n(h);const f=Object.values(h).filter(k=>R0.includes(k.class_type)),p=await Promise.all(f.map(async k=>{const L=k.class_type==="CozyGenDynamicInput"&&k.inputs.param_type==="DROPDOWN",R=k.class_type==="CozyGenChoiceInput";if(L||R){const T=k.inputs.param_name;let z=k.inputs.choice_type||k.properties&&k.properties.choice_type;if(!z&&L&&(z=_0[T]),z)try{const I=await ec(z,{signal:j.signal,refresh:z==="loras"});k.inputs.choices=I.choices||[]}catch(I){(I==null?void 0:I.name)!=="AbortError"&&console.error(`Choices for ${T} failed`,I),k.inputs.choices=[]}}return k}));if(w)return;s(p);const x=Jw(e),N={};p.forEach(k=>{const L=k.inputs.param_name;if(!L)return;if(x[L]!==void 0){N[L]=x[L];return}let R;if(["CozyGenDynamicInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput"].includes(k.class_type)){if(R=k.inputs.default_value,k.class_type==="CozyGenIntInput"){const T=parseInt(R,10);R=Number.isNaN(T)?0:T}else if(k.class_type==="CozyGenFloatInput"){const T=parseFloat(R);R=Number.isNaN(T)?0:T}}else if(k.class_type==="CozyGenChoiceInput"){const T=k.inputs.choices||[];R=T.length?T[0]:""}else k.class_type,R="";N[L]=R}),a(N);try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:workflow:ready"),performance.measure(`cozygen:workflow:ready:${e||"unknown"}`,"cozygen:workflow:load","cozygen:workflow:ready"))}catch{}}catch(h){if(w)return;console.error("Failed to load workflow",h),m(h),n(null),s([])}finally{w||u(!1)}}return S(),()=>{Zw(e),w=!0,j.abort()}},[e]);const v=c.useMemo(()=>r.filter(w=>w.class_type==="CozyGenImageInput"),[r]),g=v[0]||null,y=c.useCallback((w,j)=>{a(S=>{const h={...S,[w]:j};return e&&Wi(e,h),h})},[e]);return{workflowData:t,dynamicInputs:r,imageInputs:v,primaryImageInput:g,formData:l,setFormData:a,handleFormChange:y,loading:o,error:d}}const Nf="::";function Js(e){const t={};return Object.entries(e||{}).forEach(([n,r])=>{const s=String(n||"").trim();if(!s||typeof r!="string")return;const l=r.trim();l&&(t[s]=l)}),t}function xu(e){const t=new Map;return Object.entries(Js(e)).forEach(([n,r])=>{const s=n.toLowerCase();t.set(s,r),s.includes(Nf)&&t.set(s.replace(Nf,":"),r)}),t}function Mm(e,t){if(typeof e!="string"||!e.includes("$"))return e;const n=t instanceof Map?t:xu(t);return n.size?e.replace(/\$([a-z0-9_:-]+)\$/gi,(r,s)=>{const l=n.get(s.toLowerCase());return typeof l=="string"?l:r}):e}function A0(e,t){const n=t instanceof Map?t:xu(t);if(!n.size||!e||typeof e!="object")return e;let r=!1;const s={};return Object.entries(e).forEach(([l,a])=>{if(typeof a=="string"){const o=Mm(a,n);s[l]=o,o!==a&&(r=!0)}else s[l]=a}),r?s:e}function $m(e){return e?JSON.parse(JSON.stringify(e)):{}}function T0(e,t,n){const r=$m(e),s={...n||{}};if(!t||!Array.isArray(t))return{workflow:r,formData:s};for(const l of t){if(!l||!l.id||!l.inputs||!r[l.id])continue;const a=l.inputs.param_name;if(!a||l.class_type==="CozyGenImageInput")continue;let o=s[a];const u=r[l.id];if(!u||!u.inputs)continue;const d=l.class_type;o===void 0&&(d==="CozyGenChoiceInput"?o=l.inputs.value??l.inputs.default_choice??(l.inputs.choices&&l.inputs.choices[0])??"":o=l.inputs.default_value),o===void 0&&(o=""),s[a]=o,d==="CozyGenFloatInput"||d==="CozyGenIntInput"||d==="CozyGenStringInput"||d==="CozyGenDynamicInput"?u.inputs.default_value=o:d==="CozyGenChoiceInput"&&(u.inputs.value=o)}return{workflow:r,formData:s}}function wu(){const[e,t]=c.useState(()=>typeof document>"u"?!0:document.visibilityState!=="hidden");return c.useEffect(()=>{if(typeof document>"u")return;const n=()=>{t(document.visibilityState!=="hidden")};return document.addEventListener("visibilitychange",n),()=>document.removeEventListener("visibilitychange",n)},[]),e}function M0({selectedWorkflow:e,workflowData:t,dynamicInputs:n,imageInputs:r,formData:s,setFormData:l,promptAliases:a=null}){const o=wu(),[u,d]=c.useState(!1),[m,v]=c.useState(!1),[g,y]=c.useState(0),[w,j]=c.useState(0),[S,h]=c.useState("Idle"),[f,p]=c.useState("idle"),[x,N]=c.useState([]),k=c.useRef({ts:0,value:0,max:0}),L=c.useRef(null),R=c.useRef({value:0,max:0}),T=c.useRef(null),z=c.useRef(null),I=c.useRef(t),X=c.useRef(s),Y=c.useRef(!1),be=c.useRef(0),ve=c.useRef(0),ae=c.useRef("idle"),de=c.useRef(null),_=c.useRef(null);c.useEffect(()=>{I.current=t},[t]),c.useEffect(()=>{Y.current=m},[m]),c.useEffect(()=>{be.current=g},[g]),c.useEffect(()=>{ve.current=w},[w]),c.useEffect(()=>{ae.current=f},[f]),c.useEffect(()=>{X.current=s},[s]);const C=()=>{de.current&&(clearTimeout(de.current),de.current=null)},$=()=>{_.current&&(clearTimeout(_.current),_.current=null)},P=()=>{z.current&&(clearTimeout(z.current),z.current=null)},D=()=>{L.current&&(cancelAnimationFrame(L.current),L.current=null)},H=c.useCallback((U,ue,xe=null)=>{const ze={ts:Date.now(),level:U||"info",message:String(ue||""),extra:xe||null};N(Ae=>{const Le=[...Ae||[],ze];return Le.length>250?Le.slice(Le.length-250):Le})},[]),le=c.useCallback(()=>N([]),[]),Z=()=>{if(!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent("cozygen:queue-finished"))}catch{}},ee=()=>{$(),_.current=setTimeout(()=>{Y.current||(p("idle"),h("Idle"),y(0),j(0))},8e3)},ce=c.useCallback(()=>{C(),d(!1),v(!1),y(0),j(0),h("Finished"),p("finished"),H("success","Finished"),ee(),Z()},[H]),W=c.useCallback((U="Error")=>{C(),d(!1),v(!1),h(U),p("error"),H("error",U||"Error"),ee()},[H]);c.useEffect(()=>{C(),!(!m||!w||w<=0||g<w)&&(de.current=setTimeout(()=>{const U=Y.current,ue=be.current,xe=ve.current,ze=ae.current;U&&xe>0&&ue>=xe&&ze!=="finished"&&ze!=="error"&&ce()},800))},[m,g,w,ce]),c.useEffect(()=>{if(typeof window>"u"||!o&&!m)return;let U=!1,ue=1e3;const xe=()=>{if(U||!o&&!Y.current)return;const ze=window.location.protocol==="https:"?"wss":"ws",Ae=window.location.host,Le=uu(),_e=`${ze}://${Ae}/ws${Le?`?token=${encodeURIComponent(Le)}`:""}`,Ue=new WebSocket(_e);T.current=Ue,Ue.onopen=()=>{ue=1e3},Ue.onmessage=Ge=>{var Ye,te,me;if(typeof Ge.data!="string")return;let V;try{V=JSON.parse(Ge.data)}catch{return}const Se=V.type;if(Se==="cozygen_batch_ready"){ce();return}if(Se==="execution_success"||Se==="execution_finished"){Y.current&&ce();return}if(Se==="execution_error"||Se==="execution_interrupted"){H("error","Execution error"),W("Execution error");return}if(Se==="status"){const ye=V.data||{},Ne=ye.status||ye,Pe=Ne.exec_info||ye.exec_info||Ne;if(Pe&&Y.current){const ie=Pe.queue_remaining??Pe.queue_pending??Pe.queue_remaining_items??0;(Pe.queue_running??Pe.running??0)===0&&ie===0&&ce()}return}if(Se==="executing"){$(),p("running");const ye=(Ye=V.data)==null?void 0:Ye.node,Ne=I.current;if(ye&&Ne&&Ne[ye]){const Pe=Ne[ye],ie=Pe.title||Pe.class_type||"Node";H("info",`Executing: ${ie}`,{nodeId:ye}),h(`Executing: ${ie}`)}else H("info","Executing"),h("Executing");return}if(Se==="progress"){const ye=((te=V.data)==null?void 0:te.value)??0,Ne=((me=V.data)==null?void 0:me.max)??0;R.current={value:ye,max:Ne},L.current||(L.current=window.requestAnimationFrame(()=>{L.current=null;const Ke=R.current;y(Ke.value),j(Ke.max)}));const Pe=Date.now(),ie=k.current;Pe-ie.ts>2500&&(ye!==ie.value||Ne!==ie.max)&&Ne>0&&(k.current={ts:Pe,value:ye,max:Ne},H("info",`Progress: ${ye}/${Ne}`));return}},Ue.onclose=()=>{U||!o&&!Y.current||(P(),z.current=setTimeout(xe,ue),ue=Math.min(Math.ceil(ue*1.6),15e3))}};return xe(),()=>{U=!0,C(),$(),P(),D(),T.current&&(T.current.onclose=null,T.current.close())}},[H,W,ce,o,m]);const O=c.useCallback(async(U={})=>{if(!t)return;const{overrides:ue=null,persistFormState:xe=!0}=U||{};C(),$(),d(!0),v(!0),h("Queuing prompt"),p("queued"),y(0),j(0),H("info","Queuing prompt",{workflow:e||""});const ze=X.current||{},Ae=ue?{...ze,...ue||{}}:ze,Le=A0(Ae,a||{}),{workflow:_e,formData:Ue}=T0(t,n||[],Le||{}),Ge={...Ue,...Ae};xe&&e&&Wi(e,Ge),xe&&l(Ge);const V=r||[];for(const Se of V){if(!Se||!Se.id||!Se.inputs)continue;const Ye=Se.inputs.param_name;if(!Ye)continue;const te=Ge[Ye];if(!te){alert(`Please upload or select an image for "${Ye}" before generating.`),W("Missing image input");return}_e[Se.id]&&_e[Se.id].inputs&&(_e[Se.id].inputs.image_filename=te)}try{let Se=_e;if(a){const Ye=te=>{if(typeof te=="string")return Mm(te,a);if(Array.isArray(te))return te.map(me=>Ye(me));if(te&&typeof te=="object"){const me=Array.isArray(te)?[]:{};return Object.entries(te).forEach(([ye,Ne])=>{me[ye]=Ye(Ne)}),me}return te};try{Se=Ye(_e)}catch{Se=_e}}mm({workflowName:e,workflow:Se,timestamp:Date.now()}),await du({prompt:Se}),H("info","Prompt queued")}catch(Se){console.error("Failed to queue prompt",Se),Se!=null&&Se.unauthorized?(H("error","Session expired. Please sign in again."),W("Session expired. Please sign in again."),window.location.hash="#/login"):(H("error","Error queuing prompt"),W("Error queuing prompt"))}},[t,n,r,a,e,l,W,H]);return{isLoading:u,progressValue:g,progressMax:w,statusText:S,statusPhase:f,handleGenerate:O,logEntries:x,clearLogs:le}}const Fm="cozygen_prompt_aliases",Om="cozygen_alias_categories",Dm="cozygen_alias_category_list";function Cf(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Fm);return e?JSON.parse(e)||{}:{}}catch{return{}}}function Ya(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Fm,JSON.stringify(e||{}))}catch{}}function Ef(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Om);return e?JSON.parse(e)||{}:{}}catch{return{}}}function qa(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Om,JSON.stringify(e||{}))}catch{}}function bf(){if(typeof window>"u")return[];try{const e=window.localStorage.getItem(Dm);return Array.isArray(JSON.parse(e))?JSON.parse(e):[]}catch{return[]}}function Xa(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Dm,JSON.stringify(e||[]))}catch{}}function Bm(){const[e,t]=c.useState(()=>Cf()),[n,r]=c.useState(()=>Ef()),[s,l]=c.useState(()=>bf()),[a,o]=c.useState(!1),[u,d]=c.useState(!1),[m,v]=c.useState(null),g=c.useCallback(async()=>{o(!0),v(null);try{const S=await Xx(),h=Js((S==null?void 0:S.items)||S||{}),f=(S==null?void 0:S.categories)||{},p=Array.isArray(S==null?void 0:S.categoryList)?S.categoryList:[];t(h),r(f),l(p),Ya(h),qa(f),Xa(p)}catch(S){console.error("Failed to load prompt aliases",S),v(S);const h=Js(Cf()),f=Ef(),p=bf();t(h),r(f),l(p)}finally{o(!1)}},[]),y=c.useCallback(async S=>{const h=(S==null?void 0:S.items)||S||{},f=(S==null?void 0:S.categories)||n||{},p=Array.isArray(S==null?void 0:S.categoryList)&&S.categoryList.length?S.categoryList:s.length?s:Array.from(new Set(Object.values(f).filter(Boolean))),x=Js(h||{});d(!0),v(null);try{await Jx({items:x,categories:f,categoryList:p}),t(x),r(f),l(p),Ya(x),qa(f),Xa(p)}catch(N){throw console.error("Failed to save prompt aliases",N),v(N),Ya(x),qa(f),Xa(p),N}finally{d(!1)}},[n,s]);c.useEffect(()=>{g()},[g]);const w=c.useMemo(()=>{const S=xu(e),h=new Map(S);return Object.entries(n||{}).forEach(([f,p])=>{const x=String(p||"").trim();x&&(e!=null&&e[f])&&h.set(`${x}:${f}`,e[f])}),h},[e,n]),j=c.useMemo(()=>{const S=new Set,h=[];return w.forEach((f,p)=>{let x=p.includes("::")?p.replace("::",":"):p;const N=x.split(":");N.length>=3&&N[0]&&N[1]&&N[0].toLowerCase()===N[1].toLowerCase()&&(x=[N[0],...N.slice(2)].join(":"));const k=x.toLowerCase();S.has(k)||(S.add(k),h.push(x))}),h},[w]);return{aliases:e,aliasCategories:n,categoryList:s,aliasLookup:w,aliasOptions:j,loading:a,saving:u,error:m,refreshAliases:g,persistAliases:y}}const Um=c.createContext(null);function Vm(){const e=c.useContext(Um);if(!e)throw new Error("useStudioContext must be used within a StudioProvider");return e}function $0({children:e}){const{workflows:t,selectedWorkflow:n,selectWorkflow:r,loading:s,error:l}=z0(),{workflowData:a,dynamicInputs:o,imageInputs:u,primaryImageInput:d,formData:m,setFormData:v,handleFormChange:g,loading:y,error:w}=I0(n),j=Bm(),S=c.useMemo(()=>{const X=[];return Object.entries(j.aliases||{}).forEach(([Y,be])=>{const ve=String(Y).split("::"),ae=ve.length>1,de=j.aliasCategories&&j.aliasCategories[Y]||(ae?ve[0]:""),_=ae?ve.slice(1).join("::"):Y,C={key:Y,name:_,category:de,text:be,token:de?`${de}:${_}`:_};X.push({...C,...vu(C)})}),X},[j.aliases,j.aliasCategories]),h=c.useMemo(()=>P0(n,o),[n,o]),f=c.useMemo(()=>{const X=(h||o||[]).filter(_=>(_==null?void 0:_.class_type)!=="CozyGenImageInput"),Y=/\b(checkpoint|ckpt|lora|model|vae|embedding|clip|sampler|scheduler|seed)\b/i,be=_=>{const C=String((_==null?void 0:_.paramName)||"").toLowerCase(),$=String((_==null?void 0:_.label)||"").toLowerCase(),P=`${C} ${$}`,D=m==null?void 0:m[_==null?void 0:_.paramName],H=typeof D=="string"?D:"";let le=0;return P.includes("prompt")&&(le+=100),P.includes("negative")&&P.includes("prompt")&&(le-=15),_!=null&&_.multiline&&(le+=10),H.includes("$")&&(le+=20),Y.test(P)&&(le-=200),Em(H)&&(le-=200),le};if(typeof(m==null?void 0:m.prompt)=="string")return"prompt";const ve=X.map(_=>Bs(_)).filter(_=>(_==null?void 0:_.paramType)==="STRING"&&(_==null?void 0:_.paramName));if(!ve.length)return"prompt";let ae=ve[0],de=be(ae);for(let _=1;_<ve.length;_+=1){const C=ve[_],$=be(C);$>de&&(ae=C,de=$)}return(ae==null?void 0:ae.paramName)||"prompt"},[o,m,h]),{isLoading:p,progressValue:x,progressMax:N,statusText:k,statusPhase:L,handleGenerate:R,logEntries:T,clearLogs:z}=M0({selectedWorkflow:n,workflowData:a,dynamicInputs:o,imageInputs:u,formData:m,setFormData:v,promptAliases:j.aliasLookup});c.useEffect(()=>{if(L==="finished"&&!(typeof window>"u")){try{window.localStorage.setItem("cozygen_gallery_pending","1")}catch{}window.dispatchEvent(new Event("cozygen:gallery-pending"))}},[L]),c.useEffect(()=>{if(typeof window>"u")return;const X=L==="queued"||L==="running"||p;try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:X}}))}catch{}},[L,p]);const I=c.useMemo(()=>({workflows:t,selectedWorkflow:n,selectWorkflow:r,workflowsLoading:s,workflowsError:l,workflowData:a,dynamicInputs:o,orderedDynamicInputs:h,imageInputs:u,primaryImageInput:d,formData:m,setFormData:v,handleFormChange:g,workflowLoading:y,workflowError:w,promptFieldName:f,aliasOptions:j.aliasOptions,aliasCatalog:S,aliasLookup:j.aliasLookup,aliasCategories:j.aliasCategories,aliasLoading:j.loading,aliasSaving:j.saving,aliasError:j.error,refreshAliases:j.refreshAliases,persistAliases:j.persistAliases,isLoading:p,progressValue:x,progressMax:N,statusText:k,statusPhase:L,handleGenerate:R,logEntries:T,clearLogs:z}),[t,n,r,s,l,a,o,h,u,d,m,v,g,y,w,f,j.aliasOptions,j.aliasLookup,j.aliasCategories,S,j.loading,j.saving,j.error,j.refreshAliases,j.persistAliases,p,x,N,k,L,R,T,z]);return i.jsx(Um.Provider,{value:I,children:e})}function F0(){const e=Ln(),{workflows:t=[],selectedWorkflow:n,selectWorkflow:r,workflowData:s,dynamicInputs:l=[],imageInputs:a=[],formData:o,setFormData:u,handleFormChange:d,aliasOptions:m,aliasCatalog:v,isLoading:g,progressValue:y,progressMax:w,statusText:j,statusPhase:S,handleGenerate:h,logEntries:f,clearLogs:p,promptFieldName:x,orderedDynamicInputs:N}=Vm(),k=c.useRef(null),L=c.useRef(null),[R,T]=c.useState(()=>n0()),[z,I]=c.useState(null),X=(z==null?void 0:z.name)||"",Y=c.useCallback(()=>I(null),[]),[be,ve]=c.useState(!1),[ae,de]=c.useState([]),[_,C]=c.useState([]),[$,P]=c.useState(""),[D,H]=c.useState(""),[le,Z]=c.useState(""),ee=c.useRef(new Map),ce=c.useCallback((te="")=>{const ye=`?field=${encodeURIComponent(te||x||"prompt")}`;e(`/compose${ye}`)},[e,x]),W=c.useCallback(te=>{!te||te===n||(n&&Wi(n,o||{},{immediate:!0}),P(""),H(""),Z(""),r(te))},[o,n,r]),O=c.useMemo(()=>{const me=[...N||[],...a||[]].map(ye=>{var Ne;return(Ne=ye==null?void 0:ye.inputs)==null?void 0:Ne.param_name}).filter(ye=>ye&&typeof ye=="string");return new Set(me)},[N,a]),U=c.useCallback(te=>{H(te);const me=_.find(Pe=>Pe.id===te);if(P((me==null?void 0:me.name)||""),!te||!(me!=null&&me.values)||!n){te||Z("");return}const ye=O,Ne={};Object.entries(me.values).forEach(([Pe,ie])=>{(!ye.size||ye.has(Pe))&&(Ne[Pe]=ie)}),u(Pe=>{const ie={...Pe,...Ne};return Wi(n,ie,{immediate:!0}),ie}),Z(`Applied "${me.name}".`)},[O,_,n,u]),ue=a||[],xe=!!(s&&n),ze=ue.length>0,Ae=c.useCallback((te,me)=>{const ye=ee.current;me&&te&&ye.set(te,me);const Ne=ae.length?ae:(me==null?void 0:me.order)||[],Pe=Ne.length,ie=Pe>0?Ne.indexOf(te):-1,Me=ie>0?Ne[ie-1]:null,Ke=ie>=0&&ie<Pe-1?Ne[ie+1]:null,lt=Me?ye.get(Me):null,tt=Ke?ye.get(Ke):null;return{...me,index:ie>=0?ie:0,total:Pe,onPrev:lt?()=>I(Ae(Me,lt)):null,onNext:tt?()=>I(Ae(Ke,tt)):null,onRender:h}},[ae,h]),Le=c.useCallback(te=>{const me=te||[];de(ye=>ye.length===me.length&&ye.every((Ne,Pe)=>Ne===me[Pe])?ye:me)},[]),_e=c.useCallback(te=>{const me=te||"";T(me),t0(me)},[]),Ue=c.useCallback(te=>{te!=null&&te.name&&I(Ae(te.name,te))},[Ae]),Ge=c.useCallback(async te=>{if(!te){C([]),H("");return}try{const me=await Zx(te),ye=Array.isArray(me==null?void 0:me.presets)?me.presets:[];C(ye),H(Ne=>Ne&&ye.some(Pe=>Pe.id===Ne)?Ne:"")}catch(me){console.error("Failed to load workflow presets",me),C([]),Z("Presets unavailable.")}},[]);c.useEffect(()=>{Ge(n)},[n,Ge]);const V=c.useCallback(async()=>{if(!n)return;const te=$.trim();if(!te){Z("Name a preset to save.");return}const me={},ye=O;Object.entries(o||{}).forEach(([ie,Me])=>{(!ye.size||ye.has(ie))&&(me[ie]=Me)});const Ne=_.find(ie=>ie.id===D),Pe=Ne&&Ne.name.toLowerCase()===te.toLowerCase()?Ne.id:void 0;try{const ie=await ew(n,{id:Pe,name:te,values:me}),Me=Array.isArray(ie==null?void 0:ie.presets)?ie.presets:[],Ke=ie==null?void 0:ie.preset;C(Me),Ke!=null&&Ke.id&&H(Ke.id),Z(`Saved "${te}".`)}catch(ie){console.error("Failed to save preset",ie),Z("Save failed.")}},[O,o,$,_,D,n]),Se=c.useCallback(async()=>{if(!(!n||!D))try{const te=await tw(n,D),me=Array.isArray(te==null?void 0:te.presets)?te.presets:[];C(me),H(""),Z("Preset deleted.")}catch(te){console.error("Failed to delete preset",te),Z("Delete failed.")}},[D,n]),Ye=c.useCallback(()=>{var te;return(te=z==null?void 0:z.render)==null?void 0:te.call(z,o)},[z,o]);return c.useEffect(()=>{const te=()=>{!xe||g||h()};return window.addEventListener("cozygen:request-render",te),()=>window.removeEventListener("cozygen:request-render",te)},[h,xe,g]),!t||t.length===0?i.jsx("div",{className:"page-shell",children:i.jsx("div",{className:"ui-card px-3 py-3 sm:px-4 sm:py-4",children:i.jsx("p",{className:"text-sm text-[#9DA3FFCC]",children:"No workflows found. Drop a workflow file in CozyGen and refresh."})})}):i.jsxs("div",{className:"page-shell page-stack has-dock controls-page",children:[i.jsxs("div",{className:"page-bar controls-bar",children:[i.jsx("h1",{className:"page-bar-title",children:"Controls"}),i.jsx("div",{className:"page-bar-actions",children:R?i.jsxs("span",{className:"controls-meta",children:["Last: ",R]}):null})]}),i.jsxs("section",{className:"controls-board",children:[i.jsx(Ow,{workflows:t,selectedWorkflow:n,onWorkflowChange:W,workflowData:s,presets:_,presetName:$,onPresetNameChange:P,selectedPresetId:D,onPresetSelect:U,onPresetSave:V,onPresetDelete:Se,presetStatus:le}),ze?i.jsx(ac,{ref:L,className:"controls-panel",title:i.jsxs(i.Fragment,{children:[i.jsx(cw,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Images"]}),bodyClassName:"control-shell controls-body",defaultOpen:!1,children:s?i.jsx("div",{className:"grid grid-cols-1 gap-3 lg:grid-cols-2",children:ue.map(te=>i.jsx(zw,{input:te,value:o[te.inputs.param_name]||"",onFormChange:d},te.id))}):null}):null,i.jsx(ac,{title:i.jsxs(i.Fragment,{children:[i.jsx(mu,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Parameters"]}),bodyClassName:"control-shell controls-body",defaultOpen:!0,className:"controls-panel",children:s?i.jsx(j0,{workflowName:n,dynamicInputs:N,formData:o,onFormChange:d,parameterSectionRef:k,compactControls:!0,lastEditedParam:R,spotlightName:X,onCloseSpotlight:Y,onVisibleParamsChange:Le,aliasOptions:m,aliasCatalog:v,onOpenComposer:ce,onParamEdited:_e,onSpotlight:Ue}):i.jsxs("div",{className:"empty-state-inline",children:[i.jsx("span",{className:"empty-state-arrow",children:i.jsx(uw,{size:20})}),i.jsx("span",{children:"Select a workflow above to get started"})]})})]}),i.jsxs("div",{className:"controls-status-strip",children:[i.jsxs("div",{className:"controls-status-left",children:[i.jsx("span",{className:`controls-status-dot is-${S||"idle"}`,"aria-hidden":"true"}),i.jsxs("div",{className:"controls-status-text",children:[i.jsx("span",{className:"controls-status-phase",children:S||"idle"}),i.jsx("span",{className:"controls-status-msg",children:j||"Idle"})]})]}),i.jsxs("div",{className:"controls-status-right",children:[g&&w>0?i.jsx("div",{className:"controls-status-meter","aria-label":"Progress",children:i.jsx("div",{className:"controls-status-meter-fill",style:{width:`${Math.max(0,Math.min(100,Math.round((y||0)/w*100)))}%`}})}):null,i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>ve(!0),children:"Logs"})]})]}),i.jsx("section",{className:"dock-panel ui-card",children:i.jsx(xw,{busy:g,progressValue:y,progressMax:w,statusText:j,statusPhase:S,primaryLabel:"Render",onPrimary:h,primaryDisabled:!xe,onLogs:()=>ve(!0)})}),i.jsx(_w,{open:!!z,onClose:Y,title:z==null?void 0:z.label,description:z==null?void 0:z.description,render:Ye,index:(z==null?void 0:z.index)??0,total:(z==null?void 0:z.total)??0,onPrev:(z==null?void 0:z.onPrev)||null,onNext:(z==null?void 0:z.onNext)||null,onRender:(z==null?void 0:z.onRender)||null,children:null}),i.jsx(k0,{open:be,onClose:()=>ve(!1),logs:f,onClear:p})]})}function O0(){return i.jsx("div",{className:"page-shell page-stack",children:i.jsxs("section",{className:"home-hero",children:[i.jsx("span",{className:"home-hero-orb is-warm","aria-hidden":"true"}),i.jsx("span",{className:"home-hero-orb is-cool","aria-hidden":"true"}),i.jsx("span",{className:"home-hero-spark","aria-hidden":"true"}),i.jsx("span",{className:"home-hero-beam","aria-hidden":"true"}),i.jsx("span",{className:"home-hero-ring","aria-hidden":"true"}),i.jsxs("div",{className:"home-hero-inner home-hero-full",children:[i.jsx("div",{className:"home-hero-kicker",children:"CozyGen Studio"}),i.jsx("h1",{className:"home-hero-title",children:"Creative studio for prompt-first storytelling"}),i.jsx("p",{className:"home-hero-description",children:"CozyGen is a quiet, cinematic workspace for people who sketch with wordsshape the mood, stage the scene, then send it down the render runway without losing your flow."}),i.jsxs("div",{className:"home-info-grid",children:[i.jsxs("article",{className:"ui-card",children:[i.jsx("h3",{className:"text-xs uppercase tracking-[0.12em] text-[rgba(159,178,215,0.8)]",children:"Control as composition"}),i.jsx("p",{className:"mt-1 text-[0.78rem] leading-relaxed text-[rgba(204,217,255,0.75)]",children:"Dial the palette, tempo, and texture in one place. The controls read like a creative brief, not a checklist."})]}),i.jsxs("article",{className:"ui-card",children:[i.jsx("h3",{className:"text-xs uppercase tracking-[0.12em] text-[rgba(159,178,215,0.8)]",children:"Alias & tag storyboards"}),i.jsx("p",{className:"mt-1 text-[0.78rem] leading-relaxed text-[rgba(204,217,255,0.75)]",children:"Save characters, atmospheres, and motifs as building blocks, then arrange them like panels in a storyboard."})]}),i.jsxs("article",{className:"ui-card",children:[i.jsx("h3",{className:"text-xs uppercase tracking-[0.12em] text-[rgba(159,178,215,0.8)]",children:"Gallery inspiration"}),i.jsx("p",{className:"mt-1 text-[0.78rem] leading-relaxed text-[rgba(204,217,255,0.75)]",children:"Pin your strongest frames, compare variations, and carry the aesthetic through to your next scene."})]}),i.jsxs("article",{className:"ui-card",children:[i.jsx("h3",{className:"text-xs uppercase tracking-[0.12em] text-[rgba(159,178,215,0.8)]",children:"Render runway"}),i.jsx("p",{className:"mt-1 text-[0.78rem] leading-relaxed text-[rgba(204,217,255,0.75)]",children:"Stack iterations like takes on a set. Keep composing while the queue runs in the background."})]})]})]})]})})}const D0=e=>i.jsxs("svg",{viewBox:"0 0 24 24",width:"14",height:"14","aria-hidden":"true",...e,children:[i.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"2.5",ry:"2.5",fill:"none",stroke:"currentColor",strokeWidth:"1.3"}),i.jsx("rect",{x:"7",y:"3",width:"10",height:"14",rx:"2.5",ry:"2.5",fill:"none",stroke:"currentColor",strokeWidth:"1.3",opacity:"0.8"}),i.jsx("circle",{cx:"12",cy:"11",r:"2.3",fill:"currentColor",opacity:"0.9"})]});function B0({subfolder:e,crumbs:t=[],dirChips:n=[],onBack:r,onRoot:s,onCrumb:l,onSelectDir:a}){const o=!e;return i.jsxs("div",{className:"gallery-nav",children:[i.jsx("div",{className:"gallery-crumbs",role:"navigation","aria-label":"Gallery path",children:t.map((u,d)=>i.jsxs(c.Fragment,{children:[i.jsx("span",{className:"text-[#6A6FA8]",children:"/"}),i.jsx(Q,{size:"xs",variant:"chip",onClick:()=>l==null?void 0:l(u.path),"aria-current":d===t.length-1?"page":void 0,children:u.name})]},u.path||u.name||d))}),i.jsxs("div",{className:"gallery-dir-chips",children:[i.jsxs(Q,{size:"xs",variant:"chip",onClick:()=>s==null?void 0:s(),disabled:o,"aria-label":"Go to output root",title:"Output root",children:[i.jsx(D0,{}),"Output"]}),n.map(u=>i.jsx(Q,{size:"xs",variant:"chip",onClick:()=>a==null?void 0:a(u.subfolder),children:u.filename||u.subfolder||"Collection"},u.subfolder||u.filename))]})]})}const U0=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),V0=({src:e,poster:t,autoPlay:n})=>{const r=c.useRef(null),s=wu();return c.useEffect(()=>{const l=r.current;l&&(l.pause(),l.currentTime=0,l.load())},[e]),c.useEffect(()=>{const l=r.current;if(!l)return;let a;const o=()=>{const d=l.play();d&&typeof d.catch=="function"&&d.catch(()=>{})},u=()=>{l.pause()};return n?s?typeof window<"u"&&"IntersectionObserver"in window?(a=new IntersectionObserver(m=>{m.forEach(v=>{v.isIntersecting?o():u()})},{threshold:.65}),a.observe(l)):o():u():(u(),l.currentTime=0),()=>{a&&a.disconnect(),u()}},[n,e,s]),e?i.jsx("video",{ref:r,src:e,poster:t||void 0,muted:!0,playsInline:!0,loop:!0,preload:n?"metadata":"none",className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40"}):i.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})},Lf={contentVisibility:"auto",containIntrinsicSize:"260px 320px"};function W0({item:e,onSelect:t,variant:n="grid",autoPlay:r=!1}){if(!e)return null;const s=e.type==="directory",l=e.filename||"",a=e.subfolder||"",o=l||a||"Unknown",u=!!(e!=null&&e.meta&&(e.meta.model||e.meta.prompt||Array.isArray(e.meta.loras)&&e.meta.loras.length)),d=()=>{t&&t(e)},m=n==="feed"?768:384,v=!s&&l?`/cozygen/thumb?type=output&subfolder=${encodeURIComponent(a)}&filename=${encodeURIComponent(l)}&w=`:null,g=v?`${v}${m}`:null,y=v?n==="feed"?`${v}384 384w, ${v}768 768w`:`${v}192 192w, ${v}384 384w`:null,w=n==="feed"?"(max-width: 768px) 92vw, 768px":"(max-width: 640px) 45vw, (max-width: 1024px) 30vw, 240px",j=!s&&l?(()=>{const h=e.type&&e.type!=="directory"?e.type:"output",f=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(l)}&subfolder=${encodeURIComponent(a)}&type=${encodeURIComponent(h)}${f}`})():null,S=U0(l);if(s)return i.jsx("button",{type:"button",onClick:d,className:"gallery-dir-tile",style:Lf,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"h-7 w-7 rounded-lg bg-gradient-to-br from-[#6B5BFF] to-[#FF4F9A] opacity-80 group-hover:opacity-100 flex items-center justify-center text-[11px] text-white",children:""}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-[11px] font-medium text-[#E5E7FF] truncate",children:o}),i.jsx("div",{className:"text-[10px] text-[#9DA3FFCC] truncate",children:"Collection"})]})]})});if(n==="feed"){const h={contentVisibility:"auto",containIntrinsicSize:"520px 720px"};return i.jsx("div",{className:"gallery-feed-item",style:h,children:i.jsxs("button",{type:"button",onClick:d,className:"gallery-feed-media",children:[u?i.jsx("span",{className:"gallery-meta-badge",role:"img","aria-label":"Metadata available",title:"Metadata available",children:"i"}):null,i.jsx("div",{className:"relative w-full flex items-center justify-center bg-[#020312]",children:S?i.jsx(V0,{src:j,poster:g,autoPlay:r}):g?i.jsx("img",{src:g,srcSet:y||void 0,sizes:w,alt:o,className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40",loading:"lazy",decoding:"async"}):i.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})}),i.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#05071680] opacity-0 group-hover:opacity-100 transition-opacity"}),S&&i.jsx("div",{className:"pointer-events-none absolute left-2 top-2 rounded-md bg-[#050716CC] px-2 py-[1px] text-[10px] text-[#CFFAFE] border border-[#3EF0FF80]",children:"Video"})]})})}return i.jsx("button",{type:"button",onClick:d,className:"gallery-tile",style:Lf,children:i.jsxs("div",{className:"gallery-tile-media",children:[u?i.jsx("span",{className:"gallery-meta-badge",role:"img","aria-label":"Metadata available",title:"Metadata available",children:"i"}):null,g?i.jsx("img",{src:g,srcSet:y||void 0,sizes:w,alt:o,className:"gallery-tile-img",loading:"lazy",decoding:"async"}):i.jsx("div",{className:"gallery-tile-empty",children:"No preview"}),S&&i.jsx("div",{className:"gallery-badge",children:"Video"})]})})}const Pf=c.memo(W0),Su=["seed","noise_seed"],Wm=["ckpt_name","checkpoint","ckpt","model_name"],uc=["lora_name"],Hm=["width","image_width"],Gm=["height","image_height"],bl=e=>String(e||"").toLowerCase(),yl=e=>(e==null?void 0:e.class_type)==="CozyGenDynamicInput"||(e==null?void 0:e.class_type)==="CozyGenChoiceInput",xl=e=>{var t;return bl((t=e==null?void 0:e.inputs)==null?void 0:t.choice_type)},Gi=(e,t)=>{e!=null&&e.inputs&&("default_value"in e.inputs&&(e.inputs.default_value=t),"value"in e.inputs&&(e.inputs.value=t))},Km=e=>bl(e==null?void 0:e.class_type).includes("checkpoint"),Qm=e=>bl(e==null?void 0:e.class_type).includes("lora"),Ym=e=>bl(e==null?void 0:e.class_type).includes("seed"),ju=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;const t=parseInt(String(e),10);return Number.isFinite(t)?t:null},bn=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;const t=parseInt(String(e),10);return Number.isFinite(t)?t:null},Zl=e=>e!=null&&e.inputs?"default_value"in e.inputs?bn(e.inputs.default_value):"value"in e.inputs?bn(e.inputs.value):null:null,dc=e=>{var t;return bl((t=e==null?void 0:e.inputs)==null?void 0:t.param_name)},ei=(e,t)=>{if(!(e!=null&&e.inputs))return!1;let n=!1;return"default_value"in e.inputs&&bn(e.inputs.default_value)!==null&&(e.inputs.default_value=t,n=!0),"value"in e.inputs&&bn(e.inputs.value)!==null&&(e.inputs.value=t,n=!0),n},zf=(e,t)=>{if(!(e!=null&&e.inputs))return!1;let n=!1;return Su.forEach(r=>{if(!(r in e.inputs))return;const s=e.inputs[r];Array.isArray(s)||ju(s)!==null&&(e.inputs[r]=t,n=!0)}),n},H0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(Su.forEach(s=>{if(!(s in r.inputs))return;const l=r.inputs[s];if(Array.isArray(l)&&l.length){n.add(l[0]);return}ju(l)!==null&&(r.inputs[s]=t)}),Ym(r)&&zf(r,t))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&zf(s,t)})},G0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(yl(r)&&xl(r)==="checkpoints"&&Gi(r,t),Km(r)&&Wm.forEach(s=>{if(!(s in r.inputs))return;const l=r.inputs[s];if(Array.isArray(l)&&l.length){n.add(l[0]);return}(typeof l=="string"||typeof l=="number")&&(r.inputs[s]=t)}))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&yl(s)&&xl(s)==="checkpoints"&&Gi(s,t)})},K0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(yl(r)&&xl(r)==="loras"&&Gi(r,t),(Qm(r)||uc.some(s=>s in r.inputs))&&uc.forEach(s=>{if(!(s in r.inputs))return;const l=r.inputs[s];if(Array.isArray(l)&&l.length){n.add(l[0]);return}(typeof l=="string"||typeof l=="number")&&(r.inputs[s]=t)}))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&yl(s)&&xl(s)==="loras"&&Gi(s,t)})},Q0=(e,t,n)=>{if(t===null&&n===null)return;const r=new Set,s=new Set;Object.values(e||{}).forEach(l=>{if(!(l!=null&&l.inputs))return;const a=l.inputs,o=dc(l);t!==null&&o==="width"&&ei(l,t),n!==null&&o==="height"&&ei(l,n),t!==null&&Hm.forEach(u=>{if(!(u in a))return;const d=a[u];if(Array.isArray(d)&&d.length){r.add(d[0]);return}bn(d)!==null&&(a[u]=t)}),n!==null&&Gm.forEach(u=>{if(!(u in a))return;const d=a[u];if(Array.isArray(d)&&d.length){s.add(d[0]);return}bn(d)!==null&&(a[u]=n)})}),r.forEach(l=>{const a=e==null?void 0:e[l];a&&ei(a,t)}),s.forEach(l=>{const a=e==null?void 0:e[l];a&&ei(a,n)})};function Y0(e){const t={hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null},n=new Set,r=new Set;return Object.values(e||{}).forEach(s=>{const l=(s==null?void 0:s.inputs)||{};if(l){if(Su.forEach(a=>{a in l&&(t.hasSeed=!0)}),Km(s)&&(t.hasCheckpoint=!0,Wm.forEach(a=>{const o=l[a];typeof o=="string"&&o&&n.add(o)})),Qm(s)||uc.some(a=>a in l)){t.hasLora=!0;const a=l.lora_name;typeof a=="string"&&a&&r.add(a)}if(yl(s)){const a=xl(s),o=l.default_value??l.value;a==="checkpoints"&&(t.hasCheckpoint=!0,typeof o=="string"&&o&&n.add(o)),a==="loras"&&(t.hasLora=!0,typeof o=="string"&&o&&r.add(o))}if(Ym(s)&&"seed"in l&&(t.hasSeed=!0),t.width===null&&dc(s)==="width"){const a=Zl(s);a!==null&&(t.width=a)}if(t.height===null&&dc(s)==="height"){const a=Zl(s);a!==null&&(t.height=a)}t.width===null&&Hm.forEach(a=>{if(!(a in l)||t.width!==null)return;const o=l[a];if(Array.isArray(o)&&o.length){const d=e==null?void 0:e[o[0]],m=Zl(d);m!==null&&(t.width=m);return}const u=bn(o);u!==null&&(t.width=u)}),t.height===null&&Gm.forEach(a=>{if(!(a in l)||t.height!==null)return;const o=l[a];if(Array.isArray(o)&&o.length){const d=e==null?void 0:e[o[0]],m=Zl(d);m!==null&&(t.height=m);return}const u=bn(o);u!==null&&(t.height=u)})}}),t.checkpoint=n.values().next().value||"",t.loras=Array.from(r),t.hasSize=t.width!==null||t.height!==null,t}function q0(e,t={}){if(!e)return e;const n=$m(e),{seedMode:r="keep",seedValue:s=null,checkpoint:l=null,lora:a=null,width:o=null,height:u=null}=t;if(r&&r!=="keep"){const v=r==="random"?Math.floor(Math.random()*4294967295):ju(s);v!==null&&H0(n,v)}l&&G0(n,l),a&&K0(n,a);const d=bn(o),m=bn(u);return(d!==null||m!==null)&&Q0(n,d,m),n}function X0({filename:e,locationLabel:t,isClip:n,url:r,canRerun:s,rerunBusy:l,canDelete:a,deleteBusy:o,metaRows:u,metaOpen:d,onToggleMeta:m,onOpenOptions:v,onDelete:g,onClose:y,closeButtonRef:w}){return i.jsxs("header",{className:"media-viewer-head",children:[i.jsxs("div",{className:"media-viewer-head-bar bottom-sheet-head",children:[i.jsxs("div",{className:"media-viewer-meta",children:[i.jsx("div",{className:"media-viewer-title",title:e,children:e}),i.jsxs("div",{className:"media-viewer-sub",children:[i.jsx("span",{className:"media-chip",children:t}),i.jsx("span",{className:`media-chip ${n?"is-clip":"is-still"}`,children:n?"Video":"Image"})]})]}),i.jsx("button",{ref:w,type:"button",className:"bottom-sheet-close media-viewer-close",onClick:y,"aria-label":"Close",children:i.jsx(hr,{size:16})})]}),i.jsxs("div",{className:"media-viewer-actions",children:[s?i.jsx(Q,{variant:"ghost",size:"sm",onClick:v,disabled:l,"aria-label":"Re-run generation",children:l?"Re-running":"Re-run"}):null,u.length?i.jsx(Q,{variant:"ghost",size:"sm",onClick:m,"aria-expanded":d,"aria-label":d?"Hide metadata":"Show metadata",children:d?"Hide metadata":"Metadata"}):null,i.jsx(Q,{as:"a",href:r,target:"_blank",rel:"noreferrer",variant:"ghost",size:"sm",children:"Open"}),a?i.jsx(Q,{variant:"danger",size:"sm",onClick:g,disabled:o,children:o?"Deleting":"Delete"}):null]})]})}function J0({metaRows:e=[]}){return e.length?i.jsx("div",{className:"media-viewer-info","aria-label":"Generation metadata",children:e.map(t=>i.jsxs("div",{className:"media-info-row",children:[i.jsx("span",{className:"media-info-label",children:t.label}),i.jsx("span",{className:`media-info-value ${t.isPrompt?"is-prompt":""}`,children:t.value})]},t.label))}):null}function Z0({showNav:e,canPrev:t,canNext:n,onPrev:r,onNext:s,isClip:l,url:a,filename:o}){return i.jsxs("div",{className:"media-viewer-stage",children:[e?i.jsx("button",{type:"button",className:`media-stage-nav is-left ${t?"":"is-disabled"}`,onClick:r,"aria-label":"Previous",disabled:!t,children:i.jsx(Sm,{size:18})}):null,i.jsx("div",{className:"media-viewer-frame",children:l?i.jsx("video",{src:a,controls:!0,className:"media-viewer-media",autoPlay:!0,muted:!0,playsInline:!0}):i.jsx("img",{src:a,alt:o,className:"media-viewer-media",decoding:"async"})}),e?i.jsx("button",{type:"button",className:`media-stage-nav is-right ${n?"":"is-disabled"}`,onClick:s,"aria-label":"Next",disabled:!n,children:i.jsx(ha,{size:18})}):null]})}const e1=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),t1=e=>{if(!e)return"";const t=e.filename||"",n=e.subfolder||"",r=e.type||"output",s=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(t)}&subfolder=${encodeURIComponent(n)}&type=${encodeURIComponent(r)}${s}`},_f=e=>{if(!ws(e))return null;const{folderPath:t,base:n}=va(e);return{folderPath:t||"root",base:n||""}},Rf=(e="")=>{if(!e||e==="root")return"root";const t=e.split("/").filter(Boolean);return t[t.length-1]||e};function n1({isOpen:e,media:t,onClose:n,onPrev:r,onNext:s,onDeleted:l,total:a=0,canPrev:o=!1,canNext:u=!1}){var Br;const d=c.useRef(!1),m=c.useRef(null),[v,g]=c.useState(!1),[y,w]=c.useState(!1),[j,S]=c.useState(!1),[h,f]=c.useState(!1),p=c.useRef(null),x=c.useRef(null),N=c.useRef(!1),k=c.useRef(null),[L,R]=c.useState(!1),[T,z]=c.useState("random"),[I,X]=c.useState(""),[Y,be]=c.useState(""),[ve,ae]=c.useState(""),[de,_]=c.useState(""),[C,$]=c.useState(""),[P,D]=c.useState("All"),[H,le]=c.useState("All"),[Z,ee]=c.useState({hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null}),[ce,W]=c.useState(!1),[O,U]=c.useState(""),[ue,xe]=c.useState(!1),[ze,Ae]=c.useState(""),[Le,_e]=c.useState([]),[Ue,Ge]=c.useState([]),V=c.useRef(null),Se=c.useRef(null),Ye=G=>G?Array.from(G.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(ne=>!ne.hasAttribute("disabled")&&ne.getAttribute("aria-hidden")!=="true"):[];c.useEffect(()=>{if(!e)return;const G=ne=>{ne.key==="Escape"&&(n==null||n()),ne.key==="ArrowLeft"&&o&&(r==null||r()),ne.key==="ArrowRight"&&u&&(s==null||s())};return window.addEventListener("keydown",G),()=>window.removeEventListener("keydown",G)},[e,n,s,r,o,u]),c.useEffect(()=>{e&&(g(!1),R(!1),S(!1),f(!1),z("random"),X(""),be(""),ae(""),_(""),$(""),D("All"),le("All"),ee({hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null}),W(!1),U(""),xe(!1),Ae(""),_e([]),Ge([]),V.current=null,Se.current&&(Se.current.abort(),Se.current=null),N.current=!0,k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{N.current=!1,k.current=null},250))},[e,t]),c.useEffect(()=>()=>{k.current&&(clearTimeout(k.current),k.current=null)},[]),c.useEffect(()=>{if(!e||typeof document>"u")return;const G=p.current;x.current=document.activeElement;const ne=()=>{var Nt;const Ie=Ye(G),He=m.current||Ie[0]||G;(Nt=He==null?void 0:He.focus)==null||Nt.call(He)},Ce=Ie=>{if(Ie.key!=="Tab"||!G)return;const He=Ye(G);if(!He.length){Ie.preventDefault(),G.focus();return}const Nt=He[0],zl=He[He.length-1],Tt=document.activeElement;Ie.shiftKey&&Tt===Nt?(Ie.preventDefault(),zl.focus()):!Ie.shiftKey&&Tt===zl&&(Ie.preventDefault(),Nt.focus())};return requestAnimationFrame(ne),G==null||G.addEventListener("keydown",Ce),()=>{var He;G==null||G.removeEventListener("keydown",Ce);const Ie=x.current;Ie&&document.contains(Ie)&&((He=Ie.focus)==null||He.call(Ie))}},[e]);const te=!!t,me=t?t1(t):"",ye=(t==null?void 0:t.subfolder)||"Gallery",Ne=e1((t==null?void 0:t.filename)||""),Pe=a>1,ie=(t==null?void 0:t.meta)||{},Me=[ie!=null&&ie.model?{label:"Model",value:ie.model}:null,ie!=null&&ie.prompt?{label:"Prompt",value:ie.prompt,isPrompt:!0}:null,Array.isArray(ie==null?void 0:ie.loras)&&ie.loras.length?{label:"LoRAs",value:ie.loras.join(", ")}:null].filter(Boolean),Ke=!!((Br=t==null?void 0:t.meta)!=null&&Br.has_prompt||Me.length),lt=typeof(t==null?void 0:t.filename)=="string"&&t.filename.toLowerCase().endsWith(".png"),tt=te&&Ke&&lt,kt=te,B=c.useMemo(()=>[{key:"random",label:"Random"},{key:"keep",label:"Keep"},{key:"custom",label:"Custom"}],[]),q=c.useMemo(()=>{if(T!=="custom")return null;const G=parseInt(String(I),10);return Number.isFinite(G)?G:null},[I,T]),ge=T!=="custom"||q!==null,je=c.useMemo(()=>{if(!String(Y||"").trim())return null;const G=parseInt(String(Y),10);return Number.isFinite(G)&&G>0?G:null},[Y]),Re=c.useMemo(()=>{if(!String(ve||"").trim())return null;const G=parseInt(String(ve),10);return Number.isFinite(G)&&G>0?G:null},[ve]),We=(!String(Y||"").trim()||je!==null)&&(!String(ve||"").trim()||Re!==null),Oe=!!String(Y||"").trim()&&je===null,Qe=!!String(ve||"").trim()&&Re===null,F=Z.checkpoint||(ie==null?void 0:ie.model)||"",se=Array.isArray(Z.loras)?Z.loras:[],b=F?xn(F):"",A=se.length?se.map(G=>xn(G)).join(", "):"",K=c.useMemo(()=>(Le||[]).map(G=>{const ne=String(G||"");return{value:ne,meta:_f(ne)}}),[Le]),re=c.useMemo(()=>(Ue||[]).map(G=>{const ne=String(G||"");return{value:ne,meta:_f(ne)}}),[Ue]),we=c.useMemo(()=>{const G=new Set(["All"]);return K.forEach(({meta:ne})=>{ne!=null&&ne.folderPath&&G.add(ne.folderPath)}),Array.from(G).sort((ne,Ce)=>ne.localeCompare(Ce))},[K]),oe=c.useMemo(()=>{const G=new Set(["All"]);return re.forEach(({meta:ne})=>{ne!=null&&ne.folderPath&&G.add(ne.folderPath)}),Array.from(G).sort((ne,Ce)=>ne.localeCompare(Ce))},[re]),fe=we.length>2,Te=oe.length>2;c.useEffect(()=>{if(!fe){P!=="All"&&D("All");return}we.includes(P)||D("All")},[P,we,fe]),c.useEffect(()=>{if(!Te){H!=="All"&&le("All");return}oe.includes(H)||le("All")},[H,oe,Te]);const dt=c.useMemo(()=>{const G=new Map;return K.forEach(({meta:ne})=>{if(!(ne!=null&&ne.base))return;const Ce=ne.base.toLowerCase();G.set(Ce,(G.get(Ce)||0)+1)}),G},[K]),At=c.useMemo(()=>{const G=new Map;return re.forEach(({meta:ne})=>{if(!(ne!=null&&ne.base))return;const Ce=ne.base.toLowerCase();G.set(Ce,(G.get(Ce)||0)+1)}),G},[re]),Pt=c.useMemo(()=>{const G=[],ne=fe&&P==="All";return K.forEach(({value:Ce,meta:Ie})=>{if(!Ie){G.push({value:Ce,label:Ce});return}if(fe&&P!=="All"&&Ie.folderPath!==P)return;let He=Ie.base||xn(Ce)||Ce;if(ne&&Ie.base){const Nt=Ie.base.toLowerCase();dt.get(Nt)>1&&(He=`${He} (${Rf(Ie.folderPath)})`)}G.push({value:Ce,label:He})}),G},[K,P,dt,fe]),Xt=c.useMemo(()=>{const G=[],ne=Te&&H==="All";return re.forEach(({value:Ce,meta:Ie})=>{if(!Ie){G.push({value:Ce,label:Ce});return}if(Te&&H!=="All"&&Ie.folderPath!==H)return;let He=Ie.base||xn(Ce)||Ce;if(ne&&Ie.base){const Nt=Ie.base.toLowerCase();At.get(Nt)>1&&(He=`${He} (${Rf(Ie.folderPath)})`)}G.push({value:Ce,label:He})}),G},[re,H,At,Te]),ht=c.useMemo(()=>de?Pt.some(G=>String(G.value)===String(de)):!0,[Pt,de]),xt=c.useMemo(()=>C?Xt.some(G=>String(G.value)===String(C)):!0,[Xt,C]),Ll=c.useMemo(()=>!de||ht?Pt:[{value:de,label:xn(String(de))},...Pt],[de,ht,Pt]),Pl=c.useMemo(()=>!C||xt?Xt:[{value:C,label:xn(String(C))},...Xt],[C,xt,Xt]),an=c.useCallback(async G=>{const ne=G==null?void 0:G.hasCheckpoint,Ce=G==null?void 0:G.hasLora;if(!ne&&!Ce)return;Se.current&&Se.current.abort();const Ie=new AbortController;Se.current=Ie,xe(!0),Ae("");try{const[He,Nt]=await Promise.all([ne&&!Le.length?ec("checkpoints",{signal:Ie.signal}):null,Ce&&!Ue.length?ec("loras",{signal:Ie.signal}):null]);He!=null&&He.choices&&_e(He.choices),Nt!=null&&Nt.choices&&Ge(Nt.choices)}catch(He){if((He==null?void 0:He.name)==="AbortError")return;Ae("Unable to load model choices right now.")}finally{Se.current===Ie&&(Se.current=null),xe(!1)}},[Le.length,Ue.length]),Or=c.useCallback(async()=>{var G;if(!t)throw new Error("media_missing");if(V.current)return{prompt:V.current,info:Z};W(!0),U("");try{const ne=await Yx({filename:t.filename,subfolder:t.subfolder||""}),Ce=ne==null?void 0:ne.prompt;if(!Ce)throw new Error("prompt_missing");const Ie=Y0(Ce);return V.current=Ce,ee(Ie),{prompt:Ce,info:Ie}}catch(ne){const Ce=((G=ne==null?void 0:ne.payload)==null?void 0:G.error)||(ne==null?void 0:ne.message)||"Unable to load prompt metadata.";throw U(Ce),ne}finally{W(!1)}},[t==null?void 0:t.filename,t==null?void 0:t.subfolder,Z]),xa=c.useCallback(async()=>{if(tt){R(!0),D("All"),le("All");try{const G=await Or(),ne=G==null?void 0:G.info;be(Ce=>String(Ce||"").trim()?Ce:(ne==null?void 0:ne.width)!==null&&(ne==null?void 0:ne.width)!==void 0?String(ne.width):""),ae(Ce=>String(Ce||"").trim()?Ce:(ne==null?void 0:ne.height)!==null&&(ne==null?void 0:ne.height)!==void 0?String(ne.height):""),await an(G==null?void 0:G.info)}catch{}}},[tt,an,Or]),Vt=G=>{if(!(typeof window>"u"))try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:G}}))}catch{}},Hn=async()=>{var G;if(!(!t||y||!tt)){if(!ge){alert("Enter a valid seed value.");return}if(!We){alert("Enter valid width and height values.");return}w(!0),Vt(!0);try{const{prompt:ne}=await Or(),Ie=q0(ne,{seedMode:T,seedValue:T==="custom"?q:null,checkpoint:de||null,lora:C||null,width:je,height:Re});mm({workflowName:t.filename||"gallery",workflow:Ie,timestamp:Date.now()}),await du({prompt:Ie}),Vt(!1),S(!0),setTimeout(()=>{R(!1),S(!1)},1500)}catch(ne){if(Vt(!1),ne!=null&&ne.unauthorized){window.location.hash="#/login";return}const Ce=((G=ne==null?void 0:ne.payload)==null?void 0:G.error)||(ne==null?void 0:ne.message)||"Unable to re-run this item.";alert(Ce)}finally{w(!1)}}},Dr=async()=>{var ne;if(!(!(t!=null&&t.filename)||!window.confirm("Delete this item? This cannot be undone."))){f(!0);try{await qx({filename:t.filename,subfolder:t.subfolder||""}),l==null||l(),n==null||n()}catch(Ce){if(Ce!=null&&Ce.unauthorized){window.location.hash="#/login";return}const Ie=((ne=Ce==null?void 0:Ce.payload)==null?void 0:ne.error)||(Ce==null?void 0:Ce.message)||"Unable to delete this item.";alert(Ie)}finally{f(!1)}}};return!t||!e||typeof document>"u"?null:iu.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"react-modal-overlay",role:"presentation",onPointerDown:G=>{d.current=G.target===G.currentTarget},onClick:G=>{d.current&&G.target===G.currentTarget&&(N.current||n==null||n())},children:i.jsx("div",{className:"react-modal-content media-viewer-dialog",ref:p,role:"dialog","aria-modal":"true","aria-label":"Preview",onClick:G=>G.stopPropagation(),tabIndex:-1,children:i.jsxs("div",{className:"media-viewer-panel",children:[i.jsx(X0,{filename:t.filename,locationLabel:ye,isClip:Ne,url:me,canRerun:tt,rerunBusy:y,canDelete:kt,deleteBusy:h,metaRows:Me,metaOpen:v,onToggleMeta:()=>g(G=>!G),onOpenOptions:xa,onDelete:Dr,onClose:n,closeButtonRef:m}),v?i.jsx(J0,{metaRows:Me}):null,i.jsx(Z0,{showNav:Pe,canPrev:o,canNext:u,onPrev:r,onNext:s,isClip:Ne,url:me,filename:t.filename})]})})}),i.jsx(Ut,{open:L,onClose:()=>R(!1),title:"Re-run options",footer:j?i.jsxs("div",{className:"fade-in flex items-center justify-center gap-2 py-2 text-sm font-medium text-[#44E1C5]",children:[i.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"Render queued successfully!"]}):i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:()=>R(!1),disabled:y,children:"Cancel"}),i.jsx(Q,{variant:"primary",className:"w-full",onClick:Hn,disabled:y||ce||!!O||!ge||!We,children:y?"Re-running":"Run"})]}),children:i.jsxs("div",{className:"sheet-stack",children:[ce?i.jsx("div",{className:"composer-alias-empty",children:"Loading prompt"}):null,O?i.jsx("div",{className:"text-xs text-[#FF8F70]",children:O}):null,i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Seed"}),i.jsx(Pr,{ariaLabel:"Seed mode",value:T,onChange:z,size:"sm",items:B}),T==="custom"?i.jsx("input",{type:"number",inputMode:"numeric",className:"ui-control ui-input mt-2",placeholder:"Enter seed",value:I,onChange:G=>X(G.target.value)}):null,i.jsx("div",{className:"sheet-hint text-xs text-[#9DA3FFCC]",children:T==="random"?"Randomize each run":"Keep or customize the seed used in the prompt."})]}),Z.hasSize?i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Size"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"number",inputMode:"numeric",min:1,step:1,className:"ui-control ui-input flex-1",placeholder:"Width",value:Y,onChange:G=>be(G.target.value),"aria-label":"Width","aria-invalid":Oe}),i.jsx("span",{className:"text-xs text-[#9DA3FF99]","aria-hidden":"true",children:""}),i.jsx("input",{type:"number",inputMode:"numeric",min:1,step:1,className:"ui-control ui-input flex-1",placeholder:"Height",value:ve,onChange:G=>ae(G.target.value),"aria-label":"Height","aria-invalid":Qe})]})]}):null,Z.hasCheckpoint?i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Checkpoint"}),fe?i.jsx(rt,{value:P,onChange:D,"aria-label":"Checkpoint folder filter",size:"sm",searchThreshold:0,options:we.map(G=>({value:G,label:G}))}):null,i.jsx(rt,{value:de,onChange:_,wrapperClassName:fe?"mt-2":"","aria-label":"Checkpoint override",size:"sm",searchThreshold:0,options:[{value:"",label:b?`Keep current (${b})`:"Keep current"},...Ll]})]}):null,Z.hasLora?i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"LoRA"}),Te?i.jsx(rt,{value:H,onChange:le,"aria-label":"LoRA folder filter",size:"sm",searchThreshold:0,options:oe.map(G=>({value:G,label:G}))}):null,i.jsx(rt,{value:C,onChange:$,wrapperClassName:Te?"mt-2":"","aria-label":"LoRA override",size:"sm",searchThreshold:0,options:[{value:"",label:A?`Keep current (${A})`:"Keep current"},...Pl]})]}):null,ue?i.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:"Loading model choices"}):null,ze?i.jsx("div",{className:"text-xs text-[#FF8F70]",children:ze}):null]})})]}),document.body)}const r1=(e="")=>e.startsWith("."),s1=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),l1=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);function i1(){const e=wu(),t=(W,O="")=>{try{return typeof window<"u"&&localStorage.getItem(W)||O}catch{return O}},n=(W,O)=>{try{typeof window<"u"&&localStorage.setItem(W,O)}catch{}},[r,s]=c.useState(t("galleryPath","")),[l,a]=c.useState([]),[o,u]=c.useState(!1),[d,m]=c.useState(!1),[v,g]=c.useState(""),[y,w]=c.useState(1),[j,S]=c.useState(1),[h,f]=c.useState(()=>{const W=t("galleryPageSize","30"),O=parseInt(W,10);return Number.isFinite(O)?O:30}),[p,x]=c.useState("all"),[N,k]=c.useState(!1),[L,R]=c.useState(""),[T,z]=c.useState(()=>t("galleryRecursive","0")==="1"),[I,X]=c.useState(0);c.useEffect(()=>{let W=!1;const O=new AbortController;return(async()=>{u(!0),g("");try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:gallery:fetch")}catch{}try{const ue=await dm(r,y,h,N,T,p,I,{signal:O.signal,includeMeta:!0});if(W)return;ue&&ue.items?(a(ue.items),S(ue.total_pages||1),g("")):(a([]),S(1));try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:gallery:ready"),performance.measure("cozygen:gallery:first-paint","cozygen:gallery:fetch","cozygen:gallery:ready"))}catch{}}catch(ue){if((ue==null?void 0:ue.name)==="AbortError")return;console.error("Failed to load gallery",ue),W||g("Unable to load gallery right now."),W||(a([]),S(1))}finally{!W&&!O.signal.aborted&&(u(!1),m(!0))}})(),n("galleryPath",r),n("galleryPageSize",String(h)),()=>{W=!0,O.abort()}},[r,y,h,I,N,T,p]);const Y=c.useMemo(()=>{if(!r)return[];const W=r.replace(/\\/g,"/").split("/").filter(Boolean),O=[];for(let U=0;U<W.length;U++)O.push({name:W[U],path:W.slice(0,U+1).join("/")});return O},[r]),be=c.useMemo(()=>l.filter(W=>W.type==="directory").map(W=>({filename:W.filename,subfolder:W.subfolder})),[l]),ve=c.useMemo(()=>{const W=(L||"").trim().toLowerCase();return l.filter(O=>{const U=(O.filename||"").toLowerCase();return!(!N&&r1(U)||O.type!=="directory"&&(p==="image"&&!s1(U)||p==="video"&&!l1(U))||W&&!U.includes(W))})},[l,N,p,L]),ae=c.useMemo(()=>ve.filter(W=>W.type!=="directory"),[ve]),de=c.useCallback(()=>{if(!r)return;const W=r.replace(/\\/g,"/").lastIndexOf("/"),O=W===-1?"":r.slice(0,W);s(O),w(1)},[r]),_=c.useCallback(()=>{s(""),w(1)},[]),C=c.useCallback(W=>{s(W||""),w(1)},[]),$=c.useCallback(W=>{s(W),w(1)},[]),P=c.useCallback(W=>{const O=parseInt(String(W),10)||30;f(O),w(1)},[]),D=c.useCallback(W=>{x(W),w(1)},[]),H=c.useCallback(W=>{const O=!!W;z(O),w(1),n("galleryRecursive",O?"1":"0")},[]),le=c.useCallback(W=>{R(W),w(1)},[]),Z=c.useCallback(()=>{X(W=>W+1)},[]),ee=c.useRef(null),ce=c.useCallback(()=>{ee.current||(ee.current=window.setTimeout(()=>{ee.current=null,Z()},400))},[Z]);return c.useEffect(()=>{const W=()=>Z();return typeof window<"u"&&window.addEventListener&&window.addEventListener("cozygen:queue-finished",W),()=>{typeof window<"u"&&window.removeEventListener&&window.removeEventListener("cozygen:queue-finished",W)}},[Z]),c.useEffect(()=>{if(typeof window>"u"||!e)return;let W=!1,O,U,ue=8e3;const xe=()=>{U&&(clearTimeout(U),U=null)},ze=(Le=8e3)=>{xe(),U=window.setTimeout(()=>{W||(ce(),ze(ue))},Le)};return(()=>{if(!("EventSource"in window)){ze();return}const Le=new URLSearchParams({subfolder:r||"",recursive:T?"1":"0",show_hidden:N?"1":"0"});O=new EventSource(`/cozygen/api/gallery/stream?${Le.toString()}`),O.onmessage=()=>{W||ce()},O.onerror=()=>{O&&(O.close(),O=null),ue=Math.min(Math.ceil(ue*1.4),2e4),ze()}})(),()=>{W=!0,xe(),ee.current&&(clearTimeout(ee.current),ee.current=null),O&&(O.close(),O=null)}},[r,T,N,ce,e]),c.useEffect(()=>{e&&Z()},[e,Z]),{path:r,items:l,loading:o,hasLoaded:d,error:v,page:y,totalPages:j,perPage:h,kind:p,showHidden:N,query:L,recursive:T,crumbs:Y,dirChips:be,filtered:ve,mediaItems:ae,setPage:w,setPerPage:P,setShowHidden:k,setQuery:le,setKind:D,setRecursive:H,goBack:de,goRoot:_,goToPath:C,selectDir:$,refresh:Z}}function a1(e){const[t,n]=c.useState(!1),[r,s]=c.useState(null);c.useEffect(()=>{if(!e||e.length===0){s(null),n(!1);return}s(y=>y==null?y:y>=e.length?e.length-1:y)},[e]);const l=c.useCallback(y=>{if(!e||!e.length||!y)return;const w=e.indexOf(y);w!==-1&&(s(w),n(!0))},[e]),a=c.useCallback(()=>{n(!1),s(null)},[]),o=c.useCallback(()=>{!e||!e.length||s(y=>y==null||y>=e.length-1?y:y+1)},[e]),u=c.useCallback(()=>{!e||!e.length||s(y=>y==null||y<=0?y:y-1)},[e]),d=r!=null&&r>=0&&e&&r<e.length?e[r]:null,m=(e==null?void 0:e.length)||0,v=r!==null&&r>0,g=r!==null&&r<m-1;return{viewerOpen:t,viewerIndex:r,currentMedia:d,total:m,canPrev:v,canNext:g,open:l,close:a,next:o,prev:u,setViewerOpen:n}}const If="cozygen_gallery_view_mode",Af="cozygen_gallery_feed_autoplay";function o1(e,t){const n=c.useRef(null),[r,s]=c.useState(0),[l,a]=c.useState({width:0,cols:0,top:0,viewport:typeof window<"u"&&window.innerHeight||800}),o=g=>{if(!g||typeof window>"u")return null;let y=g.parentElement;for(;y;){const w=window.getComputedStyle(y);if(w.overflowY==="auto"||w.overflowY==="scroll")return y;y=y.parentElement}return window};c.useEffect(()=>{if(!t)return;const g=n.current;if(!g||typeof window>"u"||typeof ResizeObserver>"u")return;const y=o(g)||window,w=()=>{const f=g.getBoundingClientRect(),p=f.width||g.clientWidth||1,x=Math.max(1,Math.floor(p/160)),N=y===window?window.scrollY||0:y.scrollTop||0,k=y===window?{top:0}:y.getBoundingClientRect(),L=y===window?f.top+(window.scrollY||0):f.top-k.top+N,R=y===window?window.innerHeight||800:y.clientHeight||800;a(T=>T.width===p&&T.cols===x&&T.top===L&&T.viewport===R?T:{width:p,cols:x,top:L,viewport:R}),s(N)};w();const j=new ResizeObserver(()=>w());j.observe(g),window.addEventListener("resize",w);let S=!1;const h=()=>{S||(S=!0,window.requestAnimationFrame(()=>{S=!1;const f=y===window?window.scrollY||0:y.scrollTop||0;s(f)}))};return y.addEventListener("scroll",h,{passive:!0}),()=>{j.disconnect(),window.removeEventListener("resize",w),y.removeEventListener("scroll",h)}},[t]);const u=t&&l.cols>0&&e.length>60,{visibleItems:d,topSpacer:m,bottomSpacer:v}=c.useMemo(()=>{if(!u)return{visibleItems:e,topSpacer:0,bottomSpacer:0};const g=l.width/l.cols,y=Math.max(180,Math.ceil(g*1.25)+32),w=Math.ceil(e.length/l.cols),j=Math.max(0,r-l.top),S=Math.max(0,Math.floor(j/y)-2),h=Math.min(w,Math.ceil((j+l.viewport)/y)+2),f=S*l.cols,p=Math.min(e.length,h*l.cols);return{visibleItems:e.slice(f,p),topSpacer:S*y,bottomSpacer:Math.max(0,(w-h)*y)}},[e,l,r,u]);return{containerRef:n,visibleItems:d,topSpacer:m,bottomSpacer:v,virtualized:u}}function c1(){const{path:e,loading:t,hasLoaded:n,page:r,totalPages:s,perPage:l,kind:a,showHidden:o,recursive:u,error:d,crumbs:m,dirChips:v,filtered:g,mediaItems:y,setPage:w,setPerPage:j,setShowHidden:S,setKind:h,setRecursive:f,goBack:p,goRoot:x,goToPath:N,selectDir:k,refresh:L}=i1(),{viewerOpen:R,currentMedia:T,total:z,canPrev:I,canNext:X,open:Y,close:be,next:ve,prev:ae}=a1(y),[de,_]=c.useState(()=>{if(typeof window>"u")return"grid";const V=window.localStorage.getItem(If);return V==="feed"||V==="grid"?V:"grid"}),[C,$]=c.useState(()=>typeof window>"u"?!1:window.localStorage.getItem(Af)==="true");c.useEffect(()=>{try{window.localStorage.setItem(If,de)}catch{}},[de]),c.useEffect(()=>{try{window.localStorage.setItem(Af,C?"true":"false")}catch{}},[C]);const P=c.useCallback(async()=>{try{await sw(),L(),alert("Cache cleared successfully! Thumbnails will be regenerated.")}catch(V){alert("Failed to clear cache: "+(V.message||"Unknown error"))}},[L]),D=c.useCallback(V=>{if(V.type==="directory"){k(V.subfolder);return}Y(V)},[Y,k]),H=de==="grid",[le,Z]=c.useState(!1),ee=c.useMemo(()=>[{key:"all",label:"All"},{key:"image",label:"Images"},{key:"video",label:"Videos"}],[]),ce=c.useMemo(()=>[{key:"grid",ariaLabel:"Grid view",icon:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[i.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),i.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})},{key:"feed",ariaLabel:"Feed view",icon:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[i.jsx("rect",{x:"2",y:"1",width:"12",height:"5",rx:"1"}),i.jsx("rect",{x:"2",y:"8",width:"12",height:"5",rx:"1"})]})}],[]),W=V=>V.type==="directory"?`dir:${V.subfolder||V.filename}`:`${V.subfolder||""}|${V.filename}`;c.useEffect(()=>{try{window.localStorage.setItem("cozygen_gallery_pending","0")}catch{}window.dispatchEvent(new Event("cozygen:gallery-viewed"))},[]);const O=t&&!n,U=t&&n,ue=`${g.length} items`,xe=O?"Loading":ue,ze=!!d,{containerRef:Ae,visibleItems:Le,topSpacer:_e,bottomSpacer:Ue,virtualized:Ge}=o1(g,H);return i.jsxs("div",{className:"page-shell gallery-shell",children:[i.jsx("div",{className:"screen-sticky gallery-header",children:i.jsxs("div",{className:"gallery-header-inner",children:[i.jsxs("div",{className:"page-bar gallery-bar",children:[i.jsx("h1",{className:"page-bar-title",children:"Gallery"}),i.jsxs("div",{className:"page-bar-actions",children:[i.jsx("span",{className:"gallery-status",children:xe}),i.jsx(Pr,{ariaLabel:"View mode",value:de,onChange:_,layout:"icon",size:"sm",items:ce}),i.jsx(Q,{size:"xs",className:"mobile-only",onClick:()=>Z(!0),children:"Filters"})]})]}),i.jsx("div",{className:"gallery-nav-row",children:i.jsx(B0,{subfolder:e,crumbs:m,dirChips:v,onBack:p,onRoot:x,onCrumb:V=>N(V),onSelectDir:V=>k(V)})}),i.jsxs("div",{className:"gallery-toolbar",children:[i.jsx("div",{className:"gallery-toolbar-left",children:i.jsx(Pr,{ariaLabel:"Filter by type",value:a,onChange:h,size:"sm",items:ee})}),i.jsx("div",{className:"gallery-toolbar-right",children:i.jsxs("div",{className:"gallery-options",children:[i.jsx(Q,{size:"icon",active:u,pressed:u,onClick:()=>f(V=>!V),title:u?"Showing subfolders":"This folder only","aria-label":"Toggle subfolders",children:u?i.jsx(tc,{size:16}):i.jsx(nf,{size:16})}),i.jsx(Q,{size:"icon",active:o,pressed:o,onClick:()=>S(V=>!V),title:o?"Showing hidden":"Hiding hidden","aria-label":"Toggle hidden items",children:o?i.jsx(rf,{size:16}):i.jsx(sf,{size:16})}),de==="feed"&&i.jsx(Q,{size:"icon",active:C,pressed:C,onClick:()=>$(V=>!V),title:C?"Autoplay on":"Autoplay off","aria-label":"Toggle autoplay",children:C?i.jsx(lf,{size:16}):i.jsx(af,{size:16})}),i.jsx(Q,{size:"icon",onClick:L,title:"Refresh","aria-label":"Refresh gallery",children:i.jsx(nc,{size:16})}),i.jsx(Q,{size:"xs",onClick:P,title:"Clear thumbnail cache","aria-label":"Clear cache",children:"Clear Cache"})]})})]}),i.jsx("div",{className:"gallery-pagination",children:i.jsxs("div",{className:"gallery-pagination-controls",children:[i.jsx(Q,{size:"icon",variant:"ghost",onClick:()=>w(V=>Math.max(1,V-1)),disabled:r<=1||t,"aria-label":"Previous page",children:i.jsx(Sm,{size:16})}),i.jsxs("span",{className:"gallery-page-indicator",children:[r," / ",s]}),i.jsx(Q,{size:"icon",variant:"ghost",onClick:()=>w(V=>V<s?V+1:V),disabled:r>=s||t,"aria-label":"Next page",children:i.jsx(ha,{size:16})}),i.jsx(rt,{value:l,onChange:V=>j(parseInt(V,10)||30),className:"gallery-page-size","aria-label":"Items per page",size:"sm",options:[15,30,60,120]})]})})]})}),O&&g.length===0?i.jsx("div",{className:"gallery-grid-responsive",children:Array.from({length:8}).map((V,Se)=>i.jsxs("div",{className:"gallery-skeleton-item",children:[i.jsx("div",{className:"gallery-skeleton-thumb skeleton"}),i.jsx("div",{className:"gallery-skeleton-label skeleton skeleton-text"})]},Se))}):ze&&g.length===0?i.jsxs("div",{className:"gallery-empty",role:"alert",children:[i.jsx("div",{className:"gallery-empty-icon",children:i.jsx(of,{size:48})}),i.jsx("div",{className:"gallery-empty-title",children:"Gallery unavailable"}),i.jsx("div",{className:"gallery-empty-desc",children:d}),i.jsx(Q,{size:"sm",variant:"primary",className:"mt-4",onClick:L,children:"Retry"})]}):g.length===0?i.jsxs("div",{className:"gallery-empty",children:[i.jsx("div",{className:"gallery-empty-icon",children:i.jsx(of,{size:48})}),i.jsx("div",{className:"gallery-empty-title",children:"No media found"}),i.jsx("div",{className:"gallery-empty-desc",children:a!=="all"?`No ${a}s match your filters. Try selecting "All" or adjusting your search.`:"This folder is empty. Render something new or navigate to a different folder."})]}):H?i.jsx("div",{className:"w-full overflow-hidden",children:i.jsxs("div",{className:"gallery-grid-responsive",ref:Ae,children:[Ge&&_e>0?i.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${_e}px`}}):null,Le.map(V=>i.jsx(Pf,{item:V,onSelect:D,variant:"grid",autoPlay:!1},W(V))),Ge&&Ue>0?i.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${Ue}px`}}):null]})}):i.jsx("div",{className:"flex flex-col gap-6 items-center",children:y.map(V=>i.jsx("div",{className:"w-full flex justify-center",children:i.jsx(Pf,{item:V,onSelect:D,variant:"feed",autoPlay:C})},W(V)))}),i.jsx(n1,{isOpen:R,media:T,onClose:be,onPrev:ae,onNext:ve,onDeleted:L,total:z,canPrev:I,canNext:X}),i.jsx(Ut,{open:le,onClose:()=>Z(!1),title:"Gallery filters",contentClassName:"gallery-filters-sheet",footer:i.jsx(Q,{variant:"primary",className:"w-full",onClick:()=>Z(!1),children:"Done"}),children:i.jsxs("div",{className:"sheet-stack gallery-filters-stack",children:[i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Type"}),i.jsx(Pr,{ariaLabel:"Filter by type",value:a,onChange:h,size:"sm",items:ee})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Options"}),i.jsxs("div",{className:"gallery-filter-actions",children:[i.jsx(Q,{size:"sm",variant:u?"primary":"muted",onClick:()=>f(V=>!V),children:i.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[u?i.jsx(tc,{size:14}):i.jsx(nf,{size:14}),i.jsx("span",{children:u?"Subfolders":"This folder"})]})}),i.jsx(Q,{size:"sm",variant:o?"primary":"muted",onClick:()=>S(V=>!V),children:i.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[o?i.jsx(rf,{size:14}):i.jsx(sf,{size:14}),i.jsx("span",{children:o?"Hidden on":"Hidden off"})]})}),de==="feed"?i.jsx(Q,{size:"sm",variant:C?"primary":"muted",onClick:()=>$(V=>!V),children:i.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[C?i.jsx(lf,{size:14}):i.jsx(af,{size:14}),i.jsx("span",{children:C?"Autoplay":"No autoplay"})]})}):null,i.jsx(Q,{size:"sm",variant:"ghost",onClick:L,children:i.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[i.jsx(nc,{size:14}),i.jsx("span",{children:"Refresh"})]})})]})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Page size"}),i.jsxs("div",{className:"gallery-filter-page",children:[i.jsx(rt,{value:l,onChange:V=>j(parseInt(V,10)||30),"aria-label":"Items per page",size:"sm",options:[15,30,60,120]}),i.jsxs("div",{className:"sheet-hint",children:[U?i.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):null,i.jsxs("span",{children:[xe,"  Page ",r," of ",s]})]}),i.jsxs("div",{className:"gallery-filter-pagination",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:()=>w(V=>Math.max(1,V-1)),disabled:r<=1||t,children:"Prev"}),i.jsx(Q,{variant:"muted",className:"w-full",onClick:()=>w(V=>V<s?V+1:V),disabled:r>=s||t,children:"Next"})]})]})]})]})})]})}const u1=()=>typeof window>"u"?800:window.innerHeight||800,d1=e=>{if(!e||typeof window>"u")return null;let t=e.parentElement;for(;t;){const n=window.getComputedStyle(t);if(n.overflowY==="auto"||n.overflowY==="scroll")return t;t=t.parentElement}return window};function ku({itemCount:e,enabled:t=!0,estimateRowHeight:n=72,overscan:r=6,minItems:s=80}={}){const l=c.useRef(null),a=c.useRef(n),[o,u]=c.useState({top:0,scrollTop:0,viewport:u1(),rowHeight:n});c.useEffect(()=>{if(!t)return;const j=l.current;if(!j||typeof window>"u"||typeof ResizeObserver>"u")return;const S=d1(j)||window,h=()=>{const N=j.getBoundingClientRect(),k=S===window?window.scrollY||0:S.scrollTop||0,L=S===window?{top:0}:S.getBoundingClientRect(),R=S===window?N.top+(window.scrollY||0):N.top-L.top+k,T=S===window?window.innerHeight||800:S.clientHeight||800;u(z=>z.top===R&&z.scrollTop===k&&z.viewport===T&&z.rowHeight===a.current?z:{top:R,scrollTop:k,viewport:T,rowHeight:a.current})};h();const f=new ResizeObserver(()=>h());f.observe(j),window.addEventListener("resize",h);let p=!1;const x=()=>{p||(p=!0,window.requestAnimationFrame(()=>{p=!1;const N=S===window?window.scrollY||0:S.scrollTop||0;u(k=>k.scrollTop===N&&k.rowHeight===a.current?k:{...k,scrollTop:N,rowHeight:a.current})}))};return S.addEventListener("scroll",x,{passive:!0}),()=>{f.disconnect(),window.removeEventListener("resize",h),S.removeEventListener("scroll",x)}},[t]),c.useEffect(()=>{if(!t||typeof window>"u")return;let j=0;const S=()=>{const h=l.current;if(!h)return;const f=h.querySelector('[data-virtual-row="true"]');if(!f)return;const p=f.getBoundingClientRect(),x=Math.max(24,Math.round(p.height||0));x&&Math.abs(x-a.current)>2&&(a.current=x,u(N=>({...N,rowHeight:x})))};return j=window.requestAnimationFrame(S),()=>{j&&window.cancelAnimationFrame(j)}},[t,e,o.scrollTop]);const d=!!(t&&e>s),{startIndex:m,endIndex:v,topSpacer:g,bottomSpacer:y}=c.useMemo(()=>{if(!d)return{startIndex:0,endIndex:e,topSpacer:0,bottomSpacer:0};const j=o.rowHeight||n,S=Math.max(0,o.scrollTop-o.top),h=Math.max(0,Math.floor(S/j)-r),f=Math.min(e,Math.ceil((S+o.viewport)/j)+r);return{startIndex:h,endIndex:f,topSpacer:h*j,bottomSpacer:Math.max(0,(e-f)*j)}},[e,o,r,n,d]),w=v>=e-Math.max(6,r*2);return{containerRef:l,startIndex:m,endIndex:v,topSpacer:g,bottomSpacer:y,virtualized:d,isNearEnd:w}}const f1=c.memo(function({id:t,name:n,category:r,text:s,isSelected:l,onOpen:a,visibilityStyle:o}){const u=c.useCallback(()=>{a(t)},[t,a]),d=Lm({name:n})||n||"Untitled",m=r?`${r}:${n}`:n,v=`${(s||"").slice(0,140)}${(s||"").length>140?"":""}`;return i.jsxs("button",{type:"button",role:"listitem",className:`composer-alias-item ${l?"is-selected":""}`,onClick:u,style:o,"data-virtual-row":"true",children:[i.jsxs("div",{className:"composer-alias-header",children:[i.jsx("div",{className:"composer-alias-name",children:d}),r?i.jsx("span",{className:"composer-alias-category",children:Tn(r)}):null]}),i.jsxs("div",{className:"composer-alias-token",children:["$",m||"alias","$"]}),i.jsx("div",{className:"composer-alias-text",children:v||""})]})}),Ki="::",p1=()=>`alias-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,6)}`,_n=e=>String(e||"").split(",").map(t=>t.trim()).filter(Boolean),Nu=e=>(e||[]).map(t=>String(t||"").trim()).filter(Boolean).join(", "),h1=(e,t)=>{const n=String(t||"").trim();if(!n)return String(e||"");const r=_n(e);return new Set(r.map(l=>l.toLowerCase())).has(n.toLowerCase())||r.push(n),Nu(r)},m1=(e,t)=>{const n=String(t||"").trim().toLowerCase();if(!n)return String(e||"");const r=_n(e).filter(s=>s.toLowerCase()!==n);return Nu(r)},g1=(e,t,n)=>{const r=String(t||"").trim().toLowerCase(),s=String(n||"").trim();if(!r||!s)return String(e||"");const l=_n(e).map(u=>u.toLowerCase()===r?s:u),a=new Set,o=[];return l.forEach(u=>{const d=String(u||"").trim().toLowerCase();!d||a.has(d)||(a.add(d),o.push(u))}),Nu(o)},Ja=(e,t={})=>Object.entries(Js(e)).map(([n,r],s)=>{const[l,a]=String(n).includes(Ki)?n.split(Ki):["",n],o=a||n,u=t[n]||t[o]||l||"";return{id:`existing-${s}-${n}`,name:o,text:r,category:u}}),Tf=e=>{const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.text)=="string"?n.text.trim():"";if(r&&s){const l=String((n==null?void 0:n.category)||"").trim(),a=l?`${l}${Ki}${r}`:r;t[a]=s}}),t},Mf=e=>{const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.category)=="string"?n.category.trim():"";if(r){const l=s?`${s}${Ki}${r}`:r;t[l]=s}}),t},v1={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function y1(){var se;const e=Ln(),{aliases:t,aliasCategories:n,categoryList:r,loading:s,saving:l,error:a,persistAliases:o}=Bm(),[u,d]=c.useState(()=>Ja(t,n)),[m,v]=c.useState(()=>Array.isArray(r)?r:[]),[g,y]=c.useState("All"),[w,j]=c.useState("All"),[S,h]=c.useState(""),f=c.useDeferredValue(S),[p,x]=c.useState(""),[N,k]=c.useState(!1),[L,R]=c.useState(!1),[T,z]=c.useState({loading:!1,invalid:[],suggestions:{}}),[I,X]=c.useState(!1),[Y,be]=c.useState(null),[ve,ae]=c.useState(""),de=c.useRef(null),_=c.useRef(null),[C,$]=c.useState(!1),[P,D]=c.useState(""),[H,le]=c.useState(""),Z=fu("(min-width: 1024px)");c.useEffect(()=>{if(C)return;const b=Ja(t,n||{});d(b),p&&!b.some(A=>A.id===p)&&(x(""),k(!1))},[n,C]),c.useEffect(()=>{C||Array.isArray(r)&&v(r)},[r,C]),c.useEffect(()=>{if(C)return;const b=Ja(t,n||{});d(b),p&&!b.some(A=>A.id===p)&&(x(""),k(!1))},[t,n,p,C]);const ee=c.useMemo(()=>Tf(u),[u]),ce=()=>{const b={id:p1(),name:"",text:"",category:""};d(A=>[...A,b]),x(b.id),ae(""),$(!0),k(!0)},W=(b,A,K)=>{$(!0),d(re=>re.map((we,oe)=>oe===b?{...we,[A]:K}:we))},O=b=>{$(!0),d(A=>{var re;const K=A.filter((we,oe)=>oe!==b);return(K.length===0||p===((re=A[b])==null?void 0:re.id))&&(x(""),k(!1)),K})},U=async()=>{ae("");try{const b=new Map;if(u.forEach(K=>{_n((K==null?void 0:K.text)||"").forEach(we=>{const oe=String(we).toLowerCase();oe&&(b.has(oe)||b.set(oe,{tag:we,rows:[]}),b.get(oe).rows.push(K.id))})}),b.size){const K=Array.from(b.values()).map(re=>re.tag);try{const re=await Ka(K),we=Array.isArray(re==null?void 0:re.invalid)?re.invalid:[],oe=new Set(we.map(fe=>String(fe).toLowerCase()));if(oe.size){const fe=u.map(Te=>{const At=_n((Te==null?void 0:Te.text)||"").filter(Xt=>oe.has(String(Xt).toLowerCase()));if(!At.length)return null;const Pt=Te.category?`${Te.category}:${Te.name}`:Te.name;return{id:Te.id,token:Pt,friendlyName:formatAliasFriendlyName({name:Te.name})||Te.name||"Untitled",category:Te.category||"",invalid:At}}).filter(Boolean);be({invalid:we,invalidLower:Array.from(oe),rows:fe,suggestions:(re==null?void 0:re.suggestions)||{}}),X(!0),ae("Fix invalid tags before saving.");return}}catch(re){console.error("Unable to validate tags",re),ae("Unable to validate tags right now.");return}}const A=Mf(u);await o({items:ee,categories:A,categoryList:m}),$(!1),ae("Saved.")}catch{ae("Unable to save right now.")}},ue=c.useMemo(()=>{const b=f.trim().toLowerCase(),K=[...u.filter(re=>{const we=(re.category||"").trim();if(g===""&&we||g!=="All"&&g!==""&&we!==g)return!1;const oe=Ds(re.name||"",re.category||"");if(w!=="All"&&oe!==w)return!1;if(!b)return!0;const fe=we?`${we}:${re.name}`:re.name;return(re.name||"").toLowerCase().includes(b)||(re.text||"").toLowerCase().includes(b)||(we||"").toLowerCase().includes(b)||(fe||"").toLowerCase().includes(b)})];return K.sort((re,we)=>(re.name||"").localeCompare(we.name||"")),K},[u,g,w,f]),{containerRef:xe,startIndex:ze,endIndex:Ae,topSpacer:Le,bottomSpacer:_e,virtualized:Ue}=ku({itemCount:ue.length,enabled:!0,estimateRowHeight:86,overscan:8,minItems:120}),Ge=Ue?ue.slice(ze,Ae):ue,V=ue.find(b=>b.id===p)||u.find(b=>b.id===p)||null,Se=V?V.category?`${V.category}:${V.name}`:V.name||"alias":"",Ye=V&&(formatAliasFriendlyName({name:V.name})||V.name)||"Alias",te=Se?`$${Se}$`:"$alias$",me=ue.length?ue:u,ye=V?me.findIndex(b=>b.id===V.id):-1,Ne=ye>0?me[ye-1]:null,Pe=ye>=0&&ye<me.length-1?me[ye+1]:null,ie=b=>{b&&(x(b.id),k(!0),ae(""))},Me=c.useMemo(()=>{const b=new Set(m||[]);return u.forEach(A=>{A.category&&b.add(A.category)}),Array.from(b).sort((A,K)=>A.localeCompare(K))},[u,m]),Ke=c.useMemo(()=>{const b=new Set;return u.forEach(A=>{const K=(A.category||"").trim();if(g===""&&K||g!=="All"&&g!==""&&K!==g)return;const re=Ds(A.name||"",A.category||"");re&&b.add(re)}),Array.from(b).sort((A,K)=>A.localeCompare(K))},[u,g]);c.useEffect(()=>{w!=="All"&&(Ke.includes(w)||j("All"))},[Ke,w]),c.useEffect(()=>{le("")},[p]);const lt=c.useMemo(()=>_n((V==null?void 0:V.text)||""),[V==null?void 0:V.text]),tt=c.useMemo(()=>{const b=Array.isArray(T==null?void 0:T.invalid)?T.invalid:[];return new Set(b.map(A=>String(A).toLowerCase()))},[T]);c.useEffect(()=>{if(!V||!(N||Z))return;const b=lt,A=[],K=new Set;if(b.forEach(oe=>{const fe=String(oe).toLowerCase();!fe||K.has(fe)||(K.add(fe),A.push(oe))}),!A.length){z({loading:!1,invalid:[],suggestions:{}});return}let re=!1;const we=window.setTimeout(async()=>{z(oe=>({...oe,loading:!0}));try{const oe=await Ka(A);if(re)return;z({loading:!1,invalid:Array.isArray(oe==null?void 0:oe.invalid)?oe.invalid:[],suggestions:(oe==null?void 0:oe.suggestions)||{}})}catch(oe){console.error("Failed to validate tags",oe),re||z({loading:!1,invalid:[],suggestions:{}})}},260);return()=>{re=!0,window.clearTimeout(we)}},[N,Z,V,lt]);const kt=b=>{var K,re;const A=String(b||"");if(!A)return!1;try{return(re=(K=navigator.clipboard)==null?void 0:K.writeText)==null||re.call(K,A),!0}catch{return!1}},B=(b="")=>{const A=b?`?q=${encodeURIComponent(b)}`:"";e(`/tags${A}`)},q=()=>{var re;if(!V)return;const b=_n(H);if(!b.length){ae("Enter a tag to add.");return}const A=u.findIndex(we=>we.id===V.id);if(A===-1)return;let K=((re=u[A])==null?void 0:re.text)||"";b.forEach(we=>{K=h1(K,we)}),W(A,"text",K),le(""),ae(`Added ${b.length} tag${b.length===1?"":"s"}.`)},ge=async()=>{const b=P.trim();if(!b){ae("Enter a category name.");return}const A=Array.from(new Set([...m||[],b]));v(A),D(""),ae("Category added.");const K=Tf(u),re=Mf(u);$(!0);try{await o({items:K,categories:re,categoryList:A}),$(!1),ae("Category saved.")}catch{ae("Unable to save right now.")}},je=c.useCallback(b=>{b&&(x(b.id),k(!0),ae(""))},[]),Re=c.useMemo(()=>{const b=new Map;return u.forEach(A=>{A!=null&&A.id&&b.set(A.id,A)}),b},[u]),We=c.useCallback(b=>{const A=Re.get(b);A&&je(A)},[je,Re]),Oe=()=>{Z&&x(""),k(!1),ae("")};c.useMemo(()=>{const b=u.length,A=ue.length;return s&&b===0?"Loading":b===A?`${b} aliases`:`${A} of ${b} aliases`},[u.length,ue.length,s]),c.useEffect(()=>{const b=A=>{var Te,dt;if(A.defaultPrevented)return;const K=A.target,re=(K==null?void 0:K.tagName)||"",we=["INPUT","TEXTAREA","SELECT"].includes(re)||(K==null?void 0:K.isContentEditable),oe=String(A.key||"").toLowerCase(),fe=A.metaKey||A.ctrlKey;if(fe&&oe==="s"){A.preventDefault(),C&&!l&&U();return}if(fe&&oe==="n"){A.preventDefault(),ce();return}if(!we&&oe==="/"){A.preventDefault(),(dt=(Te=_.current)==null?void 0:Te.focus)==null||dt.call(Te);return}oe==="escape"&&N&&!Z&&(A.preventDefault(),Oe())};return window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[ce,Oe,C,N,U,Z,l]);const Qe=i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:Oe,children:Z?"Clear selection":"Close"}),i.jsx(Q,{variant:"primary",className:"w-full",onClick:U,disabled:l||!C,children:l?"Saving":C?"Save":"Saved"})]}),F=V?i.jsxs("div",{className:"sheet-stack",children:[i.jsxs("div",{className:"alias-editor-toolbar",children:[i.jsxs("div",{className:"alias-editor-heading",children:[i.jsx("div",{className:"alias-editor-title",children:Ye}),i.jsx("div",{className:"alias-editor-meta",children:te})]}),i.jsxs("div",{className:"alias-editor-actions",children:[i.jsx(Q,{size:"xs",variant:"muted",onClick:()=>ie(Ne),disabled:!Ne,title:"Previous alias",children:"Prev"}),i.jsx(Q,{size:"xs",variant:"muted",onClick:()=>ie(Pe),disabled:!Pe,title:"Next alias",children:"Next"}),i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>{Se&&kt(te)?ae("Token copied."):ae("Copy not available on this browser.")},title:"Copy token",children:"Copy token"})]})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Token"}),i.jsx("div",{className:"composer-token",children:te}),Ds(V.name||"",V.category||"")?i.jsxs("div",{className:"sheet-hint",children:["Subcategory: ",mr(Ds(V.name||"",V.category||""))]}):null]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Friendly name"}),i.jsx("div",{className:"composer-field",children:Ye})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Alias name"}),i.jsx("input",{ref:de,type:"text",value:V.name||"",onChange:b=>{const A=u.findIndex(K=>K.id===V.id);A!==-1&&W(A,"name",b.target.value)},placeholder:"e.g. cherry_fruit",className:"sheet-input ui-control ui-input"})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Category"}),i.jsx(rt,{value:V.category||"",onChange:b=>{const A=u.findIndex(K=>K.id===V.id);A!==-1&&W(A,"category",b)},size:"sm",searchThreshold:0,options:[{value:"",label:"Uncategorized"},...Me.filter(Boolean).map(b=>({value:b,label:Tn(b)}))]}),i.jsx(Q,{size:"xs",variant:"muted",onClick:()=>R(!0),children:"Manage categories"})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Expands to"}),i.jsx("textarea",{value:V.text,onChange:b=>{const A=u.findIndex(K=>K.id===V.id);A!==-1&&W(A,"text",b.target.value)},placeholder:"Prompt text for this alias",className:"sheet-textarea ui-control ui-textarea is-compact",rows:6}),i.jsxs("div",{className:"tag-quick-add",children:[i.jsx("input",{type:"text",value:H,onChange:b=>le(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),q())},placeholder:"Add tags (comma separated)",className:"ui-control ui-input tag-quick-input","aria-label":"Add tags"}),i.jsx(Q,{size:"sm",variant:"primary",onClick:q,disabled:!H.trim(),children:"Add"})]}),i.jsxs("div",{className:"tag-editor-actions",children:[i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>B(""),children:i.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.jsx(pr,{size:14}),"Open tag library"]})}),i.jsx(Q,{size:"xs",variant:"muted",onClick:()=>{z(A=>({...A,loading:!0}));const b=_n(V.text||"");Ka(b).then(A=>{z({loading:!1,invalid:Array.isArray(A==null?void 0:A.invalid)?A.invalid:[],suggestions:(A==null?void 0:A.suggestions)||{}})}).catch(()=>z({loading:!1,invalid:[],suggestions:{}}))},disabled:T.loading,title:"Validate against danbooru_tags.md",children:T.loading?"Validating":"Validate"})]}),lt.length?i.jsx("div",{className:"tag-chip-list","aria-label":"Alias tags",children:lt.map(b=>{const A=tt.has(String(b).toLowerCase());return i.jsxs("span",{className:`ui-chip ${A?"is-invalid":""}`,children:[i.jsx("code",{className:"ui-chip-code",children:b}),i.jsx(Q,{size:"mini",variant:"danger",onClick:()=>{const K=u.findIndex(re=>re.id===V.id);K!==-1&&W(K,"text",m1(V.text||"",b))},"aria-label":`Remove ${b}`,title:"Remove",children:i.jsx(hr,{size:12})})]},b)})}):i.jsx("div",{className:"sheet-hint",children:"Tip: Use the Tag library to add validated tags quickly."}),!T.loading&&Array.isArray(T.invalid)&&T.invalid.length?i.jsxs("div",{className:"tag-invalid-panel",role:"alert",children:[i.jsxs("div",{className:"tag-invalid-title",children:["Invalid tags (",T.invalid.length,")"]}),i.jsx("div",{className:"tag-invalid-body",children:T.invalid.map(b=>{var K;const A=((K=T==null?void 0:T.suggestions)==null?void 0:K[b])||[];return i.jsxs("div",{className:"tag-invalid-row",children:[i.jsxs("div",{className:"tag-invalid-tag",children:[i.jsx("code",{children:b}),i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>B(b),children:"Find"})]}),Array.isArray(A)&&A.length?i.jsx("div",{className:"tag-invalid-suggestions",children:A.slice(0,6).map(re=>i.jsx(Q,{size:"xs",variant:"chip",onClick:()=>{const we=u.findIndex(oe=>oe.id===V.id);we!==-1&&W(we,"text",g1(V.text||"",b,re))},title:`Replace ${b} with ${re}`,children:re},`${b}-${re}`))}):i.jsx("div",{className:"sheet-hint",children:"No suggestions found for this tag."})]},b)})})]}):null]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx(Q,{variant:"danger",onClick:()=>{const b=u.findIndex(A=>A.id===V.id);b!==-1&&(O(b),k(!1))},children:"Delete alias"}),i.jsx("div",{className:"sheet-hint",children:"Deleting removes it from your library. Use Save changes to persist."})]})]}):i.jsx("div",{className:"alias-editor-empty",children:"Select an alias to edit, or create a new one."});return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"page-shell page-stack alias-page",children:[i.jsxs("div",{className:"page-bar",children:[i.jsx("h1",{className:"page-bar-title",children:"Aliases"}),i.jsxs("div",{className:"page-bar-actions",children:[i.jsx(Q,{size:"xs",onClick:()=>openTagLibrary({query:S||"",targetId:""}),title:"Browse danbooru tags",children:"Tags"}),i.jsx(Q,{size:"xs",variant:"primary",onClick:ce,children:"Add"})]})]}),i.jsx("div",{className:"library-toolbar screen-sticky",children:i.jsxs("div",{className:"library-toolbar-inner",children:[i.jsxs("div",{className:"composer-filters",children:[i.jsxs("div",{className:"input-with-action",children:[i.jsx("input",{ref:_,type:"search",value:S,onChange:b=>h(b.target.value),className:"composer-search ui-control ui-input",placeholder:"Search aliases","aria-label":"Search aliases"}),i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>h(""),disabled:!S,children:"Clear"})]}),i.jsx(rt,{wrapperClassName:"composer-subcategory-select",value:g,onChange:y,"aria-label":"Filter by category",size:"sm",searchThreshold:0,options:[{value:"All",label:"Category: All"},{value:"",label:"Uncategorized"},...Me.filter(Boolean).map(b=>({value:b,label:Tn(b)}))]}),i.jsx(rt,{wrapperClassName:"composer-subcategory-select",value:w,onChange:j,"aria-label":"Filter by subcategory",size:"sm",searchThreshold:0,options:[{value:"All",label:"Subcategory: All"},...Ke.map(b=>({value:b,label:mr(b)}))]}),C?i.jsx(Q,{size:"sm",variant:"primary",onClick:U,disabled:l,children:l?"Saving":"Save changes"}):null]}),a?i.jsx("div",{className:"library-toolbar-status is-error",children:"Could not load aliases. Try again later."}):null,ve?i.jsx("div",{className:"library-toolbar-status",children:ve}):null]})}),i.jsxs("div",{className:"alias-layout",children:[i.jsx("div",{className:"alias-list",children:u.length===0&&!s?i.jsx("section",{className:"ui-panel text-center py-16",children:i.jsx("p",{className:"text-base text-[rgba(159,178,215,0.8)]",children:"No aliases yet. Add your first one."})}):i.jsxs("div",{className:"composer-alias-list",role:"list",ref:xe,children:[ue.length===0?i.jsx("div",{className:"composer-alias-empty",children:"No aliases match your filters."}):null,Ue&&Le>0?i.jsx("div",{"aria-hidden":!0,style:{height:`${Le}px`}}):null,Ge.map(b=>i.jsx(f1,{id:b.id,name:b.name,category:(b.category||"").trim(),text:b.text||"",isSelected:p===b.id,onOpen:We,visibilityStyle:v1},b.id)),Ue&&_e>0?i.jsx("div",{"aria-hidden":!0,style:{height:`${_e}px`}}):null]})}),i.jsx("aside",{className:"alias-editor-panel",children:i.jsxs("div",{className:"alias-editor-card ui-panel",children:[F,V?i.jsx("div",{className:"alias-editor-footer",children:Qe}):null]})})]})]}),i.jsx(Ut,{open:N&&!!V&&!Z,onClose:Oe,title:"Alias",variant:"fullscreen",footer:Qe,children:F}),i.jsx(Ut,{open:L,onClose:()=>{R(!1),D(""),ae("")},title:"Categories",variant:"sheet",footer:i.jsx("div",{className:"sheet-hint",children:"Categories help you organize aliases and improve the Insert alias picker."}),children:i.jsxs("div",{className:"sheet-stack",children:[i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Add category"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:P,onChange:b=>D(b.target.value),placeholder:"e.g. styles",className:"sheet-input ui-control ui-input"}),i.jsx(Q,{size:"sm",variant:"primary",onClick:ge,children:"Add"})]})]}),i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Existing"}),Me.length===0?i.jsx("div",{className:"sheet-hint",children:"No categories yet."}):i.jsx(rt,{value:"",onChange:b=>{b&&(y(b),R(!1))},size:"sm",searchThreshold:0,placeholder:"Select a category",options:Me.filter(Boolean).map(b=>({value:b,label:Tn(b)}))})]})]})}),i.jsx(Ut,{open:I,onClose:()=>X(!1),title:"Fix invalid tags",variant:"fullscreen",footer:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:()=>X(!1),children:"Close"}),i.jsx(Q,{variant:"primary",className:"w-full",onClick:()=>{const b=new Set(((Y==null?void 0:Y.invalidLower)||[]).map(A=>String(A).toLowerCase()));if(!b.size){X(!1);return}d(A=>A.map(K=>{const we=_n((K==null?void 0:K.text)||"").filter(fe=>!b.has(String(fe).toLowerCase())),oe=joinTags(we);return oe===((K==null?void 0:K.text)||"")?K:{...K,text:oe}})),$(!0),X(!1),ae("Removed invalid tags. Review and save again.")},children:"Remove invalid tags"})]}),children:i.jsxs("div",{className:"sheet-stack",children:[i.jsx("div",{className:"sheet-section",children:i.jsxs("div",{className:"sheet-hint",children:["These aliases contain tags not found in ",i.jsx("code",{className:"font-mono",children:"danbooru_tags.md"}),". Fix them before saving."]})}),(se=Y==null?void 0:Y.rows)!=null&&se.length?i.jsxs("div",{className:"sheet-section",children:[i.jsx("div",{className:"sheet-label",children:"Aliases with issues"}),i.jsx("div",{className:"composer-alias-list",role:"list",children:Y.rows.map(b=>i.jsxs("button",{type:"button",role:"listitem",className:"composer-alias-item",onClick:()=>{x(b.id),k(!0),X(!1)},children:[i.jsxs("div",{className:"composer-alias-header",children:[i.jsx("div",{className:"composer-alias-name",children:b.friendlyName}),b.category?i.jsx("span",{className:"composer-alias-category",children:Tn(b.category)}):null]}),i.jsxs("div",{className:"composer-alias-token",children:["$",b.token,"$"]}),i.jsx("div",{className:"tag-invalid-inline",children:b.invalid.map(A=>i.jsx("span",{className:"ui-chip is-invalid",children:i.jsx("code",{className:"ui-chip-code",children:A})},`${b.id}-${A}`))})]},b.id))})]}):null]})})]})}const x1={contentVisibility:"auto",containIntrinsicSize:"240px 120px"},w1=c.memo(function({tag:t,category:n,count:r,isCollected:s,onSelectTag:l,addToCollection:a,removeFromCollection:o,setStatus:u}){const d=c.useCallback(()=>{const m=String(t||"");if(l){l(m),u(`Added: ${m}`);return}s?(o(m),u(`Removed: ${m}`)):(a(m),u(`Added: ${m}`))},[a,s,l,o,u,t]);return i.jsx("div",{className:"tag-library-row",role:"listitem",style:x1,"data-virtual-row":"true",children:i.jsxs("button",{type:"button",className:`composer-alias-item tag-library-item ${!l&&s?"is-collected":""}`,onClick:d,children:[i.jsxs("div",{className:"composer-alias-header",children:[i.jsx("div",{className:"composer-alias-name tag-library-name",children:i.jsx("code",{className:"tag-library-code",children:t})}),n?i.jsx("span",{className:"composer-alias-category",children:mr(n)}):null]}),i.jsx("div",{className:"composer-alias-token",children:Number(r||0).toLocaleString()})]})})});function S1(e){var n,r;const t=String(e||"");if(!t)return!1;try{return(r=(n=navigator.clipboard)==null?void 0:n.writeText)==null||r.call(n,t),!0}catch{return!1}}function j1({open:e,onClose:t,onSelectTag:n,initialQuery:r="",title:s="Tag library",contextTitle:l="",contextToken:a="",contextText:o="",contextTagCount:u=null,inline:d=!1}){const[m,v]=c.useState(r||""),[g,y]=c.useState(""),[w,j]=c.useState("count"),[S,h]=c.useState(""),[f,p]=c.useState([]),[x,N]=c.useState([]),[k,L]=c.useState(0),[R,T]=c.useState(0),[z,I]=c.useState(!1),[X,Y]=c.useState(!1),[be,ve]=c.useState(""),[ae,de]=c.useState(""),_=c.useRef(null),C=c.useRef(null),$=c.useRef(new Map),P=c.useRef(new Map),[D,H]=c.useState([]),[le,Z]=c.useState(!1),[ee,ce]=c.useState(null),[W,O]=c.useState(null),U=c.useRef(null),ue=c.useRef(null),xe=c.useRef(null),ze=c.useRef(null),Ae=c.useRef(null),Le=x.length<k,_e=d||e,{containerRef:Ue,startIndex:Ge,endIndex:V,topSpacer:Se,bottomSpacer:Ye,virtualized:te,isNearEnd:me}=ku({itemCount:x.length,enabled:_e,estimateRowHeight:74,overscan:8,minItems:90}),ye=te?x.slice(Ge,V):x,Ne=c.useMemo(()=>D.join(", "),[D]),Pe=c.useMemo(()=>new Set(D.map(F=>F.toLowerCase())),[D]),ie=c.useMemo(()=>{const F=Number.parseInt(String(S||""),10);return Number.isFinite(F)&&F>0?F:0},[S]),Me=c.useCallback((F,se,b,A,K,re)=>[F||"",se||"",b||"",String(A||0),String(K||0),String(re||0)].join("::"),[]),Ke=c.useCallback(()=>{const F=$.current;if(F.size<=50)return;const se=Array.from(F.entries());se.sort((b,A)=>{var K,re;return(((K=b[1])==null?void 0:K.ts)||0)-(((re=A[1])==null?void 0:re.ts)||0)}),se.slice(0,Math.max(0,se.length-50)).forEach(([b])=>F.delete(b))},[]),lt=c.useCallback(F=>{const se=String(F||"").trim();se&&H(b=>new Set(b.map(K=>K.toLowerCase())).has(se.toLowerCase())?b:[...b,se])},[]),tt=c.useCallback(F=>{const se=String(F||"").trim().toLowerCase();se&&H(b=>b.filter(A=>A.toLowerCase()!==se))},[]),kt=c.useCallback(()=>{H([]),de("Cleared collected tags.")},[]),B=c.useCallback(()=>{var se,b;if(!D.length){de("No tags to copy.");return}if(S1(Ne)){de(`Copied ${D.length} tag${D.length===1?"":"s"}.`);return}const F=xe.current;if(F)try{F.value=Ne,F.removeAttribute("readonly"),F.select(),F.setSelectionRange(0,Ne.length);const A=document.execCommand&&document.execCommand("copy");if(F.setAttribute("readonly","readonly"),(b=(se=window.getSelection())==null?void 0:se.removeAllRanges)==null||b.call(se),A){de(`Copied ${D.length} tag${D.length===1?"":"s"}.`);return}}catch{}de("Copy not available on this browser.")},[D,Ne]),q=c.useCallback((F,se)=>{H(b=>{const A=[...b],[K]=A.splice(F,1);return A.splice(se,0,K),A})},[]);c.useCallback((F,se)=>{ce(se),ze.current=F.target,F.dataTransfer.effectAllowed="move",F.dataTransfer.setData("text/plain",se.toString()),requestAnimationFrame(()=>{ze.current&&ze.current.classList.add("is-dragging")})},[]),c.useCallback(()=>{ze.current&&ze.current.classList.remove("is-dragging"),ee!==null&&W!==null&&ee!==W&&q(ee,W),ce(null),O(null),ze.current=null},[ee,W,q]),c.useCallback((F,se)=>{F.preventDefault(),F.dataTransfer.dropEffect="move",O(se)},[]),c.useCallback(()=>{},[]),c.useCallback((F,se)=>{const b=F.touches[0];Ae.current={idx:se,startX:b.clientX,startY:b.clientY,moved:!1}},[]),c.useCallback(F=>{if(!Ae.current)return;const se=F.touches[0],b=Math.abs(se.clientX-Ae.current.startX),A=Math.abs(se.clientY-Ae.current.startY);if(b>10||A>10){Ae.current.moved=!0,ce(Ae.current.idx),F.preventDefault();const K=document.querySelectorAll(".tag-collection-chip"),re=se.clientX,we=se.clientY;for(let oe=0;oe<K.length;oe++){const fe=K[oe].getBoundingClientRect();if(re>=fe.left&&re<=fe.right&&we>=fe.top&&we<=fe.bottom){O(oe);break}}}},[]),c.useCallback(()=>{var F;(F=Ae.current)!=null&&F.moved&&ee!==null&&W!==null&&ee!==W&&q(ee,W),Ae.current=null,ce(null),O(null)},[ee,W,q]);const ge=c.useCallback(async({nextQuery:F,nextCategory:se,nextSort:b,nextMinCount:A}={})=>{var Xt;const K=typeof F=="string"?F:m,re=typeof se=="string"?se:g,we=typeof b=="string"?b:w,oe=typeof A=="number"?A:ie,fe=Me(K,re,we,oe,80,0),Te=Date.now(),dt=$.current.get(fe);if(dt&&Te-dt.ts<5*60*1e3){N(dt.items||[]),L(Number(dt.total||0)),T(0),ve(""),de(""),I(!1);return}const At=P.current.get(fe);if(At){try{const ht=await At;N((ht==null?void 0:ht.items)||[]),L(Number((ht==null?void 0:ht.total)||0)),T(0),ve(""),de("")}catch{}return}I(!0),ve(""),de(""),T(0),_.current&&_.current.key!==fe&&_.current.controller.abort();const Pt=new AbortController;_.current={controller:Pt,key:fe};try{const ht=Bi({q:K,category:re,sort:we,minCount:oe,limit:80,offset:0},{signal:Pt.signal});P.current.set(fe,ht);const xt=await ht;$.current.set(fe,{items:(xt==null?void 0:xt.items)||[],total:Number((xt==null?void 0:xt.total)||0),ts:Date.now()}),Ke(),N((xt==null?void 0:xt.items)||[]),L(Number((xt==null?void 0:xt.total)||0))}catch(ht){if((ht==null?void 0:ht.name)==="AbortError")return;console.error("Failed to search tags",ht),ve("Unable to load tags right now."),N([]),L(0)}finally{P.current.delete(fe),((Xt=_.current)==null?void 0:Xt.key)===fe&&(_.current=null),I(!1)}},[Me,g,ie,m,w,Ke]),je=c.useCallback(async()=>{var we;if(z||X||!Le)return;const F=R+80,se=Me(m,g,w,ie,80,F),b=Date.now(),A=$.current.get(se);if(A&&b-A.ts<5*60*1e3){N(oe=>[...oe,...A.items||[]]),L(Number(A.total||0)),T(F),Y(!1);return}const K=P.current.get(se);if(K){try{const oe=await K,fe=(oe==null?void 0:oe.items)||[];N(Te=>[...Te,...fe]),L(Number((oe==null?void 0:oe.total)||0)),T(F)}catch{}return}Y(!0),ve(""),C.current&&C.current.key!==se&&C.current.controller.abort();const re=new AbortController;C.current={controller:re,key:se};try{const oe=Bi({q:m,category:g,sort:w,minCount:ie,limit:80,offset:F},{signal:re.signal});P.current.set(se,oe);const fe=await oe,Te=(fe==null?void 0:fe.items)||[];$.current.set(se,{items:Te,total:Number((fe==null?void 0:fe.total)||0),ts:Date.now()}),Ke(),N(dt=>[...dt,...Te]),L(Number((fe==null?void 0:fe.total)||0)),T(F)}catch(oe){if((oe==null?void 0:oe.name)==="AbortError")return;console.error("Failed to load more tags",oe),ve("Unable to load more tags.")}finally{P.current.delete(se),((we=C.current)==null?void 0:we.key)===se&&(C.current=null),Y(!1)}},[Me,Le,g,z,X,ie,R,m,w,Ke]);c.useEffect(()=>{if(!_e)return;ve(""),de("");let F=!1;return(async()=>{try{const se=await fm();if(F)return;p(Array.isArray(se==null?void 0:se.categories)?se.categories:[])}catch(se){console.error("Failed to load tag categories",se),F||p([])}})(),()=>{F=!0}},[_e]),c.useEffect(()=>{_e&&(v(r||""),y(""),j("count"),h(""),N([]),L(0),T(0),I(!1),Y(!1),ve(""),de(""),H([]))},[r,_e]),c.useEffect(()=>{if(!_e)return;const F=window.setTimeout(()=>{ge()},220);return()=>window.clearTimeout(F)},[g,_e,ie,m,ge,w]),c.useEffect(()=>()=>{var F,se,b,A;_.current&&((se=(F=_.current.controller)==null?void 0:F.abort)==null||se.call(F)),C.current&&((A=(b=C.current.controller)==null?void 0:b.abort)==null||A.call(b))},[]),c.useEffect(()=>{if(!_e||te)return;const F=U.current;if(!F||typeof IntersectionObserver>"u")return;const se=new IntersectionObserver(b=>{const A=b[0];A!=null&&A.isIntersecting&&je()},{threshold:.1});return se.observe(F),()=>se.disconnect()},[_e,je]),c.useEffect(()=>{te&&(!Le||z||X||me&&je())},[te,Le,z,X,me,je]);const Re=c.useMemo(()=>d?null:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:t,children:"Done"}),i.jsx(Q,{variant:"ghost",className:"w-full",onClick:()=>ge(),disabled:z||X,children:i.jsxs("span",{className:"inline-flex items-center gap-2",children:[i.jsx(nc,{size:14}),"Refresh"]})})]}),[d,z,X,t,ge]),We=!!(n&&(l||a||o)),Oe=Number.isFinite(u)?`${u} tags`:"",Qe=i.jsxs("div",{className:`sheet-stack ${d?"ui-card":""}`,children:[We?i.jsxs("div",{className:"tag-library-context",children:[i.jsxs("div",{className:"tag-library-context-head",children:[i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"sheet-label",children:"Adding to alias"}),i.jsx("div",{className:"tag-library-context-title",children:l||"Alias"}),a?i.jsx("div",{className:"tag-library-context-token",children:a}):null]}),i.jsx(Q,{size:"xs",variant:"muted",onClick:t,children:"Back"})]}),i.jsx("div",{className:"tag-library-context-preview",children:o||""}),Oe?i.jsx("div",{className:"tag-library-context-meta",children:Oe}):null]}):null,i.jsxs("div",{className:"sheet-section",children:[d?null:i.jsx("div",{className:"sheet-label",children:"Browse"}),i.jsxs("div",{className:"composer-filters",children:[i.jsxs("div",{className:"input-with-action",children:[i.jsx("input",{ref:ue,type:"search",value:m,onChange:F=>v(F.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>v(""),disabled:!m,children:"Clear"})]}),i.jsx(rt,{value:g,onChange:y,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:[{value:"",label:"Category: All"},...f.map(F=>({value:F.key,label:`${mr(F.key)} (${Number(F.actual||F.count||0).toLocaleString()})`}))]}),i.jsxs("div",{className:"composer-sort-row",children:[i.jsx(rt,{value:w,onChange:j,wrapperClassName:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]}),i.jsxs("div",{className:"composer-min-count",children:[i.jsx("span",{className:"composer-filter-divider","aria-hidden":"true",children:"|"}),i.jsx("label",{className:"composer-min-count-label",htmlFor:"tag-library-min-count",children:"Minimum count"}),i.jsx("input",{id:"tag-library-min-count",type:"number",inputMode:"numeric",min:0,step:1,value:S,onChange:F=>{const se=F.target.value;(se===""||Number(se)>=0)&&h(se)},className:"ui-control ui-input is-compact composer-min-count-input",placeholder:"0"})]})]})]}),ae?i.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:ae}):null,be?i.jsx("div",{className:"text-xs text-[#FF8F70]",children:be}):null]}),i.jsx("div",{className:"composer-alias-list tag-library-grid",role:"list",ref:Ue,children:z?i.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):x.length===0?i.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):i.jsxs(i.Fragment,{children:[te&&Se>0?i.jsx("div",{"aria-hidden":!0,style:{height:`${Se}px`}}):null,ye.map(F=>i.jsx(w1,{tag:F.tag,category:F.category,count:F.count,isCollected:Pe.has(String(F.tag||"").toLowerCase()),onSelectTag:n,addToCollection:lt,removeFromCollection:tt,setStatus:de},`${F.tag}-${F.category}`)),te&&Ye>0?i.jsx("div",{"aria-hidden":!0,style:{height:`${Ye}px`}}):null,te?null:i.jsx("div",{ref:U,className:"composer-sentinel"}),X?i.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]});return _e?d?i.jsxs("section",{className:"tag-library-surface",children:[s?i.jsx("div",{className:"sheet-label tag-library-page-title",children:s}):null,Qe,n?null:i.jsxs("div",{className:"tag-collection-bar","aria-live":"polite",children:[i.jsxs("div",{className:"tag-collection-bar-main",children:[i.jsx("div",{className:"tag-collection-bar-title",children:"Tags"}),i.jsx("div",{className:"tag-collection-bar-count","aria-live":"polite",children:D.length===0?"No tags selected":`${D.length} selected`})]}),i.jsx(Q,{size:"icon",variant:"ghost",onClick:()=>Z(!0),"aria-label":"Manage collected tags",children:i.jsx(dw,{size:16})}),i.jsx("textarea",{ref:xe,value:Ne,onChange:F=>{const se=F.target.value.split(",").map(K=>K.trim()).filter(Boolean),b=new Set,A=[];se.forEach(K=>{const re=K.toLowerCase();b.has(re)||(b.add(re),A.push(K))}),H(A)},className:"sr-only","aria-label":"Collected tags text"})]}),n?null:i.jsx(Ut,{open:le,onClose:()=>Z(!1),title:"Collected tags",variant:"sheet",shouldCloseOnOverlayClick:!0,children:i.jsxs("div",{className:"sheet-stack",children:[i.jsxs("div",{className:"sheet-section",children:[i.jsxs("div",{className:"sheet-label",children:["Tags (",D.length,")"]}),i.jsxs("div",{className:"tag-collection-codeblock",children:[i.jsx("pre",{className:"tag-collection-pre",children:Ne||""}),i.jsx(Q,{size:"icon",variant:"ghost",className:"absolute top-2 right-2",onClick:B,disabled:D.length===0,"aria-label":"Copy collected tags",children:i.jsx(fw,{size:16})}),i.jsx("textarea",{ref:xe,value:Ne,readOnly:!0,className:"sr-only","aria-label":"Collected tags text"})]}),D.length?i.jsx("div",{className:"tag-collection-chips",children:D.map((F,se)=>i.jsxs("span",{className:"ui-chip is-accent is-clickable tag-collection-chip",onClick:()=>tt(F),role:"button",tabIndex:0,onKeyDown:b=>{b.target===b.currentTarget&&(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),tt(F))},children:[i.jsx("code",{className:"ui-chip-code",children:F}),i.jsx(Q,{size:"mini",variant:"danger","aria-label":`Remove ${F}`,onClick:b=>{b.stopPropagation(),tt(F)},children:i.jsx(hr,{size:12})})]},`${F}-${se}`))}):i.jsx("div",{className:"sheet-hint",children:"No tags collected yet."})]}),i.jsxs("div",{className:"sheet-section flex gap-2",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:()=>Z(!1),children:"Close"}),i.jsx(Q,{variant:"ghost",className:"w-full",onClick:kt,disabled:D.length===0,children:"Clear"})]})]})})]}):i.jsx(Ut,{open:e,onClose:t,title:s,variant:"fullscreen",contentClassName:"tag-library-sheet",footer:Re,shouldCloseOnOverlayClick:!1,children:Qe}):null}function k1(){const e=Ln(),[t]=om(),n=t.get("q")||"",r=c.useMemo(()=>n?`Tag Library  ${n}`:"Tag Library",[n]);return i.jsxs("div",{className:"page-shell page-stack",children:[i.jsxs("div",{className:"page-bar",children:[i.jsx("h1",{className:"page-bar-title",children:r}),i.jsxs("div",{className:"page-bar-actions",children:[i.jsx(Q,{size:"xs",onClick:()=>e("/aliases"),children:"Aliases"}),i.jsx(Q,{size:"xs",onClick:()=>e("/compose"),children:"Composer"})]})]}),i.jsx(j1,{inline:!0,initialQuery:n,title:"Browse",onSelectTag:null})]})}function $f({className:e="",style:t,label:n,status:r,applyLabel:s,onClear:l,onApply:a,disabled:o=!1}){return i.jsxs("div",{className:`composer-tag-collection-bar ${e}`.trim(),style:t,children:[i.jsxs("div",{children:[i.jsx("div",{className:"composer-tag-collection-label",children:n}),r?i.jsx("div",{className:"composer-tag-collection-status",children:r}):null]}),i.jsxs("div",{className:"composer-tag-collection-actions",children:[i.jsx(Q,{size:"xs",variant:"muted",onClick:l,disabled:o,children:"Clear"}),i.jsx(Q,{size:"xs",variant:"primary",onClick:a,disabled:o,children:s})]})]})}const N1=c.memo(function({tag:t,category:n,count:r,isCollected:s,onToggle:l,visibilityStyle:a}){const o=c.useCallback(u=>{u.stopPropagation(),l(t)},[l,t]);return i.jsxs("button",{type:"button",className:`composer-alias-item composer-tag-item ${s?"is-collected":""}`,onClick:o,style:a,"data-virtual-row":"true",children:[i.jsxs("div",{className:"composer-alias-header",children:[i.jsx("div",{className:"composer-alias-name composer-tag-name",children:i.jsx("code",{className:"composer-tag-code",children:t})}),n?i.jsx("span",{className:"composer-alias-category",children:mr(n)}):null]}),i.jsx("div",{className:"composer-alias-token composer-tag-count",children:Number(r||0).toLocaleString()})]})}),Ff={contentVisibility:"auto",containIntrinsicSize:"260px 140px"};function C1({open:e=!1,onClose:t,value:n="",onChange:r,aliasOptions:s=[],aliasCatalog:l=[],fieldLabel:a="Prompt",variant:o="sheet"}){var Ru,Iu,Au;const u=c.useRef(null),d=c.useRef(null),m=c.useRef(null),v=c.useRef(null),[g,y]=c.useState(n),[w,j]=c.useState(""),S=c.useDeferredValue(w),[h,f]=c.useState("All"),[p,x]=c.useState("All"),[N,k]=c.useState(30),[L,R]=c.useState("compose"),T=o==="page",z=T||e,[I,X]=c.useState(null),[Y,be]=c.useState(null),[ve,ae]=c.useState(null),de=c.useRef(null),_=c.useRef(null),[C,$]=c.useState(!1),[P,D]=c.useState(null),H=c.useRef(null),le=c.useRef(null),[Z,ee]=c.useState(""),[ce,W]=c.useState(""),[O,U]=c.useState("count"),[ue,xe]=c.useState(""),[ze,Ae]=c.useState([]),[Le,_e]=c.useState([]),[Ue,Ge]=c.useState(0),[V,Se]=c.useState(0),[Ye,te]=c.useState(!1),[me,ye]=c.useState(!1),[Ne,Pe]=c.useState(""),ie=c.useRef(null),Me=c.useRef(null),Ke=c.useRef(new Map),lt=c.useRef(new Map),tt=c.useMemo(()=>{const E=Number.parseInt(String(ue||""),10);return Number.isFinite(E)&&E>0?E:0},[ue]),[kt,B]=c.useState([]),[q,ge]=c.useState(""),[je,Re]=c.useState([]),[We,Oe]=c.useState(""),Qe=c.useMemo(()=>{if(!g)return{text:"",parts:[]};const E=new Map;if((l||[]).forEach(Xe=>{if(!Xe)return;const Ee=String(Xe.token||"").trim().toLowerCase(),Be=typeof Xe.text=="string"?Xe.text.trim():"";!Ee||!Be||E.set(Ee,Be)}),!E.size||!g.includes("$"))return{text:g,parts:[{text:g,isAlias:!1}]};const M=[],pe=/\$([a-z0-9_:-]+)\$/gi;let ke=0,De;for(;(De=pe.exec(g))!==null;){const Xe=De.index;Xe>ke&&M.push({text:g.slice(ke,Xe),isAlias:!1});const Ee=String(De[1]||"").toLowerCase(),Be=E.get(Ee);typeof Be=="string"?M.push({text:Be,isAlias:!0}):M.push({text:De[0],isAlias:!1}),ke=pe.lastIndex}return ke<g.length&&M.push({text:g.slice(ke),isAlias:!1}),{text:M.map(Xe=>Xe.text).join(""),parts:M}},[l,g]);c.useEffect(()=>{e&&(y(n),R("compose"),j(""),f("All"),x("All"),k(30),X(null),be(null),ae(null),$(!1),D(null),Br(""),ee(""),W(""),U("count"),xe(""),_e([]),Ge(0),Se(0),te(!1),ye(!1),Pe(""))},[e,n]),c.useEffect(()=>{if(I===null||typeof document>"u")return;const E=document.querySelector("main.app-content"),M={htmlOverscroll:document.documentElement.style.overscrollBehavior,bodyOverscroll:document.body.style.overscrollBehavior,bodyOverflow:document.body.style.overflow,scrollOverflow:E==null?void 0:E.style.overflow,scrollTouch:E==null?void 0:E.style.touchAction,scrollOverscroll:E==null?void 0:E.style.overscrollBehavior};return document.documentElement.style.overscrollBehavior="none",document.body.style.overscrollBehavior="none",document.body.style.overflow="hidden",E&&(E.style.overflow="hidden",E.style.touchAction="none",E.style.overscrollBehavior="none"),()=>{document.documentElement.style.overscrollBehavior=M.htmlOverscroll||"",document.body.style.overscrollBehavior=M.bodyOverscroll||"",document.body.style.overflow=M.bodyOverflow||"",E&&(E.style.overflow=M.scrollOverflow||"",E.style.touchAction=M.scrollTouch||"",E.style.overscrollBehavior=M.scrollOverscroll||"")}},[I]);const F=c.useMemo(()=>(Array.isArray(l)?l.filter(E=>E&&E.name):[]).map(E=>({...E,...vu(E)})),[l]),se=c.useMemo(()=>{const E=new Map;return F.forEach(M=>{M!=null&&M.token&&E.set(String(M.token).toLowerCase(),M)}),E},[F]),b=c.useMemo(()=>{const E=new Set(["All"]);return F.forEach(M=>{M.category&&E.add(M.category)}),Array.from(E).sort((M,pe)=>M.localeCompare(pe))},[F]),A=c.useMemo(()=>{const E=new Set(["All"]);return F.forEach(M=>{(!h||h==="All"||M.category===h)&&M.subcategory&&E.add(M.subcategory)}),Array.from(E).sort((M,pe)=>M.localeCompare(pe))},[F,h]),K=c.useMemo(()=>["All",...b.filter(E=>E!=="All")],[b]),re=c.useMemo(()=>["All",...A.filter(E=>E!=="All")],[A]),we=c.useMemo(()=>{const E=S.trim().toLowerCase();return F.filter(M=>{var pe,ke,De,$e;return h!=="All"&&(M.category||"")!==h||p!=="All"&&(M.subcategory||"other")!==p?!1:E?((pe=M.token)==null?void 0:pe.toLowerCase().includes(E))||((ke=M.text)==null?void 0:ke.toLowerCase().includes(E))||((De=M.name)==null?void 0:De.toLowerCase().includes(E))||(($e=M.displayName)==null?void 0:$e.toLowerCase().includes(E)):!0}).sort((M,pe)=>{const ke=(M.subcategory||"").toLowerCase(),De=(pe.subcategory||"").toLowerCase();return ke!==De?ke.localeCompare(De):M.token.localeCompare(pe.token)})},[F,h,p,S]),oe=c.useMemo(()=>we.slice(0,N),[we,N]);c.useEffect(()=>{k(30)},[h,p,w,F]),c.useEffect(()=>{x("All")},[h]),c.useEffect(()=>{const E=m.current;if(!E)return;const M=new IntersectionObserver(pe=>{pe[0].isIntersecting&&N<we.length&&k(De=>Math.min(De+20,we.length))},{threshold:.1});return M.observe(E),()=>M.disconnect()},[N,we.length]);const fe=c.useMemo(()=>typeof g!="string"?[]:Bw(g),[g]);c.useEffect(()=>{if(!e||L!=="tags"||ze.length>0)return;let E=!1;return(async()=>{try{const M=await fm();if(E)return;Ae(Array.isArray(M==null?void 0:M.categories)?M.categories:[])}catch(M){console.error("Failed to load tag categories",M),E||Ae([])}})(),()=>{E=!0}},[e,L,ze.length]);const Te=c.useCallback((E,M,pe,ke,De,$e)=>[E||"",M||"",pe||"",String(ke||0),String(De||0),String($e||0)].join("::"),[]),dt=c.useCallback(()=>{const E=Ke.current;if(E.size<=50)return;const M=Array.from(E.entries());M.sort((pe,ke)=>{var De,$e;return(((De=pe[1])==null?void 0:De.ts)||0)-((($e=ke[1])==null?void 0:$e.ts)||0)}),M.slice(0,Math.max(0,M.length-50)).forEach(([pe])=>E.delete(pe))},[]),At=c.useCallback(async({nextQuery:E,nextCategory:M,nextSort:pe,nextMinCount:ke}={})=>{var $u;const De=typeof E=="string"?E:Z,$e=typeof M=="string"?M:ce,Xe=typeof pe=="string"?pe:O,Ee=typeof ke=="number"?ke:tt,Be=Te(De,$e,Xe,Ee,80,0),Gn=Date.now(),Kn=Ke.current.get(Be);if(Kn&&Gn-Kn.ts<5*60*1e3){_e(Kn.items||[]),Ge(Number(Kn.total||0)),Se(0),Pe(""),te(!1);return}const Tu=lt.current.get(Be);if(Tu){try{const Mt=await Tu;_e((Mt==null?void 0:Mt.items)||[]),Ge(Number((Mt==null?void 0:Mt.total)||0)),Se(0),Pe("")}catch{}return}te(!0),Pe(""),Se(0),ie.current&&ie.current.key!==Be&&ie.current.controller.abort();const Mu=new AbortController;ie.current={controller:Mu,key:Be};try{const Mt=Bi({q:De,category:$e,sort:Xe,minCount:Ee,limit:80,offset:0},{signal:Mu.signal});lt.current.set(Be,Mt);const Jt=await Mt;Ke.current.set(Be,{items:(Jt==null?void 0:Jt.items)||[],total:Number((Jt==null?void 0:Jt.total)||0),ts:Date.now()}),dt(),_e((Jt==null?void 0:Jt.items)||[]),Ge(Number((Jt==null?void 0:Jt.total)||0))}catch(Mt){if((Mt==null?void 0:Mt.name)==="AbortError")return;console.error("Failed to search tags",Mt),Pe("Unable to load tags right now."),_e([]),Ge(0)}finally{lt.current.delete(Be),(($u=ie.current)==null?void 0:$u.key)===Be&&(ie.current=null),te(!1)}},[Te,ce,tt,Z,O,dt]),Pt=c.useCallback(async()=>{var Xe;if(Ye||me||Le.length>=Ue)return;const E=V+80,M=Te(Z,ce,O,tt,80,E),pe=Date.now(),ke=Ke.current.get(M);if(ke&&pe-ke.ts<5*60*1e3){_e(Ee=>[...Ee,...ke.items||[]]),Ge(Number(ke.total||0)),Se(E),ye(!1);return}const De=lt.current.get(M);if(De){try{const Ee=await De,Be=(Ee==null?void 0:Ee.items)||[];_e(Gn=>[...Gn,...Be]),Ge(Number((Ee==null?void 0:Ee.total)||0)),Se(E)}catch{}return}ye(!0),Pe(""),Me.current&&Me.current.key!==M&&Me.current.controller.abort();const $e=new AbortController;Me.current={controller:$e,key:M};try{const Ee=Bi({q:Z,category:ce,sort:O,minCount:tt,limit:80,offset:E},{signal:$e.signal});lt.current.set(M,Ee);const Be=await Ee,Gn=(Be==null?void 0:Be.items)||[];Ke.current.set(M,{items:Gn,total:Number((Be==null?void 0:Be.total)||0),ts:Date.now()}),dt(),_e(Kn=>[...Kn,...Gn]),Ge(Number((Be==null?void 0:Be.total)||0)),Se(E)}catch(Ee){if((Ee==null?void 0:Ee.name)==="AbortError")return;console.error("Failed to load more tags",Ee),Pe("Unable to load more tags.")}finally{lt.current.delete(M),((Xe=Me.current)==null?void 0:Xe.key)===M&&(Me.current=null),ye(!1)}},[Te,ce,Ye,me,tt,V,Z,O,Le.length,Ue,dt]);c.useEffect(()=>{if(!e||L!=="tags")return;const E=window.setTimeout(()=>{At()},220);return()=>window.clearTimeout(E)},[e,L,Z,ce,O,tt,At]),c.useEffect(()=>()=>{var E,M,pe,ke;ie.current&&((M=(E=ie.current.controller)==null?void 0:E.abort)==null||M.call(E)),Me.current&&((ke=(pe=Me.current.controller)==null?void 0:pe.abort)==null||ke.call(pe))},[]);const{containerRef:Xt,startIndex:ht,endIndex:xt,topSpacer:Ll,bottomSpacer:Pl,virtualized:an,isNearEnd:Or}=ku({itemCount:Le.length,enabled:e&&L==="tags",estimateRowHeight:70,overscan:8,minItems:90}),xa=an?Le.slice(ht,xt):Le;c.useEffect(()=>{if(!e||L!=="tags"||an)return;const E=le.current;if(!E||typeof IntersectionObserver>"u")return;const M=new IntersectionObserver(pe=>{const ke=pe[0];ke!=null&&ke.isIntersecting&&Pt()},{threshold:.1});return M.observe(E),()=>M.disconnect()},[e,L,an,Pt]),c.useEffect(()=>{an&&(Ye||me||Le.length>=Ue||Or&&Pt())},[an,Ye,me,Le.length,Ue,Or,Pt]);const Vt=c.useCallback(E=>{y(M=>{const ke=typeof E=="function"?E(typeof M=="string"?M:""):String(E||"");return o==="page"&&(r==null||r(ke)),ke})},[r,o]),Hn=c.useCallback(E=>{const M=String(E||"").trim();if(M&&(Vt(pe=>{const ke=pe.length,De=pe.length,$e=pe.slice(0,ke),Xe=pe.slice(De),Ee=$e.match(/[^\s]$/),Be=Xe.match(/^[^\s]/),Gn=Ee&&Ee[0]!==","?", ":"",Kn=Be&&Be[0]!==","?", ":"";return $e+Gn+M+Kn+Xe}),u.current))try{u.current.blur()}catch{}},[Vt]),[Dr,Br]=c.useState(""),G=c.useCallback(()=>{const E=String(Dr||"").trim();if(!E)return;const pe=E.split(",").map(ke=>ke.trim()).filter(Boolean).join(", ");pe&&(Hn(pe),Br(""),R("compose"))},[Dr,Hn]),ne=c.useCallback(()=>{B([]),ge("Cleared collected tags.")},[]),Ce=c.useCallback(()=>{if(!kt.length){ge("No tags to apply.");return}Hn(kt.join(", ")),ge(`Applied ${kt.length} tag${kt.length===1?"":"s"}.`),B([]),R("compose")},[kt,Hn]),Ie=c.useCallback(E=>{const M=String(E||"").trim();M&&B(pe=>{const ke=M.toLowerCase();return pe.some($e=>$e.toLowerCase()===ke)?(ge(`Removed: ${M}`),pe.filter($e=>$e.toLowerCase()!==ke)):(ge(`Selected: ${M}`),[...pe,M])})},[]),He=c.useCallback(E=>{const M=String(E||"").trim();M&&Re(pe=>{const ke=M.toLowerCase();return pe.some($e=>$e.toLowerCase()===ke)?(Oe(`Removed: ${M}`),pe.filter($e=>$e.toLowerCase()!==ke)):(Oe(`Selected: ${M}`),[...pe,M])})},[]),Nt=c.useCallback(()=>{Re([]),Oe("Cleared selected aliases.")},[]),zl=c.useCallback(()=>{if(!je.length){Oe("No aliases to apply.");return}const E=je.map(M=>`$${M}$`).join(", ");Hn(E),Oe(`Applied ${je.length} alias${je.length===1?"":"es"}.`),Re([]),R("compose")},[je,Hn]),Tt=L==="tags"?{kind:"tag",count:kt.length,status:q,onClear:ne,onApply:Ce}:L==="aliases"?{kind:"alias",count:je.length,status:We,onClear:Nt,onApply:zl}:null,Ur=(Tt==null?void 0:Tt.count)||0,qm=Tt?`${Ur} ${Tt.kind==="alias"?Ur===1?"alias":"aliases":Ur===1?Tt.kind:`${Tt.kind}s`} selected`:"",Xm=!T&&Ur>0,Cu=T&&Ur>0,Jm=Cu?{"--composer-selection-offset":"var(--bottom-nav-height, 64px)"}:void 0,_l=Tt?{label:qm,status:Tt.status,onClear:Tt.onClear,onApply:Tt.onApply,applyLabel:"Insert",disabled:!Ur}:null,Zm=Xm&&_l?i.jsx($f,{..._l,className:"is-footer"}):null,eg=Cu&&_l?i.jsx($f,{..._l,className:"is-floating",style:Jm}):null,Eu=E=>{Vt(M=>Uw(M||"",E))},bu=c.useCallback((E,M)=>{if(!(fe!=null&&fe.length))return;const pe=E+M;pe<0||pe>=fe.length||(Vt(ke=>hf(ke||"",fe,E,pe)),ae(pe))},[fe,Vt]),Lu=E=>{if(!E)return;let M=E.text;if(E.type==="alias"){const ke=se.get(E.text.toLowerCase());M=(ke==null?void 0:ke.displayName)||E.text}const pe=ff(g||"",E);D({element:E,displayName:M,weight:(pe==null?void 0:pe.weight)??1}),$(!0)},Rl=c.useCallback((E,M)=>{E===M||E===null||M===null||fe!=null&&fe.length&&Vt(pe=>hf(pe||"",fe,E,M))},[fe,Vt]),tg=c.useCallback((E,M)=>{X(M),de.current=E.target,E.dataTransfer.effectAllowed="move",E.dataTransfer.setData("text/plain",M.toString()),requestAnimationFrame(()=>{de.current&&de.current.classList.add("is-dragging")})},[]),ng=c.useCallback(()=>{de.current&&de.current.classList.remove("is-dragging"),I!==null&&Y!==null&&I!==Y&&Rl(I,Y),X(null),be(null),de.current=null},[I,Y,Rl]),rg=c.useCallback((E,M)=>{E.preventDefault(),E.dataTransfer.dropEffect="move",M!==Y&&be(M)},[Y]),sg=c.useCallback(()=>{},[]),lg=c.useCallback((E,M)=>{var $e,Xe;if(!((Xe=($e=E.target)==null?void 0:$e.closest)==null?void 0:Xe.call($e,".composer-token-drag-handle")))return;const ke=E.touches[0],De=window.setTimeout(()=>{_.current&&(_.current.active=!0,X(M),be(M))},240);_.current={idx:M,startX:ke.clientX,startY:ke.clientY,active:!1,timer:De}},[]),ig=c.useCallback(E=>{if(!_.current)return;const M=E.touches[0],pe=Math.abs(M.clientX-_.current.startX),ke=Math.abs(M.clientY-_.current.startY);if(!_.current.active){(pe>8||ke>8)&&(window.clearTimeout(_.current.timer),_.current=null);return}E.preventDefault();const De=document.querySelectorAll(".composer-token-draggable"),$e=M.clientX,Xe=M.clientY;for(let Ee=0;Ee<De.length;Ee++){const Be=De[Ee].getBoundingClientRect();if($e>=Be.left&&$e<=Be.right&&Xe>=Be.top&&Xe<=Be.bottom){be(Ee);break}}},[]),ag=c.useCallback(()=>{var E,M;(E=_.current)!=null&&E.timer&&window.clearTimeout(_.current.timer),(M=_.current)!=null&&M.active&&I!==null&&Y!==null&&I!==Y&&Rl(I,Y),_.current=null,X(null),be(null)},[I,Y,Rl]),og=c.useCallback(()=>{var E;(E=_.current)!=null&&E.timer&&window.clearTimeout(_.current.timer),_.current=null,X(null),be(null)},[]),cg=()=>{r==null||r(g),t==null||t()},Pu=()=>{t==null||t()};if(!z)return null;const zu=i.jsxs("div",{className:`composer-shell ${T?"ui-card":""}`,children:[i.jsx(Pr,{ariaLabel:"Composer tabs",value:L,onChange:R,items:[{key:"compose",label:"Compose",icon:i.jsx(hu,{size:14})},{key:"aliases",label:"Aliases",icon:i.jsx(El,{size:14})},{key:"tags",label:"Tags",icon:i.jsx(pr,{size:14})}]}),i.jsxs("div",{className:`composer-panel composer-panel-compose ${L==="compose"?"is-visible":""}`,children:[i.jsx("div",{className:"composer-editor",children:i.jsxs("div",{className:"composer-input-row",children:[i.jsx("input",{ref:u,type:"text",value:Dr,onChange:E=>Br(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(E.preventDefault(),G())},className:"composer-input ui-control ui-input is-compact",placeholder:"Add prompt text","aria-label":"Add prompt text"}),i.jsx(Q,{size:"icon",variant:"ghost",onClick:G,disabled:!Dr.trim(),"aria-label":"Add prompt text",children:"+"})]})}),i.jsxs("div",{className:"composer-tokens",children:[i.jsxs("div",{className:"composer-tokens-header",children:[i.jsxs("span",{className:"composer-tokens-label",children:["Elements",i.jsx("span",{className:"composer-tokens-count",children:fe.length})]}),i.jsx("span",{className:"composer-tokens-hint",children:"Drag to reorder  Tap to adjust"})]}),fe.length?i.jsx("div",{ref:v,className:`composer-tokens-list ${I!==null?"is-dragging":""}`,style:{"--composer-elements":fe.length},children:fe.map((E,M)=>{let pe=E.text;if(E.type==="alias"){const Ee=se.get(E.text.toLowerCase());pe=(Ee==null?void 0:Ee.displayName)||E.text}const ke=I===M,De=Y===M&&I!==null&&I!==M,$e=ff(g||"",E),Xe=($e==null?void 0:$e.weight)??1;return i.jsxs("span",{className:`composer-token composer-token-draggable ${E.type==="alias"?"is-alias":"is-tag"} ${ke?"is-dragging":""} ${De?"is-drop-target":""} ${ve===M?"is-selected":""}`,title:E.type==="alias"?`Alias: $${E.text}$`:`Tag: ${E.text}`,role:"button",tabIndex:0,draggable:!0,onDragStart:Ee=>tg(Ee,M),onDragEnd:ng,onDragOver:Ee=>rg(Ee,M),onDragLeave:sg,onTouchStart:Ee=>lg(Ee,M),onTouchMove:ig,onTouchEnd:ag,onTouchCancel:og,onClick:()=>{I===null&&(ae(M),Lu(E))},onKeyDown:Ee=>{if(Ee.target===Ee.currentTarget&&(Ee.key==="Enter"||Ee.key===" ")){if(Ee.preventDefault(),I!==null)return;ae(M),Lu(E)}},children:[i.jsx("span",{className:"composer-token-order",children:M+1}),i.jsx("span",{className:"composer-token-drag-handle","aria-hidden":"true",children:i.jsx(rc,{size:10})}),i.jsx("span",{className:"composer-token-name",children:pe}),E.type==="alias"&&i.jsx("span",{className:"composer-token-type",children:"$"}),Math.abs(Xe-1)>1e-6&&i.jsxs("span",{className:"composer-token-weight",children:[An(Xe),""]}),i.jsxs("div",{className:"composer-token-shift",role:"group","aria-label":"Reorder token",children:[i.jsx(Q,{size:"mini",variant:"ghost",onClick:Ee=>{Ee.stopPropagation(),bu(M,-1)},"aria-label":"Move up",disabled:M===0,children:""}),i.jsx(Q,{size:"mini",variant:"ghost",onClick:Ee=>{Ee.stopPropagation(),bu(M,1)},"aria-label":"Move down",disabled:M===fe.length-1,children:""})]}),i.jsx(Q,{size:"mini",variant:"danger",onClick:Ee=>{Ee.stopPropagation(),Eu(E)},"aria-label":`Remove ${E.text}`,children:i.jsx(hr,{size:9})})]},`${E.type}-${E.text}-${E.start}`)})}):i.jsx("div",{className:"composer-empty",children:"No elements yet."})]}),i.jsxs("div",{className:"composer-expanded",children:[i.jsxs("div",{className:"composer-expanded-header",children:[i.jsx("span",{className:"composer-expanded-label",children:"Expanded prompt"}),i.jsx("span",{className:"composer-expanded-meta",children:Qe.text?`${Qe.text.length} chars`:"Empty"})]}),i.jsx("div",{className:"composer-expanded-box","aria-label":"Expanded prompt",children:Qe.text?Qe.parts.map((E,M)=>E.isAlias?i.jsx("span",{className:"composer-expanded-alias",children:E.text},`alias-${M}`):i.jsx("span",{children:E.text},`text-${M}`)):"No prompt yet."})]})]}),i.jsxs("div",{className:`composer-panel composer-panel-aliases ${L==="aliases"?"is-visible":""}`,children:[i.jsxs("div",{className:"composer-filters",children:[i.jsxs("div",{className:"input-with-action",children:[i.jsx("input",{ref:d,type:"text",value:w,onChange:E=>j(E.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>j(""),disabled:!w,children:"Clear"})]}),i.jsx(rt,{value:h,onChange:f,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:K.map(E=>({value:E,label:E==="All"?"Category: All":Tn(E)}))}),re.length>2&&i.jsx(rt,{value:p,onChange:x,wrapperClassName:"composer-subcategory-select",size:"sm",searchThreshold:0,options:re.map(E=>({value:E,label:E==="All"?"All subcategories":mr(E)}))})]}),i.jsx("div",{className:"composer-alias-list",children:we.length===0?i.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):i.jsxs(i.Fragment,{children:[oe.map(E=>i.jsxs("button",{type:"button",onClick:()=>He(E.token),className:`composer-alias-item ${je.some(M=>M.toLowerCase()===E.token.toLowerCase())?"is-collected":""}`,style:Ff,children:[i.jsxs("div",{className:"composer-alias-header",children:[i.jsx("div",{className:"composer-alias-name",children:E.displayName||E.token}),E.category?i.jsx("span",{className:"composer-alias-category",children:Tn(E.category)}):null]}),i.jsxs("div",{className:"composer-alias-token",children:["$",E.token,"$"]}),i.jsx("div",{className:"composer-alias-text",children:E.text})]},E.key)),N<we.length&&i.jsx("div",{ref:m,className:"composer-sentinel"})]})})]}),i.jsxs("div",{className:`composer-panel composer-panel-tags ${L==="tags"?"is-visible":""}`,onClick:E=>E.stopPropagation(),children:[i.jsxs("div",{className:"composer-filters",children:[i.jsxs("div",{className:"input-with-action",children:[i.jsx("input",{ref:H,type:"search",value:Z,onChange:E=>ee(E.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),i.jsx(Q,{size:"xs",variant:"ghost",onClick:()=>ee(""),disabled:!Z,children:"Clear"})]}),i.jsx(rt,{value:ce,onChange:W,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:[{value:"",label:"Category: All"},...ze.map(E=>({value:E.key,label:`${mr(E.key)} (${Number(E.actual||E.count||0).toLocaleString()})`}))]}),i.jsxs("div",{className:"composer-sort-row",children:[i.jsx(rt,{value:O,onChange:U,wrapperClassName:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]}),i.jsxs("div",{className:"composer-min-count",children:[i.jsx("span",{className:"composer-filter-divider","aria-hidden":"true",children:"|"}),i.jsx("label",{className:"composer-min-count-label",htmlFor:"composer-min-count",children:"Minimum count"}),i.jsx("input",{id:"composer-min-count",type:"number",inputMode:"numeric",min:0,step:1,value:ue,onChange:E=>{const M=E.target.value;(M===""||Number(M)>=0)&&xe(M)},className:"ui-control ui-input is-compact composer-min-count-input",placeholder:"0"})]})]})]}),Ne?i.jsx("div",{className:"composer-tags-error",children:Ne}):null,i.jsx("div",{className:"composer-alias-list composer-tags-grid",role:"list",ref:Xt,children:Ye?i.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):Le.length===0?i.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):i.jsxs(i.Fragment,{children:[an&&Ll>0?i.jsx("div",{"aria-hidden":!0,style:{height:`${Ll}px`}}):null,xa.map(E=>i.jsx(N1,{tag:E.tag,category:E.category,count:E.count,isCollected:kt.some(M=>M.toLowerCase()===String(E.tag||"").toLowerCase()),onToggle:Ie,visibilityStyle:Ff},`${E.tag}-${E.category}`)),an&&Pl>0?i.jsx("div",{"aria-hidden":!0,style:{height:`${Pl}px`}}):null,Le.length<Ue&&!an?i.jsx("div",{ref:le,className:"composer-sentinel"}):null,me?i.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]})]}),_u=i.jsx(oc,{open:C,onClose:()=>$(!1),title:((Ru=P==null?void 0:P.element)==null?void 0:Ru.type)==="alias"?"Alias strength":"Tag strength",tokenLabel:P?((Iu=P.element)==null?void 0:Iu.type)==="alias"?`${P.displayName}  $${(Au=P.element)==null?void 0:Au.text}$`:P.displayName:"",weight:(P==null?void 0:P.weight)??1,onApply:E=>{P!=null&&P.element&&Vt(M=>pf(M||"",P.element,E))},onRemoveWeight:()=>{P!=null&&P.element&&Vt(E=>pf(E||"",P.element,null))},onDeleteToken:()=>{P!=null&&P.element&&Eu(P.element)}}),ug=i.jsx("div",{className:"page-bar composer-bar",children:i.jsx("h1",{className:"page-bar-title",children:a||"Prompt"})});return T?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"page-shell page-stack",children:[ug,zu]}),eg,_u]}):i.jsxs(i.Fragment,{children:[i.jsx(Ut,{open:e,onClose:Pu,title:"Composer",variant:"fullscreen",shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,footer:i.jsxs("div",{className:"composer-footer-stack",children:[Zm,i.jsxs("div",{className:"flex gap-2",children:[i.jsx(Q,{variant:"muted",className:"w-full",onClick:Pu,children:"Cancel"}),i.jsx(Q,{variant:"primary",className:"w-full",onClick:cg,children:"Apply"})]})]}),children:zu}),_u]})}function E1(){const e=Ln(),[t]=om(),{formData:n,handleFormChange:r,aliasOptions:s,aliasCatalog:l,promptFieldName:a,handleGenerate:o,workflowData:u,selectedWorkflow:d,isLoading:m}=Vm(),g=t.get("field")||a||"prompt",y=(n==null?void 0:n[g])||"";return c.useEffect(()=>{if(!(typeof document>"u"))return document.body.classList.add("no-pull-refresh"),document.documentElement.classList.add("no-pull-refresh"),()=>{document.body.classList.remove("no-pull-refresh"),document.documentElement.classList.remove("no-pull-refresh")}},[]),c.useEffect(()=>{const w=()=>{!u||!d||m||o()};return window.addEventListener("cozygen:request-render",w),()=>window.removeEventListener("cozygen:request-render",w)},[o,m,d,u]),i.jsx(C1,{open:!0,onClose:()=>e("/controls"),value:y,onChange:w=>r(g,w),aliasOptions:s,aliasCatalog:l,fieldLabel:g,variant:"page"})}function b1(){var h,f;const{authed:e,ready:t,login:n}=pa(),r=Ln(),l=((f=(h=qt().state)==null?void 0:h.from)==null?void 0:f.pathname)||"/studio",[a,o]=c.useState(""),[u,d]=c.useState(""),[m,v]=c.useState(""),[g,y]=c.useState(!1),[w,j]=c.useState(!1);c.useEffect(()=>{try{localStorage.getItem("cozygen_idle_logout")&&(j(!0),localStorage.removeItem("cozygen_idle_logout"))}catch{}},[]),c.useEffect(()=>{t&&e&&r(l,{replace:!0})},[t,e,l,r]);const S=async p=>{p.preventDefault(),v(""),y(!0);try{await n(a,u),r(l,{replace:!0})}catch(x){x!=null&&x.unauthorized?v("Invalid username or password."):v("Unable to sign in. Please try again.")}finally{y(!1)}};return i.jsx("div",{className:"login-shell",children:i.jsxs("div",{className:"ui-card w-full max-w-[420px] p-6 sm:p-7",children:[i.jsxs("div",{className:"login-brand",children:[i.jsx(xm,{size:34}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("div",{className:"login-title",children:"Sign in"}),i.jsx("div",{className:"login-subtitle",children:"Continue to CozyGen Studio"})]})]}),i.jsxs("form",{className:"login-form",onSubmit:S,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"login-username",className:"login-label",children:"Username"}),i.jsx("input",{id:"login-username",type:"text",className:"ui-control ui-input",value:a,onChange:p=>o(p.target.value),autoComplete:"username",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"login-password",className:"login-label",children:"Password"}),i.jsx("input",{id:"login-password",type:"password",className:"ui-control ui-input",value:u,onChange:p=>d(p.target.value),autoComplete:"current-password",required:!0})]}),m?i.jsx("div",{className:"ui-alert",children:m}):w?i.jsx("div",{className:"ui-alert is-warn",children:"You were signed out due to inactivity. Please sign in again."}):null,i.jsx(Q,{type:"submit",disabled:g,variant:"primary",className:"w-full",children:g?"Signing in":"Sign in"})]}),i.jsxs("p",{className:"login-footnote",children:["Access is protected by CozyGen auth. Set ",i.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /"," ",i.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server to enable."]})]})})}function L1({containerRef:e}){const{pathname:t,hash:n}=qt();return c.useEffect(()=>{if(n)return;const r=e==null?void 0:e.current;if(r&&typeof r.scrollTo=="function"){r.scrollTo({top:0,left:0,behavior:"auto"});return}typeof window<"u"&&window.scrollTo(0,0)},[t,n,e]),null}function P1({children:e}){const{authed:t,ready:n}=pa(),r=qt();return n?t?e:i.jsx(Yo,{to:"/login",state:{from:r},replace:!0}):i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-200",children:i.jsxs("div",{className:"page-loading",children:[i.jsx("span",{className:"loading-spinner lg","aria-hidden":"true"}),i.jsx("span",{className:"sr-only",children:"Checking session"})]})})}function z1(){const{pathname:e}=qt(),t=Ln(),{defaultCreds:n,authed:r}=pa(),s=e==="/login",l=c.useRef(null),a=!s,o=a;return c.useEffect(()=>{if(!r)return;const u=d=>{var g;const m=String(((g=d==null?void 0:d.detail)==null?void 0:g.fieldName)||"").trim(),v=m?`?field=${encodeURIComponent(m)}`:"";t(`/compose${v}`)};return window.addEventListener("cozygen:open-composer",u),()=>window.removeEventListener("cozygen:open-composer",u)},[r,t]),i.jsxs("div",{className:"app-shell",children:[!s&&i.jsx(hw,{isMobileAlignedNav:a}),!s&&r&&n&&i.jsxs("div",{className:"flex-shrink-0 bg-amber-500/10 text-amber-200 border-b border-amber-400/50 px-4 py-2 text-sm text-center",children:["Default CozyGen credentials are still in use. Change ",i.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /",i.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server."]}),i.jsx(L1,{containerRef:l}),i.jsxs("div",{className:"app-body",children:[i.jsx("main",{ref:l,className:s?"app-content is-login":"app-content",children:i.jsxs(zx,{children:[i.jsx(cn,{path:"/login",element:i.jsx(b1,{})}),i.jsxs(cn,{element:i.jsx(P1,{children:i.jsx($0,{children:i.jsx(Lx,{})})}),children:[i.jsx(cn,{path:"/",element:i.jsx(Yo,{to:"/studio",replace:!0})}),i.jsx(cn,{path:"/studio",element:i.jsx(O0,{})}),i.jsx(cn,{path:"/controls",element:i.jsx(F0,{})}),i.jsx(cn,{path:"/compose",element:i.jsx(E1,{})}),i.jsx(cn,{path:"/gallery",element:i.jsx(c1,{})}),i.jsx(cn,{path:"/aliases",element:i.jsx(y1,{})}),i.jsx(cn,{path:"/tags",element:i.jsx(k1,{})})]}),i.jsx(cn,{path:"*",element:i.jsx(Yo,{to:"/studio",replace:!0})})]})}),o?i.jsx(vw,{}):null]})]})}function _1(){return i.jsx(Ox,{children:i.jsx(aw,{children:i.jsx(z1,{})})})}Za.createRoot(document.getElementById("root")).render(i.jsx(Zt.StrictMode,{children:i.jsx(_1,{})}));
