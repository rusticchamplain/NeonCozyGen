function Ty(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function $y(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Yp={exports:{}},qa={},Qp={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mi=Symbol.for("react.element"),My=Symbol.for("react.portal"),Fy=Symbol.for("react.fragment"),Oy=Symbol.for("react.strict_mode"),Dy=Symbol.for("react.profiler"),By=Symbol.for("react.provider"),Uy=Symbol.for("react.context"),Vy=Symbol.for("react.forward_ref"),Wy=Symbol.for("react.suspense"),Hy=Symbol.for("react.memo"),Gy=Symbol.for("react.lazy"),Qd=Symbol.iterator;function Ky(e){return e===null||typeof e!="object"?null:(e=Qd&&e[Qd]||e["@@iterator"],typeof e=="function"?e:null)}var qp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xp=Object.assign,Jp={};function el(e,t,n){this.props=e,this.context=t,this.refs=Jp,this.updater=n||qp}el.prototype.isReactComponent={};el.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};el.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Zp(){}Zp.prototype=el.prototype;function wu(e,t,n){this.props=e,this.context=t,this.refs=Jp,this.updater=n||qp}var Su=wu.prototype=new Zp;Su.constructor=wu;Xp(Su,el.prototype);Su.isPureReactComponent=!0;var qd=Array.isArray,eh=Object.prototype.hasOwnProperty,ju={current:null},th={key:!0,ref:!0,__self:!0,__source:!0};function nh(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)eh.call(t,r)&&!th.hasOwnProperty(r)&&(s[r]=t[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:mi,type:e,key:i,ref:a,props:s,_owner:ju.current}}function Yy(e,t){return{$$typeof:mi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ku(e){return typeof e=="object"&&e!==null&&e.$$typeof===mi}function Qy(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Xd=/\/+/g;function _o(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Qy(""+e.key):t.toString(36)}function Zi(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case mi:case My:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+_o(a,0):r,qd(s)?(n="",e!=null&&(n=e.replace(Xd,"$&/")+"/"),Zi(s,t,n,"",function(d){return d})):s!=null&&(ku(s)&&(s=Yy(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Xd,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",qd(e))for(var c=0;c<e.length;c++){i=e[c];var u=r+_o(i,c);a+=Zi(i,t,n,u,s)}else if(u=Ky(e),typeof u=="function")for(e=u.call(e),c=0;!(i=e.next()).done;)i=i.value,u=r+_o(i,c++),a+=Zi(i,t,n,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function _i(e,t,n){if(e==null)return e;var r=[],s=0;return Zi(e,r,"","",function(i){return t.call(n,i,s++)}),r}function qy(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Gt={current:null},ea={transition:null},Xy={ReactCurrentDispatcher:Gt,ReactCurrentBatchConfig:ea,ReactCurrentOwner:ju};function rh(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:_i,forEach:function(e,t,n){_i(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return _i(e,function(){t++}),t},toArray:function(e){return _i(e,function(t){return t})||[]},only:function(e){if(!ku(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};De.Component=el;De.Fragment=Fy;De.Profiler=Dy;De.PureComponent=wu;De.StrictMode=Oy;De.Suspense=Wy;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xy;De.act=rh;De.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Xp({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=ju.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)eh.call(t,u)&&!th.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:mi,type:e.type,key:s,ref:i,props:r,_owner:a}};De.createContext=function(e){return e={$$typeof:Uy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:By,_context:e},e.Consumer=e};De.createElement=nh;De.createFactory=function(e){var t=nh.bind(null,e);return t.type=e,t};De.createRef=function(){return{current:null}};De.forwardRef=function(e){return{$$typeof:Vy,render:e}};De.isValidElement=ku;De.lazy=function(e){return{$$typeof:Gy,_payload:{_status:-1,_result:e},_init:qy}};De.memo=function(e,t){return{$$typeof:Hy,type:e,compare:t===void 0?null:t}};De.startTransition=function(e){var t=ea.transition;ea.transition={};try{e()}finally{ea.transition=t}};De.unstable_act=rh;De.useCallback=function(e,t){return Gt.current.useCallback(e,t)};De.useContext=function(e){return Gt.current.useContext(e)};De.useDebugValue=function(){};De.useDeferredValue=function(e){return Gt.current.useDeferredValue(e)};De.useEffect=function(e,t){return Gt.current.useEffect(e,t)};De.useId=function(){return Gt.current.useId()};De.useImperativeHandle=function(e,t,n){return Gt.current.useImperativeHandle(e,t,n)};De.useInsertionEffect=function(e,t){return Gt.current.useInsertionEffect(e,t)};De.useLayoutEffect=function(e,t){return Gt.current.useLayoutEffect(e,t)};De.useMemo=function(e,t){return Gt.current.useMemo(e,t)};De.useReducer=function(e,t,n){return Gt.current.useReducer(e,t,n)};De.useRef=function(e){return Gt.current.useRef(e)};De.useState=function(e){return Gt.current.useState(e)};De.useSyncExternalStore=function(e,t,n){return Gt.current.useSyncExternalStore(e,t,n)};De.useTransition=function(){return Gt.current.useTransition()};De.version="18.3.1";Qp.exports=De;var o=Qp.exports;const fn=$y(o),Jy=Ty({__proto__:null,default:fn},[o]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zy=o,ev=Symbol.for("react.element"),tv=Symbol.for("react.fragment"),nv=Object.prototype.hasOwnProperty,rv=Zy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sv={key:!0,ref:!0,__self:!0,__source:!0};function sh(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)nv.call(t,r)&&!sv.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:ev,type:e,key:i,ref:a,props:s,_owner:rv.current}}qa.Fragment=tv;qa.jsx=sh;qa.jsxs=sh;Yp.exports=qa;var l=Yp.exports,uc={},lh={exports:{}},an={},ih={exports:{}},ah={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(A,L){var D=A.length;A.push(L);e:for(;0<D;){var _=D-1>>>1,H=A[_];if(0<s(H,L))A[_]=L,A[D]=H,D=_;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var L=A[0],D=A.pop();if(D!==L){A[0]=D;e:for(var _=0,H=A.length,Q=H>>>1;_<Q;){var oe=2*(_+1)-1,ne=A[oe],re=oe+1,ae=A[re];if(0>s(ne,D))re<H&&0>s(ae,ne)?(A[_]=ae,A[re]=D,_=re):(A[_]=ne,A[oe]=D,_=oe);else if(re<H&&0>s(ae,D))A[_]=ae,A[re]=D,_=re;else break e}}return L}function s(A,L){var D=A.sortIndex-L.sortIndex;return D!==0?D:A.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,c=a.now();e.unstable_now=function(){return a.now()-c}}var u=[],d=[],m=1,y=null,g=3,v=!1,w=!1,k=!1,j=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(A){for(var L=n(d);L!==null;){if(L.callback===null)r(d);else if(L.startTime<=A)r(d),L.sortIndex=L.expirationTime,t(u,L);else break;L=n(d)}}function x(A){if(k=!1,p(A),!w)if(n(u)!==null)w=!0,ce(b);else{var L=n(d);L!==null&&me(x,L.startTime-A)}}function b(A,L){w=!1,k&&(k=!1,h($),$=-1),v=!0;var D=g;try{for(p(L),y=n(u);y!==null&&(!(y.expirationTime>L)||A&&!I());){var _=y.callback;if(typeof _=="function"){y.callback=null,g=y.priorityLevel;var H=_(y.expirationTime<=L);L=e.unstable_now(),typeof H=="function"?y.callback=H:y===n(u)&&r(u),p(L)}else r(u);y=n(u)}if(y!==null)var Q=!0;else{var oe=n(d);oe!==null&&me(x,oe.startTime-L),Q=!1}return Q}finally{y=null,g=D,v=!1}}var C=!1,z=null,$=-1,O=5,R=-1;function I(){return!(e.unstable_now()-R<O)}function Z(){if(z!==null){var A=e.unstable_now();R=A;var L=!0;try{L=z(!0,A)}finally{L?X():(C=!1,z=null)}}else C=!1}var X;if(typeof f=="function")X=function(){f(Z)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Se=de.port2;de.port1.onmessage=Z,X=function(){Se.postMessage(null)}}else X=function(){j(Z,0)};function ce(A){z=A,C||(C=!0,X())}function me(A,L){$=j(function(){A(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(A){A.callback=null},e.unstable_continueExecution=function(){w||v||(w=!0,ce(b))},e.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<A?Math.floor(1e3/A):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(A){switch(g){case 1:case 2:case 3:var L=3;break;default:L=g}var D=g;g=L;try{return A()}finally{g=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(A,L){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var D=g;g=A;try{return L()}finally{g=D}},e.unstable_scheduleCallback=function(A,L,D){var _=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?_+D:_):D=_,A){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=D+H,A={id:m++,callback:L,priorityLevel:A,startTime:D,expirationTime:H,sortIndex:-1},D>_?(A.sortIndex=D,t(d,A),n(u)===null&&A===n(d)&&(k?(h($),$=-1):k=!0,me(x,D-_))):(A.sortIndex=H,t(u,A),w||v||(w=!0,ce(b))),A},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(A){var L=g;return function(){var D=g;g=L;try{return A.apply(this,arguments)}finally{g=D}}}})(ah);ih.exports=ah;var lv=ih.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iv=o,ln=lv;function ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var oh=new Set,Yl={};function ps(e,t){Ws(e,t),Ws(e+"Capture",t)}function Ws(e,t){for(Yl[e]=t,e=0;e<t.length;e++)oh.add(t[e])}var ar=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dc=Object.prototype.hasOwnProperty,av=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jd={},Zd={};function ov(e){return dc.call(Zd,e)?!0:dc.call(Jd,e)?!1:av.test(e)?Zd[e]=!0:(Jd[e]=!0,!1)}function cv(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function uv(e,t,n,r){if(t===null||typeof t>"u"||cv(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Kt(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var It={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){It[e]=new Kt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];It[t]=new Kt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){It[e]=new Kt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){It[e]=new Kt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){It[e]=new Kt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){It[e]=new Kt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){It[e]=new Kt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){It[e]=new Kt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){It[e]=new Kt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Cu=/[\-:]([a-z])/g;function Nu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Cu,Nu);It[t]=new Kt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Cu,Nu);It[t]=new Kt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Cu,Nu);It[t]=new Kt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){It[e]=new Kt(e,1,!1,e.toLowerCase(),null,!1,!1)});It.xlinkHref=new Kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){It[e]=new Kt(e,1,!1,e.toLowerCase(),null,!0,!0)});function bu(e,t,n,r){var s=It.hasOwnProperty(t)?It[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(uv(t,n,s,r)&&(n=null),r||s===null?ov(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var fr=iv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ri=Symbol.for("react.element"),Ns=Symbol.for("react.portal"),bs=Symbol.for("react.fragment"),Eu=Symbol.for("react.strict_mode"),fc=Symbol.for("react.profiler"),ch=Symbol.for("react.provider"),uh=Symbol.for("react.context"),Lu=Symbol.for("react.forward_ref"),pc=Symbol.for("react.suspense"),hc=Symbol.for("react.suspense_list"),Pu=Symbol.for("react.memo"),wr=Symbol.for("react.lazy"),dh=Symbol.for("react.offscreen"),ef=Symbol.iterator;function Sl(e){return e===null||typeof e!="object"?null:(e=ef&&e[ef]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,Ro;function zl(e){if(Ro===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ro=t&&t[1]||""}return`
`+Ro+e}var Ao=!1;function Io(e,t){if(!e||Ao)return"";Ao=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,c=i.length-1;1<=a&&0<=c&&s[a]!==i[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==i[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==i[c]){var u=`
`+s[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=c);break}}}finally{Ao=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?zl(e):""}function dv(e){switch(e.tag){case 5:return zl(e.type);case 16:return zl("Lazy");case 13:return zl("Suspense");case 19:return zl("SuspenseList");case 0:case 2:case 15:return e=Io(e.type,!1),e;case 11:return e=Io(e.type.render,!1),e;case 1:return e=Io(e.type,!0),e;default:return""}}function mc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case bs:return"Fragment";case Ns:return"Portal";case fc:return"Profiler";case Eu:return"StrictMode";case pc:return"Suspense";case hc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case uh:return(e.displayName||"Context")+".Consumer";case ch:return(e._context.displayName||"Context")+".Provider";case Lu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Pu:return t=e.displayName||null,t!==null?t:mc(e.type)||"Memo";case wr:t=e._payload,e=e._init;try{return mc(e(t))}catch{}}return null}function fv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mc(t);case 8:return t===Eu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Mr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function pv(e){var t=fh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ai(e){e._valueTracker||(e._valueTracker=pv(e))}function ph(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=fh(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function pa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function gc(e,t){var n=t.checked;return pt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function tf(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Mr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function hh(e,t){t=t.checked,t!=null&&bu(e,"checked",t,!1)}function yc(e,t){hh(e,t);var n=Mr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?vc(e,t.type,n):t.hasOwnProperty("defaultValue")&&vc(e,t.type,Mr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function nf(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function vc(e,t,n){(t!=="number"||pa(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var _l=Array.isArray;function Ms(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Mr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function xc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ee(91));return pt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function rf(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ee(92));if(_l(n)){if(1<n.length)throw Error(ee(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Mr(n)}}function mh(e,t){var n=Mr(t.value),r=Mr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function sf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function gh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?gh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ii,yh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ii=Ii||document.createElement("div"),Ii.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ii.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ql(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var $l={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},hv=["Webkit","ms","Moz","O"];Object.keys($l).forEach(function(e){hv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),$l[t]=$l[e]})});function vh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||$l.hasOwnProperty(e)&&$l[e]?(""+t).trim():t+"px"}function xh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=vh(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var mv=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sc(e,t){if(t){if(mv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ee(62))}}function jc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kc=null;function zu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Cc=null,Fs=null,Os=null;function lf(e){if(e=vi(e)){if(typeof Cc!="function")throw Error(ee(280));var t=e.stateNode;t&&(t=to(t),Cc(e.stateNode,e.type,t))}}function wh(e){Fs?Os?Os.push(e):Os=[e]:Fs=e}function Sh(){if(Fs){var e=Fs,t=Os;if(Os=Fs=null,lf(e),t)for(e=0;e<t.length;e++)lf(t[e])}}function jh(e,t){return e(t)}function kh(){}var To=!1;function Ch(e,t,n){if(To)return e(t,n);To=!0;try{return jh(e,t,n)}finally{To=!1,(Fs!==null||Os!==null)&&(kh(),Sh())}}function ql(e,t){var n=e.stateNode;if(n===null)return null;var r=to(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ee(231,t,typeof n));return n}var Nc=!1;if(ar)try{var jl={};Object.defineProperty(jl,"passive",{get:function(){Nc=!0}}),window.addEventListener("test",jl,jl),window.removeEventListener("test",jl,jl)}catch{Nc=!1}function gv(e,t,n,r,s,i,a,c,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(m){this.onError(m)}}var Ml=!1,ha=null,ma=!1,bc=null,yv={onError:function(e){Ml=!0,ha=e}};function vv(e,t,n,r,s,i,a,c,u){Ml=!1,ha=null,gv.apply(yv,arguments)}function xv(e,t,n,r,s,i,a,c,u){if(vv.apply(this,arguments),Ml){if(Ml){var d=ha;Ml=!1,ha=null}else throw Error(ee(198));ma||(ma=!0,bc=d)}}function hs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Nh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function af(e){if(hs(e)!==e)throw Error(ee(188))}function wv(e){var t=e.alternate;if(!t){if(t=hs(e),t===null)throw Error(ee(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return af(s),e;if(i===r)return af(s),t;i=i.sibling}throw Error(ee(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=i;break}if(c===r){a=!0,r=s,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=s;break}if(c===r){a=!0,r=i,n=s;break}c=c.sibling}if(!a)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?e:t}function bh(e){return e=wv(e),e!==null?Eh(e):null}function Eh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Eh(e);if(t!==null)return t;e=e.sibling}return null}var Lh=ln.unstable_scheduleCallback,of=ln.unstable_cancelCallback,Sv=ln.unstable_shouldYield,jv=ln.unstable_requestPaint,wt=ln.unstable_now,kv=ln.unstable_getCurrentPriorityLevel,_u=ln.unstable_ImmediatePriority,Ph=ln.unstable_UserBlockingPriority,ga=ln.unstable_NormalPriority,Cv=ln.unstable_LowPriority,zh=ln.unstable_IdlePriority,Xa=null,Kn=null;function Nv(e){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(Xa,e,void 0,(e.current.flags&128)===128)}catch{}}var Ln=Math.clz32?Math.clz32:Lv,bv=Math.log,Ev=Math.LN2;function Lv(e){return e>>>=0,e===0?32:31-(bv(e)/Ev|0)|0}var Ti=64,$i=4194304;function Rl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ya(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=Rl(c):(i&=a,i!==0&&(r=Rl(i)))}else a=n&~s,a!==0?r=Rl(a):i!==0&&(r=Rl(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ln(t),s=1<<n,r|=e[n],t&=~s;return r}function Pv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zv(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Ln(i),c=1<<a,u=s[a];u===-1?(!(c&n)||c&r)&&(s[a]=Pv(c,t)):u<=t&&(e.expiredLanes|=c),i&=~c}}function Ec(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function _h(){var e=Ti;return Ti<<=1,!(Ti&4194240)&&(Ti=64),e}function $o(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gi(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ln(t),e[t]=n}function _v(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Ln(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Ru(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ln(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Ze=0;function Rh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ah,Au,Ih,Th,$h,Lc=!1,Mi=[],Er=null,Lr=null,Pr=null,Xl=new Map,Jl=new Map,jr=[],Rv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cf(e,t){switch(e){case"focusin":case"focusout":Er=null;break;case"dragenter":case"dragleave":Lr=null;break;case"mouseover":case"mouseout":Pr=null;break;case"pointerover":case"pointerout":Xl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jl.delete(t.pointerId)}}function kl(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=vi(t),t!==null&&Au(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Av(e,t,n,r,s){switch(t){case"focusin":return Er=kl(Er,e,t,n,r,s),!0;case"dragenter":return Lr=kl(Lr,e,t,n,r,s),!0;case"mouseover":return Pr=kl(Pr,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Xl.set(i,kl(Xl.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Jl.set(i,kl(Jl.get(i)||null,e,t,n,r,s)),!0}return!1}function Mh(e){var t=ns(e.target);if(t!==null){var n=hs(t);if(n!==null){if(t=n.tag,t===13){if(t=Nh(n),t!==null){e.blockedOn=t,$h(e.priority,function(){Ih(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ta(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Pc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);kc=r,n.target.dispatchEvent(r),kc=null}else return t=vi(n),t!==null&&Au(t),e.blockedOn=n,!1;t.shift()}return!0}function uf(e,t,n){ta(e)&&n.delete(t)}function Iv(){Lc=!1,Er!==null&&ta(Er)&&(Er=null),Lr!==null&&ta(Lr)&&(Lr=null),Pr!==null&&ta(Pr)&&(Pr=null),Xl.forEach(uf),Jl.forEach(uf)}function Cl(e,t){e.blockedOn===t&&(e.blockedOn=null,Lc||(Lc=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,Iv)))}function Zl(e){function t(s){return Cl(s,e)}if(0<Mi.length){Cl(Mi[0],e);for(var n=1;n<Mi.length;n++){var r=Mi[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Er!==null&&Cl(Er,e),Lr!==null&&Cl(Lr,e),Pr!==null&&Cl(Pr,e),Xl.forEach(t),Jl.forEach(t),n=0;n<jr.length;n++)r=jr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<jr.length&&(n=jr[0],n.blockedOn===null);)Mh(n),n.blockedOn===null&&jr.shift()}var Ds=fr.ReactCurrentBatchConfig,va=!0;function Tv(e,t,n,r){var s=Ze,i=Ds.transition;Ds.transition=null;try{Ze=1,Iu(e,t,n,r)}finally{Ze=s,Ds.transition=i}}function $v(e,t,n,r){var s=Ze,i=Ds.transition;Ds.transition=null;try{Ze=4,Iu(e,t,n,r)}finally{Ze=s,Ds.transition=i}}function Iu(e,t,n,r){if(va){var s=Pc(e,t,n,r);if(s===null)Go(e,t,r,xa,n),cf(e,r);else if(Av(s,e,t,n,r))r.stopPropagation();else if(cf(e,r),t&4&&-1<Rv.indexOf(e)){for(;s!==null;){var i=vi(s);if(i!==null&&Ah(i),i=Pc(e,t,n,r),i===null&&Go(e,t,r,xa,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Go(e,t,r,null,n)}}var xa=null;function Pc(e,t,n,r){if(xa=null,e=zu(r),e=ns(e),e!==null)if(t=hs(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Nh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xa=e,null}function Fh(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kv()){case _u:return 1;case Ph:return 4;case ga:case Cv:return 16;case zh:return 536870912;default:return 16}default:return 16}}var Cr=null,Tu=null,na=null;function Oh(){if(na)return na;var e,t=Tu,n=t.length,r,s="value"in Cr?Cr.value:Cr.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return na=s.slice(e,1<r?1-r:void 0)}function ra(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Fi(){return!0}function df(){return!1}function on(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Fi:df,this.isPropagationStopped=df,this}return pt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Fi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Fi)},persist:function(){},isPersistent:Fi}),t}var tl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$u=on(tl),yi=pt({},tl,{view:0,detail:0}),Mv=on(yi),Mo,Fo,Nl,Ja=pt({},yi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Nl&&(Nl&&e.type==="mousemove"?(Mo=e.screenX-Nl.screenX,Fo=e.screenY-Nl.screenY):Fo=Mo=0,Nl=e),Mo)},movementY:function(e){return"movementY"in e?e.movementY:Fo}}),ff=on(Ja),Fv=pt({},Ja,{dataTransfer:0}),Ov=on(Fv),Dv=pt({},yi,{relatedTarget:0}),Oo=on(Dv),Bv=pt({},tl,{animationName:0,elapsedTime:0,pseudoElement:0}),Uv=on(Bv),Vv=pt({},tl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Wv=on(Vv),Hv=pt({},tl,{data:0}),pf=on(Hv),Gv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Yv[e])?!!t[e]:!1}function Mu(){return Qv}var qv=pt({},yi,{key:function(e){if(e.key){var t=Gv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ra(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Kv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mu,charCode:function(e){return e.type==="keypress"?ra(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ra(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Xv=on(qv),Jv=pt({},Ja,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hf=on(Jv),Zv=pt({},yi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mu}),ex=on(Zv),tx=pt({},tl,{propertyName:0,elapsedTime:0,pseudoElement:0}),nx=on(tx),rx=pt({},Ja,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),sx=on(rx),lx=[9,13,27,32],Fu=ar&&"CompositionEvent"in window,Fl=null;ar&&"documentMode"in document&&(Fl=document.documentMode);var ix=ar&&"TextEvent"in window&&!Fl,Dh=ar&&(!Fu||Fl&&8<Fl&&11>=Fl),mf=" ",gf=!1;function Bh(e,t){switch(e){case"keyup":return lx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uh(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Es=!1;function ax(e,t){switch(e){case"compositionend":return Uh(t);case"keypress":return t.which!==32?null:(gf=!0,mf);case"textInput":return e=t.data,e===mf&&gf?null:e;default:return null}}function ox(e,t){if(Es)return e==="compositionend"||!Fu&&Bh(e,t)?(e=Oh(),na=Tu=Cr=null,Es=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dh&&t.locale!=="ko"?null:t.data;default:return null}}var cx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!cx[e.type]:t==="textarea"}function Vh(e,t,n,r){wh(r),t=wa(t,"onChange"),0<t.length&&(n=new $u("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ol=null,ei=null;function ux(e){em(e,0)}function Za(e){var t=zs(e);if(ph(t))return e}function dx(e,t){if(e==="change")return t}var Wh=!1;if(ar){var Do;if(ar){var Bo="oninput"in document;if(!Bo){var vf=document.createElement("div");vf.setAttribute("oninput","return;"),Bo=typeof vf.oninput=="function"}Do=Bo}else Do=!1;Wh=Do&&(!document.documentMode||9<document.documentMode)}function xf(){Ol&&(Ol.detachEvent("onpropertychange",Hh),ei=Ol=null)}function Hh(e){if(e.propertyName==="value"&&Za(ei)){var t=[];Vh(t,ei,e,zu(e)),Ch(ux,t)}}function fx(e,t,n){e==="focusin"?(xf(),Ol=t,ei=n,Ol.attachEvent("onpropertychange",Hh)):e==="focusout"&&xf()}function px(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Za(ei)}function hx(e,t){if(e==="click")return Za(t)}function mx(e,t){if(e==="input"||e==="change")return Za(t)}function gx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _n=typeof Object.is=="function"?Object.is:gx;function ti(e,t){if(_n(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!dc.call(t,s)||!_n(e[s],t[s]))return!1}return!0}function wf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Sf(e,t){var n=wf(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=wf(n)}}function Gh(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Gh(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Kh(){for(var e=window,t=pa();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=pa(e.document)}return t}function Ou(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yx(e){var t=Kh(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Gh(n.ownerDocument.documentElement,n)){if(r!==null&&Ou(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Sf(n,i);var a=Sf(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vx=ar&&"documentMode"in document&&11>=document.documentMode,Ls=null,zc=null,Dl=null,_c=!1;function jf(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;_c||Ls==null||Ls!==pa(r)||(r=Ls,"selectionStart"in r&&Ou(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Dl&&ti(Dl,r)||(Dl=r,r=wa(zc,"onSelect"),0<r.length&&(t=new $u("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ls)))}function Oi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ps={animationend:Oi("Animation","AnimationEnd"),animationiteration:Oi("Animation","AnimationIteration"),animationstart:Oi("Animation","AnimationStart"),transitionend:Oi("Transition","TransitionEnd")},Uo={},Yh={};ar&&(Yh=document.createElement("div").style,"AnimationEvent"in window||(delete Ps.animationend.animation,delete Ps.animationiteration.animation,delete Ps.animationstart.animation),"TransitionEvent"in window||delete Ps.transitionend.transition);function eo(e){if(Uo[e])return Uo[e];if(!Ps[e])return e;var t=Ps[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Yh)return Uo[e]=t[n];return e}var Qh=eo("animationend"),qh=eo("animationiteration"),Xh=eo("animationstart"),Jh=eo("transitionend"),Zh=new Map,kf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Zh.set(e,t),ps(t,[e])}for(var Vo=0;Vo<kf.length;Vo++){var Wo=kf[Vo],xx=Wo.toLowerCase(),wx=Wo[0].toUpperCase()+Wo.slice(1);Dr(xx,"on"+wx)}Dr(Qh,"onAnimationEnd");Dr(qh,"onAnimationIteration");Dr(Xh,"onAnimationStart");Dr("dblclick","onDoubleClick");Dr("focusin","onFocus");Dr("focusout","onBlur");Dr(Jh,"onTransitionEnd");Ws("onMouseEnter",["mouseout","mouseover"]);Ws("onMouseLeave",["mouseout","mouseover"]);Ws("onPointerEnter",["pointerout","pointerover"]);Ws("onPointerLeave",["pointerout","pointerover"]);ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Al));function Cf(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,xv(r,t,void 0,e),e.currentTarget=null}function em(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var c=r[a],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Cf(s,c,d),i=u}else for(a=0;a<r.length;a++){if(c=r[a],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Cf(s,c,d),i=u}}}if(ma)throw e=bc,ma=!1,bc=null,e}function rt(e,t){var n=t[$c];n===void 0&&(n=t[$c]=new Set);var r=e+"__bubble";n.has(r)||(tm(t,e,2,!1),n.add(r))}function Ho(e,t,n){var r=0;t&&(r|=4),tm(n,e,r,t)}var Di="_reactListening"+Math.random().toString(36).slice(2);function ni(e){if(!e[Di]){e[Di]=!0,oh.forEach(function(n){n!=="selectionchange"&&(Sx.has(n)||Ho(n,!1,e),Ho(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Di]||(t[Di]=!0,Ho("selectionchange",!1,t))}}function tm(e,t,n,r){switch(Fh(t)){case 1:var s=Tv;break;case 4:s=$v;break;default:s=Iu}n=s.bind(null,t,n,e),s=void 0,!Nc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Go(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;c!==null;){if(a=ns(c),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}c=c.parentNode}}r=r.return}Ch(function(){var d=i,m=zu(n),y=[];e:{var g=Zh.get(e);if(g!==void 0){var v=$u,w=e;switch(e){case"keypress":if(ra(n)===0)break e;case"keydown":case"keyup":v=Xv;break;case"focusin":w="focus",v=Oo;break;case"focusout":w="blur",v=Oo;break;case"beforeblur":case"afterblur":v=Oo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=ff;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=Ov;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=ex;break;case Qh:case qh:case Xh:v=Uv;break;case Jh:v=nx;break;case"scroll":v=Mv;break;case"wheel":v=sx;break;case"copy":case"cut":case"paste":v=Wv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=hf}var k=(t&4)!==0,j=!k&&e==="scroll",h=k?g!==null?g+"Capture":null:g;k=[];for(var f=d,p;f!==null;){p=f;var x=p.stateNode;if(p.tag===5&&x!==null&&(p=x,h!==null&&(x=ql(f,h),x!=null&&k.push(ri(f,x,p)))),j)break;f=f.return}0<k.length&&(g=new v(g,w,null,n,m),y.push({event:g,listeners:k}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",v=e==="mouseout"||e==="pointerout",g&&n!==kc&&(w=n.relatedTarget||n.fromElement)&&(ns(w)||w[or]))break e;if((v||g)&&(g=m.window===m?m:(g=m.ownerDocument)?g.defaultView||g.parentWindow:window,v?(w=n.relatedTarget||n.toElement,v=d,w=w?ns(w):null,w!==null&&(j=hs(w),w!==j||w.tag!==5&&w.tag!==6)&&(w=null)):(v=null,w=d),v!==w)){if(k=ff,x="onMouseLeave",h="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(k=hf,x="onPointerLeave",h="onPointerEnter",f="pointer"),j=v==null?g:zs(v),p=w==null?g:zs(w),g=new k(x,f+"leave",v,n,m),g.target=j,g.relatedTarget=p,x=null,ns(m)===d&&(k=new k(h,f+"enter",w,n,m),k.target=p,k.relatedTarget=j,x=k),j=x,v&&w)t:{for(k=v,h=w,f=0,p=k;p;p=Ss(p))f++;for(p=0,x=h;x;x=Ss(x))p++;for(;0<f-p;)k=Ss(k),f--;for(;0<p-f;)h=Ss(h),p--;for(;f--;){if(k===h||h!==null&&k===h.alternate)break t;k=Ss(k),h=Ss(h)}k=null}else k=null;v!==null&&Nf(y,g,v,k,!1),w!==null&&j!==null&&Nf(y,j,w,k,!0)}}e:{if(g=d?zs(d):window,v=g.nodeName&&g.nodeName.toLowerCase(),v==="select"||v==="input"&&g.type==="file")var b=dx;else if(yf(g))if(Wh)b=mx;else{b=px;var C=fx}else(v=g.nodeName)&&v.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(b=hx);if(b&&(b=b(e,d))){Vh(y,b,n,m);break e}C&&C(e,g,d),e==="focusout"&&(C=g._wrapperState)&&C.controlled&&g.type==="number"&&vc(g,"number",g.value)}switch(C=d?zs(d):window,e){case"focusin":(yf(C)||C.contentEditable==="true")&&(Ls=C,zc=d,Dl=null);break;case"focusout":Dl=zc=Ls=null;break;case"mousedown":_c=!0;break;case"contextmenu":case"mouseup":case"dragend":_c=!1,jf(y,n,m);break;case"selectionchange":if(vx)break;case"keydown":case"keyup":jf(y,n,m)}var z;if(Fu)e:{switch(e){case"compositionstart":var $="onCompositionStart";break e;case"compositionend":$="onCompositionEnd";break e;case"compositionupdate":$="onCompositionUpdate";break e}$=void 0}else Es?Bh(e,n)&&($="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&($="onCompositionStart");$&&(Dh&&n.locale!=="ko"&&(Es||$!=="onCompositionStart"?$==="onCompositionEnd"&&Es&&(z=Oh()):(Cr=m,Tu="value"in Cr?Cr.value:Cr.textContent,Es=!0)),C=wa(d,$),0<C.length&&($=new pf($,e,null,n,m),y.push({event:$,listeners:C}),z?$.data=z:(z=Uh(n),z!==null&&($.data=z)))),(z=ix?ax(e,n):ox(e,n))&&(d=wa(d,"onBeforeInput"),0<d.length&&(m=new pf("onBeforeInput","beforeinput",null,n,m),y.push({event:m,listeners:d}),m.data=z))}em(y,t)})}function ri(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wa(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ql(e,n),i!=null&&r.unshift(ri(e,i,s)),i=ql(e,t),i!=null&&r.push(ri(e,i,s))),e=e.return}return r}function Ss(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Nf(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=ql(n,i),u!=null&&a.unshift(ri(n,u,c))):s||(u=ql(n,i),u!=null&&a.push(ri(n,u,c)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var jx=/\r\n?/g,kx=/\u0000|\uFFFD/g;function bf(e){return(typeof e=="string"?e:""+e).replace(jx,`
`).replace(kx,"")}function Bi(e,t,n){if(t=bf(t),bf(e)!==t&&n)throw Error(ee(425))}function Sa(){}var Rc=null,Ac=null;function Ic(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Tc=typeof setTimeout=="function"?setTimeout:void 0,Cx=typeof clearTimeout=="function"?clearTimeout:void 0,Ef=typeof Promise=="function"?Promise:void 0,Nx=typeof queueMicrotask=="function"?queueMicrotask:typeof Ef<"u"?function(e){return Ef.resolve(null).then(e).catch(bx)}:Tc;function bx(e){setTimeout(function(){throw e})}function Ko(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Zl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Zl(t)}function zr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Lf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var nl=Math.random().toString(36).slice(2),Bn="__reactFiber$"+nl,si="__reactProps$"+nl,or="__reactContainer$"+nl,$c="__reactEvents$"+nl,Ex="__reactListeners$"+nl,Lx="__reactHandles$"+nl;function ns(e){var t=e[Bn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[or]||n[Bn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Lf(e);e!==null;){if(n=e[Bn])return n;e=Lf(e)}return t}e=n,n=e.parentNode}return null}function vi(e){return e=e[Bn]||e[or],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function to(e){return e[si]||null}var Mc=[],_s=-1;function Br(e){return{current:e}}function st(e){0>_s||(e.current=Mc[_s],Mc[_s]=null,_s--)}function nt(e,t){_s++,Mc[_s]=e.current,e.current=t}var Fr={},Ot=Br(Fr),Xt=Br(!1),os=Fr;function Hs(e,t){var n=e.type.contextTypes;if(!n)return Fr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Jt(e){return e=e.childContextTypes,e!=null}function ja(){st(Xt),st(Ot)}function Pf(e,t,n){if(Ot.current!==Fr)throw Error(ee(168));nt(Ot,t),nt(Xt,n)}function nm(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(ee(108,fv(e)||"Unknown",s));return pt({},n,r)}function ka(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fr,os=Ot.current,nt(Ot,e),nt(Xt,Xt.current),!0}function zf(e,t,n){var r=e.stateNode;if(!r)throw Error(ee(169));n?(e=nm(e,t,os),r.__reactInternalMemoizedMergedChildContext=e,st(Xt),st(Ot),nt(Ot,e)):st(Xt),nt(Xt,n)}var tr=null,no=!1,Yo=!1;function rm(e){tr===null?tr=[e]:tr.push(e)}function Px(e){no=!0,rm(e)}function Ur(){if(!Yo&&tr!==null){Yo=!0;var e=0,t=Ze;try{var n=tr;for(Ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}tr=null,no=!1}catch(s){throw tr!==null&&(tr=tr.slice(e+1)),Lh(_u,Ur),s}finally{Ze=t,Yo=!1}}return null}var Rs=[],As=0,Ca=null,Na=0,pn=[],hn=0,cs=null,rr=1,sr="";function Zr(e,t){Rs[As++]=Na,Rs[As++]=Ca,Ca=e,Na=t}function sm(e,t,n){pn[hn++]=rr,pn[hn++]=sr,pn[hn++]=cs,cs=e;var r=rr;e=sr;var s=32-Ln(r)-1;r&=~(1<<s),n+=1;var i=32-Ln(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,rr=1<<32-Ln(t)+s|n<<s|r,sr=i+e}else rr=1<<i|n<<s|r,sr=e}function Du(e){e.return!==null&&(Zr(e,1),sm(e,1,0))}function Bu(e){for(;e===Ca;)Ca=Rs[--As],Rs[As]=null,Na=Rs[--As],Rs[As]=null;for(;e===cs;)cs=pn[--hn],pn[hn]=null,sr=pn[--hn],pn[hn]=null,rr=pn[--hn],pn[hn]=null}var sn=null,rn=null,ot=!1,bn=null;function lm(e,t){var n=mn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function _f(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sn=e,rn=zr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sn=e,rn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=cs!==null?{id:rr,overflow:sr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=mn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,sn=e,rn=null,!0):!1;default:return!1}}function Fc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Oc(e){if(ot){var t=rn;if(t){var n=t;if(!_f(e,t)){if(Fc(e))throw Error(ee(418));t=zr(n.nextSibling);var r=sn;t&&_f(e,t)?lm(r,n):(e.flags=e.flags&-4097|2,ot=!1,sn=e)}}else{if(Fc(e))throw Error(ee(418));e.flags=e.flags&-4097|2,ot=!1,sn=e}}}function Rf(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sn=e}function Ui(e){if(e!==sn)return!1;if(!ot)return Rf(e),ot=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ic(e.type,e.memoizedProps)),t&&(t=rn)){if(Fc(e))throw im(),Error(ee(418));for(;t;)lm(e,t),t=zr(t.nextSibling)}if(Rf(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){rn=zr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}rn=null}}else rn=sn?zr(e.stateNode.nextSibling):null;return!0}function im(){for(var e=rn;e;)e=zr(e.nextSibling)}function Gs(){rn=sn=null,ot=!1}function Uu(e){bn===null?bn=[e]:bn.push(e)}var zx=fr.ReactCurrentBatchConfig;function bl(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var c=s.refs;a===null?delete c[i]:c[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,e))}return e}function Vi(e,t){throw e=Object.prototype.toString.call(t),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Af(e){var t=e._init;return t(e._payload)}function am(e){function t(h,f){if(e){var p=h.deletions;p===null?(h.deletions=[f],h.flags|=16):p.push(f)}}function n(h,f){if(!e)return null;for(;f!==null;)t(h,f),f=f.sibling;return null}function r(h,f){for(h=new Map;f!==null;)f.key!==null?h.set(f.key,f):h.set(f.index,f),f=f.sibling;return h}function s(h,f){return h=Ir(h,f),h.index=0,h.sibling=null,h}function i(h,f,p){return h.index=p,e?(p=h.alternate,p!==null?(p=p.index,p<f?(h.flags|=2,f):p):(h.flags|=2,f)):(h.flags|=1048576,f)}function a(h){return e&&h.alternate===null&&(h.flags|=2),h}function c(h,f,p,x){return f===null||f.tag!==6?(f=tc(p,h.mode,x),f.return=h,f):(f=s(f,p),f.return=h,f)}function u(h,f,p,x){var b=p.type;return b===bs?m(h,f,p.props.children,x,p.key):f!==null&&(f.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===wr&&Af(b)===f.type)?(x=s(f,p.props),x.ref=bl(h,f,p),x.return=h,x):(x=ua(p.type,p.key,p.props,null,h.mode,x),x.ref=bl(h,f,p),x.return=h,x)}function d(h,f,p,x){return f===null||f.tag!==4||f.stateNode.containerInfo!==p.containerInfo||f.stateNode.implementation!==p.implementation?(f=nc(p,h.mode,x),f.return=h,f):(f=s(f,p.children||[]),f.return=h,f)}function m(h,f,p,x,b){return f===null||f.tag!==7?(f=as(p,h.mode,x,b),f.return=h,f):(f=s(f,p),f.return=h,f)}function y(h,f,p){if(typeof f=="string"&&f!==""||typeof f=="number")return f=tc(""+f,h.mode,p),f.return=h,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Ri:return p=ua(f.type,f.key,f.props,null,h.mode,p),p.ref=bl(h,null,f),p.return=h,p;case Ns:return f=nc(f,h.mode,p),f.return=h,f;case wr:var x=f._init;return y(h,x(f._payload),p)}if(_l(f)||Sl(f))return f=as(f,h.mode,p,null),f.return=h,f;Vi(h,f)}return null}function g(h,f,p,x){var b=f!==null?f.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return b!==null?null:c(h,f,""+p,x);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ri:return p.key===b?u(h,f,p,x):null;case Ns:return p.key===b?d(h,f,p,x):null;case wr:return b=p._init,g(h,f,b(p._payload),x)}if(_l(p)||Sl(p))return b!==null?null:m(h,f,p,x,null);Vi(h,p)}return null}function v(h,f,p,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return h=h.get(p)||null,c(f,h,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ri:return h=h.get(x.key===null?p:x.key)||null,u(f,h,x,b);case Ns:return h=h.get(x.key===null?p:x.key)||null,d(f,h,x,b);case wr:var C=x._init;return v(h,f,p,C(x._payload),b)}if(_l(x)||Sl(x))return h=h.get(p)||null,m(f,h,x,b,null);Vi(f,x)}return null}function w(h,f,p,x){for(var b=null,C=null,z=f,$=f=0,O=null;z!==null&&$<p.length;$++){z.index>$?(O=z,z=null):O=z.sibling;var R=g(h,z,p[$],x);if(R===null){z===null&&(z=O);break}e&&z&&R.alternate===null&&t(h,z),f=i(R,f,$),C===null?b=R:C.sibling=R,C=R,z=O}if($===p.length)return n(h,z),ot&&Zr(h,$),b;if(z===null){for(;$<p.length;$++)z=y(h,p[$],x),z!==null&&(f=i(z,f,$),C===null?b=z:C.sibling=z,C=z);return ot&&Zr(h,$),b}for(z=r(h,z);$<p.length;$++)O=v(z,h,$,p[$],x),O!==null&&(e&&O.alternate!==null&&z.delete(O.key===null?$:O.key),f=i(O,f,$),C===null?b=O:C.sibling=O,C=O);return e&&z.forEach(function(I){return t(h,I)}),ot&&Zr(h,$),b}function k(h,f,p,x){var b=Sl(p);if(typeof b!="function")throw Error(ee(150));if(p=b.call(p),p==null)throw Error(ee(151));for(var C=b=null,z=f,$=f=0,O=null,R=p.next();z!==null&&!R.done;$++,R=p.next()){z.index>$?(O=z,z=null):O=z.sibling;var I=g(h,z,R.value,x);if(I===null){z===null&&(z=O);break}e&&z&&I.alternate===null&&t(h,z),f=i(I,f,$),C===null?b=I:C.sibling=I,C=I,z=O}if(R.done)return n(h,z),ot&&Zr(h,$),b;if(z===null){for(;!R.done;$++,R=p.next())R=y(h,R.value,x),R!==null&&(f=i(R,f,$),C===null?b=R:C.sibling=R,C=R);return ot&&Zr(h,$),b}for(z=r(h,z);!R.done;$++,R=p.next())R=v(z,h,$,R.value,x),R!==null&&(e&&R.alternate!==null&&z.delete(R.key===null?$:R.key),f=i(R,f,$),C===null?b=R:C.sibling=R,C=R);return e&&z.forEach(function(Z){return t(h,Z)}),ot&&Zr(h,$),b}function j(h,f,p,x){if(typeof p=="object"&&p!==null&&p.type===bs&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case Ri:e:{for(var b=p.key,C=f;C!==null;){if(C.key===b){if(b=p.type,b===bs){if(C.tag===7){n(h,C.sibling),f=s(C,p.props.children),f.return=h,h=f;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===wr&&Af(b)===C.type){n(h,C.sibling),f=s(C,p.props),f.ref=bl(h,C,p),f.return=h,h=f;break e}n(h,C);break}else t(h,C);C=C.sibling}p.type===bs?(f=as(p.props.children,h.mode,x,p.key),f.return=h,h=f):(x=ua(p.type,p.key,p.props,null,h.mode,x),x.ref=bl(h,f,p),x.return=h,h=x)}return a(h);case Ns:e:{for(C=p.key;f!==null;){if(f.key===C)if(f.tag===4&&f.stateNode.containerInfo===p.containerInfo&&f.stateNode.implementation===p.implementation){n(h,f.sibling),f=s(f,p.children||[]),f.return=h,h=f;break e}else{n(h,f);break}else t(h,f);f=f.sibling}f=nc(p,h.mode,x),f.return=h,h=f}return a(h);case wr:return C=p._init,j(h,f,C(p._payload),x)}if(_l(p))return w(h,f,p,x);if(Sl(p))return k(h,f,p,x);Vi(h,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,f!==null&&f.tag===6?(n(h,f.sibling),f=s(f,p),f.return=h,h=f):(n(h,f),f=tc(p,h.mode,x),f.return=h,h=f),a(h)):n(h,f)}return j}var Ks=am(!0),om=am(!1),ba=Br(null),Ea=null,Is=null,Vu=null;function Wu(){Vu=Is=Ea=null}function Hu(e){var t=ba.current;st(ba),e._currentValue=t}function Dc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Bs(e,t){Ea=e,Vu=Is=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(qt=!0),e.firstContext=null)}function yn(e){var t=e._currentValue;if(Vu!==e)if(e={context:e,memoizedValue:t,next:null},Is===null){if(Ea===null)throw Error(ee(308));Is=e,Ea.dependencies={lanes:0,firstContext:e}}else Is=Is.next=e;return t}var rs=null;function Gu(e){rs===null?rs=[e]:rs.push(e)}function cm(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Gu(t)):(n.next=s.next,s.next=n),t.interleaved=n,cr(e,r)}function cr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Sr=!1;function Ku(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function um(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _r(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,cr(e,n)}return s=r.interleaved,s===null?(t.next=t,Gu(r)):(t.next=s.next,s.next=t),r.interleaved=t,cr(e,n)}function sa(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ru(e,n)}}function If(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function La(e,t,n,r){var s=e.updateQueue;Sr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,a===null?i=d:a.next=d,a=u;var m=e.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==a&&(c===null?m.firstBaseUpdate=d:c.next=d,m.lastBaseUpdate=u))}if(i!==null){var y=s.baseState;a=0,m=d=u=null,c=i;do{var g=c.lane,v=c.eventTime;if((r&g)===g){m!==null&&(m=m.next={eventTime:v,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=e,k=c;switch(g=t,v=n,k.tag){case 1:if(w=k.payload,typeof w=="function"){y=w.call(v,y,g);break e}y=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=k.payload,g=typeof w=="function"?w.call(v,y,g):w,g==null)break e;y=pt({},y,g);break e;case 2:Sr=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,g=s.effects,g===null?s.effects=[c]:g.push(c))}else v={eventTime:v,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(d=m=v,u=y):m=m.next=v,a|=g;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;g=c,c=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(m===null&&(u=y),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);ds|=a,e.lanes=a,e.memoizedState=y}}function Tf(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ee(191,s));s.call(r)}}}var xi={},Yn=Br(xi),li=Br(xi),ii=Br(xi);function ss(e){if(e===xi)throw Error(ee(174));return e}function Yu(e,t){switch(nt(ii,t),nt(li,e),nt(Yn,xi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:wc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=wc(t,e)}st(Yn),nt(Yn,t)}function Ys(){st(Yn),st(li),st(ii)}function dm(e){ss(ii.current);var t=ss(Yn.current),n=wc(t,e.type);t!==n&&(nt(li,e),nt(Yn,n))}function Qu(e){li.current===e&&(st(Yn),st(li))}var ut=Br(0);function Pa(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qo=[];function qu(){for(var e=0;e<Qo.length;e++)Qo[e]._workInProgressVersionPrimary=null;Qo.length=0}var la=fr.ReactCurrentDispatcher,qo=fr.ReactCurrentBatchConfig,us=0,dt=null,Nt=null,zt=null,za=!1,Bl=!1,ai=0,_x=0;function $t(){throw Error(ee(321))}function Xu(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!_n(e[n],t[n]))return!1;return!0}function Ju(e,t,n,r,s,i){if(us=i,dt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,la.current=e===null||e.memoizedState===null?Tx:$x,e=n(r,s),Bl){i=0;do{if(Bl=!1,ai=0,25<=i)throw Error(ee(301));i+=1,zt=Nt=null,t.updateQueue=null,la.current=Mx,e=n(r,s)}while(Bl)}if(la.current=_a,t=Nt!==null&&Nt.next!==null,us=0,zt=Nt=dt=null,za=!1,t)throw Error(ee(300));return e}function Zu(){var e=ai!==0;return ai=0,e}function On(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?dt.memoizedState=zt=e:zt=zt.next=e,zt}function vn(){if(Nt===null){var e=dt.alternate;e=e!==null?e.memoizedState:null}else e=Nt.next;var t=zt===null?dt.memoizedState:zt.next;if(t!==null)zt=t,Nt=e;else{if(e===null)throw Error(ee(310));Nt=e,e={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},zt===null?dt.memoizedState=zt=e:zt=zt.next=e}return zt}function oi(e,t){return typeof t=="function"?t(e):t}function Xo(e){var t=vn(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=Nt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=a=null,u=null,d=i;do{var m=d.lane;if((us&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var y={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=y,a=r):u=u.next=y,dt.lanes|=m,ds|=m}d=d.next}while(d!==null&&d!==i);u===null?a=r:u.next=c,_n(r,t.memoizedState)||(qt=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,dt.lanes|=i,ds|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Jo(e){var t=vn(),n=t.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);_n(i,t.memoizedState)||(qt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function fm(){}function pm(e,t){var n=dt,r=vn(),s=t(),i=!_n(r.memoizedState,s);if(i&&(r.memoizedState=s,qt=!0),r=r.queue,ed(gm.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||zt!==null&&zt.memoizedState.tag&1){if(n.flags|=2048,ci(9,mm.bind(null,n,r,s,t),void 0,null),_t===null)throw Error(ee(349));us&30||hm(n,t,s)}return s}function hm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function mm(e,t,n,r){t.value=n,t.getSnapshot=r,ym(t)&&vm(e)}function gm(e,t,n){return n(function(){ym(t)&&vm(e)})}function ym(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!_n(e,n)}catch{return!0}}function vm(e){var t=cr(e,1);t!==null&&Pn(t,e,1,-1)}function $f(e){var t=On();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oi,lastRenderedState:e},t.queue=e,e=e.dispatch=Ix.bind(null,dt,e),[t.memoizedState,e]}function ci(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function xm(){return vn().memoizedState}function ia(e,t,n,r){var s=On();dt.flags|=e,s.memoizedState=ci(1|t,n,void 0,r===void 0?null:r)}function ro(e,t,n,r){var s=vn();r=r===void 0?null:r;var i=void 0;if(Nt!==null){var a=Nt.memoizedState;if(i=a.destroy,r!==null&&Xu(r,a.deps)){s.memoizedState=ci(t,n,i,r);return}}dt.flags|=e,s.memoizedState=ci(1|t,n,i,r)}function Mf(e,t){return ia(8390656,8,e,t)}function ed(e,t){return ro(2048,8,e,t)}function wm(e,t){return ro(4,2,e,t)}function Sm(e,t){return ro(4,4,e,t)}function jm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function km(e,t,n){return n=n!=null?n.concat([e]):null,ro(4,4,jm.bind(null,t,e),n)}function td(){}function Cm(e,t){var n=vn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Xu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Nm(e,t){var n=vn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Xu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function bm(e,t,n){return us&21?(_n(n,t)||(n=_h(),dt.lanes|=n,ds|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,qt=!0),e.memoizedState=n)}function Rx(e,t){var n=Ze;Ze=n!==0&&4>n?n:4,e(!0);var r=qo.transition;qo.transition={};try{e(!1),t()}finally{Ze=n,qo.transition=r}}function Em(){return vn().memoizedState}function Ax(e,t,n){var r=Ar(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Lm(e))Pm(t,n);else if(n=cm(e,t,n,r),n!==null){var s=Wt();Pn(n,e,r,s),zm(n,t,r)}}function Ix(e,t,n){var r=Ar(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Lm(e))Pm(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,c=i(a,n);if(s.hasEagerState=!0,s.eagerState=c,_n(c,a)){var u=t.interleaved;u===null?(s.next=s,Gu(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=cm(e,t,s,r),n!==null&&(s=Wt(),Pn(n,e,r,s),zm(n,t,r))}}function Lm(e){var t=e.alternate;return e===dt||t!==null&&t===dt}function Pm(e,t){Bl=za=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function zm(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Ru(e,n)}}var _a={readContext:yn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},Tx={readContext:yn,useCallback:function(e,t){return On().memoizedState=[e,t===void 0?null:t],e},useContext:yn,useEffect:Mf,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ia(4194308,4,jm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ia(4194308,4,e,t)},useInsertionEffect:function(e,t){return ia(4,2,e,t)},useMemo:function(e,t){var n=On();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=On();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ax.bind(null,dt,e),[r.memoizedState,e]},useRef:function(e){var t=On();return e={current:e},t.memoizedState=e},useState:$f,useDebugValue:td,useDeferredValue:function(e){return On().memoizedState=e},useTransition:function(){var e=$f(!1),t=e[0];return e=Rx.bind(null,e[1]),On().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=dt,s=On();if(ot){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=t(),_t===null)throw Error(ee(349));us&30||hm(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Mf(gm.bind(null,r,i,e),[e]),r.flags|=2048,ci(9,mm.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=On(),t=_t.identifierPrefix;if(ot){var n=sr,r=rr;n=(r&~(1<<32-Ln(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ai++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=_x++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$x={readContext:yn,useCallback:Cm,useContext:yn,useEffect:ed,useImperativeHandle:km,useInsertionEffect:wm,useLayoutEffect:Sm,useMemo:Nm,useReducer:Xo,useRef:xm,useState:function(){return Xo(oi)},useDebugValue:td,useDeferredValue:function(e){var t=vn();return bm(t,Nt.memoizedState,e)},useTransition:function(){var e=Xo(oi)[0],t=vn().memoizedState;return[e,t]},useMutableSource:fm,useSyncExternalStore:pm,useId:Em,unstable_isNewReconciler:!1},Mx={readContext:yn,useCallback:Cm,useContext:yn,useEffect:ed,useImperativeHandle:km,useInsertionEffect:wm,useLayoutEffect:Sm,useMemo:Nm,useReducer:Jo,useRef:xm,useState:function(){return Jo(oi)},useDebugValue:td,useDeferredValue:function(e){var t=vn();return Nt===null?t.memoizedState=e:bm(t,Nt.memoizedState,e)},useTransition:function(){var e=Jo(oi)[0],t=vn().memoizedState;return[e,t]},useMutableSource:fm,useSyncExternalStore:pm,useId:Em,unstable_isNewReconciler:!1};function Cn(e,t){if(e&&e.defaultProps){t=pt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Bc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:pt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var so={isMounted:function(e){return(e=e._reactInternals)?hs(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Wt(),s=Ar(e),i=lr(r,s);i.payload=t,n!=null&&(i.callback=n),t=_r(e,i,s),t!==null&&(Pn(t,e,s,r),sa(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Wt(),s=Ar(e),i=lr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=_r(e,i,s),t!==null&&(Pn(t,e,s,r),sa(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Wt(),r=Ar(e),s=lr(n,r);s.tag=2,t!=null&&(s.callback=t),t=_r(e,s,r),t!==null&&(Pn(t,e,r,n),sa(t,e,r))}};function Ff(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!ti(n,r)||!ti(s,i):!0}function _m(e,t,n){var r=!1,s=Fr,i=t.contextType;return typeof i=="object"&&i!==null?i=yn(i):(s=Jt(t)?os:Ot.current,r=t.contextTypes,i=(r=r!=null)?Hs(e,s):Fr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=so,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Of(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&so.enqueueReplaceState(t,t.state,null)}function Uc(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Ku(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=yn(i):(i=Jt(t)?os:Ot.current,s.context=Hs(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Bc(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&so.enqueueReplaceState(s,s.state,null),La(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Qs(e,t){try{var n="",r=t;do n+=dv(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Zo(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Vc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Fx=typeof WeakMap=="function"?WeakMap:Map;function Rm(e,t,n){n=lr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Aa||(Aa=!0,Zc=r),Vc(e,t)},n}function Am(e,t,n){n=lr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Vc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Vc(e,t),typeof r!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Df(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Fx;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Jx.bind(null,e,t,n),t.then(e,e))}function Bf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Uf(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=lr(-1,1),t.tag=2,_r(n,t,1))),n.lanes|=1),e)}var Ox=fr.ReactCurrentOwner,qt=!1;function Vt(e,t,n,r){t.child=e===null?om(t,null,n,r):Ks(t,e.child,n,r)}function Vf(e,t,n,r,s){n=n.render;var i=t.ref;return Bs(t,s),r=Ju(e,t,n,r,i,s),n=Zu(),e!==null&&!qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ur(e,t,s)):(ot&&n&&Du(t),t.flags|=1,Vt(e,t,r,s),t.child)}function Wf(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!cd(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Im(e,t,i,r,s)):(e=ua(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:ti,n(a,r)&&e.ref===t.ref)return ur(e,t,s)}return t.flags|=1,e=Ir(i,r),e.ref=t.ref,e.return=t,t.child=e}function Im(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(ti(i,r)&&e.ref===t.ref)if(qt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(qt=!0);else return t.lanes=e.lanes,ur(e,t,s)}return Wc(e,t,n,r,s)}function Tm(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt($s,nn),nn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,nt($s,nn),nn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,nt($s,nn),nn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,nt($s,nn),nn|=r;return Vt(e,t,s,n),t.child}function $m(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Wc(e,t,n,r,s){var i=Jt(n)?os:Ot.current;return i=Hs(t,i),Bs(t,s),n=Ju(e,t,n,r,i,s),r=Zu(),e!==null&&!qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ur(e,t,s)):(ot&&r&&Du(t),t.flags|=1,Vt(e,t,n,s),t.child)}function Hf(e,t,n,r,s){if(Jt(n)){var i=!0;ka(t)}else i=!1;if(Bs(t,s),t.stateNode===null)aa(e,t),_m(t,n,r),Uc(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,c=t.memoizedProps;a.props=c;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=yn(d):(d=Jt(n)?os:Ot.current,d=Hs(t,d));var m=n.getDerivedStateFromProps,y=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";y||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Of(t,a,r,d),Sr=!1;var g=t.memoizedState;a.state=g,La(t,r,a,s),u=t.memoizedState,c!==r||g!==u||Xt.current||Sr?(typeof m=="function"&&(Bc(t,n,m,r),u=t.memoizedState),(c=Sr||Ff(t,n,c,r,g,u,d))?(y||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=d,r=c):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,um(e,t),c=t.memoizedProps,d=t.type===t.elementType?c:Cn(t.type,c),a.props=d,y=t.pendingProps,g=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=yn(u):(u=Jt(n)?os:Ot.current,u=Hs(t,u));var v=n.getDerivedStateFromProps;(m=typeof v=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==y||g!==u)&&Of(t,a,r,u),Sr=!1,g=t.memoizedState,a.state=g,La(t,r,a,s);var w=t.memoizedState;c!==y||g!==w||Xt.current||Sr?(typeof v=="function"&&(Bc(t,n,v,r),w=t.memoizedState),(d=Sr||Ff(t,n,d,r,g,w,u)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,w,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,w,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),a.props=r,a.state=w,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),r=!1)}return Hc(e,t,n,r,i,s)}function Hc(e,t,n,r,s,i){$m(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&zf(t,n,!1),ur(e,t,i);r=t.stateNode,Ox.current=t;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Ks(t,e.child,null,i),t.child=Ks(t,null,c,i)):Vt(e,t,c,i),t.memoizedState=r.state,s&&zf(t,n,!0),t.child}function Mm(e){var t=e.stateNode;t.pendingContext?Pf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Pf(e,t.context,!1),Yu(e,t.containerInfo)}function Gf(e,t,n,r,s){return Gs(),Uu(s),t.flags|=256,Vt(e,t,n,r),t.child}var Gc={dehydrated:null,treeContext:null,retryLane:0};function Kc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fm(e,t,n){var r=t.pendingProps,s=ut.current,i=!1,a=(t.flags&128)!==0,c;if((c=a)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),nt(ut,s&1),e===null)return Oc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=ao(a,r,0,null),e=as(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Kc(n),t.memoizedState=Gc,e):nd(t,a));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return Dx(e,t,a,r,c,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Ir(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Ir(c,i):(i=as(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Kc(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Gc,r}return i=e.child,e=i.sibling,r=Ir(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function nd(e,t){return t=ao({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wi(e,t,n,r){return r!==null&&Uu(r),Ks(t,e.child,null,n),e=nd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Dx(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Zo(Error(ee(422))),Wi(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=ao({mode:"visible",children:r.children},s,0,null),i=as(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ks(t,e.child,null,a),t.child.memoizedState=Kc(a),t.memoizedState=Gc,i);if(!(t.mode&1))return Wi(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(ee(419)),r=Zo(i,r,void 0),Wi(e,t,a,r)}if(c=(a&e.childLanes)!==0,qt||c){if(r=_t,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,cr(e,s),Pn(r,e,s,-1))}return od(),r=Zo(Error(ee(421))),Wi(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Zx.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,rn=zr(s.nextSibling),sn=t,ot=!0,bn=null,e!==null&&(pn[hn++]=rr,pn[hn++]=sr,pn[hn++]=cs,rr=e.id,sr=e.overflow,cs=t),t=nd(t,r.children),t.flags|=4096,t)}function Kf(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Dc(e.return,t,n)}function ec(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Om(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Vt(e,t,r.children,n),r=ut.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Kf(e,n,t);else if(e.tag===19)Kf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(nt(ut,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Pa(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),ec(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Pa(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}ec(t,!0,n,null,i);break;case"together":ec(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function aa(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ur(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ds|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ee(153));if(t.child!==null){for(e=t.child,n=Ir(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ir(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Bx(e,t,n){switch(t.tag){case 3:Mm(t),Gs();break;case 5:dm(t);break;case 1:Jt(t.type)&&ka(t);break;case 4:Yu(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;nt(ba,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(nt(ut,ut.current&1),t.flags|=128,null):n&t.child.childLanes?Fm(e,t,n):(nt(ut,ut.current&1),e=ur(e,t,n),e!==null?e.sibling:null);nt(ut,ut.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Om(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),nt(ut,ut.current),r)break;return null;case 22:case 23:return t.lanes=0,Tm(e,t,n)}return ur(e,t,n)}var Dm,Yc,Bm,Um;Dm=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Yc=function(){};Bm=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ss(Yn.current);var i=null;switch(n){case"input":s=gc(e,s),r=gc(e,r),i=[];break;case"select":s=pt({},s,{value:void 0}),r=pt({},r,{value:void 0}),i=[];break;case"textarea":s=xc(e,s),r=xc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Sa)}Sc(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Yl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Yl.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&rt("scroll",e),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Um=function(e,t,n,r){n!==r&&(t.flags|=4)};function El(e,t){if(!ot)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Mt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ux(e,t,n){var r=t.pendingProps;switch(Bu(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(t),null;case 1:return Jt(t.type)&&ja(),Mt(t),null;case 3:return r=t.stateNode,Ys(),st(Xt),st(Ot),qu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ui(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,bn!==null&&(nu(bn),bn=null))),Yc(e,t),Mt(t),null;case 5:Qu(t);var s=ss(ii.current);if(n=t.type,e!==null&&t.stateNode!=null)Bm(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ee(166));return Mt(t),null}if(e=ss(Yn.current),Ui(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Bn]=t,r[si]=i,e=(t.mode&1)!==0,n){case"dialog":rt("cancel",r),rt("close",r);break;case"iframe":case"object":case"embed":rt("load",r);break;case"video":case"audio":for(s=0;s<Al.length;s++)rt(Al[s],r);break;case"source":rt("error",r);break;case"img":case"image":case"link":rt("error",r),rt("load",r);break;case"details":rt("toggle",r);break;case"input":tf(r,i),rt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},rt("invalid",r);break;case"textarea":rf(r,i),rt("invalid",r)}Sc(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var c=i[a];a==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&Bi(r.textContent,c,e),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Bi(r.textContent,c,e),s=["children",""+c]):Yl.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&rt("scroll",r)}switch(n){case"input":Ai(r),nf(r,i,!0);break;case"textarea":Ai(r),sf(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Sa)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=gh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Bn]=t,e[si]=r,Dm(e,t,!1,!1),t.stateNode=e;e:{switch(a=jc(n,r),n){case"dialog":rt("cancel",e),rt("close",e),s=r;break;case"iframe":case"object":case"embed":rt("load",e),s=r;break;case"video":case"audio":for(s=0;s<Al.length;s++)rt(Al[s],e);s=r;break;case"source":rt("error",e),s=r;break;case"img":case"image":case"link":rt("error",e),rt("load",e),s=r;break;case"details":rt("toggle",e),s=r;break;case"input":tf(e,r),s=gc(e,r),rt("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=pt({},r,{value:void 0}),rt("invalid",e);break;case"textarea":rf(e,r),s=xc(e,r),rt("invalid",e);break;default:s=r}Sc(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?xh(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&yh(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ql(e,u):typeof u=="number"&&Ql(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Yl.hasOwnProperty(i)?u!=null&&i==="onScroll"&&rt("scroll",e):u!=null&&bu(e,i,u,a))}switch(n){case"input":Ai(e),nf(e,r,!1);break;case"textarea":Ai(e),sf(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Mr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Ms(e,!!r.multiple,i,!1):r.defaultValue!=null&&Ms(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Sa)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Mt(t),null;case 6:if(e&&t.stateNode!=null)Um(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ee(166));if(n=ss(ii.current),ss(Yn.current),Ui(t)){if(r=t.stateNode,n=t.memoizedProps,r[Bn]=t,(i=r.nodeValue!==n)&&(e=sn,e!==null))switch(e.tag){case 3:Bi(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Bi(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Bn]=t,t.stateNode=r}return Mt(t),null;case 13:if(st(ut),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ot&&rn!==null&&t.mode&1&&!(t.flags&128))im(),Gs(),t.flags|=98560,i=!1;else if(i=Ui(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(ee(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ee(317));i[Bn]=t}else Gs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Mt(t),i=!1}else bn!==null&&(nu(bn),bn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||ut.current&1?bt===0&&(bt=3):od())),t.updateQueue!==null&&(t.flags|=4),Mt(t),null);case 4:return Ys(),Yc(e,t),e===null&&ni(t.stateNode.containerInfo),Mt(t),null;case 10:return Hu(t.type._context),Mt(t),null;case 17:return Jt(t.type)&&ja(),Mt(t),null;case 19:if(st(ut),i=t.memoizedState,i===null)return Mt(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)El(i,!1);else{if(bt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Pa(e),a!==null){for(t.flags|=128,El(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return nt(ut,ut.current&1|2),t.child}e=e.sibling}i.tail!==null&&wt()>qs&&(t.flags|=128,r=!0,El(i,!1),t.lanes=4194304)}else{if(!r)if(e=Pa(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),El(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!ot)return Mt(t),null}else 2*wt()-i.renderingStartTime>qs&&n!==1073741824&&(t.flags|=128,r=!0,El(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=wt(),t.sibling=null,n=ut.current,nt(ut,r?n&1|2:n&1),t):(Mt(t),null);case 22:case 23:return ad(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?nn&1073741824&&(Mt(t),t.subtreeFlags&6&&(t.flags|=8192)):Mt(t),null;case 24:return null;case 25:return null}throw Error(ee(156,t.tag))}function Vx(e,t){switch(Bu(t),t.tag){case 1:return Jt(t.type)&&ja(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ys(),st(Xt),st(Ot),qu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Qu(t),null;case 13:if(st(ut),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ee(340));Gs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return st(ut),null;case 4:return Ys(),null;case 10:return Hu(t.type._context),null;case 22:case 23:return ad(),null;case 24:return null;default:return null}}var Hi=!1,Ft=!1,Wx=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Ts(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){vt(e,t,r)}else n.current=null}function Qc(e,t,n){try{n()}catch(r){vt(e,t,r)}}var Yf=!1;function Hx(e,t){if(Rc=va,e=Kh(),Ou(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,c=-1,u=-1,d=0,m=0,y=e,g=null;t:for(;;){for(var v;y!==n||s!==0&&y.nodeType!==3||(c=a+s),y!==i||r!==0&&y.nodeType!==3||(u=a+r),y.nodeType===3&&(a+=y.nodeValue.length),(v=y.firstChild)!==null;)g=y,y=v;for(;;){if(y===e)break t;if(g===n&&++d===s&&(c=a),g===i&&++m===r&&(u=a),(v=y.nextSibling)!==null)break;y=g,g=y.parentNode}y=v}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ac={focusedElem:e,selectionRange:n},va=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var k=w.memoizedProps,j=w.memoizedState,h=t.stateNode,f=h.getSnapshotBeforeUpdate(t.elementType===t.type?k:Cn(t.type,k),j);h.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(x){vt(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return w=Yf,Yf=!1,w}function Ul(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Qc(t,n,i)}s=s.next}while(s!==r)}}function lo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function qc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Vm(e){var t=e.alternate;t!==null&&(e.alternate=null,Vm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Bn],delete t[si],delete t[$c],delete t[Ex],delete t[Lx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Wm(e){return e.tag===5||e.tag===3||e.tag===4}function Qf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Wm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Xc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Sa));else if(r!==4&&(e=e.child,e!==null))for(Xc(e,t,n),e=e.sibling;e!==null;)Xc(e,t,n),e=e.sibling}function Jc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Jc(e,t,n),e=e.sibling;e!==null;)Jc(e,t,n),e=e.sibling}var Rt=null,Nn=!1;function xr(e,t,n){for(n=n.child;n!==null;)Hm(e,t,n),n=n.sibling}function Hm(e,t,n){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(Xa,n)}catch{}switch(n.tag){case 5:Ft||Ts(n,t);case 6:var r=Rt,s=Nn;Rt=null,xr(e,t,n),Rt=r,Nn=s,Rt!==null&&(Nn?(e=Rt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Rt.removeChild(n.stateNode));break;case 18:Rt!==null&&(Nn?(e=Rt,n=n.stateNode,e.nodeType===8?Ko(e.parentNode,n):e.nodeType===1&&Ko(e,n),Zl(e)):Ko(Rt,n.stateNode));break;case 4:r=Rt,s=Nn,Rt=n.stateNode.containerInfo,Nn=!0,xr(e,t,n),Rt=r,Nn=s;break;case 0:case 11:case 14:case 15:if(!Ft&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Qc(n,t,a),s=s.next}while(s!==r)}xr(e,t,n);break;case 1:if(!Ft&&(Ts(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){vt(n,t,c)}xr(e,t,n);break;case 21:xr(e,t,n);break;case 22:n.mode&1?(Ft=(r=Ft)||n.memoizedState!==null,xr(e,t,n),Ft=r):xr(e,t,n);break;default:xr(e,t,n)}}function qf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Wx),t.forEach(function(r){var s=ew.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function jn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,c=a;e:for(;c!==null;){switch(c.tag){case 5:Rt=c.stateNode,Nn=!1;break e;case 3:Rt=c.stateNode.containerInfo,Nn=!0;break e;case 4:Rt=c.stateNode.containerInfo,Nn=!0;break e}c=c.return}if(Rt===null)throw Error(ee(160));Hm(i,a,s),Rt=null,Nn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){vt(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Gm(t,e),t=t.sibling}function Gm(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(jn(t,e),Fn(e),r&4){try{Ul(3,e,e.return),lo(3,e)}catch(k){vt(e,e.return,k)}try{Ul(5,e,e.return)}catch(k){vt(e,e.return,k)}}break;case 1:jn(t,e),Fn(e),r&512&&n!==null&&Ts(n,n.return);break;case 5:if(jn(t,e),Fn(e),r&512&&n!==null&&Ts(n,n.return),e.flags&32){var s=e.stateNode;try{Ql(s,"")}catch(k){vt(e,e.return,k)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&hh(s,i),jc(c,a);var d=jc(c,i);for(a=0;a<u.length;a+=2){var m=u[a],y=u[a+1];m==="style"?xh(s,y):m==="dangerouslySetInnerHTML"?yh(s,y):m==="children"?Ql(s,y):bu(s,m,y,d)}switch(c){case"input":yc(s,i);break;case"textarea":mh(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Ms(s,!!i.multiple,v,!1):g!==!!i.multiple&&(i.defaultValue!=null?Ms(s,!!i.multiple,i.defaultValue,!0):Ms(s,!!i.multiple,i.multiple?[]:"",!1))}s[si]=i}catch(k){vt(e,e.return,k)}}break;case 6:if(jn(t,e),Fn(e),r&4){if(e.stateNode===null)throw Error(ee(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(k){vt(e,e.return,k)}}break;case 3:if(jn(t,e),Fn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Zl(t.containerInfo)}catch(k){vt(e,e.return,k)}break;case 4:jn(t,e),Fn(e);break;case 13:jn(t,e),Fn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(ld=wt())),r&4&&qf(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(Ft=(d=Ft)||m,jn(t,e),Ft=d):jn(t,e),Fn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!m&&e.mode&1)for(xe=e,m=e.child;m!==null;){for(y=xe=m;xe!==null;){switch(g=xe,v=g.child,g.tag){case 0:case 11:case 14:case 15:Ul(4,g,g.return);break;case 1:Ts(g,g.return);var w=g.stateNode;if(typeof w.componentWillUnmount=="function"){r=g,n=g.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(k){vt(r,n,k)}}break;case 5:Ts(g,g.return);break;case 22:if(g.memoizedState!==null){Jf(y);continue}}v!==null?(v.return=g,xe=v):Jf(y)}m=m.sibling}e:for(m=null,y=e;;){if(y.tag===5){if(m===null){m=y;try{s=y.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=y.stateNode,u=y.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=vh("display",a))}catch(k){vt(e,e.return,k)}}}else if(y.tag===6){if(m===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(k){vt(e,e.return,k)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===e)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===e)break e;for(;y.sibling===null;){if(y.return===null||y.return===e)break e;m===y&&(m=null),y=y.return}m===y&&(m=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:jn(t,e),Fn(e),r&4&&qf(e);break;case 21:break;default:jn(t,e),Fn(e)}}function Fn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Wm(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ql(s,""),r.flags&=-33);var i=Qf(e);Jc(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=Qf(e);Xc(e,c,a);break;default:throw Error(ee(161))}}catch(u){vt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Gx(e,t,n){xe=e,Km(e)}function Km(e,t,n){for(var r=(e.mode&1)!==0;xe!==null;){var s=xe,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Hi;if(!a){var c=s.alternate,u=c!==null&&c.memoizedState!==null||Ft;c=Hi;var d=Ft;if(Hi=a,(Ft=u)&&!d)for(xe=s;xe!==null;)a=xe,u=a.child,a.tag===22&&a.memoizedState!==null?Zf(s):u!==null?(u.return=a,xe=u):Zf(s);for(;i!==null;)xe=i,Km(i),i=i.sibling;xe=s,Hi=c,Ft=d}Xf(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,xe=i):Xf(e)}}function Xf(e){for(;xe!==null;){var t=xe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ft||lo(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ft)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Cn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Tf(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Tf(t,a,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var y=m.dehydrated;y!==null&&Zl(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Ft||t.flags&512&&qc(t)}catch(g){vt(t,t.return,g)}}if(t===e){xe=null;break}if(n=t.sibling,n!==null){n.return=t.return,xe=n;break}xe=t.return}}function Jf(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,xe=n;break}xe=t.return}}function Zf(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{lo(4,t)}catch(u){vt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){vt(t,s,u)}}var i=t.return;try{qc(t)}catch(u){vt(t,i,u)}break;case 5:var a=t.return;try{qc(t)}catch(u){vt(t,a,u)}}}catch(u){vt(t,t.return,u)}if(t===e){xe=null;break}var c=t.sibling;if(c!==null){c.return=t.return,xe=c;break}xe=t.return}}var Kx=Math.ceil,Ra=fr.ReactCurrentDispatcher,rd=fr.ReactCurrentOwner,gn=fr.ReactCurrentBatchConfig,Ge=0,_t=null,St=null,At=0,nn=0,$s=Br(0),bt=0,ui=null,ds=0,io=0,sd=0,Vl=null,Qt=null,ld=0,qs=1/0,er=null,Aa=!1,Zc=null,Rr=null,Gi=!1,Nr=null,Ia=0,Wl=0,eu=null,oa=-1,ca=0;function Wt(){return Ge&6?wt():oa!==-1?oa:oa=wt()}function Ar(e){return e.mode&1?Ge&2&&At!==0?At&-At:zx.transition!==null?(ca===0&&(ca=_h()),ca):(e=Ze,e!==0||(e=window.event,e=e===void 0?16:Fh(e.type)),e):1}function Pn(e,t,n,r){if(50<Wl)throw Wl=0,eu=null,Error(ee(185));gi(e,n,r),(!(Ge&2)||e!==_t)&&(e===_t&&(!(Ge&2)&&(io|=n),bt===4&&kr(e,At)),Zt(e,r),n===1&&Ge===0&&!(t.mode&1)&&(qs=wt()+500,no&&Ur()))}function Zt(e,t){var n=e.callbackNode;zv(e,t);var r=ya(e,e===_t?At:0);if(r===0)n!==null&&of(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&of(n),t===1)e.tag===0?Px(ep.bind(null,e)):rm(ep.bind(null,e)),Nx(function(){!(Ge&6)&&Ur()}),n=null;else{switch(Rh(r)){case 1:n=_u;break;case 4:n=Ph;break;case 16:n=ga;break;case 536870912:n=zh;break;default:n=ga}n=tg(n,Ym.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ym(e,t){if(oa=-1,ca=0,Ge&6)throw Error(ee(327));var n=e.callbackNode;if(Us()&&e.callbackNode!==n)return null;var r=ya(e,e===_t?At:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ta(e,r);else{t=r;var s=Ge;Ge|=2;var i=qm();(_t!==e||At!==t)&&(er=null,qs=wt()+500,is(e,t));do try{qx();break}catch(c){Qm(e,c)}while(!0);Wu(),Ra.current=i,Ge=s,St!==null?t=0:(_t=null,At=0,t=bt)}if(t!==0){if(t===2&&(s=Ec(e),s!==0&&(r=s,t=tu(e,s))),t===1)throw n=ui,is(e,0),kr(e,r),Zt(e,wt()),n;if(t===6)kr(e,r);else{if(s=e.current.alternate,!(r&30)&&!Yx(s)&&(t=Ta(e,r),t===2&&(i=Ec(e),i!==0&&(r=i,t=tu(e,i))),t===1))throw n=ui,is(e,0),kr(e,r),Zt(e,wt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(ee(345));case 2:es(e,Qt,er);break;case 3:if(kr(e,r),(r&130023424)===r&&(t=ld+500-wt(),10<t)){if(ya(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Wt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Tc(es.bind(null,e,Qt,er),t);break}es(e,Qt,er);break;case 4:if(kr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Ln(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=wt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Kx(r/1960))-r,10<r){e.timeoutHandle=Tc(es.bind(null,e,Qt,er),r);break}es(e,Qt,er);break;case 5:es(e,Qt,er);break;default:throw Error(ee(329))}}}return Zt(e,wt()),e.callbackNode===n?Ym.bind(null,e):null}function tu(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(is(e,t).flags|=256),e=Ta(e,t),e!==2&&(t=Qt,Qt=n,t!==null&&nu(t)),e}function nu(e){Qt===null?Qt=e:Qt.push.apply(Qt,e)}function Yx(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!_n(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function kr(e,t){for(t&=~sd,t&=~io,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ln(t),r=1<<n;e[n]=-1,t&=~r}}function ep(e){if(Ge&6)throw Error(ee(327));Us();var t=ya(e,0);if(!(t&1))return Zt(e,wt()),null;var n=Ta(e,t);if(e.tag!==0&&n===2){var r=Ec(e);r!==0&&(t=r,n=tu(e,r))}if(n===1)throw n=ui,is(e,0),kr(e,t),Zt(e,wt()),n;if(n===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,es(e,Qt,er),Zt(e,wt()),null}function id(e,t){var n=Ge;Ge|=1;try{return e(t)}finally{Ge=n,Ge===0&&(qs=wt()+500,no&&Ur())}}function fs(e){Nr!==null&&Nr.tag===0&&!(Ge&6)&&Us();var t=Ge;Ge|=1;var n=gn.transition,r=Ze;try{if(gn.transition=null,Ze=1,e)return e()}finally{Ze=r,gn.transition=n,Ge=t,!(Ge&6)&&Ur()}}function ad(){nn=$s.current,st($s)}function is(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Cx(n)),St!==null)for(n=St.return;n!==null;){var r=n;switch(Bu(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ja();break;case 3:Ys(),st(Xt),st(Ot),qu();break;case 5:Qu(r);break;case 4:Ys();break;case 13:st(ut);break;case 19:st(ut);break;case 10:Hu(r.type._context);break;case 22:case 23:ad()}n=n.return}if(_t=e,St=e=Ir(e.current,null),At=nn=t,bt=0,ui=null,sd=io=ds=0,Qt=Vl=null,rs!==null){for(t=0;t<rs.length;t++)if(n=rs[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}rs=null}return e}function Qm(e,t){do{var n=St;try{if(Wu(),la.current=_a,za){for(var r=dt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}za=!1}if(us=0,zt=Nt=dt=null,Bl=!1,ai=0,rd.current=null,n===null||n.return===null){bt=1,ui=t,St=null;break}e:{var i=e,a=n.return,c=n,u=t;if(t=At,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=c,y=m.tag;if(!(m.mode&1)&&(y===0||y===11||y===15)){var g=m.alternate;g?(m.updateQueue=g.updateQueue,m.memoizedState=g.memoizedState,m.lanes=g.lanes):(m.updateQueue=null,m.memoizedState=null)}var v=Bf(a);if(v!==null){v.flags&=-257,Uf(v,a,c,i,t),v.mode&1&&Df(i,d,t),t=v,u=d;var w=t.updateQueue;if(w===null){var k=new Set;k.add(u),t.updateQueue=k}else w.add(u);break e}else{if(!(t&1)){Df(i,d,t),od();break e}u=Error(ee(426))}}else if(ot&&c.mode&1){var j=Bf(a);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Uf(j,a,c,i,t),Uu(Qs(u,c));break e}}i=u=Qs(u,c),bt!==4&&(bt=2),Vl===null?Vl=[i]:Vl.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var h=Rm(i,u,t);If(i,h);break e;case 1:c=u;var f=i.type,p=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Rr===null||!Rr.has(p)))){i.flags|=65536,t&=-t,i.lanes|=t;var x=Am(i,c,t);If(i,x);break e}}i=i.return}while(i!==null)}Jm(n)}catch(b){t=b,St===n&&n!==null&&(St=n=n.return);continue}break}while(!0)}function qm(){var e=Ra.current;return Ra.current=_a,e===null?_a:e}function od(){(bt===0||bt===3||bt===2)&&(bt=4),_t===null||!(ds&268435455)&&!(io&268435455)||kr(_t,At)}function Ta(e,t){var n=Ge;Ge|=2;var r=qm();(_t!==e||At!==t)&&(er=null,is(e,t));do try{Qx();break}catch(s){Qm(e,s)}while(!0);if(Wu(),Ge=n,Ra.current=r,St!==null)throw Error(ee(261));return _t=null,At=0,bt}function Qx(){for(;St!==null;)Xm(St)}function qx(){for(;St!==null&&!Sv();)Xm(St)}function Xm(e){var t=eg(e.alternate,e,nn);e.memoizedProps=e.pendingProps,t===null?Jm(e):St=t,rd.current=null}function Jm(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Vx(n,t),n!==null){n.flags&=32767,St=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{bt=6,St=null;return}}else if(n=Ux(n,t,nn),n!==null){St=n;return}if(t=t.sibling,t!==null){St=t;return}St=t=e}while(t!==null);bt===0&&(bt=5)}function es(e,t,n){var r=Ze,s=gn.transition;try{gn.transition=null,Ze=1,Xx(e,t,n,r)}finally{gn.transition=s,Ze=r}return null}function Xx(e,t,n,r){do Us();while(Nr!==null);if(Ge&6)throw Error(ee(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(_v(e,i),e===_t&&(St=_t=null,At=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Gi||(Gi=!0,tg(ga,function(){return Us(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=gn.transition,gn.transition=null;var a=Ze;Ze=1;var c=Ge;Ge|=4,rd.current=null,Hx(e,n),Gm(n,e),yx(Ac),va=!!Rc,Ac=Rc=null,e.current=n,Gx(n),jv(),Ge=c,Ze=a,gn.transition=i}else e.current=n;if(Gi&&(Gi=!1,Nr=e,Ia=s),i=e.pendingLanes,i===0&&(Rr=null),Nv(n.stateNode),Zt(e,wt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Aa)throw Aa=!1,e=Zc,Zc=null,e;return Ia&1&&e.tag!==0&&Us(),i=e.pendingLanes,i&1?e===eu?Wl++:(Wl=0,eu=e):Wl=0,Ur(),null}function Us(){if(Nr!==null){var e=Rh(Ia),t=gn.transition,n=Ze;try{if(gn.transition=null,Ze=16>e?16:e,Nr===null)var r=!1;else{if(e=Nr,Nr=null,Ia=0,Ge&6)throw Error(ee(331));var s=Ge;for(Ge|=4,xe=e.current;xe!==null;){var i=xe,a=i.child;if(xe.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(xe=d;xe!==null;){var m=xe;switch(m.tag){case 0:case 11:case 15:Ul(8,m,i)}var y=m.child;if(y!==null)y.return=m,xe=y;else for(;xe!==null;){m=xe;var g=m.sibling,v=m.return;if(Vm(m),m===d){xe=null;break}if(g!==null){g.return=v,xe=g;break}xe=v}}}var w=i.alternate;if(w!==null){var k=w.child;if(k!==null){w.child=null;do{var j=k.sibling;k.sibling=null,k=j}while(k!==null)}}xe=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,xe=a;else e:for(;xe!==null;){if(i=xe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ul(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,xe=h;break e}xe=i.return}}var f=e.current;for(xe=f;xe!==null;){a=xe;var p=a.child;if(a.subtreeFlags&2064&&p!==null)p.return=a,xe=p;else e:for(a=f;xe!==null;){if(c=xe,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:lo(9,c)}}catch(b){vt(c,c.return,b)}if(c===a){xe=null;break e}var x=c.sibling;if(x!==null){x.return=c.return,xe=x;break e}xe=c.return}}if(Ge=s,Ur(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(Xa,e)}catch{}r=!0}return r}finally{Ze=n,gn.transition=t}}return!1}function tp(e,t,n){t=Qs(n,t),t=Rm(e,t,1),e=_r(e,t,1),t=Wt(),e!==null&&(gi(e,1,t),Zt(e,t))}function vt(e,t,n){if(e.tag===3)tp(e,e,n);else for(;t!==null;){if(t.tag===3){tp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rr===null||!Rr.has(r))){e=Qs(n,e),e=Am(t,e,1),t=_r(t,e,1),e=Wt(),t!==null&&(gi(t,1,e),Zt(t,e));break}}t=t.return}}function Jx(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Wt(),e.pingedLanes|=e.suspendedLanes&n,_t===e&&(At&n)===n&&(bt===4||bt===3&&(At&130023424)===At&&500>wt()-ld?is(e,0):sd|=n),Zt(e,t)}function Zm(e,t){t===0&&(e.mode&1?(t=$i,$i<<=1,!($i&130023424)&&($i=4194304)):t=1);var n=Wt();e=cr(e,t),e!==null&&(gi(e,t,n),Zt(e,n))}function Zx(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Zm(e,n)}function ew(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(t),Zm(e,n)}var eg;eg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xt.current)qt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return qt=!1,Bx(e,t,n);qt=!!(e.flags&131072)}else qt=!1,ot&&t.flags&1048576&&sm(t,Na,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;aa(e,t),e=t.pendingProps;var s=Hs(t,Ot.current);Bs(t,n),s=Ju(null,t,r,e,s,n);var i=Zu();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Jt(r)?(i=!0,ka(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ku(t),s.updater=so,t.stateNode=s,s._reactInternals=t,Uc(t,r,e,n),t=Hc(null,t,r,!0,i,n)):(t.tag=0,ot&&i&&Du(t),Vt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(aa(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=nw(r),e=Cn(r,e),s){case 0:t=Wc(null,t,r,e,n);break e;case 1:t=Hf(null,t,r,e,n);break e;case 11:t=Vf(null,t,r,e,n);break e;case 14:t=Wf(null,t,r,Cn(r.type,e),n);break e}throw Error(ee(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Cn(r,s),Wc(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Cn(r,s),Hf(e,t,r,s,n);case 3:e:{if(Mm(t),e===null)throw Error(ee(387));r=t.pendingProps,i=t.memoizedState,s=i.element,um(e,t),La(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Qs(Error(ee(423)),t),t=Gf(e,t,r,n,s);break e}else if(r!==s){s=Qs(Error(ee(424)),t),t=Gf(e,t,r,n,s);break e}else for(rn=zr(t.stateNode.containerInfo.firstChild),sn=t,ot=!0,bn=null,n=om(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gs(),r===s){t=ur(e,t,n);break e}Vt(e,t,r,n)}t=t.child}return t;case 5:return dm(t),e===null&&Oc(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,Ic(r,s)?a=null:i!==null&&Ic(r,i)&&(t.flags|=32),$m(e,t),Vt(e,t,a,n),t.child;case 6:return e===null&&Oc(t),null;case 13:return Fm(e,t,n);case 4:return Yu(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ks(t,null,r,n):Vt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Cn(r,s),Vf(e,t,r,s,n);case 7:return Vt(e,t,t.pendingProps,n),t.child;case 8:return Vt(e,t,t.pendingProps.children,n),t.child;case 12:return Vt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,nt(ba,r._currentValue),r._currentValue=a,i!==null)if(_n(i.value,a)){if(i.children===s.children&&!Xt.current){t=ur(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){a=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=lr(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Dc(i.return,n,t),c.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(ee(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Dc(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Vt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Bs(t,n),s=yn(s),r=r(s),t.flags|=1,Vt(e,t,r,n),t.child;case 14:return r=t.type,s=Cn(r,t.pendingProps),s=Cn(r.type,s),Wf(e,t,r,s,n);case 15:return Im(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Cn(r,s),aa(e,t),t.tag=1,Jt(r)?(e=!0,ka(t)):e=!1,Bs(t,n),_m(t,r,s),Uc(t,r,s,n),Hc(null,t,r,!0,e,n);case 19:return Om(e,t,n);case 22:return Tm(e,t,n)}throw Error(ee(156,t.tag))};function tg(e,t){return Lh(e,t)}function tw(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(e,t,n,r){return new tw(e,t,n,r)}function cd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function nw(e){if(typeof e=="function")return cd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Lu)return 11;if(e===Pu)return 14}return 2}function Ir(e,t){var n=e.alternate;return n===null?(n=mn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ua(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")cd(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case bs:return as(n.children,s,i,t);case Eu:a=8,s|=8;break;case fc:return e=mn(12,n,t,s|2),e.elementType=fc,e.lanes=i,e;case pc:return e=mn(13,n,t,s),e.elementType=pc,e.lanes=i,e;case hc:return e=mn(19,n,t,s),e.elementType=hc,e.lanes=i,e;case dh:return ao(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ch:a=10;break e;case uh:a=9;break e;case Lu:a=11;break e;case Pu:a=14;break e;case wr:a=16,r=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return t=mn(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function as(e,t,n,r){return e=mn(7,e,r,t),e.lanes=n,e}function ao(e,t,n,r){return e=mn(22,e,r,t),e.elementType=dh,e.lanes=n,e.stateNode={isHidden:!1},e}function tc(e,t,n){return e=mn(6,e,null,t),e.lanes=n,e}function nc(e,t,n){return t=mn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function rw(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$o(0),this.expirationTimes=$o(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$o(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ud(e,t,n,r,s,i,a,c,u){return e=new rw(e,t,n,c,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=mn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ku(i),e}function sw(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ns,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ng(e){if(!e)return Fr;e=e._reactInternals;e:{if(hs(e)!==e||e.tag!==1)throw Error(ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Jt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ee(171))}if(e.tag===1){var n=e.type;if(Jt(n))return nm(e,n,t)}return t}function rg(e,t,n,r,s,i,a,c,u){return e=ud(n,r,!0,e,s,i,a,c,u),e.context=ng(null),n=e.current,r=Wt(),s=Ar(n),i=lr(r,s),i.callback=t??null,_r(n,i,s),e.current.lanes=s,gi(e,s,r),Zt(e,r),e}function oo(e,t,n,r){var s=t.current,i=Wt(),a=Ar(s);return n=ng(n),t.context===null?t.context=n:t.pendingContext=n,t=lr(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=_r(s,t,a),e!==null&&(Pn(e,s,a,i),sa(e,s,a)),a}function $a(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function np(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function dd(e,t){np(e,t),(e=e.alternate)&&np(e,t)}function lw(){return null}var sg=typeof reportError=="function"?reportError:function(e){console.error(e)};function fd(e){this._internalRoot=e}co.prototype.render=fd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ee(409));oo(e,t,null,null)};co.prototype.unmount=fd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fs(function(){oo(null,e,null,null)}),t[or]=null}};function co(e){this._internalRoot=e}co.prototype.unstable_scheduleHydration=function(e){if(e){var t=Th();e={blockedOn:null,target:e,priority:t};for(var n=0;n<jr.length&&t!==0&&t<jr[n].priority;n++);jr.splice(n,0,e),n===0&&Mh(e)}};function pd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function uo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rp(){}function iw(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=$a(a);i.call(d)}}var a=rg(t,r,e,0,null,!1,!1,"",rp);return e._reactRootContainer=a,e[or]=a.current,ni(e.nodeType===8?e.parentNode:e),fs(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=$a(u);c.call(d)}}var u=ud(e,0,!1,null,null,!1,!1,"",rp);return e._reactRootContainer=u,e[or]=u.current,ni(e.nodeType===8?e.parentNode:e),fs(function(){oo(t,u,n,r)}),u}function fo(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var c=s;s=function(){var u=$a(a);c.call(u)}}oo(t,a,e,s)}else a=iw(n,t,e,s,r);return $a(a)}Ah=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Rl(t.pendingLanes);n!==0&&(Ru(t,n|1),Zt(t,wt()),!(Ge&6)&&(qs=wt()+500,Ur()))}break;case 13:fs(function(){var r=cr(e,1);if(r!==null){var s=Wt();Pn(r,e,1,s)}}),dd(e,1)}};Au=function(e){if(e.tag===13){var t=cr(e,134217728);if(t!==null){var n=Wt();Pn(t,e,134217728,n)}dd(e,134217728)}};Ih=function(e){if(e.tag===13){var t=Ar(e),n=cr(e,t);if(n!==null){var r=Wt();Pn(n,e,t,r)}dd(e,t)}};Th=function(){return Ze};$h=function(e,t){var n=Ze;try{return Ze=e,t()}finally{Ze=n}};Cc=function(e,t,n){switch(t){case"input":if(yc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=to(r);if(!s)throw Error(ee(90));ph(r),yc(r,s)}}}break;case"textarea":mh(e,n);break;case"select":t=n.value,t!=null&&Ms(e,!!n.multiple,t,!1)}};jh=id;kh=fs;var aw={usingClientEntryPoint:!1,Events:[vi,zs,to,wh,Sh,id]},Ll={findFiberByHostInstance:ns,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ow={bundleType:Ll.bundleType,version:Ll.version,rendererPackageName:Ll.rendererPackageName,rendererConfig:Ll.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bh(e),e===null?null:e.stateNode},findFiberByHostInstance:Ll.findFiberByHostInstance||lw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ki=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ki.isDisabled&&Ki.supportsFiber)try{Xa=Ki.inject(ow),Kn=Ki}catch{}}an.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aw;an.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pd(t))throw Error(ee(200));return sw(e,t,null,n)};an.createRoot=function(e,t){if(!pd(e))throw Error(ee(299));var n=!1,r="",s=sg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=ud(e,1,!1,null,null,n,!1,r,s),e[or]=t.current,ni(e.nodeType===8?e.parentNode:e),new fd(t)};an.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=bh(t),e=e===null?null:e.stateNode,e};an.flushSync=function(e){return fs(e)};an.hydrate=function(e,t,n){if(!uo(t))throw Error(ee(200));return fo(null,e,t,!0,n)};an.hydrateRoot=function(e,t,n){if(!pd(e))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=sg;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=rg(t,null,e,1,n??null,s,!1,i,a),e[or]=t.current,ni(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new co(t)};an.render=function(e,t,n){if(!uo(t))throw Error(ee(200));return fo(null,e,t,!1,n)};an.unmountComponentAtNode=function(e){if(!uo(e))throw Error(ee(40));return e._reactRootContainer?(fs(function(){fo(null,null,e,!1,function(){e._reactRootContainer=null,e[or]=null})}),!0):!1};an.unstable_batchedUpdates=id;an.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!uo(n))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return fo(e,t,n,!1,r)};an.version="18.3.1-next-f1338f8080-20240426";function lg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lg)}catch(e){console.error(e)}}lg(),lh.exports=an;var hd=lh.exports,sp=hd;uc.createRoot=sp.createRoot,uc.hydrateRoot=sp.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function di(){return di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},di.apply(this,arguments)}var br;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(br||(br={}));const lp="popstate";function cw(e){e===void 0&&(e={});function t(s,i){let{pathname:a="/",search:c="",hash:u=""}=ms(s.location.hash.substr(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),ru("",{pathname:a,search:c,hash:u},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){let a=s.document.querySelector("base"),c="";if(a&&a.getAttribute("href")){let u=s.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof i=="string"?i:Ma(i))}function r(s,i){md(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return dw(t,n,r,e)}function ft(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function md(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function uw(){return Math.random().toString(36).substr(2,8)}function ip(e,t){return{usr:e.state,key:e.key,idx:t}}function ru(e,t,n,r){return n===void 0&&(n=null),di({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ms(t):t,{state:n,key:t&&t.key||r||uw()})}function Ma(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ms(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function dw(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,c=br.Pop,u=null,d=m();d==null&&(d=0,a.replaceState(di({},a.state,{idx:d}),""));function m(){return(a.state||{idx:null}).idx}function y(){c=br.Pop;let j=m(),h=j==null?null:j-d;d=j,u&&u({action:c,location:k.location,delta:h})}function g(j,h){c=br.Push;let f=ru(k.location,j,h);n&&n(f,j),d=m()+1;let p=ip(f,d),x=k.createHref(f);try{a.pushState(p,"",x)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;s.location.assign(x)}i&&u&&u({action:c,location:k.location,delta:1})}function v(j,h){c=br.Replace;let f=ru(k.location,j,h);n&&n(f,j),d=m();let p=ip(f,d),x=k.createHref(f);a.replaceState(p,"",x),i&&u&&u({action:c,location:k.location,delta:0})}function w(j){let h=s.location.origin!=="null"?s.location.origin:s.location.href,f=typeof j=="string"?j:Ma(j);return f=f.replace(/ $/,"%20"),ft(h,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,h)}let k={get action(){return c},get location(){return e(s,a)},listen(j){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(lp,y),u=j,()=>{s.removeEventListener(lp,y),u=null}},createHref(j){return t(s,j)},createURL:w,encodeLocation(j){let h=w(j);return{pathname:h.pathname,search:h.search,hash:h.hash}},push:g,replace:v,go(j){return a.go(j)}};return k}var ap;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ap||(ap={}));function fw(e,t,n){return n===void 0&&(n="/"),pw(e,t,n)}function pw(e,t,n,r){let s=typeof t=="string"?ms(t):t,i=Xs(s.pathname||"/",n);if(i==null)return null;let a=ig(e);hw(a);let c=null;for(let u=0;c==null&&u<a.length;++u){let d=Nw(i);c=kw(a[u],d)}return c}function ig(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,a,c)=>{let u={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(ft(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=Tr([r,u.relativePath]),m=n.concat(u);i.children&&i.children.length>0&&(ft(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),ig(i.children,t,m,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:Sw(d,i.index),routesMeta:m})};return e.forEach((i,a)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))s(i,a);else for(let u of ag(i.path))s(i,a,u)}),t}function ag(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=ag(r.join("/")),c=[];return c.push(...a.map(u=>u===""?i:[i,u].join("/"))),s&&c.push(...a),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function hw(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:jw(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const mw=/^:[\w-]+$/,gw=3,yw=2,vw=1,xw=10,ww=-2,op=e=>e==="*";function Sw(e,t){let n=e.split("/"),r=n.length;return n.some(op)&&(r+=ww),t&&(r+=yw),n.filter(s=>!op(s)).reduce((s,i)=>s+(mw.test(i)?gw:i===""?vw:xw),r)}function jw(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function kw(e,t,n){let{routesMeta:r}=e,s={},i="/",a=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,m=i==="/"?t:t.slice(i.length)||"/",y=su({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},m),g=u.route;if(!y)return null;Object.assign(s,y.params),a.push({params:s,pathname:Tr([i,y.pathname]),pathnameBase:Pw(Tr([i,y.pathnameBase])),route:g}),y.pathnameBase!=="/"&&(i=Tr([i,y.pathnameBase]))}return a}function su(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Cw(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((d,m,y)=>{let{paramName:g,isOptional:v}=m;if(g==="*"){let k=c[y]||"";a=i.slice(0,i.length-k.length).replace(/(.)\/+$/,"$1")}const w=c[y];return v&&!w?d[g]=void 0:d[g]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:a,pattern:e}}function Cw(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),md(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function Nw(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return md(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Xs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function bw(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?ms(e):e;return{pathname:n?n.startsWith("/")?n:Ew(n,t):t,search:zw(r),hash:_w(s)}}function Ew(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function rc(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Lw(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function gd(e,t){let n=Lw(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function yd(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=ms(e):(s=di({},e),ft(!s.pathname||!s.pathname.includes("?"),rc("?","pathname","search",s)),ft(!s.pathname||!s.pathname.includes("#"),rc("#","pathname","hash",s)),ft(!s.search||!s.search.includes("#"),rc("#","search","hash",s)));let i=e===""||s.pathname==="",a=i?"/":s.pathname,c;if(a==null)c=n;else{let y=t.length-1;if(!r&&a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),y-=1;s.pathname=g.join("/")}c=y>=0?t[y]:"/"}let u=bw(s,c),d=a&&a!=="/"&&a.endsWith("/"),m=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||m)&&(u.pathname+="/"),u}const Tr=e=>e.join("/").replace(/\/\/+/g,"/"),Pw=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),zw=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,_w=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Rw(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const og=["post","put","patch","delete"];new Set(og);const Aw=["get",...og];new Set(Aw);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fi(){return fi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fi.apply(this,arguments)}const po=o.createContext(null),cg=o.createContext(null),pr=o.createContext(null),ho=o.createContext(null),hr=o.createContext({outlet:null,matches:[],isDataRoute:!1}),ug=o.createContext(null);function Iw(e,t){let{relative:n}=t===void 0?{}:t;rl()||ft(!1);let{basename:r,navigator:s}=o.useContext(pr),{hash:i,pathname:a,search:c}=mo(e,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:Tr([r,a])),s.createHref({pathname:u,search:c,hash:i})}function rl(){return o.useContext(ho)!=null}function cn(){return rl()||ft(!1),o.useContext(ho).location}function dg(e){o.useContext(pr).static||o.useLayoutEffect(e)}function qn(){let{isDataRoute:e}=o.useContext(hr);return e?Qw():Tw()}function Tw(){rl()||ft(!1);let e=o.useContext(po),{basename:t,future:n,navigator:r}=o.useContext(pr),{matches:s}=o.useContext(hr),{pathname:i}=cn(),a=JSON.stringify(gd(s,n.v7_relativeSplatPath)),c=o.useRef(!1);return dg(()=>{c.current=!0}),o.useCallback(function(d,m){if(m===void 0&&(m={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let y=yd(d,JSON.parse(a),i,m.relative==="path");e==null&&t!=="/"&&(y.pathname=y.pathname==="/"?t:Tr([t,y.pathname])),(m.replace?r.replace:r.push)(y,m.state,m)},[t,r,a,i,e])}const $w=o.createContext(null);function Mw(e){let t=o.useContext(hr).outlet;return t&&o.createElement($w.Provider,{value:e},t)}function mo(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=o.useContext(pr),{matches:s}=o.useContext(hr),{pathname:i}=cn(),a=JSON.stringify(gd(s,r.v7_relativeSplatPath));return o.useMemo(()=>yd(e,JSON.parse(a),i,n==="path"),[e,a,i,n])}function Fw(e,t){return Ow(e,t)}function Ow(e,t,n,r){rl()||ft(!1);let{navigator:s}=o.useContext(pr),{matches:i}=o.useContext(hr),a=i[i.length-1],c=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let d=cn(),m;if(t){var y;let j=typeof t=="string"?ms(t):t;u==="/"||(y=j.pathname)!=null&&y.startsWith(u)||ft(!1),m=j}else m=d;let g=m.pathname||"/",v=g;if(u!=="/"){let j=u.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(j.length).join("/")}let w=fw(e,{pathname:v}),k=Ww(w&&w.map(j=>Object.assign({},j,{params:Object.assign({},c,j.params),pathname:Tr([u,s.encodeLocation?s.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?u:Tr([u,s.encodeLocation?s.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),i,n,r);return t&&k?o.createElement(ho.Provider,{value:{location:fi({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:br.Pop}},k):k}function Dw(){let e=Yw(),t=Rw(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return o.createElement(o.Fragment,null,o.createElement("h2",null,"Unexpected Application Error!"),o.createElement("h3",{style:{fontStyle:"italic"}},t),n?o.createElement("pre",{style:s},n):null,null)}const Bw=o.createElement(Dw,null);class Uw extends o.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?o.createElement(hr.Provider,{value:this.props.routeContext},o.createElement(ug.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Vw(e){let{routeContext:t,match:n,children:r}=e,s=o.useContext(po);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),o.createElement(hr.Provider,{value:t},r)}function Ww(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,c=(s=n)==null?void 0:s.errors;if(c!=null){let m=a.findIndex(y=>y.route.id&&(c==null?void 0:c[y.route.id])!==void 0);m>=0||ft(!1),a=a.slice(0,Math.min(a.length,m+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<a.length;m++){let y=a[m];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=m),y.route.id){let{loaderData:g,errors:v}=n,w=y.route.loader&&g[y.route.id]===void 0&&(!v||v[y.route.id]===void 0);if(y.route.lazy||w){u=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((m,y,g)=>{let v,w=!1,k=null,j=null;n&&(v=c&&y.route.id?c[y.route.id]:void 0,k=y.route.errorElement||Bw,u&&(d<0&&g===0?(qw("route-fallback"),w=!0,j=null):d===g&&(w=!0,j=y.route.hydrateFallbackElement||null)));let h=t.concat(a.slice(0,g+1)),f=()=>{let p;return v?p=k:w?p=j:y.route.Component?p=o.createElement(y.route.Component,null):y.route.element?p=y.route.element:p=m,o.createElement(Vw,{match:y,routeContext:{outlet:m,matches:h,isDataRoute:n!=null},children:p})};return n&&(y.route.ErrorBoundary||y.route.errorElement||g===0)?o.createElement(Uw,{location:n.location,revalidation:n.revalidation,component:k,error:v,children:f(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):f()},null)}var fg=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(fg||{}),pg=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(pg||{});function Hw(e){let t=o.useContext(po);return t||ft(!1),t}function Gw(e){let t=o.useContext(cg);return t||ft(!1),t}function Kw(e){let t=o.useContext(hr);return t||ft(!1),t}function hg(e){let t=Kw(),n=t.matches[t.matches.length-1];return n.route.id||ft(!1),n.route.id}function Yw(){var e;let t=o.useContext(ug),n=Gw(),r=hg();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function Qw(){let{router:e}=Hw(fg.UseNavigateStable),t=hg(pg.UseNavigateStable),n=o.useRef(!1);return dg(()=>{n.current=!0}),o.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,fi({fromRouteId:t},i)))},[e,t])}const cp={};function qw(e,t,n){cp[e]||(cp[e]=!0)}function Xw(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function lu(e){let{to:t,replace:n,state:r,relative:s}=e;rl()||ft(!1);let{future:i,static:a}=o.useContext(pr),{matches:c}=o.useContext(hr),{pathname:u}=cn(),d=qn(),m=yd(t,gd(c,i.v7_relativeSplatPath),u,s==="path"),y=JSON.stringify(m);return o.useEffect(()=>d(JSON.parse(y),{replace:n,state:r,relative:s}),[d,y,s,n,r]),null}function Jw(e){return Mw(e.context)}function kn(e){ft(!1)}function Zw(e){let{basename:t="/",children:n=null,location:r,navigationType:s=br.Pop,navigator:i,static:a=!1,future:c}=e;rl()&&ft(!1);let u=t.replace(/^\/*/,"/"),d=o.useMemo(()=>({basename:u,navigator:i,static:a,future:fi({v7_relativeSplatPath:!1},c)}),[u,c,i,a]);typeof r=="string"&&(r=ms(r));let{pathname:m="/",search:y="",hash:g="",state:v=null,key:w="default"}=r,k=o.useMemo(()=>{let j=Xs(m,u);return j==null?null:{location:{pathname:j,search:y,hash:g,state:v,key:w},navigationType:s}},[u,m,y,g,v,w,s]);return k==null?null:o.createElement(pr.Provider,{value:d},o.createElement(ho.Provider,{children:n,value:k}))}function e0(e){let{children:t,location:n}=e;return Fw(iu(t),n)}new Promise(()=>{});function iu(e,t){t===void 0&&(t=[]);let n=[];return o.Children.forEach(e,(r,s)=>{if(!o.isValidElement(r))return;let i=[...t,s];if(r.type===o.Fragment){n.push.apply(n,iu(r.props.children,i));return}r.type!==kn&&ft(!1),!r.props.index||!r.props.children||ft(!1);let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=iu(r.props.children,i)),n.push(a)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fa(){return Fa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fa.apply(this,arguments)}function mg(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function t0(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function n0(e,t){return e.button===0&&(!t||t==="_self")&&!t0(e)}function au(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function r0(e,t){let n=au(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(i=>{n.append(s,i)})}),n}const s0=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],l0=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],i0="6";try{window.__reactRouterVersion=i0}catch{}const a0=o.createContext({isTransitioning:!1}),o0="startTransition",up=Jy[o0];function c0(e){let{basename:t,children:n,future:r,window:s}=e,i=o.useRef();i.current==null&&(i.current=cw({window:s,v5Compat:!0}));let a=i.current,[c,u]=o.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},m=o.useCallback(y=>{d&&up?up(()=>u(y)):u(y)},[u,d]);return o.useLayoutEffect(()=>a.listen(m),[a,m]),o.useEffect(()=>Xw(r),[r]),o.createElement(Zw,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:a,future:r})}const u0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",d0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gg=o.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:i,replace:a,state:c,target:u,to:d,preventScrollReset:m,viewTransition:y}=t,g=mg(t,s0),{basename:v}=o.useContext(pr),w,k=!1;if(typeof d=="string"&&d0.test(d)&&(w=d,u0))try{let p=new URL(window.location.href),x=d.startsWith("//")?new URL(p.protocol+d):new URL(d),b=Xs(x.pathname,v);x.origin===p.origin&&b!=null?d=b+x.search+x.hash:k=!0}catch{}let j=Iw(d,{relative:s}),h=p0(d,{replace:a,state:c,target:u,preventScrollReset:m,relative:s,viewTransition:y});function f(p){r&&r(p),p.defaultPrevented||h(p)}return o.createElement("a",Fa({},g,{href:w||j,onClick:k||i?r:f,ref:n,target:u}))}),js=o.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:a=!1,style:c,to:u,viewTransition:d,children:m}=t,y=mg(t,l0),g=mo(u,{relative:y.relative}),v=cn(),w=o.useContext(cg),{navigator:k,basename:j}=o.useContext(pr),h=w!=null&&h0(g)&&d===!0,f=k.encodeLocation?k.encodeLocation(g).pathname:g.pathname,p=v.pathname,x=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;s||(p=p.toLowerCase(),x=x?x.toLowerCase():null,f=f.toLowerCase()),x&&j&&(x=Xs(x,j)||x);const b=f!=="/"&&f.endsWith("/")?f.length-1:f.length;let C=p===f||!a&&p.startsWith(f)&&p.charAt(b)==="/",z=x!=null&&(x===f||!a&&x.startsWith(f)&&x.charAt(f.length)==="/"),$={isActive:C,isPending:z,isTransitioning:h},O=C?r:void 0,R;typeof i=="function"?R=i($):R=[i,C?"active":null,z?"pending":null,h?"transitioning":null].filter(Boolean).join(" ");let I=typeof c=="function"?c($):c;return o.createElement(gg,Fa({},y,{"aria-current":O,className:R,ref:n,style:I,to:u,viewTransition:d}),typeof m=="function"?m($):m)});var ou;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(ou||(ou={}));var dp;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(dp||(dp={}));function f0(e){let t=o.useContext(po);return t||ft(!1),t}function p0(e,t){let{target:n,replace:r,state:s,preventScrollReset:i,relative:a,viewTransition:c}=t===void 0?{}:t,u=qn(),d=cn(),m=mo(e,{relative:a});return o.useCallback(y=>{if(n0(y,n)){y.preventDefault();let g=r!==void 0?r:Ma(d)===Ma(m);u(e,{replace:g,state:s,preventScrollReset:i,relative:a,viewTransition:c})}},[d,u,m,r,s,n,e,i,a,c])}function yg(e){let t=o.useRef(au(e)),n=o.useRef(!1),r=cn(),s=o.useMemo(()=>r0(r.search,n.current?null:t.current),[r.search]),i=qn(),a=o.useCallback((c,u)=>{const d=au(typeof c=="function"?c(s):c);n.current=!0,i("?"+d,u)},[i,s]);return[s,a]}function h0(e,t){t===void 0&&(t={});let n=o.useContext(a0);n==null&&ft(!1);let{basename:r}=f0(ou.useViewTransitionState),s=mo(e,{relative:t.relative});if(!n.isTransitioning)return!1;let i=Xs(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=Xs(n.nextLocation.pathname,r)||n.nextLocation.pathname;return su(s.pathname,a)!=null||su(s.pathname,i)!=null}function vg(){const[e,t]=o.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("cozygen_gallery_pending")==="1"}catch{return!1}});return o.useEffect(()=>{const n=()=>t(!0),r=()=>t(!1),s=i=>{i.key==="cozygen_gallery_pending"&&t(i.newValue==="1")};return window.addEventListener("cozygen:gallery-pending",n),window.addEventListener("cozygen:gallery-viewed",r),window.addEventListener("storage",s),()=>{window.removeEventListener("cozygen:gallery-pending",n),window.removeEventListener("cozygen:gallery-viewed",r),window.removeEventListener("storage",s)}},[]),e}const cu="cozygen_token",Oa="cozygen:auth-expired";function vd(){try{return typeof window>"u"?null:localStorage.getItem(cu)}catch{return null}}function xg(e){try{if(typeof window>"u")return;e?localStorage.setItem(cu,e):localStorage.removeItem(cu)}catch{}}function da(){xg(null)}function sl(){const e=vd();return e?{Authorization:`Bearer ${e}`}:{}}function m0(e={}){if(da(),!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent(Oa,{detail:e}))}catch{window.dispatchEvent(new Event(Oa))}}const wi=async(e,t)=>{if(t.status===401){m0({url:e,status:t.status});const r=new Error("unauthorized");throw r.unauthorized=!0,r.status=401,r}if(!t.ok)throw new Error(`${e} failed`);return(t.headers.get("content-type")||"").includes("application/json")?t.json():t.text()},Vr=async(e,t={})=>{const{signal:n}=t,r=await fetch(e,{headers:{...sl()},credentials:"include",signal:n});return wi(e,r)},gs=async(e,t,n={})=>{const{signal:r}=n,s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...sl()},body:JSON.stringify(t),credentials:"include",signal:r});return wi(e,s)};async function g0(e={}){return Vr("/cozygen/workflows",e)}async function y0(e,t={}){return Vr(`/cozygen/workflows/${encodeURIComponent(e)}`,t)}async function uu(e,t={}){const{refresh:n=!1,cacheBust:r="",...s}=t||{},i=new URLSearchParams({type:String(e||"")});return n&&i.set("refresh","1"),r&&i.set("cache_bust",String(r)),Vr(`/cozygen/get_choices?${i.toString()}`,s)}async function xd(e){const t=await fetch("/prompt",{method:"POST",headers:{"Content-Type":"application/json",...sl()},body:JSON.stringify(e),credentials:"include"});return wi("/prompt",t)}async function v0(e){const t=new FormData;t.append("image",e);const n=await fetch("/cozygen/upload_image",{method:"POST",headers:{...sl()},body:t,credentials:"include"});return wi("/cozygen/upload_image",n)}async function wg(e="",t=1,n=50,r=!1,s=!1,i="all",a="",c={}){const{includeMeta:u=!1,...d}=c||{},m=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),show_hidden:r?"1":"0",recursive:s?"1":"0",kind:i});return u&&m.set("include_meta","1"),a&&m.set("cache_bust",String(a)),Vr(`/cozygen/api/gallery?${m.toString()}`,d)}async function x0({filename:e="",subfolder:t=""}={},n={}){const r=new URLSearchParams({filename:String(e||""),subfolder:String(t||"")}),s=await fetch(`/cozygen/api/gallery/prompt?${r.toString()}`,{headers:{...sl()},credentials:"include",signal:n==null?void 0:n.signal}),a=(s.headers.get("content-type")||"").includes("application/json")?await s.json():await s.text();if(!s.ok){const c=new Error((a==null?void 0:a.error)||"Prompt metadata not found");throw c.status=s.status,c.payload=a,c}return a}async function Sg({filename:e="",subfolder:t=""}={},n={}){return gs("/cozygen/api/gallery/delete",{filename:e,subfolder:t},n)}async function w0(){return Vr("/cozygen/api/aliases")}async function S0(e){return gs("/cozygen/api/aliases",e||{})}async function wd(e={}){return Vr("/cozygen/api/tags/categories",e)}async function Js({q:e="",category:t="",sort:n="count",minCount:r=0,limit:s=80,offset:i=0}={},a={}){const c=Number.isFinite(Number(r))?Math.max(0,Number(r)):0,u=new URLSearchParams({q:String(e||""),category:String(t||""),sort:String(n||"count"),limit:String(s||80),offset:String(i||0)});return c>0&&u.set("min_count",String(c)),Vr(`/cozygen/api/tags/search?${u.toString()}`,a)}async function sc(e=[],t={}){return gs("/cozygen/api/tags/validate",{tags:Array.isArray(e)?e:[]},t)}async function j0(e,t={}){const n=new URLSearchParams;return e&&n.set("workflow",e),Vr(`/cozygen/api/workflow_presets?${n.toString()}`,t)}async function k0(e,t,n={}){return gs("/cozygen/api/workflow_presets",{workflow:e,preset:t},n)}async function C0(e,t,n={}){return gs("/cozygen/api/workflow_presets",{workflow:e,delete:t},n)}async function N0(e,t){return gs("/cozygen/api/login",{username:e,password:t})}async function b0(){return fetch("/cozygen/api/auth_status",{headers:{...sl()},credentials:"include"}).then(e=>wi("/cozygen/api/auth_status",e))}async function E0(){return gs("/cozygen/api/clear_cache",{})}const L0=30*60*1e3,fp="cozygen_idle_logout",jg=o.createContext(null);function P0({children:e}){const[t,n]=o.useState(!1),[r,s]=o.useState(null),[i,a]=o.useState(!1),c=o.useRef(null),u=o.useCallback(async()=>{if(!vd()){s(null),a(!1),n(!0);return}try{const v=await b0();s((v==null?void 0:v.user)||null),a(!!(v!=null&&v.default_credentials))}catch{da(),s(null),a(!1)}finally{n(!0)}},[]);o.useEffect(()=>{u()},[u]);const d=o.useCallback(async(g,v)=>{const w=await N0(g,v);xg((w==null?void 0:w.token)||""),s((w==null?void 0:w.user)||g),a(!!(w!=null&&w.default_credentials));try{localStorage.removeItem(fp)}catch{}return w},[]),m=o.useCallback(()=>{da(),s(null),a(!1)},[]);o.useEffect(()=>{if(typeof window>"u")return;const g=()=>{m(),n(!0)};return window.addEventListener(Oa,g),()=>window.removeEventListener(Oa,g)},[m]),o.useEffect(()=>{if(!t)return;const g=()=>{c.current&&clearTimeout(c.current);const w=setTimeout(()=>{da(),s(null),a(!1);try{localStorage.setItem(fp,"1")}catch{}window.location.hash="#/login"},L0);c.current=w};g();const v=["pointerdown","keydown","visibilitychange"];return v.forEach(w=>window.addEventListener(w,g,{passive:!0})),()=>{c.current&&(clearTimeout(c.current),c.current=null),v.forEach(w=>window.removeEventListener(w,g))}},[t]);const y=o.useMemo(()=>({ready:t,user:r,authed:!!r,defaultCreds:i,login:d,logout:m,refresh:u}),[t,r,i,d,m,u]);return l.jsx(jg.Provider,{value:y,children:e})}function go(){const e=o.useContext(jg);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function z0({children:e}){return l.jsx(P0,{children:e})}const kg="cozygen_last_render_payload";function Cg(e){if(e)try{if(typeof window>"u")return;window.localStorage.setItem(kg,JSON.stringify(e))}catch{}}function Ng(){try{if(typeof window>"u")return null;const e=window.localStorage.getItem(kg);return e?JSON.parse(e):null}catch{return null}}async function bg(){const e=Ng();if(!e||!e.workflow)return{success:!1,error:"No previous render to repeat"};try{return window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!0}})),await xd({prompt:e.workflow}),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),{success:!0}}catch(t){return console.error("Failed to requeue prompt",t),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),t!=null&&t.unauthorized?(window.location.hash="#/login",{success:!1,error:"Session expired"}):{success:!1,error:"Failed to queue prompt"}}}function Eg(){const e=Ng();return!!(e&&e.workflow)}function Sd(e,t=!1){const n=()=>typeof window>"u"||!window.matchMedia?t:window.matchMedia(e).matches,[r,s]=o.useState(n);return o.useEffect(()=>{if(typeof window>"u"||!window.matchMedia)return;const i=window.matchMedia(e),a=()=>s(i.matches);return a(),typeof i.addEventListener=="function"?(i.addEventListener("change",a),()=>i.removeEventListener("change",a)):(i.addListener(a),()=>i.removeListener(a))},[e]),r}const K=o.forwardRef(function({as:t,href:n,variant:r,size:s="md",iconOnly:i=!1,active:a=!1,pressed:c,className:u="",type:d,...m},y){const g=t||(n?"a":"button"),v=s==="lg"?"is-lg":s==="sm"?"is-compact":s==="xs"?"is-tiny":s==="mini"?"is-mini":s==="icon"?"is-icon":"",w=r?`is-${r}`:"",h=["ui-button",v,w,i?"is-icon":"",a?"is-active":"",u].filter(Boolean).join(" "),f={ref:y,className:h,"aria-pressed":c,...m};return g==="button"?l.jsx("button",{...f,type:d||"button"}):l.jsx(g,{...f,href:n})}),Lg=({size:e=32,className:t=""})=>l.jsxs("svg",{width:e,height:e,viewBox:"0 0 32 32",fill:"none",className:t,"aria-hidden":"true",children:[l.jsx("path",{d:"M8 24L20 4",stroke:"url(#logo-gradient)",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("path",{d:"M6 26C6 26 7 24 8 24C9 24 10 25 8 27C6 29 4 28 6 26Z",fill:"url(#logo-warm)"}),l.jsx("circle",{cx:"22",cy:"8",r:"2",fill:"url(#logo-spark)"}),l.jsx("circle",{cx:"26",cy:"12",r:"1.5",fill:"url(#logo-spark)",opacity:"0.8"}),l.jsx("circle",{cx:"24",cy:"16",r:"1",fill:"url(#logo-spark)",opacity:"0.6"}),l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"logo-gradient",x1:"8",y1:"24",x2:"20",y2:"4",gradientUnits:"userSpaceOnUse",children:[l.jsx("stop",{stopColor:"#FF9F7A"}),l.jsx("stop",{offset:"0.5",stopColor:"#9F8CFF"}),l.jsx("stop",{offset:"1",stopColor:"#44E1C5"})]}),l.jsxs("linearGradient",{id:"logo-warm",x1:"4",y1:"24",x2:"10",y2:"28",gradientUnits:"userSpaceOnUse",children:[l.jsx("stop",{stopColor:"#FF9F7A"}),l.jsx("stop",{offset:"1",stopColor:"#FFD666"})]}),l.jsxs("radialGradient",{id:"logo-spark",cx:"0.3",cy:"0.3",r:"0.7",children:[l.jsx("stop",{stopColor:"#FFFFFF"}),l.jsx("stop",{offset:"0.5",stopColor:"#44E1C5"}),l.jsx("stop",{offset:"1",stopColor:"#9F8CFF"})]})]})]}),lt=({children:e,size:t=16,className:n="",...r})=>l.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,"aria-hidden":"true",...r,children:e}),_0=e=>l.jsxs(lt,{...e,children:[l.jsx("path",{d:"M3 10l9-7 9 7"}),l.jsx("path",{d:"M5 10v10h14V10"}),l.jsx("path",{d:"M9 20v-6h6v6"})]}),jd=e=>l.jsxs(lt,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),l.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor",stroke:"none"}),l.jsx("path",{d:"M21 15l-5-5L5 21"})]}),dr=e=>l.jsxs(lt,{...e,children:[l.jsx("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"}),l.jsx("line",{x1:"7",y1:"7",x2:"7.01",y2:"7",strokeWidth:"3"})]}),ll=e=>l.jsxs(lt,{...e,children:[l.jsx("path",{d:"M14 3H4a2 2 0 00-2 2v10l6 6h10a2 2 0 002-2V9l-6-6z"}),l.jsx("path",{d:"M14 3v6h6"}),l.jsx("path",{d:"M7 7h5"}),l.jsx("path",{d:"M7 11h7"})]}),yo=e=>l.jsx(lt,{...e,children:l.jsx("path",{d:"M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"})}),Pg=e=>l.jsx(lt,{...e,children:l.jsx("polygon",{points:"5 3 19 12 5 21 5 3",fill:"currentColor",stroke:"none"})}),pp=e=>l.jsxs(lt,{...e,children:[l.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"}),l.jsx("polyline",{points:"16 17 21 12 16 7"}),l.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),kd=e=>l.jsxs(lt,{...e,children:[l.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),l.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),l.jsx("line",{x1:"15",y1:"9",x2:"15",y2:"15"}),l.jsx("circle",{cx:"9",cy:"12",r:"1.5",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"10",r:"1.5",fill:"currentColor",stroke:"none"})]}),R0=e=>l.jsxs(lt,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"4"}),l.jsx("line",{x1:"3",y1:"9",x2:"6",y2:"9"})]}),du=e=>l.jsxs(lt,{...e,children:[l.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"}),l.jsx("path",{d:"M2 10h20"})]}),hp=e=>l.jsx(lt,{...e,children:l.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"})}),mp=e=>l.jsxs(lt,{...e,children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),gp=e=>l.jsxs(lt,{...e,children:[l.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),yp=e=>l.jsx(lt,{...e,children:l.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),fu=e=>l.jsxs(lt,{...e,children:[l.jsx("path",{d:"M3 6h18"}),l.jsx("path",{d:"M8 6V4h8v2"}),l.jsx("path",{d:"M6 6l1 14h10l1-14"}),l.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),l.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),vp=e=>l.jsxs(lt,{...e,children:[l.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),l.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),fa=e=>l.jsxs(lt,{...e,children:[l.jsx("polyline",{points:"23 4 23 10 17 10"}),l.jsx("path",{d:"M20.49 15a9 9 0 11-2.12-9.36L23 10"})]}),zg=e=>l.jsx(lt,{...e,children:l.jsx("polyline",{points:"15 18 9 12 15 6"})}),vo=e=>l.jsx(lt,{...e,children:l.jsx("polyline",{points:"9 18 15 12 9 6"})}),Da=e=>l.jsxs(lt,{...e,children:[l.jsx("circle",{cx:"9",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"9",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"9",cy:"18",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"18",r:"1",fill:"currentColor",stroke:"none"})]}),Or=e=>l.jsxs(lt,{...e,children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),xp=e=>l.jsxs(lt,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",strokeDasharray:"4 2"}),l.jsx("line",{x1:"9",y1:"12",x2:"15",y2:"12"})]}),A0=e=>l.jsxs(lt,{...e,children:[l.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),l.jsx("polyline",{points:"5 12 12 5 19 12"})]}),I0=e=>l.jsxs(lt,{...e,children:[l.jsx("circle",{cx:"6",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"12",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"18",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"})]}),T0=e=>l.jsxs(lt,{...e,children:[l.jsx("rect",{x:"9",y:"9",width:"10",height:"10",rx:"2"}),l.jsx("path",{d:"M7 15H6a2 2 0 01-2-2V6a2 2 0 012-2h7"})]}),wp=[{to:"/studio",label:"Studio",Icon:_0,end:!0},{to:"/controls",label:"Controls",Icon:kd}],$0=[{to:"/gallery",label:"Gallery",Icon:jd},{to:"/tags",label:"Tag Library",Icon:dr},{to:"/aliases",label:"Aliases",Icon:ll}],Pl=({isActive:e})=>["slim-nav-link btn-touch",e?"is-active":null].filter(Boolean).join(" ");function M0({isMobileAlignedNav:e=!1}){const[t,n]=o.useState(!1),{pathname:r}=cn(),s=vg(),{logout:i,user:a}=go(),[c,u]=o.useState(!1),d=Sd("(min-width: 768px)"),m=o.useRef(null),y=o.useRef(null),g=()=>n(C=>!C),v=()=>n(!1),w=r==="/login",k=d&&!e,j=!w&&k,h=k,f=!d||e;o.useEffect(()=>{const C=z=>{var O;const $=!!((O=z==null?void 0:z.detail)!=null&&O.active);u($)};return window.addEventListener("cozygen:render-state",C),()=>window.removeEventListener("cozygen:render-state",C)},[]),o.useEffect(()=>{if(!t)return;const C=z=>{m.current&&!m.current.contains(z.target)&&y.current&&!y.current.contains(z.target)&&v()};return document.addEventListener("mousedown",C),document.addEventListener("touchstart",C),()=>{document.removeEventListener("mousedown",C),document.removeEventListener("touchstart",C)}},[t]);const p=async()=>{if(c)return;if(r==="/controls"||r==="/compose"){try{window.dispatchEvent(new Event("cozygen:request-render"))}catch{}return}if(!Eg()){alert("No previous render found yet. Render once from Studio first.");return}u(!0);const $=await bg();u(!1),$!=null&&$.success||alert(($==null?void 0:$.error)||"Failed to render.")},x=()=>{try{i()}catch{}window.location.hash="#/login"},b=[...wp,...$0];return l.jsxs("header",{className:"top-bar",children:[l.jsx("div",{className:"top-bar-shell",children:l.jsxs("div",{className:"brand-row",children:[l.jsxs(gg,{to:"/studio",className:"brand-mark",onClick:v,children:[l.jsx(Lg,{size:28,className:"brand-logo"}),l.jsx("span",{className:"brand-text",children:"CozyGen"})]}),k?l.jsx("nav",{className:"desktop-nav","aria-label":"Main navigation",children:b.map(C=>l.jsx(js,{to:C.to,end:C.end,className:Pl,children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[l.jsx(C.Icon,{size:16}),l.jsx("span",{children:C.label}),C.to==="/gallery"&&s?l.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})},C.to))}):null,l.jsx("div",{className:"flex-1"}),j?l.jsxs(K,{variant:"primary",size:"sm",onClick:p,title:c?"Rendering":"Render","aria-busy":c,"aria-disabled":c,disabled:c,children:[l.jsx("span",{className:"inline-flex items-center justify-center",children:c?l.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):l.jsx(Pg,{size:16})}),l.jsx("span",{children:c?"Rendering":"Render"})]}):null,h?l.jsxs(K,{variant:"muted",size:"sm",onClick:x,title:"Sign out",children:[l.jsx("span",{className:"inline-flex items-center justify-center",children:l.jsx(pp,{size:16})}),l.jsx("span",{children:"Logout"}),a?l.jsxs("span",{className:"text-xs text-[#9DA3FFB3]",children:["@",a]}):null]}):null,f?l.jsx("button",{ref:y,type:"button",className:`mobile-menu-toggle btn-touch ${t?"is-active":""}`,onClick:g,"aria-expanded":t,"aria-controls":"cozygen-mobile-nav","aria-label":t?"Close menu":"Open menu",children:l.jsx("span",{className:"mobile-menu-icon",children:l.jsx("span",{})})}):null]})}),f?l.jsxs("div",{ref:m,id:"cozygen-mobile-nav",className:`mobile-nav-drawer ${t?"is-open":""}`,role:"menu",children:[l.jsxs("div",{className:"mobile-nav-section",children:[wp.map(C=>l.jsx(js,{to:C.to,end:C.end,className:Pl,onClick:v,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(C.Icon,{size:16}),l.jsx("span",{children:C.label})]})},C.to)),l.jsx(js,{to:"/gallery",className:Pl,onClick:v,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(jd,{size:16}),l.jsx("span",{children:"Gallery"}),s?l.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})})]}),l.jsxs("div",{className:"mobile-nav-section secondary",children:[l.jsx(js,{to:"/tags",className:Pl,onClick:v,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(dr,{size:16}),l.jsx("span",{children:"Tag Library"})]})}),l.jsx(js,{to:"/aliases",className:Pl,onClick:v,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(ll,{size:16}),l.jsx("span",{children:"Aliases"})]})}),l.jsx("button",{type:"button",className:"slim-nav-link btn-touch text-left",onClick:()=>{v(),x()},role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(pp,{size:16}),l.jsx("span",{children:"Logout"}),a?l.jsxs("span",{className:"text-[rgba(159,178,215,0.75)] text-xs",children:["@",a]}):null]})})]})]}):null]})}const Sp=[{to:"/controls",label:"Controls",Icon:kd},{to:"/compose",label:"Compose",Icon:yo},{to:"/gallery",label:"Gallery",Icon:jd}],F0=[{to:"/aliases",label:"Aliases",Icon:ll},{to:"/tags",label:"Tags",Icon:dr}],O0=({isActive:e})=>["bottom-nav-link",e?"is-active":""].filter(Boolean).join(" ");function D0(){const e=cn(),t=qn(),n=vg(),[r,s]=fn.useState(!1),[i,a]=fn.useState(!1),[c,u]=fn.useState(!1),[d,m]=fn.useState({}),y=Sd("(min-width: 768px)"),g=fn.useRef(null),v=fn.useRef(null),w=e.pathname==="/controls",k=e.pathname==="/compose",j=async()=>{if(!(typeof window>"u")&&!i)if(s(!0),setTimeout(()=>s(!1),400),w||k)try{window.dispatchEvent(new CustomEvent("cozygen:request-render"))}catch{}else{if(!Eg())return;const f=await bg();f.success||console.warn("Requeue failed:",f.error)}};fn.useEffect(()=>{const f=p=>{var b;const x=!!((b=p==null?void 0:p.detail)!=null&&b.active);a(x),x&&(s(!0),setTimeout(()=>s(!1),400))};return window.addEventListener("cozygen:render-state",f),()=>window.removeEventListener("cozygen:render-state",f)},[]),fn.useEffect(()=>{if(!c||y)return;const f=p=>{g.current&&g.current.contains(p.target)||v.current&&v.current.contains(p.target)||u(!1)};return window.addEventListener("pointerdown",f),()=>window.removeEventListener("pointerdown",f)},[c,y]),fn.useEffect(()=>{if(!c||y||!v.current)return;const f=v.current.getBoundingClientRect(),p=f.left+f.width/2,x=window.innerHeight-f.top+8;m({left:`${Math.min(window.innerWidth-80,Math.max(40,p))}px`,bottom:`${x}px`,top:"auto"})},[c,y]),fn.useEffect(()=>{y&&u(!1)},[y]);const h=y?[...Sp,...F0]:Sp;return l.jsxs(l.Fragment,{children:[l.jsxs("nav",{className:"bottom-nav","aria-label":"Bottom navigation",children:[h.map(f=>l.jsxs(js,{to:f.to,end:f.end,className:O0,children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(f.Icon,{size:20})}),l.jsxs("span",{className:"bottom-nav-label",children:[f.label,f.to==="/gallery"&&n?l.jsx("span",{className:"badge-dot pulse","aria-hidden":"true"}):null]})]},f.to)),y?null:l.jsxs("button",{ref:v,type:"button",className:"bottom-nav-link",onClick:()=>u(f=>!f),"aria-expanded":c,"aria-label":"Open library",children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(dr,{size:20})}),l.jsx("span",{className:"bottom-nav-label",children:"Library"})]},"library"),l.jsxs("button",{type:"button",className:`bottom-nav-link is-action ${r?"is-flash":""} ${i?"is-rendering":""}`,onClick:j,"aria-label":"Render","aria-busy":i,"aria-disabled":i,disabled:i,children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(Pg,{size:20})}),l.jsx("span",{className:"bottom-nav-label",children:"Render"})]},"render")]}),y?null:l.jsxs("div",{ref:g,className:`library-popover ${c?"is-open":""}`,style:d,children:[l.jsxs(K,{size:"sm",variant:"ghost",className:"w-[120px] flex-col gap-1",onClick:()=>{u(!1),t("/aliases")},children:[l.jsx(ll,{size:18}),l.jsx("span",{className:"text-[0.65rem]",children:"Aliases"})]}),l.jsxs(K,{size:"sm",variant:"ghost",className:"w-[120px] flex-col gap-1",onClick:()=>{u(!1),t("/tags")},children:[l.jsx(dr,{size:18}),l.jsx("span",{className:"text-[0.65rem]",children:"Tags"})]})]})]})}function B0(e,t){if(!t||t<=0)return null;const n=Number(e)||0,r=Number(t)||0,s=Math.round(n/r*100);return Number.isFinite(s)?Math.max(0,Math.min(100,s)):null}function U0({busy:e=!1,progressValue:t=0,progressMax:n=0,statusText:r="Idle",statusPhase:s="idle",primaryLabel:i="Render",onPrimary:a,primaryDisabled:c=!1,onLogs:u,logsLabel:d="Logs"}){const m=B0(t,n),y=s==="queued"?"rgba(255, 143, 112, 0.95)":s==="running"?"rgba(68, 225, 197, 0.95)":s==="finished"?"rgba(92, 255, 154, 0.95)":s==="error"?"rgba(255, 143, 112, 0.95)":"rgba(159, 178, 215, 0.55)",v={idle:"Idle",queued:"Queued",running:"Running",finished:"Finished",error:"Error"}[s]||"Status",w=e||c;return l.jsxs("div",{className:"dock-bar-inner",children:[l.jsx(K,{variant:"primary",size:"lg",className:"w-full",onClick:a,disabled:w,children:e?"Rendering":i}),l.jsxs("div",{className:"dock-status-row",children:[l.jsxs("span",{className:"dock-status-left",children:[l.jsx("span",{className:"dock-status-dot",style:{background:y}}),l.jsx("span",{className:"dock-status-label",children:v})]}),l.jsxs("span",{className:"dock-status-right",children:[m!=null&&e?l.jsxs("span",{className:"dock-progress",children:[l.jsx("span",{className:"dock-progress-bar","aria-hidden":"true",children:l.jsx("span",{className:"dock-progress-fill",style:{width:`${m}%`}})}),l.jsxs("span",{children:[m,"%"]})]}):null,l.jsx("span",{className:"dock-status-text",children:r||(e?"Working":"Idle")}),u?l.jsx(K,{size:"xs",variant:"ghost",onClick:u,children:d}):null]})]})]})}const _g="jpg,jpeg,png,webp,gif,bmp,tif,tiff",Cd=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),Rg=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);async function lc({subfolder:e="",page:t=1,perPage:n=50,exts:r=_g,signal:s}={}){const i=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),exts:r}),a=await fetch(`/cozygen/input?${i.toString()}`,{signal:s});if(!a.ok)throw new Error(`Input list failed: ${a.status}`);return a.json()}const Ba=e=>`/cozygen/input/file?path=${encodeURIComponent(e)}`,pu="output::",xo=(e="")=>e.replace(/\\/g,"/").replace(/^\/+/,"").replace(/\/+$/,""),Ag=(e="")=>{const t=e.replace(/\\/g,"/").split("/").filter(Boolean);return t[t.length-1]||""},V0=({subfolder:e="",filename:t=""}={})=>{const n=Ag(t);if(!n)return"";const r=xo(e);return`${pu}${r}::${n}`},hu=(e="")=>{if(typeof e!="string"||!e.startsWith(pu))return null;const t=e.slice(pu.length);if(!t)return null;const n=t.lastIndexOf("::"),r=n===-1?t:t.slice(n+2);return r?{subfolder:n===-1?"":t.slice(0,n),filename:r}:null},Ua=({filename:e="",subfolder:t="",type:n="output"}={})=>{const r=Ag(e);return r?`/view?${new URLSearchParams({filename:r,subfolder:xo(t),type:n||"output"}).toString()}`:""},mu=(e="")=>e.split("/").slice(0,-1).join("/"),W0=e=>{if(typeof e!="string"||!e)return e!=null&&e.path?mu(e.path):"";const t=hu(e);return t?xo(t.subfolder):mu(e)},jp=(e=[])=>e.map(t=>{const n=t.rel_path||t.name||"",r=t.name||n||"Untitled",s=!!t.is_dir,i=s?"":Ba(n);return{...t,name:r,rel_path:n,is_dir:s,is_image:!s&&Cd(r),is_video:!s&&Rg(r),source:"input",preview_url:i}}),H0=(e=[])=>e.map(t=>{const n=t.filename||"",r=t.subfolder||"",s=t.type==="directory",i=s?r||n:[r,n].filter(Boolean).join("/"),a=n||r||i||"Untitled",c=s?"":Ua({filename:n,subfolder:r,type:t.type});return{...t,name:a,rel_path:i,is_dir:s,is_image:!s&&Cd(n),is_video:!s&&Rg(n),source:"output",preview_url:c}}),Jr={get(e,t){try{return(typeof window<"u"?JSON.parse(localStorage.getItem(e)):null)??t}catch{return t}},set(e,t){try{typeof window<"u"&&localStorage.setItem(e,JSON.stringify(t))}catch{}}};function G0({input:e,value:t,onFormChange:n}){var Y;const r=((Y=e==null?void 0:e.inputs)==null?void 0:Y.param_name)||"Image Input",s=(e==null?void 0:e.class_type)||"CozyGenImageInput",i=`cg_last_input_cwd::${r}`,a=`cg_last_picker_source::${r}`,[c,u]=o.useState(""),[d,m]=o.useState(!1),[y,g]=o.useState(!1),[v,w]=o.useState(Jr.get(i,"")),[k,j]=o.useState(1),[h,f]=o.useState(50),[p,x]=o.useState([]),[b,C]=o.useState(1),[z,$]=o.useState(!1),[O,R]=o.useState(""),[I,Z]=o.useState([]),[X,de]=o.useState(!0),Se=o.useRef(null),[ce,me]=o.useState(()=>Jr.get(a,"inputs")==="outputs"?"outputs":"inputs"),A=ce,L=o.useCallback(U=>{const W=U==="outputs"?"outputs":"inputs";me(W),Jr.set(a,W),w(""),j(1)},[]),D=o.useMemo(()=>{if(c)try{const U=new URL(c,window.location.origin);return(U.searchParams.get("path")||U.searchParams.get("filename")||U.pathname.split("/").pop()||"").split("/").pop()||"No file selected."}catch{}if(!t)return"No file selected.";if(typeof t=="string"){const U=hu(t);return U!=null&&U.filename?U.filename.split("/").pop():t.split("/").pop()}return t!=null&&t.path?t.path.split("/").pop():"No file selected."},[c,t]);o.useEffect(()=>{if(typeof t=="string"&&t){const U=hu(t);U!=null&&U.filename?u(Ua({filename:U.filename,subfolder:U.subfolder,type:"output"})):u(Ba(t)),m(!1)}else t!=null&&t.url?(u(t.url),m(!1)):(u(""),m(!1))},[t]);const _=o.useCallback(async U=>{const W=await v0(U),ue=`/view?filename=${W.filename}&type=input`;u(ue),m(!1),Jr.set(i,""),s==="CozyGenImageInput"?n(r,W.filename):n(r,{source:"Upload",path:W.filename,url:ue})},[s,n,r]),H=o.useCallback(()=>{u(""),m(!1),s==="CozyGenImageInput"?n(r,""):n(r,{source:"Upload",path:"",url:""})},[s,n,r]),Q=o.useCallback(()=>{const W=W0(t)||Jr.get(i,"");w(W),j(1),g(!0)},[t]),oe=o.useCallback(()=>{g(!1)},[]);o.useEffect(()=>{if(y){if(A!=="inputs"){Z([]);return}(async()=>{try{const U=await lc({subfolder:"",page:1,perPage:0,exts:""});Z((U.items||[]).filter(W=>W.is_dir))}catch{}})()}},[y,A]),o.useEffect(()=>{if(!y)return;let U=!1;Se.current&&Se.current.abort();const W=new AbortController;Se.current=W;async function ue(){$(!0);try{if(A==="outputs"){const je=await wg(v,k,h,!1,!1,"all","",{signal:W.signal});if(U)return;const _e=H0(je&&je.items||[]);U||(x(_e),C(je&&je.total_pages||1))}else{const _e=await lc({subfolder:v,page:k,perPage:h,exts:X?_g:"",signal:W.signal}),$e=(_e.items||[]).some(ze=>!ze.is_dir);if(X&&!$e){const ze=await lc({subfolder:v,page:k,perPage:h,exts:"",signal:W.signal});U||(x(jp(ze.items||[])),C(ze.total_pages||1),de(!1));return}U||(x(jp(_e.items||[])),C(_e.total_pages||1))}}catch(je){if((je==null?void 0:je.name)==="AbortError")return;console.error(A==="outputs"?"Failed to load output directory":"Failed to load input directory",je),U||(x([]),C(1))}finally{U||$(!1)}}return ue(),()=>{U=!0,Se.current===W&&(Se.current=null),W.abort()}},[y,v,k,h,X,A]);const ne=o.useDeferredValue(O),re=o.useMemo(()=>{const U=ne.trim().toLowerCase();let W=p;return X&&(W=W.filter(ue=>{if(ue.is_dir)return!0;const je=ue.name||ue.filename||ue.rel_path||"";return Cd(String(je))})),U?W.filter(ue=>(ue.name||ue.filename||ue.rel_path||"").toLowerCase().includes(U)):W},[p,ne,X]),ae=o.useCallback(U=>{if(!U)return;const W=typeof U=="object"?U:null;if(((W==null?void 0:W.source)||"inputs")==="output"){const $e=V0({subfolder:(W==null?void 0:W.subfolder)||"",filename:(W==null?void 0:W.filename)||(W==null?void 0:W.name)||""});if(!$e)return;const ze=(W==null?void 0:W.preview_url)||Ua({filename:W==null?void 0:W.filename,subfolder:W==null?void 0:W.subfolder,type:W==null?void 0:W.type});u(ze),m(!1),Jr.set(i,xo((W==null?void 0:W.subfolder)||"")),s==="CozyGenImageInput"?n(r,$e):n(r,{source:"OutputGallery",path:$e,url:ze}),g(!1);return}const je=typeof U=="string"?U:(W==null?void 0:W.rel_path)||(W==null?void 0:W.path)||"";if(!je)return;const _e=(W==null?void 0:W.preview_url)||Ba(je);u(_e),m(!1),Jr.set(i,mu(je)),s==="CozyGenImageInput"?n(r,je):n(r,{source:"Server",path:je,url:_e}),g(!1)},[s,n,r]);return{param:r,previewUrl:c,imgReady:d,setImgReady:m,displayName:D,serverOpen:y,openServer:Q,closeServer:oe,cwd:v,setCwd:w,page:k,setPage:j,perPage:h,setPerPage:f,totalPages:b,loading:z,search:O,setSearch:R,topDirs:I,imagesOnly:X,setImagesOnly:de,shownEntries:re,pickerSource:A,setPickerSource:L,handleUpload:_,clearImage:H,selectServer:ae}}function Ht({open:e,onClose:t,title:n,children:r,footer:s,variant:i="sheet",className:a="",contentClassName:c="",shouldCloseOnOverlayClick:u=!0,shouldCloseOnEsc:d=!0}){const m=o.useRef(!1),y=o.useRef(null),g=o.useRef(null),v=j=>j?Array.from(j.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(h=>!h.hasAttribute("disabled")&&h.getAttribute("aria-hidden")!=="true"):[],w=o.useMemo(()=>["bottom-sheet-content",i==="fullscreen"?"is-fullscreen":"is-sheet",c].filter(Boolean).join(" "),[c,i]),k=o.useMemo(()=>["bottom-sheet-overlay",a].filter(Boolean).join(" "),[a]);return o.useEffect(()=>{if(!e||!d)return;const j=h=>{h.key==="Escape"&&(t==null||t())};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[e,t,d]),o.useEffect(()=>{if(!e||typeof document>"u")return;const j=y.current;g.current=document.activeElement;const h=()=>{var b;const x=v(j)[0]||j;(b=x==null?void 0:x.focus)==null||b.call(x)},f=p=>{if(p.key!=="Tab"||!j)return;const x=v(j);if(!x.length){p.preventDefault(),j.focus();return}const b=x[0],C=x[x.length-1],z=document.activeElement;p.shiftKey&&z===b?(p.preventDefault(),C.focus()):!p.shiftKey&&z===C&&(p.preventDefault(),b.focus())};return requestAnimationFrame(h),j==null||j.addEventListener("keydown",f),()=>{var x;j==null||j.removeEventListener("keydown",f);const p=g.current;p&&document.contains(p)&&((x=p.focus)==null||x.call(p))}},[e]),!e||typeof document>"u"?null:hd.createPortal(l.jsx("div",{className:k,role:"presentation",onPointerDown:j=>{m.current=j.target===j.currentTarget},onClick:j=>{u&&m.current&&j.target===j.currentTarget&&(t==null||t())},children:l.jsx("div",{ref:y,className:w,role:"dialog","aria-modal":"true","aria-label":n||"Sheet",onClick:j=>j.stopPropagation(),tabIndex:-1,children:l.jsxs("div",{className:"bottom-sheet-panel",children:[l.jsxs("header",{className:"bottom-sheet-head",children:[l.jsx("div",{className:"bottom-sheet-title",children:n||""}),l.jsx("button",{type:"button",className:"bottom-sheet-close",onClick:t,"aria-label":"Close",children:l.jsx(Or,{size:16})})]}),l.jsx("div",{className:"bottom-sheet-body",children:r}),s?l.jsx("footer",{className:"bottom-sheet-foot",children:s}):null]})})}),document.body)}function K0({items:e=[],value:t,onChange:n,ariaLabel:r,role:s="tablist",className:i="",tabClassName:a="",size:c="md",layout:u="equal",wrap:d=!1}){const m=["segmented-tabs",c==="sm"?"is-compact":"",u==="auto"?"is-auto":"",u==="icon"?"is-icon":"",d?"is-wrap":"",i].filter(Boolean).join(" "),y=s==="tablist"?"tab":"button",g=o.useRef([]);o.useEffect(()=>{g.current=g.current.slice(0,e.length)},[e.length]);const v=o.useMemo(()=>e.map((p,x)=>p.disabled?null:x).filter(p=>p!==null),[e]),w=o.useMemo(()=>e.findIndex(p=>p.key===t&&!p.disabled),[e,t]),k=v.length?v[0]:-1,j=w>=0?w:k,h=p=>{var b;const x=g.current[p];(b=x==null?void 0:x.focus)==null||b.call(x)},f=(p,x)=>{var C;if(!e.length)return p;let b=p;for(let z=0;z<e.length;z+=1)if(b=(b+x+e.length)%e.length,!((C=e[b])!=null&&C.disabled))return b;return p};return l.jsx("div",{className:m,role:s,"aria-label":r,children:e.map((p,x)=>{const b=p.key===t,C=p.label?String(p.label):"";return l.jsxs("button",{type:"button",ref:z=>{g.current[x]=z},role:y,"aria-selected":s==="tablist"?b:void 0,"aria-pressed":s!=="tablist"?b:void 0,"aria-controls":s==="tablist"?p.controls:void 0,className:["segmented-tab",b?"is-active":"",p.icon&&!C?"is-icon":"",p.className||"",a].filter(Boolean).join(" "),onClick:()=>{p.disabled||n==null||n(p.key)},onKeyDown:z=>{if(s!=="tablist"||!["ArrowRight","ArrowLeft","Home","End"].includes(z.key)||(z.preventDefault(),!e.length))return;let $=x;z.key==="Home"?$=v.length?v[0]:$:z.key==="End"?$=v.length?v[v.length-1]:$:z.key==="ArrowRight"?$=f($,1):z.key==="ArrowLeft"&&($=f($,-1));const O=e[$];!O||O.disabled||(n==null||n(O.key),h($))},disabled:p.disabled,title:p.title||C||p.ariaLabel,"aria-label":p.ariaLabel,tabIndex:s==="tablist"?x===j?0:-1:void 0,children:[p.icon?l.jsx("span",{className:"segmented-tab-icon",children:p.icon}):null,C?l.jsx("span",{className:"segmented-tab-label",children:C}):null,p.badge?l.jsx("span",{className:"segmented-tab-badge",children:p.badge}):null]},p.key)})})}const $r=o.memo(K0),Y0=(e=[])=>(e||[]).map(t=>typeof t=="string"||typeof t=="number"?{value:t,label:String(t)}:{value:(t==null?void 0:t.value)??(t==null?void 0:t.id)??"",label:(t==null?void 0:t.label)??(t==null?void 0:t.name)??String((t==null?void 0:t.value)??""),disabled:!!(t!=null&&t.disabled)}),Q0=(e,t)=>{if(!t)return e;const n=t.trim().toLowerCase();return n?e.filter(r=>{const s=String(r.label||"").toLowerCase(),i=String(r.value||"").toLowerCase();return s.includes(n)||i.includes(n)}):e};function q0({value:e,onChange:t,options:n,children:r,placeholder:s,emptyLabel:i="No matches",disabled:a=!1,size:c="md",className:u="",wrapperClassName:d="",searchable:m=!1,searchThreshold:y=0,searchPlaceholder:g="Search options...",searchValue:v,onSearchChange:w,searchAriaLabel:k="Search options",...j}){const[h,f]=o.useState(""),p=typeof v=="string"?v:h,x=w||f,b=o.useMemo(()=>Y0(n),[n]),C=m||typeof y=="number"&&y>0&&b.length>y,z=o.useMemo(()=>C?Q0(b,p):b,[b,p,C]),$=["ui-control","ui-select",c==="sm"?"is-compact":"",u,C?"":d].filter(Boolean).join(" "),O=()=>r||(z.length?z.map(I=>l.jsx("option",{value:I.value,disabled:I.disabled,children:I.label},String(I.value))):l.jsx("option",{value:"",disabled:!0,children:i})),R=l.jsxs("select",{...j,className:$,value:e??"",onChange:I=>t==null?void 0:t(I.target.value),disabled:a,children:[s?l.jsx("option",{value:"",children:s}):null,O()]});return C?l.jsxs("div",{className:["ui-select-stack",d].filter(Boolean).join(" "),children:[l.jsx("input",{type:"search",value:p,onChange:I=>x(I.target.value),placeholder:g,className:"ui-control ui-input is-compact","aria-label":k,disabled:a}),R]}):R}const Je=o.memo(q0);function X0({open:e,cwd:t,setCwd:n,page:r,setPage:s,perPage:i,setPerPage:a,totalPages:c,topDirs:u,loading:d,imagesOnly:m,setImagesOnly:y,search:g,setSearch:v,shownEntries:w,onSelect:k,onClose:j,pickerSource:h,setPickerSource:f}){if(!e)return null;const p=h||"inputs",x=typeof f=="function",b=()=>{n(""),s(1)},C=I=>{x&&I!==p&&(f(I),n(""),s(1))},z=t.split("/").filter(Boolean),$=p==="outputs"?"Choose output":"Choose input",O=[{key:"",label:"Root"},...u.map(I=>({key:I.rel_path,label:I.name}))],R=I=>{n(I),s(1)};return l.jsx(Ht,{open:e,onClose:j,title:$,variant:"fullscreen",footer:l.jsxs("div",{className:"flex items-center gap-2 w-full",children:[l.jsx(K,{variant:"muted",className:"w-full",disabled:r<=1||d,onClick:()=>s(I=>Math.max(1,I-1)),children:"Prev"}),l.jsxs("div",{className:"text-xs text-center text-[rgba(159,178,215,0.75)] min-w-[92px]",children:[r," / ",c]}),l.jsx(K,{variant:"muted",className:"w-full",disabled:r>=c||d,onClick:()=>s(I=>I<c?I+1:I),children:"Next"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Location"}),l.jsxs("div",{className:"imagepicker-breadcrumb",children:[l.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:b,children:"Root"}),z.map((I,Z)=>{const X=z.slice(0,Z+1).join("/");return l.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:()=>{n(X),s(1)},children:I},X)})]})]}),x?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Source"}),l.jsx($r,{ariaLabel:"Source",value:p,onChange:C,size:"sm",items:[{key:"inputs",label:"Inputs"},{key:"outputs",label:"Outputs"}]})]}):null,l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Filters"}),l.jsxs("div",{className:"composer-filters",children:[l.jsxs("label",{className:"inline-flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:m,onChange:I=>{y(I.target.checked),s(1)}}),l.jsx("span",{className:"text-sm text-[rgba(159,178,215,0.85)]",children:"Images only"})]}),l.jsx("input",{type:"search",value:g,onChange:I=>v(I.target.value),placeholder:"Search files",className:"sheet-input ui-control ui-input","aria-label":"Search files"}),l.jsx(Je,{value:i,onChange:I=>{const Z=parseInt(I,10)||50;a(Z),s(1)},"aria-label":"Items per page",size:"sm",options:[25,50,100]})]})]}),u.length>0?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Quick folders"}),l.jsx($r,{ariaLabel:"Quick folders",value:t,onChange:R,size:"sm",layout:"auto",wrap:!0,className:"imagepicker-chips",items:O})]}):null,l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Results"}),d?l.jsxs("div",{className:"sheet-hint",children:["Scanning ",p==="outputs"?"output":"input"," folders"]}):w.length===0?l.jsx("div",{className:"sheet-hint",children:"Nothing here yet. Try a different folder or turn off Images only."}):null,l.jsx("div",{className:"imagepicker-grid",children:!d&&w.map(I=>{const Z=`${I.source||"input"}::${I.rel_path||I.name}`,X=I.is_dir?"":I.preview_url||(I.source==="output"?Ua({filename:I.filename,subfolder:I.subfolder,type:I.type}):Ba(I.rel_path||""));return l.jsx("button",{type:"button",className:`imagepicker-item ${I.is_dir?"is-dir":""}`,onClick:()=>{I.is_dir?(n(I.rel_path||""),s(1)):k(I)},children:I.is_dir?l.jsxs("div",{className:"imagepicker-dir-row",children:[l.jsx("div",{className:"imagepicker-dir-dot","aria-hidden":"true"}),l.jsx("div",{className:"imagepicker-name",children:I.name})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"imagepicker-thumb",children:X?l.jsx("img",{className:"imagepicker-img",alt:I.name,src:X}):l.jsx("div",{className:"imagepicker-img is-placeholder"})}),l.jsx("div",{className:"imagepicker-name",children:I.name})]})},Z)})})]})]})})}function J0({open:e,onClose:t,title:n,url:r,kind:s="image"}){return r?l.jsx(Ht,{open:e,onClose:t,title:n||"Preview",variant:"fullscreen",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx(K,{href:r,target:"_blank",rel:"noreferrer",variant:"muted",className:"w-full text-center",children:"Open"}),l.jsx(K,{variant:"primary",className:"w-full",onClick:t,children:"Close"})]}),children:l.jsx("div",{className:"url-viewer-stage",children:s==="video"?l.jsx("video",{src:r,controls:!0,className:"url-viewer-media",autoPlay:!0}):l.jsx("img",{src:r,alt:n||"Preview",className:"url-viewer-media"})})}):null}function Z0({input:e,value:t,onFormChange:n}){const{previewUrl:r,imgReady:s,setImgReady:i,displayName:a,serverOpen:c,openServer:u,closeServer:d,cwd:m,setCwd:y,page:g,setPage:v,perPage:w,setPerPage:k,totalPages:j,topDirs:h,loading:f,search:p,setSearch:x,imagesOnly:b,setImagesOnly:C,shownEntries:z,pickerSource:$,setPickerSource:O,handleUpload:R,clearImage:I,selectServer:Z}=G0({input:e,value:t,onFormChange:n}),X=o.useRef(null),de=o.useRef(null),[Se,ce]=o.useState(0),[me,A]=o.useState(!1);o.useEffect(()=>{const _=de.current;if(!_)return;const H=oe=>{oe.preventDefault(),oe.stopPropagation()},Q=async oe=>{var re,ae;H(oe);const ne=(ae=(re=oe.dataTransfer)==null?void 0:re.files)==null?void 0:ae[0];ne&&(await R(ne),X.current&&(X.current.value=""),ce(Y=>Y+1))};return["dragenter","dragover","dragleave","drop"].forEach(oe=>_.addEventListener(oe,oe==="drop"?Q:H)),()=>{["dragenter","dragover","dragleave","drop"].forEach(oe=>_.removeEventListener(oe,oe==="drop"?Q:H))}},[R]);const L=async _=>{var Q;const H=(Q=_.target.files)==null?void 0:Q[0];H&&(await R(H),X.current&&(X.current.value=""),ce(oe=>oe+1))},D=()=>{X.current&&X.current.click()};return l.jsxs("div",{className:"ui-card",children:[l.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[l.jsx("h3",{className:"text-sm font-semibold text-[#F8F4FF] truncate",children:a}),l.jsx("span",{className:"text-[11px] text-[#C3C7FFB3] truncate",children:"Image"})]}),l.jsx("div",{ref:de,className:"mb-3 rounded-xl border border-dashed border-[rgba(255,255,255,0.14)] bg-[rgba(255,255,255,0.02)] flex items-center justify-center min-h-[140px] sm:min-h-[180px] overflow-hidden",children:r?l.jsx(K,{variant:"bare",className:"w-full h-full",onClick:()=>A(!0),"aria-label":`Preview ${a}`,title:"Open preview",children:l.jsx("img",{src:r,alt:a,className:`max-h-64 max-w-full object-contain transition-opacity ${s?"opacity-100":"opacity-0"}`,onLoad:()=>i(!0)})}):l.jsx("div",{className:"text-[11px] text-[#9DA3FFCC] text-center px-6",children:"Drop an image here, upload from your device, or choose one from your server."})}),l.jsx("input",{ref:X,type:"file",accept:"image/*",className:"hidden",onChange:L},Se),l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx(K,{size:"sm",variant:"primary",onClick:u,children:"Choose"}),l.jsx(K,{size:"sm",variant:"muted",onClick:D,children:"Upload"}),l.jsx(K,{size:"sm",variant:"ghost",onClick:I,children:"Clear"})]}),l.jsx(X0,{open:c,cwd:m,setCwd:y,page:g,setPage:v,perPage:w,setPerPage:k,totalPages:j,topDirs:h,loading:f,imagesOnly:b,setImagesOnly:C,search:p,setSearch:x,shownEntries:z,pickerSource:$,setPickerSource:O,onSelect:Z,onClose:d}),l.jsx(J0,{open:me,onClose:()=>A(!1),title:a||"Preview",url:r,kind:"image"})]})}function eS({open:e,onClose:t,title:n,description:r,render:s,index:i=0,total:a=0,children:c}){const[u,d]=o.useState("idle"),m=o.useRef(null),y=o.useRef(null),g=w=>w?Array.from(w.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(k=>!k.hasAttribute("disabled")&&k.getAttribute("aria-hidden")!=="true"):[];if(o.useEffect(()=>{if(u==="queued"){const w=setTimeout(()=>d("idle"),1600);return()=>clearTimeout(w)}},[u]),o.useEffect(()=>{if(!e||typeof document>"u")return;const w=m.current;y.current=document.activeElement;const k=()=>{var p;const f=g(w)[0]||w;(p=f==null?void 0:f.focus)==null||p.call(f)},j=h=>{if(h.key==="Escape"){t==null||t();return}if(h.key!=="Tab"||!w)return;const f=g(w);if(!f.length){h.preventDefault(),w.focus();return}const p=f[0],x=f[f.length-1],b=document.activeElement;h.shiftKey&&b===p?(h.preventDefault(),x.focus()):!h.shiftKey&&b===x&&(h.preventDefault(),p.focus())};return requestAnimationFrame(k),w==null||w.addEventListener("keydown",j),()=>{var f;w==null||w.removeEventListener("keydown",j);const h=y.current;h&&document.contains(h)&&((f=h.focus)==null||f.call(h))}},[e,t]),!e)return null;const v=typeof s=="function"?s():c;return l.jsxs("div",{className:"spotlight-overlay",role:"dialog","aria-modal":"true",children:[l.jsx("div",{className:"spotlight-backdrop",onClick:t}),l.jsxs("div",{className:"spotlight-sheet",ref:m,tabIndex:-1,children:[l.jsxs("div",{className:"spotlight-header",children:[l.jsxs("div",{className:"spotlight-meta",children:[l.jsx("div",{className:"spotlight-kicker",children:"Focused control"}),l.jsx("div",{className:"spotlight-title",children:n||"Control"}),r?l.jsx("div",{className:"spotlight-hint",children:r}):null]}),l.jsx("button",{type:"button",className:"spotlight-close",onClick:t,"aria-label":"Close",children:l.jsx(Or,{size:16})})]}),l.jsx("div",{className:"spotlight-body",children:v}),l.jsx("div",{className:"spotlight-footer",children:l.jsx("div",{className:"spotlight-footer-right",children:l.jsx(K,{size:"sm",variant:"muted",onClick:t,"aria-label":"Close",children:"Close"})})})]})]})}const ls=o.forwardRef(function({title:t,kicker:n,meta:r,defaultOpen:s=!0,variant:i="card",className:a="",bodyClassName:c,children:u},d){const m=i==="bare",y=(m?["collapsible-section","collapsible-section--bare",a]:["ui-panel","collapsible-card",a]).filter(Boolean).join(" "),g=(m?["collapsible-section-body",c||"space-y-4"]:["collapsible-card-body",c||"space-y-4"]).filter(Boolean).join(" "),v=r!=null?l.jsx("div",{className:"collapsible-card-summary-meta",children:r}):null;return l.jsxs("details",{ref:d,className:y,open:s,children:[l.jsxs("summary",{className:m?"collapsible-section-summary":"collapsible-card-summary",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[n?l.jsx("span",{className:"ui-kicker",children:n}):null,l.jsx("span",{className:"text-sm font-semibold tracking-wide",children:t})]}),v,m?l.jsx("span",{className:"collapsible-section-chevron","aria-hidden":"true",children:l.jsx(vo,{size:16})}):null]}),l.jsx("div",{className:g,children:u})]})}),tS=/\.(safetensors|ckpt|pt|pth)$/i,nS=/\.([a-z0-9]{2,16})$/i,rS=e=>/[a-z]/i.test(e),wo=e=>e.replace(/\\/g,"/"),Ig=e=>{const{folder:t,base:n}=sS(e);if(!n)return e;if(!t)return n;const r=t.split(/\s+/).filter(Boolean),s=r[r.length-1]||"";if(s&&n.toLowerCase().startsWith(s.toLowerCase())){const i=n.slice(s.length);return i?`${t}${i}`:t}return`${t} ${n}`.trim()};function Tg(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const r=wo(t).split("/").filter(Boolean).pop()||"";return tS.test(r)}function Zs(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const s=(wo(t).split("/").filter(Boolean).pop()||"").match(nS);return s?rS(s[1]):!1}function So(e){if(typeof e!="string")return{folderPath:"",base:"",filename:""};const t=wo(e.trim());if(!t)return{folderPath:"",base:"",filename:""};const n=t.split("/").filter(Boolean),r=n.pop()||"",s=r.replace(/\.[^.]+$/,"");return{folderPath:n.join("/"),base:s,filename:r}}function sS(e){if(typeof e!="string")return{folder:"",base:""};const n=wo(e.trim()).split("/").filter(Boolean),s=(n.pop()||"").replace(/\.[^.]+$/,"");return{folder:n.join(" ").trim(),base:s}}function lS(e){return Tg(e)?Ig(e):e}function iS(e){return Zs(e)?Ig(e):e}function Dn(e){if(!Zs(e))return e;const{base:t}=So(e);return t||iS(e)}const aS=(e="")=>{if(!e||e==="root")return"root";const t=e.split("/").filter(Boolean);return t[t.length-1]||e},oS=o.memo(function({workflows:t=[],selectedWorkflow:n,onWorkflowChange:r,workflowData:s,presets:i=[],presetName:a="",onPresetNameChange:c,selectedPresetId:u="",onPresetSelect:d,onPresetSave:m,onPresetDelete:y,presetStatus:g}){const v=Array.isArray(t)?t:[],w=Array.isArray(i)?i:[],[k,j]=o.useState("All"),h=o.useMemo(()=>v.map(R=>{const I=String(R||"");if(!Zs(I))return{value:I,isFile:!1,base:"",folderPath:""};const{folderPath:Z,base:X}=So(I);return{value:I,isFile:!0,base:X,folderPath:Z||"root"}}),[v]),f=o.useMemo(()=>{const R=new Set(["All"]);return h.forEach(I=>{I.isFile&&I.folderPath&&R.add(I.folderPath)}),Array.from(R).sort((I,Z)=>I.localeCompare(Z))},[h]),p=f.length>2;o.useEffect(()=>{if(!p){k!=="All"&&j("All");return}f.includes(k)||j("All")},[p,k,f]);const x=o.useMemo(()=>{const R=new Map;return h.forEach(I=>{if(!I.isFile||!I.base)return;const Z=I.base.toLowerCase();R.set(Z,(R.get(Z)||0)+1)}),R},[h]),b=o.useMemo(()=>{const R=[],I=p&&k==="All";return h.forEach(Z=>{if(!Z.isFile){R.push({value:Z.value,label:Z.value});return}if(p&&k!=="All"&&Z.folderPath!==k)return;let X=Z.base||Dn(Z.value)||Z.value;if(I&&Z.base){const de=Z.base.toLowerCase();x.get(de)>1&&(X=`${X} (${aS(Z.folderPath)})`)}R.push({value:Z.value,label:X})}),R},[h,k,x,p]),C=o.useMemo(()=>n?b.some(R=>String(R.value)===String(n)):!0,[b,n]),z=o.useMemo(()=>!n||C?b:[{value:n,label:Dn(String(n))},...b],[C,n,b]),$=()=>{m()},O=()=>{y()};return l.jsxs(ls,{title:l.jsxs(l.Fragment,{children:[l.jsx(du,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Workflow"]}),bodyClassName:"control-shell controls-body",defaultOpen:!1,className:"controls-panel",children:[l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"workflow-select",children:"Workflow"}),p?l.jsx(Je,{value:k,onChange:j,wrapperClassName:"mb-2","aria-label":"Workflow folder filter",size:"sm",options:f.map(R=>({value:R,label:R}))}):null,l.jsx(Je,{id:"workflow-select",value:n||"",onChange:r,"aria-label":"Workflow",size:"sm",placeholder:"Select workflow...",options:z})]}),l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"preset-select",children:"Preset"}),l.jsx(Je,{id:"preset-select",value:u||"",onChange:d,"aria-label":"Workflow preset",disabled:!s,size:"sm",placeholder:"Select preset...",options:w.map(R=>({value:R.id,label:R.name}))})]}),l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"preset-name-input",children:"Preset name"}),l.jsx("input",{id:"preset-name-input",type:"text",value:a,onChange:R=>c(R.target.value),className:"ui-control ui-input",placeholder:"Name for new preset...","aria-label":"Preset name",disabled:!s})]}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("div",{className:"flex gap-2 flex-wrap",children:[l.jsx(K,{size:"sm",variant:"primary",onClick:$,disabled:!s||!a.trim(),children:"Save preset"}),l.jsx(K,{size:"sm",variant:"muted",onClick:O,disabled:!s||!u,children:"Delete preset"})]}),g?l.jsx("div",{className:"text-xs text-[#6D8BFF]",children:g}):null]})]})});function cS({open:e,onClose:t,title:n,value:r,onChange:s,placeholder:i="",description:a}){const c=n||"Edit",u=o.useMemo(()=>`sheet-textarea-${Math.random().toString(36).slice(2,9)}`,[]);return l.jsxs(Ht,{open:e,onClose:t,title:c,variant:"fullscreen",footer:l.jsx(K,{variant:"primary",className:"w-full",onClick:t,children:"Done"}),children:[a?l.jsx("div",{className:"text-[12px] text-[rgba(159,178,215,0.75)] mb-3",children:a}):null,l.jsx("textarea",{id:u,value:r??"",onChange:d=>s==null?void 0:s(d.target.value),placeholder:i,className:"sheet-textarea ui-control ui-textarea",rows:12})]})}function En(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(2).replace(/\.?0+$/u,""):"1"}function $g(e=""){const t=String(e||"");if(!t.trim())return[];const n=[];let r=0;for(;r<t.length;){for(;r<t.length&&/[\s,]/.test(t[r]);)r++;if(r>=t.length)break;let s=r,i=r,a="tag",c="";const u=t[r]==="(";if(u&&(s=r,r++),t[r]==="$"){a="alias";const d=r;for(r++;r<t.length&&t[r]!=="$"&&t[r]!==","&&t[r]!==`
`;)c+=t[r],r++;t[r]==="$"&&r++,u||(s=d)}else if(u){for(a="tag";r<t.length&&!(t[r]===":"||t[r]===`
`||t[r]===")");)c+=t[r],r++;c=c.trim()}else{a="tag";const d=r;for(;r<t.length&&!(t[r]===","||t[r]==="$"||t[r]===`
`||t[r]==="(");)c+=t[r],r++;c=c.trim(),s=d}if(u&&t[r]===":"){for(r++;r<t.length&&t[r]!==")"&&t[r]!==","&&t[r]!==`
`;)r++;t[r]===")"&&r++}u&&t[r]===")"&&r++,i=r,c&&n.push({type:a,text:c,start:s,end:i})}return n}function Hl(e="",t){if(!t||typeof t.start!="number"||typeof t.end!="number")return null;const r=String(e||"").slice(t.start,t.end);if(!r.startsWith("(")||!r.includes(":"))return null;const s=r.lastIndexOf(":");if(s===-1)return null;const i=r.slice(s+1);if(!i.endsWith(")"))return null;const a=i.slice(0,-1).trim();if(!/^\d+(\.\d+)?$/u.test(a))return null;const c=Number.parseFloat(a);return Number.isFinite(c)?{weight:c,wrapperStart:t.start,wrapperEnd:t.end}:null}function gu(e="",t,n){const r=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return r;const s=n==null?null:Number(n),i=s===null||!Number.isFinite(s)||Math.abs(s-1)<1e-6,a=t.type==="alias"?`$${t.text}$`:t.text;if(i)return r.slice(0,t.start)+a+r.slice(t.end);const c=En(s),u=`(${a}:${c})`;return r.slice(0,t.start)+u+r.slice(t.end)}function yu(e="",t,n,r){var g;if(n===r||n===null||r===null||!(t!=null&&t.length))return e;const s=String(e||""),i=t.map(v=>({start:v.start,end:v.end,text:s.slice(v.start,v.end)})),a=i.slice(0,-1).map((v,w)=>{const k=i[w+1];return s.slice(v.end,k.start)}),c=i.length?s.slice(0,i[0].start):"",u=i.length?s.slice(i[i.length-1].end):"",d=[...i],[m]=d.splice(n,1);d.splice(r,0,m);let y=c+(((g=d[0])==null?void 0:g.text)||"");for(let v=1;v<d.length;v++)y+=(a[v-1]??", ")+d[v].text;return y+=u,y}function Mg(e="",t){const n=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return n;const r=n.slice(0,t.start).replace(/[\s,]*$/,""),s=n.slice(t.end).replace(/^[\s,]*/,"");return r?`${r}, ${s}`.trim():s.trim()}function ks(e="",t){if(!t||typeof t.index!="number"||typeof t.length!="number")return null;const n=String(e||""),r=t.index,s=t.index+t.length;if(r<=0||n[r-1]!=="("||n[s]!==":")return null;let i=s+1,a="";for(;i<n.length&&n[i]!==")";)if(a+=n[i],i+=1,a.length>12)return null;if(i>=n.length||n[i]!==")")return null;const c=a.trim();if(!/^\d+(\.\d+)?$/u.test(c))return null;const u=Number.parseFloat(c);return Number.isFinite(u)?{weight:u,wrapperStart:r-1,wrapperEnd:i+1}:null}function Yi(e="",t,n){const r=String(e||"");if(!t||typeof t.index!="number"||typeof t.length!="number")return r;const s=t.index,i=t.index+t.length,a=ks(r,t),c=n==null?null:Number(n),u=c===null||!Number.isFinite(c)||Math.abs(c-1)<1e-6;if(a){if(u)return r.slice(0,a.wrapperStart)+r.slice(s,i)+r.slice(a.wrapperEnd);const m=En(c);return r.slice(0,i+1)+m+r.slice(a.wrapperEnd-1)}if(u)return r;const d=En(c);return r.slice(0,s)+"("+r.slice(s,i)+":"+d+")"+r.slice(i)}function Qi(e,t,n){const r=Number(e);return Number.isFinite(r)?Math.max(t,Math.min(n,r)):t}function Va({open:e,onClose:t,title:n="Alias strength",tokenLabel:r="",weight:s=1,onApply:i,onRemoveWeight:a,onDeleteToken:c,onReplace:u,replaceLabel:d="Replace"}){const m=o.useMemo(()=>Qi(s||1,.2,2),[s]),[y,g]=o.useState(m);o.useEffect(()=>{e&&g(m)},[e,m]);const v=En(y);return l.jsx(Ht,{open:e,onClose:t,title:n,footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:t,children:"Cancel"}),l.jsx(K,{variant:"primary",className:"w-full",onClick:()=>{i==null||i(y),t==null||t()},children:"Done"})]}),children:l.jsxs("div",{className:"sheet-stack token-strength-sheet",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Alias"}),l.jsx("div",{className:"sheet-hint",children:r||""})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Strength"}),l.jsxs("div",{className:"token-strength-row",children:[l.jsx(K,{size:"sm",variant:"muted",onClick:()=>g(w=>Qi(w-.05,.2,2)),children:""}),l.jsxs("div",{className:"token-strength-value tabular-nums",children:[v,""]}),l.jsx(K,{size:"sm",variant:"muted",onClick:()=>g(w=>Qi(w+.05,.2,2)),children:"+"})]}),l.jsx("input",{type:"range",min:.2,max:2,step:.05,value:y,onChange:w=>g(Qi(w.target.value,.2,2)),className:"ui-range","aria-label":"Alias strength"}),l.jsx("div",{className:"sheet-hint token-strength-hint",children:"1.0 is normal. Increase to emphasize or reduce to soften."})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Actions"}),l.jsxs("div",{className:"token-strength-actions",children:[l.jsx(K,{size:"sm",variant:"ghost",onClick:()=>g(1),children:"Reset"}),u?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"token-strength-divider","aria-hidden":"true",children:"|"}),l.jsx(K,{size:"sm",variant:"ghost",onClick:()=>{u==null||u(),t==null||t()},children:d})]}):null,l.jsx("span",{className:"token-strength-divider","aria-hidden":"true",children:"|"}),l.jsx(K,{size:"sm",variant:"danger",onClick:()=>{c==null||c(),t==null||t()},children:"Delete"})]})]})]})})}function ts(e){const t=String(e||"").trim();if(!t)return"";const n=t.toLowerCase(),r={scifi:"Sci-Fi",sci:"Sci",ui:"UI",vfx:"VFX",hdr:"HDR",dof:"DoF",bokeh:"Bokeh",vhs:"VHS",jpeg:"JPEG",jpg:"JPG",png:"PNG",gif:"GIF",webp:"WebP",api:"API",nsfw:"NSFW",sfw:"SFW",sfx:"SFX",fx:"FX",lora:"LoRA",loras:"LoRAs",ip:"IP",egirl:"E-girl",i2v:"I2V",t2i:"T2I",img2img:"Img2Img",txt2img:"Txt2Img",tts:"TTS",asmr:"ASMR",ai:"AI",highleg:"High-Leg","one-piece":"One-Piece","three-quarter":"Three-Quarter"};return r[n]?r[n]:/^\d+$/.test(n)?n:n==="3d"?"3D":n==="2d"?"2D":n.length===1?n.toUpperCase():n.charAt(0).toUpperCase()+n.slice(1)}function uS(e=""){const t=String(e||"").trim().toLowerCase();return t?t.startsWith("flirty_")?"flirty":t.startsWith("action_")||t.startsWith("dynamic_")||t.startsWith("stealth_")||t.startsWith("athletic_")||t.startsWith("running_")||t.startsWith("walking_")?"action":t.startsWith("sleepy_")||t.startsWith("relaxed_")||t.startsWith("reclining_")||t.startsWith("sitting_")||t.startsWith("kneeling_")?"rest":t.startsWith("happy_")||t.startsWith("sad_")||t.startsWith("angry_")||t.startsWith("nervous_")||t.startsWith("smug_")||t.startsWith("surprised_")||t.startsWith("scared_")||t.startsWith("tipsy_")?"emotion":t.startsWith("composed_")||t.startsWith("contemplative_")||t.startsWith("looking_")?"posed":"everyday":""}function dS(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return n==="lingerie"?"lingerie":n==="swimwear"||n==="swim"?"swimwear":n==="costumes"||n==="tech"?"costumes":n==="uniform"?"uniform":n==="formal"?"formal":n==="alt"?"alt":n==="casual"||n==="street"||n==="lounge"||n==="sporty"||n==="dress"?"everyday":n||"everyday"}function fS(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return["fire","candlelight","embers"].includes(n)?"fire":["moonlight"].includes(n)?"night":["neon"].includes(n)?"neon":["studio","stage","sidelighting","dim"].includes(n)?"studio":["golden","sunbeam","dappled"].includes(n)?"natural":["lens","light"].includes(n)?"effects":n||"other"}function Il(e="",t=""){const n=String(e||"").trim(),r=String(t||"").trim().toLowerCase();if(!n)return"";if(r==="outfit")return dS(n)||"everyday";if(r==="pose")return uS(n)||"everyday";if(r==="lighting")return fS(n)||"effects";const s=n.indexOf("_");return s<=0?"":n.slice(0,s).trim()}function Fg(e=""){const t=String(e||"").trim();return t?t.includes(":")?t.split(":").slice(1).join(":"):t:""}function Wa({token:e="",name:t=""}={}){const n=String(t||"").trim()||Fg(e);if(!n)return"";let s=n.replace(/_(\d+)$/u,"").split("_").filter(Boolean);if(s.length===0)return n;const i=[];for(let y=0;y<s.length;y++){const g=s[y],v=s[y+1];if(g&&v&&g.toLowerCase()==="one"&&v.toLowerCase()==="piece"){i.push("one-piece"),y+=1;continue}if(g&&v&&g.toLowerCase()==="three"&&v.toLowerCase()==="quarter"){i.push("three-quarter"),y+=1;continue}i.push(g)}if(s=i,Array.from(new Set(s.map(y=>String(y).toLowerCase()))).length===1)return ts(s[0]);const c=s[0],u=s.slice(1),d=ts(c),m=u.map(ts).join(" ").trim();return m?m.toLowerCase()===d.toLowerCase()?u.length===1&&String(u[0]).toLowerCase()===String(c).toLowerCase()?d||n:s.map(ts).join(" ").trim()||n:`${d} - ${m}`:s.map(ts).join(" ").trim()||n}function Nd(e){if(!e)return{subcategory:"",displayName:""};const t=e.name||"",n=e.token||"",r=Fg(n)||t,s=Il(r,e.category)||"other",i=Wa({token:n,name:t})||n||t||"Alias";return{subcategory:s,displayName:i}}function Gn(e=""){const t=String(e||"").trim();return t?t==="All"?"All":{action:"Actions",camera:"Camera",body:"Body",char:"Characters",mood:"Mood",outfit:"Outfits",pose:"Poses",prop:"Props",scene:"Scenes",weather:"Weather",style:"Style",hair:"Hair",lighting:"Lighting"}[t]||ts(t):""}function zn(e=""){const t=String(e||"").trim();return t?t==="All"?"All":t.split(/[_-]+/u).filter(Boolean).map(n=>ts(n)).join(" ").trim():""}function kp({open:e,onClose:t,isPromptLike:n,pickerSearch:r,onSearchChange:s,pickerSearchRef:i,categories:a,pickerCategory:c,onCategoryChange:u,subcategories:d,pickerSubcategory:m,onSubcategoryChange:y,filteredAliases:g,visibleAliases:v,visibleCount:w,onShowMore:k,listItemVisibilityStyles:j,onInsertAlias:h}){return l.jsx(Ht,{open:e,onClose:t,title:n?"Insert alias":"Aliases",footer:l.jsx(K,{variant:"primary",className:"w-full",onClick:t,children:"Done"}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Search"}),l.jsxs("div",{className:"composer-filters",children:[l.jsx("input",{ref:i,type:"text",value:r,onChange:f=>s(f.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),l.jsx(Je,{value:c,onChange:u,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:["All",...a.filter(f=>f!=="All")].map(f=>({value:f,label:f==="All"?"Category: All":Gn(f)}))}),d.length>2?l.jsx(Je,{value:m,onChange:y,wrapperClassName:"composer-subcategory-select",size:"sm",searchThreshold:0,options:d.map(f=>({value:f,label:f==="All"?"All subcategories":zn(f)}))}):null]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Results"}),l.jsx("div",{className:"composer-alias-list",children:g.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):l.jsxs(l.Fragment,{children:[v.map(f=>l.jsxs("button",{type:"button",onClick:()=>h(f.token,{closeAfter:!n}),className:"composer-alias-item",style:j,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:f.displayName||f.token}),f.category?l.jsx("span",{className:"composer-alias-category",children:Gn(f.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",f.token,"$"]}),l.jsx("div",{className:"composer-alias-text",children:f.text})]},f.key)),w<g.length?l.jsxs(K,{variant:"muted",className:"w-full",onClick:k,children:["Show more (",g.length-w," left)"]}):null]})})]})]})})}const Cp={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function pS({name:e,label:t,description:n,value:r,onChange:s,onEnter:i,disabled:a=!1,multiline:c=!1,aliasOptions:u=[],aliasCatalog:d=[],onOpenComposer:m}){var ct,jt;const y=o.useRef(null),g=o.useRef(null),v=o.useRef({start:null,end:null}),w=o.useRef(null),k=o.useRef(null),[j,h]=o.useState(null),[f,p]=o.useState(null),[x,b]=o.useState(!1),[C,z]=o.useState(""),$=o.useDeferredValue(C),[O,R]=o.useState("All"),[I,Z]=o.useState("All"),[X]=o.useState([]),de=o.useRef(null),[Se,ce]=o.useState(!1),[me,A]=o.useState(!1),[L,D]=o.useState(null),_=typeof r=="string"?r:String(r??"");o.useMemo(()=>Array.isArray(u)?u.filter(Boolean):[],[u]);const H=o.useMemo(()=>(Array.isArray(d)?d.filter(V=>V&&V.name):[]).map(V=>({...V,...Nd(V)})),[d]),Q=o.useMemo(()=>H,[H]),oe=V=>{const J=V.target.value;s==null||s(J)},ne=V=>{if(!c&&V.key==="Enter"){V.preventDefault(),i==null||i(V.target.value,V);return}},re=o.useMemo(()=>{const V=new Map;return Q.forEach(J=>{J!=null&&J.token&&V.set(String(J.token).toLowerCase(),J)}),V},[Q]),ae=o.useMemo(()=>{const V=new Set(["All"]);return H.forEach(J=>{J.category&&V.add(J.category)}),Array.from(V).sort((J,ye)=>J.localeCompare(ye))},[H]),Y=o.useMemo(()=>{const V=new Set(["All"]);return Q.forEach(J=>{(!O||O==="All"||J.category===O)&&J.subcategory&&V.add(J.subcategory)}),Array.from(V).sort((J,ye)=>J.localeCompare(ye))},[Q,O]);o.useEffect(()=>{Z("All")},[O]);const U=o.useMemo(()=>{const V=_||"";if(!V||!V.includes("$"))return[];const J=[],ye=/\$([a-z0-9_:-]+)\$/gi;let Ee;for(;Ee=ye.exec(V);)J.push({token:Ee[1],index:Ee.index,length:Ee[0].length});return J},[_]),W=()=>{try{const V=y.current;V?v.current={start:V.selectionStart??null,end:V.selectionEnd??null}:v.current={start:null,end:null}}catch{v.current={start:null,end:null}}g.current&&g.current.scrollIntoView({block:"center",behavior:"smooth"}),b(!0)},ue=o.useMemo(()=>{const V=$.trim().toLowerCase();return Q.filter(J=>{var ye,Ee,Ie,We;return O!=="All"&&(J.category||"")!==O||I!=="All"&&(J.subcategory||"other")!==I?!1:V?((ye=J.token)==null?void 0:ye.toLowerCase().includes(V))||((Ee=J.text)==null?void 0:Ee.toLowerCase().includes(V))||((Ie=J.name)==null?void 0:Ie.toLowerCase().includes(V))||((We=J.displayName)==null?void 0:We.toLowerCase().includes(V)):!0}).sort((J,ye)=>{const Ee=(J.subcategory||"").toLowerCase(),Ie=(ye.subcategory||"").toLowerCase();return Ee!==Ie?Ee.localeCompare(Ie):J.token.localeCompare(ye.token)})},[Q,O,I,$]),[je,_e]=o.useState(30),$e=o.useMemo(()=>ue.slice(0,je),[ue,je]);o.useEffect(()=>{_e(30)},[O,I,C,H]),o.useEffect(()=>{Z("All")},[O]);const ze=(V,{closeAfter:J=!0}={})=>{var Be,ht;const ye=y.current,Ee=`$${V}$`,Ie=_||"",We=(Be=v.current)==null?void 0:Be.start,Fe=(ht=v.current)==null?void 0:ht.end,Qe=(ye==null?void 0:ye.selectionStart)??(typeof We=="number"?We:Ie.length),B=(ye==null?void 0:ye.selectionEnd)??(typeof Fe=="number"?Fe:Ie.length),se=Ie.slice(0,Qe),P=Ie.slice(B),F=se.match(/[^\s]$/),q=P.match(/^[^\s]/),le=F&&F[0]!==","?", ":"",ke=q&&q[0]!==","?", ":"",fe=se+le+Ee+ke+P;s==null||s(fe);const we=(se+le+Ee+ke).length;v.current={start:we,end:we},J&&(b(!1),requestAnimationFrame(()=>{var Tt;(Tt=ye==null?void 0:ye.blur)==null||Tt.call(ye)}))},Te=V=>{const J=_||"",ye=ks(J,V),Ee=ye?ye.wrapperStart:V.index,Ie=ye?ye.wrapperEnd:V.index+V.length,We=J.slice(0,Ee).replace(/[\s,]*$/,""),Fe=J.slice(Ie).replace(/^[\s,]*/,""),Qe=We?`${We} ${Fe}`.trim():Fe.trim();s==null||s(Qe)},He=V=>{if(!V)return;const J=re.get(V.token.toLowerCase()),ye=(J==null?void 0:J.displayName)||V.token,Ee=ks(_||"",V);D({tokenObj:V,displayName:ye,weight:(Ee==null?void 0:Ee.weight)??1}),A(!0),requestAnimationFrame(()=>{var Ie,We;return(We=(Ie=y.current)==null?void 0:Ie.blur)==null?void 0:We.call(Ie)})},Ke=o.useMemo(()=>(V,J)=>{var P;if(V===J||V===null||J===null||!(U!=null&&U.length))return;const ye=_||"",Ee=U.map(F=>{const q=ks(ye,F),le=q?q.wrapperStart:F.index,ke=q?q.wrapperEnd:F.index+F.length;return{start:le,end:ke,text:ye.slice(le,ke)||`$${F.token}$`}}),Ie=Ee.slice(0,-1).map((F,q)=>{const le=Ee[q+1];return ye.slice(F.end,le.start)}),We=Ee.length?ye.slice(0,Ee[0].start):"",Fe=Ee.length?ye.slice(Ee[Ee.length-1].end):"",Qe=[...Ee],[B]=Qe.splice(V,1);Qe.splice(J,0,B);let se=We+(((P=Qe[0])==null?void 0:P.text)||"");for(let F=1;F<Qe.length;F+=1)se+=(Ie[F-1]??", ")+Qe[F].text;se+=Fe,s==null||s(se)},[s,U,_]),ve=(V,J)=>{h(J),w.current=V.currentTarget,V.dataTransfer.effectAllowed="move",V.dataTransfer.setData("text/plain",String(J)),requestAnimationFrame(()=>{w.current&&w.current.classList.add("is-dragging")})},Pe=(V,J)=>{V.preventDefault(),V.dataTransfer.dropEffect="move",J!==f&&p(J)},Ve=V=>{V!==f&&p(V)},T=V=>{j!==null&&V!==null&&j!==V&&Ke(j,V),h(null),p(null),w.current=null},ie=()=>{w.current&&w.current.classList.remove("is-dragging"),T(f)},ge=(V,J)=>{V.preventDefault(),T(J)},Ne=(V,J)=>{var Ie,We;if(!((We=(Ie=V.target)==null?void 0:Ie.closest)==null?void 0:We.call(Ie,".token-chip-drag-handle")))return;const Ee=V.touches[0];k.current={idx:J,startX:Ee.clientX,startY:Ee.clientY,moved:!1}},Re=V=>{if(!k.current)return;const J=V.touches[0],ye=Math.abs(J.clientX-k.current.startX),Ee=Math.abs(J.clientY-k.current.startY);if(ye<=10&&Ee<=10)return;k.current.moved=!0,h(k.current.idx),V.preventDefault();const Ie=g.current,We=Ie?Ie.querySelectorAll(".token-chip-draggable"):document.querySelectorAll(".token-chip-draggable"),Fe=J.clientX,Qe=J.clientY;for(let B=0;B<We.length;B++){const se=We[B].getBoundingClientRect();if(Fe>=se.left&&Fe<=se.right&&Qe>=se.top&&Qe<=se.bottom){p(B);break}}},pe=()=>{var V;(V=k.current)!=null&&V.moved&&j!==null&&f!==null&&j!==f&&Ke(j,f),k.current=null,h(null),p(null)},Ae={id:e,name:e,value:_,onChange:oe,disabled:a,className:"ui-control ui-input pr-10 text-[13px] sm:text-sm",placeholder:"","aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0},Ye=()=>{b(!1),requestAnimationFrame(()=>{var V,J;(J=(V=y.current)==null?void 0:V.blur)==null||J.call(V)})},tt=(()=>{const V=String(e||"").toLowerCase(),J=String(t||"").toLowerCase();return!!`${V} ${J}`.trim().includes("prompt")})();return c?l.jsxs("div",{className:"relative space-y-2",ref:g,children:[m&&!tt?l.jsxs("div",{className:"stringinput-toolbar",children:[l.jsx(K,{size:"sm",variant:"muted",onClick:()=>m(e),children:"Open composer"}),H.length?l.jsx(K,{size:"sm",variant:"ghost",onClick:W,children:"Aliases"}):null,l.jsx(K,{size:"sm",variant:"ghost",onClick:()=>ce(!0),children:"Expand"})]}):null,l.jsx("textarea",{ref:y,...Ae,rows:3,wrap:"soft",onKeyDown:ne,className:Ae.className+" resize-none min-h-[88px] max-h-[160px] leading-relaxed overflow-y-auto overflow-x-hidden break-words whitespace-pre-wrap",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"anywhere"}}),m&&tt?l.jsx("div",{className:"stringinput-underbar",children:l.jsxs("div",{className:"stringinput-underbar-actions",children:[l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>m(e),children:"Open composer"}),H.length?l.jsx(K,{size:"xs",variant:"ghost",onClick:W,children:"Insert alias"}):null]})}):null,l.jsx(cS,{open:Se,onClose:()=>ce(!1),title:t||e,value:_,onChange:s,description:n}),U.length?l.jsxs("div",{className:"stringinput-tokens",children:[l.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",l.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),l.jsx("div",{className:"stringinput-tokens-list",children:U.map((V,J)=>{var Qe;const ye=re.get(V.token.toLowerCase()),Ee=(ye==null?void 0:ye.displayName)||V.token,Ie=j===J,We=f===J&&j!==null&&j!==J,Fe=((Qe=ks(_||"",V))==null?void 0:Qe.weight)??1;return l.jsxs("div",{className:`ui-chip is-clickable token-chip token-chip-draggable ${Ie?"is-dragging":""} ${We?"is-drop-target":""}`,title:`$${V.token}$`,role:"button",tabIndex:0,draggable:!0,onDragStart:B=>ve(B,J),onDragEnd:ie,onDragEnter:()=>Ve(J),onDragOver:B=>Pe(B,J),onDrop:B=>ge(B,J),onTouchStart:B=>Ne(B,J),onTouchMove:Re,onTouchEnd:pe,onClick:()=>{j===null&&He(V)},onKeyDown:B=>{(B.key==="Enter"||B.key===" ")&&(B.preventDefault(),He(V))},children:[l.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:l.jsx(Da,{size:14})}),l.jsx("span",{className:"token-chip-label",children:Ee}),Math.abs(Fe-1)>1e-6?l.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${En(Fe)}x`,children:["",En(Fe)]}):null,l.jsx(K,{size:"mini",variant:"danger",onClick:B=>{B.stopPropagation(),Te(V)},"aria-label":`Remove ${V.token}`,children:l.jsx(Or,{size:12})})]},`${V.token}-${V.index}`)})})]}):null,l.jsx(Va,{open:me,onClose:()=>A(!1),title:"Alias strength",tokenLabel:L?`${L.displayName}  $${(ct=L.tokenObj)==null?void 0:ct.token}$`:"",weight:(L==null?void 0:L.weight)??1,onApply:V=>{L!=null&&L.tokenObj&&(s==null||s(Yi(_||"",L.tokenObj,V)))},onRemoveWeight:()=>{L!=null&&L.tokenObj&&(s==null||s(Yi(_||"",L.tokenObj,null)))},onDeleteToken:()=>{L!=null&&L.tokenObj&&Te(L.tokenObj)}}),x?l.jsx(kp,{open:x,onClose:Ye,isPromptLike:tt,pickerSearch:C,onSearchChange:z,pickerSearchRef:de,categories:ae,pickerCategory:O,onCategoryChange:R,subcategories:Y,pickerSubcategory:I,onSubcategoryChange:Z,filteredAliases:ue,visibleAliases:$e,visibleCount:je,onShowMore:()=>_e(V=>Math.min(V+30,ue.length)),listItemVisibilityStyles:Cp,onInsertAlias:ze}):null]}):l.jsxs("div",{className:"relative space-y-2",ref:g,children:[l.jsx("input",{...Ae,type:"text",inputMode:"text",autoComplete:"off",onKeyDown:ne,className:Ae.className+" min-h-[44px]",ref:y}),U.length?l.jsxs("div",{className:"stringinput-tokens",children:[l.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",l.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),l.jsx("div",{className:"stringinput-tokens-list",children:U.map((V,J)=>{var Qe;const ye=re.get(V.token.toLowerCase()),Ee=(ye==null?void 0:ye.displayName)||V.token,Ie=j===J,We=f===J&&j!==null&&j!==J,Fe=((Qe=ks(_||"",V))==null?void 0:Qe.weight)??1;return l.jsxs("div",{className:`ui-chip is-clickable token-chip token-chip-draggable ${Ie?"is-dragging":""} ${We?"is-drop-target":""}`,title:`$${V.token}$`,onClick:()=>{j===null&&He(V)},role:"button",tabIndex:0,draggable:!0,onDragStart:B=>ve(B,J),onDragEnd:ie,onDragEnter:()=>Ve(J),onDragOver:B=>Pe(B,J),onDrop:B=>ge(B,J),onTouchStart:B=>Ne(B,J),onTouchMove:Re,onTouchEnd:pe,onKeyDown:B=>{(B.key==="Enter"||B.key===" ")&&(B.preventDefault(),He(V))},children:[l.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:l.jsx(Da,{size:14})}),l.jsx("span",{className:"token-chip-label",children:Ee}),Math.abs(Fe-1)>1e-6?l.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${En(Fe)}x`,children:["",En(Fe)]}):null,l.jsx(K,{size:"mini",variant:"danger",onClick:B=>{B.stopPropagation(),Te(V)},"aria-label":`Remove ${V.token}`,children:l.jsx(Or,{size:12})})]},`${V.token}-${V.index}`)})})]}):null,l.jsx(Va,{open:me,onClose:()=>A(!1),title:"Alias strength",tokenLabel:L?`${L.displayName}  $${(jt=L.tokenObj)==null?void 0:jt.token}$`:"",weight:(L==null?void 0:L.weight)??1,onApply:V=>{L!=null&&L.tokenObj&&(s==null||s(Yi(_||"",L.tokenObj,V)))},onRemoveWeight:()=>{L!=null&&L.tokenObj&&(s==null||s(Yi(_||"",L.tokenObj,null)))},onDeleteToken:()=>{L!=null&&L.tokenObj&&Te(L.tokenObj)}}),H.length?l.jsx(K,{size:"sm",variant:"ghost",className:"stringinput-trailing",onClick:()=>m?m(e):W(),title:m?"Open prompt composer":"Insert alias","aria-label":m?"Open prompt composer":"Insert alias",children:m?l.jsx(yo,{size:16}):l.jsx(dr,{size:16})}):null,l.jsx(kp,{open:x,onClose:Ye,isPromptLike:tt,pickerSearch:C,onSearchChange:z,pickerSearchRef:de,categories:ae,pickerCategory:O,onCategoryChange:R,subcategories:Y,pickerSubcategory:I,onSubcategoryChange:Z,filteredAliases:ue,visibleAliases:$e,visibleCount:je,onShowMore:()=>_e(V=>Math.min(V+30,ue.length)),listItemVisibilityStyles:Cp,onInsertAlias:ze})]})}const Og=o.memo(pS),Np=e=>e==null?void 0:String(e).trim().replace(/[^A-Za-z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||void 0;function hS({name:e,label:t,description:n,value:r,onChange:s,disabled:i=!1,min:a,max:c,step:u,isFloat:d=!1,inputId:m}){const y=u??(d?.01:1),g=m??Np(e),v=j=>{if(j===""||j===null||j===void 0)return"";const h=d?parseFloat(j):parseInt(j,10);return Number.isNaN(h)?"":h},w=j=>{const h=j.target.value,f=v(h);s==null||s(f)},k=j=>{if(j.key!=="ArrowUp"&&j.key!=="ArrowDown")return;j.preventDefault();const h=typeof r=="number"?r:v(String(r??""))||0,f=j.key==="ArrowUp"?y:-y;let p=h+f;if(typeof a=="number"&&(p=Math.max(a,p)),typeof c=="number"&&(p=Math.min(c,p)),d){const x=typeof y=="number"?(String(y).split(".")[1]||"").length:2;p=parseFloat(p.toFixed(Math.max(x,2)))}s==null||s(p)};return l.jsxs("div",{className:"w-full flex items-center gap-2",children:[l.jsx("input",{id:g,name:e,type:"number",inputMode:d?"decimal":"numeric",value:r??"",onChange:w,onKeyDown:k,disabled:i,min:a,max:c,step:y,"aria-label":t||e,"aria-describedby":n?`${g||Np(e)||e}-description`:void 0,className:"ui-control ui-input"}),typeof a=="number"||typeof c=="number"?l.jsxs("div",{className:"hidden sm:flex flex-col text-[10px] text-[#6A6FA8] text-right leading-tight",children:[typeof a=="number"&&l.jsxs("span",{children:["min ",a]}),typeof c=="number"&&l.jsxs("span",{children:["max ",c]})]}):null]})}const Gl=o.memo(hS);function mS({name:e,label:t,description:n,value:r,onChange:s,disabled:i=!1}){const a=!!r,c=()=>{i||s==null||s(!a)},u=d=>{(d.key===" "||d.key==="Enter")&&(d.preventDefault(),c())};return l.jsxs("button",{id:e,type:"button",role:"switch","aria-checked":a,"aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0,onClick:c,onKeyDown:u,disabled:i,className:`ui-switch ${a?"is-on":""}`,children:[l.jsx("span",{className:"ui-switch-track",children:l.jsx("span",{className:"ui-switch-knob"})}),l.jsx("span",{className:"ui-switch-state",children:a?"On":"Off"})]})}const Dg=o.memo(mS);function gS(e,t){try{if(typeof window>"u"||!e)return null;const n=e.getItem(t);return n?JSON.parse(n):null}catch{return null}}function jo(e,t,n){try{if(typeof window>"u"||!e)return;e.setItem(t,JSON.stringify(n))}catch{}}function Rn(){try{return typeof window>"u"?null:window.sessionStorage||null}catch{return null}}function il(){try{return typeof window>"u"?null:window.localStorage||null}catch{return null}}const Bg=750,ir=new Map,Un=new Map,Vn=new Map,Vs=new Map,Wn=new Map,Hn=new Map;function Ug(e){var t;if(Un.has(e)&&(clearTimeout(Un.get(e)),Un.delete(e)),Vn.has(e)){try{(t=window.cancelIdleCallback)==null||t.call(window,Vn.get(e))}catch{}Vn.delete(e)}ir.has(e)&&(jo(Rn(),e,ir.get(e)),ir.delete(e))}function yS(e){var r;if(Un.has(e)&&(clearTimeout(Un.get(e)),Un.delete(e)),Vn.has(e)){try{(r=window.cancelIdleCallback)==null||r.call(window,Vn.get(e))}catch{}Vn.delete(e)}const t=()=>{ir.has(e)&&(jo(Rn(),e,ir.get(e)),ir.delete(e))},n=setTimeout(()=>{Un.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const s=window.requestIdleCallback(()=>{Vn.delete(e),t()},{timeout:2500});Vn.set(e,s);return}}catch{}t()},Bg);Un.set(e,n)}function vS(){Array.from(Un.values()).forEach(e=>clearTimeout(e)),Un.clear(),Array.from(Vn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),Vn.clear(),Array.from(ir.entries()).forEach(([e,t])=>{jo(Rn(),e,t)}),ir.clear(),Array.from(Wn.values()).forEach(e=>clearTimeout(e)),Wn.clear(),Array.from(Hn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),Hn.clear(),Array.from(Vs.entries()).forEach(([e,t])=>{try{const n=Rn();n&&n.setItem(e,t)}catch{}}),Vs.clear()}if(typeof window<"u"&&!window.__cozygenFormStateFlush){const e=()=>vS();window.addEventListener("beforeunload",e),window.addEventListener("pagehide",e),window.__cozygenFormStateFlush=!0}function xS(e){var r;if(!e)return{};const t=`${e}_formData`,n=gS(Rn(),t);if(n&&typeof n=="object")return n;try{const s=il();(r=s==null?void 0:s.removeItem)==null||r.call(s,t)}catch{}return{}}function Ha(e,t,n={}){var i;if(!e)return;const{immediate:r=!1}=n||{},s=`${e}_formData`;if(r){Ug(s),jo(Rn(),s,t||{});try{const a=il();(i=a==null?void 0:a.removeItem)==null||i.call(a,s)}catch{}return}ir.set(s,t||{}),yS(s)}function wS(e){e&&Ug(`${e}_formData`)}function SS(e,t,n=Bg){var i;if(Vs.set(e,t),Wn.has(e)&&(clearTimeout(Wn.get(e)),Wn.delete(e)),Hn.has(e)){try{(i=window.cancelIdleCallback)==null||i.call(window,Hn.get(e))}catch{}Hn.delete(e)}const r=()=>{const a=Vs.get(e);Vs.delete(e);try{const c=Rn();c&&c.setItem(e,a)}catch{}},s=setTimeout(()=>{Wn.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const a=window.requestIdleCallback(()=>{Hn.delete(e),r()},{timeout:2e3});Hn.set(e,a);return}}catch{}r()},n);Wn.set(e,s)}function jS(e,t={}){var s,i;const{immediate:n=!1}=t||{},r="cozygen_last_param";if(n){if(Wn.has(r)&&(clearTimeout(Wn.get(r)),Wn.delete(r)),Hn.has(r)){try{(s=window.cancelIdleCallback)==null||s.call(window,Hn.get(r))}catch{}Hn.delete(r)}Vs.delete(r);try{const a=Rn();a&&a.setItem(r,e||"");const c=il();(i=c==null?void 0:c.removeItem)==null||i.call(c,r)}catch{}return}SS(r,e||"")}function kS(){var t,n;const e="cozygen_last_param";try{const r=Rn(),s=((t=r==null?void 0:r.getItem)==null?void 0:t.call(r,e))||"";if(s)return s;const i=il();(n=i==null?void 0:i.removeItem)==null||n.call(i,e)}catch{}return""}function Vg(e,t){const n=e?String(e):"global",r=t?String(t):"";return`cozygen_dropdown_folder:${n}:${r}`}function bp(e,t){var r,s;const n=Vg(e,t);try{const i=Rn(),a=((r=i==null?void 0:i.getItem)==null?void 0:r.call(i,n))||"";if(a)return a;const c=il();(s=c==null?void 0:c.removeItem)==null||s.call(c,n)}catch{}return""}function CS(e,t,n){var s;const r=Vg(e,t);try{const i=Rn();i&&i.setItem(r,String(n||""));const a=il();(s=a==null?void 0:a.removeItem)==null||s.call(a,r)}catch{}}function NS({workflowName:e,name:t,label:n,description:r,value:s,onChange:i,disabled:a=!1,options:c=[]}){const u=s??"",[d,m]=o.useState(()=>bp(e,t)||"All");o.useEffect(()=>{const x=bp(e,t);m(x||"All")},[e,t]);const y=o.useMemo(()=>(c||[]).map(x=>typeof x=="string"?{value:x,label:x}:{value:x.value??x.name??"",label:x.label??x.name??String(x.value??"")}),[c]),g=x=>{const b=typeof(x==null?void 0:x.value)=="string"||typeof(x==null?void 0:x.value)=="number"?String(x.value):"",C=typeof(x==null?void 0:x.label)=="string"||typeof(x==null?void 0:x.label)=="number"?String(x.label):"";return Zs(b)?b:Zs(C)?C:""},v=o.useMemo(()=>y.map(x=>{const b=g(x);if(!b)return{opt:x,path:"",base:"",folderPath:""};const{folderPath:C,base:z}=So(b);return{opt:x,path:b,base:z,folderPath:C||"root"}}),[y]),w=o.useMemo(()=>{const x=new Set(["All"]);return v.forEach(({path:b,folderPath:C})=>{b&&x.add(C||"root")}),Array.from(x).sort((b,C)=>b.localeCompare(C))},[v]),k=w.length>2;o.useEffect(()=>{if(!k){d!=="All"&&m("All");return}w.includes(d)||m("All")},[w,d,k]),o.useEffect(()=>{CS(e,t,d)},[e,t,d]);const j=o.useMemo(()=>{const x=new Map;return v.forEach(({base:b})=>{if(!b)return;const C=b.toLowerCase();x.set(C,(x.get(C)||0)+1)}),x},[v]),h=o.useMemo(()=>{const x=[],b=k&&d==="All";return v.forEach(({opt:C,path:z,base:$,folderPath:O})=>{if(!z){x.push(C);return}const R=O||"root";if(k&&d!=="All"&&R!==d)return;let I=$||Dn(z)||C.label;if(b&&$){const Z=$.toLowerCase();if(j.get(Z)>1){const X=R==="root"?"root":R.split("/").pop()||R;I=`${I} (${X})`}}x.push({...C,label:I})}),x.sort((C,z)=>String(C.label||"").localeCompare(String(z.label||"")))},[v,j,d,k]),f=o.useMemo(()=>u===""||u===null||u===void 0?!0:h.some(x=>String(x.value)===String(u)),[h,u]),p=x=>{const b=x&&x.target?x.target.value:x;i==null||i(b)};return l.jsxs("div",{className:"w-full space-y-2",children:[k?l.jsx("div",{className:"relative w-full",children:l.jsx(Je,{value:d,onChange:m,disabled:a,"aria-label":`Choose folder for ${n||t}`,size:"sm",options:w.map(x=>({value:x,label:x}))})}):null,l.jsx("div",{className:"relative w-full",children:l.jsx(Je,{id:t,name:t,value:u,onChange:p,disabled:a,"aria-label":n||t,"aria-describedby":r?`${t}-description`:void 0,placeholder:h.length>0&&(u===void 0||u==="")?"Select...":void 0,emptyLabel:"No matches",options:[...!f&&u!==""?[{value:u,label:Dn(String(u))}]:[],...h]},`${t||"field"}:${d}`)})]})}const bd=o.memo(NS);function Ep(e=[]){return e.map(t=>typeof t=="string"?{value:t,label:t}:{value:t.value??t.name??"",label:t.label??t.name??String(t.value??"")})}function Lp(e,t){if(!e)return null;const n=String(e);if(t==="high"){const r=n.match(/(.+)-high(\.[^.]*)?$/i);return r?r[1]:null}if(t==="low"){const r=n.match(/(.+)-low(\.[^.]*)?$/i);return r?r[1]:null}return null}function bS(e){return e?e.replace(/[_-]+/g," ").replace(/\s+/g," ").trim().replace(/^./,t=>t.toUpperCase()):""}const ES=(...e)=>e.flat().map(n=>String(n??"").trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")).filter(Boolean).join("-")||"field";function LS({name:e,label:t,description:n,highParam:r,lowParam:s,highChoices:i=[],lowChoices:a=[],formData:c={},onChangeParam:u,highStrengthParam:d,lowStrengthParam:m,strengthValue:y,onChangeStrength:g,highStrengthValue:v,lowStrengthValue:w,onChangeHighStrength:k,onChangeLowStrength:j,disabled:h=!1}){const f=o.useMemo(()=>Ep(i),[i]),p=o.useMemo(()=>Ep(a),[a]),x=o.useMemo(()=>{const re=new Map;p.forEach(Y=>{const U=Lp(Y.value,"low");U&&(re.has(U)||re.set(U,Y))});const ae=[];return f.forEach(Y=>{const U=Lp(Y.value,"high");if(!U)return;const W=re.get(U);W&&ae.push({base:U,label:bS(U),highValue:Y.value,lowValue:W.value})}),ae.sort((Y,U)=>Y.label.localeCompare(U.label)),ae},[f,p]),b=o.useMemo(()=>{const re=c[r],ae=c[s];if(!re||!ae)return"";const Y=x.find(U=>U.highValue===re&&U.lowValue===ae);return Y?Y.base:""},[c,r,s,x]),C=d||m||`${e}_strength`,z=o.useMemo(()=>ES(e||"lora",C||"strength"),[e,C]),$=!!(d||m),O=!!(d&&m),R=(re,ae=1)=>typeof re=="number"?re:ae,I=R(typeof y=="number"?y:typeof v=="number"?v:typeof w=="number"?w:void 0,1),Z=R(typeof v=="number"?v:void 0,I),X=R(typeof w=="number"?w:void 0,O?I:Z),de=O&&Math.abs(Z-X)>1e-4,[Se,ce]=o.useState(de);o.useEffect(()=>{ce(de)},[de,r,s]);const me=re=>{if(!u)return;const ae=x.find(Y=>Y.base===re);ae&&(u(r,ae.highValue),u(s,ae.lowValue))};if(x.length===0)return l.jsxs("div",{className:"text-[11px] text-[#9DA3FFCC]",children:["No matching ",l.jsx("span",{className:"font-semibold",children:"-high"})," /"," ",l.jsx("span",{className:"font-semibold",children:"-low"})," LoRA pairs found."]});const A=`${z}-linked`,L=`${z}-high`,D=`${z}-low`,_=O?"Linked":"Strength",H=O?"Applies to high + low":d||m||"",Q=(re,ae)=>{const Y=Array.isArray(re)?re:[re];let U=!1;Y.forEach(W=>{if(W==="high"&&typeof k=="function"){k(ae);return}if(W==="low"&&typeof j=="function"){j(ae);return}typeof g=="function"&&!U&&(g(ae),U=!0)})},oe=re=>{(d||!d&&!m)&&Q("high",re),m&&Q("low",re)},ne=()=>{O&&ce(re=>{const ae=!re;return ae||oe(typeof Z=="number"?Z:typeof X=="number"?X:I),ae})};return l.jsxs("div",{className:"space-y-2",children:[l.jsx(bd,{name:`${e}_pair`,label:t,description:n,value:b||"",onChange:me,disabled:h,options:x.map(re=>({value:re.base,label:re.label}))}),$&&l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-[10px] uppercase tracking-[0.16em] text-[#9DA3FFCC]",children:"Strength"}),O&&l.jsx("button",{type:"button",className:"text-[10px] font-semibold tracking-[0.12em] uppercase text-[#E5E7FF]",onClick:ne,disabled:h,children:Se?"Link values":"Split values"})]}),Se&&O?l.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-3",children:[l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:L,className:"lora-strength-label is-high",children:[l.jsx("span",{className:"lora-strength-label-pill",children:"High"}),l.jsxs("span",{className:"lora-strength-label-text",children:["High strength",d&&l.jsx("span",{className:"lora-strength-label-hint",children:d})]})]}),l.jsx(Gl,{name:`${C}_high`,label:"High strength",description:"",value:Z,onChange:re=>Q("high",re),disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:L})]}),l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:D,className:"lora-strength-label is-low",children:[l.jsx("span",{className:"lora-strength-label-pill",children:"Low"}),l.jsxs("span",{className:"lora-strength-label-text",children:["Low strength",m&&l.jsx("span",{className:"lora-strength-label-hint",children:m})]})]}),l.jsx(Gl,{name:`${C}_low`,label:"Low strength",description:"",value:X,onChange:re=>Q("low",re),disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:D})]})]}):l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:A,className:"lora-strength-label is-linked",children:[l.jsx("span",{className:"lora-strength-label-pill",children:_}),l.jsxs("span",{className:"lora-strength-label-text",children:["LoRA strength",H&&l.jsx("span",{className:"lora-strength-label-hint",children:H})]})]}),l.jsx(Gl,{name:C,label:"LoRA strength",description:"",value:I,onChange:oe,disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:A})]})]})]})}function PS(e,t){if(e.disabled!==t.disabled||e.name!==t.name||e.label!==t.label||e.description!==t.description||e.highParam!==t.highParam||e.lowParam!==t.lowParam||e.highStrengthParam!==t.highStrengthParam||e.lowStrengthParam!==t.lowStrengthParam||e.strengthValue!==t.strengthValue||e.highStrengthValue!==t.highStrengthValue||e.lowStrengthValue!==t.lowStrengthValue||e.highChoices!==t.highChoices||e.lowChoices!==t.lowChoices||e.onChangeParam!==t.onChangeParam||e.onChangeStrength!==t.onChangeStrength||e.onChangeHighStrength!==t.onChangeHighStrength||e.onChangeLowStrength!==t.onChangeLowStrength)return!1;const n=e.formData||{},r=t.formData||{};return!(n[e.highParam]!==r[t.highParam]||n[e.lowParam]!==r[t.lowParam])}const Wg=o.memo(LS,PS),zS=16,_S=[" - "," ","-","_"],Hg=e=>[...new Set(e.filter(Boolean))],Ga=(e,t)=>{const n=String(e||"").trim(),r=_S.map(s=>`${n}${s}${t}`);return r.push(`${n}${t}`),Hg(r)},Pp=(e,t)=>{const n=Ga(`${e} Strength`,t),r=Ga(e,t).map(s=>`${s} Strength`);return Hg([...n,...r])},zp=e=>String(e||"").toLowerCase().replace(/[\s_-]+/g,""),qi=(e,t=[])=>{if(!e)return null;const n=Array.isArray(t)?t:[t];for(const s of n){if(!s)continue;const i=e.get(s);if(i)return{name:s,input:i}}const r=new Map;n.forEach(s=>{s&&r.set(zp(s),s)});for(const[s,i]of e.entries()){const a=zp(s);if(r.has(a))return{name:s,input:i}}return null},RS=Array.from({length:zS},(e,t)=>{const n=t+1,r=Ga("Lora High",n),s=Ga("Lora Low",n),i=Pp("Lora High",n),a=Pp("Lora Low",n);return{id:`video_lora_${n}`,label:`Video LoRA ${n}`,highParam:r[0],lowParam:s[0],highParamAliases:r,lowParamAliases:s,highStrengthParam:i[0],lowStrengthParam:a[0],highStrengthParamAliases:i,lowStrengthParamAliases:a}}),AS=e=>{var r,s;const t=((r=e==null?void 0:e.inputs)==null?void 0:r.param_type)||((s=e==null?void 0:e.inputs)==null?void 0:s.Param_type),n=String(t||"STRING").toUpperCase();return["NUMBER","FLOAT","INT"].includes(n)?"NUMBER":["BOOLEAN","BOOL"].includes(n)?"BOOLEAN":["DROPDOWN","CHOICE","SELECT"].includes(n)?"DROPDOWN":"STRING"},IS=e=>{const t=(e==null?void 0:e.inputs)||{};return t.label||t.display_name||t.title||t.param_name||(e==null?void 0:e.title)||(e==null?void 0:e.class_type)||"Parameter"},TS=e=>{const t=(e==null?void 0:e.inputs)||{};return t.description||t.help||t.tooltip||t.doc||""},Cs=e=>{const t=(e==null?void 0:e.inputs)||{};return t.param_name||t.name||t.key||t.id||`param_${(e==null?void 0:e.id)||"unknown"}`},Tl=e=>{const t=(e==null?void 0:e.inputs)||{},n=t.choices||t.options||[],r=t.default_value??t.value??t.default_choice??(n&&n.length?n[0]:"")??"";return{paramName:Cs(e),label:IS(e),description:TS(e),paramType:AS(e),multiline:!!t.multiline,min:typeof t.min=="number"?t.min:void 0,max:typeof t.max=="number"?t.max:void 0,step:typeof t.step=="number"?t.step:void 0,choices:n,defaultValue:r}},$S=(e,t)=>{if((e==null?void 0:e.paramType)==="BOOLEAN")return t?"On":"Off";if(t==null||t==="")return"Empty";if(typeof t=="string"){const n=t.trim();if(!n)return"Empty";const r=240,s=140,i=n.length>r?n.slice(0,r):n,c=/[\r\n\t]/.test(i)||/\s{2,}/u.test(i)?i.replace(/\s+/gu," ").trim():i;if(c.length>s)return`${c.slice(0,s)}`;const u=lS(c);return n.length>r?`${u}`:u}return String(t)};function MS({id:e,label:t,description:n,preview:r,expanded:s=!1,onToggle:i,children:a,trailing:c,className:u=""}){const d=typeof i=="function",m=e?`${e}-description`:void 0,y=e?`${e}-panel`:void 0,g=typeof t=="string"?t.trim().replace(/\s+/gu," ").replace(/:\s*$/u,""):t,v=typeof n=="string"?n.trim().replace(/\s+/gu," "):n,w=typeof r=="string"||typeof r=="number"?String(r):void 0,k=d?"button":"div",j=d?{type:"button",onClick:i,"aria-expanded":s,"aria-controls":y,"aria-describedby":v?m:void 0}:{};return l.jsxs("div",{className:["field-row",u].filter(Boolean).join(" "),children:[l.jsxs(k,{...j,className:["field-row-head",d?"is-collapsible":"is-static",s?"is-expanded":""].filter(Boolean).join(" "),children:[l.jsxs("div",{className:"field-row-main",children:[l.jsx("div",{className:"field-row-label",children:g}),v?l.jsx("div",{id:m,className:"field-row-description",children:v}):null]}),l.jsxs("div",{className:"field-row-trailing",children:[c?l.jsx("div",{className:"field-row-trailing-control",children:c}):null,r?l.jsx("div",{className:"field-row-preview",title:w,children:r}):null,d?l.jsx("div",{className:"field-row-chevron","aria-hidden":"true",children:l.jsx(vo,{size:16})}):null]})]}),d&&s?l.jsx("div",{id:y,className:"field-row-body",children:a}):null]})}const vu=o.memo(MS);function FS({paramName:e,cfg:t,formData:n,loraPair:r,collapsed:s,onToggle:i,formatPreview:a,onChangeParam:c,changeHandlers:u}){const{id:d,label:m,highParam:y,lowParam:g,highStrengthParam:v,lowStrengthParam:w,highCfg:k,lowCfg:j}=r,h=v?n[v]:void 0,f=w?n[w]:void 0,p=h??f??1,x=s?a(t,[n[y],n[g]].filter(Boolean).join("  ")):null,b=e?`param-${e}`:void 0;return l.jsx("div",{id:b,"data-param-name":e,"data-param-label":m||t.label,"data-param-type":"lora_pair",className:"settings-row",children:l.jsx(vu,{id:e,label:m||t.label,description:t.description,preview:x,expanded:!s,onToggle:i,children:s?null:l.jsx(Wg,{name:d||y,label:m||t.label,highParam:y,lowParam:g,highChoices:k.choices,lowChoices:j.choices,formData:n,onChangeParam:c,highStrengthParam:v,lowStrengthParam:w,strengthValue:p,highStrengthValue:h,lowStrengthValue:f,onChangeHighStrength:v?u.get(v):void 0,onChangeLowStrength:w?u.get(w):void 0,disabled:!1},`lora-${e}`)})})}function OS({paramName:e,cfg:t,formData:n,workflowName:r,spotlightName:s,spotlightRenderKey:i,aliasOptions:a,aliasCatalog:c,onOpenComposer:u,changeHandlers:d,enterHandlers:m,collapsed:y,previewValue:g,onToggle:v}){const w=n[e],k={name:e,label:t.label,description:t.description,value:w,disabled:!1,defaultValue:t.defaultValue},j=(f=n,p=!1)=>{const x={...k,value:f==null?void 0:f[e]};return t.paramType==="NUMBER"?l.jsx(Gl,{...x,inputId:e,onChange:d.get(e),min:t.min,max:t.max,step:t.step,isFloat:!0},`field-${e}-number-${i}`):t.paramType==="BOOLEAN"?l.jsx(Dg,{...x,onChange:d.get(e)},`field-${e}-bool-${i}`):t.paramType==="DROPDOWN"?l.jsx(bd,{...x,workflowName:r,onChange:d.get(e),options:t.choices||[]},`field-${e}-dropdown-${i}`):l.jsx(Og,{...x,aliasOptions:a,aliasCatalog:c,onOpenComposer:u,onChange:d.get(e),onEnter:m.get(e),multiline:t.multiline||s===e||p},`field-${e}-string-${i}`)},h=e?`param-${e}`:void 0;return t.paramType==="BOOLEAN"?l.jsx("div",{id:h,"data-param-name":e,"data-param-label":t.label,"data-param-type":"single",className:"settings-row",children:l.jsx(vu,{id:e,label:t.label,description:t.description,trailing:j(n,!0)})}):l.jsx("div",{id:h,"data-param-name":e,"data-param-label":t.label,"data-param-type":"single",className:"settings-row",children:l.jsx(vu,{id:e,label:t.label,description:t.description,preview:g,expanded:!y,onToggle:v,children:y?null:j(n,!0)})})}function DS({inputs:e=[],formData:t={},onFormChange:n,workflowName:r,onParamEdited:s,onSpotlight:i,compactControls:a=!0,collapseAllKey:c=0,collapseAllCollapsed:u=!0,lastEditedParam:d="",spotlightName:m="",onCloseSpotlight:y=()=>{},onVisibleParamsChange:g=()=>{},aliasOptions:v=[],aliasCatalog:w=[],onOpenComposer:k}){const[j,h]=o.useState({}),[f,p]=o.useState(0),x=o.useRef(t);o.useEffect(()=>{x.current=t},[t]);const b=o.useCallback((L,D)=>$S(L,D),[]),C=o.useCallback((L,D)=>{!n||!L||(n(L,D),s==null||s(L),h(_=>(_==null?void 0:_[L])===!1?_:{..._,[L]:!1}))},[n,s]),z=o.useCallback(L=>{L&&h(D=>({...D,[L]:!(D!=null&&D[L])}))},[]),$=o.useMemo(()=>e||[],[e]),O=o.useMemo(()=>{const L=new Map;return($||[]).forEach(D=>{const _=Cs(D);_&&L.set(_,H=>C(_,H))}),L},[C,$]),R=o.useMemo(()=>{const L=new Map;return($||[]).forEach(D=>{const _=Cs(D);_&&L.set(_,(H,Q)=>{var oe,ne;C(_,H),(ne=(oe=Q==null?void 0:Q.target)==null?void 0:oe.blur)==null||ne.call(oe),m===_&&(y==null||y())})}),L},[C,y,m,$]),I=o.useMemo(()=>{const L=new Map;return($||[]).forEach(D=>{const _=Cs(D);_&&L.set(_,()=>z(_))}),L},[z,$]);o.useEffect(()=>{const L={};(e||[]).forEach(D=>{const _=Cs(D);_&&(L[_]=u)}),d&&(L[d]=!1),h(L)},[c,u,e,d]);const Z=o.useMemo(()=>{const L=new Map;return(e||[]).forEach(D=>{const _=Cs(D);_&&L.set(_,D)}),L},[e]),X=o.useMemo(()=>{const L=[];return RS.forEach(D=>{const _=qi(Z,D.highParamAliases||D.highParam),H=qi(Z,D.lowParamAliases||D.lowParam);if(!_||!H)return;const Q=_.input,oe=H.input,ne=Tl(Q),re=Tl(oe);if(ne.paramType!=="DROPDOWN"||re.paramType!=="DROPDOWN")return;const ae=ne.choices||[],Y=re.choices||[];if(!ae.length||!Y.length)return;const U=qi(Z,D.highStrengthParamAliases||D.highStrengthParam),W=qi(Z,D.lowStrengthParamAliases||D.lowStrengthParam);L.push({...D,highParam:_.name,lowParam:H.name,highStrengthParam:U==null?void 0:U.name,lowStrengthParam:W==null?void 0:W.name,highInput:Q,lowInput:oe,highCfg:ne,lowCfg:re})}),L},[Z]),de=o.useMemo(()=>{const L=new Map;return X.forEach(D=>{L.set(D.highParam,D)}),L},[X]),Se=o.useMemo(()=>{const L=new Set;return X.forEach(D=>{L.add(D.highParam),L.add(D.lowParam),D.highStrengthParam&&L.add(D.highStrengthParam),D.lowStrengthParam&&L.add(D.lowStrengthParam)}),L},[X]),ce=o.useMemo(()=>{const L=[];return($||[]).forEach(D=>{const _=Tl(D),H=_.paramName,Q=de.get(H);if(Q){L.push({name:H,label:Q.label||_.label,description:_.description,render:oe=>{const ne=oe||x.current||{},re=Q.highStrengthParam?ne[Q.highStrengthParam]:void 0,ae=Q.lowStrengthParam?ne[Q.lowStrengthParam]:void 0,Y=re??ae??1;return l.jsx(Wg,{name:Q.id||Q.highParam,label:Q.label||_.label,highParam:Q.highParam,lowParam:Q.lowParam,highChoices:Q.highCfg.choices,lowChoices:Q.lowCfg.choices,formData:ne,onChangeParam:C,highStrengthParam:Q.highStrengthParam,lowStrengthParam:Q.lowStrengthParam,strengthValue:Y,highStrengthValue:re,lowStrengthValue:ae,onChangeHighStrength:Q.highStrengthParam?O.get(Q.highStrengthParam):void 0,onChangeLowStrength:Q.lowStrengthParam?O.get(Q.lowStrengthParam):void 0,disabled:!1},`lora-${H}-${f}`)}});return}Se.has(H)||L.push({name:H,label:_.label,description:_.description,render:oe=>{const ne=oe||x.current||{},re={name:H,label:_.label,description:_.description,value:ne[H],defaultValue:_.defaultValue,disabled:!1};return _.paramType==="NUMBER"?l.jsx(Gl,{...re,onChange:O.get(H),min:_.min,max:_.max,step:_.step,isFloat:!0},`field-${H}-number-${f}`):_.paramType==="BOOLEAN"?l.jsx(Dg,{...re,onChange:O.get(H)},`field-${H}-bool-${f}`):_.paramType==="DROPDOWN"?l.jsx(bd,{...re,workflowName:r,onChange:O.get(H),options:_.choices||[]},`field-${H}-dropdown-${f}`):l.jsx(Og,{...re,aliasOptions:v,aliasCatalog:w,onOpenComposer:k,onChange:O.get(H),onEnter:R.get(H),multiline:_.multiline},`field-${H}-string-${f}`)}})}),L},[$,de,Se,f,r,v,w,k,C,O,R,m,y]),me=o.useMemo(()=>{const L=new Map;return ce.forEach(D=>L.set(D.name,D)),L},[ce]);o.useEffect(()=>{g==null||g(ce.map(L=>L.name))},[ce,g]);const A=o.useCallback(L=>{const D=ce.map(ne=>ne.name),_=me.get(L);if(!_)return;const H=D.indexOf(L),Q=H>0?D[H-1]:null,oe=H>=0&&H<D.length-1?D[H+1]:null;p(ne=>ne+1),i==null||i({name:L,label:_.label,description:_.description,render:ne=>_.render(ne||x.current),order:D,index:H>=0?H:0,total:D.length,onPrev:Q?()=>A(Q):null,onNext:oe?()=>A(oe):null})},[me,i,ce]);return l.jsx("div",{className:"settings-list",children:$.map(L=>{const D=Tl(L),_=D.paramName,H=de.get(_);if(H){const ne=a?j[_]??!0:!!j[_];return l.jsx(FS,{paramName:_,cfg:D,formData:t,loraPair:H,collapsed:ne,onToggle:I.get(_),formatPreview:b,onChangeParam:C,changeHandlers:O},`lora_pair_${H.id||H.highParam}`)}if(Se.has(_))return null;const Q=a?j[_]??!0:!!j[_],oe=Q?b(D,t[_]):null;return l.jsx(OS,{paramName:_,cfg:D,formData:t,workflowName:r,spotlightName:m,spotlightRenderKey:f,aliasOptions:v,aliasCatalog:w,onOpenComposer:k,changeHandlers:O,enterHandlers:R,collapsed:Q,previewValue:oe,onToggle:I.get(_)},_)})})}function BS(e){return(e||[]).map(t=>{var n;if(["CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"].includes(t.class_type)){let r=t.class_type.replace("CozyGen","").replace("Input","").toUpperCase();return r==="CHOICE"&&(r="DROPDOWN"),{...t,inputs:{...t.inputs,param_type:r,Multiline:((n=t.inputs)==null?void 0:n.display_multiline)||!1}}}return t})}function US({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:i=!1,collapseAllState:a=null,onSpotlight:c,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:y=[],aliasCatalog:g=[],onOpenComposer:v}){const w=o.useMemo(()=>BS((t||[]).filter(k=>k.class_type!=="CozyGenImageInput")),[t]);return l.jsx("section",{className:"settings-surface scroll-mt-24",ref:s,children:l.jsx(DS,{workflowName:e,inputs:w,formData:n,onFormChange:r,compactControls:i,collapseAllKey:(a==null?void 0:a.key)??0,collapseAllCollapsed:(a==null?void 0:a.collapsed)??!0,onSpotlight:c,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:y,aliasCatalog:g,onOpenComposer:v})})}function VS({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,parameterSectionRef:s,compactControls:i=!0,collapseAllState:a=null,onSpotlight:c,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:y=[],aliasCatalog:g=[],onOpenComposer:v}){return l.jsx(US,{workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:i,collapseAllState:a,onSpotlight:c,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:y,aliasCatalog:g,onOpenComposer:v})}function _p(e){try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return""}}function WS({open:e,onClose:t,logs:n=[],onClear:r}){const s=o.useMemo(()=>(n||[]).map(i=>`[${_p(i.ts)}] ${String(i.level||"info").toUpperCase()} ${i.message}`).join(`
`),[n]);return l.jsx(Ht,{open:e,onClose:t,title:"Run logs",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:()=>{var i,a;try{(a=(i=navigator.clipboard)==null?void 0:i.writeText)==null||a.call(i,s||"")}catch{}},children:"Copy"}),l.jsx(K,{variant:"ghost",className:"w-full",onClick:r,children:"Clear"}),l.jsx(K,{variant:"primary",className:"w-full",onClick:t,children:"Close"})]}),children:l.jsx("pre",{className:"runlog-pre",children:n!=null&&n.length?n.map((i,a)=>l.jsxs("div",{className:`runlog-line is-${i.level||"info"}`,children:[l.jsx("span",{className:"runlog-ts",children:_p(i.ts)}),l.jsx("span",{className:"runlog-msg",children:i.message})]},`${i.ts}-${a}`)):"No logs yet."})})}const HS="cozygen_field_order_v1";function GS(e,t){if(!e)return t;try{const n=JSON.parse(e);return n&&typeof n=="object"?n:t}catch{return t}}function KS(){if(typeof window>"u")return{};try{return GS(window.localStorage.getItem(HS),{})}catch{return{}}}function YS(e){if(Array.isArray(e))return{order:e.filter(Boolean),hidden:{}};if(!e||typeof e!="object")return{order:[],hidden:{}};const t=Array.isArray(e.order)?e.order.filter(Boolean):[],n=e.hidden&&typeof e.hidden=="object"?e.hidden:{};return{order:t,hidden:n}}function QS(e){if(!e)return{order:[],hidden:{}};const n=KS()[e];return YS(n)}function qS(e,t){let n=Array.isArray(t)?t:[];if(!e||n.length===0)return n;const{order:r,hidden:s}=QS(e);if(r&&r.length){const i=new Map;n.forEach(c=>{var d;const u=(d=c==null?void 0:c.inputs)==null?void 0:d.param_name;u&&!i.has(u)&&i.set(u,c)});const a=[];r.forEach(c=>{const u=i.get(c);u&&(a.push(u),i.delete(c))}),n.forEach(c=>{var d;const u=(d=c==null?void 0:c.inputs)==null?void 0:d.param_name;if(!u){a.push(c);return}i.has(u)&&(a.push(c),i.delete(u))}),n=a}return n=n.filter(i=>{var c;const a=(c=i==null?void 0:i.inputs)==null?void 0:c.param_name;return a?!s[a]:!0}),n}function XS(){const[e,t]=o.useState([]),[n,r]=o.useState(null),[s,i]=o.useState(!0),[a,c]=o.useState(null);o.useEffect(()=>{let d=!1;async function m(){i(!0),c(null);try{const y=await g0();if(d)return;const g=(y==null?void 0:y.workflows)||[];t(g);let v=null;try{if(v=typeof window<"u"?sessionStorage.getItem("selectedWorkflow"):null,typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{v=null}if(v&&g.includes(v))r(v);else if(g.length>0){r(g[0]);try{typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",g[0])}catch{}}else r(null)}catch(y){if(d)return;console.error("Failed to load workflows",y),c(y)}finally{d||i(!1)}}return m(),()=>{d=!0}},[]);const u=o.useCallback(d=>{r(d);try{if(typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",d),typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{}},[]);return{workflows:e,selectedWorkflow:n,selectWorkflow:u,loading:s,error:a}}const JS={clip_name1:"clip",clip_name2:"clip",unet_name:"unet",vae_name:"vae",sampler_name:"sampler",scheduler:"scheduler"},ZS=["CozyGenDynamicInput","CozyGenImageInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"];function e1(e){const[t,n]=o.useState(null),[r,s]=o.useState([]),[i,a]=o.useState({}),[c,u]=o.useState(!1),[d,m]=o.useState(null);o.useEffect(()=>{if(!e){n(null),s([]),a({});return}let w=!1;const k=new AbortController;async function j(){u(!0),m(null);try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:workflow:load")}catch{}try{const h=await y0(e,{signal:k.signal});if(w)return;for(const C in h){const z=h[C];z.class_type==="CozyGenImageInput"&&!z.inputs.param_name&&(z.inputs.param_name="Image Input"),h[C].id=C}n(h);const f=Object.values(h).filter(C=>ZS.includes(C.class_type)),p=await Promise.all(f.map(async C=>{const z=C.class_type==="CozyGenDynamicInput"&&C.inputs.param_type==="DROPDOWN",$=C.class_type==="CozyGenChoiceInput";if(z||$){const O=C.inputs.param_name;let R=C.inputs.choice_type||C.properties&&C.properties.choice_type;if(!R&&z&&(R=JS[O]),R)try{const I=await uu(R,{signal:k.signal,refresh:R==="loras"});C.inputs.choices=I.choices||[]}catch(I){(I==null?void 0:I.name)!=="AbortError"&&console.error(`Choices for ${O} failed`,I),C.inputs.choices=[]}}return C}));if(w)return;s(p);const x=xS(e),b={};p.forEach(C=>{const z=C.inputs.param_name;if(!z)return;if(x[z]!==void 0){b[z]=x[z];return}let $;if(["CozyGenDynamicInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput"].includes(C.class_type)){if($=C.inputs.default_value,C.class_type==="CozyGenIntInput"){const O=parseInt($,10);$=Number.isNaN(O)?0:O}else if(C.class_type==="CozyGenFloatInput"){const O=parseFloat($);$=Number.isNaN(O)?0:O}}else if(C.class_type==="CozyGenChoiceInput"){const O=C.inputs.choices||[];$=O.length?O[0]:""}else C.class_type,$="";b[z]=$}),a(b);try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:workflow:ready"),performance.measure(`cozygen:workflow:ready:${e||"unknown"}`,"cozygen:workflow:load","cozygen:workflow:ready"))}catch{}}catch(h){if(w)return;console.error("Failed to load workflow",h),m(h),n(null),s([])}finally{w||u(!1)}}return j(),()=>{wS(e),w=!0,k.abort()}},[e]);const y=o.useMemo(()=>r.filter(w=>w.class_type==="CozyGenImageInput"),[r]),g=y[0]||null,v=o.useCallback((w,k)=>{a(j=>{const h={...j,[w]:k};return e&&Ha(e,h),h})},[e]);return{workflowData:t,dynamicInputs:r,imageInputs:y,primaryImageInput:g,formData:i,setFormData:a,handleFormChange:v,loading:c,error:d}}const Rp="::";function Kl(e){const t={};return Object.entries(e||{}).forEach(([n,r])=>{const s=String(n||"").trim();if(!s||typeof r!="string")return;const i=r.trim();i&&(t[s]=i)}),t}function Ed(e){const t=new Map;return Object.entries(Kl(e)).forEach(([n,r])=>{const s=n.toLowerCase();t.set(s,r),s.includes(Rp)&&t.set(s.replace(Rp,":"),r)}),t}function Gg(e,t){if(typeof e!="string"||!e.includes("$"))return e;const n=t instanceof Map?t:Ed(t);return n.size?e.replace(/\$([a-z0-9_:-]+)\$/gi,(r,s)=>{const i=n.get(s.toLowerCase());return typeof i=="string"?i:r}):e}function t1(e,t){const n=t instanceof Map?t:Ed(t);if(!n.size||!e||typeof e!="object")return e;let r=!1;const s={};return Object.entries(e).forEach(([i,a])=>{if(typeof a=="string"){const c=Gg(a,n);s[i]=c,c!==a&&(r=!0)}else s[i]=a}),r?s:e}function Ld(e){return e?JSON.parse(JSON.stringify(e)):{}}function n1(e,t,n){const r=Ld(e),s={...n||{}};if(!t||!Array.isArray(t))return{workflow:r,formData:s};for(const i of t){if(!i||!i.id||!i.inputs||!r[i.id])continue;const a=i.inputs.param_name;if(!a||i.class_type==="CozyGenImageInput")continue;let c=s[a];const u=r[i.id];if(!u||!u.inputs)continue;const d=i.class_type;c===void 0&&(d==="CozyGenChoiceInput"?c=i.inputs.value??i.inputs.default_choice??(i.inputs.choices&&i.inputs.choices[0])??"":c=i.inputs.default_value),c===void 0&&(c=""),s[a]=c,d==="CozyGenFloatInput"||d==="CozyGenIntInput"||d==="CozyGenStringInput"||d==="CozyGenDynamicInput"?u.inputs.default_value=c:d==="CozyGenChoiceInput"&&(u.inputs.value=c)}return{workflow:r,formData:s}}function Pd(){const[e,t]=o.useState(()=>typeof document>"u"?!0:document.visibilityState!=="hidden");return o.useEffect(()=>{if(typeof document>"u")return;const n=()=>{t(document.visibilityState!=="hidden")};return document.addEventListener("visibilitychange",n),()=>document.removeEventListener("visibilitychange",n)},[]),e}function r1({selectedWorkflow:e,workflowData:t,dynamicInputs:n,imageInputs:r,formData:s,setFormData:i,promptAliases:a=null}){const c=Pd(),[u,d]=o.useState(!1),[m,y]=o.useState(!1),[g,v]=o.useState(0),[w,k]=o.useState(0),[j,h]=o.useState("Idle"),[f,p]=o.useState("idle"),[x,b]=o.useState([]),C=o.useRef({ts:0,value:0,max:0}),z=o.useRef(null),$=o.useRef({value:0,max:0}),O=o.useRef(null),R=o.useRef(null),I=o.useRef(t),Z=o.useRef(s),X=o.useRef(!1),de=o.useRef(0),Se=o.useRef(0),ce=o.useRef("idle"),me=o.useRef(null),A=o.useRef(null);o.useEffect(()=>{I.current=t},[t]),o.useEffect(()=>{X.current=m},[m]),o.useEffect(()=>{de.current=g},[g]),o.useEffect(()=>{Se.current=w},[w]),o.useEffect(()=>{ce.current=f},[f]),o.useEffect(()=>{Z.current=s},[s]);const L=()=>{me.current&&(clearTimeout(me.current),me.current=null)},D=()=>{A.current&&(clearTimeout(A.current),A.current=null)},_=()=>{R.current&&(clearTimeout(R.current),R.current=null)},H=()=>{z.current&&(cancelAnimationFrame(z.current),z.current=null)},Q=o.useCallback((W,ue,je=null)=>{const _e={ts:Date.now(),level:W||"info",message:String(ue||""),extra:je||null};b($e=>{const ze=[...$e||[],_e];return ze.length>250?ze.slice(ze.length-250):ze})},[]),oe=o.useCallback(()=>b([]),[]),ne=()=>{if(!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent("cozygen:queue-finished"))}catch{}},re=()=>{D(),A.current=setTimeout(()=>{X.current||(p("idle"),h("Idle"),v(0),k(0))},8e3)},ae=o.useCallback(()=>{L(),d(!1),y(!1),v(0),k(0),h("Finished"),p("finished"),Q("success","Finished"),re(),ne()},[Q]),Y=o.useCallback((W="Error")=>{L(),d(!1),y(!1),h(W),p("error"),Q("error",W||"Error"),re()},[Q]);o.useEffect(()=>{L(),!(!m||!w||w<=0||g<w)&&(me.current=setTimeout(()=>{const W=X.current,ue=de.current,je=Se.current,_e=ce.current;W&&je>0&&ue>=je&&_e!=="finished"&&_e!=="error"&&ae()},800))},[m,g,w,ae]),o.useEffect(()=>{if(typeof window>"u"||!c&&!m)return;let W=!1,ue=1e3;const je=()=>{if(W||!c&&!X.current)return;const _e=window.location.protocol==="https:"?"wss":"ws",$e=window.location.host,ze=vd(),Te=`${_e}://${$e}/ws${ze?`?token=${encodeURIComponent(ze)}`:""}`,He=new WebSocket(Te);O.current=He,He.onopen=()=>{ue=1e3},He.onmessage=Ke=>{var Ve,T,ie;if(typeof Ke.data!="string")return;let ve;try{ve=JSON.parse(Ke.data)}catch{return}const Pe=ve.type;if(Pe==="cozygen_batch_ready"){ae();return}if(Pe==="execution_success"||Pe==="execution_finished"){X.current&&ae();return}if(Pe==="execution_error"||Pe==="execution_interrupted"){Q("error","Execution error"),Y("Execution error");return}if(Pe==="status"){const ge=ve.data||{},Ne=ge.status||ge,Re=Ne.exec_info||ge.exec_info||Ne;if(Re&&X.current){const pe=Re.queue_remaining??Re.queue_pending??Re.queue_remaining_items??0;(Re.queue_running??Re.running??0)===0&&pe===0&&ae()}return}if(Pe==="executing"){D(),p("running");const ge=(Ve=ve.data)==null?void 0:Ve.node,Ne=I.current;if(ge&&Ne&&Ne[ge]){const Re=Ne[ge],pe=Re.title||Re.class_type||"Node";Q("info",`Executing: ${pe}`,{nodeId:ge}),h(`Executing: ${pe}`)}else Q("info","Executing"),h("Executing");return}if(Pe==="progress"){const ge=((T=ve.data)==null?void 0:T.value)??0,Ne=((ie=ve.data)==null?void 0:ie.max)??0;$.current={value:ge,max:Ne},z.current||(z.current=window.requestAnimationFrame(()=>{z.current=null;const Ye=$.current;v(Ye.value),k(Ye.max)}));const Re=Date.now(),pe=C.current;Re-pe.ts>2500&&(ge!==pe.value||Ne!==pe.max)&&Ne>0&&(C.current={ts:Re,value:ge,max:Ne},Q("info",`Progress: ${ge}/${Ne}`));return}},He.onclose=()=>{W||!c&&!X.current||(_(),R.current=setTimeout(je,ue),ue=Math.min(Math.ceil(ue*1.6),15e3))}};return je(),()=>{W=!0,L(),D(),_(),H(),O.current&&(O.current.onclose=null,O.current.close())}},[Q,Y,ae,c,m]);const U=o.useCallback(async(W={})=>{if(!t)return;const{overrides:ue=null,persistFormState:je=!0}=W||{};L(),D(),d(!0),y(!0),h("Queuing prompt"),p("queued"),v(0),k(0),Q("info","Queuing prompt",{workflow:e||""});const _e=Z.current||{},$e=ue?{..._e,...ue||{}}:_e,ze=t1($e,a||{}),{workflow:Te,formData:He}=n1(t,n||[],ze||{}),Ke={...He,...$e};je&&e&&Ha(e,Ke),je&&i(Ke);const ve=r||[];for(const Pe of ve){if(!Pe||!Pe.id||!Pe.inputs)continue;const Ve=Pe.inputs.param_name;if(!Ve)continue;const T=Ke[Ve];if(!T){alert(`Please upload or select an image for "${Ve}" before generating.`),Y("Missing image input");return}Te[Pe.id]&&Te[Pe.id].inputs&&(Te[Pe.id].inputs.image_filename=T)}try{let Pe=Te;if(a){const Ve=T=>{if(typeof T=="string")return Gg(T,a);if(Array.isArray(T))return T.map(ie=>Ve(ie));if(T&&typeof T=="object"){const ie=Array.isArray(T)?[]:{};return Object.entries(T).forEach(([ge,Ne])=>{ie[ge]=Ve(Ne)}),ie}return T};try{Pe=Ve(Te)}catch{Pe=Te}}Cg({workflowName:e,workflow:Pe,timestamp:Date.now()}),await xd({prompt:Pe}),Q("info","Prompt queued")}catch(Pe){console.error("Failed to queue prompt",Pe),Pe!=null&&Pe.unauthorized?(Q("error","Session expired. Please sign in again."),Y("Session expired. Please sign in again."),window.location.hash="#/login"):(Q("error","Error queuing prompt"),Y("Error queuing prompt"))}},[t,n,r,a,e,i,Y,Q]);return{isLoading:u,progressValue:g,progressMax:w,statusText:j,statusPhase:f,handleGenerate:U,logEntries:x,clearLogs:oe}}const Kg="cozygen_prompt_aliases",Yg="cozygen_alias_categories",Qg="cozygen_alias_category_list";function Ap(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Kg);return e?JSON.parse(e)||{}:{}}catch{return{}}}function ic(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Kg,JSON.stringify(e||{}))}catch{}}function Ip(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Yg);return e?JSON.parse(e)||{}:{}}catch{return{}}}function ac(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Yg,JSON.stringify(e||{}))}catch{}}function Tp(){if(typeof window>"u")return[];try{const e=window.localStorage.getItem(Qg);return Array.isArray(JSON.parse(e))?JSON.parse(e):[]}catch{return[]}}function oc(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Qg,JSON.stringify(e||[]))}catch{}}function qg(){const[e,t]=o.useState(()=>Ap()),[n,r]=o.useState(()=>Ip()),[s,i]=o.useState(()=>Tp()),[a,c]=o.useState(!1),[u,d]=o.useState(!1),[m,y]=o.useState(null),g=o.useCallback(async()=>{c(!0),y(null);try{const j=await w0(),h=Kl((j==null?void 0:j.items)||j||{}),f=(j==null?void 0:j.categories)||{},p=Array.isArray(j==null?void 0:j.categoryList)?j.categoryList:[];t(h),r(f),i(p),ic(h),ac(f),oc(p)}catch(j){console.error("Failed to load prompt aliases",j),y(j);const h=Kl(Ap()),f=Ip(),p=Tp();t(h),r(f),i(p)}finally{c(!1)}},[]),v=o.useCallback(async j=>{const h=(j==null?void 0:j.items)||j||{},f=(j==null?void 0:j.categories)||n||{},p=Array.isArray(j==null?void 0:j.categoryList)&&j.categoryList.length?j.categoryList:s.length?s:Array.from(new Set(Object.values(f).filter(Boolean))),x=Kl(h||{});d(!0),y(null);try{await S0({items:x,categories:f,categoryList:p}),t(x),r(f),i(p),ic(x),ac(f),oc(p)}catch(b){throw console.error("Failed to save prompt aliases",b),y(b),ic(x),ac(f),oc(p),b}finally{d(!1)}},[n,s]);o.useEffect(()=>{g()},[g]);const w=o.useMemo(()=>{const j=Ed(e),h=new Map(j);return Object.entries(n||{}).forEach(([f,p])=>{const x=String(p||"").trim();x&&(e!=null&&e[f])&&h.set(`${x}:${f}`,e[f])}),h},[e,n]),k=o.useMemo(()=>{const j=new Set,h=[];return w.forEach((f,p)=>{let x=p.includes("::")?p.replace("::",":"):p;const b=x.split(":");b.length>=3&&b[0]&&b[1]&&b[0].toLowerCase()===b[1].toLowerCase()&&(x=[b[0],...b.slice(2)].join(":"));const C=x.toLowerCase();j.has(C)||(j.add(C),h.push(x))}),h},[w]);return{aliases:e,aliasCategories:n,categoryList:s,aliasLookup:w,aliasOptions:k,loading:a,saving:u,error:m,refreshAliases:g,persistAliases:v}}const Xg=o.createContext(null);function zd(){const e=o.useContext(Xg);if(!e)throw new Error("useStudioContext must be used within a StudioProvider");return e}function s1({children:e}){const{workflows:t,selectedWorkflow:n,selectWorkflow:r,loading:s,error:i}=XS(),{workflowData:a,dynamicInputs:c,imageInputs:u,primaryImageInput:d,formData:m,setFormData:y,handleFormChange:g,loading:v,error:w}=e1(n),k=qg(),j=o.useMemo(()=>{const Z=[];return Object.entries(k.aliases||{}).forEach(([X,de])=>{const Se=String(X).split("::"),ce=Se.length>1,me=k.aliasCategories&&k.aliasCategories[X]||(ce?Se[0]:""),A=ce?Se.slice(1).join("::"):X,L={key:X,name:A,category:me,text:de,token:me?`${me}:${A}`:A};Z.push({...L,...Nd(L)})}),Z},[k.aliases,k.aliasCategories]),h=o.useMemo(()=>qS(n,c),[n,c]),f=o.useMemo(()=>{const Z=(h||c||[]).filter(A=>(A==null?void 0:A.class_type)!=="CozyGenImageInput"),X=/\b(checkpoint|ckpt|lora|model|vae|embedding|clip|sampler|scheduler|seed)\b/i,de=A=>{const L=String((A==null?void 0:A.paramName)||"").toLowerCase(),D=String((A==null?void 0:A.label)||"").toLowerCase(),_=`${L} ${D}`,H=m==null?void 0:m[A==null?void 0:A.paramName],Q=typeof H=="string"?H:"";let oe=0;return _.includes("prompt")&&(oe+=100),_.includes("negative")&&_.includes("prompt")&&(oe-=15),A!=null&&A.multiline&&(oe+=10),Q.includes("$")&&(oe+=20),X.test(_)&&(oe-=200),Tg(Q)&&(oe-=200),oe};if(typeof(m==null?void 0:m.prompt)=="string")return"prompt";const Se=Z.map(A=>Tl(A)).filter(A=>(A==null?void 0:A.paramType)==="STRING"&&(A==null?void 0:A.paramName));if(!Se.length)return"prompt";let ce=Se[0],me=de(ce);for(let A=1;A<Se.length;A+=1){const L=Se[A],D=de(L);D>me&&(ce=L,me=D)}return(ce==null?void 0:ce.paramName)||"prompt"},[c,m,h]),{isLoading:p,progressValue:x,progressMax:b,statusText:C,statusPhase:z,handleGenerate:$,logEntries:O,clearLogs:R}=r1({selectedWorkflow:n,workflowData:a,dynamicInputs:c,imageInputs:u,formData:m,setFormData:y,promptAliases:k.aliasLookup});o.useEffect(()=>{if(z==="finished"&&!(typeof window>"u")){try{window.localStorage.setItem("cozygen_gallery_pending","1")}catch{}window.dispatchEvent(new Event("cozygen:gallery-pending"))}},[z]),o.useEffect(()=>{if(typeof window>"u")return;const Z=z==="queued"||z==="running"||p;try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:Z}}))}catch{}},[z,p]);const I=o.useMemo(()=>({workflows:t,selectedWorkflow:n,selectWorkflow:r,workflowsLoading:s,workflowsError:i,workflowData:a,dynamicInputs:c,orderedDynamicInputs:h,imageInputs:u,primaryImageInput:d,formData:m,setFormData:y,handleFormChange:g,workflowLoading:v,workflowError:w,promptFieldName:f,aliasOptions:k.aliasOptions,aliasCatalog:j,aliasLookup:k.aliasLookup,aliasCategories:k.aliasCategories,aliasLoading:k.loading,aliasSaving:k.saving,aliasError:k.error,refreshAliases:k.refreshAliases,persistAliases:k.persistAliases,isLoading:p,progressValue:x,progressMax:b,statusText:C,statusPhase:z,handleGenerate:$,logEntries:O,clearLogs:R}),[t,n,r,s,i,a,c,h,u,d,m,y,g,v,w,f,k.aliasOptions,k.aliasLookup,k.aliasCategories,j,k.loading,k.saving,k.error,k.refreshAliases,k.persistAliases,p,x,b,C,z,$,O,R]);return l.jsx(Xg.Provider,{value:I,children:e})}function l1(){const e=qn(),{workflows:t=[],selectedWorkflow:n,selectWorkflow:r,workflowData:s,dynamicInputs:i=[],imageInputs:a=[],formData:c,setFormData:u,handleFormChange:d,aliasOptions:m,aliasCatalog:y,isLoading:g,progressValue:v,progressMax:w,statusText:k,statusPhase:j,handleGenerate:h,logEntries:f,clearLogs:p,promptFieldName:x,orderedDynamicInputs:b}=zd(),C=o.useRef(null),z=o.useRef(null),[$,O]=o.useState(()=>kS()),[R,I]=o.useState(null),Z=(R==null?void 0:R.name)||"",X=o.useCallback(()=>I(null),[]),[de,Se]=o.useState(!1),[ce,me]=o.useState([]),[A,L]=o.useState([]),[D,_]=o.useState(""),[H,Q]=o.useState(""),[oe,ne]=o.useState(""),re=o.useRef(new Map),ae=o.useCallback((T="")=>{const ge=`?field=${encodeURIComponent(T||x||"prompt")}`;e(`/compose${ge}`)},[e,x]),Y=o.useCallback(T=>{!T||T===n||(n&&Ha(n,c||{},{immediate:!0}),_(""),Q(""),ne(""),r(T))},[c,n,r]),U=o.useMemo(()=>{const ie=[...b||[],...a||[]].map(ge=>{var Ne;return(Ne=ge==null?void 0:ge.inputs)==null?void 0:Ne.param_name}).filter(ge=>ge&&typeof ge=="string");return new Set(ie)},[b,a]),W=o.useCallback(T=>{Q(T);const ie=A.find(Re=>Re.id===T);if(_((ie==null?void 0:ie.name)||""),!T||!(ie!=null&&ie.values)||!n){T||ne("");return}const ge=U,Ne={};Object.entries(ie.values).forEach(([Re,pe])=>{(!ge.size||ge.has(Re))&&(Ne[Re]=pe)}),u(Re=>{const pe={...Re,...Ne};return Ha(n,pe,{immediate:!0}),pe}),ne(`Applied "${ie.name}".`)},[U,A,n,u]),ue=a||[],je=!!(s&&n),_e=ue.length>0,$e=o.useCallback((T,ie)=>{const ge=re.current;ie&&T&&ge.set(T,ie);const Ne=ce.length?ce:(ie==null?void 0:ie.order)||[],Re=Ne.length,pe=Re>0?Ne.indexOf(T):-1,Ae=pe>0?Ne[pe-1]:null,Ye=pe>=0&&pe<Re-1?Ne[pe+1]:null,tt=Ae?ge.get(Ae):null,ct=Ye?ge.get(Ye):null;return{...ie,index:pe>=0?pe:0,total:Re,onPrev:tt?()=>I($e(Ae,tt)):null,onNext:ct?()=>I($e(Ye,ct)):null,onRender:h}},[ce,h]),ze=o.useCallback(T=>{const ie=T||[];me(ge=>ge.length===ie.length&&ge.every((Ne,Re)=>Ne===ie[Re])?ge:ie)},[]),Te=o.useCallback(T=>{const ie=T||"";O(ie),jS(ie)},[]),He=o.useCallback(T=>{T!=null&&T.name&&I($e(T.name,T))},[$e]),Ke=o.useCallback(async T=>{if(!T){L([]),Q("");return}try{const ie=await j0(T),ge=Array.isArray(ie==null?void 0:ie.presets)?ie.presets:[];L(ge),Q(Ne=>Ne&&ge.some(Re=>Re.id===Ne)?Ne:"")}catch(ie){console.error("Failed to load workflow presets",ie),L([]),ne("Presets unavailable.")}},[]);o.useEffect(()=>{Ke(n)},[n,Ke]);const ve=o.useCallback(async()=>{if(!n)return;const T=D.trim();if(!T){ne("Name a preset to save.");return}const ie={},ge=U;Object.entries(c||{}).forEach(([pe,Ae])=>{(!ge.size||ge.has(pe))&&(ie[pe]=Ae)});const Ne=A.find(pe=>pe.id===H),Re=Ne&&Ne.name.toLowerCase()===T.toLowerCase()?Ne.id:void 0;try{const pe=await k0(n,{id:Re,name:T,values:ie}),Ae=Array.isArray(pe==null?void 0:pe.presets)?pe.presets:[],Ye=pe==null?void 0:pe.preset;L(Ae),Ye!=null&&Ye.id&&Q(Ye.id),ne(`Saved "${T}".`)}catch(pe){console.error("Failed to save preset",pe),ne("Save failed.")}},[U,c,D,A,H,n]),Pe=o.useCallback(async()=>{if(!(!n||!H))try{const T=await C0(n,H),ie=Array.isArray(T==null?void 0:T.presets)?T.presets:[];L(ie),Q(""),ne("Preset deleted.")}catch(T){console.error("Failed to delete preset",T),ne("Delete failed.")}},[H,n]),Ve=o.useCallback(()=>{var T;return(T=R==null?void 0:R.render)==null?void 0:T.call(R,c)},[R,c]);return o.useEffect(()=>{const T=()=>{!je||g||h()};return window.addEventListener("cozygen:request-render",T),()=>window.removeEventListener("cozygen:request-render",T)},[h,je,g]),!t||t.length===0?l.jsx("div",{className:"page-shell",children:l.jsx("div",{className:"ui-card px-3 py-3 sm:px-4 sm:py-4",children:l.jsx("p",{className:"text-sm text-[#9DA3FFCC]",children:"No workflows found. Drop a workflow file in CozyGen and refresh."})})}):l.jsxs("div",{className:"page-shell page-stack has-dock controls-page",children:[l.jsxs("div",{className:"page-bar controls-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Controls"}),l.jsx("div",{className:"page-bar-actions",children:$?l.jsxs("span",{className:"controls-meta",children:["Last: ",$]}):null})]}),l.jsxs("section",{className:"controls-board",children:[l.jsx(oS,{workflows:t,selectedWorkflow:n,onWorkflowChange:Y,workflowData:s,presets:A,presetName:D,onPresetNameChange:_,selectedPresetId:H,onPresetSelect:W,onPresetSave:ve,onPresetDelete:Pe,presetStatus:oe}),_e?l.jsx(ls,{ref:z,className:"controls-panel",title:l.jsxs(l.Fragment,{children:[l.jsx(R0,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Images"]}),bodyClassName:"control-shell controls-body",defaultOpen:!1,children:s?l.jsx("div",{className:"grid grid-cols-1 gap-3 lg:grid-cols-2",children:ue.map(T=>l.jsx(Z0,{input:T,value:c[T.inputs.param_name]||"",onFormChange:d},T.id))}):null}):null,l.jsx(ls,{title:l.jsxs(l.Fragment,{children:[l.jsx(kd,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Parameters"]}),bodyClassName:"control-shell controls-body",defaultOpen:!0,className:"controls-panel",children:s?l.jsx(VS,{workflowName:n,dynamicInputs:b,formData:c,onFormChange:d,parameterSectionRef:C,compactControls:!0,lastEditedParam:$,spotlightName:Z,onCloseSpotlight:X,onVisibleParamsChange:ze,aliasOptions:m,aliasCatalog:y,onOpenComposer:ae,onParamEdited:Te,onSpotlight:He}):l.jsxs("div",{className:"empty-state-inline",children:[l.jsx("span",{className:"empty-state-arrow",children:l.jsx(A0,{size:20})}),l.jsx("span",{children:"Select a workflow above to get started"})]})})]}),l.jsxs("div",{className:"controls-status-strip",children:[l.jsxs("div",{className:"controls-status-left",children:[l.jsx("span",{className:`controls-status-dot is-${j||"idle"}`,"aria-hidden":"true"}),l.jsxs("div",{className:"controls-status-text",children:[l.jsx("span",{className:"controls-status-phase",children:j||"idle"}),l.jsx("span",{className:"controls-status-msg",children:k||"Idle"})]})]}),l.jsxs("div",{className:"controls-status-right",children:[g&&w>0?l.jsx("div",{className:"controls-status-meter","aria-label":"Progress",children:l.jsx("div",{className:"controls-status-meter-fill",style:{width:`${Math.max(0,Math.min(100,Math.round((v||0)/w*100)))}%`}})}):null,l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>Se(!0),children:"Logs"})]})]}),l.jsx("section",{className:"dock-panel ui-card",children:l.jsx(U0,{busy:g,progressValue:v,progressMax:w,statusText:k,statusPhase:j,primaryLabel:"Render",onPrimary:h,primaryDisabled:!je,onLogs:()=>Se(!0)})}),l.jsx(eS,{open:!!R,onClose:X,title:R==null?void 0:R.label,description:R==null?void 0:R.description,render:Ve,index:(R==null?void 0:R.index)??0,total:(R==null?void 0:R.total)??0,onPrev:(R==null?void 0:R.onPrev)||null,onNext:(R==null?void 0:R.onNext)||null,onRender:(R==null?void 0:R.onRender)||null,children:null}),l.jsx(WS,{open:de,onClose:()=>Se(!1),logs:f,onClear:p})]})}function i1(){return l.jsx("div",{className:"page-shell page-stack",children:l.jsxs("section",{className:"home-hero",children:[l.jsx("span",{className:"home-hero-orb is-warm","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-orb is-cool","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-spark","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-beam","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-ring","aria-hidden":"true"}),l.jsxs("div",{className:"home-hero-inner home-hero-full",children:[l.jsx("div",{className:"home-hero-kicker",children:"CozyGen Studio"}),l.jsx("h1",{className:"home-hero-title",children:"Creative studio for prompt-first storytelling"}),l.jsx("p",{className:"home-hero-description",children:"CozyGen is a quiet, cinematic workspace for people who sketch with wordsshape the mood, stage the scene, then send it down the render runway without losing your flow."}),l.jsxs("div",{className:"home-info-grid",children:[l.jsxs("article",{className:"ui-card",children:[l.jsx("h3",{className:"text-xs uppercase tracking-[0.12em] text-[rgba(159,178,215,0.8)]",children:"Control as composition"}),l.jsx("p",{className:"mt-1 text-[0.78rem] leading-relaxed text-[rgba(204,217,255,0.75)]",children:"Dial the palette, tempo, and texture in one place. The controls read like a creative brief, not a checklist."})]}),l.jsxs("article",{className:"ui-card",children:[l.jsx("h3",{className:"text-xs uppercase tracking-[0.12em] text-[rgba(159,178,215,0.8)]",children:"Alias & tag storyboards"}),l.jsx("p",{className:"mt-1 text-[0.78rem] leading-relaxed text-[rgba(204,217,255,0.75)]",children:"Save characters, atmospheres, and motifs as building blocks, then arrange them like panels in a storyboard."})]}),l.jsxs("article",{className:"ui-card",children:[l.jsx("h3",{className:"text-xs uppercase tracking-[0.12em] text-[rgba(159,178,215,0.8)]",children:"Gallery inspiration"}),l.jsx("p",{className:"mt-1 text-[0.78rem] leading-relaxed text-[rgba(204,217,255,0.75)]",children:"Pin your strongest frames, compare variations, and carry the aesthetic through to your next scene."})]}),l.jsxs("article",{className:"ui-card",children:[l.jsx("h3",{className:"text-xs uppercase tracking-[0.12em] text-[rgba(159,178,215,0.8)]",children:"Render runway"}),l.jsx("p",{className:"mt-1 text-[0.78rem] leading-relaxed text-[rgba(204,217,255,0.75)]",children:"Stack iterations like takes on a set. Keep composing while the queue runs in the background."})]})]})]})]})})}const a1=e=>l.jsxs("svg",{viewBox:"0 0 24 24",width:"14",height:"14","aria-hidden":"true",...e,children:[l.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"2.5",ry:"2.5",fill:"none",stroke:"currentColor",strokeWidth:"1.3"}),l.jsx("rect",{x:"7",y:"3",width:"10",height:"14",rx:"2.5",ry:"2.5",fill:"none",stroke:"currentColor",strokeWidth:"1.3",opacity:"0.8"}),l.jsx("circle",{cx:"12",cy:"11",r:"2.3",fill:"currentColor",opacity:"0.9"})]});function o1({subfolder:e,crumbs:t=[],dirChips:n=[],onBack:r,onRoot:s,onCrumb:i,onSelectDir:a}){const c=!e;return l.jsxs("div",{className:"gallery-nav",children:[l.jsx("div",{className:"gallery-crumbs",role:"navigation","aria-label":"Gallery path",children:t.map((u,d)=>l.jsxs(o.Fragment,{children:[l.jsx("span",{className:"text-[#6A6FA8]",children:"/"}),l.jsx(K,{size:"xs",variant:"chip",onClick:()=>i==null?void 0:i(u.path),"aria-current":d===t.length-1?"page":void 0,children:u.name})]},u.path||u.name||d))}),l.jsxs("div",{className:"gallery-dir-chips",children:[l.jsxs(K,{size:"xs",variant:"chip",onClick:()=>s==null?void 0:s(),disabled:c,"aria-label":"Go to output root",title:"Output root",children:[l.jsx(a1,{}),"Output"]}),n.map(u=>l.jsx(K,{size:"xs",variant:"chip",onClick:()=>a==null?void 0:a(u.subfolder),children:u.filename||u.subfolder||"Collection"},u.subfolder||u.filename))]})]})}const c1=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),u1=({src:e,poster:t,autoPlay:n})=>{const r=o.useRef(null),s=Pd();return o.useEffect(()=>{const i=r.current;i&&(i.pause(),i.currentTime=0,i.load())},[e]),o.useEffect(()=>{const i=r.current;if(!i)return;let a;const c=()=>{const d=i.play();d&&typeof d.catch=="function"&&d.catch(()=>{})},u=()=>{i.pause()};return n?s?typeof window<"u"&&"IntersectionObserver"in window?(a=new IntersectionObserver(m=>{m.forEach(y=>{y.isIntersecting?c():u()})},{threshold:.65}),a.observe(i)):c():u():(u(),i.currentTime=0),()=>{a&&a.disconnect(),u()}},[n,e,s]),e?l.jsx("video",{ref:r,src:e,poster:t||void 0,muted:!0,playsInline:!0,loop:!0,preload:n?"metadata":"none",className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40"}):l.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})},$p={contentVisibility:"auto",containIntrinsicSize:"260px 320px"};function d1({item:e,onSelect:t,onDelete:n,isDeleting:r=!1,variant:s="grid",autoPlay:i=!1}){if(!e)return null;const a=e.type==="directory",c=e.filename||"",u=e.subfolder||"",d=c||u||"Unknown",m=e.mtime??e.modified??e.updated_at??e.created_at,y=m?`&v=${encodeURIComponent(String(m))}`:"",g=()=>{t&&t(e)},v=s==="feed"?768:384,w=!a&&c?`/cozygen/thumb?type=output&subfolder=${encodeURIComponent(u)}&filename=${encodeURIComponent(c)}${y}&w=`:null,k=w?`${w}${v}`:null,j=w?s==="feed"?`${w}384 384w, ${w}768 768w`:`${w}192 192w, ${w}384 384w`:null,h=s==="feed"?"(max-width: 768px) 92vw, 768px":"(max-width: 640px) 45vw, (max-width: 1024px) 30vw, 240px",f=!a&&c?(()=>{const C=e.type&&e.type!=="directory"?e.type:"output",z=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(c)}&subfolder=${encodeURIComponent(u)}&type=${encodeURIComponent(C)}${z}`})():null,p=c1(c),x=!!n&&!a,b=C=>{C.stopPropagation(),n==null||n(e)};if(a)return l.jsx("button",{type:"button",onClick:g,className:"gallery-dir-tile",style:$p,children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"h-7 w-7 rounded-lg bg-gradient-to-br from-[#6B5BFF] to-[#FF4F9A] opacity-80 group-hover:opacity-100 flex items-center justify-center text-[11px] text-white",children:""}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-[11px] font-medium text-[#E5E7FF] truncate",children:d}),l.jsx("div",{className:"text-[10px] text-[#9DA3FFCC] truncate",children:"Collection"})]})]})});if(s==="feed"){const C={contentVisibility:"auto",containIntrinsicSize:"520px 720px"};return l.jsxs("div",{className:"gallery-feed-item",style:C,children:[l.jsxs("button",{type:"button",onClick:g,className:"gallery-feed-media",children:[l.jsx("div",{className:"relative w-full flex items-center justify-center bg-[#020312]",children:p?l.jsx(u1,{src:f,poster:k,autoPlay:i}):k?l.jsx("img",{src:k,srcSet:j||void 0,sizes:h,alt:d,className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40",loading:"lazy",decoding:"async"}):l.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})}),l.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#05071680] opacity-0 group-hover:opacity-100 transition-opacity"}),p&&l.jsx("div",{className:"pointer-events-none absolute left-2 top-2 rounded-md bg-[#050716CC] px-2 py-[1px] text-[10px] text-[#CFFAFE] border border-[#3EF0FF80]",children:"Video"})]}),x?l.jsx(K,{size:"mini",variant:"muted",iconOnly:!0,className:"gallery-tile-delete",onClick:b,disabled:r,"aria-label":"Delete item",title:r?"Deleting":"Delete item",children:l.jsx(fu,{size:12})}):null]})}return l.jsxs("div",{className:"gallery-tile",style:$p,children:[l.jsx("button",{type:"button",onClick:g,className:"gallery-tile-button",children:l.jsxs("div",{className:"gallery-tile-media",children:[k?l.jsx("img",{src:k,srcSet:j||void 0,sizes:h,alt:d,className:"gallery-tile-img",loading:"lazy",decoding:"async"}):l.jsx("div",{className:"gallery-tile-empty",children:"No preview"}),p&&l.jsx("div",{className:"gallery-badge",children:"Video"})]})}),x?l.jsx(K,{size:"mini",variant:"muted",iconOnly:!0,className:"gallery-tile-delete",onClick:b,disabled:r,"aria-label":"Delete item",title:r?"Deleting":"Delete item",children:l.jsx(fu,{size:12})}):null]})}const Mp=o.memo(d1),_d=["seed","noise_seed"],Jg=["ckpt_name","checkpoint","ckpt","model_name"],xu=["lora_name"],Zg=["width","image_width"],ey=["height","image_height"],f1=/(prompt|positive|text)/i,p1=/(negative|neg)/i,al=e=>String(e||"").toLowerCase(),pi=e=>(e==null?void 0:e.class_type)==="CozyGenDynamicInput"||(e==null?void 0:e.class_type)==="CozyGenChoiceInput",hi=e=>{var t;return al((t=e==null?void 0:e.inputs)==null?void 0:t.choice_type)},Ka=(e,t)=>{e!=null&&e.inputs&&("default_value"in e.inputs&&(e.inputs.default_value=t),"value"in e.inputs&&(e.inputs.value=t))},ty=e=>al(e==null?void 0:e.class_type).includes("checkpoint"),ny=e=>al(e==null?void 0:e.class_type).includes("lora"),ry=e=>al(e==null?void 0:e.class_type).includes("seed"),Rd=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;const t=parseInt(String(e),10);return Number.isFinite(t)?t:null},Qn=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;const t=parseInt(String(e),10);return Number.isFinite(t)?t:null},Xi=e=>e!=null&&e.inputs?"default_value"in e.inputs?Qn(e.inputs.default_value):"value"in e.inputs?Qn(e.inputs.value):null:null,Ya=e=>{var t;return al((t=e==null?void 0:e.inputs)==null?void 0:t.param_name)},h1=e=>{var t;return String(((t=e==null?void 0:e.inputs)==null?void 0:t.param_name)||"").trim()},Ji=(e,t)=>{if(!(e!=null&&e.inputs))return!1;let n=!1;return"default_value"in e.inputs&&Qn(e.inputs.default_value)!==null&&(e.inputs.default_value=t,n=!0),"value"in e.inputs&&Qn(e.inputs.value)!==null&&(e.inputs.value=t,n=!0),n},m1=e=>{const t=String(e||"").trim();return!t||p1.test(t)?!1:f1.test(t)},g1=e=>{if(!e)return[];const t=[];return typeof e.default_value=="string"&&t.push("default_value"),typeof e.value=="string"&&e.value!==e.default_value&&t.push("value"),t},y1=e=>al(e==null?void 0:e.class_type).includes("textencode"),Fp=(e,t)=>{if(!(e!=null&&e.inputs))return!1;let n=!1;return _d.forEach(r=>{if(!(r in e.inputs))return;const s=e.inputs[r];Array.isArray(s)||Rd(s)!==null&&(e.inputs[r]=t,n=!0)}),n},v1=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(_d.forEach(s=>{if(!(s in r.inputs))return;const i=r.inputs[s];if(Array.isArray(i)&&i.length){n.add(i[0]);return}Rd(i)!==null&&(r.inputs[s]=t)}),ry(r)&&Fp(r,t))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&Fp(s,t)})},x1=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(pi(r)&&hi(r)==="checkpoints"&&Ka(r,t),ty(r)&&Jg.forEach(s=>{if(!(s in r.inputs))return;const i=r.inputs[s];if(Array.isArray(i)&&i.length){n.add(i[0]);return}(typeof i=="string"||typeof i=="number")&&(r.inputs[s]=t)}))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&pi(s)&&hi(s)==="checkpoints"&&Ka(s,t)})},w1=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(pi(r)&&hi(r)==="loras"&&Ka(r,t),(ny(r)||xu.some(s=>s in r.inputs))&&xu.forEach(s=>{if(!(s in r.inputs))return;const i=r.inputs[s];if(Array.isArray(i)&&i.length){n.add(i[0]);return}(typeof i=="string"||typeof i=="number")&&(r.inputs[s]=t)}))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&pi(s)&&hi(s)==="loras"&&Ka(s,t)})},S1=(e,t,n)=>{if(t===null&&n===null)return;const r=new Set,s=new Set;Object.values(e||{}).forEach(i=>{if(!(i!=null&&i.inputs))return;const a=i.inputs,c=Ya(i);t!==null&&c==="width"&&Ji(i,t),n!==null&&c==="height"&&Ji(i,n),t!==null&&Zg.forEach(u=>{if(!(u in a))return;const d=a[u];if(Array.isArray(d)&&d.length){r.add(d[0]);return}Qn(d)!==null&&(a[u]=t)}),n!==null&&ey.forEach(u=>{if(!(u in a))return;const d=a[u];if(Array.isArray(d)&&d.length){s.add(d[0]);return}Qn(d)!==null&&(a[u]=n)})}),r.forEach(i=>{const a=e==null?void 0:e[i];a&&Ji(a,t)}),s.forEach(i=>{const a=e==null?void 0:e[i];a&&Ji(a,n)})};function j1(e){if(!e)return[];const t=Object.entries(e||{}).sort((r,s)=>{const i=Number(r[0]),a=Number(s[0]);return Number.isFinite(i)&&Number.isFinite(a)?i-a:String(r[0]).localeCompare(String(s[0]))}),n=[];return t.forEach(([r,s])=>{if(!(s!=null&&s.inputs))return;const i=s.inputs,a=String((s==null?void 0:s.class_type)||""),c=h1(s),u=Ya(s);if(u&&m1(u)){const d=g1(i);if(d.length){const m=i[d[0]];typeof m=="string"&&n.push({id:String(r),key:`${r}:${d[0]}`,label:c||`Prompt ${r}`,text:m,fields:d,classType:a})}return}y1(s)&&typeof i.text=="string"&&n.push({id:String(r),key:`${r}:text`,label:`${a||"Text Encode"} ${r}`,text:i.text,fields:["text"],classType:a})}),n}function k1(e,t=[],n={},r={}){if(!e||!t.length)return e;const{mutate:s=!1}=r||{},i=s?e:Ld(e);return t.forEach(a=>{var d;if(!(a!=null&&a.id)||!((d=a==null?void 0:a.fields)!=null&&d.length))return;const c=typeof(n==null?void 0:n[a.key])=="string"?n[a.key]:a.text;if(typeof c!="string")return;const u=i==null?void 0:i[a.id];u!=null&&u.inputs&&a.fields.forEach(m=>{typeof u.inputs[m]=="string"&&(u.inputs[m]=c)})}),i}function C1(e){const t={hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null},n=new Set,r=new Set;return Object.values(e||{}).forEach(s=>{const i=(s==null?void 0:s.inputs)||{};if(i){if(_d.forEach(a=>{a in i&&(t.hasSeed=!0)}),ty(s)&&(t.hasCheckpoint=!0,Jg.forEach(a=>{const c=i[a];typeof c=="string"&&c&&n.add(c)})),ny(s)||xu.some(a=>a in i)){t.hasLora=!0;const a=i.lora_name;typeof a=="string"&&a&&r.add(a)}if(pi(s)){const a=hi(s),c=i.default_value??i.value;a==="checkpoints"&&(t.hasCheckpoint=!0,typeof c=="string"&&c&&n.add(c)),a==="loras"&&(t.hasLora=!0,typeof c=="string"&&c&&r.add(c))}if(ry(s)&&"seed"in i&&(t.hasSeed=!0),t.width===null&&Ya(s)==="width"){const a=Xi(s);a!==null&&(t.width=a)}if(t.height===null&&Ya(s)==="height"){const a=Xi(s);a!==null&&(t.height=a)}t.width===null&&Zg.forEach(a=>{if(!(a in i)||t.width!==null)return;const c=i[a];if(Array.isArray(c)&&c.length){const d=e==null?void 0:e[c[0]],m=Xi(d);m!==null&&(t.width=m);return}const u=Qn(c);u!==null&&(t.width=u)}),t.height===null&&ey.forEach(a=>{if(!(a in i)||t.height!==null)return;const c=i[a];if(Array.isArray(c)&&c.length){const d=e==null?void 0:e[c[0]],m=Xi(d);m!==null&&(t.height=m);return}const u=Qn(c);u!==null&&(t.height=u)})}}),t.checkpoint=n.values().next().value||"",t.loras=Array.from(r),t.hasSize=t.width!==null||t.height!==null,t}function N1(e,t={}){if(!e)return e;const n=Ld(e),{seedMode:r="keep",seedValue:s=null,checkpoint:i=null,lora:a=null,width:c=null,height:u=null}=t;if(r&&r!=="keep"){const y=r==="random"?Math.floor(Math.random()*4294967295):Rd(s);y!==null&&v1(n,y)}i&&x1(n,i),a&&w1(n,a);const d=Qn(c),m=Qn(u);return(d!==null||m!==null)&&S1(n,d,m),n}const sy=o.memo(function({id:t,name:n,category:r,text:s,isSelected:i,onOpen:a,visibilityStyle:c}){const u=o.useCallback(()=>{a(t)},[t,a]),d=Wa({name:n})||n||"Untitled",m=r?`${r}:${n}`:n,y=`${(s||"").slice(0,140)}${(s||"").length>140?"":""}`;return l.jsxs("button",{type:"button",role:"listitem",className:`composer-alias-item ${i?"is-selected":""}`,onClick:u,style:c,"data-virtual-row":"true",children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:d}),r?l.jsx("span",{className:"composer-alias-category",children:Gn(r)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",m||"alias","$"]}),l.jsx("div",{className:"composer-alias-text",children:y||""})]})}),ly=o.memo(function({tag:t,category:n,count:r,isCollected:s,onToggle:i,visibilityStyle:a}){const c=o.useCallback(u=>{u.stopPropagation(),i(t)},[i,t]);return l.jsxs("button",{type:"button",className:`composer-alias-item composer-tag-item ${s?"is-collected":""}`,onClick:c,style:a,"data-virtual-row":"true",children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name composer-tag-name",children:l.jsx("code",{className:"composer-tag-code",children:t})}),n?l.jsx("span",{className:"composer-alias-category",children:zn(n)}):null]}),l.jsx("div",{className:"composer-alias-token composer-tag-count",children:Number(r||0).toLocaleString()})]})});function b1({filename:e,locationLabel:t,isClip:n,url:r,canRerun:s,rerunBusy:i,canDelete:a,deleteBusy:c,metaRows:u,metaOpen:d,onToggleMeta:m,onOpenOptions:y,onDelete:g,onClose:v,closeButtonRef:w}){return l.jsxs("header",{className:"media-viewer-head",children:[l.jsxs("div",{className:"media-viewer-head-bar bottom-sheet-head",children:[l.jsxs("div",{className:"media-viewer-meta",children:[l.jsx("div",{className:"media-viewer-title",title:e,children:e}),l.jsxs("div",{className:"media-viewer-sub",children:[l.jsx("span",{className:"media-chip",children:t}),l.jsx("span",{className:`media-chip ${n?"is-clip":"is-still"}`,children:n?"Video":"Image"})]})]}),l.jsx("button",{ref:w,type:"button",className:"bottom-sheet-close media-viewer-close",onClick:v,"aria-label":"Close",children:l.jsx(Or,{size:16})})]}),l.jsxs("div",{className:"media-viewer-actions",children:[l.jsx(K,{as:"a",href:r,target:"_blank",rel:"noreferrer",variant:"ghost",size:"sm",children:"Open"}),u.length?l.jsx(K,{variant:"ghost",size:"sm",onClick:m,"aria-expanded":d,"aria-label":d?"Hide metadata":"Show metadata",children:d?"Hide metadata":"Metadata"}):null,s?l.jsx(K,{variant:"ghost",size:"sm",onClick:y,disabled:i,"aria-label":"Re-run generation",children:i?"Re-running":"Re-run"}):null,a?l.jsx(K,{variant:"ghost",size:"sm",iconOnly:!0,className:"media-viewer-action-icon media-viewer-action-delete",onClick:g,disabled:c,"aria-label":"Delete item",title:"Delete item",children:c?l.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):l.jsx(fu,{size:16})}):null]})]})}function E1({metaRows:e=[]}){return e.length?l.jsx("div",{className:"media-viewer-info","aria-label":"Generation metadata",children:e.map(t=>l.jsxs("div",{className:"media-info-row",children:[l.jsx("span",{className:"media-info-label",children:t.label}),l.jsx("span",{className:`media-info-value ${t.isPrompt?"is-prompt":""}`,children:t.value})]},t.label))}):null}function L1({showNav:e,canPrev:t,canNext:n,onPrev:r,onNext:s,isClip:i,url:a,filename:c}){return l.jsxs("div",{className:"media-viewer-stage",children:[e?l.jsx("button",{type:"button",className:`media-stage-nav is-left ${t?"":"is-disabled"}`,onClick:r,"aria-label":"Previous",disabled:!t,children:l.jsx(zg,{size:18})}):null,l.jsx("div",{className:"media-viewer-frame",children:i?l.jsx("video",{src:a,controls:!0,className:"media-viewer-media",autoPlay:!0,muted:!0,playsInline:!0}):l.jsx("img",{src:a,alt:c,className:"media-viewer-media",decoding:"async"})}),e?l.jsx("button",{type:"button",className:`media-stage-nav is-right ${n?"":"is-disabled"}`,onClick:s,"aria-label":"Next",disabled:!n,children:l.jsx(vo,{size:18})}):null]})}const P1=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),Op={contentVisibility:"auto",containIntrinsicSize:"240px 120px"},z1=e=>{if(!e)return"";const t=e.filename||"",n=e.subfolder||"",r=e.type||"output",s=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(t)}&subfolder=${encodeURIComponent(n)}&type=${encodeURIComponent(r)}${s}`},Dp=e=>{if(!Zs(e))return null;const{folderPath:t,base:n}=So(e);return{folderPath:t||"root",base:n||""}},Bp=(e="")=>{if(!e||e==="root")return"root";const t=e.split("/").filter(Boolean);return t[t.length-1]||e};function _1({isOpen:e,media:t,onClose:n,onPrev:r,onNext:s,onDeleted:i,total:a=0,canPrev:c=!1,canNext:u=!1}){var Hd,Gd,Kd,Yd;const{aliasCatalog:d=[],aliasLoading:m,aliasError:y}=zd(),g=o.useRef(!1),v=o.useRef(null),[w,k]=o.useState(!1),[j,h]=o.useState(!1),[f,p]=o.useState(!1),[x,b]=o.useState(!1),C=o.useRef(null),z=o.useRef(null),$=o.useRef(!1),O=o.useRef(null),[R,I]=o.useState(!1),[Z,X]=o.useState(!1),[de,Se]=o.useState(null),ce=o.useRef("options"),[me,A]=o.useState("random"),[L,D]=o.useState(""),[_,H]=o.useState(""),[Q,oe]=o.useState(""),[ne,re]=o.useState(""),[ae,Y]=o.useState(""),[U,W]=o.useState("All"),[ue,je]=o.useState("All"),[_e,$e]=o.useState({hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null}),[ze,Te]=o.useState([]),[He,Ke]=o.useState({}),[ve,Pe]=o.useState(""),[Ve,T]=o.useState(""),[ie,ge]=o.useState("elements"),[Ne,Re]=o.useState(""),pe=o.useDeferredValue(Ne),[Ae,Ye]=o.useState("All"),[tt,ct]=o.useState("All"),[jt,V]=o.useState(30),[J,ye]=o.useState(""),[Ee,Ie]=o.useState(""),We=o.useDeferredValue(Ee),[Fe,Qe]=o.useState(""),[B,se]=o.useState("count"),[P,F]=o.useState(""),[q,le]=o.useState([]),[ke,fe]=o.useState([]),[we,Be]=o.useState(0),[ht,Tt]=o.useState(0),[en,An]=o.useState(!1),[xt,Et]=o.useState(!1),[ol,Wr]=o.useState(""),[tn,mr]=o.useState(""),xn=o.useRef(null),mt=o.useRef(null),[gr,wn]=o.useState(!1),[et,yr]=o.useState(null),[Lt,Xn]=o.useState(null),[un,dn]=o.useState(null),Si=o.useRef(null),it=o.useRef(null),[kt,In]=o.useState(!1),[Sn,cl]=o.useState(""),[ji,ul]=o.useState(!1),[Hr,dl]=o.useState(""),[ys,fl]=o.useState([]),[Gr,pl]=o.useState([]),Jn=o.useRef(null),Tn=o.useRef(null),ki=S=>S?Array.from(S.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(N=>!N.hasAttribute("disabled")&&N.getAttribute("aria-hidden")!=="true"):[];o.useEffect(()=>{if(!e)return;const S=N=>{N.key==="Escape"&&(n==null||n()),N.key==="ArrowLeft"&&c&&(r==null||r()),N.key==="ArrowRight"&&u&&(s==null||s())};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[e,n,s,r,c,u]),o.useEffect(()=>{var S;e&&(k(!1),I(!1),X(!1),Se(null),ce.current="options",p(!1),b(!1),A("random"),D(""),H(""),oe(""),re(""),Y(""),W("All"),je("All"),$e({hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null}),Te([]),Ke({}),Pe(""),T(""),ge("elements"),Re(""),Ye("All"),ct("All"),V(30),ye(""),Ie(""),Qe(""),se("count"),F(""),le([]),fe([]),Be(0),Tt(0),An(!1),Et(!1),Wr(""),mr(""),wn(!1),yr(null),In(!1),cl(""),ul(!1),dl(""),fl([]),pl([]),Jn.current=null,Tn.current&&(Tn.current.abort(),Tn.current=null),(S=it.current)!=null&&S.timer&&(clearTimeout(it.current.timer),it.current=null),xn.current&&(xn.current.abort(),xn.current=null),mt.current&&(mt.current.abort(),mt.current=null),$.current=!0,O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{$.current=!1,O.current=null},250))},[e,t]),o.useEffect(()=>()=>{var S;O.current&&(clearTimeout(O.current),O.current=null),(S=it.current)!=null&&S.timer&&(clearTimeout(it.current.timer),it.current=null),xn.current&&(xn.current.abort(),xn.current=null),mt.current&&(mt.current.abort(),mt.current=null)},[]),o.useEffect(()=>{if(!e||typeof document>"u")return;const S=C.current;z.current=document.activeElement;const N=()=>{var qe;const te=ki(S),be=v.current||te[0]||S;(qe=be==null?void 0:be.focus)==null||qe.call(be)},G=te=>{if(te.key!=="Tab"||!S)return;const be=ki(S);if(!be.length){te.preventDefault(),S.focus();return}const qe=be[0],at=be[be.length-1],yt=document.activeElement;te.shiftKey&&yt===qe?(te.preventDefault(),at.focus()):!te.shiftKey&&yt===at&&(te.preventDefault(),qe.focus())};return requestAnimationFrame(N),S==null||S.addEventListener("keydown",G),()=>{var be;S==null||S.removeEventListener("keydown",G);const te=z.current;te&&document.contains(te)&&((be=te.focus)==null||be.call(te))}},[e]);const Ci=!!t,Ni=t?z1(t):"",ko=(t==null?void 0:t.subfolder)||"Gallery",bi=P1((t==null?void 0:t.filename)||""),Co=a>1,Pt=(t==null?void 0:t.meta)||{},hl=[Pt!=null&&Pt.model?{label:"Model",value:Pt.model}:null,Pt!=null&&Pt.prompt?{label:"Prompt",value:Pt.prompt,isPrompt:!0}:null,Array.isArray(Pt==null?void 0:Pt.loras)&&Pt.loras.length?{label:"LoRAs",value:Pt.loras.join(", ")}:null].filter(Boolean),Ei=!!((Hd=t==null?void 0:t.meta)!=null&&Hd.has_prompt||hl.length),Li=typeof(t==null?void 0:t.filename)=="string"&&t.filename.toLowerCase().endsWith(".png"),Kr=Ci&&Ei&&Li,No=Ci,Pi=o.useMemo(()=>[{key:"random",label:"Random"},{key:"keep",label:"Keep"},{key:"custom",label:"Custom"}],[]),ml=o.useMemo(()=>{if(me!=="custom")return null;const S=parseInt(String(L),10);return Number.isFinite(S)?S:null},[L,me]),gl=me!=="custom"||ml!==null,E=o.useMemo(()=>{if(!String(_||"").trim())return null;const S=parseInt(String(_),10);return Number.isFinite(S)&&S>0?S:null},[_]),M=o.useMemo(()=>{if(!String(Q||"").trim())return null;const S=parseInt(String(Q),10);return Number.isFinite(S)&&S>0?S:null},[Q]),he=(!String(_||"").trim()||E!==null)&&(!String(Q||"").trim()||M!==null),Ce=!!String(_||"").trim()&&E===null,Ue=!!String(Q||"").trim()&&M===null,Me=_e.checkpoint||(Pt==null?void 0:Pt.model)||"",Xe=Array.isArray(_e.loras)?_e.loras:[],Le=Me?Dn(Me):"",Oe=Xe.length?Xe.map(S=>Dn(S)).join(", "):"",Dt=o.useMemo(()=>(ys||[]).map(S=>{const N=String(S||"");return{value:N,meta:Dp(N)}}),[ys]),Bt=o.useMemo(()=>(Gr||[]).map(S=>{const N=String(S||"");return{value:N,meta:Dp(N)}}),[Gr]),Yr=o.useMemo(()=>{const S=new Set(["All"]);return Dt.forEach(({meta:N})=>{N!=null&&N.folderPath&&S.add(N.folderPath)}),Array.from(S).sort((N,G)=>N.localeCompare(G))},[Dt]),Qr=o.useMemo(()=>{const S=new Set(["All"]);return Bt.forEach(({meta:N})=>{N!=null&&N.folderPath&&S.add(N.folderPath)}),Array.from(S).sort((N,G)=>N.localeCompare(G))},[Bt]),$n=Yr.length>2,gt=Qr.length>2;o.useEffect(()=>{if(!$n){U!=="All"&&W("All");return}Yr.includes(U)||W("All")},[U,Yr,$n]),o.useEffect(()=>{if(!gt){ue!=="All"&&je("All");return}Qr.includes(ue)||je("All")},[ue,Qr,gt]);const Ut=o.useMemo(()=>{const S=new Map;return Dt.forEach(({meta:N})=>{if(!(N!=null&&N.base))return;const G=N.base.toLowerCase();S.set(G,(S.get(G)||0)+1)}),S},[Dt]),Td=o.useMemo(()=>{const S=new Map;return Bt.forEach(({meta:N})=>{if(!(N!=null&&N.base))return;const G=N.base.toLowerCase();S.set(G,(S.get(G)||0)+1)}),S},[Bt]),yl=o.useMemo(()=>{const S=[],N=$n&&U==="All";return Dt.forEach(({value:G,meta:te})=>{if(!te){S.push({value:G,label:G});return}if($n&&U!=="All"&&te.folderPath!==U)return;let be=te.base||Dn(G)||G;if(N&&te.base){const qe=te.base.toLowerCase();Ut.get(qe)>1&&(be=`${be} (${Bp(te.folderPath)})`)}S.push({value:G,label:be})}),S},[Dt,U,Ut,$n]),vl=o.useMemo(()=>{const S=[],N=gt&&ue==="All";return Bt.forEach(({value:G,meta:te})=>{if(!te){S.push({value:G,label:G});return}if(gt&&ue!=="All"&&te.folderPath!==ue)return;let be=te.base||Dn(G)||G;if(N&&te.base){const qe=te.base.toLowerCase();Td.get(qe)>1&&(be=`${be} (${Bp(te.folderPath)})`)}S.push({value:G,label:be})}),S},[Bt,ue,Td,gt]),$d=o.useMemo(()=>ne?yl.some(S=>String(S.value)===String(ne)):!0,[yl,ne]),Md=o.useMemo(()=>ae?vl.some(S=>String(S.value)===String(ae)):!0,[vl,ae]),iy=o.useMemo(()=>!ne||$d?yl:[{value:ne,label:Dn(String(ne))},...yl],[ne,$d,yl]),ay=o.useMemo(()=>!ae||Md?vl:[{value:ae,label:Dn(String(ae))},...vl],[ae,Md,vl]),Fd=o.useCallback(async S=>{const N=S==null?void 0:S.hasCheckpoint,G=S==null?void 0:S.hasLora;if(!N&&!G)return;Tn.current&&Tn.current.abort();const te=new AbortController;Tn.current=te,ul(!0),dl("");try{const[be,qe]=await Promise.all([N&&!ys.length?uu("checkpoints",{signal:te.signal}):null,G&&!Gr.length?uu("loras",{signal:te.signal}):null]);be!=null&&be.choices&&fl(be.choices),qe!=null&&qe.choices&&pl(qe.choices)}catch(be){if((be==null?void 0:be.name)==="AbortError")return;dl("Unable to load model choices right now.")}finally{Tn.current===te&&(Tn.current=null),ul(!1)}},[ys.length,Gr.length]),bo=o.useCallback(async()=>{var S;if(!t)throw new Error("media_missing");if(Jn.current)return{prompt:Jn.current,info:_e};In(!0),cl("");try{const N=await x0({filename:t.filename,subfolder:t.subfolder||""}),G=N==null?void 0:N.prompt;if(!G)throw new Error("prompt_missing");const te=C1(G),be=j1(G);if(Te(be),be.length){const qe={};be.forEach(at=>{qe[at.key]=at.text}),Ke(qe),Pe(at=>at&&qe[at]?at:be[0].key)}else Ke({}),Pe("");return Jn.current=G,$e(te),{prompt:G,info:te}}catch(N){const G=((S=N==null?void 0:N.payload)==null?void 0:S.error)||(N==null?void 0:N.message)||"Unable to load prompt metadata.";throw cl(G),N}finally{In(!1)}},[t==null?void 0:t.filename,t==null?void 0:t.subfolder,_e]),oy=o.useCallback(async()=>{if(Kr){X(!1),I(!0),W("All"),je("All");try{const S=await bo(),N=S==null?void 0:S.info;H(G=>String(G||"").trim()?G:(N==null?void 0:N.width)!==null&&(N==null?void 0:N.width)!==void 0?String(N.width):""),oe(G=>String(G||"").trim()?G:(N==null?void 0:N.height)!==null&&(N==null?void 0:N.height)!==void 0?String(N.height):""),await Fd(S==null?void 0:S.info)}catch{}}},[Kr,Fd,bo]),cy=o.useCallback(()=>{Se(null),ce.current="options",I(!1),X(!0)},[]),uy=o.useCallback((S,N)=>{S&&(ce.current=Z?"editor":"options",ge(S.type==="alias"?"aliases":"tags"),Se({element:S,displayName:N||S.text||""}),I(!1),X(!0))},[Z]),dy=o.useCallback(()=>{X(!1),Se(null),ge("elements"),ce.current="options"},[]),fy=o.useCallback(()=>{X(!1),Se(null),ge("elements"),I(!0),ce.current="options"},[]),Yt=o.useMemo(()=>ze.length?ze.map(S=>{const N=He==null?void 0:He[S.key],G=typeof N=="string"?N:S.text||"",te=$g(G||"");return{...S,text:G,elements:te}}).filter(S=>S.elements.length):[],[ze,He]);o.useEffect(()=>{if(!Yt.length){Pe("");return}Yt.some(N=>N.key===ve)||Pe(Yt[0].key)},[Yt,ve]);const Ct=o.useMemo(()=>Yt.length?Yt.find(N=>N.key===ve)||Yt[0]:null,[Yt,ve]),Eo=(Ct==null?void 0:Ct.text)||"",Od=o.useMemo(()=>(Yt||[]).map(S=>({value:S.key,label:S.label})),[Yt]),Mn=(Ct==null?void 0:Ct.elements)||[],py=o.useMemo(()=>[{key:"elements",label:"Elements",icon:l.jsx(yo,{size:14})},{key:"aliases",label:"Aliases",icon:l.jsx(ll,{size:14})},{key:"tags",label:"Tags",icon:l.jsx(dr,{size:14})}],[]),vr=Z,hy=o.useMemo(()=>{if(!(de!=null&&de.element))return"";const S=de.element,N=de.displayName||S.text||"";return S.type==="alias"?`${N}  $${S.text}$`:N||S.text},[de]),Dd=de?"Replace prompt element":"Add prompt element",my=de?"Replace with tag or $alias$":"Add tag or $alias$",Lo=o.useMemo(()=>{const S=new Set;return Mn.forEach(N=>{if((N==null?void 0:N.type)!=="tag")return;const G=String(N.text||"").trim().toLowerCase();G&&S.add(G)}),S},[Mn]),Po=o.useMemo(()=>{const S=new Set;return Mn.forEach(N=>{if((N==null?void 0:N.type)!=="alias")return;const G=String(N.text||"").trim().toLowerCase();G&&S.add(G)}),S},[Mn]),vs=o.useMemo(()=>Array.isArray(d)?d.map(S=>{if(!S)return null;const N=String(S.token||S.name||"").trim();if(!N)return null;const G=S.displayName||Wa({token:N,name:S.name});return{...S,key:S.key||N,token:N,displayName:G,subcategory:S.subcategory||""}}).filter(Boolean):[],[d]),gy=o.useMemo(()=>{const S=new Set;return vs.forEach(G=>{const te=String(G.category||"").trim();te&&S.add(te)}),["All",...Array.from(S).sort((G,te)=>G.localeCompare(te))]},[vs]),Bd=o.useMemo(()=>{const S=new Set;return vs.forEach(G=>{if(Ae!=="All"&&G.category!==Ae)return;const te=String(G.subcategory||"").trim();te&&S.add(te)}),["All",...Array.from(S).sort((G,te)=>G.localeCompare(te))]},[vs,Ae]),xl=o.useMemo(()=>{const S=String(pe||"").trim().toLowerCase();return vs.filter(N=>{if(Ae!=="All"&&(N.category||"")!==Ae||tt!=="All"&&(N.subcategory||"")!==tt)return!1;if(!S)return!0;const G=String(N.displayName||"").toLowerCase(),te=String(N.token||"").toLowerCase(),be=String(N.text||"").toLowerCase();return G.includes(S)||te.includes(S)||be.includes(S)})},[vs,Ae,tt,pe]),yy=o.useMemo(()=>xl.slice(0,jt),[xl,jt]),wl=o.useMemo(()=>{const S=Number.parseInt(String(P||""),10);return Number.isFinite(S)&&S>0?S:0},[P]),vy=o.useMemo(()=>Array.isArray(q)?q.map(S=>{if(!S)return null;if(typeof S=="string"){const te=S.trim();return te?{value:te,label:zn(te)}:null}const N=String(S.key||"").trim();if(!N)return null;const G=Number(S.actual||S.count||0);return{value:N,label:`${zn(N)} (${G.toLocaleString()})`}}).filter(Boolean):[],[q]);o.useEffect(()=>{ct("All")},[Ae]),o.useEffect(()=>{V(30)},[Ae,tt,pe]),o.useEffect(()=>{if(!vr||ie!=="tags"||q.length>0)return;let S=!1;return wd().then(N=>{S||le(Array.isArray(N==null?void 0:N.categories)?N.categories:[])}).catch(()=>{S||le([])}),()=>{S=!0}},[vr,ie,q.length]);const Ud=o.useCallback(async()=>{if(!vr||ie!=="tags")return;xn.current&&xn.current.abort(),mt.current&&(mt.current.abort(),mt.current=null);const S=new AbortController;xn.current=S;try{An(!0),Wr("");const N=await Js({q:We,category:Fe,sort:B,minCount:wl,limit:40,offset:0},{signal:S.signal}),G=Array.isArray(N==null?void 0:N.items)?N.items:[];fe(G),Be(Number((N==null?void 0:N.total)||0)),Tt(G.length)}catch(N){if((N==null?void 0:N.name)==="AbortError")return;Wr("Unable to load tags right now."),fe([]),Be(0),Tt(0)}finally{An(!1)}},[We,vr,ie,Fe,wl,B]),xy=o.useCallback(async()=>{if(!vr||ie!=="tags"||en||xt||ke.length>=we)return;mt.current&&mt.current.abort();const S=new AbortController;mt.current=S;try{Et(!0);const N=await Js({q:We,category:Fe,sort:B,minCount:wl,limit:40,offset:ht},{signal:S.signal}),G=Array.isArray(N==null?void 0:N.items)?N.items:[];fe(te=>[...te,...G]),Be(Number((N==null?void 0:N.total)||0)),Tt(ht+G.length)}catch(N){if((N==null?void 0:N.name)==="AbortError")return;Wr("Unable to load more tags.")}finally{Et(!1)}},[We,vr,ie,Fe,ke.length,en,xt,wl,ht,B,we]);o.useEffect(()=>{if(!vr||ie!=="tags")return;const S=window.setTimeout(()=>{Ud()},250);return()=>window.clearTimeout(S)},[vr,ie,We,Fe,B,wl,Ud]),o.useEffect(()=>{ie!=="elements"&&(Xn(null),dn(null))},[ie]);const Zn=o.useCallback(S=>{Ct!=null&&Ct.key&&Ke(N=>{const G=typeof(N==null?void 0:N[Ct.key])=="string"?N[Ct.key]:Ct.text||"",te=typeof S=="function"?S(G):String(S||"");return te===G?N:{...N,[Ct.key]:te}})},[Ct]),qr=o.useCallback((S,N,G)=>{const te=de==null?void 0:de.element;if(!te)return!1;const be=String(N||"").trim();return be?(Zn(qe=>{const at=typeof qe=="string"?qe:"";if(!at||typeof te.start!="number"||typeof te.end!="number")return at;const yt=Hl(at,te),Xr=S==="alias"?`$${be.replace(/^\$|\$$/g,"")}$`:be,ws=yt?`(${Xr}:${En(yt.weight)})`:Xr;return at.slice(0,te.start)+ws+at.slice(te.end)}),Se(null),wn(!1),yr(null),S==="alias"?ye(`Replaced with ${G||be}`):mr(`Replaced with ${G||be}`),ce.current==="editor"?X(!0):(ge("elements"),X(!1),I(!0)),ce.current="options",!0):!1},[de,Zn,wn,yr,ge,X,I]),xs=o.useCallback(S=>{const N=String(S||"").trim();N&&Zn(G=>{const te=G.trim();return te?`${te.replace(/[\s,]*$/,"")}, ${N}`.trim():N})},[Zn]),Vd=o.useCallback(()=>{const S=String(Ve||"").trim();if(!S)return;const N=S.split(",").map(be=>be.trim()).filter(Boolean),G=N[0];if(!G)return;if(de!=null&&de.element){const be=G.match(/^\$([a-z0-9_:-]+)\$$/i);be?qr("alias",be[1],be[1]):qr("tag",G,G),T("");return}const te=N.join(", ");te&&(xs(te),T(""))},[Ve,xs,qr,de]),wy=o.useCallback((S,N)=>{const G=String(S||"").trim();if(!G)return;if(de!=null&&de.element){qr("alias",G,N||G);return}const te=G.toLowerCase();if(Po.has(te)){ye(`Already added: ${N||G}`);return}xs(`$${G}$`),ye(`Added: ${N||G}`)},[xs,Po,qr,de]),Sy=o.useCallback(S=>{const N=String(S||"").trim();if(!N)return;if(de!=null&&de.element){qr("tag",N,N);return}const G=N.toLowerCase();if(Lo.has(G)){mr(`Already added: ${N}`);return}xs(N),mr(`Added: ${N}`)},[xs,Lo,qr,de]);o.useEffect(()=>{if(!J)return;const S=window.setTimeout(()=>ye(""),1600);return()=>window.clearTimeout(S)},[J]),o.useEffect(()=>{if(!tn)return;const S=window.setTimeout(()=>mr(""),1600);return()=>window.clearTimeout(S)},[tn]);const Wd=o.useCallback((S,N)=>{if(!S)return;const G=Hl(Eo||"",S),te=(G==null?void 0:G.weight)??1;yr({element:S,displayName:N,weight:te}),wn(!0)},[Eo]),jy=o.useCallback(S=>{S&&(Zn(N=>Mg(N||"",S)),wn(!1),yr(null))},[Zn]),zi=o.useCallback((S,N)=>{S===null||N===null||S===N||Zn(G=>yu(G||"",Mn,S,N))},[Mn,Zn]),ky=(S,N)=>{Xn(N),dn(N),S!=null&&S.dataTransfer&&(S.dataTransfer.effectAllowed="move",S.dataTransfer.setData("text/plain",String(N)))},Cy=(S,N)=>{S.preventDefault(),!(Lt===null||N===un)&&(dn(N),S!=null&&S.dataTransfer&&(S.dataTransfer.dropEffect="move"))},Ny=()=>{Lt!==null&&un!==null&&Lt!==un&&zi(Lt,un),Xn(null),dn(null)},by=()=>{un!==null&&dn(null)},Ey=(S,N)=>{S.preventDefault(),Lt!==null&&Lt!==N&&zi(Lt,N),Xn(null),dn(null)},Ly=o.useCallback((S,N)=>{var qe,at;if(!((at=(qe=S.target)==null?void 0:qe.closest)==null?void 0:at.call(qe,".composer-token-drag-handle")))return;const te=S.touches[0],be=window.setTimeout(()=>{it.current&&(it.current.active=!0,Xn(N),dn(N))},240);it.current={idx:N,startX:te.clientX,startY:te.clientY,active:!1,timer:be}},[]),Py=o.useCallback(S=>{if(!it.current)return;const N=S.touches[0],G=Math.abs(N.clientX-it.current.startX),te=Math.abs(N.clientY-it.current.startY);if(!it.current.active){(G>8||te>8)&&(window.clearTimeout(it.current.timer),it.current=null);return}S.preventDefault();const be=Si.current,qe=be?be.querySelectorAll(".composer-token-draggable"):[],at=N.clientX,yt=N.clientY;for(let Xr=0;Xr<qe.length;Xr+=1){const ws=qe[Xr].getBoundingClientRect();if(at>=ws.left&&at<=ws.right&&yt>=ws.top&&yt<=ws.bottom){dn(Xr);break}}},[]),zy=o.useCallback(()=>{var S,N;(S=it.current)!=null&&S.timer&&window.clearTimeout(it.current.timer),(N=it.current)!=null&&N.active&&Lt!==null&&un!==null&&Lt!==un&&zi(Lt,un),it.current=null,Xn(null),dn(null)},[Lt,un,zi]),_y=o.useCallback(()=>{var S;(S=it.current)!=null&&S.timer&&window.clearTimeout(it.current.timer),it.current=null,Xn(null),dn(null)},[]),zo=S=>{if(!(typeof window>"u"))try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:S}}))}catch{}},Ry=async()=>{var S;if(!(!t||j||!Kr)){if(!gl){alert("Enter a valid seed value.");return}if(!he){alert("Enter valid width and height values.");return}h(!0),zo(!0);try{const{prompt:N}=await bo();let te=N1(N,{seedMode:me,seedValue:me==="custom"?ml:null,checkpoint:ne||null,lora:ae||null,width:E,height:M});ze.length&&(te=k1(te,ze,He,{mutate:!0})),Cg({workflowName:t.filename||"gallery",workflow:te,timestamp:Date.now()}),await xd({prompt:te}),zo(!1),p(!0),setTimeout(()=>{I(!1),p(!1)},1500)}catch(N){if(zo(!1),N!=null&&N.unauthorized){window.location.hash="#/login";return}const G=((S=N==null?void 0:N.payload)==null?void 0:S.error)||(N==null?void 0:N.message)||"Unable to re-run this item.";alert(G)}finally{h(!1)}}},Ay=async()=>{var N;if(!(!(t!=null&&t.filename)||!window.confirm("Delete this item? This cannot be undone."))){b(!0);try{await Sg({filename:t.filename,subfolder:t.subfolder||""}),i==null||i(),n==null||n()}catch(G){if(G!=null&&G.unauthorized){window.location.hash="#/login";return}const te=((N=G==null?void 0:G.payload)==null?void 0:N.error)||(G==null?void 0:G.message)||"Unable to delete this item.";alert(te)}finally{b(!1)}}},Iy=l.jsx(Va,{open:gr,onClose:()=>wn(!1),title:((Gd=et==null?void 0:et.element)==null?void 0:Gd.type)==="alias"?"Alias strength":"Tag strength",tokenLabel:et?((Kd=et.element)==null?void 0:Kd.type)==="alias"?`${et.displayName}  $${(Yd=et.element)==null?void 0:Yd.text}$`:et.displayName:"",weight:(et==null?void 0:et.weight)??1,onApply:S=>{et!=null&&et.element&&Zn(N=>gu(N||"",et.element,S))},onDeleteToken:()=>{et!=null&&et.element&&jy(et.element)},onReplace:()=>{et!=null&&et.element&&uy(et.element,et.displayName)}});return!t||!e||typeof document>"u"?null:hd.createPortal(l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"react-modal-overlay",role:"presentation",onPointerDown:S=>{g.current=S.target===S.currentTarget},onClick:S=>{g.current&&S.target===S.currentTarget&&($.current||n==null||n())},children:l.jsx("div",{className:"react-modal-content media-viewer-dialog",ref:C,role:"dialog","aria-modal":"true","aria-label":"Preview",onClick:S=>S.stopPropagation(),tabIndex:-1,children:l.jsxs("div",{className:"media-viewer-panel",children:[l.jsx(b1,{filename:t.filename,locationLabel:ko,isClip:bi,url:Ni,canRerun:Kr,rerunBusy:j,canDelete:No,deleteBusy:x,metaRows:hl,metaOpen:w,onToggleMeta:()=>k(S=>!S),onOpenOptions:oy,onDelete:Ay,onClose:n,closeButtonRef:v}),w?l.jsx(E1,{metaRows:hl}):null,l.jsx(L1,{showNav:Co,canPrev:c,canNext:u,onPrev:r,onNext:s,isClip:bi,url:Ni,filename:t.filename})]})})}),l.jsx(Ht,{open:R,onClose:()=>I(!1),title:"Re-run options",footer:f?l.jsxs("div",{className:"fade-in flex items-center justify-center gap-2 py-2 text-sm font-medium text-[#44E1C5]",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"Render queued successfully!"]}):l.jsxs("div",{className:"flex gap-2",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:()=>I(!1),disabled:j,children:"Cancel"}),l.jsx(K,{variant:"primary",className:"w-full",onClick:Ry,disabled:j||kt||!!Sn||!gl||!he,children:j?"Re-running":"Run"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[!kt&&!Sn&&Yt.length?l.jsx(K,{variant:"muted",className:"w-full",onClick:()=>{ge("elements"),cy()},children:"Open prompt editor"}):null,kt?l.jsx("div",{className:"composer-alias-empty",children:"Loading prompt"}):null,Sn?l.jsx("div",{className:"text-xs text-[#FF8F70]",children:Sn}):null,l.jsx(ls,{title:"Seed",variant:"bare",defaultOpen:!0,children:l.jsxs("div",{className:"sheet-section",children:[l.jsx($r,{ariaLabel:"Seed mode",value:me,onChange:A,size:"sm",items:Pi}),me==="custom"?l.jsx("input",{type:"number",inputMode:"numeric",className:"ui-control ui-input mt-2",placeholder:"Enter seed",value:L,onChange:S=>D(S.target.value)}):null,l.jsx("div",{className:"sheet-hint text-xs text-[#9DA3FFCC]",children:me==="random"?"Randomize each run":"Keep or customize the seed used in the prompt."})]})}),!kt&&!Sn&&!Yt.length?l.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:"No prompt text found for this image."}):null,_e.hasSize?l.jsx(ls,{title:"Size",variant:"bare",defaultOpen:!1,children:l.jsx("div",{className:"sheet-section",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"number",inputMode:"numeric",min:1,step:1,className:"ui-control ui-input flex-1",placeholder:"Width",value:_,onChange:S=>H(S.target.value),"aria-label":"Width","aria-invalid":Ce}),l.jsx("span",{className:"text-xs text-[#9DA3FF99]","aria-hidden":"true",children:""}),l.jsx("input",{type:"number",inputMode:"numeric",min:1,step:1,className:"ui-control ui-input flex-1",placeholder:"Height",value:Q,onChange:S=>oe(S.target.value),"aria-label":"Height","aria-invalid":Ue})]})})}):null,_e.hasCheckpoint?l.jsx(ls,{title:"Checkpoint",variant:"bare",defaultOpen:!1,children:l.jsxs("div",{className:"sheet-section",children:[$n?l.jsx(Je,{value:U,onChange:W,"aria-label":"Checkpoint folder filter",size:"sm",searchThreshold:0,options:Yr.map(S=>({value:S,label:S}))}):null,l.jsx(Je,{value:ne,onChange:re,wrapperClassName:$n?"mt-2":"","aria-label":"Checkpoint override",size:"sm",searchThreshold:0,options:[{value:"",label:Le?`Keep current (${Le})`:"Keep current"},...iy]})]})}):null,_e.hasLora?l.jsx(ls,{title:"LoRA",variant:"bare",defaultOpen:!1,children:l.jsxs("div",{className:"sheet-section",children:[gt?l.jsx(Je,{value:ue,onChange:je,"aria-label":"LoRA folder filter",size:"sm",searchThreshold:0,options:Qr.map(S=>({value:S,label:S}))}):null,l.jsx(Je,{value:ae,onChange:Y,wrapperClassName:gt?"mt-2":"","aria-label":"LoRA override",size:"sm",searchThreshold:0,options:[{value:"",label:Oe?`Keep current (${Oe})`:"Keep current"},...ay]})]})}):null,ji?l.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:"Loading model choices"}):null,Hr?l.jsx("div",{className:"text-xs text-[#FF8F70]",children:Hr}):null]})}),l.jsx(Ht,{open:Z,onClose:dy,title:"Edit prompt",variant:"fullscreen",footer:l.jsx("div",{className:"flex gap-2",children:l.jsx(K,{variant:"muted",className:"w-full",onClick:fy,children:"Back to options"})}),children:l.jsxs("div",{className:"sheet-stack",children:[kt?l.jsx("div",{className:"composer-alias-empty",children:"Loading prompt"}):null,Sn?l.jsx("div",{className:"text-xs text-[#FF8F70]",children:Sn}):null,de?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Replacing"}),l.jsx("div",{className:"sheet-hint",children:hy||""}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>Se(null),children:"Cancel replace"}),l.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:"Choose a replacement from Aliases or Tags. Selection returns to options."})]})]}):null,!kt&&!Sn&&Yt.length?l.jsxs(l.Fragment,{children:[Od.length>1?l.jsx(Je,{value:(Ct==null?void 0:Ct.key)||"",onChange:Pe,"aria-label":"Prompt source",size:"sm",options:Od}):null,l.jsx($r,{ariaLabel:"Prompt element view",value:ie,onChange:ge,items:py,size:"sm"}),ie==="elements"?l.jsxs("div",{className:"composer-panel composer-panel-compose is-visible",children:[l.jsx("div",{className:"composer-editor",children:l.jsxs("div",{className:"composer-input-row",children:[l.jsx("input",{type:"text",value:Ve,onChange:S=>T(S.target.value),onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),Vd())},className:"composer-input ui-control ui-input is-compact",placeholder:my,"aria-label":Dd,disabled:!Ct}),l.jsx(K,{size:"icon",variant:"ghost",onClick:Vd,disabled:!Ve.trim()||!Ct,"aria-label":Dd,children:"+"})]})}),l.jsxs("div",{className:"composer-tokens",children:[l.jsxs("div",{className:"composer-tokens-header",children:[l.jsxs("span",{className:"composer-tokens-label",children:["Elements",l.jsx("span",{className:"composer-tokens-count",children:Mn.length})]}),l.jsx("span",{className:"composer-tokens-hint",children:"Drag handle to reorder  Tap to adjust or replace"})]}),Mn.length?l.jsx("div",{ref:Si,className:`composer-tokens-list ${Lt!==null?"is-dragging":""}`,style:{"--composer-elements":Mn.length},children:Mn.map((S,N)=>{const G=S.type==="alias"&&Wa({token:S.text})||S.text,te=Hl(Eo||"",S),be=(te==null?void 0:te.weight)??1,qe=Lt===N,at=un===N&&Lt!==null&&Lt!==N;return l.jsxs("span",{className:`composer-token composer-token-draggable ${S.type==="alias"?"is-alias":"is-tag"} ${qe?"is-dragging":""} ${at?"is-drop-target":""}`,role:"button",tabIndex:0,draggable:!0,title:S.type==="alias"?`Alias: $${S.text}$`:`Tag: ${S.text}`,onDragStart:yt=>ky(yt,N),onDragEnd:Ny,onDragOver:yt=>Cy(yt,N),onDragLeave:by,onDrop:yt=>Ey(yt,N),onTouchStart:yt=>Ly(yt,N),onTouchMove:Py,onTouchEnd:zy,onTouchCancel:_y,onClick:()=>{Lt===null&&Wd(S,G)},onKeyDown:yt=>{yt.target===yt.currentTarget&&(yt.key==="Enter"||yt.key===" ")&&(yt.preventDefault(),Wd(S,G))},children:[l.jsx("span",{className:"composer-token-order",children:N+1}),l.jsx("span",{className:"composer-token-drag-handle","aria-hidden":"true",children:l.jsx(Da,{size:10})}),l.jsx("span",{className:"composer-token-name",children:G}),S.type==="alias"&&l.jsx("span",{className:"composer-token-type",children:"$"}),Math.abs(be-1)>1e-6&&l.jsxs("span",{className:"composer-token-weight",children:[En(be),""]})]},`${S.type}-${S.text}-${S.start}`)})}):l.jsx("div",{className:"composer-empty",children:"No elements yet."})]})]}):null,ie==="aliases"?l.jsxs("div",{className:"composer-panel composer-panel-aliases is-visible",children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{type:"text",value:Ne,onChange:S=>Re(S.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>Re(""),disabled:!Ne,children:"Clear"})]}),l.jsx(Je,{value:Ae,onChange:Ye,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:gy.map(S=>({value:S,label:S==="All"?"Category: All":Gn(S)}))}),Bd.length>2?l.jsx(Je,{value:tt,onChange:ct,wrapperClassName:"composer-subcategory-select",size:"sm",searchThreshold:0,options:Bd.map(S=>({value:S,label:S==="All"?"All subcategories":zn(S)}))}):null]}),J?l.jsx("div",{className:"composer-tag-collection-status",role:"status",children:J}):null,l.jsx("div",{className:"composer-alias-list",role:"list",children:m?l.jsx("div",{className:"composer-alias-empty",children:"Loading aliases"}):y?l.jsx("div",{className:"composer-alias-empty",children:"Unable to load aliases."}):xl.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):l.jsxs(l.Fragment,{children:[yy.map(S=>l.jsx(sy,{id:S.key,name:S.name||S.token,category:S.category,text:S.text,isSelected:Po.has(String(S.token||"").toLowerCase()),onOpen:()=>wy(S.token,S.displayName),visibilityStyle:Op},S.key)),jt<xl.length?l.jsxs(K,{variant:"muted",className:"w-full",onClick:()=>V(S=>S+30),children:["Show more (",xl.length-jt," left)"]}):null]})})]}):null,ie==="tags"?l.jsxs("div",{className:"composer-panel composer-panel-tags is-visible",children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{type:"search",value:Ee,onChange:S=>Ie(S.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>Ie(""),disabled:!Ee,children:"Clear"})]}),l.jsx(Je,{value:Fe,onChange:Qe,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:[{value:"",label:"Category: All"},...vy]}),l.jsxs("div",{className:"composer-sort-row",children:[l.jsx(Je,{value:B,onChange:se,wrapperClassName:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]}),l.jsxs("div",{className:"composer-min-count",children:[l.jsx("span",{className:"composer-filter-divider","aria-hidden":"true",children:"|"}),l.jsx("label",{className:"composer-min-count-label",htmlFor:"rerun-min-count",children:"Minimum count"}),l.jsx("input",{id:"rerun-min-count",type:"number",inputMode:"numeric",min:0,step:1,value:P,onChange:S=>{const N=S.target.value;(N===""||Number(N)>=0)&&F(N)},className:"ui-control ui-input is-compact composer-min-count-input",placeholder:"0"})]})]})]}),ol?l.jsx("div",{className:"composer-tags-error",children:ol}):null,tn?l.jsx("div",{className:"composer-tag-collection-status",role:"status",children:tn}):null,l.jsx("div",{className:"composer-alias-list composer-tags-grid",role:"list",children:en?l.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):ke.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):l.jsxs(l.Fragment,{children:[ke.map(S=>l.jsx(ly,{tag:S.tag,category:S.category,count:S.count,isCollected:Lo.has(String(S.tag||"").toLowerCase()),onToggle:Sy,visibilityStyle:Op},`${S.tag}-${S.category}`)),ke.length<we?l.jsx(K,{variant:"muted",className:"w-full",onClick:xy,disabled:xt,children:xt?"Loading more":`Show more (${we-ke.length} left)`}):null]})})]}):null]}):null,!kt&&!Sn&&!Yt.length?l.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:"No prompt text found for this image."}):null]})}),Iy]}),document.body)}const R1=(e="")=>e.startsWith("."),A1=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),I1=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);function T1(){const e=Pd(),t=(Y,U="")=>{try{return typeof window<"u"&&localStorage.getItem(Y)||U}catch{return U}},n=(Y,U)=>{try{typeof window<"u"&&localStorage.setItem(Y,U)}catch{}},[r,s]=o.useState(t("galleryPath","")),[i,a]=o.useState([]),[c,u]=o.useState(!1),[d,m]=o.useState(!1),[y,g]=o.useState(""),[v,w]=o.useState(1),[k,j]=o.useState(1),[h,f]=o.useState(()=>{const Y=t("galleryPageSize","30"),U=parseInt(Y,10);return Number.isFinite(U)?U:30}),[p,x]=o.useState("all"),[b,C]=o.useState(!1),[z,$]=o.useState(""),[O,R]=o.useState(()=>t("galleryRecursive","0")==="1"),[I,Z]=o.useState(0);o.useEffect(()=>{let Y=!1;const U=new AbortController;return(async()=>{u(!0),g("");try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:gallery:fetch")}catch{}try{const ue=await wg(r,v,h,b,O,p,I,{signal:U.signal,includeMeta:!0});if(Y)return;ue&&ue.items?(a(ue.items),j(ue.total_pages||1),g("")):(a([]),j(1));try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:gallery:ready"),performance.measure("cozygen:gallery:first-paint","cozygen:gallery:fetch","cozygen:gallery:ready"))}catch{}}catch(ue){if((ue==null?void 0:ue.name)==="AbortError")return;console.error("Failed to load gallery",ue),Y||g("Unable to load gallery right now."),Y||(a([]),j(1))}finally{!Y&&!U.signal.aborted&&(u(!1),m(!0))}})(),n("galleryPath",r),n("galleryPageSize",String(h)),()=>{Y=!0,U.abort()}},[r,v,h,I,b,O,p]);const X=o.useMemo(()=>{if(!r)return[];const Y=r.replace(/\\/g,"/").split("/").filter(Boolean),U=[];for(let W=0;W<Y.length;W++)U.push({name:Y[W],path:Y.slice(0,W+1).join("/")});return U},[r]),de=o.useMemo(()=>i.filter(Y=>Y.type==="directory").map(Y=>({filename:Y.filename,subfolder:Y.subfolder})),[i]),Se=o.useMemo(()=>{const Y=(z||"").trim().toLowerCase();return i.filter(U=>{const W=(U.filename||"").toLowerCase();return!(!b&&R1(W)||U.type!=="directory"&&(p==="image"&&!A1(W)||p==="video"&&!I1(W))||Y&&!W.includes(Y))})},[i,b,p,z]),ce=o.useMemo(()=>Se.filter(Y=>Y.type!=="directory"),[Se]),me=o.useCallback(()=>{if(!r)return;const Y=r.replace(/\\/g,"/").lastIndexOf("/"),U=Y===-1?"":r.slice(0,Y);s(U),w(1)},[r]),A=o.useCallback(()=>{s(""),w(1)},[]),L=o.useCallback(Y=>{s(Y||""),w(1)},[]),D=o.useCallback(Y=>{s(Y),w(1)},[]),_=o.useCallback(Y=>{const U=parseInt(String(Y),10)||30;f(U),w(1)},[]),H=o.useCallback(Y=>{x(Y),w(1)},[]),Q=o.useCallback(Y=>{const U=!!Y;R(U),w(1),n("galleryRecursive",U?"1":"0")},[]),oe=o.useCallback(Y=>{$(Y),w(1)},[]),ne=o.useCallback(()=>{Z(Y=>Y+1)},[]),re=o.useRef(null),ae=o.useCallback(()=>{re.current||(re.current=window.setTimeout(()=>{re.current=null,ne()},400))},[ne]);return o.useEffect(()=>{const Y=()=>ne();return typeof window<"u"&&window.addEventListener&&window.addEventListener("cozygen:queue-finished",Y),()=>{typeof window<"u"&&window.removeEventListener&&window.removeEventListener("cozygen:queue-finished",Y)}},[ne]),o.useEffect(()=>{if(typeof window>"u"||!e)return;let Y=!1,U,W,ue=8e3;const je=()=>{W&&(clearTimeout(W),W=null)},_e=(ze=8e3)=>{je(),W=window.setTimeout(()=>{Y||(ae(),_e(ue))},ze)};return(()=>{if(!("EventSource"in window)){_e();return}const ze=new URLSearchParams({subfolder:r||"",recursive:O?"1":"0",show_hidden:b?"1":"0"});U=new EventSource(`/cozygen/api/gallery/stream?${ze.toString()}`),U.onmessage=()=>{Y||ae()},U.onerror=()=>{U&&(U.close(),U=null),ue=Math.min(Math.ceil(ue*1.4),2e4),_e()}})(),()=>{Y=!0,je(),re.current&&(clearTimeout(re.current),re.current=null),U&&(U.close(),U=null)}},[r,O,b,ae,e]),o.useEffect(()=>{e&&ne()},[e,ne]),{path:r,items:i,loading:c,hasLoaded:d,error:y,page:v,totalPages:k,perPage:h,kind:p,showHidden:b,query:z,recursive:O,crumbs:X,dirChips:de,filtered:Se,mediaItems:ce,setPage:w,setPerPage:_,setShowHidden:C,setQuery:oe,setKind:H,setRecursive:Q,goBack:me,goRoot:A,goToPath:L,selectDir:D,refresh:ne}}function $1(e){const[t,n]=o.useState(!1),[r,s]=o.useState(null);o.useEffect(()=>{if(!e||e.length===0){s(null),n(!1);return}s(v=>v==null?v:v>=e.length?e.length-1:v)},[e]);const i=o.useCallback(v=>{if(!e||!e.length||!v)return;const w=e.indexOf(v);w!==-1&&(s(w),n(!0))},[e]),a=o.useCallback(()=>{n(!1),s(null)},[]),c=o.useCallback(()=>{!e||!e.length||s(v=>v==null||v>=e.length-1?v:v+1)},[e]),u=o.useCallback(()=>{!e||!e.length||s(v=>v==null||v<=0?v:v-1)},[e]),d=r!=null&&r>=0&&e&&r<e.length?e[r]:null,m=(e==null?void 0:e.length)||0,y=r!==null&&r>0,g=r!==null&&r<m-1;return{viewerOpen:t,viewerIndex:r,currentMedia:d,total:m,canPrev:y,canNext:g,open:i,close:a,next:c,prev:u,setViewerOpen:n}}const Up="cozygen_gallery_view_mode",Vp="cozygen_gallery_feed_autoplay";function M1(e,t){const n=o.useRef(null),[r,s]=o.useState(0),[i,a]=o.useState({width:0,cols:0,top:0,viewport:typeof window<"u"&&window.innerHeight||800}),c=g=>{if(!g||typeof window>"u")return null;let v=g.parentElement;for(;v;){const w=window.getComputedStyle(v);if(w.overflowY==="auto"||w.overflowY==="scroll")return v;v=v.parentElement}return window};o.useEffect(()=>{if(!t)return;const g=n.current;if(!g||typeof window>"u"||typeof ResizeObserver>"u")return;const v=c(g)||window,w=()=>{const f=g.getBoundingClientRect(),p=f.width||g.clientWidth||1,x=Math.max(1,Math.floor(p/160)),b=v===window?window.scrollY||0:v.scrollTop||0,C=v===window?{top:0}:v.getBoundingClientRect(),z=v===window?f.top+(window.scrollY||0):f.top-C.top+b,$=v===window?window.innerHeight||800:v.clientHeight||800;a(O=>O.width===p&&O.cols===x&&O.top===z&&O.viewport===$?O:{width:p,cols:x,top:z,viewport:$}),s(b)};w();const k=new ResizeObserver(()=>w());k.observe(g),window.addEventListener("resize",w);let j=!1;const h=()=>{j||(j=!0,window.requestAnimationFrame(()=>{j=!1;const f=v===window?window.scrollY||0:v.scrollTop||0;s(f)}))};return v.addEventListener("scroll",h,{passive:!0}),()=>{k.disconnect(),window.removeEventListener("resize",w),v.removeEventListener("scroll",h)}},[t]);const u=t&&i.cols>0&&e.length>60,{visibleItems:d,topSpacer:m,bottomSpacer:y}=o.useMemo(()=>{if(!u)return{visibleItems:e,topSpacer:0,bottomSpacer:0};const g=i.width/i.cols,v=Math.max(180,Math.ceil(g*1.25)+32),w=Math.ceil(e.length/i.cols),k=Math.max(0,r-i.top),j=Math.max(0,Math.floor(k/v)-2),h=Math.min(w,Math.ceil((k+i.viewport)/v)+2),f=j*i.cols,p=Math.min(e.length,h*i.cols);return{visibleItems:e.slice(f,p),topSpacer:j*v,bottomSpacer:Math.max(0,(w-h)*v)}},[e,i,r,u]);return{containerRef:n,visibleItems:d,topSpacer:m,bottomSpacer:y,virtualized:u}}function F1(){const{path:e,loading:t,hasLoaded:n,page:r,totalPages:s,perPage:i,kind:a,showHidden:c,recursive:u,error:d,crumbs:m,dirChips:y,filtered:g,mediaItems:v,setPage:w,setPerPage:k,setShowHidden:j,setKind:h,setRecursive:f,goBack:p,goRoot:x,goToPath:b,selectDir:C,refresh:z}=T1(),{viewerOpen:$,currentMedia:O,total:R,canPrev:I,canNext:Z,open:X,close:de,next:Se,prev:ce}=$1(v),[me,A]=o.useState(()=>{if(typeof window>"u")return"grid";const T=window.localStorage.getItem(Up);return T==="feed"||T==="grid"?T:"grid"}),[L,D]=o.useState(()=>typeof window>"u"?!1:window.localStorage.getItem(Vp)==="true"),[_,H]=o.useState("");o.useEffect(()=>{try{window.localStorage.setItem(Up,me)}catch{}},[me]),o.useEffect(()=>{try{window.localStorage.setItem(Vp,L?"true":"false")}catch{}},[L]);const Q=o.useCallback(async()=>{try{await E0(),z(),alert("Cache cleared successfully! Thumbnails will be regenerated.")}catch(T){alert("Failed to clear cache: "+(T.message||"Unknown error"))}},[z]),oe=o.useCallback(T=>(T==null?void 0:T.type)==="directory"?`dir:${T.subfolder||T.filename}`:`${T.subfolder||""}|${T.filename}`,[]),ne=o.useCallback(T=>{if(T.type==="directory"){C(T.subfolder);return}X(T)},[X,C]),re=o.useCallback(async T=>{var Re;if(!T||T.type==="directory"||!T.filename)return;const ie=T.filename||"this item";if(!window.confirm(`Delete "${ie}"? This cannot be undone.`))return;const Ne=oe(T);H(Ne);try{await Sg({filename:T.filename,subfolder:T.subfolder||""}),z()}catch(pe){if(pe!=null&&pe.unauthorized){window.location.hash="#/login";return}const Ae=((Re=pe==null?void 0:pe.payload)==null?void 0:Re.error)||(pe==null?void 0:pe.message)||"Unable to delete this item.";alert(Ae)}finally{H("")}},[oe,z]),ae=me==="grid",[Y,U]=o.useState(!1),W=o.useMemo(()=>[{key:"all",label:"All"},{key:"image",label:"Images"},{key:"video",label:"Videos"}],[]),ue=o.useMemo(()=>[{key:"grid",ariaLabel:"Grid view",icon:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})},{key:"feed",ariaLabel:"Feed view",icon:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("rect",{x:"2",y:"1",width:"12",height:"5",rx:"1"}),l.jsx("rect",{x:"2",y:"8",width:"12",height:"5",rx:"1"})]})}],[]);o.useEffect(()=>{try{window.localStorage.setItem("cozygen_gallery_pending","0")}catch{}window.dispatchEvent(new Event("cozygen:gallery-viewed"))},[]);const je=t&&!n,_e=t&&n,$e=`${g.length} items`,ze=je?"Loading":$e,Te=!!d,{containerRef:He,visibleItems:Ke,topSpacer:ve,bottomSpacer:Pe,virtualized:Ve}=M1(g,ae);return l.jsxs("div",{className:"page-shell gallery-shell",children:[l.jsx("div",{className:"screen-sticky gallery-header",children:l.jsxs("div",{className:"gallery-header-inner",children:[l.jsxs("div",{className:"page-bar gallery-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Gallery"}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx("span",{className:"gallery-status",children:ze}),l.jsx($r,{ariaLabel:"View mode",value:me,onChange:A,layout:"icon",size:"sm",items:ue}),l.jsx(K,{size:"xs",className:"mobile-only",onClick:()=>U(!0),children:"Filters"})]})]}),l.jsx("div",{className:"gallery-nav-row",children:l.jsx(o1,{subfolder:e,crumbs:m,dirChips:y,onBack:p,onRoot:x,onCrumb:T=>b(T),onSelectDir:T=>C(T)})}),l.jsxs("div",{className:"gallery-toolbar",children:[l.jsx("div",{className:"gallery-toolbar-left",children:l.jsx($r,{ariaLabel:"Filter by type",value:a,onChange:h,size:"sm",items:W})}),l.jsx("div",{className:"gallery-toolbar-right",children:l.jsxs("div",{className:"gallery-options",children:[l.jsx(K,{size:"icon",active:u,pressed:u,onClick:()=>f(T=>!T),title:u?"Showing subfolders":"This folder only","aria-label":"Toggle subfolders",children:u?l.jsx(du,{size:16}):l.jsx(hp,{size:16})}),l.jsx(K,{size:"icon",active:c,pressed:c,onClick:()=>j(T=>!T),title:c?"Showing hidden":"Hiding hidden","aria-label":"Toggle hidden items",children:c?l.jsx(mp,{size:16}):l.jsx(gp,{size:16})}),me==="feed"&&l.jsx(K,{size:"icon",active:L,pressed:L,onClick:()=>D(T=>!T),title:L?"Autoplay on":"Autoplay off","aria-label":"Toggle autoplay",children:L?l.jsx(yp,{size:16}):l.jsx(vp,{size:16})}),l.jsx(K,{size:"icon",onClick:z,title:"Refresh","aria-label":"Refresh gallery",children:l.jsx(fa,{size:16})}),l.jsx(K,{size:"xs",onClick:Q,title:"Clear thumbnail cache","aria-label":"Clear cache",children:"Clear Cache"})]})})]}),l.jsx("div",{className:"gallery-pagination",children:l.jsxs("div",{className:"gallery-pagination-controls",children:[l.jsx(K,{size:"icon",variant:"ghost",onClick:()=>w(T=>Math.max(1,T-1)),disabled:r<=1||t,"aria-label":"Previous page",children:l.jsx(zg,{size:16})}),l.jsxs("span",{className:"gallery-page-indicator",children:[r," / ",s]}),l.jsx(K,{size:"icon",variant:"ghost",onClick:()=>w(T=>T<s?T+1:T),disabled:r>=s||t,"aria-label":"Next page",children:l.jsx(vo,{size:16})}),l.jsx(Je,{value:i,onChange:T=>k(parseInt(T,10)||30),className:"gallery-page-size","aria-label":"Items per page",size:"sm",options:[15,30,60,120]})]})})]})}),je&&g.length===0?l.jsx("div",{className:"gallery-grid-responsive",children:Array.from({length:8}).map((T,ie)=>l.jsxs("div",{className:"gallery-skeleton-item",children:[l.jsx("div",{className:"gallery-skeleton-thumb skeleton"}),l.jsx("div",{className:"gallery-skeleton-label skeleton skeleton-text"})]},ie))}):Te&&g.length===0?l.jsxs("div",{className:"gallery-empty",role:"alert",children:[l.jsx("div",{className:"gallery-empty-icon",children:l.jsx(xp,{size:48})}),l.jsx("div",{className:"gallery-empty-title",children:"Gallery unavailable"}),l.jsx("div",{className:"gallery-empty-desc",children:d}),l.jsx(K,{size:"sm",variant:"primary",className:"mt-4",onClick:z,children:"Retry"})]}):g.length===0?l.jsxs("div",{className:"gallery-empty",children:[l.jsx("div",{className:"gallery-empty-icon",children:l.jsx(xp,{size:48})}),l.jsx("div",{className:"gallery-empty-title",children:"No media found"}),l.jsx("div",{className:"gallery-empty-desc",children:a!=="all"?`No ${a}s match your filters. Try selecting "All" or adjusting your search.`:"This folder is empty. Render something new or navigate to a different folder."})]}):ae?l.jsx("div",{className:"w-full overflow-hidden",children:l.jsxs("div",{className:"gallery-grid-responsive",ref:He,children:[Ve&&ve>0?l.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${ve}px`}}):null,Ke.map(T=>l.jsx(Mp,{item:T,onSelect:ne,onDelete:re,isDeleting:oe(T)===_,variant:"grid",autoPlay:!1},oe(T))),Ve&&Pe>0?l.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${Pe}px`}}):null]})}):l.jsx("div",{className:"flex flex-col gap-6 items-center",children:v.map(T=>l.jsx("div",{className:"w-full flex justify-center",children:l.jsx(Mp,{item:T,onSelect:ne,onDelete:re,isDeleting:oe(T)===_,variant:"feed",autoPlay:L})},oe(T)))}),l.jsx(_1,{isOpen:$,media:O,onClose:de,onPrev:ce,onNext:Se,onDeleted:z,total:R,canPrev:I,canNext:Z}),l.jsx(Ht,{open:Y,onClose:()=>U(!1),title:"Gallery filters",contentClassName:"gallery-filters-sheet",footer:l.jsx(K,{variant:"primary",className:"w-full",onClick:()=>U(!1),children:"Done"}),children:l.jsxs("div",{className:"sheet-stack gallery-filters-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Type"}),l.jsx($r,{ariaLabel:"Filter by type",value:a,onChange:h,size:"sm",items:W})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Options"}),l.jsxs("div",{className:"gallery-filter-actions",children:[l.jsx(K,{size:"sm",variant:u?"primary":"muted",onClick:()=>f(T=>!T),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[u?l.jsx(du,{size:14}):l.jsx(hp,{size:14}),l.jsx("span",{children:u?"Subfolders":"This folder"})]})}),l.jsx(K,{size:"sm",variant:c?"primary":"muted",onClick:()=>j(T=>!T),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[c?l.jsx(mp,{size:14}):l.jsx(gp,{size:14}),l.jsx("span",{children:c?"Hidden on":"Hidden off"})]})}),me==="feed"?l.jsx(K,{size:"sm",variant:L?"primary":"muted",onClick:()=>D(T=>!T),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[L?l.jsx(yp,{size:14}):l.jsx(vp,{size:14}),l.jsx("span",{children:L?"Autoplay":"No autoplay"})]})}):null,l.jsx(K,{size:"sm",variant:"ghost",onClick:z,children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[l.jsx(fa,{size:14}),l.jsx("span",{children:"Refresh"})]})}),l.jsx(K,{size:"sm",variant:"ghost",onClick:Q,title:"Clear thumbnail cache",children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[l.jsx(fa,{size:14}),l.jsx("span",{children:"Clear cache"})]})})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Page size"}),l.jsxs("div",{className:"gallery-filter-page",children:[l.jsx(Je,{value:i,onChange:T=>k(parseInt(T,10)||30),"aria-label":"Items per page",size:"sm",options:[15,30,60,120]}),l.jsxs("div",{className:"sheet-hint",children:[_e?l.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):null,l.jsxs("span",{children:[ze,"  Page ",r," of ",s]})]}),l.jsxs("div",{className:"gallery-filter-pagination",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:()=>w(T=>Math.max(1,T-1)),disabled:r<=1||t,children:"Prev"}),l.jsx(K,{variant:"muted",className:"w-full",onClick:()=>w(T=>T<s?T+1:T),disabled:r>=s||t,children:"Next"})]})]})]})]})})]})}const O1=()=>typeof window>"u"?800:window.innerHeight||800,D1=e=>{if(!e||typeof window>"u")return null;let t=e.parentElement;for(;t;){const n=window.getComputedStyle(t);if(n.overflowY==="auto"||n.overflowY==="scroll")return t;t=t.parentElement}return window};function Ad({itemCount:e,enabled:t=!0,estimateRowHeight:n=72,overscan:r=6,minItems:s=80}={}){const i=o.useRef(null),a=o.useRef(n),[c,u]=o.useState({top:0,scrollTop:0,viewport:O1(),rowHeight:n});o.useEffect(()=>{if(!t)return;const k=i.current;if(!k||typeof window>"u"||typeof ResizeObserver>"u")return;const j=D1(k)||window,h=()=>{const b=k.getBoundingClientRect(),C=j===window?window.scrollY||0:j.scrollTop||0,z=j===window?{top:0}:j.getBoundingClientRect(),$=j===window?b.top+(window.scrollY||0):b.top-z.top+C,O=j===window?window.innerHeight||800:j.clientHeight||800;u(R=>R.top===$&&R.scrollTop===C&&R.viewport===O&&R.rowHeight===a.current?R:{top:$,scrollTop:C,viewport:O,rowHeight:a.current})};h();const f=new ResizeObserver(()=>h());f.observe(k),window.addEventListener("resize",h);let p=!1;const x=()=>{p||(p=!0,window.requestAnimationFrame(()=>{p=!1;const b=j===window?window.scrollY||0:j.scrollTop||0;u(C=>C.scrollTop===b&&C.rowHeight===a.current?C:{...C,scrollTop:b,rowHeight:a.current})}))};return j.addEventListener("scroll",x,{passive:!0}),()=>{f.disconnect(),window.removeEventListener("resize",h),j.removeEventListener("scroll",x)}},[t]),o.useEffect(()=>{if(!t||typeof window>"u")return;let k=0;const j=()=>{const h=i.current;if(!h)return;const f=h.querySelector('[data-virtual-row="true"]');if(!f)return;const p=f.getBoundingClientRect(),x=Math.max(24,Math.round(p.height||0));x&&Math.abs(x-a.current)>2&&(a.current=x,u(b=>({...b,rowHeight:x})))};return k=window.requestAnimationFrame(j),()=>{k&&window.cancelAnimationFrame(k)}},[t,e,c.scrollTop]);const d=!!(t&&e>s),{startIndex:m,endIndex:y,topSpacer:g,bottomSpacer:v}=o.useMemo(()=>{if(!d)return{startIndex:0,endIndex:e,topSpacer:0,bottomSpacer:0};const k=c.rowHeight||n,j=Math.max(0,c.scrollTop-c.top),h=Math.max(0,Math.floor(j/k)-r),f=Math.min(e,Math.ceil((j+c.viewport)/k)+r);return{startIndex:h,endIndex:f,topSpacer:h*k,bottomSpacer:Math.max(0,(e-f)*k)}},[e,c,r,n,d]),w=y>=e-Math.max(6,r*2);return{containerRef:i,startIndex:m,endIndex:y,topSpacer:g,bottomSpacer:v,virtualized:d,isNearEnd:w}}const Qa="::",B1=()=>`alias-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,6)}`,nr=e=>String(e||"").split(",").map(t=>t.trim()).filter(Boolean),Id=e=>(e||[]).map(t=>String(t||"").trim()).filter(Boolean).join(", "),U1=(e,t)=>{const n=String(t||"").trim();if(!n)return String(e||"");const r=nr(e);return new Set(r.map(i=>i.toLowerCase())).has(n.toLowerCase())||r.push(n),Id(r)},V1=(e,t)=>{const n=String(t||"").trim().toLowerCase();if(!n)return String(e||"");const r=nr(e).filter(s=>s.toLowerCase()!==n);return Id(r)},W1=(e,t,n)=>{const r=String(t||"").trim().toLowerCase(),s=String(n||"").trim();if(!r||!s)return String(e||"");const i=nr(e).map(u=>u.toLowerCase()===r?s:u),a=new Set,c=[];return i.forEach(u=>{const d=String(u||"").trim().toLowerCase();!d||a.has(d)||(a.add(d),c.push(u))}),Id(c)},cc=(e,t={})=>Object.entries(Kl(e)).map(([n,r],s)=>{const[i,a]=String(n).includes(Qa)?n.split(Qa):["",n],c=a||n,u=t[n]||t[c]||i||"";return{id:`existing-${s}-${n}`,name:c,text:r,category:u}}),Wp=e=>{const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.text)=="string"?n.text.trim():"";if(r&&s){const i=String((n==null?void 0:n.category)||"").trim(),a=i?`${i}${Qa}${r}`:r;t[a]=s}}),t},Hp=e=>{const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.category)=="string"?n.category.trim():"";if(r){const i=s?`${s}${Qa}${r}`:r;t[i]=s}}),t},H1={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function G1(){var se;const e=qn(),{aliases:t,aliasCategories:n,categoryList:r,loading:s,saving:i,error:a,persistAliases:c}=qg(),[u,d]=o.useState(()=>cc(t,n)),[m,y]=o.useState(()=>Array.isArray(r)?r:[]),[g,v]=o.useState("All"),[w,k]=o.useState("All"),[j,h]=o.useState(""),f=o.useDeferredValue(j),[p,x]=o.useState(""),[b,C]=o.useState(!1),[z,$]=o.useState(!1),[O,R]=o.useState({loading:!1,invalid:[],suggestions:{}}),[I,Z]=o.useState(!1),[X,de]=o.useState(null),[Se,ce]=o.useState(""),me=o.useRef(null),A=o.useRef(null),[L,D]=o.useState(!1),[_,H]=o.useState(""),[Q,oe]=o.useState(""),ne=Sd("(min-width: 1024px)");o.useEffect(()=>{if(L)return;const P=cc(t,n||{});d(P),p&&!P.some(F=>F.id===p)&&(x(""),C(!1))},[n,L]),o.useEffect(()=>{L||Array.isArray(r)&&y(r)},[r,L]),o.useEffect(()=>{if(L)return;const P=cc(t,n||{});d(P),p&&!P.some(F=>F.id===p)&&(x(""),C(!1))},[t,n,p,L]);const re=o.useMemo(()=>Wp(u),[u]),ae=()=>{const P={id:B1(),name:"",text:"",category:""};d(F=>[...F,P]),x(P.id),ce(""),D(!0),C(!0)},Y=(P,F,q)=>{D(!0),d(le=>le.map((ke,fe)=>fe===P?{...ke,[F]:q}:ke))},U=P=>{D(!0),d(F=>{var le;const q=F.filter((ke,fe)=>fe!==P);return(q.length===0||p===((le=F[P])==null?void 0:le.id))&&(x(""),C(!1)),q})},W=async()=>{ce("");try{const P=new Map;if(u.forEach(q=>{nr((q==null?void 0:q.text)||"").forEach(ke=>{const fe=String(ke).toLowerCase();fe&&(P.has(fe)||P.set(fe,{tag:ke,rows:[]}),P.get(fe).rows.push(q.id))})}),P.size){const q=Array.from(P.values()).map(le=>le.tag);try{const le=await sc(q),ke=Array.isArray(le==null?void 0:le.invalid)?le.invalid:[],fe=new Set(ke.map(we=>String(we).toLowerCase()));if(fe.size){const we=u.map(Be=>{const Tt=nr((Be==null?void 0:Be.text)||"").filter(An=>fe.has(String(An).toLowerCase()));if(!Tt.length)return null;const en=Be.category?`${Be.category}:${Be.name}`:Be.name;return{id:Be.id,token:en,friendlyName:formatAliasFriendlyName({name:Be.name})||Be.name||"Untitled",category:Be.category||"",invalid:Tt}}).filter(Boolean);de({invalid:ke,invalidLower:Array.from(fe),rows:we,suggestions:(le==null?void 0:le.suggestions)||{}}),Z(!0),ce("Fix invalid tags before saving.");return}}catch(le){console.error("Unable to validate tags",le),ce("Unable to validate tags right now.");return}}const F=Hp(u);await c({items:re,categories:F,categoryList:m}),D(!1),ce("Saved.")}catch{ce("Unable to save right now.")}},ue=o.useMemo(()=>{const P=f.trim().toLowerCase(),q=[...u.filter(le=>{const ke=(le.category||"").trim();if(g===""&&ke||g!=="All"&&g!==""&&ke!==g)return!1;const fe=Il(le.name||"",le.category||"");if(w!=="All"&&fe!==w)return!1;if(!P)return!0;const we=ke?`${ke}:${le.name}`:le.name;return(le.name||"").toLowerCase().includes(P)||(le.text||"").toLowerCase().includes(P)||(ke||"").toLowerCase().includes(P)||(we||"").toLowerCase().includes(P)})];return q.sort((le,ke)=>(le.name||"").localeCompare(ke.name||"")),q},[u,g,w,f]),{containerRef:je,startIndex:_e,endIndex:$e,topSpacer:ze,bottomSpacer:Te,virtualized:He}=Ad({itemCount:ue.length,enabled:!0,estimateRowHeight:86,overscan:8,minItems:120}),Ke=He?ue.slice(_e,$e):ue,ve=ue.find(P=>P.id===p)||u.find(P=>P.id===p)||null,Pe=ve?ve.category?`${ve.category}:${ve.name}`:ve.name||"alias":"",Ve=ve&&(formatAliasFriendlyName({name:ve.name})||ve.name)||"Alias",T=Pe?`$${Pe}$`:"$alias$",ie=ue.length?ue:u,ge=ve?ie.findIndex(P=>P.id===ve.id):-1,Ne=ge>0?ie[ge-1]:null,Re=ge>=0&&ge<ie.length-1?ie[ge+1]:null,pe=P=>{P&&(x(P.id),C(!0),ce(""))},Ae=o.useMemo(()=>{const P=new Set(m||[]);return u.forEach(F=>{F.category&&P.add(F.category)}),Array.from(P).sort((F,q)=>F.localeCompare(q))},[u,m]),Ye=o.useMemo(()=>{const P=new Set;return u.forEach(F=>{const q=(F.category||"").trim();if(g===""&&q||g!=="All"&&g!==""&&q!==g)return;const le=Il(F.name||"",F.category||"");le&&P.add(le)}),Array.from(P).sort((F,q)=>F.localeCompare(q))},[u,g]);o.useEffect(()=>{w!=="All"&&(Ye.includes(w)||k("All"))},[Ye,w]),o.useEffect(()=>{oe("")},[p]);const tt=o.useMemo(()=>nr((ve==null?void 0:ve.text)||""),[ve==null?void 0:ve.text]),ct=o.useMemo(()=>{const P=Array.isArray(O==null?void 0:O.invalid)?O.invalid:[];return new Set(P.map(F=>String(F).toLowerCase()))},[O]);o.useEffect(()=>{if(!ve||!(b||ne))return;const P=tt,F=[],q=new Set;if(P.forEach(fe=>{const we=String(fe).toLowerCase();!we||q.has(we)||(q.add(we),F.push(fe))}),!F.length){R({loading:!1,invalid:[],suggestions:{}});return}let le=!1;const ke=window.setTimeout(async()=>{R(fe=>({...fe,loading:!0}));try{const fe=await sc(F);if(le)return;R({loading:!1,invalid:Array.isArray(fe==null?void 0:fe.invalid)?fe.invalid:[],suggestions:(fe==null?void 0:fe.suggestions)||{}})}catch(fe){console.error("Failed to validate tags",fe),le||R({loading:!1,invalid:[],suggestions:{}})}},260);return()=>{le=!0,window.clearTimeout(ke)}},[b,ne,ve,tt]);const jt=P=>{var q,le;const F=String(P||"");if(!F)return!1;try{return(le=(q=navigator.clipboard)==null?void 0:q.writeText)==null||le.call(q,F),!0}catch{return!1}},V=(P="")=>{const F=P?`?q=${encodeURIComponent(P)}`:"";e(`/tags${F}`)},J=()=>{var le;if(!ve)return;const P=nr(Q);if(!P.length){ce("Enter a tag to add.");return}const F=u.findIndex(ke=>ke.id===ve.id);if(F===-1)return;let q=((le=u[F])==null?void 0:le.text)||"";P.forEach(ke=>{q=U1(q,ke)}),Y(F,"text",q),oe(""),ce(`Added ${P.length} tag${P.length===1?"":"s"}.`)},ye=async()=>{const P=_.trim();if(!P){ce("Enter a category name.");return}const F=Array.from(new Set([...m||[],P]));y(F),H(""),ce("Category added.");const q=Wp(u),le=Hp(u);D(!0);try{await c({items:q,categories:le,categoryList:F}),D(!1),ce("Category saved.")}catch{ce("Unable to save right now.")}},Ee=o.useCallback(P=>{P&&(x(P.id),C(!0),ce(""))},[]),Ie=o.useMemo(()=>{const P=new Map;return u.forEach(F=>{F!=null&&F.id&&P.set(F.id,F)}),P},[u]),We=o.useCallback(P=>{const F=Ie.get(P);F&&Ee(F)},[Ee,Ie]),Fe=()=>{ne&&x(""),C(!1),ce("")};o.useMemo(()=>{const P=u.length,F=ue.length;return s&&P===0?"Loading":P===F?`${P} aliases`:`${F} of ${P} aliases`},[u.length,ue.length,s]),o.useEffect(()=>{const P=F=>{var Be,ht;if(F.defaultPrevented)return;const q=F.target,le=(q==null?void 0:q.tagName)||"",ke=["INPUT","TEXTAREA","SELECT"].includes(le)||(q==null?void 0:q.isContentEditable),fe=String(F.key||"").toLowerCase(),we=F.metaKey||F.ctrlKey;if(we&&fe==="s"){F.preventDefault(),L&&!i&&W();return}if(we&&fe==="n"){F.preventDefault(),ae();return}if(!ke&&fe==="/"){F.preventDefault(),(ht=(Be=A.current)==null?void 0:Be.focus)==null||ht.call(Be);return}fe==="escape"&&b&&!ne&&(F.preventDefault(),Fe())};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[ae,Fe,L,b,W,ne,i]);const Qe=l.jsxs("div",{className:"flex gap-2",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:Fe,children:ne?"Clear selection":"Close"}),l.jsx(K,{variant:"primary",className:"w-full",onClick:W,disabled:i||!L,children:i?"Saving":L?"Save":"Saved"})]}),B=ve?l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"alias-editor-toolbar",children:[l.jsxs("div",{className:"alias-editor-heading",children:[l.jsx("div",{className:"alias-editor-title",children:Ve}),l.jsx("div",{className:"alias-editor-meta",children:T})]}),l.jsxs("div",{className:"alias-editor-actions",children:[l.jsx(K,{size:"xs",variant:"muted",onClick:()=>pe(Ne),disabled:!Ne,title:"Previous alias",children:"Prev"}),l.jsx(K,{size:"xs",variant:"muted",onClick:()=>pe(Re),disabled:!Re,title:"Next alias",children:"Next"}),l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>{Pe&&jt(T)?ce("Token copied."):ce("Copy not available on this browser.")},title:"Copy token",children:"Copy token"})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Token"}),l.jsx("div",{className:"composer-token",children:T}),Il(ve.name||"",ve.category||"")?l.jsxs("div",{className:"sheet-hint",children:["Subcategory: ",zn(Il(ve.name||"",ve.category||""))]}):null]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Friendly name"}),l.jsx("div",{className:"composer-field",children:Ve})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Alias name"}),l.jsx("input",{ref:me,type:"text",value:ve.name||"",onChange:P=>{const F=u.findIndex(q=>q.id===ve.id);F!==-1&&Y(F,"name",P.target.value)},placeholder:"e.g. cherry_fruit",className:"sheet-input ui-control ui-input"})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Category"}),l.jsx(Je,{value:ve.category||"",onChange:P=>{const F=u.findIndex(q=>q.id===ve.id);F!==-1&&Y(F,"category",P)},size:"sm",searchThreshold:0,options:[{value:"",label:"Uncategorized"},...Ae.filter(Boolean).map(P=>({value:P,label:Gn(P)}))]}),l.jsx(K,{size:"xs",variant:"muted",onClick:()=>$(!0),children:"Manage categories"})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Expands to"}),l.jsx("textarea",{value:ve.text,onChange:P=>{const F=u.findIndex(q=>q.id===ve.id);F!==-1&&Y(F,"text",P.target.value)},placeholder:"Prompt text for this alias",className:"sheet-textarea ui-control ui-textarea is-compact",rows:6}),l.jsxs("div",{className:"tag-quick-add",children:[l.jsx("input",{type:"text",value:Q,onChange:P=>oe(P.target.value),onKeyDown:P=>{P.key==="Enter"&&(P.preventDefault(),J())},placeholder:"Add tags (comma separated)",className:"ui-control ui-input tag-quick-input","aria-label":"Add tags"}),l.jsx(K,{size:"sm",variant:"primary",onClick:J,disabled:!Q.trim(),children:"Add"})]}),l.jsxs("div",{className:"tag-editor-actions",children:[l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>V(""),children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(dr,{size:14}),"Open tag library"]})}),l.jsx(K,{size:"xs",variant:"muted",onClick:()=>{R(F=>({...F,loading:!0}));const P=nr(ve.text||"");sc(P).then(F=>{R({loading:!1,invalid:Array.isArray(F==null?void 0:F.invalid)?F.invalid:[],suggestions:(F==null?void 0:F.suggestions)||{}})}).catch(()=>R({loading:!1,invalid:[],suggestions:{}}))},disabled:O.loading,title:"Validate against danbooru_tags.md",children:O.loading?"Validating":"Validate"})]}),tt.length?l.jsx("div",{className:"tag-chip-list","aria-label":"Alias tags",children:tt.map(P=>{const F=ct.has(String(P).toLowerCase());return l.jsxs("span",{className:`ui-chip ${F?"is-invalid":""}`,children:[l.jsx("code",{className:"ui-chip-code",children:P}),l.jsx(K,{size:"mini",variant:"danger",onClick:()=>{const q=u.findIndex(le=>le.id===ve.id);q!==-1&&Y(q,"text",V1(ve.text||"",P))},"aria-label":`Remove ${P}`,title:"Remove",children:l.jsx(Or,{size:12})})]},P)})}):l.jsx("div",{className:"sheet-hint",children:"Tip: Use the Tag library to add validated tags quickly."}),!O.loading&&Array.isArray(O.invalid)&&O.invalid.length?l.jsxs("div",{className:"tag-invalid-panel",role:"alert",children:[l.jsxs("div",{className:"tag-invalid-title",children:["Invalid tags (",O.invalid.length,")"]}),l.jsx("div",{className:"tag-invalid-body",children:O.invalid.map(P=>{var q;const F=((q=O==null?void 0:O.suggestions)==null?void 0:q[P])||[];return l.jsxs("div",{className:"tag-invalid-row",children:[l.jsxs("div",{className:"tag-invalid-tag",children:[l.jsx("code",{children:P}),l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>V(P),children:"Find"})]}),Array.isArray(F)&&F.length?l.jsx("div",{className:"tag-invalid-suggestions",children:F.slice(0,6).map(le=>l.jsx(K,{size:"xs",variant:"chip",onClick:()=>{const ke=u.findIndex(fe=>fe.id===ve.id);ke!==-1&&Y(ke,"text",W1(ve.text||"",P,le))},title:`Replace ${P} with ${le}`,children:le},`${P}-${le}`))}):l.jsx("div",{className:"sheet-hint",children:"No suggestions found for this tag."})]},P)})})]}):null]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx(K,{variant:"danger",onClick:()=>{const P=u.findIndex(F=>F.id===ve.id);P!==-1&&(U(P),C(!1))},children:"Delete alias"}),l.jsx("div",{className:"sheet-hint",children:"Deleting removes it from your library. Use Save changes to persist."})]})]}):l.jsx("div",{className:"alias-editor-empty",children:"Select an alias to edit, or create a new one."});return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"page-shell page-stack alias-page",children:[l.jsxs("div",{className:"page-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Aliases"}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx(K,{size:"xs",onClick:()=>openTagLibrary({query:j||"",targetId:""}),title:"Browse danbooru tags",children:"Tags"}),l.jsx(K,{size:"xs",variant:"primary",onClick:ae,children:"Add"})]})]}),l.jsx("div",{className:"library-toolbar screen-sticky",children:l.jsxs("div",{className:"library-toolbar-inner",children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:A,type:"search",value:j,onChange:P=>h(P.target.value),className:"composer-search ui-control ui-input",placeholder:"Search aliases","aria-label":"Search aliases"}),l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>h(""),disabled:!j,children:"Clear"})]}),l.jsx(Je,{wrapperClassName:"composer-subcategory-select",value:g,onChange:v,"aria-label":"Filter by category",size:"sm",searchThreshold:0,options:[{value:"All",label:"Category: All"},{value:"",label:"Uncategorized"},...Ae.filter(Boolean).map(P=>({value:P,label:Gn(P)}))]}),l.jsx(Je,{wrapperClassName:"composer-subcategory-select",value:w,onChange:k,"aria-label":"Filter by subcategory",size:"sm",searchThreshold:0,options:[{value:"All",label:"Subcategory: All"},...Ye.map(P=>({value:P,label:zn(P)}))]}),L?l.jsx(K,{size:"sm",variant:"primary",onClick:W,disabled:i,children:i?"Saving":"Save changes"}):null]}),a?l.jsx("div",{className:"library-toolbar-status is-error",children:"Could not load aliases. Try again later."}):null,Se?l.jsx("div",{className:"library-toolbar-status",children:Se}):null]})}),l.jsxs("div",{className:"alias-layout",children:[l.jsx("div",{className:"alias-list",children:u.length===0&&!s?l.jsx("section",{className:"ui-panel text-center py-16",children:l.jsx("p",{className:"text-base text-[rgba(159,178,215,0.8)]",children:"No aliases yet. Add your first one."})}):l.jsxs("div",{className:"composer-alias-list",role:"list",ref:je,children:[ue.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases match your filters."}):null,He&&ze>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${ze}px`}}):null,Ke.map(P=>l.jsx(sy,{id:P.id,name:P.name,category:(P.category||"").trim(),text:P.text||"",isSelected:p===P.id,onOpen:We,visibilityStyle:H1},P.id)),He&&Te>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${Te}px`}}):null]})}),l.jsx("aside",{className:"alias-editor-panel",children:l.jsxs("div",{className:"alias-editor-card ui-panel",children:[B,ve?l.jsx("div",{className:"alias-editor-footer",children:Qe}):null]})})]})]}),l.jsx(Ht,{open:b&&!!ve&&!ne,onClose:Fe,title:"Alias",variant:"fullscreen",footer:Qe,children:B}),l.jsx(Ht,{open:z,onClose:()=>{$(!1),H(""),ce("")},title:"Categories",variant:"sheet",footer:l.jsx("div",{className:"sheet-hint",children:"Categories help you organize aliases and improve the Insert alias picker."}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Add category"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:_,onChange:P=>H(P.target.value),placeholder:"e.g. styles",className:"sheet-input ui-control ui-input"}),l.jsx(K,{size:"sm",variant:"primary",onClick:ye,children:"Add"})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Existing"}),Ae.length===0?l.jsx("div",{className:"sheet-hint",children:"No categories yet."}):l.jsx(Je,{value:"",onChange:P=>{P&&(v(P),$(!1))},size:"sm",searchThreshold:0,placeholder:"Select a category",options:Ae.filter(Boolean).map(P=>({value:P,label:Gn(P)}))})]})]})}),l.jsx(Ht,{open:I,onClose:()=>Z(!1),title:"Fix invalid tags",variant:"fullscreen",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:()=>Z(!1),children:"Close"}),l.jsx(K,{variant:"primary",className:"w-full",onClick:()=>{const P=new Set(((X==null?void 0:X.invalidLower)||[]).map(F=>String(F).toLowerCase()));if(!P.size){Z(!1);return}d(F=>F.map(q=>{const ke=nr((q==null?void 0:q.text)||"").filter(we=>!P.has(String(we).toLowerCase())),fe=joinTags(ke);return fe===((q==null?void 0:q.text)||"")?q:{...q,text:fe}})),D(!0),Z(!1),ce("Removed invalid tags. Review and save again.")},children:"Remove invalid tags"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsx("div",{className:"sheet-section",children:l.jsxs("div",{className:"sheet-hint",children:["These aliases contain tags not found in ",l.jsx("code",{className:"font-mono",children:"danbooru_tags.md"}),". Fix them before saving."]})}),(se=X==null?void 0:X.rows)!=null&&se.length?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Aliases with issues"}),l.jsx("div",{className:"composer-alias-list",role:"list",children:X.rows.map(P=>l.jsxs("button",{type:"button",role:"listitem",className:"composer-alias-item",onClick:()=>{x(P.id),C(!0),Z(!1)},children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:P.friendlyName}),P.category?l.jsx("span",{className:"composer-alias-category",children:Gn(P.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",P.token,"$"]}),l.jsx("div",{className:"tag-invalid-inline",children:P.invalid.map(F=>l.jsx("span",{className:"ui-chip is-invalid",children:l.jsx("code",{className:"ui-chip-code",children:F})},`${P.id}-${F}`))})]},P.id))})]}):null]})})]})}const K1={contentVisibility:"auto",containIntrinsicSize:"240px 120px"},Y1=o.memo(function({tag:t,category:n,count:r,isCollected:s,onSelectTag:i,addToCollection:a,removeFromCollection:c,setStatus:u}){const d=o.useCallback(()=>{const m=String(t||"");if(i){i(m),u(`Added: ${m}`);return}s?(c(m),u(`Removed: ${m}`)):(a(m),u(`Added: ${m}`))},[a,s,i,c,u,t]);return l.jsx("div",{className:"tag-library-row",role:"listitem",style:K1,"data-virtual-row":"true",children:l.jsxs("button",{type:"button",className:`composer-alias-item tag-library-item ${!i&&s?"is-collected":""}`,onClick:d,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name tag-library-name",children:l.jsx("code",{className:"tag-library-code",children:t})}),n?l.jsx("span",{className:"composer-alias-category",children:zn(n)}):null]}),l.jsx("div",{className:"composer-alias-token",children:Number(r||0).toLocaleString()})]})})});function Q1(e){var n,r;const t=String(e||"");if(!t)return!1;try{return(r=(n=navigator.clipboard)==null?void 0:n.writeText)==null||r.call(n,t),!0}catch{return!1}}function q1({open:e,onClose:t,onSelectTag:n,initialQuery:r="",title:s="Tag library",contextTitle:i="",contextToken:a="",contextText:c="",contextTagCount:u=null,inline:d=!1}){const[m,y]=o.useState(r||""),[g,v]=o.useState(""),[w,k]=o.useState("count"),[j,h]=o.useState(""),[f,p]=o.useState([]),[x,b]=o.useState([]),[C,z]=o.useState(0),[$,O]=o.useState(0),[R,I]=o.useState(!1),[Z,X]=o.useState(!1),[de,Se]=o.useState(""),[ce,me]=o.useState(""),A=o.useRef(null),L=o.useRef(null),D=o.useRef(new Map),_=o.useRef(new Map),[H,Q]=o.useState([]),[oe,ne]=o.useState(!1),[re,ae]=o.useState(null),[Y,U]=o.useState(null),W=o.useRef(null),ue=o.useRef(null),je=o.useRef(null),_e=o.useRef(null),$e=o.useRef(null),ze=x.length<C,Te=d||e,{containerRef:He,startIndex:Ke,endIndex:ve,topSpacer:Pe,bottomSpacer:Ve,virtualized:T,isNearEnd:ie}=Ad({itemCount:x.length,enabled:Te,estimateRowHeight:74,overscan:8,minItems:90}),ge=T?x.slice(Ke,ve):x,Ne=o.useMemo(()=>H.join(", "),[H]),Re=o.useMemo(()=>new Set(H.map(B=>B.toLowerCase())),[H]),pe=o.useMemo(()=>{const B=Number.parseInt(String(j||""),10);return Number.isFinite(B)&&B>0?B:0},[j]),Ae=o.useCallback((B,se,P,F,q,le)=>[B||"",se||"",P||"",String(F||0),String(q||0),String(le||0)].join("::"),[]),Ye=o.useCallback(()=>{const B=D.current;if(B.size<=50)return;const se=Array.from(B.entries());se.sort((P,F)=>{var q,le;return(((q=P[1])==null?void 0:q.ts)||0)-(((le=F[1])==null?void 0:le.ts)||0)}),se.slice(0,Math.max(0,se.length-50)).forEach(([P])=>B.delete(P))},[]),tt=o.useCallback(B=>{const se=String(B||"").trim();se&&Q(P=>new Set(P.map(q=>q.toLowerCase())).has(se.toLowerCase())?P:[...P,se])},[]),ct=o.useCallback(B=>{const se=String(B||"").trim().toLowerCase();se&&Q(P=>P.filter(F=>F.toLowerCase()!==se))},[]),jt=o.useCallback(()=>{Q([]),me("Cleared collected tags.")},[]),V=o.useCallback(()=>{var se,P;if(!H.length){me("No tags to copy.");return}if(Q1(Ne)){me(`Copied ${H.length} tag${H.length===1?"":"s"}.`);return}const B=je.current;if(B)try{B.value=Ne,B.removeAttribute("readonly"),B.select(),B.setSelectionRange(0,Ne.length);const F=document.execCommand&&document.execCommand("copy");if(B.setAttribute("readonly","readonly"),(P=(se=window.getSelection())==null?void 0:se.removeAllRanges)==null||P.call(se),F){me(`Copied ${H.length} tag${H.length===1?"":"s"}.`);return}}catch{}me("Copy not available on this browser.")},[H,Ne]),J=o.useCallback((B,se)=>{Q(P=>{const F=[...P],[q]=F.splice(B,1);return F.splice(se,0,q),F})},[]);o.useCallback((B,se)=>{ae(se),_e.current=B.target,B.dataTransfer.effectAllowed="move",B.dataTransfer.setData("text/plain",se.toString()),requestAnimationFrame(()=>{_e.current&&_e.current.classList.add("is-dragging")})},[]),o.useCallback(()=>{_e.current&&_e.current.classList.remove("is-dragging"),re!==null&&Y!==null&&re!==Y&&J(re,Y),ae(null),U(null),_e.current=null},[re,Y,J]),o.useCallback((B,se)=>{B.preventDefault(),B.dataTransfer.dropEffect="move",U(se)},[]),o.useCallback(()=>{},[]),o.useCallback((B,se)=>{const P=B.touches[0];$e.current={idx:se,startX:P.clientX,startY:P.clientY,moved:!1}},[]),o.useCallback(B=>{if(!$e.current)return;const se=B.touches[0],P=Math.abs(se.clientX-$e.current.startX),F=Math.abs(se.clientY-$e.current.startY);if(P>10||F>10){$e.current.moved=!0,ae($e.current.idx),B.preventDefault();const q=document.querySelectorAll(".tag-collection-chip"),le=se.clientX,ke=se.clientY;for(let fe=0;fe<q.length;fe++){const we=q[fe].getBoundingClientRect();if(le>=we.left&&le<=we.right&&ke>=we.top&&ke<=we.bottom){U(fe);break}}}},[]),o.useCallback(()=>{var B;(B=$e.current)!=null&&B.moved&&re!==null&&Y!==null&&re!==Y&&J(re,Y),$e.current=null,ae(null),U(null)},[re,Y,J]);const ye=o.useCallback(async({nextQuery:B,nextCategory:se,nextSort:P,nextMinCount:F}={})=>{var An;const q=typeof B=="string"?B:m,le=typeof se=="string"?se:g,ke=typeof P=="string"?P:w,fe=typeof F=="number"?F:pe,we=Ae(q,le,ke,fe,80,0),Be=Date.now(),ht=D.current.get(we);if(ht&&Be-ht.ts<5*60*1e3){b(ht.items||[]),z(Number(ht.total||0)),O(0),Se(""),me(""),I(!1);return}const Tt=_.current.get(we);if(Tt){try{const xt=await Tt;b((xt==null?void 0:xt.items)||[]),z(Number((xt==null?void 0:xt.total)||0)),O(0),Se(""),me("")}catch{}return}I(!0),Se(""),me(""),O(0),A.current&&A.current.key!==we&&A.current.controller.abort();const en=new AbortController;A.current={controller:en,key:we};try{const xt=Js({q,category:le,sort:ke,minCount:fe,limit:80,offset:0},{signal:en.signal});_.current.set(we,xt);const Et=await xt;D.current.set(we,{items:(Et==null?void 0:Et.items)||[],total:Number((Et==null?void 0:Et.total)||0),ts:Date.now()}),Ye(),b((Et==null?void 0:Et.items)||[]),z(Number((Et==null?void 0:Et.total)||0))}catch(xt){if((xt==null?void 0:xt.name)==="AbortError")return;console.error("Failed to search tags",xt),Se("Unable to load tags right now."),b([]),z(0)}finally{_.current.delete(we),((An=A.current)==null?void 0:An.key)===we&&(A.current=null),I(!1)}},[Ae,g,pe,m,w,Ye]),Ee=o.useCallback(async()=>{var ke;if(R||Z||!ze)return;const B=$+80,se=Ae(m,g,w,pe,80,B),P=Date.now(),F=D.current.get(se);if(F&&P-F.ts<5*60*1e3){b(fe=>[...fe,...F.items||[]]),z(Number(F.total||0)),O(B),X(!1);return}const q=_.current.get(se);if(q){try{const fe=await q,we=(fe==null?void 0:fe.items)||[];b(Be=>[...Be,...we]),z(Number((fe==null?void 0:fe.total)||0)),O(B)}catch{}return}X(!0),Se(""),L.current&&L.current.key!==se&&L.current.controller.abort();const le=new AbortController;L.current={controller:le,key:se};try{const fe=Js({q:m,category:g,sort:w,minCount:pe,limit:80,offset:B},{signal:le.signal});_.current.set(se,fe);const we=await fe,Be=(we==null?void 0:we.items)||[];D.current.set(se,{items:Be,total:Number((we==null?void 0:we.total)||0),ts:Date.now()}),Ye(),b(ht=>[...ht,...Be]),z(Number((we==null?void 0:we.total)||0)),O(B)}catch(fe){if((fe==null?void 0:fe.name)==="AbortError")return;console.error("Failed to load more tags",fe),Se("Unable to load more tags.")}finally{_.current.delete(se),((ke=L.current)==null?void 0:ke.key)===se&&(L.current=null),X(!1)}},[Ae,ze,g,R,Z,pe,$,m,w,Ye]);o.useEffect(()=>{if(!Te)return;Se(""),me("");let B=!1;return(async()=>{try{const se=await wd();if(B)return;p(Array.isArray(se==null?void 0:se.categories)?se.categories:[])}catch(se){console.error("Failed to load tag categories",se),B||p([])}})(),()=>{B=!0}},[Te]),o.useEffect(()=>{Te&&(y(r||""),v(""),k("count"),h(""),b([]),z(0),O(0),I(!1),X(!1),Se(""),me(""),Q([]))},[r,Te]),o.useEffect(()=>{if(!Te)return;const B=window.setTimeout(()=>{ye()},220);return()=>window.clearTimeout(B)},[g,Te,pe,m,ye,w]),o.useEffect(()=>()=>{var B,se,P,F;A.current&&((se=(B=A.current.controller)==null?void 0:B.abort)==null||se.call(B)),L.current&&((F=(P=L.current.controller)==null?void 0:P.abort)==null||F.call(P))},[]),o.useEffect(()=>{if(!Te||T)return;const B=W.current;if(!B||typeof IntersectionObserver>"u")return;const se=new IntersectionObserver(P=>{const F=P[0];F!=null&&F.isIntersecting&&Ee()},{threshold:.1});return se.observe(B),()=>se.disconnect()},[Te,Ee]),o.useEffect(()=>{T&&(!ze||R||Z||ie&&Ee())},[T,ze,R,Z,ie,Ee]);const Ie=o.useMemo(()=>d?null:l.jsxs("div",{className:"flex gap-2",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:t,children:"Done"}),l.jsx(K,{variant:"ghost",className:"w-full",onClick:()=>ye(),disabled:R||Z,children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(fa,{size:14}),"Refresh"]})})]}),[d,R,Z,t,ye]),We=!!(n&&(i||a||c)),Fe=Number.isFinite(u)?`${u} tags`:"",Qe=l.jsxs("div",{className:`sheet-stack ${d?"ui-card":""}`,children:[We?l.jsxs("div",{className:"tag-library-context",children:[l.jsxs("div",{className:"tag-library-context-head",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"sheet-label",children:"Adding to alias"}),l.jsx("div",{className:"tag-library-context-title",children:i||"Alias"}),a?l.jsx("div",{className:"tag-library-context-token",children:a}):null]}),l.jsx(K,{size:"xs",variant:"muted",onClick:t,children:"Back"})]}),l.jsx("div",{className:"tag-library-context-preview",children:c||""}),Fe?l.jsx("div",{className:"tag-library-context-meta",children:Fe}):null]}):null,l.jsxs("div",{className:"sheet-section",children:[d?null:l.jsx("div",{className:"sheet-label",children:"Browse"}),l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:ue,type:"search",value:m,onChange:B=>y(B.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>y(""),disabled:!m,children:"Clear"})]}),l.jsx(Je,{value:g,onChange:v,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:[{value:"",label:"Category: All"},...f.map(B=>({value:B.key,label:`${zn(B.key)} (${Number(B.actual||B.count||0).toLocaleString()})`}))]}),l.jsxs("div",{className:"composer-sort-row",children:[l.jsx(Je,{value:w,onChange:k,wrapperClassName:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]}),l.jsxs("div",{className:"composer-min-count",children:[l.jsx("span",{className:"composer-filter-divider","aria-hidden":"true",children:"|"}),l.jsx("label",{className:"composer-min-count-label",htmlFor:"tag-library-min-count",children:"Minimum count"}),l.jsx("input",{id:"tag-library-min-count",type:"number",inputMode:"numeric",min:0,step:1,value:j,onChange:B=>{const se=B.target.value;(se===""||Number(se)>=0)&&h(se)},className:"ui-control ui-input is-compact composer-min-count-input",placeholder:"0"})]})]})]}),ce?l.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:ce}):null,de?l.jsx("div",{className:"text-xs text-[#FF8F70]",children:de}):null]}),l.jsx("div",{className:"composer-alias-list tag-library-grid",role:"list",ref:He,children:R?l.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):x.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):l.jsxs(l.Fragment,{children:[T&&Pe>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${Pe}px`}}):null,ge.map(B=>l.jsx(Y1,{tag:B.tag,category:B.category,count:B.count,isCollected:Re.has(String(B.tag||"").toLowerCase()),onSelectTag:n,addToCollection:tt,removeFromCollection:ct,setStatus:me},`${B.tag}-${B.category}`)),T&&Ve>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${Ve}px`}}):null,T?null:l.jsx("div",{ref:W,className:"composer-sentinel"}),Z?l.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]});return Te?d?l.jsxs("section",{className:"tag-library-surface",children:[s?l.jsx("div",{className:"sheet-label tag-library-page-title",children:s}):null,Qe,n?null:l.jsxs("div",{className:"tag-collection-bar","aria-live":"polite",children:[l.jsxs("div",{className:"tag-collection-bar-main",children:[l.jsx("div",{className:"tag-collection-bar-title",children:"Tags"}),l.jsx("div",{className:"tag-collection-bar-count","aria-live":"polite",children:H.length===0?"No tags selected":`${H.length} selected`})]}),l.jsx(K,{size:"icon",variant:"ghost",onClick:()=>ne(!0),"aria-label":"Manage collected tags",children:l.jsx(I0,{size:16})}),l.jsx("textarea",{ref:je,value:Ne,onChange:B=>{const se=B.target.value.split(",").map(q=>q.trim()).filter(Boolean),P=new Set,F=[];se.forEach(q=>{const le=q.toLowerCase();P.has(le)||(P.add(le),F.push(q))}),Q(F)},className:"sr-only","aria-label":"Collected tags text"})]}),n?null:l.jsx(Ht,{open:oe,onClose:()=>ne(!1),title:"Collected tags",variant:"sheet",shouldCloseOnOverlayClick:!0,children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsxs("div",{className:"sheet-label",children:["Tags (",H.length,")"]}),l.jsxs("div",{className:"tag-collection-codeblock",children:[l.jsx("pre",{className:"tag-collection-pre",children:Ne||""}),l.jsx(K,{size:"icon",variant:"ghost",className:"absolute top-2 right-2",onClick:V,disabled:H.length===0,"aria-label":"Copy collected tags",children:l.jsx(T0,{size:16})}),l.jsx("textarea",{ref:je,value:Ne,readOnly:!0,className:"sr-only","aria-label":"Collected tags text"})]}),H.length?l.jsx("div",{className:"tag-collection-chips",children:H.map((B,se)=>l.jsxs("span",{className:"ui-chip is-accent is-clickable tag-collection-chip",onClick:()=>ct(B),role:"button",tabIndex:0,onKeyDown:P=>{P.target===P.currentTarget&&(P.key==="Enter"||P.key===" ")&&(P.preventDefault(),ct(B))},children:[l.jsx("code",{className:"ui-chip-code",children:B}),l.jsx(K,{size:"mini",variant:"danger","aria-label":`Remove ${B}`,onClick:P=>{P.stopPropagation(),ct(B)},children:l.jsx(Or,{size:12})})]},`${B}-${se}`))}):l.jsx("div",{className:"sheet-hint",children:"No tags collected yet."})]}),l.jsxs("div",{className:"sheet-section flex gap-2",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:()=>ne(!1),children:"Close"}),l.jsx(K,{variant:"ghost",className:"w-full",onClick:jt,disabled:H.length===0,children:"Clear"})]})]})})]}):l.jsx(Ht,{open:e,onClose:t,title:s,variant:"fullscreen",contentClassName:"tag-library-sheet",footer:Ie,shouldCloseOnOverlayClick:!1,children:Qe}):null}function X1(){const e=qn(),[t]=yg(),n=t.get("q")||"",r=o.useMemo(()=>n?`Tag Library  ${n}`:"Tag Library",[n]);return l.jsxs("div",{className:"page-shell page-stack",children:[l.jsxs("div",{className:"page-bar",children:[l.jsx("h1",{className:"page-bar-title",children:r}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx(K,{size:"xs",onClick:()=>e("/aliases"),children:"Aliases"}),l.jsx(K,{size:"xs",onClick:()=>e("/compose"),children:"Composer"})]})]}),l.jsx(q1,{inline:!0,initialQuery:n,title:"Browse",onSelectTag:null})]})}function Gp({className:e="",style:t,label:n,status:r,applyLabel:s,onClear:i,onApply:a,disabled:c=!1}){return l.jsxs("div",{className:`composer-tag-collection-bar ${e}`.trim(),style:t,children:[l.jsxs("div",{children:[l.jsx("div",{className:"composer-tag-collection-label",children:n}),r?l.jsx("div",{className:"composer-tag-collection-status",children:r}):null]}),l.jsxs("div",{className:"composer-tag-collection-actions",children:[l.jsx(K,{size:"xs",variant:"muted",onClick:i,disabled:c,children:"Clear"}),l.jsx(K,{size:"xs",variant:"primary",onClick:a,disabled:c,children:s})]})]})}const Kp={contentVisibility:"auto",containIntrinsicSize:"260px 140px"};function J1({open:e=!1,onClose:t,value:n="",onChange:r,aliasOptions:s=[],aliasCatalog:i=[],fieldLabel:a="Prompt",variant:c="sheet"}){var Pi,ml,gl;const u=o.useRef(null),d=o.useRef(null),m=o.useRef(null),y=o.useRef(null),[g,v]=o.useState(n),[w,k]=o.useState(""),j=o.useDeferredValue(w),[h,f]=o.useState("All"),[p,x]=o.useState("All"),[b,C]=o.useState(30),[z,$]=o.useState("compose"),O=c==="page",R=O||e,[I,Z]=o.useState(null),[X,de]=o.useState(null),[Se,ce]=o.useState(null),me=o.useRef(null),A=o.useRef(null),[L,D]=o.useState(!1),[_,H]=o.useState(null),Q=o.useRef(null),oe=o.useRef(null),[ne,re]=o.useState(""),[ae,Y]=o.useState(""),[U,W]=o.useState("count"),[ue,je]=o.useState(""),[_e,$e]=o.useState([]),[ze,Te]=o.useState([]),[He,Ke]=o.useState(0),[ve,Pe]=o.useState(0),[Ve,T]=o.useState(!1),[ie,ge]=o.useState(!1),[Ne,Re]=o.useState(""),pe=o.useRef(null),Ae=o.useRef(null),Ye=o.useRef(new Map),tt=o.useRef(new Map),ct=o.useMemo(()=>{const E=Number.parseInt(String(ue||""),10);return Number.isFinite(E)&&E>0?E:0},[ue]),[jt,V]=o.useState([]),[J,ye]=o.useState(""),[Ee,Ie]=o.useState([]),[We,Fe]=o.useState(""),Qe=o.useMemo(()=>{if(!g)return{text:"",parts:[]};const E=new Map;if((i||[]).forEach(Xe=>{if(!Xe)return;const Le=String(Xe.token||"").trim().toLowerCase(),Oe=typeof Xe.text=="string"?Xe.text.trim():"";!Le||!Oe||E.set(Le,Oe)}),!E.size||!g.includes("$"))return{text:g,parts:[{text:g,isAlias:!1}]};const M=[],he=/\$([a-z0-9_:-]+)\$/gi;let Ce=0,Ue;for(;(Ue=he.exec(g))!==null;){const Xe=Ue.index;Xe>Ce&&M.push({text:g.slice(Ce,Xe),isAlias:!1});const Le=String(Ue[1]||"").toLowerCase(),Oe=E.get(Le);typeof Oe=="string"?M.push({text:Oe,isAlias:!0}):M.push({text:Ue[0],isAlias:!1}),Ce=he.lastIndex}return Ce<g.length&&M.push({text:g.slice(Ce),isAlias:!1}),{text:M.map(Xe=>Xe.text).join(""),parts:M}},[i,g]);o.useEffect(()=>{e&&(v(n),$("compose"),k(""),f("All"),x("All"),C(30),Z(null),de(null),ce(null),D(!1),H(null),et(""),re(""),Y(""),W("count"),je(""),Te([]),Ke(0),Pe(0),T(!1),ge(!1),Re(""))},[e,n]),o.useEffect(()=>{if(I===null||typeof document>"u")return;const E=document.querySelector("main.app-content"),M={htmlOverscroll:document.documentElement.style.overscrollBehavior,bodyOverscroll:document.body.style.overscrollBehavior,bodyOverflow:document.body.style.overflow,scrollOverflow:E==null?void 0:E.style.overflow,scrollTouch:E==null?void 0:E.style.touchAction,scrollOverscroll:E==null?void 0:E.style.overscrollBehavior};return document.documentElement.style.overscrollBehavior="none",document.body.style.overscrollBehavior="none",document.body.style.overflow="hidden",E&&(E.style.overflow="hidden",E.style.touchAction="none",E.style.overscrollBehavior="none"),()=>{document.documentElement.style.overscrollBehavior=M.htmlOverscroll||"",document.body.style.overscrollBehavior=M.bodyOverscroll||"",document.body.style.overflow=M.bodyOverflow||"",E&&(E.style.overflow=M.scrollOverflow||"",E.style.touchAction=M.scrollTouch||"",E.style.overscrollBehavior=M.scrollOverscroll||"")}},[I]);const B=o.useMemo(()=>(Array.isArray(i)?i.filter(E=>E&&E.name):[]).map(E=>({...E,...Nd(E)})),[i]),se=o.useMemo(()=>{const E=new Map;return B.forEach(M=>{M!=null&&M.token&&E.set(String(M.token).toLowerCase(),M)}),E},[B]),P=o.useMemo(()=>{const E=new Set(["All"]);return B.forEach(M=>{M.category&&E.add(M.category)}),Array.from(E).sort((M,he)=>M.localeCompare(he))},[B]),F=o.useMemo(()=>{const E=new Set(["All"]);return B.forEach(M=>{(!h||h==="All"||M.category===h)&&M.subcategory&&E.add(M.subcategory)}),Array.from(E).sort((M,he)=>M.localeCompare(he))},[B,h]),q=o.useMemo(()=>["All",...P.filter(E=>E!=="All")],[P]),le=o.useMemo(()=>["All",...F.filter(E=>E!=="All")],[F]),ke=o.useMemo(()=>{const E=j.trim().toLowerCase();return B.filter(M=>{var he,Ce,Ue,Me;return h!=="All"&&(M.category||"")!==h||p!=="All"&&(M.subcategory||"other")!==p?!1:E?((he=M.token)==null?void 0:he.toLowerCase().includes(E))||((Ce=M.text)==null?void 0:Ce.toLowerCase().includes(E))||((Ue=M.name)==null?void 0:Ue.toLowerCase().includes(E))||((Me=M.displayName)==null?void 0:Me.toLowerCase().includes(E)):!0}).sort((M,he)=>{const Ce=(M.subcategory||"").toLowerCase(),Ue=(he.subcategory||"").toLowerCase();return Ce!==Ue?Ce.localeCompare(Ue):M.token.localeCompare(he.token)})},[B,h,p,j]),fe=o.useMemo(()=>ke.slice(0,b),[ke,b]);o.useEffect(()=>{C(30)},[h,p,w,B]),o.useEffect(()=>{x("All")},[h]),o.useEffect(()=>{const E=m.current;if(!E)return;const M=new IntersectionObserver(he=>{he[0].isIntersecting&&b<ke.length&&C(Ue=>Math.min(Ue+20,ke.length))},{threshold:.1});return M.observe(E),()=>M.disconnect()},[b,ke.length]);const we=o.useMemo(()=>typeof g!="string"?[]:$g(g),[g]);o.useEffect(()=>{if(!e||z!=="tags"||_e.length>0)return;let E=!1;return(async()=>{try{const M=await wd();if(E)return;$e(Array.isArray(M==null?void 0:M.categories)?M.categories:[])}catch(M){console.error("Failed to load tag categories",M),E||$e([])}})(),()=>{E=!0}},[e,z,_e.length]);const Be=o.useCallback((E,M,he,Ce,Ue,Me)=>[E||"",M||"",he||"",String(Ce||0),String(Ue||0),String(Me||0)].join("::"),[]),ht=o.useCallback(()=>{const E=Ye.current;if(E.size<=50)return;const M=Array.from(E.entries());M.sort((he,Ce)=>{var Ue,Me;return(((Ue=he[1])==null?void 0:Ue.ts)||0)-(((Me=Ce[1])==null?void 0:Me.ts)||0)}),M.slice(0,Math.max(0,M.length-50)).forEach(([he])=>E.delete(he))},[]),Tt=o.useCallback(async({nextQuery:E,nextCategory:M,nextSort:he,nextMinCount:Ce}={})=>{var $n;const Ue=typeof E=="string"?E:ne,Me=typeof M=="string"?M:ae,Xe=typeof he=="string"?he:U,Le=typeof Ce=="number"?Ce:ct,Oe=Be(Ue,Me,Xe,Le,80,0),Dt=Date.now(),Bt=Ye.current.get(Oe);if(Bt&&Dt-Bt.ts<5*60*1e3){Te(Bt.items||[]),Ke(Number(Bt.total||0)),Pe(0),Re(""),T(!1);return}const Yr=tt.current.get(Oe);if(Yr){try{const gt=await Yr;Te((gt==null?void 0:gt.items)||[]),Ke(Number((gt==null?void 0:gt.total)||0)),Pe(0),Re("")}catch{}return}T(!0),Re(""),Pe(0),pe.current&&pe.current.key!==Oe&&pe.current.controller.abort();const Qr=new AbortController;pe.current={controller:Qr,key:Oe};try{const gt=Js({q:Ue,category:Me,sort:Xe,minCount:Le,limit:80,offset:0},{signal:Qr.signal});tt.current.set(Oe,gt);const Ut=await gt;Ye.current.set(Oe,{items:(Ut==null?void 0:Ut.items)||[],total:Number((Ut==null?void 0:Ut.total)||0),ts:Date.now()}),ht(),Te((Ut==null?void 0:Ut.items)||[]),Ke(Number((Ut==null?void 0:Ut.total)||0))}catch(gt){if((gt==null?void 0:gt.name)==="AbortError")return;console.error("Failed to search tags",gt),Re("Unable to load tags right now."),Te([]),Ke(0)}finally{tt.current.delete(Oe),(($n=pe.current)==null?void 0:$n.key)===Oe&&(pe.current=null),T(!1)}},[Be,ae,ct,ne,U,ht]),en=o.useCallback(async()=>{var Xe;if(Ve||ie||ze.length>=He)return;const E=ve+80,M=Be(ne,ae,U,ct,80,E),he=Date.now(),Ce=Ye.current.get(M);if(Ce&&he-Ce.ts<5*60*1e3){Te(Le=>[...Le,...Ce.items||[]]),Ke(Number(Ce.total||0)),Pe(E),ge(!1);return}const Ue=tt.current.get(M);if(Ue){try{const Le=await Ue,Oe=(Le==null?void 0:Le.items)||[];Te(Dt=>[...Dt,...Oe]),Ke(Number((Le==null?void 0:Le.total)||0)),Pe(E)}catch{}return}ge(!0),Re(""),Ae.current&&Ae.current.key!==M&&Ae.current.controller.abort();const Me=new AbortController;Ae.current={controller:Me,key:M};try{const Le=Js({q:ne,category:ae,sort:U,minCount:ct,limit:80,offset:E},{signal:Me.signal});tt.current.set(M,Le);const Oe=await Le,Dt=(Oe==null?void 0:Oe.items)||[];Ye.current.set(M,{items:Dt,total:Number((Oe==null?void 0:Oe.total)||0),ts:Date.now()}),ht(),Te(Bt=>[...Bt,...Dt]),Ke(Number((Oe==null?void 0:Oe.total)||0)),Pe(E)}catch(Le){if((Le==null?void 0:Le.name)==="AbortError")return;console.error("Failed to load more tags",Le),Re("Unable to load more tags.")}finally{tt.current.delete(M),((Xe=Ae.current)==null?void 0:Xe.key)===M&&(Ae.current=null),ge(!1)}},[Be,ae,Ve,ie,ct,ve,ne,U,ze.length,He,ht]);o.useEffect(()=>{if(!e||z!=="tags")return;const E=window.setTimeout(()=>{Tt()},220);return()=>window.clearTimeout(E)},[e,z,ne,ae,U,ct,Tt]),o.useEffect(()=>()=>{var E,M,he,Ce;pe.current&&((M=(E=pe.current.controller)==null?void 0:E.abort)==null||M.call(E)),Ae.current&&((Ce=(he=Ae.current.controller)==null?void 0:he.abort)==null||Ce.call(he))},[]);const{containerRef:An,startIndex:xt,endIndex:Et,topSpacer:ol,bottomSpacer:Wr,virtualized:tn,isNearEnd:mr}=Ad({itemCount:ze.length,enabled:e&&z==="tags",estimateRowHeight:70,overscan:8,minItems:90}),xn=tn?ze.slice(xt,Et):ze;o.useEffect(()=>{if(!e||z!=="tags"||tn)return;const E=oe.current;if(!E||typeof IntersectionObserver>"u")return;const M=new IntersectionObserver(he=>{const Ce=he[0];Ce!=null&&Ce.isIntersecting&&en()},{threshold:.1});return M.observe(E),()=>M.disconnect()},[e,z,tn,en]),o.useEffect(()=>{tn&&(Ve||ie||ze.length>=He||mr&&en())},[tn,Ve,ie,ze.length,He,mr,en]);const mt=o.useCallback(E=>{v(M=>{const Ce=typeof E=="function"?E(typeof M=="string"?M:""):String(E||"");return c==="page"&&(r==null||r(Ce)),Ce})},[r,c]),gr=o.useCallback(E=>{const M=String(E||"").trim();if(M&&(mt(he=>{const Ce=he.length,Ue=he.length,Me=he.slice(0,Ce),Xe=he.slice(Ue),Le=Me.match(/[^\s]$/),Oe=Xe.match(/^[^\s]/),Dt=Le&&Le[0]!==","?", ":"",Bt=Oe&&Oe[0]!==","?", ":"";return Me+Dt+M+Bt+Xe}),u.current))try{u.current.blur()}catch{}},[mt]),[wn,et]=o.useState(""),yr=o.useCallback(()=>{const E=String(wn||"").trim();if(!E)return;const he=E.split(",").map(Ce=>Ce.trim()).filter(Boolean).join(", ");he&&(gr(he),et(""),$("compose"))},[wn,gr]),Lt=o.useCallback(()=>{V([]),ye("Cleared collected tags.")},[]),Xn=o.useCallback(()=>{if(!jt.length){ye("No tags to apply.");return}gr(jt.join(", ")),ye(`Applied ${jt.length} tag${jt.length===1?"":"s"}.`),V([]),$("compose")},[jt,gr]),un=o.useCallback(E=>{const M=String(E||"").trim();M&&V(he=>{const Ce=M.toLowerCase();return he.some(Me=>Me.toLowerCase()===Ce)?(ye(`Removed: ${M}`),he.filter(Me=>Me.toLowerCase()!==Ce)):(ye(`Selected: ${M}`),[...he,M])})},[]),dn=o.useCallback(E=>{const M=String(E||"").trim();M&&Ie(he=>{const Ce=M.toLowerCase();return he.some(Me=>Me.toLowerCase()===Ce)?(Fe(`Removed: ${M}`),he.filter(Me=>Me.toLowerCase()!==Ce)):(Fe(`Selected: ${M}`),[...he,M])})},[]),Si=o.useCallback(()=>{Ie([]),Fe("Cleared selected aliases.")},[]),it=o.useCallback(()=>{if(!Ee.length){Fe("No aliases to apply.");return}const E=Ee.map(M=>`$${M}$`).join(", ");gr(E),Fe(`Applied ${Ee.length} alias${Ee.length===1?"":"es"}.`),Ie([]),$("compose")},[Ee,gr]),kt=z==="tags"?{kind:"tag",count:jt.length,status:J,onClear:Lt,onApply:Xn}:z==="aliases"?{kind:"alias",count:Ee.length,status:We,onClear:Si,onApply:it}:null,In=(kt==null?void 0:kt.count)||0,Sn=kt?`${In} ${kt.kind==="alias"?In===1?"alias":"aliases":In===1?kt.kind:`${kt.kind}s`} selected`:"",cl=!O&&In>0,ji=O&&In>0,ul=ji?{"--composer-selection-offset":"var(--bottom-nav-height, 64px)"}:void 0,Hr=kt?{label:Sn,status:kt.status,onClear:kt.onClear,onApply:kt.onApply,applyLabel:"Insert",disabled:!In}:null,dl=cl&&Hr?l.jsx(Gp,{...Hr,className:"is-footer"}):null,ys=ji&&Hr?l.jsx(Gp,{...Hr,className:"is-floating",style:ul}):null,fl=E=>{mt(M=>Mg(M||"",E))},Gr=o.useCallback((E,M)=>{if(!(we!=null&&we.length))return;const he=E+M;he<0||he>=we.length||(mt(Ce=>yu(Ce||"",we,E,he)),ce(he))},[we,mt]),pl=E=>{if(!E)return;let M=E.text;if(E.type==="alias"){const Ce=se.get(E.text.toLowerCase());M=(Ce==null?void 0:Ce.displayName)||E.text}const he=Hl(g||"",E);H({element:E,displayName:M,weight:(he==null?void 0:he.weight)??1}),D(!0)},Jn=o.useCallback((E,M)=>{E===M||E===null||M===null||we!=null&&we.length&&mt(he=>yu(he||"",we,E,M))},[we,mt]),Tn=o.useCallback((E,M)=>{Z(M),me.current=E.target,E.dataTransfer.effectAllowed="move",E.dataTransfer.setData("text/plain",M.toString()),requestAnimationFrame(()=>{me.current&&me.current.classList.add("is-dragging")})},[]),ki=o.useCallback(()=>{me.current&&me.current.classList.remove("is-dragging"),I!==null&&X!==null&&I!==X&&Jn(I,X),Z(null),de(null),me.current=null},[I,X,Jn]),Ci=o.useCallback((E,M)=>{E.preventDefault(),E.dataTransfer.dropEffect="move",M!==X&&de(M)},[X]),Ni=o.useCallback(()=>{},[]),ko=o.useCallback((E,M)=>{var Me,Xe;if(!((Xe=(Me=E.target)==null?void 0:Me.closest)==null?void 0:Xe.call(Me,".composer-token-drag-handle")))return;const Ce=E.touches[0],Ue=window.setTimeout(()=>{A.current&&(A.current.active=!0,Z(M),de(M))},240);A.current={idx:M,startX:Ce.clientX,startY:Ce.clientY,active:!1,timer:Ue}},[]),bi=o.useCallback(E=>{if(!A.current)return;const M=E.touches[0],he=Math.abs(M.clientX-A.current.startX),Ce=Math.abs(M.clientY-A.current.startY);if(!A.current.active){(he>8||Ce>8)&&(window.clearTimeout(A.current.timer),A.current=null);return}E.preventDefault();const Ue=document.querySelectorAll(".composer-token-draggable"),Me=M.clientX,Xe=M.clientY;for(let Le=0;Le<Ue.length;Le++){const Oe=Ue[Le].getBoundingClientRect();if(Me>=Oe.left&&Me<=Oe.right&&Xe>=Oe.top&&Xe<=Oe.bottom){de(Le);break}}},[]),Co=o.useCallback(()=>{var E,M;(E=A.current)!=null&&E.timer&&window.clearTimeout(A.current.timer),(M=A.current)!=null&&M.active&&I!==null&&X!==null&&I!==X&&Jn(I,X),A.current=null,Z(null),de(null)},[I,X,Jn]),Pt=o.useCallback(()=>{var E;(E=A.current)!=null&&E.timer&&window.clearTimeout(A.current.timer),A.current=null,Z(null),de(null)},[]),hl=()=>{r==null||r(g),t==null||t()},Ei=()=>{t==null||t()};if(!R)return null;const Li=l.jsxs("div",{className:`composer-shell ${O?"ui-card":""}`,children:[l.jsx($r,{ariaLabel:"Composer tabs",value:z,onChange:$,items:[{key:"compose",label:"Compose",icon:l.jsx(yo,{size:14})},{key:"aliases",label:"Aliases",icon:l.jsx(ll,{size:14})},{key:"tags",label:"Tags",icon:l.jsx(dr,{size:14})}]}),l.jsxs("div",{className:`composer-panel composer-panel-compose ${z==="compose"?"is-visible":""}`,children:[l.jsx("div",{className:"composer-editor",children:l.jsxs("div",{className:"composer-input-row",children:[l.jsx("input",{ref:u,type:"text",value:wn,onChange:E=>et(E.target.value),onKeyDown:E=>{E.key==="Enter"&&(E.preventDefault(),yr())},className:"composer-input ui-control ui-input is-compact",placeholder:"Add prompt text","aria-label":"Add prompt text"}),l.jsx(K,{size:"icon",variant:"ghost",onClick:yr,disabled:!wn.trim(),"aria-label":"Add prompt text",children:"+"})]})}),l.jsxs("div",{className:"composer-tokens",children:[l.jsxs("div",{className:"composer-tokens-header",children:[l.jsxs("span",{className:"composer-tokens-label",children:["Elements",l.jsx("span",{className:"composer-tokens-count",children:we.length})]}),l.jsx("span",{className:"composer-tokens-hint",children:"Drag to reorder  Tap to adjust"})]}),we.length?l.jsx("div",{ref:y,className:`composer-tokens-list ${I!==null?"is-dragging":""}`,style:{"--composer-elements":we.length},children:we.map((E,M)=>{let he=E.text;if(E.type==="alias"){const Le=se.get(E.text.toLowerCase());he=(Le==null?void 0:Le.displayName)||E.text}const Ce=I===M,Ue=X===M&&I!==null&&I!==M,Me=Hl(g||"",E),Xe=(Me==null?void 0:Me.weight)??1;return l.jsxs("span",{className:`composer-token composer-token-draggable ${E.type==="alias"?"is-alias":"is-tag"} ${Ce?"is-dragging":""} ${Ue?"is-drop-target":""} ${Se===M?"is-selected":""}`,title:E.type==="alias"?`Alias: $${E.text}$`:`Tag: ${E.text}`,role:"button",tabIndex:0,draggable:!0,onDragStart:Le=>Tn(Le,M),onDragEnd:ki,onDragOver:Le=>Ci(Le,M),onDragLeave:Ni,onTouchStart:Le=>ko(Le,M),onTouchMove:bi,onTouchEnd:Co,onTouchCancel:Pt,onClick:()=>{I===null&&(ce(M),pl(E))},onKeyDown:Le=>{if(Le.target===Le.currentTarget&&(Le.key==="Enter"||Le.key===" ")){if(Le.preventDefault(),I!==null)return;ce(M),pl(E)}},children:[l.jsx("span",{className:"composer-token-order",children:M+1}),l.jsx("span",{className:"composer-token-drag-handle","aria-hidden":"true",children:l.jsx(Da,{size:10})}),l.jsx("span",{className:"composer-token-name",children:he}),E.type==="alias"&&l.jsx("span",{className:"composer-token-type",children:"$"}),Math.abs(Xe-1)>1e-6&&l.jsxs("span",{className:"composer-token-weight",children:[En(Xe),""]}),l.jsxs("div",{className:"composer-token-shift",role:"group","aria-label":"Reorder token",children:[l.jsx(K,{size:"mini",variant:"ghost",onClick:Le=>{Le.stopPropagation(),Gr(M,-1)},"aria-label":"Move up",disabled:M===0,children:""}),l.jsx(K,{size:"mini",variant:"ghost",onClick:Le=>{Le.stopPropagation(),Gr(M,1)},"aria-label":"Move down",disabled:M===we.length-1,children:""})]}),l.jsx(K,{size:"mini",variant:"danger",onClick:Le=>{Le.stopPropagation(),fl(E)},"aria-label":`Remove ${E.text}`,children:l.jsx(Or,{size:9})})]},`${E.type}-${E.text}-${E.start}`)})}):l.jsx("div",{className:"composer-empty",children:"No elements yet."})]}),l.jsxs("div",{className:"composer-expanded",children:[l.jsxs("div",{className:"composer-expanded-header",children:[l.jsx("span",{className:"composer-expanded-label",children:"Expanded prompt"}),l.jsx("span",{className:"composer-expanded-meta",children:Qe.text?`${Qe.text.length} chars`:"Empty"})]}),l.jsx("div",{className:"composer-expanded-box","aria-label":"Expanded prompt",children:Qe.text?Qe.parts.map((E,M)=>E.isAlias?l.jsx("span",{className:"composer-expanded-alias",children:E.text},`alias-${M}`):l.jsx("span",{children:E.text},`text-${M}`)):"No prompt yet."})]})]}),l.jsxs("div",{className:`composer-panel composer-panel-aliases ${z==="aliases"?"is-visible":""}`,children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:d,type:"text",value:w,onChange:E=>k(E.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>k(""),disabled:!w,children:"Clear"})]}),l.jsx(Je,{value:h,onChange:f,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:q.map(E=>({value:E,label:E==="All"?"Category: All":Gn(E)}))}),le.length>2&&l.jsx(Je,{value:p,onChange:x,wrapperClassName:"composer-subcategory-select",size:"sm",searchThreshold:0,options:le.map(E=>({value:E,label:E==="All"?"All subcategories":zn(E)}))})]}),l.jsx("div",{className:"composer-alias-list",children:ke.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):l.jsxs(l.Fragment,{children:[fe.map(E=>l.jsxs("button",{type:"button",onClick:()=>dn(E.token),className:`composer-alias-item ${Ee.some(M=>M.toLowerCase()===E.token.toLowerCase())?"is-collected":""}`,style:Kp,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:E.displayName||E.token}),E.category?l.jsx("span",{className:"composer-alias-category",children:Gn(E.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",E.token,"$"]}),l.jsx("div",{className:"composer-alias-text",children:E.text})]},E.key)),b<ke.length&&l.jsx("div",{ref:m,className:"composer-sentinel"})]})})]}),l.jsxs("div",{className:`composer-panel composer-panel-tags ${z==="tags"?"is-visible":""}`,onClick:E=>E.stopPropagation(),children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:Q,type:"search",value:ne,onChange:E=>re(E.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),l.jsx(K,{size:"xs",variant:"ghost",onClick:()=>re(""),disabled:!ne,children:"Clear"})]}),l.jsx(Je,{value:ae,onChange:Y,wrapperClassName:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",searchThreshold:0,options:[{value:"",label:"Category: All"},..._e.map(E=>({value:E.key,label:`${zn(E.key)} (${Number(E.actual||E.count||0).toLocaleString()})`}))]}),l.jsxs("div",{className:"composer-sort-row",children:[l.jsx(Je,{value:U,onChange:W,wrapperClassName:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]}),l.jsxs("div",{className:"composer-min-count",children:[l.jsx("span",{className:"composer-filter-divider","aria-hidden":"true",children:"|"}),l.jsx("label",{className:"composer-min-count-label",htmlFor:"composer-min-count",children:"Minimum count"}),l.jsx("input",{id:"composer-min-count",type:"number",inputMode:"numeric",min:0,step:1,value:ue,onChange:E=>{const M=E.target.value;(M===""||Number(M)>=0)&&je(M)},className:"ui-control ui-input is-compact composer-min-count-input",placeholder:"0"})]})]})]}),Ne?l.jsx("div",{className:"composer-tags-error",children:Ne}):null,l.jsx("div",{className:"composer-alias-list composer-tags-grid",role:"list",ref:An,children:Ve?l.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):ze.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):l.jsxs(l.Fragment,{children:[tn&&ol>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${ol}px`}}):null,xn.map(E=>l.jsx(ly,{tag:E.tag,category:E.category,count:E.count,isCollected:jt.some(M=>M.toLowerCase()===String(E.tag||"").toLowerCase()),onToggle:un,visibilityStyle:Kp},`${E.tag}-${E.category}`)),tn&&Wr>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${Wr}px`}}):null,ze.length<He&&!tn?l.jsx("div",{ref:oe,className:"composer-sentinel"}):null,ie?l.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]})]}),Kr=l.jsx(Va,{open:L,onClose:()=>D(!1),title:((Pi=_==null?void 0:_.element)==null?void 0:Pi.type)==="alias"?"Alias strength":"Tag strength",tokenLabel:_?((ml=_.element)==null?void 0:ml.type)==="alias"?`${_.displayName}  $${(gl=_.element)==null?void 0:gl.text}$`:_.displayName:"",weight:(_==null?void 0:_.weight)??1,onApply:E=>{_!=null&&_.element&&mt(M=>gu(M||"",_.element,E))},onRemoveWeight:()=>{_!=null&&_.element&&mt(E=>gu(E||"",_.element,null))},onDeleteToken:()=>{_!=null&&_.element&&fl(_.element)}}),No=l.jsx("div",{className:"page-bar composer-bar",children:l.jsx("h1",{className:"page-bar-title",children:a||"Prompt"})});return O?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"page-shell page-stack",children:[No,Li]}),ys,Kr]}):l.jsxs(l.Fragment,{children:[l.jsx(Ht,{open:e,onClose:Ei,title:"Composer",variant:"fullscreen",shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,footer:l.jsxs("div",{className:"composer-footer-stack",children:[dl,l.jsxs("div",{className:"flex gap-2",children:[l.jsx(K,{variant:"muted",className:"w-full",onClick:Ei,children:"Cancel"}),l.jsx(K,{variant:"primary",className:"w-full",onClick:hl,children:"Apply"})]})]}),children:Li}),Kr]})}function Z1(){const e=qn(),[t]=yg(),{formData:n,handleFormChange:r,aliasOptions:s,aliasCatalog:i,promptFieldName:a,handleGenerate:c,workflowData:u,selectedWorkflow:d,isLoading:m}=zd(),g=t.get("field")||a||"prompt",v=(n==null?void 0:n[g])||"";return o.useEffect(()=>{if(!(typeof document>"u"))return document.body.classList.add("no-pull-refresh"),document.documentElement.classList.add("no-pull-refresh"),()=>{document.body.classList.remove("no-pull-refresh"),document.documentElement.classList.remove("no-pull-refresh")}},[]),o.useEffect(()=>{const w=()=>{!u||!d||m||c()};return window.addEventListener("cozygen:request-render",w),()=>window.removeEventListener("cozygen:request-render",w)},[c,m,d,u]),l.jsx(J1,{open:!0,onClose:()=>e("/controls"),value:v,onChange:w=>r(g,w),aliasOptions:s,aliasCatalog:i,fieldLabel:g,variant:"page"})}function ej(){var h,f;const{authed:e,ready:t,login:n}=go(),r=qn(),i=((f=(h=cn().state)==null?void 0:h.from)==null?void 0:f.pathname)||"/studio",[a,c]=o.useState(""),[u,d]=o.useState(""),[m,y]=o.useState(""),[g,v]=o.useState(!1),[w,k]=o.useState(!1);o.useEffect(()=>{try{localStorage.getItem("cozygen_idle_logout")&&(k(!0),localStorage.removeItem("cozygen_idle_logout"))}catch{}},[]),o.useEffect(()=>{t&&e&&r(i,{replace:!0})},[t,e,i,r]);const j=async p=>{p.preventDefault(),y(""),v(!0);try{await n(a,u),r(i,{replace:!0})}catch(x){x!=null&&x.unauthorized?y("Invalid username or password."):y("Unable to sign in. Please try again.")}finally{v(!1)}};return l.jsx("div",{className:"login-shell",children:l.jsxs("div",{className:"ui-card w-full max-w-[420px] p-6 sm:p-7",children:[l.jsxs("div",{className:"login-brand",children:[l.jsx(Lg,{size:34}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"login-title",children:"Sign in"}),l.jsx("div",{className:"login-subtitle",children:"Continue to CozyGen Studio"})]})]}),l.jsxs("form",{className:"login-form",onSubmit:j,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"login-username",className:"login-label",children:"Username"}),l.jsx("input",{id:"login-username",type:"text",className:"ui-control ui-input",value:a,onChange:p=>c(p.target.value),autoComplete:"username",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"login-password",className:"login-label",children:"Password"}),l.jsx("input",{id:"login-password",type:"password",className:"ui-control ui-input",value:u,onChange:p=>d(p.target.value),autoComplete:"current-password",required:!0})]}),m?l.jsx("div",{className:"ui-alert",children:m}):w?l.jsx("div",{className:"ui-alert is-warn",children:"You were signed out due to inactivity. Please sign in again."}):null,l.jsx(K,{type:"submit",disabled:g,variant:"primary",className:"w-full",children:g?"Signing in":"Sign in"})]}),l.jsxs("p",{className:"login-footnote",children:["Access is protected by CozyGen auth. Set ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /"," ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server to enable."]})]})})}function tj({containerRef:e}){const{pathname:t,hash:n}=cn();return o.useEffect(()=>{if(n)return;const r=e==null?void 0:e.current;if(r&&typeof r.scrollTo=="function"){r.scrollTo({top:0,left:0,behavior:"auto"});return}typeof window<"u"&&window.scrollTo(0,0)},[t,n,e]),null}function nj({children:e}){const{authed:t,ready:n}=go(),r=cn();return n?t?e:l.jsx(lu,{to:"/login",state:{from:r},replace:!0}):l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-200",children:l.jsxs("div",{className:"page-loading",children:[l.jsx("span",{className:"loading-spinner lg","aria-hidden":"true"}),l.jsx("span",{className:"sr-only",children:"Checking session"})]})})}function rj(){const{pathname:e}=cn(),t=qn(),{defaultCreds:n,authed:r}=go(),s=e==="/login",i=o.useRef(null),a=!s,c=a;return o.useEffect(()=>{if(!r)return;const u=d=>{var g;const m=String(((g=d==null?void 0:d.detail)==null?void 0:g.fieldName)||"").trim(),y=m?`?field=${encodeURIComponent(m)}`:"";t(`/compose${y}`)};return window.addEventListener("cozygen:open-composer",u),()=>window.removeEventListener("cozygen:open-composer",u)},[r,t]),l.jsxs("div",{className:"app-shell",children:[!s&&l.jsx(M0,{isMobileAlignedNav:a}),!s&&r&&n&&l.jsxs("div",{className:"flex-shrink-0 bg-amber-500/10 text-amber-200 border-b border-amber-400/50 px-4 py-2 text-sm text-center",children:["Default CozyGen credentials are still in use. Change ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server."]}),l.jsx(tj,{containerRef:i}),l.jsxs("div",{className:"app-body",children:[l.jsx("main",{ref:i,className:s?"app-content is-login":"app-content",children:l.jsxs(e0,{children:[l.jsx(kn,{path:"/login",element:l.jsx(ej,{})}),l.jsxs(kn,{element:l.jsx(nj,{children:l.jsx(s1,{children:l.jsx(Jw,{})})}),children:[l.jsx(kn,{path:"/",element:l.jsx(lu,{to:"/studio",replace:!0})}),l.jsx(kn,{path:"/studio",element:l.jsx(i1,{})}),l.jsx(kn,{path:"/controls",element:l.jsx(l1,{})}),l.jsx(kn,{path:"/compose",element:l.jsx(Z1,{})}),l.jsx(kn,{path:"/gallery",element:l.jsx(F1,{})}),l.jsx(kn,{path:"/aliases",element:l.jsx(G1,{})}),l.jsx(kn,{path:"/tags",element:l.jsx(X1,{})})]}),l.jsx(kn,{path:"*",element:l.jsx(lu,{to:"/studio",replace:!0})})]})}),c?l.jsx(D0,{}):null]})]})}function sj(){return l.jsx(c0,{children:l.jsx(z0,{children:l.jsx(rj,{})})})}uc.createRoot(document.getElementById("root")).render(l.jsx(fn.StrictMode,{children:l.jsx(sj,{})}));
