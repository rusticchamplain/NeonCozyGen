function rg(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const l=Object.getOwnPropertyDescriptor(r,s);l&&Object.defineProperty(e,s,l.get?l:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}})();function sg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zf={exports:{}},Go={},Af={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yl=Symbol.for("react.element"),lg=Symbol.for("react.portal"),og=Symbol.for("react.fragment"),ig=Symbol.for("react.strict_mode"),ag=Symbol.for("react.profiler"),cg=Symbol.for("react.provider"),ug=Symbol.for("react.context"),dg=Symbol.for("react.forward_ref"),fg=Symbol.for("react.suspense"),pg=Symbol.for("react.memo"),hg=Symbol.for("react.lazy"),zu=Symbol.iterator;function mg(e){return e===null||typeof e!="object"?null:(e=zu&&e[zu]||e["@@iterator"],typeof e=="function"?e:null)}var Tf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Mf=Object.assign,$f={};function ms(e,t,n){this.props=e,this.context=t,this.refs=$f,this.updater=n||Tf}ms.prototype.isReactComponent={};ms.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ms.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ff(){}Ff.prototype=ms.prototype;function dc(e,t,n){this.props=e,this.context=t,this.refs=$f,this.updater=n||Tf}var fc=dc.prototype=new Ff;fc.constructor=dc;Mf(fc,ms.prototype);fc.isPureReactComponent=!0;var Au=Array.isArray,Of=Object.prototype.hasOwnProperty,pc={current:null},Df={key:!0,ref:!0,__self:!0,__source:!0};function Bf(e,t,n){var r,s={},l=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(l=""+t.key),t)Of.call(t,r)&&!Df.hasOwnProperty(r)&&(s[r]=t[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:yl,type:e,key:l,ref:i,props:s,_owner:pc.current}}function gg(e,t){return{$$typeof:yl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function hc(e){return typeof e=="object"&&e!==null&&e.$$typeof===yl}function yg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Tu=/\/+/g;function xi(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yg(""+e.key):t.toString(36)}function Xl(e,t,n,r,s){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(l){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case yl:case lg:i=!0}}if(i)return i=e,s=s(i),e=r===""?"."+xi(i,0):r,Au(s)?(n="",e!=null&&(n=e.replace(Tu,"$&/")+"/"),Xl(s,t,n,"",function(d){return d})):s!=null&&(hc(s)&&(s=gg(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Tu,"$&/")+"/")+e)),t.push(s)),1;if(i=0,r=r===""?".":r+":",Au(e))for(var c=0;c<e.length;c++){l=e[c];var u=r+xi(l,c);i+=Xl(l,t,n,u,s)}else if(u=mg(e),typeof u=="function")for(e=u.call(e),c=0;!(l=e.next()).done;)l=l.value,u=r+xi(l,c++),i+=Xl(l,t,n,u,s);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Pl(e,t,n){if(e==null)return e;var r=[],s=0;return Xl(e,r,"","",function(l){return t.call(n,l,s++)}),r}function vg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Lt={current:null},Jl={transition:null},xg={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:Jl,ReactCurrentOwner:pc};function Uf(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:Pl,forEach:function(e,t,n){Pl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Pl(e,function(){t++}),t},toArray:function(e){return Pl(e,function(t){return t})||[]},only:function(e){if(!hc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};$e.Component=ms;$e.Fragment=og;$e.Profiler=ag;$e.PureComponent=dc;$e.StrictMode=ig;$e.Suspense=fg;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xg;$e.act=Uf;$e.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Mf({},e.props),s=e.key,l=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,i=pc.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)Of.call(t,u)&&!Df.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:yl,type:e.type,key:s,ref:l,props:r,_owner:i}};$e.createContext=function(e){return e={$$typeof:ug,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:cg,_context:e},e.Consumer=e};$e.createElement=Bf;$e.createFactory=function(e){var t=Bf.bind(null,e);return t.type=e,t};$e.createRef=function(){return{current:null}};$e.forwardRef=function(e){return{$$typeof:dg,render:e}};$e.isValidElement=hc;$e.lazy=function(e){return{$$typeof:hg,_payload:{_status:-1,_result:e},_init:vg}};$e.memo=function(e,t){return{$$typeof:pg,type:e,compare:t===void 0?null:t}};$e.startTransition=function(e){var t=Jl.transition;Jl.transition={};try{e()}finally{Jl.transition=t}};$e.unstable_act=Uf;$e.useCallback=function(e,t){return Lt.current.useCallback(e,t)};$e.useContext=function(e){return Lt.current.useContext(e)};$e.useDebugValue=function(){};$e.useDeferredValue=function(e){return Lt.current.useDeferredValue(e)};$e.useEffect=function(e,t){return Lt.current.useEffect(e,t)};$e.useId=function(){return Lt.current.useId()};$e.useImperativeHandle=function(e,t,n){return Lt.current.useImperativeHandle(e,t,n)};$e.useInsertionEffect=function(e,t){return Lt.current.useInsertionEffect(e,t)};$e.useLayoutEffect=function(e,t){return Lt.current.useLayoutEffect(e,t)};$e.useMemo=function(e,t){return Lt.current.useMemo(e,t)};$e.useReducer=function(e,t,n){return Lt.current.useReducer(e,t,n)};$e.useRef=function(e){return Lt.current.useRef(e)};$e.useState=function(e){return Lt.current.useState(e)};$e.useSyncExternalStore=function(e,t,n){return Lt.current.useSyncExternalStore(e,t,n)};$e.useTransition=function(){return Lt.current.useTransition()};$e.version="18.3.1";Af.exports=$e;var a=Af.exports;const Qt=sg(a),wg=rg({__proto__:null,default:Qt},[a]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sg=a,jg=Symbol.for("react.element"),Ng=Symbol.for("react.fragment"),kg=Object.prototype.hasOwnProperty,Cg=Sg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bg={key:!0,ref:!0,__self:!0,__source:!0};function Vf(e,t,n){var r,s={},l=null,i=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)kg.call(t,r)&&!bg.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:jg,type:e,key:l,ref:i,props:s,_owner:Cg.current}}Go.Fragment=Ng;Go.jsx=Vf;Go.jsxs=Vf;zf.exports=Go;var o=zf.exports,Zi={},Wf={exports:{}},Ut={},Hf={exports:{}},Gf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,C){var L=P.length;P.push(C);e:for(;0<L;){var E=L-1>>>1,V=P[E];if(0<s(V,C))P[E]=C,P[L]=V,L=E;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var C=P[0],L=P.pop();if(L!==C){P[0]=L;e:for(var E=0,V=P.length,Y=V>>>1;E<Y;){var se=2*(E+1)-1,re=P[se],X=se+1,ie=P[X];if(0>s(re,L))X<V&&0>s(ie,re)?(P[E]=ie,P[X]=L,E=X):(P[E]=re,P[se]=L,E=se);else if(X<V&&0>s(ie,L))P[E]=ie,P[X]=L,E=X;else break e}}return C}function s(P,C){var L=P.sortIndex-C.sortIndex;return L!==0?L:P.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var i=Date,c=i.now();e.unstable_now=function(){return i.now()-c}}var u=[],d=[],m=1,y=null,g=3,x=!1,w=!1,j=!1,S=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(P){for(var C=n(d);C!==null;){if(C.callback===null)r(d);else if(C.startTime<=P)r(d),C.sortIndex=C.expirationTime,t(u,C);else break;C=n(d)}}function v(P){if(j=!1,p(P),!w)if(n(u)!==null)w=!0,Q(k);else{var C=n(d);C!==null&&ce(v,C.startTime-P)}}function k(P,C){w=!1,j&&(j=!1,h(I),I=-1),x=!0;var L=g;try{for(p(C),y=n(u);y!==null&&(!(y.expirationTime>C)||P&&!O());){var E=y.callback;if(typeof E=="function"){y.callback=null,g=y.priorityLevel;var V=E(y.expirationTime<=C);C=e.unstable_now(),typeof V=="function"?y.callback=V:y===n(u)&&r(u),p(C)}else r(u);y=n(u)}if(y!==null)var Y=!0;else{var se=n(d);se!==null&&ce(v,se.startTime-C),Y=!1}return Y}finally{y=null,g=L,x=!1}}var N=!1,_=null,I=-1,z=5,T=-1;function O(){return!(e.unstable_now()-T<z)}function ae(){if(_!==null){var P=e.unstable_now();T=P;var C=!0;try{C=_(!0,P)}finally{C?q():(N=!1,_=null)}}else N=!1}var q;if(typeof f=="function")q=function(){f(ae)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,ve=Se.port2;Se.port1.onmessage=ae,q=function(){ve.postMessage(null)}}else q=function(){S(ae,0)};function Q(P){_=P,N||(N=!0,q())}function ce(P,C){I=S(function(){P(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){w||x||(w=!0,Q(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(P){switch(g){case 1:case 2:case 3:var C=3;break;default:C=g}var L=g;g=C;try{return P()}finally{g=L}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,C){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var L=g;g=P;try{return C()}finally{g=L}},e.unstable_scheduleCallback=function(P,C,L){var E=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?E+L:E):L=E,P){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=L+V,P={id:m++,callback:C,priorityLevel:P,startTime:L,expirationTime:V,sortIndex:-1},L>E?(P.sortIndex=L,t(d,P),n(u)===null&&P===n(d)&&(j?(h(I),I=-1):j=!0,ce(v,L-E))):(P.sortIndex=V,t(u,P),w||x||(w=!0,Q(k))),P},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(P){var C=g;return function(){var L=g;g=C;try{return P.apply(this,arguments)}finally{g=L}}}})(Gf);Hf.exports=Gf;var Eg=Hf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lg=a,Bt=Eg;function Z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kf=new Set,qs={};function Ir(e,t){os(e,t),os(e+"Capture",t)}function os(e,t){for(qs[e]=t,e=0;e<t.length;e++)Kf.add(t[e])}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ea=Object.prototype.hasOwnProperty,Pg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mu={},$u={};function _g(e){return ea.call($u,e)?!0:ea.call(Mu,e)?!1:Pg.test(e)?$u[e]=!0:(Mu[e]=!0,!1)}function Rg(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ig(e,t,n,r){if(t===null||typeof t>"u"||Rg(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Pt(e,t,n,r,s,l,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=i}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){wt[e]=new Pt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];wt[t]=new Pt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){wt[e]=new Pt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){wt[e]=new Pt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){wt[e]=new Pt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){wt[e]=new Pt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){wt[e]=new Pt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){wt[e]=new Pt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){wt[e]=new Pt(e,5,!1,e.toLowerCase(),null,!1,!1)});var mc=/[\-:]([a-z])/g;function gc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(mc,gc);wt[t]=new Pt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(mc,gc);wt[t]=new Pt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(mc,gc);wt[t]=new Pt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){wt[e]=new Pt(e,1,!1,e.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Pt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){wt[e]=new Pt(e,1,!1,e.toLowerCase(),null,!0,!0)});function yc(e,t,n,r){var s=wt.hasOwnProperty(t)?wt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ig(t,n,s,r)&&(n=null),r||s===null?_g(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Dn=Lg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_l=Symbol.for("react.element"),Br=Symbol.for("react.portal"),Ur=Symbol.for("react.fragment"),vc=Symbol.for("react.strict_mode"),ta=Symbol.for("react.profiler"),Qf=Symbol.for("react.provider"),Yf=Symbol.for("react.context"),xc=Symbol.for("react.forward_ref"),na=Symbol.for("react.suspense"),ra=Symbol.for("react.suspense_list"),wc=Symbol.for("react.memo"),Gn=Symbol.for("react.lazy"),qf=Symbol.for("react.offscreen"),Fu=Symbol.iterator;function ks(e){return e===null||typeof e!="object"?null:(e=Fu&&e[Fu]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Object.assign,wi;function zs(e){if(wi===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);wi=t&&t[1]||""}return`
`+wi+e}var Si=!1;function ji(e,t){if(!e||Si)return"";Si=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),l=r.stack.split(`
`),i=s.length-1,c=l.length-1;1<=i&&0<=c&&s[i]!==l[c];)c--;for(;1<=i&&0<=c;i--,c--)if(s[i]!==l[c]){if(i!==1||c!==1)do if(i--,c--,0>c||s[i]!==l[c]){var u=`
`+s[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=i&&0<=c);break}}}finally{Si=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?zs(e):""}function zg(e){switch(e.tag){case 5:return zs(e.type);case 16:return zs("Lazy");case 13:return zs("Suspense");case 19:return zs("SuspenseList");case 0:case 2:case 15:return e=ji(e.type,!1),e;case 11:return e=ji(e.type.render,!1),e;case 1:return e=ji(e.type,!0),e;default:return""}}function sa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ur:return"Fragment";case Br:return"Portal";case ta:return"Profiler";case vc:return"StrictMode";case na:return"Suspense";case ra:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Yf:return(e.displayName||"Context")+".Consumer";case Qf:return(e._context.displayName||"Context")+".Provider";case xc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case wc:return t=e.displayName||null,t!==null?t:sa(e.type)||"Memo";case Gn:t=e._payload,e=e._init;try{return sa(e(t))}catch{}}return null}function Ag(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sa(t);case 8:return t===vc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ar(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Xf(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Tg(e){var t=Xf(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,l.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Rl(e){e._valueTracker||(e._valueTracker=Tg(e))}function Jf(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Xf(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function uo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function la(e,t){var n=t.checked;return ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Ou(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ar(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Zf(e,t){t=t.checked,t!=null&&yc(e,"checked",t,!1)}function oa(e,t){Zf(e,t);var n=ar(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ia(e,t.type,n):t.hasOwnProperty("defaultValue")&&ia(e,t.type,ar(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Du(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function ia(e,t,n){(t!=="number"||uo(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var As=Array.isArray;function Zr(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ar(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function aa(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Z(91));return ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Bu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Z(92));if(As(n)){if(1<n.length)throw Error(Z(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ar(n)}}function ep(e,t){var n=ar(t.value),r=ar(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Uu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function tp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ca(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?tp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Il,np=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Il=Il||document.createElement("div"),Il.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Il.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Xs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Os={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mg=["Webkit","ms","Moz","O"];Object.keys(Os).forEach(function(e){Mg.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Os[t]=Os[e]})});function rp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Os.hasOwnProperty(e)&&Os[e]?(""+t).trim():t+"px"}function sp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=rp(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var $g=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ua(e,t){if(t){if($g[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Z(62))}}function da(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fa=null;function Sc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var pa=null,es=null,ts=null;function Vu(e){if(e=wl(e)){if(typeof pa!="function")throw Error(Z(280));var t=e.stateNode;t&&(t=Xo(t),pa(e.stateNode,e.type,t))}}function lp(e){es?ts?ts.push(e):ts=[e]:es=e}function op(){if(es){var e=es,t=ts;if(ts=es=null,Vu(e),t)for(e=0;e<t.length;e++)Vu(t[e])}}function ip(e,t){return e(t)}function ap(){}var Ni=!1;function cp(e,t,n){if(Ni)return e(t,n);Ni=!0;try{return ip(e,t,n)}finally{Ni=!1,(es!==null||ts!==null)&&(ap(),op())}}function Js(e,t){var n=e.stateNode;if(n===null)return null;var r=Xo(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Z(231,t,typeof n));return n}var ha=!1;if(Mn)try{var Cs={};Object.defineProperty(Cs,"passive",{get:function(){ha=!0}}),window.addEventListener("test",Cs,Cs),window.removeEventListener("test",Cs,Cs)}catch{ha=!1}function Fg(e,t,n,r,s,l,i,c,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(m){this.onError(m)}}var Ds=!1,fo=null,po=!1,ma=null,Og={onError:function(e){Ds=!0,fo=e}};function Dg(e,t,n,r,s,l,i,c,u){Ds=!1,fo=null,Fg.apply(Og,arguments)}function Bg(e,t,n,r,s,l,i,c,u){if(Dg.apply(this,arguments),Ds){if(Ds){var d=fo;Ds=!1,fo=null}else throw Error(Z(198));po||(po=!0,ma=d)}}function zr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function up(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wu(e){if(zr(e)!==e)throw Error(Z(188))}function Ug(e){var t=e.alternate;if(!t){if(t=zr(e),t===null)throw Error(Z(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var l=s.alternate;if(l===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===l.child){for(l=s.child;l;){if(l===n)return Wu(s),e;if(l===r)return Wu(s),t;l=l.sibling}throw Error(Z(188))}if(n.return!==r.return)n=s,r=l;else{for(var i=!1,c=s.child;c;){if(c===n){i=!0,n=s,r=l;break}if(c===r){i=!0,r=s,n=l;break}c=c.sibling}if(!i){for(c=l.child;c;){if(c===n){i=!0,n=l,r=s;break}if(c===r){i=!0,r=l,n=s;break}c=c.sibling}if(!i)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?e:t}function dp(e){return e=Ug(e),e!==null?fp(e):null}function fp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=fp(e);if(t!==null)return t;e=e.sibling}return null}var pp=Bt.unstable_scheduleCallback,Hu=Bt.unstable_cancelCallback,Vg=Bt.unstable_shouldYield,Wg=Bt.unstable_requestPaint,ut=Bt.unstable_now,Hg=Bt.unstable_getCurrentPriorityLevel,jc=Bt.unstable_ImmediatePriority,hp=Bt.unstable_UserBlockingPriority,ho=Bt.unstable_NormalPriority,Gg=Bt.unstable_LowPriority,mp=Bt.unstable_IdlePriority,Ko=null,Sn=null;function Kg(e){if(Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(Ko,e,void 0,(e.current.flags&128)===128)}catch{}}var an=Math.clz32?Math.clz32:qg,Qg=Math.log,Yg=Math.LN2;function qg(e){return e>>>=0,e===0?32:31-(Qg(e)/Yg|0)|0}var zl=64,Al=4194304;function Ts(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mo(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,l=e.pingedLanes,i=n&268435455;if(i!==0){var c=i&~s;c!==0?r=Ts(c):(l&=i,l!==0&&(r=Ts(l)))}else i=n&~s,i!==0?r=Ts(i):l!==0&&(r=Ts(l));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,l=t&-t,s>=l||s===16&&(l&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-an(t),s=1<<n,r|=e[n],t&=~s;return r}function Xg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,l=e.pendingLanes;0<l;){var i=31-an(l),c=1<<i,u=s[i];u===-1?(!(c&n)||c&r)&&(s[i]=Xg(c,t)):u<=t&&(e.expiredLanes|=c),l&=~c}}function ga(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gp(){var e=zl;return zl<<=1,!(zl&4194240)&&(zl=64),e}function ki(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-an(t),e[t]=n}function Zg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-an(n),l=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~l}}function Nc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-an(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Qe=0;function yp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vp,kc,xp,wp,Sp,ya=!1,Tl=[],Zn=null,er=null,tr=null,Zs=new Map,el=new Map,Qn=[],ey="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gu(e,t){switch(e){case"focusin":case"focusout":Zn=null;break;case"dragenter":case"dragleave":er=null;break;case"mouseover":case"mouseout":tr=null;break;case"pointerover":case"pointerout":Zs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":el.delete(t.pointerId)}}function bs(e,t,n,r,s,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[s]},t!==null&&(t=wl(t),t!==null&&kc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function ty(e,t,n,r,s){switch(t){case"focusin":return Zn=bs(Zn,e,t,n,r,s),!0;case"dragenter":return er=bs(er,e,t,n,r,s),!0;case"mouseover":return tr=bs(tr,e,t,n,r,s),!0;case"pointerover":var l=s.pointerId;return Zs.set(l,bs(Zs.get(l)||null,e,t,n,r,s)),!0;case"gotpointercapture":return l=s.pointerId,el.set(l,bs(el.get(l)||null,e,t,n,r,s)),!0}return!1}function jp(e){var t=Sr(e.target);if(t!==null){var n=zr(t);if(n!==null){if(t=n.tag,t===13){if(t=up(n),t!==null){e.blockedOn=t,Sp(e.priority,function(){xp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Zl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=va(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);fa=r,n.target.dispatchEvent(r),fa=null}else return t=wl(n),t!==null&&kc(t),e.blockedOn=n,!1;t.shift()}return!0}function Ku(e,t,n){Zl(e)&&n.delete(t)}function ny(){ya=!1,Zn!==null&&Zl(Zn)&&(Zn=null),er!==null&&Zl(er)&&(er=null),tr!==null&&Zl(tr)&&(tr=null),Zs.forEach(Ku),el.forEach(Ku)}function Es(e,t){e.blockedOn===t&&(e.blockedOn=null,ya||(ya=!0,Bt.unstable_scheduleCallback(Bt.unstable_NormalPriority,ny)))}function tl(e){function t(s){return Es(s,e)}if(0<Tl.length){Es(Tl[0],e);for(var n=1;n<Tl.length;n++){var r=Tl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Zn!==null&&Es(Zn,e),er!==null&&Es(er,e),tr!==null&&Es(tr,e),Zs.forEach(t),el.forEach(t),n=0;n<Qn.length;n++)r=Qn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Qn.length&&(n=Qn[0],n.blockedOn===null);)jp(n),n.blockedOn===null&&Qn.shift()}var ns=Dn.ReactCurrentBatchConfig,go=!0;function ry(e,t,n,r){var s=Qe,l=ns.transition;ns.transition=null;try{Qe=1,Cc(e,t,n,r)}finally{Qe=s,ns.transition=l}}function sy(e,t,n,r){var s=Qe,l=ns.transition;ns.transition=null;try{Qe=4,Cc(e,t,n,r)}finally{Qe=s,ns.transition=l}}function Cc(e,t,n,r){if(go){var s=va(e,t,n,r);if(s===null)Ai(e,t,r,yo,n),Gu(e,r);else if(ty(s,e,t,n,r))r.stopPropagation();else if(Gu(e,r),t&4&&-1<ey.indexOf(e)){for(;s!==null;){var l=wl(s);if(l!==null&&vp(l),l=va(e,t,n,r),l===null&&Ai(e,t,r,yo,n),l===s)break;s=l}s!==null&&r.stopPropagation()}else Ai(e,t,r,null,n)}}var yo=null;function va(e,t,n,r){if(yo=null,e=Sc(r),e=Sr(e),e!==null)if(t=zr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=up(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return yo=e,null}function Np(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hg()){case jc:return 1;case hp:return 4;case ho:case Gg:return 16;case mp:return 536870912;default:return 16}default:return 16}}var qn=null,bc=null,eo=null;function kp(){if(eo)return eo;var e,t=bc,n=t.length,r,s="value"in qn?qn.value:qn.textContent,l=s.length;for(e=0;e<n&&t[e]===s[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===s[l-r];r++);return eo=s.slice(e,1<r?1-r:void 0)}function to(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ml(){return!0}function Qu(){return!1}function Vt(e){function t(n,r,s,l,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=l,this.target=i,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(l):l[c]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Ml:Qu,this.isPropagationStopped=Qu,this}return ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ml)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ml)},persist:function(){},isPersistent:Ml}),t}var gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ec=Vt(gs),xl=ot({},gs,{view:0,detail:0}),ly=Vt(xl),Ci,bi,Ls,Qo=ot({},xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ls&&(Ls&&e.type==="mousemove"?(Ci=e.screenX-Ls.screenX,bi=e.screenY-Ls.screenY):bi=Ci=0,Ls=e),Ci)},movementY:function(e){return"movementY"in e?e.movementY:bi}}),Yu=Vt(Qo),oy=ot({},Qo,{dataTransfer:0}),iy=Vt(oy),ay=ot({},xl,{relatedTarget:0}),Ei=Vt(ay),cy=ot({},gs,{animationName:0,elapsedTime:0,pseudoElement:0}),uy=Vt(cy),dy=ot({},gs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fy=Vt(dy),py=ot({},gs,{data:0}),qu=Vt(py),hy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},my={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gy[e])?!!t[e]:!1}function Lc(){return yy}var vy=ot({},xl,{key:function(e){if(e.key){var t=hy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=to(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?my[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lc,charCode:function(e){return e.type==="keypress"?to(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?to(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),xy=Vt(vy),wy=ot({},Qo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xu=Vt(wy),Sy=ot({},xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lc}),jy=Vt(Sy),Ny=ot({},gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),ky=Vt(Ny),Cy=ot({},Qo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),by=Vt(Cy),Ey=[9,13,27,32],Pc=Mn&&"CompositionEvent"in window,Bs=null;Mn&&"documentMode"in document&&(Bs=document.documentMode);var Ly=Mn&&"TextEvent"in window&&!Bs,Cp=Mn&&(!Pc||Bs&&8<Bs&&11>=Bs),Ju=" ",Zu=!1;function bp(e,t){switch(e){case"keyup":return Ey.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ep(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vr=!1;function Py(e,t){switch(e){case"compositionend":return Ep(t);case"keypress":return t.which!==32?null:(Zu=!0,Ju);case"textInput":return e=t.data,e===Ju&&Zu?null:e;default:return null}}function _y(e,t){if(Vr)return e==="compositionend"||!Pc&&bp(e,t)?(e=kp(),eo=bc=qn=null,Vr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cp&&t.locale!=="ko"?null:t.data;default:return null}}var Ry={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ed(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ry[e.type]:t==="textarea"}function Lp(e,t,n,r){lp(r),t=vo(t,"onChange"),0<t.length&&(n=new Ec("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Us=null,nl=null;function Iy(e){Op(e,0)}function Yo(e){var t=Gr(e);if(Jf(t))return e}function zy(e,t){if(e==="change")return t}var Pp=!1;if(Mn){var Li;if(Mn){var Pi="oninput"in document;if(!Pi){var td=document.createElement("div");td.setAttribute("oninput","return;"),Pi=typeof td.oninput=="function"}Li=Pi}else Li=!1;Pp=Li&&(!document.documentMode||9<document.documentMode)}function nd(){Us&&(Us.detachEvent("onpropertychange",_p),nl=Us=null)}function _p(e){if(e.propertyName==="value"&&Yo(nl)){var t=[];Lp(t,nl,e,Sc(e)),cp(Iy,t)}}function Ay(e,t,n){e==="focusin"?(nd(),Us=t,nl=n,Us.attachEvent("onpropertychange",_p)):e==="focusout"&&nd()}function Ty(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Yo(nl)}function My(e,t){if(e==="click")return Yo(t)}function $y(e,t){if(e==="input"||e==="change")return Yo(t)}function Fy(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var un=typeof Object.is=="function"?Object.is:Fy;function rl(e,t){if(un(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ea.call(t,s)||!un(e[s],t[s]))return!1}return!0}function rd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function sd(e,t){var n=rd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=rd(n)}}function Rp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Rp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ip(){for(var e=window,t=uo();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=uo(e.document)}return t}function _c(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Oy(e){var t=Ip(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Rp(n.ownerDocument.documentElement,n)){if(r!==null&&_c(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,l=Math.min(r.start,s);r=r.end===void 0?l:Math.min(r.end,s),!e.extend&&l>r&&(s=r,r=l,l=s),s=sd(n,l);var i=sd(n,r);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Dy=Mn&&"documentMode"in document&&11>=document.documentMode,Wr=null,xa=null,Vs=null,wa=!1;function ld(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wa||Wr==null||Wr!==uo(r)||(r=Wr,"selectionStart"in r&&_c(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vs&&rl(Vs,r)||(Vs=r,r=vo(xa,"onSelect"),0<r.length&&(t=new Ec("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Wr)))}function $l(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Hr={animationend:$l("Animation","AnimationEnd"),animationiteration:$l("Animation","AnimationIteration"),animationstart:$l("Animation","AnimationStart"),transitionend:$l("Transition","TransitionEnd")},_i={},zp={};Mn&&(zp=document.createElement("div").style,"AnimationEvent"in window||(delete Hr.animationend.animation,delete Hr.animationiteration.animation,delete Hr.animationstart.animation),"TransitionEvent"in window||delete Hr.transitionend.transition);function qo(e){if(_i[e])return _i[e];if(!Hr[e])return e;var t=Hr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in zp)return _i[e]=t[n];return e}var Ap=qo("animationend"),Tp=qo("animationiteration"),Mp=qo("animationstart"),$p=qo("transitionend"),Fp=new Map,od="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pr(e,t){Fp.set(e,t),Ir(t,[e])}for(var Ri=0;Ri<od.length;Ri++){var Ii=od[Ri],By=Ii.toLowerCase(),Uy=Ii[0].toUpperCase()+Ii.slice(1);pr(By,"on"+Uy)}pr(Ap,"onAnimationEnd");pr(Tp,"onAnimationIteration");pr(Mp,"onAnimationStart");pr("dblclick","onDoubleClick");pr("focusin","onFocus");pr("focusout","onBlur");pr($p,"onTransitionEnd");os("onMouseEnter",["mouseout","mouseover"]);os("onMouseLeave",["mouseout","mouseover"]);os("onPointerEnter",["pointerout","pointerover"]);os("onPointerLeave",["pointerout","pointerover"]);Ir("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ir("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ir("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ir("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ir("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ir("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ms));function id(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Bg(r,t,void 0,e),e.currentTarget=null}function Op(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var i=r.length-1;0<=i;i--){var c=r[i],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==l&&s.isPropagationStopped())break e;id(s,c,d),l=u}else for(i=0;i<r.length;i++){if(c=r[i],u=c.instance,d=c.currentTarget,c=c.listener,u!==l&&s.isPropagationStopped())break e;id(s,c,d),l=u}}}if(po)throw e=ma,po=!1,ma=null,e}function Xe(e,t){var n=t[Ca];n===void 0&&(n=t[Ca]=new Set);var r=e+"__bubble";n.has(r)||(Dp(t,e,2,!1),n.add(r))}function zi(e,t,n){var r=0;t&&(r|=4),Dp(n,e,r,t)}var Fl="_reactListening"+Math.random().toString(36).slice(2);function sl(e){if(!e[Fl]){e[Fl]=!0,Kf.forEach(function(n){n!=="selectionchange"&&(Vy.has(n)||zi(n,!1,e),zi(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Fl]||(t[Fl]=!0,zi("selectionchange",!1,t))}}function Dp(e,t,n,r){switch(Np(t)){case 1:var s=ry;break;case 4:s=sy;break;default:s=Cc}n=s.bind(null,t,n,e),s=void 0,!ha||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Ai(e,t,n,r,s){var l=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;i=i.return}for(;c!==null;){if(i=Sr(c),i===null)return;if(u=i.tag,u===5||u===6){r=l=i;continue e}c=c.parentNode}}r=r.return}cp(function(){var d=l,m=Sc(n),y=[];e:{var g=Fp.get(e);if(g!==void 0){var x=Ec,w=e;switch(e){case"keypress":if(to(n)===0)break e;case"keydown":case"keyup":x=xy;break;case"focusin":w="focus",x=Ei;break;case"focusout":w="blur",x=Ei;break;case"beforeblur":case"afterblur":x=Ei;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Yu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=iy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=jy;break;case Ap:case Tp:case Mp:x=uy;break;case $p:x=ky;break;case"scroll":x=ly;break;case"wheel":x=by;break;case"copy":case"cut":case"paste":x=fy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Xu}var j=(t&4)!==0,S=!j&&e==="scroll",h=j?g!==null?g+"Capture":null:g;j=[];for(var f=d,p;f!==null;){p=f;var v=p.stateNode;if(p.tag===5&&v!==null&&(p=v,h!==null&&(v=Js(f,h),v!=null&&j.push(ll(f,v,p)))),S)break;f=f.return}0<j.length&&(g=new x(g,w,null,n,m),y.push({event:g,listeners:j}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",g&&n!==fa&&(w=n.relatedTarget||n.fromElement)&&(Sr(w)||w[$n]))break e;if((x||g)&&(g=m.window===m?m:(g=m.ownerDocument)?g.defaultView||g.parentWindow:window,x?(w=n.relatedTarget||n.toElement,x=d,w=w?Sr(w):null,w!==null&&(S=zr(w),w!==S||w.tag!==5&&w.tag!==6)&&(w=null)):(x=null,w=d),x!==w)){if(j=Yu,v="onMouseLeave",h="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(j=Xu,v="onPointerLeave",h="onPointerEnter",f="pointer"),S=x==null?g:Gr(x),p=w==null?g:Gr(w),g=new j(v,f+"leave",x,n,m),g.target=S,g.relatedTarget=p,v=null,Sr(m)===d&&(j=new j(h,f+"enter",w,n,m),j.target=p,j.relatedTarget=S,v=j),S=v,x&&w)t:{for(j=x,h=w,f=0,p=j;p;p=$r(p))f++;for(p=0,v=h;v;v=$r(v))p++;for(;0<f-p;)j=$r(j),f--;for(;0<p-f;)h=$r(h),p--;for(;f--;){if(j===h||h!==null&&j===h.alternate)break t;j=$r(j),h=$r(h)}j=null}else j=null;x!==null&&ad(y,g,x,j,!1),w!==null&&S!==null&&ad(y,S,w,j,!0)}}e:{if(g=d?Gr(d):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var k=zy;else if(ed(g))if(Pp)k=$y;else{k=Ty;var N=Ay}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(k=My);if(k&&(k=k(e,d))){Lp(y,k,n,m);break e}N&&N(e,g,d),e==="focusout"&&(N=g._wrapperState)&&N.controlled&&g.type==="number"&&ia(g,"number",g.value)}switch(N=d?Gr(d):window,e){case"focusin":(ed(N)||N.contentEditable==="true")&&(Wr=N,xa=d,Vs=null);break;case"focusout":Vs=xa=Wr=null;break;case"mousedown":wa=!0;break;case"contextmenu":case"mouseup":case"dragend":wa=!1,ld(y,n,m);break;case"selectionchange":if(Dy)break;case"keydown":case"keyup":ld(y,n,m)}var _;if(Pc)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Vr?bp(e,n)&&(I="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(Cp&&n.locale!=="ko"&&(Vr||I!=="onCompositionStart"?I==="onCompositionEnd"&&Vr&&(_=kp()):(qn=m,bc="value"in qn?qn.value:qn.textContent,Vr=!0)),N=vo(d,I),0<N.length&&(I=new qu(I,e,null,n,m),y.push({event:I,listeners:N}),_?I.data=_:(_=Ep(n),_!==null&&(I.data=_)))),(_=Ly?Py(e,n):_y(e,n))&&(d=vo(d,"onBeforeInput"),0<d.length&&(m=new qu("onBeforeInput","beforeinput",null,n,m),y.push({event:m,listeners:d}),m.data=_))}Op(y,t)})}function ll(e,t,n){return{instance:e,listener:t,currentTarget:n}}function vo(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,l=s.stateNode;s.tag===5&&l!==null&&(s=l,l=Js(e,n),l!=null&&r.unshift(ll(e,l,s)),l=Js(e,t),l!=null&&r.push(ll(e,l,s))),e=e.return}return r}function $r(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ad(e,t,n,r,s){for(var l=t._reactName,i=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=Js(n,l),u!=null&&i.unshift(ll(n,u,c))):s||(u=Js(n,l),u!=null&&i.push(ll(n,u,c)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var Wy=/\r\n?/g,Hy=/\u0000|\uFFFD/g;function cd(e){return(typeof e=="string"?e:""+e).replace(Wy,`
`).replace(Hy,"")}function Ol(e,t,n){if(t=cd(t),cd(e)!==t&&n)throw Error(Z(425))}function xo(){}var Sa=null,ja=null;function Na(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ka=typeof setTimeout=="function"?setTimeout:void 0,Gy=typeof clearTimeout=="function"?clearTimeout:void 0,ud=typeof Promise=="function"?Promise:void 0,Ky=typeof queueMicrotask=="function"?queueMicrotask:typeof ud<"u"?function(e){return ud.resolve(null).then(e).catch(Qy)}:ka;function Qy(e){setTimeout(function(){throw e})}function Ti(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),tl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);tl(t)}function nr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function dd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ys=Math.random().toString(36).slice(2),gn="__reactFiber$"+ys,ol="__reactProps$"+ys,$n="__reactContainer$"+ys,Ca="__reactEvents$"+ys,Yy="__reactListeners$"+ys,qy="__reactHandles$"+ys;function Sr(e){var t=e[gn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[$n]||n[gn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=dd(e);e!==null;){if(n=e[gn])return n;e=dd(e)}return t}e=n,n=e.parentNode}return null}function wl(e){return e=e[gn]||e[$n],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Gr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Z(33))}function Xo(e){return e[ol]||null}var ba=[],Kr=-1;function hr(e){return{current:e}}function Je(e){0>Kr||(e.current=ba[Kr],ba[Kr]=null,Kr--)}function qe(e,t){Kr++,ba[Kr]=e.current,e.current=t}var cr={},Ct=hr(cr),zt=hr(!1),Er=cr;function is(e,t){var n=e.type.contextTypes;if(!n)return cr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},l;for(l in n)s[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function At(e){return e=e.childContextTypes,e!=null}function wo(){Je(zt),Je(Ct)}function fd(e,t,n){if(Ct.current!==cr)throw Error(Z(168));qe(Ct,t),qe(zt,n)}function Bp(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(Z(108,Ag(e)||"Unknown",s));return ot({},n,r)}function So(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||cr,Er=Ct.current,qe(Ct,e),qe(zt,zt.current),!0}function pd(e,t,n){var r=e.stateNode;if(!r)throw Error(Z(169));n?(e=Bp(e,t,Er),r.__reactInternalMemoizedMergedChildContext=e,Je(zt),Je(Ct),qe(Ct,e)):Je(zt),qe(zt,n)}var Ln=null,Jo=!1,Mi=!1;function Up(e){Ln===null?Ln=[e]:Ln.push(e)}function Xy(e){Jo=!0,Up(e)}function mr(){if(!Mi&&Ln!==null){Mi=!0;var e=0,t=Qe;try{var n=Ln;for(Qe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Ln=null,Jo=!1}catch(s){throw Ln!==null&&(Ln=Ln.slice(e+1)),pp(jc,mr),s}finally{Qe=t,Mi=!1}}return null}var Qr=[],Yr=0,jo=null,No=0,Yt=[],qt=0,Lr=null,_n=1,Rn="";function vr(e,t){Qr[Yr++]=No,Qr[Yr++]=jo,jo=e,No=t}function Vp(e,t,n){Yt[qt++]=_n,Yt[qt++]=Rn,Yt[qt++]=Lr,Lr=e;var r=_n;e=Rn;var s=32-an(r)-1;r&=~(1<<s),n+=1;var l=32-an(t)+s;if(30<l){var i=s-s%5;l=(r&(1<<i)-1).toString(32),r>>=i,s-=i,_n=1<<32-an(t)+s|n<<s|r,Rn=l+e}else _n=1<<l|n<<s|r,Rn=e}function Rc(e){e.return!==null&&(vr(e,1),Vp(e,1,0))}function Ic(e){for(;e===jo;)jo=Qr[--Yr],Qr[Yr]=null,No=Qr[--Yr],Qr[Yr]=null;for(;e===Lr;)Lr=Yt[--qt],Yt[qt]=null,Rn=Yt[--qt],Yt[qt]=null,_n=Yt[--qt],Yt[qt]=null}var Dt=null,Ot=null,et=!1,on=null;function Wp(e,t){var n=Xt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function hd(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Dt=e,Ot=nr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Dt=e,Ot=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Lr!==null?{id:_n,overflow:Rn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Xt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Dt=e,Ot=null,!0):!1;default:return!1}}function Ea(e){return(e.mode&1)!==0&&(e.flags&128)===0}function La(e){if(et){var t=Ot;if(t){var n=t;if(!hd(e,t)){if(Ea(e))throw Error(Z(418));t=nr(n.nextSibling);var r=Dt;t&&hd(e,t)?Wp(r,n):(e.flags=e.flags&-4097|2,et=!1,Dt=e)}}else{if(Ea(e))throw Error(Z(418));e.flags=e.flags&-4097|2,et=!1,Dt=e}}}function md(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Dt=e}function Dl(e){if(e!==Dt)return!1;if(!et)return md(e),et=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Na(e.type,e.memoizedProps)),t&&(t=Ot)){if(Ea(e))throw Hp(),Error(Z(418));for(;t;)Wp(e,t),t=nr(t.nextSibling)}if(md(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ot=nr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ot=null}}else Ot=Dt?nr(e.stateNode.nextSibling):null;return!0}function Hp(){for(var e=Ot;e;)e=nr(e.nextSibling)}function as(){Ot=Dt=null,et=!1}function zc(e){on===null?on=[e]:on.push(e)}var Jy=Dn.ReactCurrentBatchConfig;function Ps(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,e));var s=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(i){var c=s.refs;i===null?delete c[l]:c[l]=i},t._stringRef=l,t)}if(typeof e!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,e))}return e}function Bl(e,t){throw e=Object.prototype.toString.call(t),Error(Z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gd(e){var t=e._init;return t(e._payload)}function Gp(e){function t(h,f){if(e){var p=h.deletions;p===null?(h.deletions=[f],h.flags|=16):p.push(f)}}function n(h,f){if(!e)return null;for(;f!==null;)t(h,f),f=f.sibling;return null}function r(h,f){for(h=new Map;f!==null;)f.key!==null?h.set(f.key,f):h.set(f.index,f),f=f.sibling;return h}function s(h,f){return h=or(h,f),h.index=0,h.sibling=null,h}function l(h,f,p){return h.index=p,e?(p=h.alternate,p!==null?(p=p.index,p<f?(h.flags|=2,f):p):(h.flags|=2,f)):(h.flags|=1048576,f)}function i(h){return e&&h.alternate===null&&(h.flags|=2),h}function c(h,f,p,v){return f===null||f.tag!==6?(f=Vi(p,h.mode,v),f.return=h,f):(f=s(f,p),f.return=h,f)}function u(h,f,p,v){var k=p.type;return k===Ur?m(h,f,p.props.children,v,p.key):f!==null&&(f.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Gn&&gd(k)===f.type)?(v=s(f,p.props),v.ref=Ps(h,f,p),v.return=h,v):(v=ao(p.type,p.key,p.props,null,h.mode,v),v.ref=Ps(h,f,p),v.return=h,v)}function d(h,f,p,v){return f===null||f.tag!==4||f.stateNode.containerInfo!==p.containerInfo||f.stateNode.implementation!==p.implementation?(f=Wi(p,h.mode,v),f.return=h,f):(f=s(f,p.children||[]),f.return=h,f)}function m(h,f,p,v,k){return f===null||f.tag!==7?(f=Cr(p,h.mode,v,k),f.return=h,f):(f=s(f,p),f.return=h,f)}function y(h,f,p){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Vi(""+f,h.mode,p),f.return=h,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case _l:return p=ao(f.type,f.key,f.props,null,h.mode,p),p.ref=Ps(h,null,f),p.return=h,p;case Br:return f=Wi(f,h.mode,p),f.return=h,f;case Gn:var v=f._init;return y(h,v(f._payload),p)}if(As(f)||ks(f))return f=Cr(f,h.mode,p,null),f.return=h,f;Bl(h,f)}return null}function g(h,f,p,v){var k=f!==null?f.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return k!==null?null:c(h,f,""+p,v);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case _l:return p.key===k?u(h,f,p,v):null;case Br:return p.key===k?d(h,f,p,v):null;case Gn:return k=p._init,g(h,f,k(p._payload),v)}if(As(p)||ks(p))return k!==null?null:m(h,f,p,v,null);Bl(h,p)}return null}function x(h,f,p,v,k){if(typeof v=="string"&&v!==""||typeof v=="number")return h=h.get(p)||null,c(f,h,""+v,k);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case _l:return h=h.get(v.key===null?p:v.key)||null,u(f,h,v,k);case Br:return h=h.get(v.key===null?p:v.key)||null,d(f,h,v,k);case Gn:var N=v._init;return x(h,f,p,N(v._payload),k)}if(As(v)||ks(v))return h=h.get(p)||null,m(f,h,v,k,null);Bl(f,v)}return null}function w(h,f,p,v){for(var k=null,N=null,_=f,I=f=0,z=null;_!==null&&I<p.length;I++){_.index>I?(z=_,_=null):z=_.sibling;var T=g(h,_,p[I],v);if(T===null){_===null&&(_=z);break}e&&_&&T.alternate===null&&t(h,_),f=l(T,f,I),N===null?k=T:N.sibling=T,N=T,_=z}if(I===p.length)return n(h,_),et&&vr(h,I),k;if(_===null){for(;I<p.length;I++)_=y(h,p[I],v),_!==null&&(f=l(_,f,I),N===null?k=_:N.sibling=_,N=_);return et&&vr(h,I),k}for(_=r(h,_);I<p.length;I++)z=x(_,h,I,p[I],v),z!==null&&(e&&z.alternate!==null&&_.delete(z.key===null?I:z.key),f=l(z,f,I),N===null?k=z:N.sibling=z,N=z);return e&&_.forEach(function(O){return t(h,O)}),et&&vr(h,I),k}function j(h,f,p,v){var k=ks(p);if(typeof k!="function")throw Error(Z(150));if(p=k.call(p),p==null)throw Error(Z(151));for(var N=k=null,_=f,I=f=0,z=null,T=p.next();_!==null&&!T.done;I++,T=p.next()){_.index>I?(z=_,_=null):z=_.sibling;var O=g(h,_,T.value,v);if(O===null){_===null&&(_=z);break}e&&_&&O.alternate===null&&t(h,_),f=l(O,f,I),N===null?k=O:N.sibling=O,N=O,_=z}if(T.done)return n(h,_),et&&vr(h,I),k;if(_===null){for(;!T.done;I++,T=p.next())T=y(h,T.value,v),T!==null&&(f=l(T,f,I),N===null?k=T:N.sibling=T,N=T);return et&&vr(h,I),k}for(_=r(h,_);!T.done;I++,T=p.next())T=x(_,h,I,T.value,v),T!==null&&(e&&T.alternate!==null&&_.delete(T.key===null?I:T.key),f=l(T,f,I),N===null?k=T:N.sibling=T,N=T);return e&&_.forEach(function(ae){return t(h,ae)}),et&&vr(h,I),k}function S(h,f,p,v){if(typeof p=="object"&&p!==null&&p.type===Ur&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case _l:e:{for(var k=p.key,N=f;N!==null;){if(N.key===k){if(k=p.type,k===Ur){if(N.tag===7){n(h,N.sibling),f=s(N,p.props.children),f.return=h,h=f;break e}}else if(N.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Gn&&gd(k)===N.type){n(h,N.sibling),f=s(N,p.props),f.ref=Ps(h,N,p),f.return=h,h=f;break e}n(h,N);break}else t(h,N);N=N.sibling}p.type===Ur?(f=Cr(p.props.children,h.mode,v,p.key),f.return=h,h=f):(v=ao(p.type,p.key,p.props,null,h.mode,v),v.ref=Ps(h,f,p),v.return=h,h=v)}return i(h);case Br:e:{for(N=p.key;f!==null;){if(f.key===N)if(f.tag===4&&f.stateNode.containerInfo===p.containerInfo&&f.stateNode.implementation===p.implementation){n(h,f.sibling),f=s(f,p.children||[]),f.return=h,h=f;break e}else{n(h,f);break}else t(h,f);f=f.sibling}f=Wi(p,h.mode,v),f.return=h,h=f}return i(h);case Gn:return N=p._init,S(h,f,N(p._payload),v)}if(As(p))return w(h,f,p,v);if(ks(p))return j(h,f,p,v);Bl(h,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,f!==null&&f.tag===6?(n(h,f.sibling),f=s(f,p),f.return=h,h=f):(n(h,f),f=Vi(p,h.mode,v),f.return=h,h=f),i(h)):n(h,f)}return S}var cs=Gp(!0),Kp=Gp(!1),ko=hr(null),Co=null,qr=null,Ac=null;function Tc(){Ac=qr=Co=null}function Mc(e){var t=ko.current;Je(ko),e._currentValue=t}function Pa(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function rs(e,t){Co=e,Ac=qr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(It=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(Ac!==e)if(e={context:e,memoizedValue:t,next:null},qr===null){if(Co===null)throw Error(Z(308));qr=e,Co.dependencies={lanes:0,firstContext:e}}else qr=qr.next=e;return t}var jr=null;function $c(e){jr===null?jr=[e]:jr.push(e)}function Qp(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,$c(t)):(n.next=s.next,s.next=n),t.interleaved=n,Fn(e,r)}function Fn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Kn=!1;function Fc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function An(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function rr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Fn(e,n)}return s=r.interleaved,s===null?(t.next=t,$c(r)):(t.next=s.next,s.next=t),r.interleaved=t,Fn(e,n)}function no(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nc(e,n)}}function yd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?s=l=i:l=l.next=i,n=n.next}while(n!==null);l===null?s=l=t:l=l.next=t}else s=l=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function bo(e,t,n,r){var s=e.updateQueue;Kn=!1;var l=s.firstBaseUpdate,i=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,i===null?l=d:i.next=d,i=u;var m=e.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==i&&(c===null?m.firstBaseUpdate=d:c.next=d,m.lastBaseUpdate=u))}if(l!==null){var y=s.baseState;i=0,m=d=u=null,c=l;do{var g=c.lane,x=c.eventTime;if((r&g)===g){m!==null&&(m=m.next={eventTime:x,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=e,j=c;switch(g=t,x=n,j.tag){case 1:if(w=j.payload,typeof w=="function"){y=w.call(x,y,g);break e}y=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=j.payload,g=typeof w=="function"?w.call(x,y,g):w,g==null)break e;y=ot({},y,g);break e;case 2:Kn=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,g=s.effects,g===null?s.effects=[c]:g.push(c))}else x={eventTime:x,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(d=m=x,u=y):m=m.next=x,i|=g;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;g=c,c=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(m===null&&(u=y),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else l===null&&(s.shared.lanes=0);_r|=i,e.lanes=i,e.memoizedState=y}}function vd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Z(191,s));s.call(r)}}}var Sl={},jn=hr(Sl),il=hr(Sl),al=hr(Sl);function Nr(e){if(e===Sl)throw Error(Z(174));return e}function Oc(e,t){switch(qe(al,t),qe(il,e),qe(jn,Sl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ca(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ca(t,e)}Je(jn),qe(jn,t)}function us(){Je(jn),Je(il),Je(al)}function qp(e){Nr(al.current);var t=Nr(jn.current),n=ca(t,e.type);t!==n&&(qe(il,e),qe(jn,n))}function Dc(e){il.current===e&&(Je(jn),Je(il))}var rt=hr(0);function Eo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $i=[];function Bc(){for(var e=0;e<$i.length;e++)$i[e]._workInProgressVersionPrimary=null;$i.length=0}var ro=Dn.ReactCurrentDispatcher,Fi=Dn.ReactCurrentBatchConfig,Pr=0,st=null,pt=null,mt=null,Lo=!1,Ws=!1,cl=0,Zy=0;function jt(){throw Error(Z(321))}function Uc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!un(e[n],t[n]))return!1;return!0}function Vc(e,t,n,r,s,l){if(Pr=l,st=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=e===null||e.memoizedState===null?rv:sv,e=n(r,s),Ws){l=0;do{if(Ws=!1,cl=0,25<=l)throw Error(Z(301));l+=1,mt=pt=null,t.updateQueue=null,ro.current=lv,e=n(r,s)}while(Ws)}if(ro.current=Po,t=pt!==null&&pt.next!==null,Pr=0,mt=pt=st=null,Lo=!1,t)throw Error(Z(300));return e}function Wc(){var e=cl!==0;return cl=0,e}function hn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?st.memoizedState=mt=e:mt=mt.next=e,mt}function en(){if(pt===null){var e=st.alternate;e=e!==null?e.memoizedState:null}else e=pt.next;var t=mt===null?st.memoizedState:mt.next;if(t!==null)mt=t,pt=e;else{if(e===null)throw Error(Z(310));pt=e,e={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},mt===null?st.memoizedState=mt=e:mt=mt.next=e}return mt}function ul(e,t){return typeof t=="function"?t(e):t}function Oi(e){var t=en(),n=t.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=e;var r=pt,s=r.baseQueue,l=n.pending;if(l!==null){if(s!==null){var i=s.next;s.next=l.next,l.next=i}r.baseQueue=s=l,n.pending=null}if(s!==null){l=s.next,r=r.baseState;var c=i=null,u=null,d=l;do{var m=d.lane;if((Pr&m)===m)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var y={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=y,i=r):u=u.next=y,st.lanes|=m,_r|=m}d=d.next}while(d!==null&&d!==l);u===null?i=r:u.next=c,un(r,t.memoizedState)||(It=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do l=s.lane,st.lanes|=l,_r|=l,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Di(e){var t=en(),n=t.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,l=t.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do l=e(l,i.action),i=i.next;while(i!==s);un(l,t.memoizedState)||(It=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function Xp(){}function Jp(e,t){var n=st,r=en(),s=t(),l=!un(r.memoizedState,s);if(l&&(r.memoizedState=s,It=!0),r=r.queue,Hc(th.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||mt!==null&&mt.memoizedState.tag&1){if(n.flags|=2048,dl(9,eh.bind(null,n,r,s,t),void 0,null),gt===null)throw Error(Z(349));Pr&30||Zp(n,t,s)}return s}function Zp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=st.updateQueue,t===null?(t={lastEffect:null,stores:null},st.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function eh(e,t,n,r){t.value=n,t.getSnapshot=r,nh(t)&&rh(e)}function th(e,t,n){return n(function(){nh(t)&&rh(e)})}function nh(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!un(e,n)}catch{return!0}}function rh(e){var t=Fn(e,1);t!==null&&cn(t,e,1,-1)}function xd(e){var t=hn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ul,lastRenderedState:e},t.queue=e,e=e.dispatch=nv.bind(null,st,e),[t.memoizedState,e]}function dl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=st.updateQueue,t===null?(t={lastEffect:null,stores:null},st.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function sh(){return en().memoizedState}function so(e,t,n,r){var s=hn();st.flags|=e,s.memoizedState=dl(1|t,n,void 0,r===void 0?null:r)}function Zo(e,t,n,r){var s=en();r=r===void 0?null:r;var l=void 0;if(pt!==null){var i=pt.memoizedState;if(l=i.destroy,r!==null&&Uc(r,i.deps)){s.memoizedState=dl(t,n,l,r);return}}st.flags|=e,s.memoizedState=dl(1|t,n,l,r)}function wd(e,t){return so(8390656,8,e,t)}function Hc(e,t){return Zo(2048,8,e,t)}function lh(e,t){return Zo(4,2,e,t)}function oh(e,t){return Zo(4,4,e,t)}function ih(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ah(e,t,n){return n=n!=null?n.concat([e]):null,Zo(4,4,ih.bind(null,t,e),n)}function Gc(){}function ch(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Uc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function uh(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Uc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function dh(e,t,n){return Pr&21?(un(n,t)||(n=gp(),st.lanes|=n,_r|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,It=!0),e.memoizedState=n)}function ev(e,t){var n=Qe;Qe=n!==0&&4>n?n:4,e(!0);var r=Fi.transition;Fi.transition={};try{e(!1),t()}finally{Qe=n,Fi.transition=r}}function fh(){return en().memoizedState}function tv(e,t,n){var r=lr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ph(e))hh(t,n);else if(n=Qp(e,t,n,r),n!==null){var s=Et();cn(n,e,r,s),mh(n,t,r)}}function nv(e,t,n){var r=lr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ph(e))hh(t,s);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var i=t.lastRenderedState,c=l(i,n);if(s.hasEagerState=!0,s.eagerState=c,un(c,i)){var u=t.interleaved;u===null?(s.next=s,$c(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=Qp(e,t,s,r),n!==null&&(s=Et(),cn(n,e,r,s),mh(n,t,r))}}function ph(e){var t=e.alternate;return e===st||t!==null&&t===st}function hh(e,t){Ws=Lo=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function mh(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nc(e,n)}}var Po={readContext:Zt,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},rv={readContext:Zt,useCallback:function(e,t){return hn().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:wd,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,so(4194308,4,ih.bind(null,t,e),n)},useLayoutEffect:function(e,t){return so(4194308,4,e,t)},useInsertionEffect:function(e,t){return so(4,2,e,t)},useMemo:function(e,t){var n=hn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=hn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tv.bind(null,st,e),[r.memoizedState,e]},useRef:function(e){var t=hn();return e={current:e},t.memoizedState=e},useState:xd,useDebugValue:Gc,useDeferredValue:function(e){return hn().memoizedState=e},useTransition:function(){var e=xd(!1),t=e[0];return e=ev.bind(null,e[1]),hn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=st,s=hn();if(et){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=t(),gt===null)throw Error(Z(349));Pr&30||Zp(r,t,n)}s.memoizedState=n;var l={value:n,getSnapshot:t};return s.queue=l,wd(th.bind(null,r,l,e),[e]),r.flags|=2048,dl(9,eh.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=hn(),t=gt.identifierPrefix;if(et){var n=Rn,r=_n;n=(r&~(1<<32-an(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=cl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Zy++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},sv={readContext:Zt,useCallback:ch,useContext:Zt,useEffect:Hc,useImperativeHandle:ah,useInsertionEffect:lh,useLayoutEffect:oh,useMemo:uh,useReducer:Oi,useRef:sh,useState:function(){return Oi(ul)},useDebugValue:Gc,useDeferredValue:function(e){var t=en();return dh(t,pt.memoizedState,e)},useTransition:function(){var e=Oi(ul)[0],t=en().memoizedState;return[e,t]},useMutableSource:Xp,useSyncExternalStore:Jp,useId:fh,unstable_isNewReconciler:!1},lv={readContext:Zt,useCallback:ch,useContext:Zt,useEffect:Hc,useImperativeHandle:ah,useInsertionEffect:lh,useLayoutEffect:oh,useMemo:uh,useReducer:Di,useRef:sh,useState:function(){return Di(ul)},useDebugValue:Gc,useDeferredValue:function(e){var t=en();return pt===null?t.memoizedState=e:dh(t,pt.memoizedState,e)},useTransition:function(){var e=Di(ul)[0],t=en().memoizedState;return[e,t]},useMutableSource:Xp,useSyncExternalStore:Jp,useId:fh,unstable_isNewReconciler:!1};function sn(e,t){if(e&&e.defaultProps){t=ot({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function _a(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ot({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ei={isMounted:function(e){return(e=e._reactInternals)?zr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Et(),s=lr(e),l=An(r,s);l.payload=t,n!=null&&(l.callback=n),t=rr(e,l,s),t!==null&&(cn(t,e,s,r),no(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Et(),s=lr(e),l=An(r,s);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=rr(e,l,s),t!==null&&(cn(t,e,s,r),no(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Et(),r=lr(e),s=An(n,r);s.tag=2,t!=null&&(s.callback=t),t=rr(e,s,r),t!==null&&(cn(t,e,r,n),no(t,e,r))}};function Sd(e,t,n,r,s,l,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,i):t.prototype&&t.prototype.isPureReactComponent?!rl(n,r)||!rl(s,l):!0}function gh(e,t,n){var r=!1,s=cr,l=t.contextType;return typeof l=="object"&&l!==null?l=Zt(l):(s=At(t)?Er:Ct.current,r=t.contextTypes,l=(r=r!=null)?is(e,s):cr),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ei,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=l),t}function jd(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ei.enqueueReplaceState(t,t.state,null)}function Ra(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Fc(e);var l=t.contextType;typeof l=="object"&&l!==null?s.context=Zt(l):(l=At(t)?Er:Ct.current,s.context=is(e,l)),s.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(_a(e,t,l,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ei.enqueueReplaceState(s,s.state,null),bo(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ds(e,t){try{var n="",r=t;do n+=zg(r),r=r.return;while(r);var s=n}catch(l){s=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:s,digest:null}}function Bi(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ia(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ov=typeof WeakMap=="function"?WeakMap:Map;function yh(e,t,n){n=An(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ro||(Ro=!0,Ua=r),Ia(e,t)},n}function vh(e,t,n){n=An(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Ia(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Ia(e,t),typeof r!="function"&&(sr===null?sr=new Set([this]):sr.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function Nd(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new ov;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=wv.bind(null,e,t,n),t.then(e,e))}function kd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Cd(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=An(-1,1),t.tag=2,rr(n,t,1))),n.lanes|=1),e)}var iv=Dn.ReactCurrentOwner,It=!1;function bt(e,t,n,r){t.child=e===null?Kp(t,null,n,r):cs(t,e.child,n,r)}function bd(e,t,n,r,s){n=n.render;var l=t.ref;return rs(t,s),r=Vc(e,t,n,r,l,s),n=Wc(),e!==null&&!It?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,On(e,t,s)):(et&&n&&Rc(t),t.flags|=1,bt(e,t,r,s),t.child)}function Ed(e,t,n,r,s){if(e===null){var l=n.type;return typeof l=="function"&&!eu(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,xh(e,t,l,r,s)):(e=ao(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&s)){var i=l.memoizedProps;if(n=n.compare,n=n!==null?n:rl,n(i,r)&&e.ref===t.ref)return On(e,t,s)}return t.flags|=1,e=or(l,r),e.ref=t.ref,e.return=t,t.child=e}function xh(e,t,n,r,s){if(e!==null){var l=e.memoizedProps;if(rl(l,r)&&e.ref===t.ref)if(It=!1,t.pendingProps=r=l,(e.lanes&s)!==0)e.flags&131072&&(It=!0);else return t.lanes=e.lanes,On(e,t,s)}return za(e,t,n,r,s)}function wh(e,t,n){var r=t.pendingProps,s=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(Jr,$t),$t|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,qe(Jr,$t),$t|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,qe(Jr,$t),$t|=r}else l!==null?(r=l.baseLanes|n,t.memoizedState=null):r=n,qe(Jr,$t),$t|=r;return bt(e,t,s,n),t.child}function Sh(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function za(e,t,n,r,s){var l=At(n)?Er:Ct.current;return l=is(t,l),rs(t,s),n=Vc(e,t,n,r,l,s),r=Wc(),e!==null&&!It?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,On(e,t,s)):(et&&r&&Rc(t),t.flags|=1,bt(e,t,n,s),t.child)}function Ld(e,t,n,r,s){if(At(n)){var l=!0;So(t)}else l=!1;if(rs(t,s),t.stateNode===null)lo(e,t),gh(t,n,r),Ra(t,n,r,s),r=!0;else if(e===null){var i=t.stateNode,c=t.memoizedProps;i.props=c;var u=i.context,d=n.contextType;typeof d=="object"&&d!==null?d=Zt(d):(d=At(n)?Er:Ct.current,d=is(t,d));var m=n.getDerivedStateFromProps,y=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function";y||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(c!==r||u!==d)&&jd(t,i,r,d),Kn=!1;var g=t.memoizedState;i.state=g,bo(t,r,i,s),u=t.memoizedState,c!==r||g!==u||zt.current||Kn?(typeof m=="function"&&(_a(t,n,m,r),u=t.memoizedState),(c=Kn||Sd(t,n,c,r,g,u,d))?(y||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),i.props=r,i.state=u,i.context=d,r=c):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Yp(e,t),c=t.memoizedProps,d=t.type===t.elementType?c:sn(t.type,c),i.props=d,y=t.pendingProps,g=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Zt(u):(u=At(n)?Er:Ct.current,u=is(t,u));var x=n.getDerivedStateFromProps;(m=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(c!==y||g!==u)&&jd(t,i,r,u),Kn=!1,g=t.memoizedState,i.state=g,bo(t,r,i,s);var w=t.memoizedState;c!==y||g!==w||zt.current||Kn?(typeof x=="function"&&(_a(t,n,x,r),w=t.memoizedState),(d=Kn||Sd(t,n,d,r,g,w,u)||!1)?(m||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,w,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,w,u)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||c===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),i.props=r,i.state=w,i.context=u,r=d):(typeof i.componentDidUpdate!="function"||c===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),r=!1)}return Aa(e,t,n,r,l,s)}function Aa(e,t,n,r,s,l){Sh(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return s&&pd(t,n,!1),On(e,t,l);r=t.stateNode,iv.current=t;var c=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=cs(t,e.child,null,l),t.child=cs(t,null,c,l)):bt(e,t,c,l),t.memoizedState=r.state,s&&pd(t,n,!0),t.child}function jh(e){var t=e.stateNode;t.pendingContext?fd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&fd(e,t.context,!1),Oc(e,t.containerInfo)}function Pd(e,t,n,r,s){return as(),zc(s),t.flags|=256,bt(e,t,n,r),t.child}var Ta={dehydrated:null,treeContext:null,retryLane:0};function Ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function Nh(e,t,n){var r=t.pendingProps,s=rt.current,l=!1,i=(t.flags&128)!==0,c;if((c=i)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),qe(rt,s&1),e===null)return La(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,l?(r=t.mode,l=t.child,i={mode:"hidden",children:i},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=i):l=ri(i,r,0,null),e=Cr(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Ma(n),t.memoizedState=Ta,e):Kc(t,i));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return av(e,t,i,r,c,s,n);if(l){l=r.fallback,i=t.mode,s=e.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=or(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?l=or(c,l):(l=Cr(l,i,n,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,i=e.child.memoizedState,i=i===null?Ma(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},l.memoizedState=i,l.childLanes=e.childLanes&~n,t.memoizedState=Ta,r}return l=e.child,e=l.sibling,r=or(l,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Kc(e,t){return t=ri({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ul(e,t,n,r){return r!==null&&zc(r),cs(t,e.child,null,n),e=Kc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function av(e,t,n,r,s,l,i){if(n)return t.flags&256?(t.flags&=-257,r=Bi(Error(Z(422))),Ul(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,s=t.mode,r=ri({mode:"visible",children:r.children},s,0,null),l=Cr(l,s,i,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,t.mode&1&&cs(t,e.child,null,i),t.child.memoizedState=Ma(i),t.memoizedState=Ta,l);if(!(t.mode&1))return Ul(e,t,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,l=Error(Z(419)),r=Bi(l,r,void 0),Ul(e,t,i,r)}if(c=(i&e.childLanes)!==0,It||c){if(r=gt,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==l.retryLane&&(l.retryLane=s,Fn(e,s),cn(r,e,s,-1))}return Zc(),r=Bi(Error(Z(421))),Ul(e,t,i,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Sv.bind(null,e),s._reactRetry=t,null):(e=l.treeContext,Ot=nr(s.nextSibling),Dt=t,et=!0,on=null,e!==null&&(Yt[qt++]=_n,Yt[qt++]=Rn,Yt[qt++]=Lr,_n=e.id,Rn=e.overflow,Lr=t),t=Kc(t,r.children),t.flags|=4096,t)}function _d(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Pa(e.return,t,n)}function Ui(e,t,n,r,s){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=s)}function kh(e,t,n){var r=t.pendingProps,s=r.revealOrder,l=r.tail;if(bt(e,t,r.children,n),r=rt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&_d(e,n,t);else if(e.tag===19)_d(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(qe(rt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Eo(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Ui(t,!1,s,n,l);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Eo(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Ui(t,!0,n,null,l);break;case"together":Ui(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function lo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function On(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),_r|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Z(153));if(t.child!==null){for(e=t.child,n=or(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=or(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function cv(e,t,n){switch(t.tag){case 3:jh(t),as();break;case 5:qp(t);break;case 1:At(t.type)&&So(t);break;case 4:Oc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;qe(ko,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(qe(rt,rt.current&1),t.flags|=128,null):n&t.child.childLanes?Nh(e,t,n):(qe(rt,rt.current&1),e=On(e,t,n),e!==null?e.sibling:null);qe(rt,rt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return kh(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),qe(rt,rt.current),r)break;return null;case 22:case 23:return t.lanes=0,wh(e,t,n)}return On(e,t,n)}var Ch,$a,bh,Eh;Ch=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};$a=function(){};bh=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Nr(jn.current);var l=null;switch(n){case"input":s=la(e,s),r=la(e,r),l=[];break;case"select":s=ot({},s,{value:void 0}),r=ot({},r,{value:void 0}),l=[];break;case"textarea":s=aa(e,s),r=aa(e,r),l=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=xo)}ua(n,r);var i;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(qs.hasOwnProperty(d)?l||(l=[]):(l=l||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(i in c)!c.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&c[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(l||(l=[]),l.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(l=l||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(l=l||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(qs.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Xe("scroll",e),l||c===u||(l=[])):(l=l||[]).push(d,u))}n&&(l=l||[]).push("style",n);var d=l;(t.updateQueue=d)&&(t.flags|=4)}};Eh=function(e,t,n,r){n!==r&&(t.flags|=4)};function _s(e,t){if(!et)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Nt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function uv(e,t,n){var r=t.pendingProps;switch(Ic(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(t),null;case 1:return At(t.type)&&wo(),Nt(t),null;case 3:return r=t.stateNode,us(),Je(zt),Je(Ct),Bc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Dl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,on!==null&&(Ha(on),on=null))),$a(e,t),Nt(t),null;case 5:Dc(t);var s=Nr(al.current);if(n=t.type,e!==null&&t.stateNode!=null)bh(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Z(166));return Nt(t),null}if(e=Nr(jn.current),Dl(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[gn]=t,r[ol]=l,e=(t.mode&1)!==0,n){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(s=0;s<Ms.length;s++)Xe(Ms[s],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":Ou(r,l),Xe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Xe("invalid",r);break;case"textarea":Bu(r,l),Xe("invalid",r)}ua(n,l),s=null;for(var i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="children"?typeof c=="string"?r.textContent!==c&&(l.suppressHydrationWarning!==!0&&Ol(r.textContent,c,e),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(l.suppressHydrationWarning!==!0&&Ol(r.textContent,c,e),s=["children",""+c]):qs.hasOwnProperty(i)&&c!=null&&i==="onScroll"&&Xe("scroll",r)}switch(n){case"input":Rl(r),Du(r,l,!0);break;case"textarea":Rl(r),Uu(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=xo)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=tp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[gn]=t,e[ol]=r,Ch(e,t,!1,!1),t.stateNode=e;e:{switch(i=da(n,r),n){case"dialog":Xe("cancel",e),Xe("close",e),s=r;break;case"iframe":case"object":case"embed":Xe("load",e),s=r;break;case"video":case"audio":for(s=0;s<Ms.length;s++)Xe(Ms[s],e);s=r;break;case"source":Xe("error",e),s=r;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),s=r;break;case"details":Xe("toggle",e),s=r;break;case"input":Ou(e,r),s=la(e,r),Xe("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=ot({},r,{value:void 0}),Xe("invalid",e);break;case"textarea":Bu(e,r),s=aa(e,r),Xe("invalid",e);break;default:s=r}ua(n,s),c=s;for(l in c)if(c.hasOwnProperty(l)){var u=c[l];l==="style"?sp(e,u):l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&np(e,u)):l==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Xs(e,u):typeof u=="number"&&Xs(e,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(qs.hasOwnProperty(l)?u!=null&&l==="onScroll"&&Xe("scroll",e):u!=null&&yc(e,l,u,i))}switch(n){case"input":Rl(e),Du(e,r,!1);break;case"textarea":Rl(e),Uu(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ar(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?Zr(e,!!r.multiple,l,!1):r.defaultValue!=null&&Zr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=xo)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nt(t),null;case 6:if(e&&t.stateNode!=null)Eh(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Z(166));if(n=Nr(al.current),Nr(jn.current),Dl(t)){if(r=t.stateNode,n=t.memoizedProps,r[gn]=t,(l=r.nodeValue!==n)&&(e=Dt,e!==null))switch(e.tag){case 3:Ol(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ol(r.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[gn]=t,t.stateNode=r}return Nt(t),null;case 13:if(Je(rt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(et&&Ot!==null&&t.mode&1&&!(t.flags&128))Hp(),as(),t.flags|=98560,l=!1;else if(l=Dl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(Z(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Z(317));l[gn]=t}else as(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nt(t),l=!1}else on!==null&&(Ha(on),on=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||rt.current&1?ht===0&&(ht=3):Zc())),t.updateQueue!==null&&(t.flags|=4),Nt(t),null);case 4:return us(),$a(e,t),e===null&&sl(t.stateNode.containerInfo),Nt(t),null;case 10:return Mc(t.type._context),Nt(t),null;case 17:return At(t.type)&&wo(),Nt(t),null;case 19:if(Je(rt),l=t.memoizedState,l===null)return Nt(t),null;if(r=(t.flags&128)!==0,i=l.rendering,i===null)if(r)_s(l,!1);else{if(ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Eo(e),i!==null){for(t.flags|=128,_s(l,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)l=n,e=r,l.flags&=14680066,i=l.alternate,i===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,l.type=i.type,e=i.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return qe(rt,rt.current&1|2),t.child}e=e.sibling}l.tail!==null&&ut()>fs&&(t.flags|=128,r=!0,_s(l,!1),t.lanes=4194304)}else{if(!r)if(e=Eo(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),_s(l,!0),l.tail===null&&l.tailMode==="hidden"&&!i.alternate&&!et)return Nt(t),null}else 2*ut()-l.renderingStartTime>fs&&n!==1073741824&&(t.flags|=128,r=!0,_s(l,!1),t.lanes=4194304);l.isBackwards?(i.sibling=t.child,t.child=i):(n=l.last,n!==null?n.sibling=i:t.child=i,l.last=i)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=ut(),t.sibling=null,n=rt.current,qe(rt,r?n&1|2:n&1),t):(Nt(t),null);case 22:case 23:return Jc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?$t&1073741824&&(Nt(t),t.subtreeFlags&6&&(t.flags|=8192)):Nt(t),null;case 24:return null;case 25:return null}throw Error(Z(156,t.tag))}function dv(e,t){switch(Ic(t),t.tag){case 1:return At(t.type)&&wo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return us(),Je(zt),Je(Ct),Bc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Dc(t),null;case 13:if(Je(rt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Z(340));as()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Je(rt),null;case 4:return us(),null;case 10:return Mc(t.type._context),null;case 22:case 23:return Jc(),null;case 24:return null;default:return null}}var Vl=!1,kt=!1,fv=typeof WeakSet=="function"?WeakSet:Set,ge=null;function Xr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){at(e,t,r)}else n.current=null}function Fa(e,t,n){try{n()}catch(r){at(e,t,r)}}var Rd=!1;function pv(e,t){if(Sa=go,e=Ip(),_c(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var i=0,c=-1,u=-1,d=0,m=0,y=e,g=null;t:for(;;){for(var x;y!==n||s!==0&&y.nodeType!==3||(c=i+s),y!==l||r!==0&&y.nodeType!==3||(u=i+r),y.nodeType===3&&(i+=y.nodeValue.length),(x=y.firstChild)!==null;)g=y,y=x;for(;;){if(y===e)break t;if(g===n&&++d===s&&(c=i),g===l&&++m===r&&(u=i),(x=y.nextSibling)!==null)break;y=g,g=y.parentNode}y=x}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ja={focusedElem:e,selectionRange:n},go=!1,ge=t;ge!==null;)if(t=ge,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ge=e;else for(;ge!==null;){t=ge;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var j=w.memoizedProps,S=w.memoizedState,h=t.stateNode,f=h.getSnapshotBeforeUpdate(t.elementType===t.type?j:sn(t.type,j),S);h.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(v){at(t,t.return,v)}if(e=t.sibling,e!==null){e.return=t.return,ge=e;break}ge=t.return}return w=Rd,Rd=!1,w}function Hs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var l=s.destroy;s.destroy=void 0,l!==void 0&&Fa(t,n,l)}s=s.next}while(s!==r)}}function ti(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Oa(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Lh(e){var t=e.alternate;t!==null&&(e.alternate=null,Lh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[gn],delete t[ol],delete t[Ca],delete t[Yy],delete t[qy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ph(e){return e.tag===5||e.tag===3||e.tag===4}function Id(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ph(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Da(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=xo));else if(r!==4&&(e=e.child,e!==null))for(Da(e,t,n),e=e.sibling;e!==null;)Da(e,t,n),e=e.sibling}function Ba(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ba(e,t,n),e=e.sibling;e!==null;)Ba(e,t,n),e=e.sibling}var vt=null,ln=!1;function Hn(e,t,n){for(n=n.child;n!==null;)_h(e,t,n),n=n.sibling}function _h(e,t,n){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(Ko,n)}catch{}switch(n.tag){case 5:kt||Xr(n,t);case 6:var r=vt,s=ln;vt=null,Hn(e,t,n),vt=r,ln=s,vt!==null&&(ln?(e=vt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):vt.removeChild(n.stateNode));break;case 18:vt!==null&&(ln?(e=vt,n=n.stateNode,e.nodeType===8?Ti(e.parentNode,n):e.nodeType===1&&Ti(e,n),tl(e)):Ti(vt,n.stateNode));break;case 4:r=vt,s=ln,vt=n.stateNode.containerInfo,ln=!0,Hn(e,t,n),vt=r,ln=s;break;case 0:case 11:case 14:case 15:if(!kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var l=s,i=l.destroy;l=l.tag,i!==void 0&&(l&2||l&4)&&Fa(n,t,i),s=s.next}while(s!==r)}Hn(e,t,n);break;case 1:if(!kt&&(Xr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){at(n,t,c)}Hn(e,t,n);break;case 21:Hn(e,t,n);break;case 22:n.mode&1?(kt=(r=kt)||n.memoizedState!==null,Hn(e,t,n),kt=r):Hn(e,t,n);break;default:Hn(e,t,n)}}function zd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new fv),t.forEach(function(r){var s=jv.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function nn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var l=e,i=t,c=i;e:for(;c!==null;){switch(c.tag){case 5:vt=c.stateNode,ln=!1;break e;case 3:vt=c.stateNode.containerInfo,ln=!0;break e;case 4:vt=c.stateNode.containerInfo,ln=!0;break e}c=c.return}if(vt===null)throw Error(Z(160));_h(l,i,s),vt=null,ln=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){at(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Rh(t,e),t=t.sibling}function Rh(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(nn(t,e),pn(e),r&4){try{Hs(3,e,e.return),ti(3,e)}catch(j){at(e,e.return,j)}try{Hs(5,e,e.return)}catch(j){at(e,e.return,j)}}break;case 1:nn(t,e),pn(e),r&512&&n!==null&&Xr(n,n.return);break;case 5:if(nn(t,e),pn(e),r&512&&n!==null&&Xr(n,n.return),e.flags&32){var s=e.stateNode;try{Xs(s,"")}catch(j){at(e,e.return,j)}}if(r&4&&(s=e.stateNode,s!=null)){var l=e.memoizedProps,i=n!==null?n.memoizedProps:l,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&l.type==="radio"&&l.name!=null&&Zf(s,l),da(c,i);var d=da(c,l);for(i=0;i<u.length;i+=2){var m=u[i],y=u[i+1];m==="style"?sp(s,y):m==="dangerouslySetInnerHTML"?np(s,y):m==="children"?Xs(s,y):yc(s,m,y,d)}switch(c){case"input":oa(s,l);break;case"textarea":ep(s,l);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!l.multiple;var x=l.value;x!=null?Zr(s,!!l.multiple,x,!1):g!==!!l.multiple&&(l.defaultValue!=null?Zr(s,!!l.multiple,l.defaultValue,!0):Zr(s,!!l.multiple,l.multiple?[]:"",!1))}s[ol]=l}catch(j){at(e,e.return,j)}}break;case 6:if(nn(t,e),pn(e),r&4){if(e.stateNode===null)throw Error(Z(162));s=e.stateNode,l=e.memoizedProps;try{s.nodeValue=l}catch(j){at(e,e.return,j)}}break;case 3:if(nn(t,e),pn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{tl(t.containerInfo)}catch(j){at(e,e.return,j)}break;case 4:nn(t,e),pn(e);break;case 13:nn(t,e),pn(e),s=e.child,s.flags&8192&&(l=s.memoizedState!==null,s.stateNode.isHidden=l,!l||s.alternate!==null&&s.alternate.memoizedState!==null||(qc=ut())),r&4&&zd(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(kt=(d=kt)||m,nn(t,e),kt=d):nn(t,e),pn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!m&&e.mode&1)for(ge=e,m=e.child;m!==null;){for(y=ge=m;ge!==null;){switch(g=ge,x=g.child,g.tag){case 0:case 11:case 14:case 15:Hs(4,g,g.return);break;case 1:Xr(g,g.return);var w=g.stateNode;if(typeof w.componentWillUnmount=="function"){r=g,n=g.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(j){at(r,n,j)}}break;case 5:Xr(g,g.return);break;case 22:if(g.memoizedState!==null){Td(y);continue}}x!==null?(x.return=g,ge=x):Td(y)}m=m.sibling}e:for(m=null,y=e;;){if(y.tag===5){if(m===null){m=y;try{s=y.stateNode,d?(l=s.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(c=y.stateNode,u=y.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=rp("display",i))}catch(j){at(e,e.return,j)}}}else if(y.tag===6){if(m===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(j){at(e,e.return,j)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===e)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===e)break e;for(;y.sibling===null;){if(y.return===null||y.return===e)break e;m===y&&(m=null),y=y.return}m===y&&(m=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:nn(t,e),pn(e),r&4&&zd(e);break;case 21:break;default:nn(t,e),pn(e)}}function pn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Ph(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xs(s,""),r.flags&=-33);var l=Id(e);Ba(e,l,s);break;case 3:case 4:var i=r.stateNode.containerInfo,c=Id(e);Da(e,c,i);break;default:throw Error(Z(161))}}catch(u){at(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function hv(e,t,n){ge=e,Ih(e)}function Ih(e,t,n){for(var r=(e.mode&1)!==0;ge!==null;){var s=ge,l=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Vl;if(!i){var c=s.alternate,u=c!==null&&c.memoizedState!==null||kt;c=Vl;var d=kt;if(Vl=i,(kt=u)&&!d)for(ge=s;ge!==null;)i=ge,u=i.child,i.tag===22&&i.memoizedState!==null?Md(s):u!==null?(u.return=i,ge=u):Md(s);for(;l!==null;)ge=l,Ih(l),l=l.sibling;ge=s,Vl=c,kt=d}Ad(e)}else s.subtreeFlags&8772&&l!==null?(l.return=s,ge=l):Ad(e)}}function Ad(e){for(;ge!==null;){var t=ge;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:kt||ti(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!kt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:sn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&vd(t,l,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}vd(t,i,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var y=m.dehydrated;y!==null&&tl(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}kt||t.flags&512&&Oa(t)}catch(g){at(t,t.return,g)}}if(t===e){ge=null;break}if(n=t.sibling,n!==null){n.return=t.return,ge=n;break}ge=t.return}}function Td(e){for(;ge!==null;){var t=ge;if(t===e){ge=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ge=n;break}ge=t.return}}function Md(e){for(;ge!==null;){var t=ge;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ti(4,t)}catch(u){at(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){at(t,s,u)}}var l=t.return;try{Oa(t)}catch(u){at(t,l,u)}break;case 5:var i=t.return;try{Oa(t)}catch(u){at(t,i,u)}}}catch(u){at(t,t.return,u)}if(t===e){ge=null;break}var c=t.sibling;if(c!==null){c.return=t.return,ge=c;break}ge=t.return}}var mv=Math.ceil,_o=Dn.ReactCurrentDispatcher,Qc=Dn.ReactCurrentOwner,Jt=Dn.ReactCurrentBatchConfig,Ve=0,gt=null,dt=null,xt=0,$t=0,Jr=hr(0),ht=0,fl=null,_r=0,ni=0,Yc=0,Gs=null,Rt=null,qc=0,fs=1/0,En=null,Ro=!1,Ua=null,sr=null,Wl=!1,Xn=null,Io=0,Ks=0,Va=null,oo=-1,io=0;function Et(){return Ve&6?ut():oo!==-1?oo:oo=ut()}function lr(e){return e.mode&1?Ve&2&&xt!==0?xt&-xt:Jy.transition!==null?(io===0&&(io=gp()),io):(e=Qe,e!==0||(e=window.event,e=e===void 0?16:Np(e.type)),e):1}function cn(e,t,n,r){if(50<Ks)throw Ks=0,Va=null,Error(Z(185));vl(e,n,r),(!(Ve&2)||e!==gt)&&(e===gt&&(!(Ve&2)&&(ni|=n),ht===4&&Yn(e,xt)),Tt(e,r),n===1&&Ve===0&&!(t.mode&1)&&(fs=ut()+500,Jo&&mr()))}function Tt(e,t){var n=e.callbackNode;Jg(e,t);var r=mo(e,e===gt?xt:0);if(r===0)n!==null&&Hu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Hu(n),t===1)e.tag===0?Xy($d.bind(null,e)):Up($d.bind(null,e)),Ky(function(){!(Ve&6)&&mr()}),n=null;else{switch(yp(r)){case 1:n=jc;break;case 4:n=hp;break;case 16:n=ho;break;case 536870912:n=mp;break;default:n=ho}n=Dh(n,zh.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function zh(e,t){if(oo=-1,io=0,Ve&6)throw Error(Z(327));var n=e.callbackNode;if(ss()&&e.callbackNode!==n)return null;var r=mo(e,e===gt?xt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=zo(e,r);else{t=r;var s=Ve;Ve|=2;var l=Th();(gt!==e||xt!==t)&&(En=null,fs=ut()+500,kr(e,t));do try{vv();break}catch(c){Ah(e,c)}while(!0);Tc(),_o.current=l,Ve=s,dt!==null?t=0:(gt=null,xt=0,t=ht)}if(t!==0){if(t===2&&(s=ga(e),s!==0&&(r=s,t=Wa(e,s))),t===1)throw n=fl,kr(e,0),Yn(e,r),Tt(e,ut()),n;if(t===6)Yn(e,r);else{if(s=e.current.alternate,!(r&30)&&!gv(s)&&(t=zo(e,r),t===2&&(l=ga(e),l!==0&&(r=l,t=Wa(e,l))),t===1))throw n=fl,kr(e,0),Yn(e,r),Tt(e,ut()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(Z(345));case 2:xr(e,Rt,En);break;case 3:if(Yn(e,r),(r&130023424)===r&&(t=qc+500-ut(),10<t)){if(mo(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Et(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ka(xr.bind(null,e,Rt,En),t);break}xr(e,Rt,En);break;case 4:if(Yn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var i=31-an(r);l=1<<i,i=t[i],i>s&&(s=i),r&=~l}if(r=s,r=ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*mv(r/1960))-r,10<r){e.timeoutHandle=ka(xr.bind(null,e,Rt,En),r);break}xr(e,Rt,En);break;case 5:xr(e,Rt,En);break;default:throw Error(Z(329))}}}return Tt(e,ut()),e.callbackNode===n?zh.bind(null,e):null}function Wa(e,t){var n=Gs;return e.current.memoizedState.isDehydrated&&(kr(e,t).flags|=256),e=zo(e,t),e!==2&&(t=Rt,Rt=n,t!==null&&Ha(t)),e}function Ha(e){Rt===null?Rt=e:Rt.push.apply(Rt,e)}function gv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],l=s.getSnapshot;s=s.value;try{if(!un(l(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Yn(e,t){for(t&=~Yc,t&=~ni,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-an(t),r=1<<n;e[n]=-1,t&=~r}}function $d(e){if(Ve&6)throw Error(Z(327));ss();var t=mo(e,0);if(!(t&1))return Tt(e,ut()),null;var n=zo(e,t);if(e.tag!==0&&n===2){var r=ga(e);r!==0&&(t=r,n=Wa(e,r))}if(n===1)throw n=fl,kr(e,0),Yn(e,t),Tt(e,ut()),n;if(n===6)throw Error(Z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xr(e,Rt,En),Tt(e,ut()),null}function Xc(e,t){var n=Ve;Ve|=1;try{return e(t)}finally{Ve=n,Ve===0&&(fs=ut()+500,Jo&&mr())}}function Rr(e){Xn!==null&&Xn.tag===0&&!(Ve&6)&&ss();var t=Ve;Ve|=1;var n=Jt.transition,r=Qe;try{if(Jt.transition=null,Qe=1,e)return e()}finally{Qe=r,Jt.transition=n,Ve=t,!(Ve&6)&&mr()}}function Jc(){$t=Jr.current,Je(Jr)}function kr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Gy(n)),dt!==null)for(n=dt.return;n!==null;){var r=n;switch(Ic(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&wo();break;case 3:us(),Je(zt),Je(Ct),Bc();break;case 5:Dc(r);break;case 4:us();break;case 13:Je(rt);break;case 19:Je(rt);break;case 10:Mc(r.type._context);break;case 22:case 23:Jc()}n=n.return}if(gt=e,dt=e=or(e.current,null),xt=$t=t,ht=0,fl=null,Yc=ni=_r=0,Rt=Gs=null,jr!==null){for(t=0;t<jr.length;t++)if(n=jr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,l=n.pending;if(l!==null){var i=l.next;l.next=s,r.next=i}n.pending=r}jr=null}return e}function Ah(e,t){do{var n=dt;try{if(Tc(),ro.current=Po,Lo){for(var r=st.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Lo=!1}if(Pr=0,mt=pt=st=null,Ws=!1,cl=0,Qc.current=null,n===null||n.return===null){ht=1,fl=t,dt=null;break}e:{var l=e,i=n.return,c=n,u=t;if(t=xt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,m=c,y=m.tag;if(!(m.mode&1)&&(y===0||y===11||y===15)){var g=m.alternate;g?(m.updateQueue=g.updateQueue,m.memoizedState=g.memoizedState,m.lanes=g.lanes):(m.updateQueue=null,m.memoizedState=null)}var x=kd(i);if(x!==null){x.flags&=-257,Cd(x,i,c,l,t),x.mode&1&&Nd(l,d,t),t=x,u=d;var w=t.updateQueue;if(w===null){var j=new Set;j.add(u),t.updateQueue=j}else w.add(u);break e}else{if(!(t&1)){Nd(l,d,t),Zc();break e}u=Error(Z(426))}}else if(et&&c.mode&1){var S=kd(i);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Cd(S,i,c,l,t),zc(ds(u,c));break e}}l=u=ds(u,c),ht!==4&&(ht=2),Gs===null?Gs=[l]:Gs.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var h=yh(l,u,t);yd(l,h);break e;case 1:c=u;var f=l.type,p=l.stateNode;if(!(l.flags&128)&&(typeof f.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(sr===null||!sr.has(p)))){l.flags|=65536,t&=-t,l.lanes|=t;var v=vh(l,c,t);yd(l,v);break e}}l=l.return}while(l!==null)}$h(n)}catch(k){t=k,dt===n&&n!==null&&(dt=n=n.return);continue}break}while(!0)}function Th(){var e=_o.current;return _o.current=Po,e===null?Po:e}function Zc(){(ht===0||ht===3||ht===2)&&(ht=4),gt===null||!(_r&268435455)&&!(ni&268435455)||Yn(gt,xt)}function zo(e,t){var n=Ve;Ve|=2;var r=Th();(gt!==e||xt!==t)&&(En=null,kr(e,t));do try{yv();break}catch(s){Ah(e,s)}while(!0);if(Tc(),Ve=n,_o.current=r,dt!==null)throw Error(Z(261));return gt=null,xt=0,ht}function yv(){for(;dt!==null;)Mh(dt)}function vv(){for(;dt!==null&&!Vg();)Mh(dt)}function Mh(e){var t=Oh(e.alternate,e,$t);e.memoizedProps=e.pendingProps,t===null?$h(e):dt=t,Qc.current=null}function $h(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=dv(n,t),n!==null){n.flags&=32767,dt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ht=6,dt=null;return}}else if(n=uv(n,t,$t),n!==null){dt=n;return}if(t=t.sibling,t!==null){dt=t;return}dt=t=e}while(t!==null);ht===0&&(ht=5)}function xr(e,t,n){var r=Qe,s=Jt.transition;try{Jt.transition=null,Qe=1,xv(e,t,n,r)}finally{Jt.transition=s,Qe=r}return null}function xv(e,t,n,r){do ss();while(Xn!==null);if(Ve&6)throw Error(Z(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Z(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(Zg(e,l),e===gt&&(dt=gt=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Wl||(Wl=!0,Dh(ho,function(){return ss(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Jt.transition,Jt.transition=null;var i=Qe;Qe=1;var c=Ve;Ve|=4,Qc.current=null,pv(e,n),Rh(n,e),Oy(ja),go=!!Sa,ja=Sa=null,e.current=n,hv(n),Wg(),Ve=c,Qe=i,Jt.transition=l}else e.current=n;if(Wl&&(Wl=!1,Xn=e,Io=s),l=e.pendingLanes,l===0&&(sr=null),Kg(n.stateNode),Tt(e,ut()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ro)throw Ro=!1,e=Ua,Ua=null,e;return Io&1&&e.tag!==0&&ss(),l=e.pendingLanes,l&1?e===Va?Ks++:(Ks=0,Va=e):Ks=0,mr(),null}function ss(){if(Xn!==null){var e=yp(Io),t=Jt.transition,n=Qe;try{if(Jt.transition=null,Qe=16>e?16:e,Xn===null)var r=!1;else{if(e=Xn,Xn=null,Io=0,Ve&6)throw Error(Z(331));var s=Ve;for(Ve|=4,ge=e.current;ge!==null;){var l=ge,i=l.child;if(ge.flags&16){var c=l.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(ge=d;ge!==null;){var m=ge;switch(m.tag){case 0:case 11:case 15:Hs(8,m,l)}var y=m.child;if(y!==null)y.return=m,ge=y;else for(;ge!==null;){m=ge;var g=m.sibling,x=m.return;if(Lh(m),m===d){ge=null;break}if(g!==null){g.return=x,ge=g;break}ge=x}}}var w=l.alternate;if(w!==null){var j=w.child;if(j!==null){w.child=null;do{var S=j.sibling;j.sibling=null,j=S}while(j!==null)}}ge=l}}if(l.subtreeFlags&2064&&i!==null)i.return=l,ge=i;else e:for(;ge!==null;){if(l=ge,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Hs(9,l,l.return)}var h=l.sibling;if(h!==null){h.return=l.return,ge=h;break e}ge=l.return}}var f=e.current;for(ge=f;ge!==null;){i=ge;var p=i.child;if(i.subtreeFlags&2064&&p!==null)p.return=i,ge=p;else e:for(i=f;ge!==null;){if(c=ge,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:ti(9,c)}}catch(k){at(c,c.return,k)}if(c===i){ge=null;break e}var v=c.sibling;if(v!==null){v.return=c.return,ge=v;break e}ge=c.return}}if(Ve=s,mr(),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(Ko,e)}catch{}r=!0}return r}finally{Qe=n,Jt.transition=t}}return!1}function Fd(e,t,n){t=ds(n,t),t=yh(e,t,1),e=rr(e,t,1),t=Et(),e!==null&&(vl(e,1,t),Tt(e,t))}function at(e,t,n){if(e.tag===3)Fd(e,e,n);else for(;t!==null;){if(t.tag===3){Fd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(sr===null||!sr.has(r))){e=ds(n,e),e=vh(t,e,1),t=rr(t,e,1),e=Et(),t!==null&&(vl(t,1,e),Tt(t,e));break}}t=t.return}}function wv(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Et(),e.pingedLanes|=e.suspendedLanes&n,gt===e&&(xt&n)===n&&(ht===4||ht===3&&(xt&130023424)===xt&&500>ut()-qc?kr(e,0):Yc|=n),Tt(e,t)}function Fh(e,t){t===0&&(e.mode&1?(t=Al,Al<<=1,!(Al&130023424)&&(Al=4194304)):t=1);var n=Et();e=Fn(e,t),e!==null&&(vl(e,t,n),Tt(e,n))}function Sv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Fh(e,n)}function jv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(t),Fh(e,n)}var Oh;Oh=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||zt.current)It=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return It=!1,cv(e,t,n);It=!!(e.flags&131072)}else It=!1,et&&t.flags&1048576&&Vp(t,No,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;lo(e,t),e=t.pendingProps;var s=is(t,Ct.current);rs(t,n),s=Vc(null,t,r,e,s,n);var l=Wc();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,At(r)?(l=!0,So(t)):l=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Fc(t),s.updater=ei,t.stateNode=s,s._reactInternals=t,Ra(t,r,e,n),t=Aa(null,t,r,!0,l,n)):(t.tag=0,et&&l&&Rc(t),bt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(lo(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=kv(r),e=sn(r,e),s){case 0:t=za(null,t,r,e,n);break e;case 1:t=Ld(null,t,r,e,n);break e;case 11:t=bd(null,t,r,e,n);break e;case 14:t=Ed(null,t,r,sn(r.type,e),n);break e}throw Error(Z(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),za(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),Ld(e,t,r,s,n);case 3:e:{if(jh(t),e===null)throw Error(Z(387));r=t.pendingProps,l=t.memoizedState,s=l.element,Yp(e,t),bo(t,r,null,n);var i=t.memoizedState;if(r=i.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){s=ds(Error(Z(423)),t),t=Pd(e,t,r,n,s);break e}else if(r!==s){s=ds(Error(Z(424)),t),t=Pd(e,t,r,n,s);break e}else for(Ot=nr(t.stateNode.containerInfo.firstChild),Dt=t,et=!0,on=null,n=Kp(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(as(),r===s){t=On(e,t,n);break e}bt(e,t,r,n)}t=t.child}return t;case 5:return qp(t),e===null&&La(t),r=t.type,s=t.pendingProps,l=e!==null?e.memoizedProps:null,i=s.children,Na(r,s)?i=null:l!==null&&Na(r,l)&&(t.flags|=32),Sh(e,t),bt(e,t,i,n),t.child;case 6:return e===null&&La(t),null;case 13:return Nh(e,t,n);case 4:return Oc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=cs(t,null,r,n):bt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),bd(e,t,r,s,n);case 7:return bt(e,t,t.pendingProps,n),t.child;case 8:return bt(e,t,t.pendingProps.children,n),t.child;case 12:return bt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,l=t.memoizedProps,i=s.value,qe(ko,r._currentValue),r._currentValue=i,l!==null)if(un(l.value,i)){if(l.children===s.children&&!zt.current){t=On(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var c=l.dependencies;if(c!==null){i=l.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(l.tag===1){u=An(-1,n&-n),u.tag=2;var d=l.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?u.next=u:(u.next=m.next,m.next=u),d.pending=u}}l.lanes|=n,u=l.alternate,u!==null&&(u.lanes|=n),Pa(l.return,n,t),c.lanes|=n;break}u=u.next}}else if(l.tag===10)i=l.type===t.type?null:l.child;else if(l.tag===18){if(i=l.return,i===null)throw Error(Z(341));i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Pa(i,n,t),i=l.sibling}else i=l.child;if(i!==null)i.return=l;else for(i=l;i!==null;){if(i===t){i=null;break}if(l=i.sibling,l!==null){l.return=i.return,i=l;break}i=i.return}l=i}bt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,rs(t,n),s=Zt(s),r=r(s),t.flags|=1,bt(e,t,r,n),t.child;case 14:return r=t.type,s=sn(r,t.pendingProps),s=sn(r.type,s),Ed(e,t,r,s,n);case 15:return xh(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:sn(r,s),lo(e,t),t.tag=1,At(r)?(e=!0,So(t)):e=!1,rs(t,n),gh(t,r,s),Ra(t,r,s,n),Aa(null,t,r,!0,e,n);case 19:return kh(e,t,n);case 22:return wh(e,t,n)}throw Error(Z(156,t.tag))};function Dh(e,t){return pp(e,t)}function Nv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(e,t,n,r){return new Nv(e,t,n,r)}function eu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function kv(e){if(typeof e=="function")return eu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xc)return 11;if(e===wc)return 14}return 2}function or(e,t){var n=e.alternate;return n===null?(n=Xt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ao(e,t,n,r,s,l){var i=2;if(r=e,typeof e=="function")eu(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ur:return Cr(n.children,s,l,t);case vc:i=8,s|=8;break;case ta:return e=Xt(12,n,t,s|2),e.elementType=ta,e.lanes=l,e;case na:return e=Xt(13,n,t,s),e.elementType=na,e.lanes=l,e;case ra:return e=Xt(19,n,t,s),e.elementType=ra,e.lanes=l,e;case qf:return ri(n,s,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Qf:i=10;break e;case Yf:i=9;break e;case xc:i=11;break e;case wc:i=14;break e;case Gn:i=16,r=null;break e}throw Error(Z(130,e==null?e:typeof e,""))}return t=Xt(i,n,t,s),t.elementType=e,t.type=r,t.lanes=l,t}function Cr(e,t,n,r){return e=Xt(7,e,r,t),e.lanes=n,e}function ri(e,t,n,r){return e=Xt(22,e,r,t),e.elementType=qf,e.lanes=n,e.stateNode={isHidden:!1},e}function Vi(e,t,n){return e=Xt(6,e,null,t),e.lanes=n,e}function Wi(e,t,n){return t=Xt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Cv(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ki(0),this.expirationTimes=ki(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ki(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function tu(e,t,n,r,s,l,i,c,u){return e=new Cv(e,t,n,c,u),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Xt(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fc(l),e}function bv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Br,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Bh(e){if(!e)return cr;e=e._reactInternals;e:{if(zr(e)!==e||e.tag!==1)throw Error(Z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(At(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Z(171))}if(e.tag===1){var n=e.type;if(At(n))return Bp(e,n,t)}return t}function Uh(e,t,n,r,s,l,i,c,u){return e=tu(n,r,!0,e,s,l,i,c,u),e.context=Bh(null),n=e.current,r=Et(),s=lr(n),l=An(r,s),l.callback=t??null,rr(n,l,s),e.current.lanes=s,vl(e,s,r),Tt(e,r),e}function si(e,t,n,r){var s=t.current,l=Et(),i=lr(s);return n=Bh(n),t.context===null?t.context=n:t.pendingContext=n,t=An(l,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=rr(s,t,i),e!==null&&(cn(e,s,i,l),no(e,s,i)),i}function Ao(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Od(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function nu(e,t){Od(e,t),(e=e.alternate)&&Od(e,t)}function Ev(){return null}var Vh=typeof reportError=="function"?reportError:function(e){console.error(e)};function ru(e){this._internalRoot=e}li.prototype.render=ru.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Z(409));si(e,t,null,null)};li.prototype.unmount=ru.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Rr(function(){si(null,e,null,null)}),t[$n]=null}};function li(e){this._internalRoot=e}li.prototype.unstable_scheduleHydration=function(e){if(e){var t=wp();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Qn.length&&t!==0&&t<Qn[n].priority;n++);Qn.splice(n,0,e),n===0&&jp(e)}};function su(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function oi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Dd(){}function Lv(e,t,n,r,s){if(s){if(typeof r=="function"){var l=r;r=function(){var d=Ao(i);l.call(d)}}var i=Uh(t,r,e,0,null,!1,!1,"",Dd);return e._reactRootContainer=i,e[$n]=i.current,sl(e.nodeType===8?e.parentNode:e),Rr(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=Ao(u);c.call(d)}}var u=tu(e,0,!1,null,null,!1,!1,"",Dd);return e._reactRootContainer=u,e[$n]=u.current,sl(e.nodeType===8?e.parentNode:e),Rr(function(){si(t,u,n,r)}),u}function ii(e,t,n,r,s){var l=n._reactRootContainer;if(l){var i=l;if(typeof s=="function"){var c=s;s=function(){var u=Ao(i);c.call(u)}}si(t,i,e,s)}else i=Lv(n,t,e,s,r);return Ao(i)}vp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ts(t.pendingLanes);n!==0&&(Nc(t,n|1),Tt(t,ut()),!(Ve&6)&&(fs=ut()+500,mr()))}break;case 13:Rr(function(){var r=Fn(e,1);if(r!==null){var s=Et();cn(r,e,1,s)}}),nu(e,1)}};kc=function(e){if(e.tag===13){var t=Fn(e,134217728);if(t!==null){var n=Et();cn(t,e,134217728,n)}nu(e,134217728)}};xp=function(e){if(e.tag===13){var t=lr(e),n=Fn(e,t);if(n!==null){var r=Et();cn(n,e,t,r)}nu(e,t)}};wp=function(){return Qe};Sp=function(e,t){var n=Qe;try{return Qe=e,t()}finally{Qe=n}};pa=function(e,t,n){switch(t){case"input":if(oa(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Xo(r);if(!s)throw Error(Z(90));Jf(r),oa(r,s)}}}break;case"textarea":ep(e,n);break;case"select":t=n.value,t!=null&&Zr(e,!!n.multiple,t,!1)}};ip=Xc;ap=Rr;var Pv={usingClientEntryPoint:!1,Events:[wl,Gr,Xo,lp,op,Xc]},Rs={findFiberByHostInstance:Sr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_v={bundleType:Rs.bundleType,version:Rs.version,rendererPackageName:Rs.rendererPackageName,rendererConfig:Rs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Dn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dp(e),e===null?null:e.stateNode},findFiberByHostInstance:Rs.findFiberByHostInstance||Ev,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hl.isDisabled&&Hl.supportsFiber)try{Ko=Hl.inject(_v),Sn=Hl}catch{}}Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pv;Ut.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!su(t))throw Error(Z(200));return bv(e,t,null,n)};Ut.createRoot=function(e,t){if(!su(e))throw Error(Z(299));var n=!1,r="",s=Vh;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=tu(e,1,!1,null,null,n,!1,r,s),e[$n]=t.current,sl(e.nodeType===8?e.parentNode:e),new ru(t)};Ut.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Z(188)):(e=Object.keys(e).join(","),Error(Z(268,e)));return e=dp(t),e=e===null?null:e.stateNode,e};Ut.flushSync=function(e){return Rr(e)};Ut.hydrate=function(e,t,n){if(!oi(t))throw Error(Z(200));return ii(null,e,t,!0,n)};Ut.hydrateRoot=function(e,t,n){if(!su(e))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,s=!1,l="",i=Vh;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=Uh(t,null,e,1,n??null,s,!1,l,i),e[$n]=t.current,sl(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new li(t)};Ut.render=function(e,t,n){if(!oi(t))throw Error(Z(200));return ii(null,e,t,!1,n)};Ut.unmountComponentAtNode=function(e){if(!oi(e))throw Error(Z(40));return e._reactRootContainer?(Rr(function(){ii(null,null,e,!1,function(){e._reactRootContainer=null,e[$n]=null})}),!0):!1};Ut.unstable_batchedUpdates=Xc;Ut.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!oi(n))throw Error(Z(200));if(e==null||e._reactInternals===void 0)throw Error(Z(38));return ii(e,t,n,!1,r)};Ut.version="18.3.1-next-f1338f8080-20240426";function Wh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Wh)}catch(e){console.error(e)}}Wh(),Wf.exports=Ut;var lu=Wf.exports,Bd=lu;Zi.createRoot=Bd.createRoot,Zi.hydrateRoot=Bd.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pl(){return pl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pl.apply(this,arguments)}var Jn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Jn||(Jn={}));const Ud="popstate";function Rv(e){e===void 0&&(e={});function t(s,l){let{pathname:i="/",search:c="",hash:u=""}=Ar(s.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Ga("",{pathname:i,search:c,hash:u},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(s,l){let i=s.document.querySelector("base"),c="";if(i&&i.getAttribute("href")){let u=s.location.href,d=u.indexOf("#");c=d===-1?u:u.slice(0,d)}return c+"#"+(typeof l=="string"?l:To(l))}function r(s,l){ou(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(l)+")")}return zv(t,n,r,e)}function lt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ou(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Iv(){return Math.random().toString(36).substr(2,8)}function Vd(e,t){return{usr:e.state,key:e.key,idx:t}}function Ga(e,t,n,r){return n===void 0&&(n=null),pl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ar(t):t,{state:n,key:t&&t.key||r||Iv()})}function To(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Ar(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function zv(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:l=!1}=r,i=s.history,c=Jn.Pop,u=null,d=m();d==null&&(d=0,i.replaceState(pl({},i.state,{idx:d}),""));function m(){return(i.state||{idx:null}).idx}function y(){c=Jn.Pop;let S=m(),h=S==null?null:S-d;d=S,u&&u({action:c,location:j.location,delta:h})}function g(S,h){c=Jn.Push;let f=Ga(j.location,S,h);n&&n(f,S),d=m()+1;let p=Vd(f,d),v=j.createHref(f);try{i.pushState(p,"",v)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(v)}l&&u&&u({action:c,location:j.location,delta:1})}function x(S,h){c=Jn.Replace;let f=Ga(j.location,S,h);n&&n(f,S),d=m();let p=Vd(f,d),v=j.createHref(f);i.replaceState(p,"",v),l&&u&&u({action:c,location:j.location,delta:0})}function w(S){let h=s.location.origin!=="null"?s.location.origin:s.location.href,f=typeof S=="string"?S:To(S);return f=f.replace(/ $/,"%20"),lt(h,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,h)}let j={get action(){return c},get location(){return e(s,i)},listen(S){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Ud,y),u=S,()=>{s.removeEventListener(Ud,y),u=null}},createHref(S){return t(s,S)},createURL:w,encodeLocation(S){let h=w(S);return{pathname:h.pathname,search:h.search,hash:h.hash}},push:g,replace:x,go(S){return i.go(S)}};return j}var Wd;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Wd||(Wd={}));function Av(e,t,n){return n===void 0&&(n="/"),Tv(e,t,n)}function Tv(e,t,n,r){let s=typeof t=="string"?Ar(t):t,l=ps(s.pathname||"/",n);if(l==null)return null;let i=Hh(e);Mv(i);let c=null;for(let u=0;c==null&&u<i.length;++u){let d=Kv(l);c=Hv(i[u],d)}return c}function Hh(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(l,i,c)=>{let u={relativePath:c===void 0?l.path||"":c,caseSensitive:l.caseSensitive===!0,childrenIndex:i,route:l};u.relativePath.startsWith("/")&&(lt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=ir([r,u.relativePath]),m=n.concat(u);l.children&&l.children.length>0&&(lt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Hh(l.children,t,m,d)),!(l.path==null&&!l.index)&&t.push({path:d,score:Vv(d,l.index),routesMeta:m})};return e.forEach((l,i)=>{var c;if(l.path===""||!((c=l.path)!=null&&c.includes("?")))s(l,i);else for(let u of Gh(l.path))s(l,i,u)}),t}function Gh(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),l=n.replace(/\?$/,"");if(r.length===0)return s?[l,""]:[l];let i=Gh(r.join("/")),c=[];return c.push(...i.map(u=>u===""?l:[l,u].join("/"))),s&&c.push(...i),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function Mv(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Wv(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const $v=/^:[\w-]+$/,Fv=3,Ov=2,Dv=1,Bv=10,Uv=-2,Hd=e=>e==="*";function Vv(e,t){let n=e.split("/"),r=n.length;return n.some(Hd)&&(r+=Uv),t&&(r+=Ov),n.filter(s=>!Hd(s)).reduce((s,l)=>s+($v.test(l)?Fv:l===""?Dv:Bv),r)}function Wv(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function Hv(e,t,n){let{routesMeta:r}=e,s={},l="/",i=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,m=l==="/"?t:t.slice(l.length)||"/",y=Ka({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},m),g=u.route;if(!y)return null;Object.assign(s,y.params),i.push({params:s,pathname:ir([l,y.pathname]),pathnameBase:Xv(ir([l,y.pathnameBase])),route:g}),y.pathnameBase!=="/"&&(l=ir([l,y.pathnameBase]))}return i}function Ka(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Gv(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let l=s[0],i=l.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((d,m,y)=>{let{paramName:g,isOptional:x}=m;if(g==="*"){let j=c[y]||"";i=l.slice(0,l.length-j.length).replace(/(.)\/+$/,"$1")}const w=c[y];return x&&!w?d[g]=void 0:d[g]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:l,pathnameBase:i,pattern:e}}function Gv(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),ou(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function Kv(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ou(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ps(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Qv(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?Ar(e):e;return{pathname:n?n.startsWith("/")?n:Yv(n,t):t,search:Jv(r),hash:Zv(s)}}function Yv(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Hi(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function qv(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function iu(e,t){let n=qv(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function au(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Ar(e):(s=pl({},e),lt(!s.pathname||!s.pathname.includes("?"),Hi("?","pathname","search",s)),lt(!s.pathname||!s.pathname.includes("#"),Hi("#","pathname","hash",s)),lt(!s.search||!s.search.includes("#"),Hi("#","search","hash",s)));let l=e===""||s.pathname==="",i=l?"/":s.pathname,c;if(i==null)c=n;else{let y=t.length-1;if(!r&&i.startsWith("..")){let g=i.split("/");for(;g[0]==="..";)g.shift(),y-=1;s.pathname=g.join("/")}c=y>=0?t[y]:"/"}let u=Qv(s,c),d=i&&i!=="/"&&i.endsWith("/"),m=(l||i===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||m)&&(u.pathname+="/"),u}const ir=e=>e.join("/").replace(/\/\/+/g,"/"),Xv=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Jv=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Zv=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ex(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Kh=["post","put","patch","delete"];new Set(Kh);const tx=["get",...Kh];new Set(tx);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hl(){return hl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hl.apply(this,arguments)}const ai=a.createContext(null),Qh=a.createContext(null),Bn=a.createContext(null),ci=a.createContext(null),Un=a.createContext({outlet:null,matches:[],isDataRoute:!1}),Yh=a.createContext(null);function nx(e,t){let{relative:n}=t===void 0?{}:t;vs()||lt(!1);let{basename:r,navigator:s}=a.useContext(Bn),{hash:l,pathname:i,search:c}=ui(e,{relative:n}),u=i;return r!=="/"&&(u=i==="/"?r:ir([r,i])),s.createHref({pathname:u,search:c,hash:l})}function vs(){return a.useContext(ci)!=null}function Wt(){return vs()||lt(!1),a.useContext(ci).location}function qh(e){a.useContext(Bn).static||a.useLayoutEffect(e)}function kn(){let{isDataRoute:e}=a.useContext(Un);return e?yx():rx()}function rx(){vs()||lt(!1);let e=a.useContext(ai),{basename:t,future:n,navigator:r}=a.useContext(Bn),{matches:s}=a.useContext(Un),{pathname:l}=Wt(),i=JSON.stringify(iu(s,n.v7_relativeSplatPath)),c=a.useRef(!1);return qh(()=>{c.current=!0}),a.useCallback(function(d,m){if(m===void 0&&(m={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let y=au(d,JSON.parse(i),l,m.relative==="path");e==null&&t!=="/"&&(y.pathname=y.pathname==="/"?t:ir([t,y.pathname])),(m.replace?r.replace:r.push)(y,m.state,m)},[t,r,i,l,e])}const sx=a.createContext(null);function lx(e){let t=a.useContext(Un).outlet;return t&&a.createElement(sx.Provider,{value:e},t)}function ui(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=a.useContext(Bn),{matches:s}=a.useContext(Un),{pathname:l}=Wt(),i=JSON.stringify(iu(s,r.v7_relativeSplatPath));return a.useMemo(()=>au(e,JSON.parse(i),l,n==="path"),[e,i,l,n])}function ox(e,t){return ix(e,t)}function ix(e,t,n,r){vs()||lt(!1);let{navigator:s}=a.useContext(Bn),{matches:l}=a.useContext(Un),i=l[l.length-1],c=i?i.params:{};i&&i.pathname;let u=i?i.pathnameBase:"/";i&&i.route;let d=Wt(),m;if(t){var y;let S=typeof t=="string"?Ar(t):t;u==="/"||(y=S.pathname)!=null&&y.startsWith(u)||lt(!1),m=S}else m=d;let g=m.pathname||"/",x=g;if(u!=="/"){let S=u.replace(/^\//,"").split("/");x="/"+g.replace(/^\//,"").split("/").slice(S.length).join("/")}let w=Av(e,{pathname:x}),j=fx(w&&w.map(S=>Object.assign({},S,{params:Object.assign({},c,S.params),pathname:ir([u,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?u:ir([u,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),l,n,r);return t&&j?a.createElement(ci.Provider,{value:{location:hl({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Jn.Pop}},j):j}function ax(){let e=gx(),t=ex(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),n?a.createElement("pre",{style:s},n):null,null)}const cx=a.createElement(ax,null);class ux extends a.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?a.createElement(Un.Provider,{value:this.props.routeContext},a.createElement(Yh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dx(e){let{routeContext:t,match:n,children:r}=e,s=a.useContext(ai);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),a.createElement(Un.Provider,{value:t},r)}function fx(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var l;if(!n)return null;if(n.errors)e=n.matches;else if((l=r)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,c=(s=n)==null?void 0:s.errors;if(c!=null){let m=i.findIndex(y=>y.route.id&&(c==null?void 0:c[y.route.id])!==void 0);m>=0||lt(!1),i=i.slice(0,Math.min(i.length,m+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<i.length;m++){let y=i[m];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=m),y.route.id){let{loaderData:g,errors:x}=n,w=y.route.loader&&g[y.route.id]===void 0&&(!x||x[y.route.id]===void 0);if(y.route.lazy||w){u=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((m,y,g)=>{let x,w=!1,j=null,S=null;n&&(x=c&&y.route.id?c[y.route.id]:void 0,j=y.route.errorElement||cx,u&&(d<0&&g===0?(vx("route-fallback"),w=!0,S=null):d===g&&(w=!0,S=y.route.hydrateFallbackElement||null)));let h=t.concat(i.slice(0,g+1)),f=()=>{let p;return x?p=j:w?p=S:y.route.Component?p=a.createElement(y.route.Component,null):y.route.element?p=y.route.element:p=m,a.createElement(dx,{match:y,routeContext:{outlet:m,matches:h,isDataRoute:n!=null},children:p})};return n&&(y.route.ErrorBoundary||y.route.errorElement||g===0)?a.createElement(ux,{location:n.location,revalidation:n.revalidation,component:j,error:x,children:f(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):f()},null)}var Xh=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Xh||{}),Jh=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Jh||{});function px(e){let t=a.useContext(ai);return t||lt(!1),t}function hx(e){let t=a.useContext(Qh);return t||lt(!1),t}function mx(e){let t=a.useContext(Un);return t||lt(!1),t}function Zh(e){let t=mx(),n=t.matches[t.matches.length-1];return n.route.id||lt(!1),n.route.id}function gx(){var e;let t=a.useContext(Yh),n=hx(),r=Zh();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function yx(){let{router:e}=px(Xh.UseNavigateStable),t=Zh(Jh.UseNavigateStable),n=a.useRef(!1);return qh(()=>{n.current=!0}),a.useCallback(function(s,l){l===void 0&&(l={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,hl({fromRouteId:t},l)))},[e,t])}const Gd={};function vx(e,t,n){Gd[e]||(Gd[e]=!0)}function xx(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Qa(e){let{to:t,replace:n,state:r,relative:s}=e;vs()||lt(!1);let{future:l,static:i}=a.useContext(Bn),{matches:c}=a.useContext(Un),{pathname:u}=Wt(),d=kn(),m=au(t,iu(c,l.v7_relativeSplatPath),u,s==="path"),y=JSON.stringify(m);return a.useEffect(()=>d(JSON.parse(y),{replace:n,state:r,relative:s}),[d,y,s,n,r]),null}function wx(e){return lx(e.context)}function rn(e){lt(!1)}function Sx(e){let{basename:t="/",children:n=null,location:r,navigationType:s=Jn.Pop,navigator:l,static:i=!1,future:c}=e;vs()&&lt(!1);let u=t.replace(/^\/*/,"/"),d=a.useMemo(()=>({basename:u,navigator:l,static:i,future:hl({v7_relativeSplatPath:!1},c)}),[u,c,l,i]);typeof r=="string"&&(r=Ar(r));let{pathname:m="/",search:y="",hash:g="",state:x=null,key:w="default"}=r,j=a.useMemo(()=>{let S=ps(m,u);return S==null?null:{location:{pathname:S,search:y,hash:g,state:x,key:w},navigationType:s}},[u,m,y,g,x,w,s]);return j==null?null:a.createElement(Bn.Provider,{value:d},a.createElement(ci.Provider,{children:n,value:j}))}function jx(e){let{children:t,location:n}=e;return ox(Ya(t),n)}new Promise(()=>{});function Ya(e,t){t===void 0&&(t=[]);let n=[];return a.Children.forEach(e,(r,s)=>{if(!a.isValidElement(r))return;let l=[...t,s];if(r.type===a.Fragment){n.push.apply(n,Ya(r.props.children,l));return}r.type!==rn&&lt(!1),!r.props.index||!r.props.children||lt(!1);let i={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=Ya(r.props.children,l)),n.push(i)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mo(){return Mo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Mo.apply(this,arguments)}function em(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,l;for(l=0;l<r.length;l++)s=r[l],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Nx(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function kx(e,t){return e.button===0&&(!t||t==="_self")&&!Nx(e)}function qa(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function Cx(e,t){let n=qa(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(l=>{n.append(s,l)})}),n}const bx=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ex=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Lx="6";try{window.__reactRouterVersion=Lx}catch{}const Px=a.createContext({isTransitioning:!1}),_x="startTransition",Kd=wg[_x];function Rx(e){let{basename:t,children:n,future:r,window:s}=e,l=a.useRef();l.current==null&&(l.current=Rv({window:s,v5Compat:!0}));let i=l.current,[c,u]=a.useState({action:i.action,location:i.location}),{v7_startTransition:d}=r||{},m=a.useCallback(y=>{d&&Kd?Kd(()=>u(y)):u(y)},[u,d]);return a.useLayoutEffect(()=>i.listen(m),[i,m]),a.useEffect(()=>xx(r),[r]),a.createElement(Sx,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:i,future:r})}const Ix=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tm=a.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:l,replace:i,state:c,target:u,to:d,preventScrollReset:m,viewTransition:y}=t,g=em(t,bx),{basename:x}=a.useContext(Bn),w,j=!1;if(typeof d=="string"&&zx.test(d)&&(w=d,Ix))try{let p=new URL(window.location.href),v=d.startsWith("//")?new URL(p.protocol+d):new URL(d),k=ps(v.pathname,x);v.origin===p.origin&&k!=null?d=k+v.search+v.hash:j=!0}catch{}let S=nx(d,{relative:s}),h=Tx(d,{replace:i,state:c,target:u,preventScrollReset:m,relative:s,viewTransition:y});function f(p){r&&r(p),p.defaultPrevented||h(p)}return a.createElement("a",Mo({},g,{href:w||S,onClick:j||l?r:f,ref:n,target:u}))}),Fr=a.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:s=!1,className:l="",end:i=!1,style:c,to:u,viewTransition:d,children:m}=t,y=em(t,Ex),g=ui(u,{relative:y.relative}),x=Wt(),w=a.useContext(Qh),{navigator:j,basename:S}=a.useContext(Bn),h=w!=null&&Mx(g)&&d===!0,f=j.encodeLocation?j.encodeLocation(g).pathname:g.pathname,p=x.pathname,v=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;s||(p=p.toLowerCase(),v=v?v.toLowerCase():null,f=f.toLowerCase()),v&&S&&(v=ps(v,S)||v);const k=f!=="/"&&f.endsWith("/")?f.length-1:f.length;let N=p===f||!i&&p.startsWith(f)&&p.charAt(k)==="/",_=v!=null&&(v===f||!i&&v.startsWith(f)&&v.charAt(f.length)==="/"),I={isActive:N,isPending:_,isTransitioning:h},z=N?r:void 0,T;typeof l=="function"?T=l(I):T=[l,N?"active":null,_?"pending":null,h?"transitioning":null].filter(Boolean).join(" ");let O=typeof c=="function"?c(I):c;return a.createElement(tm,Mo({},y,{"aria-current":z,className:T,ref:n,style:O,to:u,viewTransition:d}),typeof m=="function"?m(I):m)});var Xa;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Xa||(Xa={}));var Qd;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Qd||(Qd={}));function Ax(e){let t=a.useContext(ai);return t||lt(!1),t}function Tx(e,t){let{target:n,replace:r,state:s,preventScrollReset:l,relative:i,viewTransition:c}=t===void 0?{}:t,u=kn(),d=Wt(),m=ui(e,{relative:i});return a.useCallback(y=>{if(kx(y,n)){y.preventDefault();let g=r!==void 0?r:To(d)===To(m);u(e,{replace:g,state:s,preventScrollReset:l,relative:i,viewTransition:c})}},[d,u,m,r,s,n,e,l,i,c])}function nm(e){let t=a.useRef(qa(e)),n=a.useRef(!1),r=Wt(),s=a.useMemo(()=>Cx(r.search,n.current?null:t.current),[r.search]),l=kn(),i=a.useCallback((c,u)=>{const d=qa(typeof c=="function"?c(s):c);n.current=!0,l("?"+d,u)},[l,s]);return[s,i]}function Mx(e,t){t===void 0&&(t={});let n=a.useContext(Px);n==null&&lt(!1);let{basename:r}=Ax(Xa.useViewTransitionState),s=ui(e,{relative:t.relative});if(!n.isTransitioning)return!1;let l=ps(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=ps(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Ka(s.pathname,i)!=null||Ka(s.pathname,l)!=null}function rm(){const[e,t]=a.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("cozygen_gallery_pending")==="1"}catch{return!1}});return a.useEffect(()=>{const n=()=>t(!0),r=()=>t(!1),s=l=>{l.key==="cozygen_gallery_pending"&&t(l.newValue==="1")};return window.addEventListener("cozygen:gallery-pending",n),window.addEventListener("cozygen:gallery-viewed",r),window.addEventListener("storage",s),()=>{window.removeEventListener("cozygen:gallery-pending",n),window.removeEventListener("cozygen:gallery-viewed",r),window.removeEventListener("storage",s)}},[]),e}const Ja="cozygen_token",$o="cozygen:auth-expired";function cu(){try{return typeof window>"u"?null:localStorage.getItem(Ja)}catch{return null}}function sm(e){try{if(typeof window>"u")return;e?localStorage.setItem(Ja,e):localStorage.removeItem(Ja)}catch{}}function co(){sm(null)}function xs(){const e=cu();return e?{Authorization:`Bearer ${e}`}:{}}function $x(e={}){if(co(),!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent($o,{detail:e}))}catch{window.dispatchEvent(new Event($o))}}const jl=async(e,t)=>{if(t.status===401){$x({url:e,status:t.status});const r=new Error("unauthorized");throw r.unauthorized=!0,r.status=401,r}if(!t.ok)throw new Error(`${e} failed`);return(t.headers.get("content-type")||"").includes("application/json")?t.json():t.text()},gr=async(e,t={})=>{const{signal:n}=t,r=await fetch(e,{headers:{...xs()},credentials:"include",signal:n});return jl(e,r)},ws=async(e,t,n={})=>{const{signal:r}=n,s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...xs()},body:JSON.stringify(t),credentials:"include",signal:r});return jl(e,s)};async function Fx(e={}){return gr("/cozygen/workflows",e)}async function Ox(e,t={}){return gr(`/cozygen/workflows/${encodeURIComponent(e)}`,t)}async function Za(e,t={}){const{refresh:n=!1,cacheBust:r="",...s}=t||{},l=new URLSearchParams({type:String(e||"")});return n&&l.set("refresh","1"),r&&l.set("cache_bust",String(r)),gr(`/cozygen/get_choices?${l.toString()}`,s)}async function uu(e){const t=await fetch("/prompt",{method:"POST",headers:{"Content-Type":"application/json",...xs()},body:JSON.stringify(e),credentials:"include"});return jl("/prompt",t)}async function Dx(e){const t=new FormData;t.append("image",e);const n=await fetch("/cozygen/upload_image",{method:"POST",headers:{...xs()},body:t,credentials:"include"});return jl("/cozygen/upload_image",n)}async function lm(e="",t=1,n=50,r=!1,s=!1,l="all",i="",c={}){const{includeMeta:u=!1,...d}=c||{},m=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),show_hidden:r?"1":"0",recursive:s?"1":"0",kind:l});return u&&m.set("include_meta","1"),i&&m.set("cache_bust",String(i)),gr(`/cozygen/api/gallery?${m.toString()}`,d)}async function Bx({filename:e="",subfolder:t=""}={},n={}){const r=new URLSearchParams({filename:String(e||""),subfolder:String(t||"")}),s=await fetch(`/cozygen/api/gallery/prompt?${r.toString()}`,{headers:{...xs()},credentials:"include",signal:n==null?void 0:n.signal}),i=(s.headers.get("content-type")||"").includes("application/json")?await s.json():await s.text();if(!s.ok){const c=new Error((i==null?void 0:i.error)||"Prompt metadata not found");throw c.status=s.status,c.payload=i,c}return i}async function Ux(){return gr("/cozygen/api/aliases")}async function Vx(e){return ws("/cozygen/api/aliases",e||{})}async function om(e={}){return gr("/cozygen/api/tags/categories",e)}async function Fo({q:e="",category:t="",sort:n="count",limit:r=80,offset:s=0}={},l={}){const i=new URLSearchParams({q:String(e||""),category:String(t||""),sort:String(n||"count"),limit:String(r||80),offset:String(s||0)});return gr(`/cozygen/api/tags/search?${i.toString()}`,l)}async function Gi(e=[],t={}){return ws("/cozygen/api/tags/validate",{tags:Array.isArray(e)?e:[]},t)}async function Wx(e,t={}){const n=new URLSearchParams;return e&&n.set("workflow",e),gr(`/cozygen/api/workflow_presets?${n.toString()}`,t)}async function Hx(e,t,n={}){return ws("/cozygen/api/workflow_presets",{workflow:e,preset:t},n)}async function Gx(e,t,n={}){return ws("/cozygen/api/workflow_presets",{workflow:e,delete:t},n)}async function Kx(e,t){return ws("/cozygen/api/login",{username:e,password:t})}async function Qx(){return fetch("/cozygen/api/auth_status",{headers:{...xs()},credentials:"include"}).then(e=>jl("/cozygen/api/auth_status",e))}async function Yx(){return ws("/cozygen/api/clear_cache",{})}const qx=30*60*1e3,Yd="cozygen_idle_logout",im=a.createContext(null);function Xx({children:e}){const[t,n]=a.useState(!1),[r,s]=a.useState(null),[l,i]=a.useState(!1),c=a.useRef(null),u=a.useCallback(async()=>{if(!cu()){s(null),i(!1),n(!0);return}try{const x=await Qx();s((x==null?void 0:x.user)||null),i(!!(x!=null&&x.default_credentials))}catch{co(),s(null),i(!1)}finally{n(!0)}},[]);a.useEffect(()=>{u()},[u]);const d=a.useCallback(async(g,x)=>{const w=await Kx(g,x);sm((w==null?void 0:w.token)||""),s((w==null?void 0:w.user)||g),i(!!(w!=null&&w.default_credentials));try{localStorage.removeItem(Yd)}catch{}return w},[]),m=a.useCallback(()=>{co(),s(null),i(!1)},[]);a.useEffect(()=>{if(typeof window>"u")return;const g=()=>{m(),n(!0)};return window.addEventListener($o,g),()=>window.removeEventListener($o,g)},[m]),a.useEffect(()=>{if(!t)return;const g=()=>{c.current&&clearTimeout(c.current);const w=setTimeout(()=>{co(),s(null),i(!1);try{localStorage.setItem(Yd,"1")}catch{}window.location.hash="#/login"},qx);c.current=w};g();const x=["pointerdown","keydown","visibilitychange"];return x.forEach(w=>window.addEventListener(w,g,{passive:!0})),()=>{c.current&&(clearTimeout(c.current),c.current=null),x.forEach(w=>window.removeEventListener(w,g))}},[t]);const y=a.useMemo(()=>({ready:t,user:r,authed:!!r,defaultCreds:l,login:d,logout:m,refresh:u}),[t,r,l,d,m,u]);return o.jsx(im.Provider,{value:y,children:e})}function di(){const e=a.useContext(im);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function Jx({children:e}){return o.jsx(Xx,{children:e})}const am="cozygen_last_render_payload";function cm(e){if(e)try{if(typeof window>"u")return;window.localStorage.setItem(am,JSON.stringify(e))}catch{}}function um(){try{if(typeof window>"u")return null;const e=window.localStorage.getItem(am);return e?JSON.parse(e):null}catch{return null}}async function dm(){const e=um();if(!e||!e.workflow)return{success:!1,error:"No previous render to repeat"};try{return window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!0}})),await uu({prompt:e.workflow}),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),{success:!0}}catch(t){return console.error("Failed to requeue prompt",t),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),t!=null&&t.unauthorized?(window.location.hash="#/login",{success:!1,error:"Session expired"}):{success:!1,error:"Failed to queue prompt"}}}function fm(){const e=um();return!!(e&&e.workflow)}function fi(e,t=!1){const n=()=>typeof window>"u"||!window.matchMedia?t:window.matchMedia(e).matches,[r,s]=a.useState(n);return a.useEffect(()=>{if(typeof window>"u"||!window.matchMedia)return;const l=window.matchMedia(e),i=()=>s(l.matches);return i(),typeof l.addEventListener=="function"?(l.addEventListener("change",i),()=>l.removeEventListener("change",i)):(l.addListener(i),()=>l.removeListener(i))},[e]),r}const pm=({size:e=32,className:t=""})=>o.jsxs("svg",{width:e,height:e,viewBox:"0 0 32 32",fill:"none",className:t,"aria-hidden":"true",children:[o.jsx("path",{d:"M8 24L20 4",stroke:"url(#logo-gradient)",strokeWidth:"3",strokeLinecap:"round"}),o.jsx("path",{d:"M6 26C6 26 7 24 8 24C9 24 10 25 8 27C6 29 4 28 6 26Z",fill:"url(#logo-warm)"}),o.jsx("circle",{cx:"22",cy:"8",r:"2",fill:"url(#logo-spark)"}),o.jsx("circle",{cx:"26",cy:"12",r:"1.5",fill:"url(#logo-spark)",opacity:"0.8"}),o.jsx("circle",{cx:"24",cy:"16",r:"1",fill:"url(#logo-spark)",opacity:"0.6"}),o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"logo-gradient",x1:"8",y1:"24",x2:"20",y2:"4",gradientUnits:"userSpaceOnUse",children:[o.jsx("stop",{stopColor:"#FF9F7A"}),o.jsx("stop",{offset:"0.5",stopColor:"#9F8CFF"}),o.jsx("stop",{offset:"1",stopColor:"#44E1C5"})]}),o.jsxs("linearGradient",{id:"logo-warm",x1:"4",y1:"24",x2:"10",y2:"28",gradientUnits:"userSpaceOnUse",children:[o.jsx("stop",{stopColor:"#FF9F7A"}),o.jsx("stop",{offset:"1",stopColor:"#FFD666"})]}),o.jsxs("radialGradient",{id:"logo-spark",cx:"0.3",cy:"0.3",r:"0.7",children:[o.jsx("stop",{stopColor:"#FFFFFF"}),o.jsx("stop",{offset:"0.5",stopColor:"#44E1C5"}),o.jsx("stop",{offset:"1",stopColor:"#9F8CFF"})]})]})]}),nt=({children:e,size:t=16,className:n="",...r})=>o.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,"aria-hidden":"true",...r,children:e}),Zx=e=>o.jsxs(nt,{...e,children:[o.jsx("path",{d:"M3 10l9-7 9 7"}),o.jsx("path",{d:"M5 10v10h14V10"}),o.jsx("path",{d:"M9 20v-6h6v6"})]}),du=e=>o.jsxs(nt,{...e,children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor",stroke:"none"}),o.jsx("path",{d:"M21 15l-5-5L5 21"})]}),ur=e=>o.jsxs(nt,{...e,children:[o.jsx("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"}),o.jsx("line",{x1:"7",y1:"7",x2:"7.01",y2:"7",strokeWidth:"3"})]}),Nl=e=>o.jsxs(nt,{...e,children:[o.jsx("path",{d:"M14 3H4a2 2 0 00-2 2v10l6 6h10a2 2 0 002-2V9l-6-6z"}),o.jsx("path",{d:"M14 3v6h6"}),o.jsx("path",{d:"M7 7h5"}),o.jsx("path",{d:"M7 11h7"})]}),fu=e=>o.jsx(nt,{...e,children:o.jsx("path",{d:"M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"})}),hm=e=>o.jsx(nt,{...e,children:o.jsx("polygon",{points:"5 3 19 12 5 21 5 3",fill:"currentColor",stroke:"none"})}),qd=e=>o.jsxs(nt,{...e,children:[o.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"}),o.jsx("polyline",{points:"16 17 21 12 16 7"}),o.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),pu=e=>o.jsxs(nt,{...e,children:[o.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),o.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),o.jsx("line",{x1:"15",y1:"9",x2:"15",y2:"15"}),o.jsx("circle",{cx:"9",cy:"12",r:"1.5",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"15",cy:"10",r:"1.5",fill:"currentColor",stroke:"none"})]}),ew=e=>o.jsxs(nt,{...e,children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),o.jsx("circle",{cx:"12",cy:"12",r:"4"}),o.jsx("line",{x1:"3",y1:"9",x2:"6",y2:"9"})]}),ec=e=>o.jsxs(nt,{...e,children:[o.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"}),o.jsx("path",{d:"M2 10h20"})]}),Xd=e=>o.jsx(nt,{...e,children:o.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"})}),Jd=e=>o.jsxs(nt,{...e,children:[o.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),o.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Zd=e=>o.jsxs(nt,{...e,children:[o.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),o.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),ef=e=>o.jsx(nt,{...e,children:o.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),tf=e=>o.jsxs(nt,{...e,children:[o.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),o.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),tc=e=>o.jsxs(nt,{...e,children:[o.jsx("polyline",{points:"23 4 23 10 17 10"}),o.jsx("path",{d:"M20.49 15a9 9 0 11-2.12-9.36L23 10"})]}),mm=e=>o.jsx(nt,{...e,children:o.jsx("polyline",{points:"15 18 9 12 15 6"})}),pi=e=>o.jsx(nt,{...e,children:o.jsx("polyline",{points:"9 18 15 12 9 6"})}),nc=e=>o.jsxs(nt,{...e,children:[o.jsx("circle",{cx:"9",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"15",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"9",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"9",cy:"18",r:"1",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"15",cy:"18",r:"1",fill:"currentColor",stroke:"none"})]}),dr=e=>o.jsxs(nt,{...e,children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),nf=e=>o.jsxs(nt,{...e,children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",strokeDasharray:"4 2"}),o.jsx("line",{x1:"9",y1:"12",x2:"15",y2:"12"})]}),tw=e=>o.jsxs(nt,{...e,children:[o.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),o.jsx("polyline",{points:"5 12 12 5 19 12"})]}),nw=e=>o.jsxs(nt,{...e,children:[o.jsx("circle",{cx:"6",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"12",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),o.jsx("circle",{cx:"18",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"})]}),rw=e=>o.jsxs(nt,{...e,children:[o.jsx("rect",{x:"9",y:"9",width:"10",height:"10",rx:"2"}),o.jsx("path",{d:"M7 15H6a2 2 0 01-2-2V6a2 2 0 012-2h7"})]}),rf=[{to:"/studio",label:"Studio",Icon:Zx,end:!0},{to:"/controls",label:"Controls",Icon:pu}],sw=[{to:"/gallery",label:"Gallery",Icon:du},{to:"/tags",label:"Tag Library",Icon:ur},{to:"/aliases",label:"Aliases",Icon:Nl}],Is=({isActive:e})=>["slim-nav-link btn-touch",e?"is-active":null].filter(Boolean).join(" ");function lw({isMobileAlignedNav:e=!1}){const[t,n]=a.useState(!1),{pathname:r}=Wt(),s=rm(),{logout:l,user:i}=di(),[c,u]=a.useState(!1),d=fi("(min-width: 768px)"),m=a.useRef(null),y=a.useRef(null),g=()=>n(N=>!N),x=()=>n(!1),w=r==="/login",j=d&&!e,S=!w&&j,h=j,f=!d||e;a.useEffect(()=>{const N=_=>{var z;const I=!!((z=_==null?void 0:_.detail)!=null&&z.active);u(I)};return window.addEventListener("cozygen:render-state",N),()=>window.removeEventListener("cozygen:render-state",N)},[]),a.useEffect(()=>{if(!t)return;const N=_=>{m.current&&!m.current.contains(_.target)&&y.current&&!y.current.contains(_.target)&&x()};return document.addEventListener("mousedown",N),document.addEventListener("touchstart",N),()=>{document.removeEventListener("mousedown",N),document.removeEventListener("touchstart",N)}},[t]);const p=async()=>{if(c)return;if(r==="/controls"||r==="/compose"){try{window.dispatchEvent(new Event("cozygen:request-render"))}catch{}return}if(!fm()){alert("No previous render found yet. Render once from Studio first.");return}u(!0);const I=await dm();u(!1),I!=null&&I.success||alert((I==null?void 0:I.error)||"Failed to render.")},v=()=>{try{l()}catch{}window.location.hash="#/login"},k=[...rf,...sw];return o.jsxs("header",{className:"top-bar",children:[o.jsx("div",{className:"top-bar-shell",children:o.jsxs("div",{className:"brand-row",children:[o.jsxs(tm,{to:"/studio",className:"brand-mark",onClick:x,children:[o.jsx(pm,{size:28,className:"brand-logo"}),o.jsx("span",{className:"brand-text",children:"CozyGen"})]}),j?o.jsx("nav",{className:"desktop-nav","aria-label":"Main navigation",children:k.map(N=>o.jsx(Fr,{to:N.to,end:N.end,className:Is,children:o.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[o.jsx(N.Icon,{size:16}),o.jsx("span",{children:N.label}),N.to==="/gallery"&&s?o.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})},N.to))}):null,o.jsx("div",{className:"flex-1"}),S?o.jsxs("button",{type:"button",className:`desktop-render-btn ${c?"is-busy":""}`,onClick:p,title:c?"Rendering":"Render","aria-busy":c,"aria-disabled":c,disabled:c,children:[o.jsx("span",{className:"render-icon",children:c?o.jsx("span",{className:"render-spinner","aria-hidden":"true"}):o.jsx(hm,{size:16})}),o.jsx("span",{className:"render-label",children:c?"Rendering":"Render"})]}):null,h?o.jsxs("button",{type:"button",className:"desktop-logout-btn",onClick:v,title:"Sign out",children:[o.jsx("span",{className:"logout-icon",children:o.jsx(qd,{size:16})}),o.jsx("span",{className:"logout-label",children:"Logout"}),i?o.jsxs("span",{className:"logout-user",children:["@",i]}):null]}):null,f?o.jsx("button",{ref:y,type:"button",className:`mobile-menu-toggle btn-touch ${t?"is-active":""}`,onClick:g,"aria-expanded":t,"aria-controls":"cozygen-mobile-nav","aria-label":t?"Close menu":"Open menu",children:o.jsx("span",{className:"mobile-menu-icon",children:o.jsx("span",{})})}):null]})}),f?o.jsxs("div",{ref:m,id:"cozygen-mobile-nav",className:`mobile-nav-drawer ${t?"is-open":""}`,role:"menu",children:[o.jsxs("div",{className:"mobile-nav-section",children:[rf.map(N=>o.jsx(Fr,{to:N.to,end:N.end,className:Is,onClick:x,role:"menuitem",children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(N.Icon,{size:16}),o.jsx("span",{children:N.label})]})},N.to)),o.jsx(Fr,{to:"/gallery",className:Is,onClick:x,role:"menuitem",children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(du,{size:16}),o.jsx("span",{children:"Gallery"}),s?o.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})})]}),o.jsxs("div",{className:"mobile-nav-section secondary",children:[o.jsx(Fr,{to:"/tags",className:Is,onClick:x,role:"menuitem",children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(ur,{size:16}),o.jsx("span",{children:"Tag Library"})]})}),o.jsx(Fr,{to:"/aliases",className:Is,onClick:x,role:"menuitem",children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(Nl,{size:16}),o.jsx("span",{children:"Aliases"})]})}),o.jsx("button",{type:"button",className:"slim-nav-link btn-touch text-left",onClick:()=>{x(),v()},role:"menuitem",children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(qd,{size:16}),o.jsx("span",{children:"Logout"}),i?o.jsxs("span",{className:"text-[rgba(159,178,215,0.75)] text-xs",children:["@",i]}):null]})})]})]}):null]})}const sf=[{to:"/controls",label:"Controls",Icon:pu},{to:"/compose",label:"Compose",Icon:fu},{to:"/gallery",label:"Gallery",Icon:du}],ow=[{to:"/aliases",label:"Aliases",Icon:Nl},{to:"/tags",label:"Tags",Icon:ur}],iw=({isActive:e})=>["bottom-nav-link",e?"is-active":""].filter(Boolean).join(" ");function aw(){const e=Wt(),t=kn(),n=rm(),[r,s]=Qt.useState(!1),[l,i]=Qt.useState(!1),[c,u]=Qt.useState(!1),[d,m]=Qt.useState({}),y=fi("(min-width: 768px)"),g=Qt.useRef(null),x=Qt.useRef(null),w=e.pathname==="/controls",j=e.pathname==="/compose",S=async()=>{if(!(typeof window>"u")&&!l)if(s(!0),setTimeout(()=>s(!1),400),w||j)try{window.dispatchEvent(new CustomEvent("cozygen:request-render"))}catch{}else{if(!fm())return;const f=await dm();f.success||console.warn("Requeue failed:",f.error)}};Qt.useEffect(()=>{const f=p=>{var k;const v=!!((k=p==null?void 0:p.detail)!=null&&k.active);i(v),v&&(s(!0),setTimeout(()=>s(!1),400))};return window.addEventListener("cozygen:render-state",f),()=>window.removeEventListener("cozygen:render-state",f)},[]),Qt.useEffect(()=>{if(!c||y)return;const f=p=>{g.current&&g.current.contains(p.target)||x.current&&x.current.contains(p.target)||u(!1)};return window.addEventListener("pointerdown",f),()=>window.removeEventListener("pointerdown",f)},[c,y]),Qt.useEffect(()=>{if(!c||y||!x.current)return;const f=x.current.getBoundingClientRect(),p=f.left+f.width/2,v=window.innerHeight-f.top+8;m({left:`${Math.min(window.innerWidth-80,Math.max(40,p))}px`,bottom:`${v}px`,top:"auto"})},[c,y]),Qt.useEffect(()=>{y&&u(!1)},[y]);const h=y?[...sf,...ow]:sf;return o.jsxs(o.Fragment,{children:[o.jsxs("nav",{className:"bottom-nav","aria-label":"Bottom navigation",children:[h.map(f=>o.jsxs(Fr,{to:f.to,end:f.end,className:iw,children:[o.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:o.jsx(f.Icon,{size:20})}),o.jsxs("span",{className:"bottom-nav-label",children:[f.label,f.to==="/gallery"&&n?o.jsx("span",{className:"badge-dot pulse","aria-hidden":"true"}):null]})]},f.to)),y?null:o.jsxs("button",{ref:x,type:"button",className:"bottom-nav-link",onClick:()=>u(f=>!f),"aria-expanded":c,"aria-label":"Open library",children:[o.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:o.jsx(ur,{size:20})}),o.jsx("span",{className:"bottom-nav-label",children:"Library"})]},"library"),o.jsxs("button",{type:"button",className:`bottom-nav-link is-action ${r?"is-flash":""} ${l?"is-rendering":""}`,onClick:S,"aria-label":"Render","aria-busy":l,"aria-disabled":l,disabled:l,children:[o.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:o.jsx(hm,{size:20})}),o.jsx("span",{className:"bottom-nav-label",children:"Render"})]},"render")]}),y?null:o.jsxs("div",{ref:g,className:`library-popover ${c?"is-open":""}`,style:d,children:[o.jsxs("button",{type:"button",className:"library-popover-btn",onClick:()=>{u(!1),t("/aliases")},children:[o.jsx(Nl,{size:18}),o.jsx("span",{children:"Aliases"})]}),o.jsxs("button",{type:"button",className:"library-popover-btn",onClick:()=>{u(!1),t("/tags")},children:[o.jsx(ur,{size:18}),o.jsx("span",{children:"Tags"})]})]})]})}function cw(e,t){if(!t||t<=0)return null;const n=Number(e)||0,r=Number(t)||0,s=Math.round(n/r*100);return Number.isFinite(s)?Math.max(0,Math.min(100,s)):null}function uw({busy:e=!1,progressValue:t=0,progressMax:n=0,statusText:r="Idle",statusPhase:s="idle",primaryLabel:l="Render",onPrimary:i,primaryDisabled:c=!1,onLogs:u,logsLabel:d="Logs"}){const m=cw(t,n),y=s==="queued"?"rgba(255, 143, 112, 0.95)":s==="running"?"rgba(68, 225, 197, 0.95)":s==="finished"?"rgba(92, 255, 154, 0.95)":s==="error"?"rgba(255, 143, 112, 0.95)":"rgba(159, 178, 215, 0.55)",x={idle:"Idle",queued:"Queued",running:"Running",finished:"Finished",error:"Error"}[s]||"Status",w=e||c;return o.jsxs("div",{className:"dock-bar-inner",children:[o.jsx("button",{type:"button",onClick:i,disabled:w,className:"dock-primary-btn",children:e?"Rendering":l}),o.jsxs("div",{className:"dock-status-row",children:[o.jsxs("span",{className:"dock-status-left",children:[o.jsx("span",{className:"dock-status-dot",style:{background:y}}),o.jsx("span",{className:"dock-status-label",children:x})]}),o.jsxs("span",{className:"dock-status-right",children:[m!=null&&e?o.jsxs("span",{className:"dock-progress",children:[o.jsx("span",{className:"dock-progress-bar","aria-hidden":"true",children:o.jsx("span",{className:"dock-progress-fill",style:{width:`${m}%`}})}),o.jsxs("span",{children:[m,"%"]})]}):null,o.jsx("span",{className:"dock-status-text",children:r||(e?"Working":"Idle")}),u?o.jsx("button",{type:"button",className:"dock-logs-btn",onClick:u,children:d}):null]})]})]})}const gm="jpg,jpeg,png,webp,gif,bmp,tif,tiff",hu=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),ym=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);async function Ki({subfolder:e="",page:t=1,perPage:n=50,exts:r=gm,signal:s}={}){const l=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),exts:r}),i=await fetch(`/cozygen/input?${l.toString()}`,{signal:s});if(!i.ok)throw new Error(`Input list failed: ${i.status}`);return i.json()}const Oo=e=>`/cozygen/input/file?path=${encodeURIComponent(e)}`,rc="output::",hi=(e="")=>e.replace(/\\/g,"/").replace(/^\/+/,"").replace(/\/+$/,""),vm=(e="")=>{const t=e.replace(/\\/g,"/").split("/").filter(Boolean);return t[t.length-1]||""},dw=({subfolder:e="",filename:t=""}={})=>{const n=vm(t);if(!n)return"";const r=hi(e);return`${rc}${r}::${n}`},sc=(e="")=>{if(typeof e!="string"||!e.startsWith(rc))return null;const t=e.slice(rc.length);if(!t)return null;const n=t.lastIndexOf("::"),r=n===-1?t:t.slice(n+2);return r?{subfolder:n===-1?"":t.slice(0,n),filename:r}:null},Do=({filename:e="",subfolder:t="",type:n="output"}={})=>{const r=vm(e);return r?`/view?${new URLSearchParams({filename:r,subfolder:hi(t),type:n||"output"}).toString()}`:""},lc=(e="")=>e.split("/").slice(0,-1).join("/"),fw=e=>{if(typeof e!="string"||!e)return e!=null&&e.path?lc(e.path):"";const t=sc(e);return t?hi(t.subfolder):lc(e)},lf=(e=[])=>e.map(t=>{const n=t.rel_path||t.name||"",r=t.name||n||"Untitled",s=!!t.is_dir,l=s?"":Oo(n);return{...t,name:r,rel_path:n,is_dir:s,is_image:!s&&hu(r),is_video:!s&&ym(r),source:"input",preview_url:l}}),pw=(e=[])=>e.map(t=>{const n=t.filename||"",r=t.subfolder||"",s=t.type==="directory",l=s?r||n:[r,n].filter(Boolean).join("/"),i=n||r||l||"Untitled",c=s?"":Do({filename:n,subfolder:r,type:t.type});return{...t,name:i,rel_path:l,is_dir:s,is_image:!s&&hu(n),is_video:!s&&ym(n),source:"output",preview_url:c}}),yr={get(e,t){try{return(typeof window<"u"?JSON.parse(localStorage.getItem(e)):null)??t}catch{return t}},set(e,t){try{typeof window<"u"&&localStorage.setItem(e,JSON.stringify(t))}catch{}}};function hw({input:e,value:t,onFormChange:n}){var G;const r=((G=e==null?void 0:e.inputs)==null?void 0:G.param_name)||"Image Input",s=(e==null?void 0:e.class_type)||"CozyGenImageInput",l=`cg_last_input_cwd::${r}`,i=`cg_last_picker_source::${r}`,[c,u]=a.useState(""),[d,m]=a.useState(!1),[y,g]=a.useState(!1),[x,w]=a.useState(yr.get(l,"")),[j,S]=a.useState(1),[h,f]=a.useState(50),[p,v]=a.useState([]),[k,N]=a.useState(1),[_,I]=a.useState(!1),[z,T]=a.useState(""),[O,ae]=a.useState([]),[q,Se]=a.useState(!0),ve=a.useRef(null),[Q,ce]=a.useState(()=>yr.get(i,"inputs")==="outputs"?"outputs":"inputs"),P=Q,C=a.useCallback($=>{const D=$==="outputs"?"outputs":"inputs";ce(D),yr.set(i,D),w(""),S(1)},[]),L=a.useMemo(()=>{if(c)try{const $=new URL(c,window.location.origin);return($.searchParams.get("path")||$.searchParams.get("filename")||$.pathname.split("/").pop()||"").split("/").pop()||"No file selected."}catch{}if(!t)return"No file selected.";if(typeof t=="string"){const $=sc(t);return $!=null&&$.filename?$.filename.split("/").pop():t.split("/").pop()}return t!=null&&t.path?t.path.split("/").pop():"No file selected."},[c,t]);a.useEffect(()=>{if(typeof t=="string"&&t){const $=sc(t);$!=null&&$.filename?u(Do({filename:$.filename,subfolder:$.subfolder,type:"output"})):u(Oo(t)),m(!1)}else t!=null&&t.url?(u(t.url),m(!1)):(u(""),m(!1))},[t]);const E=a.useCallback(async $=>{const D=await Dx($),le=`/view?filename=${D.filename}&type=input`;u(le),m(!1),yr.set(l,""),s==="CozyGenImageInput"?n(r,D.filename):n(r,{source:"Upload",path:D.filename,url:le})},[s,n,r]),V=a.useCallback(()=>{u(""),m(!1),s==="CozyGenImageInput"?n(r,""):n(r,{source:"Upload",path:"",url:""})},[s,n,r]),Y=a.useCallback(()=>{const D=fw(t)||yr.get(l,"");w(D),S(1),g(!0)},[t]),se=a.useCallback(()=>{g(!1)},[]);a.useEffect(()=>{if(y){if(P!=="inputs"){ae([]);return}(async()=>{try{const $=await Ki({subfolder:"",page:1,perPage:0,exts:""});ae(($.items||[]).filter(D=>D.is_dir))}catch{}})()}},[y,P]),a.useEffect(()=>{if(!y)return;let $=!1;ve.current&&ve.current.abort();const D=new AbortController;ve.current=D;async function le(){I(!0);try{if(P==="outputs"){const ue=await lm(x,j,h,!1,!1,"all","",{signal:D.signal});if($)return;const Pe=pw(ue&&ue.items||[]);$||(v(Pe),N(ue&&ue.total_pages||1))}else{const Pe=await Ki({subfolder:x,page:j,perPage:h,exts:q?gm:"",signal:D.signal}),je=(Pe.items||[]).some(Re=>!Re.is_dir);if(q&&!je){const Re=await Ki({subfolder:x,page:j,perPage:h,exts:"",signal:D.signal});$||(v(lf(Re.items||[])),N(Re.total_pages||1),Se(!1));return}$||(v(lf(Pe.items||[])),N(Pe.total_pages||1))}}catch(ue){if((ue==null?void 0:ue.name)==="AbortError")return;console.error(P==="outputs"?"Failed to load output directory":"Failed to load input directory",ue),$||(v([]),N(1))}finally{$||I(!1)}}return le(),()=>{$=!0,ve.current===D&&(ve.current=null),D.abort()}},[y,x,j,h,q,P]);const re=a.useDeferredValue(z),X=a.useMemo(()=>{const $=re.trim().toLowerCase();let D=p;return q&&(D=D.filter(le=>{if(le.is_dir)return!0;const ue=le.name||le.filename||le.rel_path||"";return hu(String(ue))})),$?D.filter(le=>(le.name||le.filename||le.rel_path||"").toLowerCase().includes($)):D},[p,re,q]),ie=a.useCallback($=>{if(!$)return;const D=typeof $=="object"?$:null;if(((D==null?void 0:D.source)||"inputs")==="output"){const je=dw({subfolder:(D==null?void 0:D.subfolder)||"",filename:(D==null?void 0:D.filename)||(D==null?void 0:D.name)||""});if(!je)return;const Re=(D==null?void 0:D.preview_url)||Do({filename:D==null?void 0:D.filename,subfolder:D==null?void 0:D.subfolder,type:D==null?void 0:D.type});u(Re),m(!1),yr.set(l,hi((D==null?void 0:D.subfolder)||"")),s==="CozyGenImageInput"?n(r,je):n(r,{source:"OutputGallery",path:je,url:Re}),g(!1);return}const ue=typeof $=="string"?$:(D==null?void 0:D.rel_path)||(D==null?void 0:D.path)||"";if(!ue)return;const Pe=(D==null?void 0:D.preview_url)||Oo(ue);u(Pe),m(!1),yr.set(l,lc(ue)),s==="CozyGenImageInput"?n(r,ue):n(r,{source:"Server",path:ue,url:Pe}),g(!1)},[s,n,r]);return{param:r,previewUrl:c,imgReady:d,setImgReady:m,displayName:L,serverOpen:y,openServer:Y,closeServer:se,cwd:x,setCwd:w,page:j,setPage:S,perPage:h,setPerPage:f,totalPages:k,loading:_,search:z,setSearch:T,topDirs:O,imagesOnly:q,setImagesOnly:Se,shownEntries:X,pickerSource:P,setPickerSource:C,handleUpload:E,clearImage:V,selectServer:ie}}function Mt({open:e,onClose:t,title:n,children:r,footer:s,variant:l="sheet",className:i="",contentClassName:c="",shouldCloseOnOverlayClick:u=!0,shouldCloseOnEsc:d=!0}){const m=a.useRef(!1),y=a.useRef(null),g=a.useRef(null),x=S=>S?Array.from(S.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(h=>!h.hasAttribute("disabled")&&h.getAttribute("aria-hidden")!=="true"):[],w=a.useMemo(()=>["bottom-sheet-content",l==="fullscreen"?"is-fullscreen":"is-sheet",c].filter(Boolean).join(" "),[c,l]),j=a.useMemo(()=>["bottom-sheet-overlay",i].filter(Boolean).join(" "),[i]);return a.useEffect(()=>{if(!e||!d)return;const S=h=>{h.key==="Escape"&&(t==null||t())};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[e,t,d]),a.useEffect(()=>{if(!e||typeof document>"u")return;const S=y.current;g.current=document.activeElement;const h=()=>{var k;const v=x(S)[0]||S;(k=v==null?void 0:v.focus)==null||k.call(v)},f=p=>{if(p.key!=="Tab"||!S)return;const v=x(S);if(!v.length){p.preventDefault(),S.focus();return}const k=v[0],N=v[v.length-1],_=document.activeElement;p.shiftKey&&_===k?(p.preventDefault(),N.focus()):!p.shiftKey&&_===N&&(p.preventDefault(),k.focus())};return requestAnimationFrame(h),S==null||S.addEventListener("keydown",f),()=>{var v;S==null||S.removeEventListener("keydown",f);const p=g.current;p&&document.contains(p)&&((v=p.focus)==null||v.call(p))}},[e]),!e||typeof document>"u"?null:lu.createPortal(o.jsx("div",{className:j,role:"presentation",onPointerDown:S=>{m.current=S.target===S.currentTarget},onClick:S=>{u&&m.current&&S.target===S.currentTarget&&(t==null||t())},children:o.jsx("div",{ref:y,className:w,role:"dialog","aria-modal":"true","aria-label":n||"Sheet",onClick:S=>S.stopPropagation(),tabIndex:-1,children:o.jsxs("div",{className:"bottom-sheet-panel",children:[o.jsxs("header",{className:"bottom-sheet-head",children:[o.jsx("div",{className:"bottom-sheet-title",children:n||""}),o.jsx("button",{type:"button",className:"bottom-sheet-close",onClick:t,"aria-label":"Close",children:o.jsx(dr,{size:16})})]}),o.jsx("div",{className:"bottom-sheet-body",children:r}),s?o.jsx("footer",{className:"bottom-sheet-foot",children:s}):null]})})}),document.body)}function mw({items:e=[],value:t,onChange:n,ariaLabel:r,role:s="tablist",className:l="",tabClassName:i="",size:c="md",layout:u="equal",wrap:d=!1}){const m=["segmented-tabs",c==="sm"?"is-compact":"",u==="auto"?"is-auto":"",u==="icon"?"is-icon":"",d?"is-wrap":"",l].filter(Boolean).join(" "),y=s==="tablist"?"tab":"button",g=a.useRef([]);a.useEffect(()=>{g.current=g.current.slice(0,e.length)},[e.length]);const x=a.useMemo(()=>e.map((p,v)=>p.disabled?null:v).filter(p=>p!==null),[e]),w=a.useMemo(()=>e.findIndex(p=>p.key===t&&!p.disabled),[e,t]),j=x.length?x[0]:-1,S=w>=0?w:j,h=p=>{var k;const v=g.current[p];(k=v==null?void 0:v.focus)==null||k.call(v)},f=(p,v)=>{var N;if(!e.length)return p;let k=p;for(let _=0;_<e.length;_+=1)if(k=(k+v+e.length)%e.length,!((N=e[k])!=null&&N.disabled))return k;return p};return o.jsx("div",{className:m,role:s,"aria-label":r,children:e.map((p,v)=>{const k=p.key===t,N=p.label?String(p.label):"";return o.jsxs("button",{type:"button",ref:_=>{g.current[v]=_},role:y,"aria-selected":s==="tablist"?k:void 0,"aria-pressed":s!=="tablist"?k:void 0,"aria-controls":s==="tablist"?p.controls:void 0,className:["segmented-tab",k?"is-active":"",p.icon&&!N?"is-icon":"",p.className||"",i].filter(Boolean).join(" "),onClick:()=>{p.disabled||n==null||n(p.key)},onKeyDown:_=>{if(s!=="tablist"||!["ArrowRight","ArrowLeft","Home","End"].includes(_.key)||(_.preventDefault(),!e.length))return;let I=v;_.key==="Home"?I=x.length?x[0]:I:_.key==="End"?I=x.length?x[x.length-1]:I:_.key==="ArrowRight"?I=f(I,1):_.key==="ArrowLeft"&&(I=f(I,-1));const z=e[I];!z||z.disabled||(n==null||n(z.key),h(I))},disabled:p.disabled,title:p.title||N||p.ariaLabel,"aria-label":p.ariaLabel,tabIndex:s==="tablist"?v===S?0:-1:void 0,children:[p.icon?o.jsx("span",{className:"segmented-tab-icon",children:p.icon}):null,N?o.jsx("span",{className:"segmented-tab-label",children:N}):null,p.badge?o.jsx("span",{className:"segmented-tab-badge",children:p.badge}):null]},p.key)})})}const br=a.memo(mw),gw=(e=[])=>(e||[]).map(t=>typeof t=="string"||typeof t=="number"?{value:t,label:String(t)}:{value:(t==null?void 0:t.value)??(t==null?void 0:t.id)??"",label:(t==null?void 0:t.label)??(t==null?void 0:t.name)??String((t==null?void 0:t.value)??""),disabled:!!(t!=null&&t.disabled)}),yw=(e,t)=>{if(!t)return e;const n=t.trim().toLowerCase();return n?e.filter(r=>{const s=String(r.label||"").toLowerCase(),l=String(r.value||"").toLowerCase();return s.includes(n)||l.includes(n)}):e};function vw({value:e,onChange:t,options:n,children:r,placeholder:s,emptyLabel:l="No matches",disabled:i=!1,size:c="md",className:u="",wrapperClassName:d="",searchable:m=!1,searchPlaceholder:y="Search options...",searchValue:g,onSearchChange:x,searchAriaLabel:w="Search options",...j}){const[S,h]=a.useState(""),f=typeof g=="string"?g:S,p=x||h,v=a.useMemo(()=>gw(n),[n]),k=a.useMemo(()=>m?yw(v,f):v,[v,f,m]),N=["ui-control","ui-select",c==="sm"?"is-compact":"",u].filter(Boolean).join(" "),_=()=>r||(k.length?k.map(z=>o.jsx("option",{value:z.value,disabled:z.disabled,children:z.label},String(z.value))):o.jsx("option",{value:"",disabled:!0,children:l})),I=o.jsxs("select",{...j,className:N,value:e??"",onChange:z=>t==null?void 0:t(z.target.value),disabled:i,children:[s?o.jsx("option",{value:"",children:s}):null,_()]});return m?o.jsxs("div",{className:d,children:[o.jsx("input",{type:"search",value:f,onChange:z=>p(z.target.value),placeholder:y,className:"ui-control ui-input is-compact","aria-label":w,disabled:i}),I]}):I}const tt=a.memo(vw);function xw({open:e,cwd:t,setCwd:n,page:r,setPage:s,perPage:l,setPerPage:i,totalPages:c,topDirs:u,loading:d,imagesOnly:m,setImagesOnly:y,search:g,setSearch:x,shownEntries:w,onSelect:j,onClose:S,pickerSource:h,setPickerSource:f}){if(!e)return null;const p=h||"inputs",v=typeof f=="function",k=()=>{n(""),s(1)},N=O=>{v&&O!==p&&(f(O),n(""),s(1))},_=t.split("/").filter(Boolean),I=p==="outputs"?"Choose output":"Choose input",z=[{key:"",label:"Root"},...u.map(O=>({key:O.rel_path,label:O.name}))],T=O=>{n(O),s(1)};return o.jsx(Mt,{open:e,onClose:S,title:I,variant:"fullscreen",footer:o.jsxs("div",{className:"flex items-center gap-2 w-full",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",disabled:r<=1||d,onClick:()=>s(O=>Math.max(1,O-1)),children:"Prev"}),o.jsxs("div",{className:"text-xs text-center text-[rgba(159,178,215,0.75)] min-w-[92px]",children:[r," / ",c]}),o.jsx("button",{type:"button",className:"ui-button is-muted w-full",disabled:r>=c||d,onClick:()=>s(O=>O<c?O+1:O),children:"Next"})]}),children:o.jsxs("div",{className:"sheet-stack",children:[o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Location"}),o.jsxs("div",{className:"imagepicker-breadcrumb",children:[o.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:k,children:"Root"}),_.map((O,ae)=>{const q=_.slice(0,ae+1).join("/");return o.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:()=>{n(q),s(1)},children:O},q)})]})]}),v?o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Source"}),o.jsx(br,{ariaLabel:"Source",value:p,onChange:N,size:"sm",items:[{key:"inputs",label:"Inputs"},{key:"outputs",label:"Outputs"}]})]}):null,o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Filters"}),o.jsxs("div",{className:"composer-filters",children:[o.jsxs("label",{className:"inline-flex items-center gap-2",children:[o.jsx("input",{type:"checkbox",checked:m,onChange:O=>{y(O.target.checked),s(1)}}),o.jsx("span",{className:"text-sm text-[rgba(159,178,215,0.85)]",children:"Images only"})]}),o.jsx("input",{type:"search",value:g,onChange:O=>x(O.target.value),placeholder:"Search files",className:"sheet-input ui-control ui-input","aria-label":"Search files"}),o.jsx(tt,{className:"sheet-select",value:l,onChange:O=>{const ae=parseInt(O,10)||50;i(ae),s(1)},"aria-label":"Items per page",size:"sm",options:[25,50,100]})]})]}),u.length>0?o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Quick folders"}),o.jsx(br,{ariaLabel:"Quick folders",value:t,onChange:T,size:"sm",layout:"auto",wrap:!0,className:"imagepicker-chips",items:z})]}):null,o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Results"}),d?o.jsxs("div",{className:"sheet-hint",children:["Scanning ",p==="outputs"?"output":"input"," folders"]}):w.length===0?o.jsx("div",{className:"sheet-hint",children:"Nothing here yet. Try a different folder or turn off Images only."}):null,o.jsx("div",{className:"imagepicker-grid",children:!d&&w.map(O=>{const ae=`${O.source||"input"}::${O.rel_path||O.name}`,q=O.is_dir?"":O.preview_url||(O.source==="output"?Do({filename:O.filename,subfolder:O.subfolder,type:O.type}):Oo(O.rel_path||""));return o.jsx("button",{type:"button",className:`imagepicker-item ${O.is_dir?"is-dir":""}`,onClick:()=>{O.is_dir?(n(O.rel_path||""),s(1)):j(O)},children:O.is_dir?o.jsxs("div",{className:"imagepicker-dir-row",children:[o.jsx("div",{className:"imagepicker-dir-dot","aria-hidden":"true"}),o.jsx("div",{className:"imagepicker-name",children:O.name})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"imagepicker-thumb",children:q?o.jsx("img",{className:"imagepicker-img",alt:O.name,src:q}):o.jsx("div",{className:"imagepicker-img is-placeholder"})}),o.jsx("div",{className:"imagepicker-name",children:O.name})]})},ae)})})]})]})})}function ww({open:e,onClose:t,title:n,url:r,kind:s="image"}){return r?o.jsx(Mt,{open:e,onClose:t,title:n||"Preview",variant:"fullscreen",footer:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("a",{href:r,target:"_blank",rel:"noreferrer",className:"ui-button is-muted w-full text-center",children:"Open"}),o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Close"})]}),children:o.jsx("div",{className:"url-viewer-stage",children:s==="video"?o.jsx("video",{src:r,controls:!0,className:"url-viewer-media",autoPlay:!0}):o.jsx("img",{src:r,alt:n||"Preview",className:"url-viewer-media"})})}):null}function Sw({input:e,value:t,onFormChange:n}){const{previewUrl:r,imgReady:s,setImgReady:l,displayName:i,serverOpen:c,openServer:u,closeServer:d,cwd:m,setCwd:y,page:g,setPage:x,perPage:w,setPerPage:j,totalPages:S,topDirs:h,loading:f,search:p,setSearch:v,imagesOnly:k,setImagesOnly:N,shownEntries:_,pickerSource:I,setPickerSource:z,handleUpload:T,clearImage:O,selectServer:ae}=hw({input:e,value:t,onFormChange:n}),q=a.useRef(null),Se=a.useRef(null),[ve,Q]=a.useState(0),[ce,P]=a.useState(!1);a.useEffect(()=>{const E=Se.current;if(!E)return;const V=se=>{se.preventDefault(),se.stopPropagation()},Y=async se=>{var X,ie;V(se);const re=(ie=(X=se.dataTransfer)==null?void 0:X.files)==null?void 0:ie[0];re&&(await T(re),q.current&&(q.current.value=""),Q(G=>G+1))};return["dragenter","dragover","dragleave","drop"].forEach(se=>E.addEventListener(se,se==="drop"?Y:V)),()=>{["dragenter","dragover","dragleave","drop"].forEach(se=>E.removeEventListener(se,se==="drop"?Y:V))}},[T]);const C=async E=>{var Y;const V=(Y=E.target.files)==null?void 0:Y[0];V&&(await T(V),q.current&&(q.current.value=""),Q(se=>se+1))},L=()=>{q.current&&q.current.click()};return o.jsxs("div",{className:"asset-card",children:[o.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[o.jsx("h3",{className:"text-sm font-semibold text-[#F8F4FF] truncate",children:i}),o.jsx("span",{className:"text-[11px] text-[#C3C7FFB3] truncate",children:"Image"})]}),o.jsx("div",{ref:Se,className:"mb-3 rounded-xl border border-dashed border-[rgba(255,255,255,0.14)] bg-[rgba(255,255,255,0.02)] flex items-center justify-center min-h-[140px] sm:min-h-[180px] overflow-hidden",children:r?o.jsx("button",{type:"button",className:"asset-preview-btn",onClick:()=>P(!0),"aria-label":`Preview ${i}`,title:"Open preview",children:o.jsx("img",{src:r,alt:i,className:`max-h-64 max-w-full object-contain transition-opacity ${s?"opacity-100":"opacity-0"}`,onLoad:()=>l(!0)})}):o.jsx("div",{className:"text-[11px] text-[#9DA3FFCC] text-center px-6",children:"Drop an image here, upload from your device, or choose one from your server."})}),o.jsx("input",{ref:q,type:"file",accept:"image/*",className:"hidden",onChange:C},ve),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("button",{type:"button",className:"ui-button is-primary is-compact",onClick:u,children:"Choose"}),o.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:L,children:"Upload"}),o.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:O,children:"Clear"})]}),o.jsx(xw,{open:c,cwd:m,setCwd:y,page:g,setPage:x,perPage:w,setPerPage:j,totalPages:S,topDirs:h,loading:f,imagesOnly:k,setImagesOnly:N,search:p,setSearch:v,shownEntries:_,pickerSource:I,setPickerSource:z,onSelect:ae,onClose:d}),o.jsx(ww,{open:ce,onClose:()=>P(!1),title:i||"Preview",url:r,kind:"image"})]})}function jw({open:e,onClose:t,title:n,description:r,render:s,index:l=0,total:i=0,children:c}){const[u,d]=a.useState("idle"),m=a.useRef(null),y=a.useRef(null),g=w=>w?Array.from(w.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(j=>!j.hasAttribute("disabled")&&j.getAttribute("aria-hidden")!=="true"):[];if(a.useEffect(()=>{if(u==="queued"){const w=setTimeout(()=>d("idle"),1600);return()=>clearTimeout(w)}},[u]),a.useEffect(()=>{if(!e||typeof document>"u")return;const w=m.current;y.current=document.activeElement;const j=()=>{var p;const f=g(w)[0]||w;(p=f==null?void 0:f.focus)==null||p.call(f)},S=h=>{if(h.key==="Escape"){t==null||t();return}if(h.key!=="Tab"||!w)return;const f=g(w);if(!f.length){h.preventDefault(),w.focus();return}const p=f[0],v=f[f.length-1],k=document.activeElement;h.shiftKey&&k===p?(h.preventDefault(),v.focus()):!h.shiftKey&&k===v&&(h.preventDefault(),p.focus())};return requestAnimationFrame(j),w==null||w.addEventListener("keydown",S),()=>{var f;w==null||w.removeEventListener("keydown",S);const h=y.current;h&&document.contains(h)&&((f=h.focus)==null||f.call(h))}},[e,t]),!e)return null;const x=typeof s=="function"?s():c;return o.jsxs("div",{className:"spotlight-overlay",role:"dialog","aria-modal":"true",children:[o.jsx("div",{className:"spotlight-backdrop",onClick:t}),o.jsxs("div",{className:"spotlight-sheet",ref:m,tabIndex:-1,children:[o.jsxs("div",{className:"spotlight-header",children:[o.jsxs("div",{className:"spotlight-meta",children:[o.jsx("div",{className:"spotlight-kicker",children:"Focused control"}),o.jsx("div",{className:"spotlight-title",children:n||"Control"}),r?o.jsx("div",{className:"spotlight-hint",children:r}):null]}),o.jsx("button",{type:"button",className:"spotlight-close",onClick:t,"aria-label":"Close",children:o.jsx(dr,{size:16})})]}),o.jsx("div",{className:"spotlight-body",children:x}),o.jsx("div",{className:"spotlight-footer",children:o.jsx("div",{className:"spotlight-footer-right",children:o.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:t,"aria-label":"Close",children:"Close"})})})]})]})}const oc=a.forwardRef(function({title:t,kicker:n,meta:r,defaultOpen:s=!0,variant:l="card",className:i="",bodyClassName:c,children:u},d){const m=l==="bare",y=(m?["collapsible-section","collapsible-section--bare",i]:["ui-panel","collapsible-card","sectioned-card",i]).filter(Boolean).join(" "),g=(m?["collapsible-section-body",c||"space-y-4"]:["collapsible-card-body",c||"space-y-4"]).filter(Boolean).join(" "),x=r!=null?o.jsx("div",{className:"collapsible-card-summary-meta",children:r}):null;return o.jsxs("details",{ref:d,className:y,open:s,children:[o.jsxs("summary",{className:m?"collapsible-section-summary":"collapsible-card-summary",children:[o.jsxs("div",{className:"flex flex-col gap-1",children:[n?o.jsx("span",{className:"ui-kicker",children:n}):null,o.jsx("span",{className:"text-sm font-semibold tracking-wide",children:t})]}),x,m?o.jsx("span",{className:"collapsible-section-chevron","aria-hidden":"true",children:o.jsx(pi,{size:16})}):null]}),o.jsx("div",{className:g,children:u})]})}),Ft=a.forwardRef(function({as:t,href:n,variant:r,size:s="md",iconOnly:l=!1,active:i=!1,pressed:c,className:u="",type:d,...m},y){const g=t||(n?"a":"button"),x=s==="sm"?"is-compact":s==="xs"?"is-tiny":s==="icon"?"is-icon":"",w=r?`is-${r}`:"",h=["ui-button",x,w,l?"is-icon":"",i?"is-active":"",u].filter(Boolean).join(" "),f={ref:y,className:h,"aria-pressed":c,...m};return g==="button"?o.jsx("button",{...f,type:d||"button"}):o.jsx(g,{...f,href:n})}),Nw=/\.(safetensors|ckpt|pt|pth)$/i,kw=/\.([a-z0-9]{2,16})$/i,Cw=e=>/[a-z]/i.test(e),mi=e=>e.replace(/\\/g,"/"),xm=e=>{const{folder:t,base:n}=bw(e);if(!n)return e;if(!t)return n;const r=t.split(/\s+/).filter(Boolean),s=r[r.length-1]||"";if(s&&n.toLowerCase().startsWith(s.toLowerCase())){const l=n.slice(s.length);return l?`${t}${l}`:t}return`${t} ${n}`.trim()};function wm(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const r=mi(t).split("/").filter(Boolean).pop()||"";return Nw.test(r)}function hs(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const s=(mi(t).split("/").filter(Boolean).pop()||"").match(kw);return s?Cw(s[1]):!1}function gi(e){if(typeof e!="string")return{folderPath:"",base:"",filename:""};const t=mi(e.trim());if(!t)return{folderPath:"",base:"",filename:""};const n=t.split("/").filter(Boolean),r=n.pop()||"",s=r.replace(/\.[^.]+$/,"");return{folderPath:n.join("/"),base:s,filename:r}}function bw(e){if(typeof e!="string")return{folder:"",base:""};const n=mi(e.trim()).split("/").filter(Boolean),s=(n.pop()||"").replace(/\.[^.]+$/,"");return{folder:n.join(" ").trim(),base:s}}function Ew(e){return wm(e)?xm(e):e}function Lw(e){return hs(e)?xm(e):e}function mn(e){if(!hs(e))return e;const{base:t}=gi(e);return t||Lw(e)}const Pw=(e="")=>{if(!e||e==="root")return"root";const t=e.split("/").filter(Boolean);return t[t.length-1]||e},_w=a.memo(function({workflows:t=[],selectedWorkflow:n,onWorkflowChange:r,workflowData:s,presets:l=[],presetName:i="",onPresetNameChange:c,selectedPresetId:u="",onPresetSelect:d,onPresetSave:m,onPresetDelete:y,presetStatus:g}){const x=Array.isArray(t)?t:[],w=Array.isArray(l)?l:[];w.length;const j=fi("(min-width: 768px)"),[S,h]=a.useState(!1),[f,p]=a.useState(!1),[v,k]=a.useState("All");a.useEffect(()=>{h(!1),p(!1)},[j]);const N=a.useMemo(()=>x.map(Q=>{const ce=String(Q||"");if(!hs(ce))return{value:ce,isFile:!1,base:"",folderPath:""};const{folderPath:P,base:C}=gi(ce);return{value:ce,isFile:!0,base:C,folderPath:P||"root"}}),[x]),_=a.useMemo(()=>{const Q=new Set(["All"]);return N.forEach(ce=>{ce.isFile&&ce.folderPath&&Q.add(ce.folderPath)}),Array.from(Q).sort((ce,P)=>ce.localeCompare(P))},[N]),I=_.length>2;a.useEffect(()=>{if(!I){v!=="All"&&k("All");return}_.includes(v)||k("All")},[I,v,_]);const z=a.useMemo(()=>{const Q=new Map;return N.forEach(ce=>{if(!ce.isFile||!ce.base)return;const P=ce.base.toLowerCase();Q.set(P,(Q.get(P)||0)+1)}),Q},[N]),T=a.useMemo(()=>{const Q=[],ce=I&&v==="All";return N.forEach(P=>{if(!P.isFile){Q.push({value:P.value,label:P.value});return}if(I&&v!=="All"&&P.folderPath!==v)return;let C=P.base||mn(P.value)||P.value;if(ce&&P.base){const L=P.base.toLowerCase();z.get(L)>1&&(C=`${C} (${Pw(P.folderPath)})`)}Q.push({value:P.value,label:C})}),Q},[N,v,z,I]),O=a.useMemo(()=>n?T.some(Q=>String(Q.value)===String(n)):!0,[T,n]),ae=a.useMemo(()=>!n||O?T:[{value:n,label:mn(String(n))},...T],[O,n,T]),q=()=>{h(!1),p(!1)},Se=()=>{m(),q()},ve=()=>{y(),q()};return o.jsxs(oc,{title:o.jsxs(o.Fragment,{children:[o.jsx(ec,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Workflow"]}),bodyClassName:"control-shell controls-body",defaultOpen:!1,className:"controls-panel",children:[o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"workflow-select",children:"Workflow"}),I?o.jsx(tt,{value:v,onChange:k,className:"mb-2","aria-label":"Workflow folder filter",size:"sm",options:_.map(Q=>({value:Q,label:Q}))}):null,o.jsx(tt,{id:"workflow-select",value:n||"",onChange:r,"aria-label":"Workflow",size:"sm",placeholder:"Select workflow...",options:ae})]}),o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"preset-select",children:"Preset"}),o.jsx(tt,{id:"preset-select",value:u||"",onChange:d,"aria-label":"Workflow preset",disabled:!s,size:"sm",placeholder:"Select preset...",options:w.map(Q=>({value:Q.id,label:Q.name}))})]}),o.jsxs("div",{className:"flex flex-col gap-1.5",children:[o.jsx("label",{className:"text-[10px] uppercase tracking-wider text-[#9FB2D7B3] font-medium",htmlFor:"preset-name-input",children:"Preset name"}),o.jsx("input",{id:"preset-name-input",type:"text",value:i,onChange:Q=>c(Q.target.value),className:"ui-control ui-input",placeholder:"Name for new preset...","aria-label":"Preset name",disabled:!s})]}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("div",{className:"flex gap-2 flex-wrap",children:[o.jsx("button",{type:"button",className:"ui-button is-primary is-compact",onClick:Se,disabled:!s||!i.trim(),children:"Save preset"}),o.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:ve,disabled:!s||!u,children:"Delete preset"})]}),g?o.jsx("div",{className:"text-xs text-[#6D8BFF]",children:g}):null]})]})});function Rw({open:e,onClose:t,title:n,value:r,onChange:s,placeholder:l="",description:i}){const c=n||"Edit",u=a.useMemo(()=>`sheet-textarea-${Math.random().toString(36).slice(2,9)}`,[]);return o.jsxs(Mt,{open:e,onClose:t,title:c,variant:"fullscreen",footer:o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Done"}),children:[i?o.jsx("div",{className:"text-[12px] text-[rgba(159,178,215,0.75)] mb-3",children:i}):null,o.jsx("textarea",{id:u,value:r??"",onChange:d=>s==null?void 0:s(d.target.value),placeholder:l,className:"sheet-textarea ui-control ui-textarea",rows:12})]})}function In(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(2).replace(/\.?0+$/u,""):"1"}function Iw(e=""){const t=String(e||"");if(!t.trim())return[];const n=[];let r=0;for(;r<t.length;){for(;r<t.length&&/[\s,]/.test(t[r]);)r++;if(r>=t.length)break;let s=r,l=r,i="tag",c="";const u=t[r]==="(";if(u&&(s=r,r++),t[r]==="$"){i="alias";const d=r;for(r++;r<t.length&&t[r]!=="$"&&t[r]!==","&&t[r]!==`
`;)c+=t[r],r++;t[r]==="$"&&r++,u||(s=d)}else{i="tag";const d=r;for(;r<t.length&&!(t[r]===","||t[r]==="$"||t[r]===`
`||u&&t[r]===":"||!u&&t[r]==="(");)c+=t[r],r++;c=c.trim(),u||(s=d)}if(u&&t[r]===":"){for(r++;r<t.length&&t[r]!==")"&&t[r]!==","&&t[r]!==`
`;)r++;t[r]===")"&&r++}l=r,c&&n.push({type:i,text:c,start:s,end:l})}return n}function of(e="",t){if(!t||typeof t.start!="number"||typeof t.end!="number")return null;const r=String(e||"").slice(t.start,t.end);if(!r.startsWith("(")||!r.includes(":"))return null;const s=r.lastIndexOf(":");if(s===-1)return null;const l=r.slice(s+1);if(!l.endsWith(")"))return null;const i=l.slice(0,-1).trim();if(!/^\d+(\.\d+)?$/u.test(i))return null;const c=Number.parseFloat(i);return Number.isFinite(c)?{weight:c,wrapperStart:t.start,wrapperEnd:t.end}:null}function af(e="",t,n){const r=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return r;const s=n==null?null:Number(n),l=s===null||!Number.isFinite(s)||Math.abs(s-1)<1e-6,i=t.type==="alias"?`$${t.text}$`:t.text;if(l)return r.slice(0,t.start)+i+r.slice(t.end);const c=In(s),u=`(${i}:${c})`;return r.slice(0,t.start)+u+r.slice(t.end)}function cf(e="",t,n,r){var g;if(n===r||n===null||r===null||!(t!=null&&t.length))return e;const s=String(e||""),l=t.map(x=>({start:x.start,end:x.end,text:s.slice(x.start,x.end)})),i=l.slice(0,-1).map((x,w)=>{const j=l[w+1];return s.slice(x.end,j.start)}),c=l.length?s.slice(0,l[0].start):"",u=l.length?s.slice(l[l.length-1].end):"",d=[...l],[m]=d.splice(n,1);d.splice(r,0,m);let y=c+(((g=d[0])==null?void 0:g.text)||"");for(let x=1;x<d.length;x++)y+=(i[x-1]??", ")+d[x].text;return y+=u,y}function zw(e="",t){const n=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return n;const r=n.slice(0,t.start).replace(/[\s,]*$/,""),s=n.slice(t.end).replace(/^[\s,]*/,"");return r?`${r}, ${s}`.trim():s.trim()}function Or(e="",t){if(!t||typeof t.index!="number"||typeof t.length!="number")return null;const n=String(e||""),r=t.index,s=t.index+t.length;if(r<=0||n[r-1]!=="("||n[s]!==":")return null;let l=s+1,i="";for(;l<n.length&&n[l]!==")";)if(i+=n[l],l+=1,i.length>12)return null;if(l>=n.length||n[l]!==")")return null;const c=i.trim();if(!/^\d+(\.\d+)?$/u.test(c))return null;const u=Number.parseFloat(c);return Number.isFinite(u)?{weight:u,wrapperStart:r-1,wrapperEnd:l+1}:null}function Gl(e="",t,n){const r=String(e||"");if(!t||typeof t.index!="number"||typeof t.length!="number")return r;const s=t.index,l=t.index+t.length,i=Or(r,t),c=n==null?null:Number(n),u=c===null||!Number.isFinite(c)||Math.abs(c-1)<1e-6;if(i){if(u)return r.slice(0,i.wrapperStart)+r.slice(s,l)+r.slice(i.wrapperEnd);const m=In(c);return r.slice(0,l+1)+m+r.slice(i.wrapperEnd-1)}if(u)return r;const d=In(c);return r.slice(0,s)+"("+r.slice(s,l)+":"+d+")"+r.slice(l)}function Kl(e,t,n){const r=Number(e);return Number.isFinite(r)?Math.max(t,Math.min(n,r)):t}function ic({open:e,onClose:t,title:n="Alias strength",tokenLabel:r="",weight:s=1,onApply:l,onRemoveWeight:i,onDeleteToken:c}){const u=a.useMemo(()=>Kl(s||1,.2,2),[s]),[d,m]=a.useState(u);a.useEffect(()=>{e&&m(u)},[e,u]);const y=In(d);return o.jsx(Mt,{open:e,onClose:t,title:n,footer:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:t,children:"Cancel"}),o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>{l==null||l(d),t==null||t()},children:"Done"})]}),children:o.jsxs("div",{className:"sheet-stack",children:[o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Alias"}),o.jsx("div",{className:"sheet-hint",children:r||""})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Strength"}),o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>m(g=>Kl(g-.05,.2,2)),children:""}),o.jsxs("div",{className:"text-sm text-[rgba(237,242,255,0.92)] tabular-nums",children:[y,""]}),o.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>m(g=>Kl(g+.05,.2,2)),children:"+"})]}),o.jsx("input",{type:"range",min:.2,max:2,step:.05,value:d,onChange:g=>m(Kl(g.target.value,.2,2)),className:"w-full","aria-label":"Alias strength"}),o.jsx("div",{className:"sheet-hint",children:"1.0 is normal. Increase to emphasize or reduce to soften."})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Actions"}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>m(1),children:"Reset to 1.0"}),o.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>{i==null||i(),t==null||t()},children:"Remove strength"}),o.jsx("button",{type:"button",className:"ui-button is-danger is-compact",onClick:()=>{c==null||c(),t==null||t()},children:"Remove alias"})]})]})]})})}function wr(e){const t=String(e||"").trim();if(!t)return"";const n=t.toLowerCase(),r={scifi:"Sci-Fi",sci:"Sci",ui:"UI",vfx:"VFX",hdr:"HDR",dof:"DoF",bokeh:"Bokeh",vhs:"VHS",jpeg:"JPEG",jpg:"JPG",png:"PNG",gif:"GIF",webp:"WebP",api:"API",nsfw:"NSFW",sfw:"SFW",sfx:"SFX",fx:"FX",lora:"LoRA",loras:"LoRAs",ip:"IP",egirl:"E-girl",i2v:"I2V",t2i:"T2I",img2img:"Img2Img",txt2img:"Txt2Img",tts:"TTS",asmr:"ASMR",ai:"AI",highleg:"High-Leg","one-piece":"One-Piece","three-quarter":"Three-Quarter"};return r[n]?r[n]:/^\d+$/.test(n)?n:n==="3d"?"3D":n==="2d"?"2D":n.length===1?n.toUpperCase():n.charAt(0).toUpperCase()+n.slice(1)}function Aw(e=""){const t=String(e||"").trim().toLowerCase();return t?t.startsWith("flirty_")?"flirty":t.startsWith("action_")||t.startsWith("dynamic_")||t.startsWith("stealth_")||t.startsWith("athletic_")||t.startsWith("running_")||t.startsWith("walking_")?"action":t.startsWith("sleepy_")||t.startsWith("relaxed_")||t.startsWith("reclining_")||t.startsWith("sitting_")||t.startsWith("kneeling_")?"rest":t.startsWith("happy_")||t.startsWith("sad_")||t.startsWith("angry_")||t.startsWith("nervous_")||t.startsWith("smug_")||t.startsWith("surprised_")||t.startsWith("scared_")||t.startsWith("tipsy_")?"emotion":t.startsWith("composed_")||t.startsWith("contemplative_")||t.startsWith("looking_")?"posed":"everyday":""}function Tw(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return n==="lingerie"?"lingerie":n==="swimwear"||n==="swim"?"swimwear":n==="costumes"||n==="tech"?"costumes":n==="uniform"?"uniform":n==="formal"?"formal":n==="alt"?"alt":n==="casual"||n==="street"||n==="lounge"||n==="sporty"||n==="dress"?"everyday":n||"everyday"}function Mw(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return["fire","candlelight","embers"].includes(n)?"fire":["moonlight"].includes(n)?"night":["neon"].includes(n)?"neon":["studio","stage","sidelighting","dim"].includes(n)?"studio":["golden","sunbeam","dappled"].includes(n)?"natural":["lens","light"].includes(n)?"effects":n||"other"}function $s(e="",t=""){const n=String(e||"").trim(),r=String(t||"").trim().toLowerCase();if(!n)return"";if(r==="outfit")return Tw(n)||"everyday";if(r==="pose")return Aw(n)||"everyday";if(r==="lighting")return Mw(n)||"effects";const s=n.indexOf("_");return s<=0?"":n.slice(0,s).trim()}function Sm(e=""){const t=String(e||"").trim();return t?t.includes(":")?t.split(":").slice(1).join(":"):t:""}function Bo({token:e="",name:t=""}={}){const n=String(t||"").trim()||Sm(e);if(!n)return"";let s=n.replace(/_(\d+)$/u,"").split("_").filter(Boolean);if(s.length===0)return n;const l=[];for(let y=0;y<s.length;y++){const g=s[y],x=s[y+1];if(g&&x&&g.toLowerCase()==="one"&&x.toLowerCase()==="piece"){l.push("one-piece"),y+=1;continue}if(g&&x&&g.toLowerCase()==="three"&&x.toLowerCase()==="quarter"){l.push("three-quarter"),y+=1;continue}l.push(g)}if(s=l,Array.from(new Set(s.map(y=>String(y).toLowerCase()))).length===1)return wr(s[0]);const c=s[0],u=s.slice(1),d=wr(c),m=u.map(wr).join(" ").trim();return m?m.toLowerCase()===d.toLowerCase()?u.length===1&&String(u[0]).toLowerCase()===String(c).toLowerCase()?d||n:s.map(wr).join(" ").trim()||n:`${d} - ${m}`:s.map(wr).join(" ").trim()||n}function mu(e){if(!e)return{subcategory:"",displayName:""};const t=e.name||"",n=e.token||"",r=Sm(n)||t,s=$s(r,e.category)||"other",l=Bo({token:n,name:t})||n||t||"Alias";return{subcategory:s,displayName:l}}function zn(e=""){const t=String(e||"").trim();return t?t==="All"?"All":{action:"Actions",camera:"Camera",body:"Body",char:"Characters",mood:"Mood",outfit:"Outfits",pose:"Poses",prop:"Props",scene:"Scenes",weather:"Weather",style:"Style",hair:"Hair",lighting:"Lighting"}[t]||wr(t):""}function fr(e=""){const t=String(e||"").trim();return t?t==="All"?"All":t.split(/[_-]+/u).filter(Boolean).map(n=>wr(n)).join(" ").trim():""}const $w={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function Fw({name:e,label:t,description:n,value:r,onChange:s,onEnter:l,disabled:i=!1,multiline:c=!1,aliasOptions:u=[],aliasCatalog:d=[],onOpenComposer:m}){var ft,it;const y=a.useRef(null),g=a.useRef(null),x=a.useRef({start:null,end:null}),w=a.useRef(null),j=a.useRef(null),[S,h]=a.useState(null),[f,p]=a.useState(null),[v,k]=a.useState(!1),[N,_]=a.useState(""),I=a.useDeferredValue(N),[z,T]=a.useState("All"),[O,ae]=a.useState("All"),[q]=a.useState([]),Se=a.useRef(null),[ve,Q]=a.useState(!1),[ce,P]=a.useState(!1),[C,L]=a.useState(null),E=typeof r=="string"?r:String(r??"");a.useMemo(()=>Array.isArray(u)?u.filter(Boolean):[],[u]);const V=a.useMemo(()=>(Array.isArray(d)?d.filter(M=>M&&M.name):[]).map(M=>({...M,...mu(M)})),[d]),Y=a.useMemo(()=>V,[V]),se=M=>{const ee=M.target.value;s==null||s(ee)},re=M=>{if(!c&&M.key==="Enter"){M.preventDefault(),l==null||l(M.target.value,M);return}},X=a.useMemo(()=>{const M=new Map;return Y.forEach(ee=>{ee!=null&&ee.token&&M.set(String(ee.token).toLowerCase(),ee)}),M},[Y]),ie=a.useMemo(()=>{const M=new Set(["All"]);return V.forEach(ee=>{ee.category&&M.add(ee.category)}),Array.from(M).sort((ee,xe)=>ee.localeCompare(xe))},[V]),G=a.useMemo(()=>{const M=new Set(["All"]);return Y.forEach(ee=>{(!z||z==="All"||ee.category===z)&&ee.subcategory&&M.add(ee.subcategory)}),Array.from(M).sort((ee,xe)=>ee.localeCompare(xe))},[Y,z]);a.useEffect(()=>{ae("All")},[z]);const $=a.useMemo(()=>{const M=E||"";if(!M||!M.includes("$"))return[];const ee=[],xe=/\$([a-z0-9_:-]+)\$/gi;let _e;for(;_e=xe.exec(M);)ee.push({token:_e[1],index:_e.index,length:_e[0].length});return ee},[E]),D=()=>{try{const M=y.current;M?x.current={start:M.selectionStart??null,end:M.selectionEnd??null}:x.current={start:null,end:null}}catch{x.current={start:null,end:null}}g.current&&g.current.scrollIntoView({block:"center",behavior:"smooth"}),k(!0)},le=a.useMemo(()=>{const M=I.trim().toLowerCase();return Y.filter(ee=>{var xe,_e,B,J;return z!=="All"&&(ee.category||"")!==z||O!=="All"&&(ee.subcategory||"other")!==O?!1:M?((xe=ee.token)==null?void 0:xe.toLowerCase().includes(M))||((_e=ee.text)==null?void 0:_e.toLowerCase().includes(M))||((B=ee.name)==null?void 0:B.toLowerCase().includes(M))||((J=ee.displayName)==null?void 0:J.toLowerCase().includes(M)):!0}).sort((ee,xe)=>{const _e=(ee.subcategory||"").toLowerCase(),B=(xe.subcategory||"").toLowerCase();return _e!==B?_e.localeCompare(B):ee.token.localeCompare(xe.token)})},[Y,z,O,I]),[ue,Pe]=a.useState(30),je=a.useMemo(()=>le.slice(0,ue),[le,ue]);a.useEffect(()=>{Pe(30)},[z,O,N,V]),a.useEffect(()=>{ae("All")},[z]);const Re=(M,{closeAfter:ee=!0}={})=>{var Ze,fn;const xe=y.current,_e=`$${M}$`,B=E||"",J=(Ze=x.current)==null?void 0:Ze.start,de=(fn=x.current)==null?void 0:fn.end,ye=(xe==null?void 0:xe.selectionStart)??(typeof J=="number"?J:B.length),fe=(xe==null?void 0:xe.selectionEnd)??(typeof de=="number"?de:B.length),R=B.slice(0,ye),F=B.slice(fe),H=R.match(/[^\s]$/),K=F.match(/^[^\s]/),Ee=H&&H[0]!==","?", ":"",we=K&&K[0]!==","?", ":"",Ye=R+Ee+_e+we+F;s==null||s(Ye);const ze=(R+Ee+_e+we).length;x.current={start:ze,end:ze},ee&&(k(!1),requestAnimationFrame(()=>{var Vn;(Vn=xe==null?void 0:xe.blur)==null||Vn.call(xe)}))},Te=M=>{const ee=E||"",xe=Or(ee,M),_e=xe?xe.wrapperStart:M.index,B=xe?xe.wrapperEnd:M.index+M.length,J=ee.slice(0,_e).replace(/[\s,]*$/,""),de=ee.slice(B).replace(/^[\s,]*/,""),ye=J?`${J} ${de}`.trim():de.trim();s==null||s(ye)},Fe=M=>{if(!M)return;const ee=X.get(M.token.toLowerCase()),xe=(ee==null?void 0:ee.displayName)||M.token,_e=Or(E||"",M);L({tokenObj:M,displayName:xe,weight:(_e==null?void 0:_e.weight)??1}),P(!0),requestAnimationFrame(()=>{var B,J;return(J=(B=y.current)==null?void 0:B.blur)==null?void 0:J.call(B)})},Be=a.useMemo(()=>(M,ee)=>{var F;if(M===ee||M===null||ee===null||!($!=null&&$.length))return;const xe=E||"",_e=$.map(H=>{const K=Or(xe,H),Ee=K?K.wrapperStart:H.index,we=K?K.wrapperEnd:H.index+H.length;return{start:Ee,end:we,text:xe.slice(Ee,we)||`$${H.token}$`}}),B=_e.slice(0,-1).map((H,K)=>{const Ee=_e[K+1];return xe.slice(H.end,Ee.start)}),J=_e.length?xe.slice(0,_e[0].start):"",de=_e.length?xe.slice(_e[_e.length-1].end):"",ye=[..._e],[fe]=ye.splice(M,1);ye.splice(ee,0,fe);let R=J+(((F=ye[0])==null?void 0:F.text)||"");for(let H=1;H<ye.length;H+=1)R+=(B[H-1]??", ")+ye[H].text;R+=de,s==null||s(R)},[s,$,E]),U=(M,ee)=>{h(ee),w.current=M.currentTarget,M.dataTransfer.effectAllowed="move",M.dataTransfer.setData("text/plain",String(ee)),requestAnimationFrame(()=>{w.current&&w.current.classList.add("is-dragging")})},ke=(M,ee)=>{M.preventDefault(),M.dataTransfer.dropEffect="move",ee!==f&&p(ee)},He=M=>{M!==f&&p(M)},te=M=>{S!==null&&M!==null&&S!==M&&Be(S,M),h(null),p(null),w.current=null},pe=()=>{w.current&&w.current.classList.remove("is-dragging"),te(f)},oe=(M,ee)=>{M.preventDefault(),te(ee)},he=(M,ee)=>{var B,J;if(!((J=(B=M.target)==null?void 0:B.closest)==null?void 0:J.call(B,".token-chip-drag-handle")))return;const _e=M.touches[0];j.current={idx:ee,startX:_e.clientX,startY:_e.clientY,moved:!1}},be=M=>{if(!j.current)return;const ee=M.touches[0],xe=Math.abs(ee.clientX-j.current.startX),_e=Math.abs(ee.clientY-j.current.startY);if(xe<=10&&_e<=10)return;j.current.moved=!0,h(j.current.idx),M.preventDefault();const B=g.current,J=B?B.querySelectorAll(".token-chip-draggable"):document.querySelectorAll(".token-chip-draggable"),de=ee.clientX,ye=ee.clientY;for(let fe=0;fe<J.length;fe++){const R=J[fe].getBoundingClientRect();if(de>=R.left&&de<=R.right&&ye>=R.top&&ye<=R.bottom){p(fe);break}}},Ce=()=>{var M;(M=j.current)!=null&&M.moved&&S!==null&&f!==null&&S!==f&&Be(S,f),j.current=null,h(null),p(null)},Me={id:e,name:e,value:E,onChange:se,disabled:i,className:"ui-control ui-input pr-10 text-[13px] sm:text-sm",placeholder:"","aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0},Ge=()=>{k(!1),requestAnimationFrame(()=>{var M,ee;(ee=(M=y.current)==null?void 0:M.blur)==null||ee.call(M)})},ct=(()=>{const M=String(e||"").toLowerCase(),ee=String(t||"").toLowerCase();return!!`${M} ${ee}`.trim().includes("prompt")})(),yt=()=>o.jsx(Mt,{open:v,onClose:Ge,title:ct?"Insert alias":"Aliases",footer:o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:Ge,children:"Done"}),children:o.jsxs("div",{className:"sheet-stack",children:[o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Search"}),o.jsxs("div",{className:"composer-filters",children:[o.jsx("input",{ref:Se,type:"text",value:N,onChange:M=>_(M.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),o.jsx(tt,{value:z,onChange:T,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:["All",...ie.filter(M=>M!=="All")].map(M=>({value:M,label:M==="All"?"Category: All":zn(M)}))}),G.length>2?o.jsx(tt,{value:O,onChange:ae,className:"composer-subcategory-select",size:"sm",options:G.map(M=>({value:M,label:M==="All"?"All subcategories":fr(M)}))}):null]})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Results"}),o.jsx("div",{className:"composer-alias-list",children:le.length===0?o.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):o.jsxs(o.Fragment,{children:[je.map(M=>o.jsxs("button",{type:"button",onClick:()=>Re(M.token,{closeAfter:!ct}),className:"composer-alias-item",style:$w,children:[o.jsxs("div",{className:"composer-alias-header",children:[o.jsx("div",{className:"composer-alias-name",children:M.displayName||M.token}),M.category?o.jsx("span",{className:"composer-alias-category",children:zn(M.category)}):null]}),o.jsxs("div",{className:"composer-alias-token",children:["$",M.token,"$"]}),o.jsx("div",{className:"composer-alias-text",children:M.text})]},M.key)),ue<le.length?o.jsxs("button",{type:"button",onClick:()=>Pe(M=>Math.min(M+30,le.length)),className:"ui-button is-muted w-full",children:["Show more (",le.length-ue," left)"]}):null]})})]})]})});return c?o.jsxs("div",{className:"relative space-y-2",ref:g,children:[m&&!ct?o.jsxs("div",{className:"stringinput-toolbar",children:[o.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>m(e),children:"Open composer"}),V.length?o.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:D,children:"Aliases"}):null,o.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>Q(!0),children:"Expand"})]}):null,o.jsx("textarea",{ref:y,...Me,rows:3,wrap:"soft",onKeyDown:re,className:Me.className+" resize-none min-h-[88px] max-h-[160px] leading-relaxed overflow-y-auto overflow-x-hidden break-words whitespace-pre-wrap",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"anywhere"}}),m&&ct?o.jsx("div",{className:"stringinput-underbar",children:o.jsxs("div",{className:"stringinput-underbar-actions",children:[o.jsx("button",{type:"button",className:"stringinput-action-link",onClick:()=>m(e),children:"Open composer"}),V.length?o.jsx("button",{type:"button",className:"stringinput-action-link",onClick:D,children:"Insert alias"}):null]})}):null,o.jsx(Rw,{open:ve,onClose:()=>Q(!1),title:t||e,value:E,onChange:s,description:n}),$.length?o.jsxs("div",{className:"stringinput-tokens",children:[o.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",o.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),o.jsx("div",{className:"stringinput-tokens-list",children:$.map((M,ee)=>{var ye;const xe=X.get(M.token.toLowerCase()),_e=(xe==null?void 0:xe.displayName)||M.token,B=S===ee,J=f===ee&&S!==null&&S!==ee,de=((ye=Or(E||"",M))==null?void 0:ye.weight)??1;return o.jsxs("div",{className:`token-chip token-chip-draggable ${B?"is-dragging":""} ${J?"is-drop-target":""}`,title:`$${M.token}$`,role:"button",tabIndex:0,draggable:!0,onDragStart:fe=>U(fe,ee),onDragEnd:pe,onDragEnter:()=>He(ee),onDragOver:fe=>ke(fe,ee),onDrop:fe=>oe(fe,ee),onTouchStart:fe=>he(fe,ee),onTouchMove:be,onTouchEnd:Ce,onClick:()=>{S===null&&Fe(M)},onKeyDown:fe=>{(fe.key==="Enter"||fe.key===" ")&&(fe.preventDefault(),Fe(M))},children:[o.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:o.jsx(nc,{size:14})}),o.jsx("span",{className:"token-chip-label",children:_e}),Math.abs(de-1)>1e-6?o.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${In(de)}x`,children:["",In(de)]}):null,o.jsx("button",{type:"button",className:"token-chip-remove",onClick:fe=>{fe.stopPropagation(),Te(M)},"aria-label":`Remove ${M.token}`,children:o.jsx(dr,{size:12})})]},`${M.token}-${M.index}`)})})]}):null,o.jsx(ic,{open:ce,onClose:()=>P(!1),title:"Alias strength",tokenLabel:C?`${C.displayName}  $${(ft=C.tokenObj)==null?void 0:ft.token}$`:"",weight:(C==null?void 0:C.weight)??1,onApply:M=>{C!=null&&C.tokenObj&&(s==null||s(Gl(E||"",C.tokenObj,M)))},onRemoveWeight:()=>{C!=null&&C.tokenObj&&(s==null||s(Gl(E||"",C.tokenObj,null)))},onDeleteToken:()=>{C!=null&&C.tokenObj&&Te(C.tokenObj)}}),v?o.jsx(yt,{}):null]}):o.jsxs("div",{className:"relative space-y-2",ref:g,children:[o.jsx("input",{...Me,type:"text",inputMode:"text",autoComplete:"off",onKeyDown:re,className:Me.className+" min-h-[44px]",ref:y}),$.length?o.jsxs("div",{className:"stringinput-tokens",children:[o.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",o.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),o.jsx("div",{className:"stringinput-tokens-list",children:$.map((M,ee)=>{var ye;const xe=X.get(M.token.toLowerCase()),_e=(xe==null?void 0:xe.displayName)||M.token,B=S===ee,J=f===ee&&S!==null&&S!==ee,de=((ye=Or(E||"",M))==null?void 0:ye.weight)??1;return o.jsxs("div",{className:`token-chip token-chip-draggable ${B?"is-dragging":""} ${J?"is-drop-target":""}`,title:`$${M.token}$`,onClick:()=>{S===null&&Fe(M)},role:"button",tabIndex:0,draggable:!0,onDragStart:fe=>U(fe,ee),onDragEnd:pe,onDragEnter:()=>He(ee),onDragOver:fe=>ke(fe,ee),onDrop:fe=>oe(fe,ee),onTouchStart:fe=>he(fe,ee),onTouchMove:be,onTouchEnd:Ce,onKeyDown:fe=>{(fe.key==="Enter"||fe.key===" ")&&(fe.preventDefault(),Fe(M))},children:[o.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:o.jsx(nc,{size:14})}),o.jsx("span",{className:"token-chip-label",children:_e}),Math.abs(de-1)>1e-6?o.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${In(de)}x`,children:["",In(de)]}):null,o.jsx("button",{type:"button",className:"token-chip-remove",onClick:fe=>{fe.stopPropagation(),Te(M)},"aria-label":`Remove ${M.token}`,children:o.jsx(dr,{size:12})})]},`${M.token}-${M.index}`)})})]}):null,o.jsx(ic,{open:ce,onClose:()=>P(!1),title:"Alias strength",tokenLabel:C?`${C.displayName}  $${(it=C.tokenObj)==null?void 0:it.token}$`:"",weight:(C==null?void 0:C.weight)??1,onApply:M=>{C!=null&&C.tokenObj&&(s==null||s(Gl(E||"",C.tokenObj,M)))},onRemoveWeight:()=>{C!=null&&C.tokenObj&&(s==null||s(Gl(E||"",C.tokenObj,null)))},onDeleteToken:()=>{C!=null&&C.tokenObj&&Te(C.tokenObj)}}),V.length?o.jsx("button",{type:"button",className:"stringinput-trailing ui-button is-ghost is-compact",onClick:()=>m?m(e):D(),title:m?"Open prompt composer":"Insert alias","aria-label":m?"Open prompt composer":"Insert alias",children:m?o.jsx(fu,{size:16}):o.jsx(ur,{size:16})}):null,o.jsx(yt,{})]})}const uf=a.memo(Fw),df=e=>e==null?void 0:String(e).trim().replace(/[^A-Za-z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||void 0;function Ow({name:e,label:t,description:n,value:r,onChange:s,disabled:l=!1,min:i,max:c,step:u,isFloat:d=!1,inputId:m}){const y=u??(d?.01:1),g=m??df(e),x=S=>{if(S===""||S===null||S===void 0)return"";const h=d?parseFloat(S):parseInt(S,10);return Number.isNaN(h)?"":h},w=S=>{const h=S.target.value,f=x(h);s==null||s(f)},j=S=>{if(S.key!=="ArrowUp"&&S.key!=="ArrowDown")return;S.preventDefault();const h=typeof r=="number"?r:x(String(r??""))||0,f=S.key==="ArrowUp"?y:-y;let p=h+f;if(typeof i=="number"&&(p=Math.max(i,p)),typeof c=="number"&&(p=Math.min(c,p)),d){const v=typeof y=="number"?(String(y).split(".")[1]||"").length:2;p=parseFloat(p.toFixed(Math.max(v,2)))}s==null||s(p)};return o.jsxs("div",{className:"w-full flex items-center gap-2",children:[o.jsx("input",{id:g,name:e,type:"number",inputMode:d?"decimal":"numeric",value:r??"",onChange:w,onKeyDown:j,disabled:l,min:i,max:c,step:y,"aria-label":t||e,"aria-describedby":n?`${g||df(e)||e}-description`:void 0,className:"ui-control ui-input"}),typeof i=="number"||typeof c=="number"?o.jsxs("div",{className:"hidden sm:flex flex-col text-[10px] text-[#6A6FA8] text-right leading-tight",children:[typeof i=="number"&&o.jsxs("span",{children:["min ",i]}),typeof c=="number"&&o.jsxs("span",{children:["max ",c]})]}):null]})}const Qs=a.memo(Ow);function Dw({name:e,label:t,description:n,value:r,onChange:s,disabled:l=!1}){const i=!!r,c=()=>{l||s==null||s(!i)},u=d=>{(d.key===" "||d.key==="Enter")&&(d.preventDefault(),c())};return o.jsxs("button",{id:e,type:"button",role:"switch","aria-checked":i,"aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0,onClick:c,onKeyDown:u,disabled:l,className:`ui-switch ${i?"is-on":""}`,children:[o.jsx("span",{className:"ui-switch-track",children:o.jsx("span",{className:"ui-switch-knob"})}),o.jsx("span",{className:"ui-switch-state",children:i?"On":"Off"})]})}const ff=a.memo(Dw);function Bw(e,t){try{if(typeof window>"u"||!e)return null;const n=e.getItem(t);return n?JSON.parse(n):null}catch{return null}}function yi(e,t,n){try{if(typeof window>"u"||!e)return;e.setItem(t,JSON.stringify(n))}catch{}}function dn(){try{return typeof window>"u"?null:window.sessionStorage||null}catch{return null}}function Ss(){try{return typeof window>"u"?null:window.localStorage||null}catch{return null}}const jm=750,Tn=new Map,yn=new Map,vn=new Map,ls=new Map,xn=new Map,wn=new Map;function Nm(e){var t;if(yn.has(e)&&(clearTimeout(yn.get(e)),yn.delete(e)),vn.has(e)){try{(t=window.cancelIdleCallback)==null||t.call(window,vn.get(e))}catch{}vn.delete(e)}Tn.has(e)&&(yi(dn(),e,Tn.get(e)),Tn.delete(e))}function Uw(e){var r;if(yn.has(e)&&(clearTimeout(yn.get(e)),yn.delete(e)),vn.has(e)){try{(r=window.cancelIdleCallback)==null||r.call(window,vn.get(e))}catch{}vn.delete(e)}const t=()=>{Tn.has(e)&&(yi(dn(),e,Tn.get(e)),Tn.delete(e))},n=setTimeout(()=>{yn.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const s=window.requestIdleCallback(()=>{vn.delete(e),t()},{timeout:2500});vn.set(e,s);return}}catch{}t()},jm);yn.set(e,n)}function Vw(){Array.from(yn.values()).forEach(e=>clearTimeout(e)),yn.clear(),Array.from(vn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),vn.clear(),Array.from(Tn.entries()).forEach(([e,t])=>{yi(dn(),e,t)}),Tn.clear(),Array.from(xn.values()).forEach(e=>clearTimeout(e)),xn.clear(),Array.from(wn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),wn.clear(),Array.from(ls.entries()).forEach(([e,t])=>{try{const n=dn();n&&n.setItem(e,t)}catch{}}),ls.clear()}if(typeof window<"u"&&!window.__cozygenFormStateFlush){const e=()=>Vw();window.addEventListener("beforeunload",e),window.addEventListener("pagehide",e),window.__cozygenFormStateFlush=!0}function Ww(e){var r;if(!e)return{};const t=`${e}_formData`,n=Bw(dn(),t);if(n&&typeof n=="object")return n;try{const s=Ss();(r=s==null?void 0:s.removeItem)==null||r.call(s,t)}catch{}return{}}function Uo(e,t,n={}){var l;if(!e)return;const{immediate:r=!1}=n||{},s=`${e}_formData`;if(r){Nm(s),yi(dn(),s,t||{});try{const i=Ss();(l=i==null?void 0:i.removeItem)==null||l.call(i,s)}catch{}return}Tn.set(s,t||{}),Uw(s)}function Hw(e){e&&Nm(`${e}_formData`)}function Gw(e,t,n=jm){var l;if(ls.set(e,t),xn.has(e)&&(clearTimeout(xn.get(e)),xn.delete(e)),wn.has(e)){try{(l=window.cancelIdleCallback)==null||l.call(window,wn.get(e))}catch{}wn.delete(e)}const r=()=>{const i=ls.get(e);ls.delete(e);try{const c=dn();c&&c.setItem(e,i)}catch{}},s=setTimeout(()=>{xn.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const i=window.requestIdleCallback(()=>{wn.delete(e),r()},{timeout:2e3});wn.set(e,i);return}}catch{}r()},n);xn.set(e,s)}function Kw(e,t={}){var s,l;const{immediate:n=!1}=t||{},r="cozygen_last_param";if(n){if(xn.has(r)&&(clearTimeout(xn.get(r)),xn.delete(r)),wn.has(r)){try{(s=window.cancelIdleCallback)==null||s.call(window,wn.get(r))}catch{}wn.delete(r)}ls.delete(r);try{const i=dn();i&&i.setItem(r,e||"");const c=Ss();(l=c==null?void 0:c.removeItem)==null||l.call(c,r)}catch{}return}Gw(r,e||"")}function Qw(){var t,n;const e="cozygen_last_param";try{const r=dn(),s=((t=r==null?void 0:r.getItem)==null?void 0:t.call(r,e))||"";if(s)return s;const l=Ss();(n=l==null?void 0:l.removeItem)==null||n.call(l,e)}catch{}return""}function km(e,t){const n=e?String(e):"global",r=t?String(t):"";return`cozygen_dropdown_folder:${n}:${r}`}function pf(e,t){var r,s;const n=km(e,t);try{const l=dn(),i=((r=l==null?void 0:l.getItem)==null?void 0:r.call(l,n))||"";if(i)return i;const c=Ss();(s=c==null?void 0:c.removeItem)==null||s.call(c,n)}catch{}return""}function Yw(e,t,n){var s;const r=km(e,t);try{const l=dn();l&&l.setItem(r,String(n||""));const i=Ss();(s=i==null?void 0:i.removeItem)==null||s.call(i,r)}catch{}}function qw({workflowName:e,name:t,label:n,description:r,value:s,onChange:l,disabled:i=!1,options:c=[]}){const u=s??"",[d,m]=a.useState(()=>pf(e,t)||"All");a.useEffect(()=>{const v=pf(e,t);m(v||"All")},[e,t]);const y=a.useMemo(()=>(c||[]).map(v=>typeof v=="string"?{value:v,label:v}:{value:v.value??v.name??"",label:v.label??v.name??String(v.value??"")}),[c]),g=v=>{const k=typeof(v==null?void 0:v.value)=="string"||typeof(v==null?void 0:v.value)=="number"?String(v.value):"",N=typeof(v==null?void 0:v.label)=="string"||typeof(v==null?void 0:v.label)=="number"?String(v.label):"";return hs(k)?k:hs(N)?N:""},x=a.useMemo(()=>y.map(v=>{const k=g(v);if(!k)return{opt:v,path:"",base:"",folderPath:""};const{folderPath:N,base:_}=gi(k);return{opt:v,path:k,base:_,folderPath:N||"root"}}),[y]),w=a.useMemo(()=>{const v=new Set(["All"]);return x.forEach(({path:k,folderPath:N})=>{k&&v.add(N||"root")}),Array.from(v).sort((k,N)=>k.localeCompare(N))},[x]),j=w.length>2;a.useEffect(()=>{if(!j){d!=="All"&&m("All");return}w.includes(d)||m("All")},[w,d,j]),a.useEffect(()=>{Yw(e,t,d)},[e,t,d]);const S=a.useMemo(()=>{const v=new Map;return x.forEach(({base:k})=>{if(!k)return;const N=k.toLowerCase();v.set(N,(v.get(N)||0)+1)}),v},[x]),h=a.useMemo(()=>{const v=[],k=j&&d==="All";return x.forEach(({opt:N,path:_,base:I,folderPath:z})=>{if(!_){v.push(N);return}const T=z||"root";if(j&&d!=="All"&&T!==d)return;let O=I||mn(_)||N.label;if(k&&I){const ae=I.toLowerCase();if(S.get(ae)>1){const q=T==="root"?"root":T.split("/").pop()||T;O=`${O} (${q})`}}v.push({...N,label:O})}),v.sort((N,_)=>String(N.label||"").localeCompare(String(_.label||"")))},[x,S,d,j]),f=a.useMemo(()=>u===""||u===null||u===void 0?!0:h.some(v=>String(v.value)===String(u)),[h,u]),p=v=>{const k=v&&v.target?v.target.value:v;l==null||l(k)};return o.jsxs("div",{className:"w-full space-y-2",children:[j?o.jsx("div",{className:"relative w-full",children:o.jsx(tt,{value:d,onChange:m,disabled:i,"aria-label":`Choose folder for ${n||t}`,size:"sm",options:w.map(v=>({value:v,label:v}))})}):null,o.jsx("div",{className:"relative w-full",children:o.jsx(tt,{id:t,name:t,value:u,onChange:p,disabled:i,"aria-label":n||t,"aria-describedby":r?`${t}-description`:void 0,placeholder:h.length>0&&(u===void 0||u==="")?"Select...":void 0,emptyLabel:"No matches",options:[...!f&&u!==""?[{value:u,label:mn(String(u))}]:[],...h]},`${t||"field"}:${d}`)})]})}const ac=a.memo(qw);function hf(e=[]){return e.map(t=>typeof t=="string"?{value:t,label:t}:{value:t.value??t.name??"",label:t.label??t.name??String(t.value??"")})}function mf(e,t){if(!e)return null;const n=String(e);if(t==="high"){const r=n.match(/(.+)-high(\.[^.]*)?$/i);return r?r[1]:null}if(t==="low"){const r=n.match(/(.+)-low(\.[^.]*)?$/i);return r?r[1]:null}return null}function Xw(e){return e?e.replace(/[_-]+/g," ").replace(/\s+/g," ").trim().replace(/^./,t=>t.toUpperCase()):""}const Jw=(...e)=>e.flat().map(n=>String(n??"").trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")).filter(Boolean).join("-")||"field";function Zw({name:e,label:t,description:n,highParam:r,lowParam:s,highChoices:l=[],lowChoices:i=[],formData:c={},onChangeParam:u,highStrengthParam:d,lowStrengthParam:m,strengthValue:y,onChangeStrength:g,highStrengthValue:x,lowStrengthValue:w,onChangeHighStrength:j,onChangeLowStrength:S,disabled:h=!1}){const f=a.useMemo(()=>hf(l),[l]),p=a.useMemo(()=>hf(i),[i]),v=a.useMemo(()=>{const X=new Map;p.forEach(G=>{const $=mf(G.value,"low");$&&(X.has($)||X.set($,G))});const ie=[];return f.forEach(G=>{const $=mf(G.value,"high");if(!$)return;const D=X.get($);D&&ie.push({base:$,label:Xw($),highValue:G.value,lowValue:D.value})}),ie.sort((G,$)=>G.label.localeCompare($.label)),ie},[f,p]),k=a.useMemo(()=>{const X=c[r],ie=c[s];if(!X||!ie)return"";const G=v.find($=>$.highValue===X&&$.lowValue===ie);return G?G.base:""},[c,r,s,v]),N=d||m||`${e}_strength`,_=a.useMemo(()=>Jw(e||"lora",N||"strength"),[e,N]),I=!!(d||m),z=!!(d&&m),T=(X,ie=1)=>typeof X=="number"?X:ie,O=T(typeof y=="number"?y:typeof x=="number"?x:typeof w=="number"?w:void 0,1),ae=T(typeof x=="number"?x:void 0,O),q=T(typeof w=="number"?w:void 0,z?O:ae),Se=z&&Math.abs(ae-q)>1e-4,[ve,Q]=a.useState(Se);a.useEffect(()=>{Q(Se)},[Se,r,s]);const ce=X=>{if(!u)return;const ie=v.find(G=>G.base===X);ie&&(u(r,ie.highValue),u(s,ie.lowValue))};if(v.length===0)return o.jsxs("div",{className:"text-[11px] text-[#9DA3FFCC]",children:["No matching ",o.jsx("span",{className:"font-semibold",children:"-high"})," /"," ",o.jsx("span",{className:"font-semibold",children:"-low"})," LoRA pairs found."]});const P=`${_}-linked`,C=`${_}-high`,L=`${_}-low`,E=z?"Linked":"Strength",V=z?"Applies to high + low":d||m||"",Y=(X,ie)=>{const G=Array.isArray(X)?X:[X];let $=!1;G.forEach(D=>{if(D==="high"&&typeof j=="function"){j(ie);return}if(D==="low"&&typeof S=="function"){S(ie);return}typeof g=="function"&&!$&&(g(ie),$=!0)})},se=X=>{(d||!d&&!m)&&Y("high",X),m&&Y("low",X)},re=()=>{z&&Q(X=>{const ie=!X;return ie||se(typeof ae=="number"?ae:typeof q=="number"?q:O),ie})};return o.jsxs("div",{className:"space-y-2",children:[o.jsx(ac,{name:`${e}_pair`,label:t,description:n,value:k||"",onChange:ce,disabled:h,options:v.map(X=>({value:X.base,label:X.label}))}),I&&o.jsxs("div",{className:"space-y-1.5",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-[10px] uppercase tracking-[0.16em] text-[#9DA3FFCC]",children:"Strength"}),z&&o.jsx("button",{type:"button",className:"text-[10px] font-semibold tracking-[0.12em] uppercase text-[#E5E7FF]",onClick:re,disabled:h,children:ve?"Link values":"Split values"})]}),ve&&z?o.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-3",children:[o.jsxs("div",{className:"flex-1 max-w-[220px]",children:[o.jsxs("label",{htmlFor:C,className:"lora-strength-label is-high",children:[o.jsx("span",{className:"lora-strength-label-pill",children:"High"}),o.jsxs("span",{className:"lora-strength-label-text",children:["High strength",d&&o.jsx("span",{className:"lora-strength-label-hint",children:d})]})]}),o.jsx(Qs,{name:`${N}_high`,label:"High strength",description:"",value:ae,onChange:X=>Y("high",X),disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:C})]}),o.jsxs("div",{className:"flex-1 max-w-[220px]",children:[o.jsxs("label",{htmlFor:L,className:"lora-strength-label is-low",children:[o.jsx("span",{className:"lora-strength-label-pill",children:"Low"}),o.jsxs("span",{className:"lora-strength-label-text",children:["Low strength",m&&o.jsx("span",{className:"lora-strength-label-hint",children:m})]})]}),o.jsx(Qs,{name:`${N}_low`,label:"Low strength",description:"",value:q,onChange:X=>Y("low",X),disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:L})]})]}):o.jsxs("div",{className:"flex-1 max-w-[220px]",children:[o.jsxs("label",{htmlFor:P,className:"lora-strength-label is-linked",children:[o.jsx("span",{className:"lora-strength-label-pill",children:E}),o.jsxs("span",{className:"lora-strength-label-text",children:["LoRA strength",V&&o.jsx("span",{className:"lora-strength-label-hint",children:V})]})]}),o.jsx(Qs,{name:N,label:"LoRA strength",description:"",value:O,onChange:se,disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:P})]})]})]})}function e0(e,t){if(e.disabled!==t.disabled||e.name!==t.name||e.label!==t.label||e.description!==t.description||e.highParam!==t.highParam||e.lowParam!==t.lowParam||e.highStrengthParam!==t.highStrengthParam||e.lowStrengthParam!==t.lowStrengthParam||e.strengthValue!==t.strengthValue||e.highStrengthValue!==t.highStrengthValue||e.lowStrengthValue!==t.lowStrengthValue||e.highChoices!==t.highChoices||e.lowChoices!==t.lowChoices||e.onChangeParam!==t.onChangeParam||e.onChangeStrength!==t.onChangeStrength||e.onChangeHighStrength!==t.onChangeHighStrength||e.onChangeLowStrength!==t.onChangeLowStrength)return!1;const n=e.formData||{},r=t.formData||{};return!(n[e.highParam]!==r[t.highParam]||n[e.lowParam]!==r[t.lowParam])}const gf=a.memo(Zw,e0);function t0({id:e,label:t,description:n,preview:r,expanded:s=!1,onToggle:l,children:i,trailing:c,className:u=""}){const d=typeof l=="function",m=e?`${e}-description`:void 0,y=e?`${e}-panel`:void 0,g=typeof t=="string"?t.trim().replace(/\s+/gu," ").replace(/:\s*$/u,""):t,x=typeof n=="string"?n.trim().replace(/\s+/gu," "):n,w=typeof r=="string"||typeof r=="number"?String(r):void 0,j=d?"button":"div",S=d?{type:"button",onClick:l,"aria-expanded":s,"aria-controls":y,"aria-describedby":x?m:void 0}:{};return o.jsxs("div",{className:["field-row",u].filter(Boolean).join(" "),children:[o.jsxs(j,{...S,className:["field-row-head",d?"is-collapsible":"is-static",s?"is-expanded":""].filter(Boolean).join(" "),children:[o.jsxs("div",{className:"field-row-main",children:[o.jsx("div",{className:"field-row-label",children:g}),x?o.jsx("div",{id:m,className:"field-row-description",children:x}):null]}),o.jsxs("div",{className:"field-row-trailing",children:[c?o.jsx("div",{className:"field-row-trailing-control",children:c}):null,r?o.jsx("div",{className:"field-row-preview",title:w,children:r}):null,d?o.jsx("div",{className:"field-row-chevron","aria-hidden":"true",children:o.jsx(pi,{size:16})}):null]})]}),d&&s?o.jsx("div",{id:y,className:"field-row-body",children:i}):null]})}const Qi=a.memo(t0),n0=16,r0=[" - "," ","-","_"],Cm=e=>[...new Set(e.filter(Boolean))],Vo=(e,t)=>{const n=String(e||"").trim(),r=r0.map(s=>`${n}${s}${t}`);return r.push(`${n}${t}`),Cm(r)},yf=(e,t)=>{const n=Vo(`${e} Strength`,t),r=Vo(e,t).map(s=>`${s} Strength`);return Cm([...n,...r])},vf=e=>String(e||"").toLowerCase().replace(/[\s_-]+/g,""),Ql=(e,t=[])=>{if(!e)return null;const n=Array.isArray(t)?t:[t];for(const s of n){if(!s)continue;const l=e.get(s);if(l)return{name:s,input:l}}const r=new Map;n.forEach(s=>{s&&r.set(vf(s),s)});for(const[s,l]of e.entries()){const i=vf(s);if(r.has(i))return{name:s,input:l}}return null},s0=Array.from({length:n0},(e,t)=>{const n=t+1,r=Vo("Lora High",n),s=Vo("Lora Low",n),l=yf("Lora High",n),i=yf("Lora Low",n);return{id:`video_lora_${n}`,label:`Video LoRA ${n}`,highParam:r[0],lowParam:s[0],highParamAliases:r,lowParamAliases:s,highStrengthParam:l[0],lowStrengthParam:i[0],highStrengthParamAliases:l,lowStrengthParamAliases:i}});function l0(e){var r,s;const t=((r=e==null?void 0:e.inputs)==null?void 0:r.param_type)||((s=e==null?void 0:e.inputs)==null?void 0:s.Param_type),n=String(t||"STRING").toUpperCase();return["NUMBER","FLOAT","INT"].includes(n)?"NUMBER":["BOOLEAN","BOOL"].includes(n)?"BOOLEAN":["DROPDOWN","CHOICE","SELECT"].includes(n)?"DROPDOWN":"STRING"}function o0(e){const t=(e==null?void 0:e.inputs)||{};return t.label||t.display_name||t.title||t.param_name||(e==null?void 0:e.title)||(e==null?void 0:e.class_type)||"Parameter"}function i0(e){const t=(e==null?void 0:e.inputs)||{};return t.description||t.help||t.tooltip||t.doc||""}function Dr(e){const t=(e==null?void 0:e.inputs)||{};return t.param_name||t.name||t.key||t.id||`param_${(e==null?void 0:e.id)||"unknown"}`}function Fs(e){const t=(e==null?void 0:e.inputs)||{},n=t.choices||t.options||[],r=t.default_value??t.value??t.default_choice??(n&&n.length?n[0]:"")??"";return{paramName:Dr(e),label:o0(e),description:i0(e),paramType:l0(e),multiline:!!t.multiline,min:typeof t.min=="number"?t.min:void 0,max:typeof t.max=="number"?t.max:void 0,step:typeof t.step=="number"?t.step:void 0,choices:n,defaultValue:r}}function a0({inputs:e=[],formData:t={},onFormChange:n,workflowName:r,onParamEdited:s,onSpotlight:l,compactControls:i=!0,collapseAllKey:c=0,collapseAllCollapsed:u=!0,lastEditedParam:d="",spotlightName:m="",onCloseSpotlight:y=()=>{},onVisibleParamsChange:g=()=>{},aliasOptions:x=[],aliasCatalog:w=[],onOpenComposer:j}){const[S,h]=a.useState({}),[f,p]=a.useState(0),v=a.useRef(t);a.useEffect(()=>{v.current=t},[t]);const k=a.useCallback((C,L)=>{if((C==null?void 0:C.paramType)==="BOOLEAN")return L?"On":"Off";if(L==null||L==="")return"Empty";if(typeof L=="string"){const E=L.trim();if(!E)return"Empty";const V=240,Y=140,se=E.length>V?E.slice(0,V):E,X=/[\r\n\t]/.test(se)||/\s{2,}/u.test(se)?se.replace(/\s+/gu," ").trim():se;if(X.length>Y)return`${X.slice(0,Y)}`;const ie=Ew(X);return E.length>V?`${ie}`:ie}return String(L)},[]),N=a.useCallback((C,L)=>{!n||!C||(n(C,L),s==null||s(C),h(E=>(E==null?void 0:E[C])===!1?E:{...E,[C]:!1}))},[n,s]),_=a.useCallback(C=>{C&&h(L=>({...L,[C]:!(L!=null&&L[C])}))},[]),I=a.useMemo(()=>e||[],[e]),z=a.useMemo(()=>{const C=new Map;return(I||[]).forEach(L=>{const E=Dr(L);E&&C.set(E,V=>N(E,V))}),C},[N,I]),T=a.useMemo(()=>{const C=new Map;return(I||[]).forEach(L=>{const E=Dr(L);E&&C.set(E,(V,Y)=>{var se,re;N(E,V),(re=(se=Y==null?void 0:Y.target)==null?void 0:se.blur)==null||re.call(se),m===E&&(y==null||y())})}),C},[N,y,m,I]),O=a.useMemo(()=>{const C=new Map;return(I||[]).forEach(L=>{const E=Dr(L);E&&C.set(E,()=>_(E))}),C},[_,I]);a.useEffect(()=>{const C={};(e||[]).forEach(L=>{const E=Dr(L);E&&(C[E]=u)}),d&&(C[d]=!1),h(C)},[c,u,e,d]);const ae=a.useMemo(()=>{const C=new Map;return(e||[]).forEach(L=>{const E=Dr(L);E&&C.set(E,L)}),C},[e]),q=a.useMemo(()=>{const C=[];return s0.forEach(L=>{const E=Ql(ae,L.highParamAliases||L.highParam),V=Ql(ae,L.lowParamAliases||L.lowParam);if(!E||!V)return;const Y=E.input,se=V.input,re=Fs(Y),X=Fs(se);if(re.paramType!=="DROPDOWN"||X.paramType!=="DROPDOWN")return;const ie=re.choices||[],G=X.choices||[];if(!ie.length||!G.length)return;const $=Ql(ae,L.highStrengthParamAliases||L.highStrengthParam),D=Ql(ae,L.lowStrengthParamAliases||L.lowStrengthParam);C.push({...L,highParam:E.name,lowParam:V.name,highStrengthParam:$==null?void 0:$.name,lowStrengthParam:D==null?void 0:D.name,highInput:Y,lowInput:se,highCfg:re,lowCfg:X})}),C},[ae]),Se=a.useMemo(()=>{const C=new Map;return q.forEach(L=>{C.set(L.highParam,L)}),C},[q]),ve=a.useMemo(()=>{const C=new Set;return q.forEach(L=>{C.add(L.highParam),C.add(L.lowParam),L.highStrengthParam&&C.add(L.highStrengthParam),L.lowStrengthParam&&C.add(L.lowStrengthParam)}),C},[q]),Q=a.useMemo(()=>{const C=[];return(I||[]).forEach(L=>{const E=Fs(L),V=E.paramName,Y=Se.get(V);if(Y){C.push({name:V,label:Y.label||E.label,description:E.description,render:se=>{const re=se||v.current||{},X=Y.highStrengthParam?re[Y.highStrengthParam]:void 0,ie=Y.lowStrengthParam?re[Y.lowStrengthParam]:void 0,G=X??ie??1;return o.jsx(gf,{name:Y.id||Y.highParam,label:Y.label||E.label,highParam:Y.highParam,lowParam:Y.lowParam,highChoices:Y.highCfg.choices,lowChoices:Y.lowCfg.choices,formData:re,onChangeParam:N,highStrengthParam:Y.highStrengthParam,lowStrengthParam:Y.lowStrengthParam,strengthValue:G,highStrengthValue:X,lowStrengthValue:ie,onChangeHighStrength:Y.highStrengthParam?z.get(Y.highStrengthParam):void 0,onChangeLowStrength:Y.lowStrengthParam?z.get(Y.lowStrengthParam):void 0,disabled:!1},`lora-${V}-${f}`)}});return}ve.has(V)||C.push({name:V,label:E.label,description:E.description,render:se=>{const re=se||v.current||{},X={name:V,label:E.label,description:E.description,value:re[V],defaultValue:E.defaultValue,disabled:!1};return E.paramType==="NUMBER"?o.jsx(Qs,{...X,onChange:z.get(V),min:E.min,max:E.max,step:E.step,isFloat:!0},`field-${V}-number-${f}`):E.paramType==="BOOLEAN"?o.jsx(ff,{...X,onChange:z.get(V)},`field-${V}-bool-${f}`):E.paramType==="DROPDOWN"?o.jsx(ac,{...X,workflowName:r,onChange:z.get(V),options:E.choices||[]},`field-${V}-dropdown-${f}`):o.jsx(uf,{...X,aliasOptions:x,aliasCatalog:w,onOpenComposer:j,onChange:z.get(V),onEnter:T.get(V),multiline:E.multiline},`field-${V}-string-${f}`)}})}),C},[I,Se,ve,f,r,x,w,j,N,z,T,m,y]),ce=a.useMemo(()=>{const C=new Map;return Q.forEach(L=>C.set(L.name,L)),C},[Q]);a.useEffect(()=>{g==null||g(Q.map(C=>C.name))},[Q,g]);const P=a.useCallback(C=>{const L=Q.map(re=>re.name),E=ce.get(C);if(!E)return;const V=L.indexOf(C),Y=V>0?L[V-1]:null,se=V>=0&&V<L.length-1?L[V+1]:null;p(re=>re+1),l==null||l({name:C,label:E.label,description:E.description,render:re=>E.render(re||v.current),order:L,index:V>=0?V:0,total:L.length,onPrev:Y?()=>P(Y):null,onNext:se?()=>P(se):null})},[ce,l,Q]);return o.jsx("div",{className:"settings-list",children:I.map(C=>{const L=Fs(C),E=L.paramName,V=Se.get(E);if(V){const{id:D,label:le,highParam:ue,lowParam:Pe,highStrengthParam:je,lowStrengthParam:Re,highCfg:Te,lowCfg:Fe}=V,Be=je?t[je]:void 0,U=Re?t[Re]:void 0,ke=Be??U??1,He=E?`param-${E}`:void 0,te=i?S[E]??!0:!!S[E],pe=te?k(L,[t[ue],t[Pe]].filter(Boolean).join("  ")):null,oe=(he=t)=>{const be=je?he==null?void 0:he[je]:void 0,Ce=Re?he==null?void 0:he[Re]:void 0,Me=be??Ce??ke;return o.jsx(gf,{name:D||ue,label:le||L.label,highParam:ue,lowParam:Pe,highChoices:Te.choices,lowChoices:Fe.choices,formData:he,onChangeParam:N,highStrengthParam:je,lowStrengthParam:Re,strengthValue:Me,highStrengthValue:be,lowStrengthValue:Ce,onChangeHighStrength:je?z.get(je):void 0,onChangeLowStrength:Re?z.get(Re):void 0,disabled:!1},`lora-${E}`)};return o.jsx("div",{id:He,"data-param-name":E,"data-param-label":le||L.label,"data-param-type":"lora_pair",className:"settings-row",children:o.jsx(Qi,{id:E,label:le||L.label,description:L.description,preview:pe,expanded:!te,onToggle:O.get(E),children:te?null:oe(t)})},`lora_pair_${D||ue}`)}if(ve.has(E))return null;const Y=t[E],re={name:E,label:L.label,description:L.description,value:Y,disabled:!1,defaultValue:L.defaultValue},X=(D=t,le=!1)=>{const ue={...re,value:D==null?void 0:D[E]};return L.paramType==="NUMBER"?o.jsx(Qs,{...ue,inputId:E,onChange:z.get(E),min:L.min,max:L.max,step:L.step,isFloat:!0},`field-${E}-number-${f}`):L.paramType==="BOOLEAN"?o.jsx(ff,{...ue,onChange:z.get(E)},`field-${E}-bool-${f}`):L.paramType==="DROPDOWN"?o.jsx(ac,{...ue,workflowName:r,onChange:z.get(E),options:L.choices||[]},`field-${E}-dropdown-${f}`):o.jsx(uf,{...ue,aliasOptions:x,aliasCatalog:w,onOpenComposer:j,onChange:z.get(E),onEnter:T.get(E),multiline:L.multiline||m===E||le},`field-${E}-string-${f}`)},ie=E?`param-${E}`:void 0,G=i?S[E]??!0:!!S[E];if(L.paramType==="BOOLEAN")return o.jsx("div",{id:ie,"data-param-name":E,"data-param-label":L.label,"data-param-type":"single",className:"settings-row",children:o.jsx(Qi,{id:E,label:L.label,description:L.description,trailing:X(t,!0)})},E);const $=G?k(L,Y):null;return o.jsx("div",{id:ie,"data-param-name":E,"data-param-label":L.label,"data-param-type":"single",className:"settings-row",children:o.jsx(Qi,{id:E,label:L.label,description:L.description,preview:$,expanded:!G,onToggle:O.get(E),children:G?null:X(t,!0)})},E)})})}function c0(e){return(e||[]).map(t=>{var n;if(["CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"].includes(t.class_type)){let r=t.class_type.replace("CozyGen","").replace("Input","").toUpperCase();return r==="CHOICE"&&(r="DROPDOWN"),{...t,inputs:{...t.inputs,param_type:r,Multiline:((n=t.inputs)==null?void 0:n.display_multiline)||!1}}}return t})}function u0({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:l=!1,collapseAllState:i=null,onSpotlight:c,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:y=[],aliasCatalog:g=[],onOpenComposer:x}){const w=a.useMemo(()=>c0((t||[]).filter(j=>j.class_type!=="CozyGenImageInput")),[t]);return o.jsx("section",{className:"settings-surface scroll-mt-24",ref:s,children:o.jsx(a0,{workflowName:e,inputs:w,formData:n,onFormChange:r,compactControls:l,collapseAllKey:(i==null?void 0:i.key)??0,collapseAllCollapsed:(i==null?void 0:i.collapsed)??!0,onSpotlight:c,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:y,aliasCatalog:g,onOpenComposer:x})})}function d0({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,parameterSectionRef:s,compactControls:l=!0,collapseAllState:i=null,onSpotlight:c,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:y=[],aliasCatalog:g=[],onOpenComposer:x}){return o.jsx(u0,{workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:l,collapseAllState:i,onSpotlight:c,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:m,aliasOptions:y,aliasCatalog:g,onOpenComposer:x})}function xf(e){try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return""}}function f0({open:e,onClose:t,logs:n=[],onClear:r}){const s=a.useMemo(()=>(n||[]).map(l=>`[${xf(l.ts)}] ${String(l.level||"info").toUpperCase()} ${l.message}`).join(`
`),[n]);return o.jsx(Mt,{open:e,onClose:t,title:"Run logs",footer:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>{var l,i;try{(i=(l=navigator.clipboard)==null?void 0:l.writeText)==null||i.call(l,s||"")}catch{}},children:"Copy"}),o.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:r,children:"Clear"}),o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Close"})]}),children:o.jsx("pre",{className:"runlog-pre",children:n!=null&&n.length?n.map((l,i)=>o.jsxs("div",{className:`runlog-line is-${l.level||"info"}`,children:[o.jsx("span",{className:"runlog-ts",children:xf(l.ts)}),o.jsx("span",{className:"runlog-msg",children:l.message})]},`${l.ts}-${i}`)):"No logs yet."})})}const p0="cozygen_field_order_v1";function h0(e,t){if(!e)return t;try{const n=JSON.parse(e);return n&&typeof n=="object"?n:t}catch{return t}}function m0(){if(typeof window>"u")return{};try{return h0(window.localStorage.getItem(p0),{})}catch{return{}}}function g0(e){if(Array.isArray(e))return{order:e.filter(Boolean),hidden:{}};if(!e||typeof e!="object")return{order:[],hidden:{}};const t=Array.isArray(e.order)?e.order.filter(Boolean):[],n=e.hidden&&typeof e.hidden=="object"?e.hidden:{};return{order:t,hidden:n}}function y0(e){if(!e)return{order:[],hidden:{}};const n=m0()[e];return g0(n)}function v0(e,t){let n=Array.isArray(t)?t:[];if(!e||n.length===0)return n;const{order:r,hidden:s}=y0(e);if(r&&r.length){const l=new Map;n.forEach(c=>{var d;const u=(d=c==null?void 0:c.inputs)==null?void 0:d.param_name;u&&!l.has(u)&&l.set(u,c)});const i=[];r.forEach(c=>{const u=l.get(c);u&&(i.push(u),l.delete(c))}),n.forEach(c=>{var d;const u=(d=c==null?void 0:c.inputs)==null?void 0:d.param_name;if(!u){i.push(c);return}l.has(u)&&(i.push(c),l.delete(u))}),n=i}return n=n.filter(l=>{var c;const i=(c=l==null?void 0:l.inputs)==null?void 0:c.param_name;return i?!s[i]:!0}),n}function x0(){const[e,t]=a.useState([]),[n,r]=a.useState(null),[s,l]=a.useState(!0),[i,c]=a.useState(null);a.useEffect(()=>{let d=!1;async function m(){l(!0),c(null);try{const y=await Fx();if(d)return;const g=(y==null?void 0:y.workflows)||[];t(g);let x=null;try{if(x=typeof window<"u"?sessionStorage.getItem("selectedWorkflow"):null,typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{x=null}if(x&&g.includes(x))r(x);else if(g.length>0){r(g[0]);try{typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",g[0])}catch{}}else r(null)}catch(y){if(d)return;console.error("Failed to load workflows",y),c(y)}finally{d||l(!1)}}return m(),()=>{d=!0}},[]);const u=a.useCallback(d=>{r(d);try{if(typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",d),typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{}},[]);return{workflows:e,selectedWorkflow:n,selectWorkflow:u,loading:s,error:i}}const w0={clip_name1:"clip",clip_name2:"clip",unet_name:"unet",vae_name:"vae",sampler_name:"sampler",scheduler:"scheduler"},S0=["CozyGenDynamicInput","CozyGenImageInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"];function j0(e){const[t,n]=a.useState(null),[r,s]=a.useState([]),[l,i]=a.useState({}),[c,u]=a.useState(!1),[d,m]=a.useState(null);a.useEffect(()=>{if(!e){n(null),s([]),i({});return}let w=!1;const j=new AbortController;async function S(){u(!0),m(null);try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:workflow:load")}catch{}try{const h=await Ox(e,{signal:j.signal});if(w)return;for(const N in h){const _=h[N];_.class_type==="CozyGenImageInput"&&!_.inputs.param_name&&(_.inputs.param_name="Image Input"),h[N].id=N}n(h);const f=Object.values(h).filter(N=>S0.includes(N.class_type)),p=await Promise.all(f.map(async N=>{const _=N.class_type==="CozyGenDynamicInput"&&N.inputs.param_type==="DROPDOWN",I=N.class_type==="CozyGenChoiceInput";if(_||I){const z=N.inputs.param_name;let T=N.inputs.choice_type||N.properties&&N.properties.choice_type;if(!T&&_&&(T=w0[z]),T)try{const O=await Za(T,{signal:j.signal,refresh:T==="loras"});N.inputs.choices=O.choices||[]}catch(O){(O==null?void 0:O.name)!=="AbortError"&&console.error(`Choices for ${z} failed`,O),N.inputs.choices=[]}}return N}));if(w)return;s(p);const v=Ww(e),k={};p.forEach(N=>{const _=N.inputs.param_name;if(!_)return;if(v[_]!==void 0){k[_]=v[_];return}let I;if(["CozyGenDynamicInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput"].includes(N.class_type)){if(I=N.inputs.default_value,N.class_type==="CozyGenIntInput"){const z=parseInt(I,10);I=Number.isNaN(z)?0:z}else if(N.class_type==="CozyGenFloatInput"){const z=parseFloat(I);I=Number.isNaN(z)?0:z}}else if(N.class_type==="CozyGenChoiceInput"){const z=N.inputs.choices||[];I=z.length?z[0]:""}else N.class_type,I="";k[_]=I}),i(k);try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:workflow:ready"),performance.measure(`cozygen:workflow:ready:${e||"unknown"}`,"cozygen:workflow:load","cozygen:workflow:ready"))}catch{}}catch(h){if(w)return;console.error("Failed to load workflow",h),m(h),n(null),s([])}finally{w||u(!1)}}return S(),()=>{Hw(e),w=!0,j.abort()}},[e]);const y=a.useMemo(()=>r.filter(w=>w.class_type==="CozyGenImageInput"),[r]),g=y[0]||null,x=a.useCallback((w,j)=>{i(S=>{const h={...S,[w]:j};return e&&Uo(e,h),h})},[e]);return{workflowData:t,dynamicInputs:r,imageInputs:y,primaryImageInput:g,formData:l,setFormData:i,handleFormChange:x,loading:c,error:d}}const wf="::";function Ys(e){const t={};return Object.entries(e||{}).forEach(([n,r])=>{const s=String(n||"").trim();if(!s||typeof r!="string")return;const l=r.trim();l&&(t[s]=l)}),t}function gu(e){const t=new Map;return Object.entries(Ys(e)).forEach(([n,r])=>{const s=n.toLowerCase();t.set(s,r),s.includes(wf)&&t.set(s.replace(wf,":"),r)}),t}function bm(e,t){if(typeof e!="string"||!e.includes("$"))return e;const n=t instanceof Map?t:gu(t);return n.size?e.replace(/\$([a-z0-9_:-]+)\$/gi,(r,s)=>{const l=n.get(s.toLowerCase());return typeof l=="string"?l:r}):e}function N0(e,t){const n=t instanceof Map?t:gu(t);if(!n.size||!e||typeof e!="object")return e;let r=!1;const s={};return Object.entries(e).forEach(([l,i])=>{if(typeof i=="string"){const c=bm(i,n);s[l]=c,c!==i&&(r=!0)}else s[l]=i}),r?s:e}function Em(e){return e?JSON.parse(JSON.stringify(e)):{}}function k0(e,t,n){const r=Em(e),s={...n||{}};if(!t||!Array.isArray(t))return{workflow:r,formData:s};for(const l of t){if(!l||!l.id||!l.inputs||!r[l.id])continue;const i=l.inputs.param_name;if(!i||l.class_type==="CozyGenImageInput")continue;let c=s[i];const u=r[l.id];if(!u||!u.inputs)continue;const d=l.class_type;c===void 0&&(d==="CozyGenChoiceInput"?c=l.inputs.value??l.inputs.default_choice??(l.inputs.choices&&l.inputs.choices[0])??"":c=l.inputs.default_value),c===void 0&&(c=""),s[i]=c,d==="CozyGenFloatInput"||d==="CozyGenIntInput"||d==="CozyGenStringInput"||d==="CozyGenDynamicInput"?u.inputs.default_value=c:d==="CozyGenChoiceInput"&&(u.inputs.value=c)}return{workflow:r,formData:s}}function yu(){const[e,t]=a.useState(()=>typeof document>"u"?!0:document.visibilityState!=="hidden");return a.useEffect(()=>{if(typeof document>"u")return;const n=()=>{t(document.visibilityState!=="hidden")};return document.addEventListener("visibilitychange",n),()=>document.removeEventListener("visibilitychange",n)},[]),e}function C0({selectedWorkflow:e,workflowData:t,dynamicInputs:n,imageInputs:r,formData:s,setFormData:l,promptAliases:i=null}){const c=yu(),[u,d]=a.useState(!1),[m,y]=a.useState(!1),[g,x]=a.useState(0),[w,j]=a.useState(0),[S,h]=a.useState("Idle"),[f,p]=a.useState("idle"),[v,k]=a.useState([]),N=a.useRef({ts:0,value:0,max:0}),_=a.useRef(null),I=a.useRef({value:0,max:0}),z=a.useRef(null),T=a.useRef(null),O=a.useRef(t),ae=a.useRef(s),q=a.useRef(!1),Se=a.useRef(0),ve=a.useRef(0),Q=a.useRef("idle"),ce=a.useRef(null),P=a.useRef(null);a.useEffect(()=>{O.current=t},[t]),a.useEffect(()=>{q.current=m},[m]),a.useEffect(()=>{Se.current=g},[g]),a.useEffect(()=>{ve.current=w},[w]),a.useEffect(()=>{Q.current=f},[f]),a.useEffect(()=>{ae.current=s},[s]);const C=()=>{ce.current&&(clearTimeout(ce.current),ce.current=null)},L=()=>{P.current&&(clearTimeout(P.current),P.current=null)},E=()=>{T.current&&(clearTimeout(T.current),T.current=null)},V=()=>{_.current&&(cancelAnimationFrame(_.current),_.current=null)},Y=a.useCallback((D,le,ue=null)=>{const Pe={ts:Date.now(),level:D||"info",message:String(le||""),extra:ue||null};k(je=>{const Re=[...je||[],Pe];return Re.length>250?Re.slice(Re.length-250):Re})},[]),se=a.useCallback(()=>k([]),[]),re=()=>{if(!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent("cozygen:queue-finished"))}catch{}},X=()=>{L(),P.current=setTimeout(()=>{q.current||(p("idle"),h("Idle"),x(0),j(0))},8e3)},ie=a.useCallback(()=>{C(),d(!1),y(!1),x(0),j(0),h("Finished"),p("finished"),Y("success","Finished"),X(),re()},[Y]),G=a.useCallback((D="Error")=>{C(),d(!1),y(!1),h(D),p("error"),Y("error",D||"Error"),X()},[Y]);a.useEffect(()=>{C(),!(!m||!w||w<=0||g<w)&&(ce.current=setTimeout(()=>{const D=q.current,le=Se.current,ue=ve.current,Pe=Q.current;D&&ue>0&&le>=ue&&Pe!=="finished"&&Pe!=="error"&&ie()},800))},[m,g,w,ie]),a.useEffect(()=>{if(typeof window>"u"||!c&&!m)return;let D=!1,le=1e3;const ue=()=>{if(D||!c&&!q.current)return;const Pe=window.location.protocol==="https:"?"wss":"ws",je=window.location.host,Re=cu(),Te=`${Pe}://${je}/ws${Re?`?token=${encodeURIComponent(Re)}`:""}`,Fe=new WebSocket(Te);z.current=Fe,Fe.onopen=()=>{le=1e3},Fe.onmessage=Be=>{var He,te,pe;if(typeof Be.data!="string")return;let U;try{U=JSON.parse(Be.data)}catch{return}const ke=U.type;if(ke==="cozygen_batch_ready"){ie();return}if(ke==="execution_success"||ke==="execution_finished"){q.current&&ie();return}if(ke==="execution_error"||ke==="execution_interrupted"){Y("error","Execution error"),G("Execution error");return}if(ke==="status"){const oe=U.data||{},he=oe.status||oe,be=he.exec_info||oe.exec_info||he;if(be&&q.current){const Ce=be.queue_remaining??be.queue_pending??be.queue_remaining_items??0;(be.queue_running??be.running??0)===0&&Ce===0&&ie()}return}if(ke==="executing"){L(),p("running");const oe=(He=U.data)==null?void 0:He.node,he=O.current;if(oe&&he&&he[oe]){const be=he[oe],Ce=be.title||be.class_type||"Node";Y("info",`Executing: ${Ce}`,{nodeId:oe}),h(`Executing: ${Ce}`)}else Y("info","Executing"),h("Executing");return}if(ke==="progress"){const oe=((te=U.data)==null?void 0:te.value)??0,he=((pe=U.data)==null?void 0:pe.max)??0;I.current={value:oe,max:he},_.current||(_.current=window.requestAnimationFrame(()=>{_.current=null;const Ge=I.current;x(Ge.value),j(Ge.max)}));const be=Date.now(),Ce=N.current;be-Ce.ts>2500&&(oe!==Ce.value||he!==Ce.max)&&he>0&&(N.current={ts:be,value:oe,max:he},Y("info",`Progress: ${oe}/${he}`));return}},Fe.onclose=()=>{D||!c&&!q.current||(E(),T.current=setTimeout(ue,le),le=Math.min(Math.ceil(le*1.6),15e3))}};return ue(),()=>{D=!0,C(),L(),E(),V(),z.current&&(z.current.onclose=null,z.current.close())}},[Y,G,ie,c,m]);const $=a.useCallback(async(D={})=>{if(!t)return;const{overrides:le=null,persistFormState:ue=!0}=D||{};C(),L(),d(!0),y(!0),h("Queuing prompt"),p("queued"),x(0),j(0),Y("info","Queuing prompt",{workflow:e||""});const Pe=ae.current||{},je=le?{...Pe,...le||{}}:Pe,Re=N0(je,i||{}),{workflow:Te,formData:Fe}=k0(t,n||[],Re||{}),Be={...Fe,...je};ue&&e&&Uo(e,Be),ue&&l(Be);const U=r||[];for(const ke of U){if(!ke||!ke.id||!ke.inputs)continue;const He=ke.inputs.param_name;if(!He)continue;const te=Be[He];if(!te){alert(`Please upload or select an image for "${He}" before generating.`),G("Missing image input");return}Te[ke.id]&&Te[ke.id].inputs&&(Te[ke.id].inputs.image_filename=te)}try{let ke=Te;if(i){const He=te=>{if(typeof te=="string")return bm(te,i);if(Array.isArray(te))return te.map(pe=>He(pe));if(te&&typeof te=="object"){const pe=Array.isArray(te)?[]:{};return Object.entries(te).forEach(([oe,he])=>{pe[oe]=He(he)}),pe}return te};try{ke=He(Te)}catch{ke=Te}}cm({workflowName:e,workflow:ke,timestamp:Date.now()}),await uu({prompt:ke}),Y("info","Prompt queued")}catch(ke){console.error("Failed to queue prompt",ke),ke!=null&&ke.unauthorized?(Y("error","Session expired. Please sign in again."),G("Session expired. Please sign in again."),window.location.hash="#/login"):(Y("error","Error queuing prompt"),G("Error queuing prompt"))}},[t,n,r,i,e,l,G,Y]);return{isLoading:u,progressValue:g,progressMax:w,statusText:S,statusPhase:f,handleGenerate:$,logEntries:v,clearLogs:se}}const Lm="cozygen_prompt_aliases",Pm="cozygen_alias_categories",_m="cozygen_alias_category_list";function Sf(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Lm);return e?JSON.parse(e)||{}:{}}catch{return{}}}function Yi(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Lm,JSON.stringify(e||{}))}catch{}}function jf(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Pm);return e?JSON.parse(e)||{}:{}}catch{return{}}}function qi(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Pm,JSON.stringify(e||{}))}catch{}}function Nf(){if(typeof window>"u")return[];try{const e=window.localStorage.getItem(_m);return Array.isArray(JSON.parse(e))?JSON.parse(e):[]}catch{return[]}}function Xi(e){if(!(typeof window>"u"))try{window.localStorage.setItem(_m,JSON.stringify(e||[]))}catch{}}function Rm(){const[e,t]=a.useState(()=>Sf()),[n,r]=a.useState(()=>jf()),[s,l]=a.useState(()=>Nf()),[i,c]=a.useState(!1),[u,d]=a.useState(!1),[m,y]=a.useState(null),g=a.useCallback(async()=>{c(!0),y(null);try{const S=await Ux(),h=Ys((S==null?void 0:S.items)||S||{}),f=(S==null?void 0:S.categories)||{},p=Array.isArray(S==null?void 0:S.categoryList)?S.categoryList:[];t(h),r(f),l(p),Yi(h),qi(f),Xi(p)}catch(S){console.error("Failed to load prompt aliases",S),y(S);const h=Ys(Sf()),f=jf(),p=Nf();t(h),r(f),l(p)}finally{c(!1)}},[]),x=a.useCallback(async S=>{const h=(S==null?void 0:S.items)||S||{},f=(S==null?void 0:S.categories)||n||{},p=Array.isArray(S==null?void 0:S.categoryList)&&S.categoryList.length?S.categoryList:s.length?s:Array.from(new Set(Object.values(f).filter(Boolean))),v=Ys(h||{});d(!0),y(null);try{await Vx({items:v,categories:f,categoryList:p}),t(v),r(f),l(p),Yi(v),qi(f),Xi(p)}catch(k){throw console.error("Failed to save prompt aliases",k),y(k),Yi(v),qi(f),Xi(p),k}finally{d(!1)}},[n,s]);a.useEffect(()=>{g()},[g]);const w=a.useMemo(()=>{const S=gu(e),h=new Map(S);return Object.entries(n||{}).forEach(([f,p])=>{const v=String(p||"").trim();v&&(e!=null&&e[f])&&h.set(`${v}:${f}`,e[f])}),h},[e,n]),j=a.useMemo(()=>{const S=new Set,h=[];return w.forEach((f,p)=>{let v=p.includes("::")?p.replace("::",":"):p;const k=v.split(":");k.length>=3&&k[0]&&k[1]&&k[0].toLowerCase()===k[1].toLowerCase()&&(v=[k[0],...k.slice(2)].join(":"));const N=v.toLowerCase();S.has(N)||(S.add(N),h.push(v))}),h},[w]);return{aliases:e,aliasCategories:n,categoryList:s,aliasLookup:w,aliasOptions:j,loading:i,saving:u,error:m,refreshAliases:g,persistAliases:x}}const Im=a.createContext(null);function zm(){const e=a.useContext(Im);if(!e)throw new Error("useStudioContext must be used within a StudioProvider");return e}function b0({children:e}){const{workflows:t,selectedWorkflow:n,selectWorkflow:r,loading:s,error:l}=x0(),{workflowData:i,dynamicInputs:c,imageInputs:u,primaryImageInput:d,formData:m,setFormData:y,handleFormChange:g,loading:x,error:w}=j0(n),j=Rm(),S=a.useMemo(()=>{const ae=[];return Object.entries(j.aliases||{}).forEach(([q,Se])=>{const ve=String(q).split("::"),Q=ve.length>1,ce=j.aliasCategories&&j.aliasCategories[q]||(Q?ve[0]:""),P=Q?ve.slice(1).join("::"):q,C={key:q,name:P,category:ce,text:Se,token:ce?`${ce}:${P}`:P};ae.push({...C,...mu(C)})}),ae},[j.aliases,j.aliasCategories]),h=a.useMemo(()=>v0(n,c),[n,c]),f=a.useMemo(()=>{const ae=(h||c||[]).filter(P=>(P==null?void 0:P.class_type)!=="CozyGenImageInput"),q=/\b(checkpoint|ckpt|lora|model|vae|embedding|clip|sampler|scheduler|seed)\b/i,Se=P=>{const C=String((P==null?void 0:P.paramName)||"").toLowerCase(),L=String((P==null?void 0:P.label)||"").toLowerCase(),E=`${C} ${L}`,V=m==null?void 0:m[P==null?void 0:P.paramName],Y=typeof V=="string"?V:"";let se=0;return E.includes("prompt")&&(se+=100),E.includes("negative")&&E.includes("prompt")&&(se-=15),P!=null&&P.multiline&&(se+=10),Y.includes("$")&&(se+=20),q.test(E)&&(se-=200),wm(Y)&&(se-=200),se};if(typeof(m==null?void 0:m.prompt)=="string")return"prompt";const ve=ae.map(P=>Fs(P)).filter(P=>(P==null?void 0:P.paramType)==="STRING"&&(P==null?void 0:P.paramName));if(!ve.length)return"prompt";let Q=ve[0],ce=Se(Q);for(let P=1;P<ve.length;P+=1){const C=ve[P],L=Se(C);L>ce&&(Q=C,ce=L)}return(Q==null?void 0:Q.paramName)||"prompt"},[c,m,h]),{isLoading:p,progressValue:v,progressMax:k,statusText:N,statusPhase:_,handleGenerate:I,logEntries:z,clearLogs:T}=C0({selectedWorkflow:n,workflowData:i,dynamicInputs:c,imageInputs:u,formData:m,setFormData:y,promptAliases:j.aliasLookup});a.useEffect(()=>{if(_==="finished"&&!(typeof window>"u")){try{window.localStorage.setItem("cozygen_gallery_pending","1")}catch{}window.dispatchEvent(new Event("cozygen:gallery-pending"))}},[_]),a.useEffect(()=>{if(typeof window>"u")return;const ae=_==="queued"||_==="running"||p;try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:ae}}))}catch{}},[_,p]);const O=a.useMemo(()=>({workflows:t,selectedWorkflow:n,selectWorkflow:r,workflowsLoading:s,workflowsError:l,workflowData:i,dynamicInputs:c,orderedDynamicInputs:h,imageInputs:u,primaryImageInput:d,formData:m,setFormData:y,handleFormChange:g,workflowLoading:x,workflowError:w,promptFieldName:f,aliasOptions:j.aliasOptions,aliasCatalog:S,aliasLookup:j.aliasLookup,aliasCategories:j.aliasCategories,aliasLoading:j.loading,aliasSaving:j.saving,aliasError:j.error,refreshAliases:j.refreshAliases,persistAliases:j.persistAliases,isLoading:p,progressValue:v,progressMax:k,statusText:N,statusPhase:_,handleGenerate:I,logEntries:z,clearLogs:T}),[t,n,r,s,l,i,c,h,u,d,m,y,g,x,w,f,j.aliasOptions,j.aliasLookup,j.aliasCategories,S,j.loading,j.saving,j.error,j.refreshAliases,j.persistAliases,p,v,k,N,_,I,z,T]);return o.jsx(Im.Provider,{value:O,children:e})}function E0(){const e=kn(),{workflows:t=[],selectedWorkflow:n,selectWorkflow:r,workflowData:s,dynamicInputs:l=[],imageInputs:i=[],formData:c,setFormData:u,handleFormChange:d,aliasOptions:m,aliasCatalog:y,isLoading:g,progressValue:x,progressMax:w,statusText:j,statusPhase:S,handleGenerate:h,logEntries:f,clearLogs:p,promptFieldName:v,orderedDynamicInputs:k}=zm(),N=a.useRef(null),_=a.useRef(null),[I,z]=a.useState(()=>Qw()),[T,O]=a.useState(null),ae=(T==null?void 0:T.name)||"",q=a.useCallback(()=>O(null),[]),[Se,ve]=a.useState(!1),[Q,ce]=a.useState([]),[P,C]=a.useState([]),[L,E]=a.useState(""),[V,Y]=a.useState(""),[se,re]=a.useState(""),X=a.useRef(new Map),ie=a.useCallback((te="")=>{const oe=`?field=${encodeURIComponent(te||v||"prompt")}`;e(`/compose${oe}`)},[e,v]),G=a.useCallback(te=>{!te||te===n||(n&&Uo(n,c||{},{immediate:!0}),E(""),Y(""),re(""),r(te))},[c,n,r]),$=a.useMemo(()=>{const pe=[...k||[],...i||[]].map(oe=>{var he;return(he=oe==null?void 0:oe.inputs)==null?void 0:he.param_name}).filter(oe=>oe&&typeof oe=="string");return new Set(pe)},[k,i]),D=a.useCallback(te=>{Y(te);const pe=P.find(be=>be.id===te);if(E((pe==null?void 0:pe.name)||""),!te||!(pe!=null&&pe.values)||!n){te||re("");return}const oe=$,he={};Object.entries(pe.values).forEach(([be,Ce])=>{(!oe.size||oe.has(be))&&(he[be]=Ce)}),u(be=>{const Ce={...be,...he};return Uo(n,Ce,{immediate:!0}),Ce}),re(`Applied "${pe.name}".`)},[$,P,n,u]),le=i||[],ue=!!(s&&n),Pe=le.length>0,je=a.useCallback((te,pe)=>{const oe=X.current;pe&&te&&oe.set(te,pe);const he=Q.length?Q:(pe==null?void 0:pe.order)||[],be=he.length,Ce=be>0?he.indexOf(te):-1,Me=Ce>0?he[Ce-1]:null,Ge=Ce>=0&&Ce<be-1?he[Ce+1]:null,ct=Me?oe.get(Me):null,yt=Ge?oe.get(Ge):null;return{...pe,index:Ce>=0?Ce:0,total:be,onPrev:ct?()=>O(je(Me,ct)):null,onNext:yt?()=>O(je(Ge,yt)):null,onRender:h}},[Q,h]),Re=a.useCallback(te=>{const pe=te||[];ce(oe=>oe.length===pe.length&&oe.every((he,be)=>he===pe[be])?oe:pe)},[]),Te=a.useCallback(te=>{const pe=te||"";z(pe),Kw(pe)},[]),Fe=a.useCallback(te=>{te!=null&&te.name&&O(je(te.name,te))},[je]),Be=a.useCallback(async te=>{if(!te){C([]),Y("");return}try{const pe=await Wx(te),oe=Array.isArray(pe==null?void 0:pe.presets)?pe.presets:[];C(oe),Y(he=>he&&oe.some(be=>be.id===he)?he:"")}catch(pe){console.error("Failed to load workflow presets",pe),C([]),re("Presets unavailable.")}},[]);a.useEffect(()=>{Be(n)},[n,Be]);const U=a.useCallback(async()=>{if(!n)return;const te=L.trim();if(!te){re("Name a preset to save.");return}const pe={},oe=$;Object.entries(c||{}).forEach(([Ce,Me])=>{(!oe.size||oe.has(Ce))&&(pe[Ce]=Me)});const he=P.find(Ce=>Ce.id===V),be=he&&he.name.toLowerCase()===te.toLowerCase()?he.id:void 0;try{const Ce=await Hx(n,{id:be,name:te,values:pe}),Me=Array.isArray(Ce==null?void 0:Ce.presets)?Ce.presets:[],Ge=Ce==null?void 0:Ce.preset;C(Me),Ge!=null&&Ge.id&&Y(Ge.id),re(`Saved "${te}".`)}catch(Ce){console.error("Failed to save preset",Ce),re("Save failed.")}},[$,c,L,P,V,n]),ke=a.useCallback(async()=>{if(!(!n||!V))try{const te=await Gx(n,V),pe=Array.isArray(te==null?void 0:te.presets)?te.presets:[];C(pe),Y(""),re("Preset deleted.")}catch(te){console.error("Failed to delete preset",te),re("Delete failed.")}},[V,n]),He=a.useCallback(()=>{var te;return(te=T==null?void 0:T.render)==null?void 0:te.call(T,c)},[T,c]);return a.useEffect(()=>{const te=()=>{!ue||g||h()};return window.addEventListener("cozygen:request-render",te),()=>window.removeEventListener("cozygen:request-render",te)},[h,ue,g]),!t||t.length===0?o.jsx("div",{className:"page-shell",children:o.jsx("div",{className:"neon-card px-3 py-3 sm:px-4 sm:py-4",children:o.jsx("p",{className:"text-sm text-[#9DA3FFCC]",children:"No workflows found. Drop a workflow file in CozyGen and refresh."})})}):o.jsxs("div",{className:"page-shell page-stack has-dock controls-page",children:[o.jsxs("div",{className:"page-bar controls-bar",children:[o.jsx("h1",{className:"page-bar-title",children:"Controls"}),o.jsx("div",{className:"page-bar-actions",children:I?o.jsxs("span",{className:"controls-meta",children:["Last: ",I]}):null})]}),o.jsxs("section",{className:"controls-board",children:[o.jsx(_w,{workflows:t,selectedWorkflow:n,onWorkflowChange:G,workflowData:s,presets:P,presetName:L,onPresetNameChange:E,selectedPresetId:V,onPresetSelect:D,onPresetSave:U,onPresetDelete:ke,presetStatus:se}),Pe?o.jsx(oc,{ref:_,className:"controls-panel",title:o.jsxs(o.Fragment,{children:[o.jsx(ew,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Images"]}),bodyClassName:"control-shell controls-body",defaultOpen:!1,children:s?o.jsx("div",{className:"grid grid-cols-1 gap-3 lg:grid-cols-2",children:le.map(te=>o.jsx(Sw,{input:te,value:c[te.inputs.param_name]||"",onFormChange:d},te.id))}):null}):null,o.jsx(oc,{title:o.jsxs(o.Fragment,{children:[o.jsx(pu,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Parameters"]}),bodyClassName:"control-shell controls-body",defaultOpen:!0,className:"controls-panel",children:s?o.jsx(d0,{workflowName:n,dynamicInputs:k,formData:c,onFormChange:d,parameterSectionRef:N,compactControls:!0,lastEditedParam:I,spotlightName:ae,onCloseSpotlight:q,onVisibleParamsChange:Re,aliasOptions:m,aliasCatalog:y,onOpenComposer:ie,onParamEdited:Te,onSpotlight:Fe}):o.jsxs("div",{className:"empty-state-inline",children:[o.jsx("span",{className:"empty-state-arrow",children:o.jsx(tw,{size:20})}),o.jsx("span",{children:"Select a workflow above to get started"})]})})]}),o.jsxs("div",{className:"controls-status-strip",children:[o.jsxs("div",{className:"controls-status-left",children:[o.jsx("span",{className:`controls-status-dot is-${S||"idle"}`,"aria-hidden":"true"}),o.jsxs("div",{className:"controls-status-text",children:[o.jsx("span",{className:"controls-status-phase",children:S||"idle"}),o.jsx("span",{className:"controls-status-msg",children:j||"Idle"})]})]}),o.jsxs("div",{className:"controls-status-right",children:[g&&w>0?o.jsx("div",{className:"controls-status-meter","aria-label":"Progress",children:o.jsx("div",{className:"controls-status-meter-fill",style:{width:`${Math.max(0,Math.min(100,Math.round((x||0)/w*100)))}%`}})}):null,o.jsx("button",{type:"button",className:"controls-status-btn",onClick:()=>ve(!0),children:"Logs"})]})]}),o.jsx("section",{className:"dock-panel",children:o.jsx(uw,{busy:g,progressValue:x,progressMax:w,statusText:j,statusPhase:S,primaryLabel:"Render",onPrimary:h,primaryDisabled:!ue,onLogs:()=>ve(!0)})}),o.jsx(jw,{open:!!T,onClose:q,title:T==null?void 0:T.label,description:T==null?void 0:T.description,render:He,index:(T==null?void 0:T.index)??0,total:(T==null?void 0:T.total)??0,onPrev:(T==null?void 0:T.onPrev)||null,onNext:(T==null?void 0:T.onNext)||null,onRender:(T==null?void 0:T.onRender)||null,children:null}),o.jsx(f0,{open:Se,onClose:()=>ve(!1),logs:f,onClear:p})]})}function L0(){return o.jsx("div",{className:"page-shell page-stack",children:o.jsxs("section",{className:"home-hero",children:[o.jsx("span",{className:"home-hero-orb is-warm","aria-hidden":"true"}),o.jsx("span",{className:"home-hero-orb is-cool","aria-hidden":"true"}),o.jsx("span",{className:"home-hero-spark","aria-hidden":"true"}),o.jsx("span",{className:"home-hero-beam","aria-hidden":"true"}),o.jsx("span",{className:"home-hero-ring","aria-hidden":"true"}),o.jsxs("div",{className:"home-hero-inner home-hero-full",children:[o.jsx("div",{className:"home-hero-kicker",children:"CozyGen Studio"}),o.jsx("h1",{className:"home-hero-title",children:"Creative studio for prompt-first storytelling"}),o.jsx("p",{className:"home-hero-description",children:"CozyGen is a quiet, cinematic workspace for people who sketch with wordsshape the mood, stage the scene, then send it down the render runway without losing your flow."}),o.jsxs("div",{className:"home-info-grid",children:[o.jsxs("article",{className:"home-info-card",children:[o.jsx("h3",{children:"Control as composition"}),o.jsx("p",{children:"Dial the palette, tempo, and texture in one place. The controls read like a creative brief, not a checklist."})]}),o.jsxs("article",{className:"home-info-card",children:[o.jsx("h3",{children:"Alias & tag storyboards"}),o.jsx("p",{children:"Save characters, atmospheres, and motifs as building blocks, then arrange them like panels in a storyboard."})]}),o.jsxs("article",{className:"home-info-card",children:[o.jsx("h3",{children:"Gallery inspiration"}),o.jsx("p",{children:"Pin your strongest frames, compare variations, and carry the aesthetic through to your next scene."})]}),o.jsxs("article",{className:"home-info-card",children:[o.jsx("h3",{children:"Render runway"}),o.jsx("p",{children:"Stack iterations like takes on a set. Keep composing while the queue runs in the background."})]})]})]})]})})}function P0({subfolder:e,crumbs:t=[],dirChips:n=[],onBack:r,onRoot:s,onCrumb:l,onSelectDir:i}){return o.jsxs("div",{className:"gallery-nav",children:[o.jsx("div",{className:"gallery-crumbs",role:"navigation","aria-label":"Gallery path",children:t.map((c,u)=>o.jsxs(a.Fragment,{children:[o.jsx("span",{className:"text-[#6A6FA8]",children:"/"}),o.jsx("button",{type:"button",className:"gallery-chip-btn",onClick:()=>l==null?void 0:l(c.path),"aria-current":u===t.length-1?"page":void 0,children:c.name})]},c.path||c.name||u))}),n.length>0?o.jsx("div",{className:"gallery-dir-chips",children:n.map(c=>o.jsx("button",{type:"button",className:"gallery-chip-btn",onClick:()=>i==null?void 0:i(c.subfolder),children:c.filename||c.subfolder||"Collection"},c.subfolder||c.filename))}):null]})}const _0=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),R0=({src:e,poster:t,autoPlay:n})=>{const r=a.useRef(null),s=yu();return a.useEffect(()=>{const l=r.current;l&&(l.pause(),l.currentTime=0,l.load())},[e]),a.useEffect(()=>{const l=r.current;if(!l)return;let i;const c=()=>{const d=l.play();d&&typeof d.catch=="function"&&d.catch(()=>{})},u=()=>{l.pause()};return n?s?typeof window<"u"&&"IntersectionObserver"in window?(i=new IntersectionObserver(m=>{m.forEach(y=>{y.isIntersecting?c():u()})},{threshold:.65}),i.observe(l)):c():u():(u(),l.currentTime=0),()=>{i&&i.disconnect(),u()}},[n,e,s]),e?o.jsx("video",{ref:r,src:e,poster:t||void 0,muted:!0,playsInline:!0,loop:!0,preload:n?"metadata":"none",className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40"}):o.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})},kf={contentVisibility:"auto",containIntrinsicSize:"260px 320px"};function I0({item:e,onSelect:t,variant:n="grid",autoPlay:r=!1}){if(!e)return null;const s=e.type==="directory",l=e.filename||"",i=e.subfolder||"",c=l||i||"Unknown",u=!!(e!=null&&e.meta&&(e.meta.model||e.meta.prompt||Array.isArray(e.meta.loras)&&e.meta.loras.length)),d=()=>{t&&t(e)},m=n==="feed"?768:384,y=!s&&l?`/cozygen/thumb?type=output&subfolder=${encodeURIComponent(i)}&filename=${encodeURIComponent(l)}&w=`:null,g=y?`${y}${m}`:null,x=y?n==="feed"?`${y}384 384w, ${y}768 768w`:`${y}192 192w, ${y}384 384w`:null,w=n==="feed"?"(max-width: 768px) 92vw, 768px":"(max-width: 640px) 45vw, (max-width: 1024px) 30vw, 240px",j=!s&&l?(()=>{const h=e.type&&e.type!=="directory"?e.type:"output",f=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(l)}&subfolder=${encodeURIComponent(i)}&type=${encodeURIComponent(h)}${f}`})():null,S=_0(l);if(s)return o.jsx("button",{type:"button",onClick:d,className:"gallery-dir-tile",style:kf,children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"h-7 w-7 rounded-lg bg-gradient-to-br from-[#6B5BFF] to-[#FF4F9A] opacity-80 group-hover:opacity-100 flex items-center justify-center text-[11px] text-white",children:""}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"text-[11px] font-medium text-[#E5E7FF] truncate",children:c}),o.jsx("div",{className:"text-[10px] text-[#9DA3FFCC] truncate",children:"Collection"})]})]})});if(n==="feed"){const h={contentVisibility:"auto",containIntrinsicSize:"520px 720px"};return o.jsx("div",{className:"gallery-feed-item",style:h,children:o.jsxs("button",{type:"button",onClick:d,className:"gallery-feed-media",children:[u?o.jsx("span",{className:"gallery-meta-badge",role:"img","aria-label":"Metadata available",title:"Metadata available",children:"i"}):null,o.jsx("div",{className:"relative w-full flex items-center justify-center bg-[#020312]",children:S?o.jsx(R0,{src:j,poster:g,autoPlay:r}):g?o.jsx("img",{src:g,srcSet:x||void 0,sizes:w,alt:c,className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40",loading:"lazy",decoding:"async"}):o.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})}),o.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#05071680] opacity-0 group-hover:opacity-100 transition-opacity"}),S&&o.jsx("div",{className:"pointer-events-none absolute left-2 top-2 rounded-md bg-[#050716CC] px-2 py-[1px] text-[10px] text-[#CFFAFE] border border-[#3EF0FF80]",children:"Video"})]})})}return o.jsx("button",{type:"button",onClick:d,className:"gallery-tile",style:kf,children:o.jsxs("div",{className:"gallery-tile-media",children:[u?o.jsx("span",{className:"gallery-meta-badge",role:"img","aria-label":"Metadata available",title:"Metadata available",children:"i"}):null,g?o.jsx("img",{src:g,srcSet:x||void 0,sizes:w,alt:c,className:"gallery-tile-img",loading:"lazy",decoding:"async"}):o.jsx("div",{className:"gallery-tile-empty",children:"No preview"}),S&&o.jsx("div",{className:"gallery-badge",children:"Video"})]})})}const Cf=a.memo(I0),vu=["seed","noise_seed"],Am=["ckpt_name","checkpoint","ckpt","model_name"],cc=["lora_name"],Tm=["width","image_width"],Mm=["height","image_height"],kl=e=>String(e||"").toLowerCase(),ml=e=>(e==null?void 0:e.class_type)==="CozyGenDynamicInput"||(e==null?void 0:e.class_type)==="CozyGenChoiceInput",gl=e=>{var t;return kl((t=e==null?void 0:e.inputs)==null?void 0:t.choice_type)},Wo=(e,t)=>{e!=null&&e.inputs&&("default_value"in e.inputs&&(e.inputs.default_value=t),"value"in e.inputs&&(e.inputs.value=t))},$m=e=>kl(e==null?void 0:e.class_type).includes("checkpoint"),Fm=e=>kl(e==null?void 0:e.class_type).includes("lora"),Om=e=>kl(e==null?void 0:e.class_type).includes("seed"),xu=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;const t=parseInt(String(e),10);return Number.isFinite(t)?t:null},Nn=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;const t=parseInt(String(e),10);return Number.isFinite(t)?t:null},Yl=e=>e!=null&&e.inputs?"default_value"in e.inputs?Nn(e.inputs.default_value):"value"in e.inputs?Nn(e.inputs.value):null:null,uc=e=>{var t;return kl((t=e==null?void 0:e.inputs)==null?void 0:t.param_name)},ql=(e,t)=>{if(!(e!=null&&e.inputs))return!1;let n=!1;return"default_value"in e.inputs&&Nn(e.inputs.default_value)!==null&&(e.inputs.default_value=t,n=!0),"value"in e.inputs&&Nn(e.inputs.value)!==null&&(e.inputs.value=t,n=!0),n},bf=(e,t)=>{if(!(e!=null&&e.inputs))return!1;let n=!1;return vu.forEach(r=>{if(!(r in e.inputs))return;const s=e.inputs[r];Array.isArray(s)||xu(s)!==null&&(e.inputs[r]=t,n=!0)}),n},z0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(vu.forEach(s=>{if(!(s in r.inputs))return;const l=r.inputs[s];if(Array.isArray(l)&&l.length){n.add(l[0]);return}xu(l)!==null&&(r.inputs[s]=t)}),Om(r)&&bf(r,t))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&bf(s,t)})},A0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(ml(r)&&gl(r)==="checkpoints"&&Wo(r,t),$m(r)&&Am.forEach(s=>{if(!(s in r.inputs))return;const l=r.inputs[s];if(Array.isArray(l)&&l.length){n.add(l[0]);return}(typeof l=="string"||typeof l=="number")&&(r.inputs[s]=t)}))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&ml(s)&&gl(s)==="checkpoints"&&Wo(s,t)})},T0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(ml(r)&&gl(r)==="loras"&&Wo(r,t),(Fm(r)||cc.some(s=>s in r.inputs))&&cc.forEach(s=>{if(!(s in r.inputs))return;const l=r.inputs[s];if(Array.isArray(l)&&l.length){n.add(l[0]);return}(typeof l=="string"||typeof l=="number")&&(r.inputs[s]=t)}))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&ml(s)&&gl(s)==="loras"&&Wo(s,t)})},M0=(e,t,n)=>{if(t===null&&n===null)return;const r=new Set,s=new Set;Object.values(e||{}).forEach(l=>{if(!(l!=null&&l.inputs))return;const i=l.inputs,c=uc(l);t!==null&&c==="width"&&ql(l,t),n!==null&&c==="height"&&ql(l,n),t!==null&&Tm.forEach(u=>{if(!(u in i))return;const d=i[u];if(Array.isArray(d)&&d.length){r.add(d[0]);return}Nn(d)!==null&&(i[u]=t)}),n!==null&&Mm.forEach(u=>{if(!(u in i))return;const d=i[u];if(Array.isArray(d)&&d.length){s.add(d[0]);return}Nn(d)!==null&&(i[u]=n)})}),r.forEach(l=>{const i=e==null?void 0:e[l];i&&ql(i,t)}),s.forEach(l=>{const i=e==null?void 0:e[l];i&&ql(i,n)})};function $0(e){const t={hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null},n=new Set,r=new Set;return Object.values(e||{}).forEach(s=>{const l=(s==null?void 0:s.inputs)||{};if(l){if(vu.forEach(i=>{i in l&&(t.hasSeed=!0)}),$m(s)&&(t.hasCheckpoint=!0,Am.forEach(i=>{const c=l[i];typeof c=="string"&&c&&n.add(c)})),Fm(s)||cc.some(i=>i in l)){t.hasLora=!0;const i=l.lora_name;typeof i=="string"&&i&&r.add(i)}if(ml(s)){const i=gl(s),c=l.default_value??l.value;i==="checkpoints"&&(t.hasCheckpoint=!0,typeof c=="string"&&c&&n.add(c)),i==="loras"&&(t.hasLora=!0,typeof c=="string"&&c&&r.add(c))}if(Om(s)&&"seed"in l&&(t.hasSeed=!0),t.width===null&&uc(s)==="width"){const i=Yl(s);i!==null&&(t.width=i)}if(t.height===null&&uc(s)==="height"){const i=Yl(s);i!==null&&(t.height=i)}t.width===null&&Tm.forEach(i=>{if(!(i in l)||t.width!==null)return;const c=l[i];if(Array.isArray(c)&&c.length){const d=e==null?void 0:e[c[0]],m=Yl(d);m!==null&&(t.width=m);return}const u=Nn(c);u!==null&&(t.width=u)}),t.height===null&&Mm.forEach(i=>{if(!(i in l)||t.height!==null)return;const c=l[i];if(Array.isArray(c)&&c.length){const d=e==null?void 0:e[c[0]],m=Yl(d);m!==null&&(t.height=m);return}const u=Nn(c);u!==null&&(t.height=u)})}}),t.checkpoint=n.values().next().value||"",t.loras=Array.from(r),t.hasSize=t.width!==null||t.height!==null,t}function F0(e,t={}){if(!e)return e;const n=Em(e),{seedMode:r="keep",seedValue:s=null,checkpoint:l=null,lora:i=null,width:c=null,height:u=null}=t;if(r&&r!=="keep"){const y=r==="random"?Math.floor(Math.random()*4294967295):xu(s);y!==null&&z0(n,y)}l&&A0(n,l),i&&T0(n,i);const d=Nn(c),m=Nn(u);return(d!==null||m!==null)&&M0(n,d,m),n}const O0=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),D0=e=>{if(!e)return"";const t=e.filename||"",n=e.subfolder||"",r=e.type||"output",s=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(t)}&subfolder=${encodeURIComponent(n)}&type=${encodeURIComponent(r)}${s}`},Ef=e=>{if(!hs(e))return null;const{folderPath:t,base:n}=gi(e);return{folderPath:t||"root",base:n||""}},Lf=(e="")=>{if(!e||e==="root")return"root";const t=e.split("/").filter(Boolean);return t[t.length-1]||e};function B0({isOpen:e,media:t,onClose:n,onPrev:r,onNext:s,total:l=0,canPrev:i=!1,canNext:c=!1}){var Cn;const u=a.useRef(!1),d=a.useRef(null),[m,y]=a.useState(!1),[g,x]=a.useState(!1),[w,j]=a.useState(!1),S=a.useRef(null),h=a.useRef(null),f=a.useRef(!1),p=a.useRef(null),[v,k]=a.useState(!1),[N,_]=a.useState("random"),[I,z]=a.useState(""),[T,O]=a.useState(""),[ae,q]=a.useState(""),[Se,ve]=a.useState(""),[Q,ce]=a.useState(""),[P,C]=a.useState("All"),[L,E]=a.useState("All"),[V,Y]=a.useState({hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null}),[se,re]=a.useState(!1),[X,ie]=a.useState(""),[G,$]=a.useState(!1),[D,le]=a.useState(""),[ue,Pe]=a.useState([]),[je,Re]=a.useState([]),Te=a.useRef(null),Fe=a.useRef(null),Be=W=>W?Array.from(W.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(ne=>!ne.hasAttribute("disabled")&&ne.getAttribute("aria-hidden")!=="true"):[];a.useEffect(()=>{if(!e)return;const W=ne=>{ne.key==="Escape"&&(n==null||n()),ne.key==="ArrowLeft"&&i&&(r==null||r()),ne.key==="ArrowRight"&&c&&(s==null||s())};return window.addEventListener("keydown",W),()=>window.removeEventListener("keydown",W)},[e,n,s,r,i,c]),a.useEffect(()=>{e&&(y(!1),k(!1),j(!1),_("random"),z(""),O(""),q(""),ve(""),ce(""),C("All"),E("All"),Y({hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null}),re(!1),ie(""),$(!1),le(""),Pe([]),Re([]),Te.current=null,Fe.current&&(Fe.current.abort(),Fe.current=null),f.current=!0,p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{f.current=!1,p.current=null},250))},[e,t]),a.useEffect(()=>()=>{p.current&&(clearTimeout(p.current),p.current=null)},[]),a.useEffect(()=>{if(!e||typeof document>"u")return;const W=S.current;h.current=document.activeElement;const ne=()=>{var St;const Ae=Be(W),We=d.current||Ae[0]||W;(St=We==null?void 0:We.focus)==null||St.call(We)},Ie=Ae=>{if(Ae.key!=="Tab"||!W)return;const We=Be(W);if(!We.length){Ae.preventDefault(),W.focus();return}const St=We[0],bl=We[We.length-1],El=document.activeElement;Ae.shiftKey&&El===St?(Ae.preventDefault(),bl.focus()):!Ae.shiftKey&&El===bl&&(Ae.preventDefault(),St.focus())};return requestAnimationFrame(ne),W==null||W.addEventListener("keydown",Ie),()=>{var We;W==null||W.removeEventListener("keydown",Ie);const Ae=h.current;Ae&&document.contains(Ae)&&((We=Ae.focus)==null||We.call(Ae))}},[e]);const U=!!t,ke=t?D0(t):"",He=(t==null?void 0:t.subfolder)||"Gallery",te=O0((t==null?void 0:t.filename)||""),pe=l>1,oe=(t==null?void 0:t.meta)||{},he=[oe!=null&&oe.model?{label:"Model",value:oe.model}:null,oe!=null&&oe.prompt?{label:"Prompt",value:oe.prompt,isPrompt:!0}:null,Array.isArray(oe==null?void 0:oe.loras)&&oe.loras.length?{label:"LoRAs",value:oe.loras.join(", ")}:null].filter(Boolean),be=!!((Cn=t==null?void 0:t.meta)!=null&&Cn.has_prompt||he.length),Ce=typeof(t==null?void 0:t.filename)=="string"&&t.filename.toLowerCase().endsWith(".png"),Me=U&&be&&Ce,Ge=a.useMemo(()=>[{key:"random",label:"Random"},{key:"keep",label:"Keep"},{key:"custom",label:"Custom"}],[]),ct=a.useMemo(()=>{if(N!=="custom")return null;const W=parseInt(String(I),10);return Number.isFinite(W)?W:null},[I,N]),yt=N!=="custom"||ct!==null,ft=a.useMemo(()=>{if(!String(T||"").trim())return null;const W=parseInt(String(T),10);return Number.isFinite(W)&&W>0?W:null},[T]),it=a.useMemo(()=>{if(!String(ae||"").trim())return null;const W=parseInt(String(ae),10);return Number.isFinite(W)&&W>0?W:null},[ae]),M=(!String(T||"").trim()||ft!==null)&&(!String(ae||"").trim()||it!==null),ee=!!String(T||"").trim()&&ft===null,xe=!!String(ae||"").trim()&&it===null,_e=V.checkpoint||(oe==null?void 0:oe.model)||"",B=Array.isArray(V.loras)?V.loras:[],J=_e?mn(_e):"",de=B.length?B.map(W=>mn(W)).join(", "):"",ye=a.useMemo(()=>(ue||[]).map(W=>{const ne=String(W||"");return{value:ne,meta:Ef(ne)}}),[ue]),fe=a.useMemo(()=>(je||[]).map(W=>{const ne=String(W||"");return{value:ne,meta:Ef(ne)}}),[je]),R=a.useMemo(()=>{const W=new Set(["All"]);return ye.forEach(({meta:ne})=>{ne!=null&&ne.folderPath&&W.add(ne.folderPath)}),Array.from(W).sort((ne,Ie)=>ne.localeCompare(Ie))},[ye]),F=a.useMemo(()=>{const W=new Set(["All"]);return fe.forEach(({meta:ne})=>{ne!=null&&ne.folderPath&&W.add(ne.folderPath)}),Array.from(W).sort((ne,Ie)=>ne.localeCompare(Ie))},[fe]),H=R.length>2,K=F.length>2;a.useEffect(()=>{if(!H){P!=="All"&&C("All");return}R.includes(P)||C("All")},[P,R,H]),a.useEffect(()=>{if(!K){L!=="All"&&E("All");return}F.includes(L)||E("All")},[L,F,K]);const Ee=a.useMemo(()=>{const W=new Map;return ye.forEach(({meta:ne})=>{if(!(ne!=null&&ne.base))return;const Ie=ne.base.toLowerCase();W.set(Ie,(W.get(Ie)||0)+1)}),W},[ye]),we=a.useMemo(()=>{const W=new Map;return fe.forEach(({meta:ne})=>{if(!(ne!=null&&ne.base))return;const Ie=ne.base.toLowerCase();W.set(Ie,(W.get(Ie)||0)+1)}),W},[fe]),Ye=a.useMemo(()=>{const W=[],ne=H&&P==="All";return ye.forEach(({value:Ie,meta:Ae})=>{if(!Ae){W.push({value:Ie,label:Ie});return}if(H&&P!=="All"&&Ae.folderPath!==P)return;let We=Ae.base||mn(Ie)||Ie;if(ne&&Ae.base){const St=Ae.base.toLowerCase();Ee.get(St)>1&&(We=`${We} (${Lf(Ae.folderPath)})`)}W.push({value:Ie,label:We})}),W},[ye,P,Ee,H]),ze=a.useMemo(()=>{const W=[],ne=K&&L==="All";return fe.forEach(({value:Ie,meta:Ae})=>{if(!Ae){W.push({value:Ie,label:Ie});return}if(K&&L!=="All"&&Ae.folderPath!==L)return;let We=Ae.base||mn(Ie)||Ie;if(ne&&Ae.base){const St=Ae.base.toLowerCase();we.get(St)>1&&(We=`${We} (${Lf(Ae.folderPath)})`)}W.push({value:Ie,label:We})}),W},[fe,L,we,K]),Ze=a.useMemo(()=>Se?Ye.some(W=>String(W.value)===String(Se)):!0,[Ye,Se]),fn=a.useMemo(()=>Q?ze.some(W=>String(W.value)===String(Q)):!0,[ze,Q]),Vn=a.useMemo(()=>!Se||Ze?Ye:[{value:Se,label:mn(String(Se))},...Ye],[Se,Ze,Ye]),Tr=a.useMemo(()=>!Q||fn?ze:[{value:Q,label:mn(String(Q))},...ze],[Q,fn,ze]),js=a.useCallback(async W=>{const ne=W==null?void 0:W.hasCheckpoint,Ie=W==null?void 0:W.hasLora;if(!ne&&!Ie)return;Fe.current&&Fe.current.abort();const Ae=new AbortController;Fe.current=Ae,$(!0),le("");try{const[We,St]=await Promise.all([ne&&!ue.length?Za("checkpoints",{signal:Ae.signal}):null,Ie&&!je.length?Za("loras",{signal:Ae.signal}):null]);We!=null&&We.choices&&Pe(We.choices),St!=null&&St.choices&&Re(St.choices)}catch(We){if((We==null?void 0:We.name)==="AbortError")return;le("Unable to load model choices right now.")}finally{Fe.current===Ae&&(Fe.current=null),$(!1)}},[ue.length,je.length]),Ht=a.useCallback(async()=>{var W;if(!t)throw new Error("media_missing");if(Te.current)return{prompt:Te.current,info:V};re(!0),ie("");try{const ne=await Bx({filename:t.filename,subfolder:t.subfolder||""}),Ie=ne==null?void 0:ne.prompt;if(!Ie)throw new Error("prompt_missing");const Ae=$0(Ie);return Te.current=Ie,Y(Ae),{prompt:Ie,info:Ae}}catch(ne){const Ie=((W=ne==null?void 0:ne.payload)==null?void 0:W.error)||(ne==null?void 0:ne.message)||"Unable to load prompt metadata.";throw ie(Ie),ne}finally{re(!1)}},[t==null?void 0:t.filename,t==null?void 0:t.subfolder,V]),Cl=a.useCallback(async()=>{if(Me){k(!0),C("All"),E("All");try{const W=await Ht(),ne=W==null?void 0:W.info;O(Ie=>String(Ie||"").trim()?Ie:(ne==null?void 0:ne.width)!==null&&(ne==null?void 0:ne.width)!==void 0?String(ne.width):""),q(Ie=>String(Ie||"").trim()?Ie:(ne==null?void 0:ne.height)!==null&&(ne==null?void 0:ne.height)!==void 0?String(ne.height):""),await js(W==null?void 0:W.info)}catch{}}},[Me,js,Ht]),Ns=W=>{if(!(typeof window>"u"))try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:W}}))}catch{}},tn=async()=>{var W;if(!(!t||g||!Me)){if(!yt){alert("Enter a valid seed value.");return}if(!M){alert("Enter valid width and height values.");return}x(!0),Ns(!0);try{const{prompt:ne}=await Ht(),Ae=F0(ne,{seedMode:N,seedValue:N==="custom"?ct:null,checkpoint:Se||null,lora:Q||null,width:ft,height:it});cm({workflowName:t.filename||"gallery",workflow:Ae,timestamp:Date.now()}),await uu({prompt:Ae}),Ns(!1),j(!0),setTimeout(()=>{k(!1),j(!1)},1500)}catch(ne){if(Ns(!1),ne!=null&&ne.unauthorized){window.location.hash="#/login";return}const Ie=((W=ne==null?void 0:ne.payload)==null?void 0:W.error)||(ne==null?void 0:ne.message)||"Unable to re-run this item.";alert(Ie)}finally{x(!1)}}};return!t||!e||typeof document>"u"?null:lu.createPortal(o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"react-modal-overlay",role:"presentation",onPointerDown:W=>{u.current=W.target===W.currentTarget},onClick:W=>{u.current&&W.target===W.currentTarget&&(f.current||n==null||n())},children:o.jsx("div",{className:"react-modal-content",ref:S,role:"dialog","aria-modal":"true","aria-label":"Preview",onClick:W=>W.stopPropagation(),tabIndex:-1,children:o.jsxs("div",{className:"media-viewer-panel",children:[o.jsxs("header",{className:"media-viewer-head",children:[o.jsxs("div",{className:"media-viewer-head-bar bottom-sheet-head",children:[o.jsxs("div",{className:"media-viewer-meta",children:[o.jsx("div",{className:"media-viewer-title",title:t.filename,children:t.filename}),o.jsxs("div",{className:"media-viewer-sub",children:[o.jsx("span",{className:"media-chip",children:He}),o.jsx("span",{className:`media-chip ${te?"is-clip":"is-still"}`,children:te?"Video":"Image"})]})]}),o.jsx("button",{ref:d,type:"button",className:"bottom-sheet-close media-viewer-close",onClick:n,"aria-label":"Close",children:o.jsx(dr,{size:16})})]}),o.jsxs("div",{className:"media-viewer-actions",children:[Me?o.jsx(Ft,{variant:"ghost",size:"sm",onClick:Cl,disabled:g,"aria-label":"Re-run generation",children:g?"Re-running":"Re-run"}):null,he.length?o.jsx(Ft,{variant:"ghost",size:"sm",onClick:()=>y(W=>!W),"aria-expanded":m,"aria-label":m?"Hide metadata":"Show metadata",children:m?"Hide metadata":"Metadata"}):null,o.jsx(Ft,{as:"a",href:ke,target:"_blank",rel:"noreferrer",variant:"ghost",size:"sm",children:"Open"})]})]}),m&&he.length?o.jsx("div",{className:"media-viewer-info","aria-label":"Generation metadata",children:he.map(W=>o.jsxs("div",{className:"media-info-row",children:[o.jsx("span",{className:"media-info-label",children:W.label}),o.jsx("span",{className:`media-info-value ${W.isPrompt?"is-prompt":""}`,children:W.value})]},W.label))}):null,o.jsxs("div",{className:"media-viewer-stage",children:[pe?o.jsx("button",{type:"button",className:`media-stage-nav is-left ${i?"":"is-disabled"}`,onClick:r,"aria-label":"Previous",disabled:!i,children:o.jsx(mm,{size:18})}):null,o.jsx("div",{className:"media-viewer-frame",children:te?o.jsx("video",{src:ke,controls:!0,className:"media-viewer-media",autoPlay:!0,muted:!0,playsInline:!0}):o.jsx("img",{src:ke,alt:t.filename,className:"media-viewer-media",decoding:"async"})}),pe?o.jsx("button",{type:"button",className:`media-stage-nav is-right ${c?"":"is-disabled"}`,onClick:s,"aria-label":"Next",disabled:!c,children:o.jsx(pi,{size:18})}):null]})]})})}),o.jsx(Mt,{open:v,onClose:()=>k(!1),title:"Re-run options",footer:w?o.jsxs("div",{className:"fade-in flex items-center justify-center gap-2 py-2 text-sm font-medium text-[#44E1C5]",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"Render queued successfully!"]}):o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>k(!1),disabled:g,children:"Cancel"}),o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:tn,disabled:g||se||!!X||!yt||!M,children:g?"Re-running":"Run"})]}),children:o.jsxs("div",{className:"sheet-stack",children:[se?o.jsx("div",{className:"composer-alias-empty",children:"Loading prompt"}):null,X?o.jsx("div",{className:"text-xs text-[#FF8F70]",children:X}):null,o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Seed"}),o.jsx(br,{ariaLabel:"Seed mode",value:N,onChange:_,size:"sm",items:Ge}),N==="custom"?o.jsx("input",{type:"number",inputMode:"numeric",className:"ui-control ui-input mt-2",placeholder:"Enter seed",value:I,onChange:W=>z(W.target.value)}):null,o.jsx("div",{className:"sheet-hint text-xs text-[#9DA3FFCC]",children:N==="random"?"Randomize each run":"Keep or customize the seed used in the prompt."})]}),V.hasSize?o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Size"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"number",inputMode:"numeric",min:1,step:1,className:"ui-control ui-input flex-1",placeholder:"Width",value:T,onChange:W=>O(W.target.value),"aria-label":"Width","aria-invalid":ee}),o.jsx("span",{className:"text-xs text-[#9DA3FF99]","aria-hidden":"true",children:""}),o.jsx("input",{type:"number",inputMode:"numeric",min:1,step:1,className:"ui-control ui-input flex-1",placeholder:"Height",value:ae,onChange:W=>q(W.target.value),"aria-label":"Height","aria-invalid":xe})]})]}):null,V.hasCheckpoint?o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Checkpoint"}),H?o.jsx(tt,{value:P,onChange:C,className:"sheet-select","aria-label":"Checkpoint folder filter",size:"sm",options:R.map(W=>({value:W,label:W}))}):null,o.jsx(tt,{value:Se,onChange:ve,className:`sheet-select ${H?"mt-2":""}`,"aria-label":"Checkpoint override",size:"sm",options:[{value:"",label:J?`Keep current (${J})`:"Keep current"},...Vn]})]}):null,V.hasLora?o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"LoRA"}),K?o.jsx(tt,{value:L,onChange:E,className:"sheet-select","aria-label":"LoRA folder filter",size:"sm",options:F.map(W=>({value:W,label:W}))}):null,o.jsx(tt,{value:Q,onChange:ce,className:`sheet-select ${K?"mt-2":""}`,"aria-label":"LoRA override",size:"sm",options:[{value:"",label:de?`Keep current (${de})`:"Keep current"},...Tr]})]}):null,G?o.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:"Loading model choices"}):null,D?o.jsx("div",{className:"text-xs text-[#FF8F70]",children:D}):null]})})]}),document.body)}const U0=(e="")=>e.startsWith("."),V0=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),W0=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);function H0(){const e=yu(),t=(G,$="")=>{try{return typeof window<"u"&&localStorage.getItem(G)||$}catch{return $}},n=(G,$)=>{try{typeof window<"u"&&localStorage.setItem(G,$)}catch{}},[r,s]=a.useState(t("galleryPath","")),[l,i]=a.useState([]),[c,u]=a.useState(!1),[d,m]=a.useState(!1),[y,g]=a.useState(""),[x,w]=a.useState(1),[j,S]=a.useState(1),[h,f]=a.useState(()=>{const G=t("galleryPageSize","30"),$=parseInt(G,10);return Number.isFinite($)?$:30}),[p,v]=a.useState("all"),[k,N]=a.useState(!1),[_,I]=a.useState(""),[z,T]=a.useState(()=>t("galleryRecursive","0")==="1"),[O,ae]=a.useState(0);a.useEffect(()=>{let G=!1;const $=new AbortController;return(async()=>{u(!0),g("");try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:gallery:fetch")}catch{}try{const le=await lm(r,x,h,k,z,p,O,{signal:$.signal,includeMeta:!0});if(G)return;le&&le.items?(i(le.items),S(le.total_pages||1),g("")):(i([]),S(1));try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:gallery:ready"),performance.measure("cozygen:gallery:first-paint","cozygen:gallery:fetch","cozygen:gallery:ready"))}catch{}}catch(le){if((le==null?void 0:le.name)==="AbortError")return;console.error("Failed to load gallery",le),G||g("Unable to load gallery right now."),G||(i([]),S(1))}finally{!G&&!$.signal.aborted&&(u(!1),m(!0))}})(),n("galleryPath",r),n("galleryPageSize",String(h)),()=>{G=!0,$.abort()}},[r,x,h,O,k,z,p]);const q=a.useMemo(()=>{if(!r)return[];const G=r.replace(/\\/g,"/").split("/").filter(Boolean),$=[];for(let D=0;D<G.length;D++)$.push({name:G[D],path:G.slice(0,D+1).join("/")});return $},[r]),Se=a.useMemo(()=>l.filter(G=>G.type==="directory").map(G=>({filename:G.filename,subfolder:G.subfolder})),[l]),ve=a.useMemo(()=>{const G=(_||"").trim().toLowerCase();return l.filter($=>{const D=($.filename||"").toLowerCase();return!(!k&&U0(D)||$.type!=="directory"&&(p==="image"&&!V0(D)||p==="video"&&!W0(D))||G&&!D.includes(G))})},[l,k,p,_]),Q=a.useMemo(()=>ve.filter(G=>G.type!=="directory"),[ve]),ce=a.useCallback(()=>{if(!r)return;const G=r.replace(/\\/g,"/").lastIndexOf("/"),$=G===-1?"":r.slice(0,G);s($),w(1)},[r]),P=a.useCallback(()=>{s(""),w(1)},[]),C=a.useCallback(G=>{s(G||""),w(1)},[]),L=a.useCallback(G=>{s(G),w(1)},[]),E=a.useCallback(G=>{const $=parseInt(String(G),10)||30;f($),w(1)},[]),V=a.useCallback(G=>{v(G),w(1)},[]),Y=a.useCallback(G=>{const $=!!G;T($),w(1),n("galleryRecursive",$?"1":"0")},[]),se=a.useCallback(G=>{I(G),w(1)},[]),re=a.useCallback(()=>{ae(G=>G+1)},[]),X=a.useRef(null),ie=a.useCallback(()=>{X.current||(X.current=window.setTimeout(()=>{X.current=null,re()},400))},[re]);return a.useEffect(()=>{const G=()=>re();return typeof window<"u"&&window.addEventListener&&window.addEventListener("cozygen:queue-finished",G),()=>{typeof window<"u"&&window.removeEventListener&&window.removeEventListener("cozygen:queue-finished",G)}},[re]),a.useEffect(()=>{if(typeof window>"u"||!e)return;let G=!1,$,D,le=8e3;const ue=()=>{D&&(clearTimeout(D),D=null)},Pe=(Re=8e3)=>{ue(),D=window.setTimeout(()=>{G||(ie(),Pe(le))},Re)};return(()=>{if(!("EventSource"in window)){Pe();return}const Re=new URLSearchParams({subfolder:r||"",recursive:z?"1":"0",show_hidden:k?"1":"0"});$=new EventSource(`/cozygen/api/gallery/stream?${Re.toString()}`),$.onmessage=()=>{G||ie()},$.onerror=()=>{$&&($.close(),$=null),le=Math.min(Math.ceil(le*1.4),2e4),Pe()}})(),()=>{G=!0,ue(),X.current&&(clearTimeout(X.current),X.current=null),$&&($.close(),$=null)}},[r,z,k,ie,e]),a.useEffect(()=>{e&&re()},[e,re]),{path:r,items:l,loading:c,hasLoaded:d,error:y,page:x,totalPages:j,perPage:h,kind:p,showHidden:k,query:_,recursive:z,crumbs:q,dirChips:Se,filtered:ve,mediaItems:Q,setPage:w,setPerPage:E,setShowHidden:N,setQuery:se,setKind:V,setRecursive:Y,goBack:ce,goRoot:P,goToPath:C,selectDir:L,refresh:re}}function G0(e){const[t,n]=a.useState(!1),[r,s]=a.useState(null);a.useEffect(()=>{if(!e||e.length===0){s(null),n(!1);return}s(x=>x==null?x:x>=e.length?e.length-1:x)},[e]);const l=a.useCallback(x=>{if(!e||!e.length||!x)return;const w=e.indexOf(x);w!==-1&&(s(w),n(!0))},[e]),i=a.useCallback(()=>{n(!1),s(null)},[]),c=a.useCallback(()=>{!e||!e.length||s(x=>x==null||x>=e.length-1?x:x+1)},[e]),u=a.useCallback(()=>{!e||!e.length||s(x=>x==null||x<=0?x:x-1)},[e]),d=r!=null&&r>=0&&e&&r<e.length?e[r]:null,m=(e==null?void 0:e.length)||0,y=r!==null&&r>0,g=r!==null&&r<m-1;return{viewerOpen:t,viewerIndex:r,currentMedia:d,total:m,canPrev:y,canNext:g,open:l,close:i,next:c,prev:u,setViewerOpen:n}}const Pf="cozygen_gallery_view_mode",_f="cozygen_gallery_feed_autoplay";function K0(e,t){const n=a.useRef(null),[r,s]=a.useState(0),[l,i]=a.useState({width:0,cols:0,top:0,viewport:typeof window<"u"&&window.innerHeight||800}),c=g=>{if(!g||typeof window>"u")return null;let x=g.parentElement;for(;x;){const w=window.getComputedStyle(x);if(w.overflowY==="auto"||w.overflowY==="scroll")return x;x=x.parentElement}return window};a.useEffect(()=>{if(!t)return;const g=n.current;if(!g||typeof window>"u"||typeof ResizeObserver>"u")return;const x=c(g)||window,w=()=>{const f=g.getBoundingClientRect(),p=f.width||g.clientWidth||1,v=Math.max(1,Math.floor(p/160)),k=x===window?window.scrollY||0:x.scrollTop||0,N=x===window?{top:0}:x.getBoundingClientRect(),_=x===window?f.top+(window.scrollY||0):f.top-N.top+k,I=x===window?window.innerHeight||800:x.clientHeight||800;i(z=>z.width===p&&z.cols===v&&z.top===_&&z.viewport===I?z:{width:p,cols:v,top:_,viewport:I}),s(k)};w();const j=new ResizeObserver(()=>w());j.observe(g),window.addEventListener("resize",w);let S=!1;const h=()=>{S||(S=!0,window.requestAnimationFrame(()=>{S=!1;const f=x===window?window.scrollY||0:x.scrollTop||0;s(f)}))};return x.addEventListener("scroll",h,{passive:!0}),()=>{j.disconnect(),window.removeEventListener("resize",w),x.removeEventListener("scroll",h)}},[t]);const u=t&&l.cols>0&&e.length>60,{visibleItems:d,topSpacer:m,bottomSpacer:y}=a.useMemo(()=>{if(!u)return{visibleItems:e,topSpacer:0,bottomSpacer:0};const g=l.width/l.cols,x=Math.max(180,Math.ceil(g*1.25)+32),w=Math.ceil(e.length/l.cols),j=Math.max(0,r-l.top),S=Math.max(0,Math.floor(j/x)-2),h=Math.min(w,Math.ceil((j+l.viewport)/x)+2),f=S*l.cols,p=Math.min(e.length,h*l.cols);return{visibleItems:e.slice(f,p),topSpacer:S*x,bottomSpacer:Math.max(0,(w-h)*x)}},[e,l,r,u]);return{containerRef:n,visibleItems:d,topSpacer:m,bottomSpacer:y,virtualized:u}}function Q0(){const{path:e,loading:t,hasLoaded:n,page:r,totalPages:s,perPage:l,kind:i,showHidden:c,recursive:u,error:d,crumbs:m,dirChips:y,filtered:g,mediaItems:x,setPage:w,setPerPage:j,setShowHidden:S,setKind:h,setRecursive:f,goBack:p,goRoot:v,goToPath:k,selectDir:N,refresh:_}=H0(),{viewerOpen:I,currentMedia:z,total:T,canPrev:O,canNext:ae,open:q,close:Se,next:ve,prev:Q}=G0(x),[ce,P]=a.useState(()=>{if(typeof window>"u")return"grid";const U=window.localStorage.getItem(Pf);return U==="feed"||U==="grid"?U:"grid"}),[C,L]=a.useState(()=>typeof window>"u"?!1:window.localStorage.getItem(_f)==="true");a.useEffect(()=>{try{window.localStorage.setItem(Pf,ce)}catch{}},[ce]),a.useEffect(()=>{try{window.localStorage.setItem(_f,C?"true":"false")}catch{}},[C]);const E=a.useCallback(async()=>{try{await Yx(),_(),alert("Cache cleared successfully! Thumbnails will be regenerated.")}catch(U){alert("Failed to clear cache: "+(U.message||"Unknown error"))}},[_]),V=a.useCallback(U=>{if(U.type==="directory"){N(U.subfolder);return}q(U)},[q,N]),Y=ce==="grid",[se,re]=a.useState(!1),X=a.useMemo(()=>[{key:"all",label:"All"},{key:"image",label:"Images"},{key:"video",label:"Videos"}],[]),ie=a.useMemo(()=>[{key:"grid",ariaLabel:"Grid view",icon:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[o.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),o.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),o.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),o.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})},{key:"feed",ariaLabel:"Feed view",icon:o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[o.jsx("rect",{x:"2",y:"1",width:"12",height:"5",rx:"1"}),o.jsx("rect",{x:"2",y:"8",width:"12",height:"5",rx:"1"})]})}],[]),G=U=>U.type==="directory"?`dir:${U.subfolder||U.filename}`:`${U.subfolder||""}|${U.filename}`;a.useEffect(()=>{try{window.localStorage.setItem("cozygen_gallery_pending","0")}catch{}window.dispatchEvent(new Event("cozygen:gallery-viewed"))},[]);const $=t&&!n,D=t&&n,le=`${g.length} items`,ue=$?"Loading":le,Pe=!!d,{containerRef:je,visibleItems:Re,topSpacer:Te,bottomSpacer:Fe,virtualized:Be}=K0(g,Y);return o.jsxs("div",{className:"page-shell gallery-shell",children:[o.jsx("div",{className:"screen-sticky gallery-header",children:o.jsxs("div",{className:"gallery-header-inner",children:[o.jsxs("div",{className:"page-bar gallery-bar",children:[o.jsx("h1",{className:"page-bar-title",children:"Gallery"}),o.jsxs("div",{className:"page-bar-actions",children:[o.jsx("span",{className:"gallery-status",children:ue}),o.jsx(br,{ariaLabel:"View mode",value:ce,onChange:P,layout:"icon",size:"sm",items:ie}),o.jsx(Ft,{size:"xs",className:"gallery-filter-btn",onClick:()=>re(!0),children:"Filters"})]})]}),o.jsx("div",{className:"gallery-nav-row",children:o.jsx(P0,{subfolder:e,crumbs:m,dirChips:y,onBack:p,onRoot:v,onCrumb:U=>k(U),onSelectDir:U=>N(U)})}),o.jsxs("div",{className:"gallery-toolbar",children:[o.jsx("div",{className:"gallery-toolbar-left",children:o.jsx(br,{ariaLabel:"Filter by type",value:i,onChange:h,size:"sm",items:X})}),o.jsx("div",{className:"gallery-toolbar-right",children:o.jsxs("div",{className:"gallery-options",children:[o.jsx(Ft,{size:"icon",active:u,pressed:u,onClick:()=>f(U=>!U),title:u?"Showing subfolders":"This folder only","aria-label":"Toggle subfolders",children:u?o.jsx(ec,{size:16}):o.jsx(Xd,{size:16})}),o.jsx(Ft,{size:"icon",active:c,pressed:c,onClick:()=>S(U=>!U),title:c?"Showing hidden":"Hiding hidden","aria-label":"Toggle hidden items",children:c?o.jsx(Jd,{size:16}):o.jsx(Zd,{size:16})}),ce==="feed"&&o.jsx(Ft,{size:"icon",active:C,pressed:C,onClick:()=>L(U=>!U),title:C?"Autoplay on":"Autoplay off","aria-label":"Toggle autoplay",children:C?o.jsx(ef,{size:16}):o.jsx(tf,{size:16})}),o.jsx(Ft,{size:"icon",onClick:_,title:"Refresh","aria-label":"Refresh gallery",children:o.jsx(tc,{size:16})}),o.jsx(Ft,{size:"xs",onClick:E,title:"Clear thumbnail cache","aria-label":"Clear cache",children:"Clear Cache"})]})})]}),o.jsx("div",{className:"gallery-pagination",children:o.jsxs("div",{className:"gallery-pagination-controls",children:[o.jsx("button",{type:"button",className:"gallery-page-btn",onClick:()=>w(U=>Math.max(1,U-1)),disabled:r<=1||t,"aria-label":"Previous page",children:o.jsx(mm,{size:16})}),o.jsxs("span",{className:"gallery-page-indicator",children:[r," / ",s]}),o.jsx("button",{type:"button",className:"gallery-page-btn",onClick:()=>w(U=>U<s?U+1:U),disabled:r>=s||t,"aria-label":"Next page",children:o.jsx(pi,{size:16})}),o.jsx(tt,{value:l,onChange:U=>j(parseInt(U,10)||30),className:"gallery-page-size","aria-label":"Items per page",size:"sm",options:[15,30,60,120]})]})})]})}),$&&g.length===0?o.jsx("div",{className:"gallery-grid-responsive",children:Array.from({length:8}).map((U,ke)=>o.jsxs("div",{className:"gallery-skeleton-item",children:[o.jsx("div",{className:"gallery-skeleton-thumb skeleton"}),o.jsx("div",{className:"gallery-skeleton-label skeleton skeleton-text"})]},ke))}):Pe&&g.length===0?o.jsxs("div",{className:"gallery-empty",role:"alert",children:[o.jsx("div",{className:"gallery-empty-icon",children:o.jsx(nf,{size:48})}),o.jsx("div",{className:"gallery-empty-title",children:"Gallery unavailable"}),o.jsx("div",{className:"gallery-empty-desc",children:d}),o.jsx("button",{type:"button",className:"ui-button is-primary is-compact mt-4",onClick:_,children:"Retry"})]}):g.length===0?o.jsxs("div",{className:"gallery-empty",children:[o.jsx("div",{className:"gallery-empty-icon",children:o.jsx(nf,{size:48})}),o.jsx("div",{className:"gallery-empty-title",children:"No media found"}),o.jsx("div",{className:"gallery-empty-desc",children:i!=="all"?`No ${i}s match your filters. Try selecting "All" or adjusting your search.`:"This folder is empty. Render something new or navigate to a different folder."})]}):Y?o.jsx("div",{className:"w-full overflow-hidden",children:o.jsxs("div",{className:"gallery-grid-responsive",ref:je,children:[Be&&Te>0?o.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${Te}px`}}):null,Re.map(U=>o.jsx(Cf,{item:U,onSelect:V,variant:"grid",autoPlay:!1},G(U))),Be&&Fe>0?o.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${Fe}px`}}):null]})}):o.jsx("div",{className:"flex flex-col gap-6 items-center",children:x.map(U=>o.jsx("div",{className:"w-full flex justify-center",children:o.jsx(Cf,{item:U,onSelect:V,variant:"feed",autoPlay:C})},G(U)))}),o.jsx(B0,{isOpen:I,media:z,onClose:Se,onPrev:Q,onNext:ve,total:T,canPrev:O,canNext:ae}),o.jsx(Mt,{open:se,onClose:()=>re(!1),title:"Gallery filters",footer:o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>re(!1),children:"Done"}),children:o.jsxs("div",{className:"sheet-stack",children:[o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Type"}),o.jsx(br,{ariaLabel:"Filter by type",value:i,onChange:h,size:"sm",items:X})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Options"}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("button",{type:"button",className:`ui-button is-compact ${u?"is-primary":"is-muted"}`,onClick:()=>f(U=>!U),children:o.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[u?o.jsx(ec,{size:14}):o.jsx(Xd,{size:14}),o.jsx("span",{children:u?"Subfolders":"This folder"})]})}),o.jsx("button",{type:"button",className:`ui-button is-compact ${c?"is-primary":"is-muted"}`,onClick:()=>S(U=>!U),children:o.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[c?o.jsx(Jd,{size:14}):o.jsx(Zd,{size:14}),o.jsx("span",{children:c?"Hidden on":"Hidden off"})]})}),ce==="feed"?o.jsx("button",{type:"button",className:`ui-button is-compact ${C?"is-primary":"is-muted"}`,onClick:()=>L(U=>!U),children:o.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[C?o.jsx(ef,{size:14}):o.jsx(tf,{size:14}),o.jsx("span",{children:C?"Autoplay":"No autoplay"})]})}):null,o.jsx("button",{type:"button",className:"ui-button is-compact is-ghost",onClick:_,children:o.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[o.jsx(tc,{size:14}),o.jsx("span",{children:"Refresh"})]})})]})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Page size"}),o.jsx(tt,{value:l,onChange:U=>j(parseInt(U,10)||30),className:"sheet-select","aria-label":"Items per page",size:"sm",options:[15,30,60,120]}),o.jsxs("div",{className:"sheet-hint",children:[D?o.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):null,o.jsxs("span",{children:[ue,"  Page ",r," of ",s]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>w(U=>Math.max(1,U-1)),disabled:r<=1||t,children:"Prev"}),o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>w(U=>U<s?U+1:U),disabled:r>=s||t,children:"Next"})]})]})]})})]})}const Y0=()=>typeof window>"u"?800:window.innerHeight||800,q0=e=>{if(!e||typeof window>"u")return null;let t=e.parentElement;for(;t;){const n=window.getComputedStyle(t);if(n.overflowY==="auto"||n.overflowY==="scroll")return t;t=t.parentElement}return window};function wu({itemCount:e,enabled:t=!0,estimateRowHeight:n=72,overscan:r=6,minItems:s=80}={}){const l=a.useRef(null),i=a.useRef(n),[c,u]=a.useState({top:0,scrollTop:0,viewport:Y0(),rowHeight:n});a.useEffect(()=>{if(!t)return;const j=l.current;if(!j||typeof window>"u"||typeof ResizeObserver>"u")return;const S=q0(j)||window,h=()=>{const k=j.getBoundingClientRect(),N=S===window?window.scrollY||0:S.scrollTop||0,_=S===window?{top:0}:S.getBoundingClientRect(),I=S===window?k.top+(window.scrollY||0):k.top-_.top+N,z=S===window?window.innerHeight||800:S.clientHeight||800;u(T=>T.top===I&&T.scrollTop===N&&T.viewport===z&&T.rowHeight===i.current?T:{top:I,scrollTop:N,viewport:z,rowHeight:i.current})};h();const f=new ResizeObserver(()=>h());f.observe(j),window.addEventListener("resize",h);let p=!1;const v=()=>{p||(p=!0,window.requestAnimationFrame(()=>{p=!1;const k=S===window?window.scrollY||0:S.scrollTop||0;u(N=>N.scrollTop===k&&N.rowHeight===i.current?N:{...N,scrollTop:k,rowHeight:i.current})}))};return S.addEventListener("scroll",v,{passive:!0}),()=>{f.disconnect(),window.removeEventListener("resize",h),S.removeEventListener("scroll",v)}},[t]),a.useEffect(()=>{if(!t||typeof window>"u")return;let j=0;const S=()=>{const h=l.current;if(!h)return;const f=h.querySelector('[data-virtual-row="true"]');if(!f)return;const p=f.getBoundingClientRect(),v=Math.max(24,Math.round(p.height||0));v&&Math.abs(v-i.current)>2&&(i.current=v,u(k=>({...k,rowHeight:v})))};return j=window.requestAnimationFrame(S),()=>{j&&window.cancelAnimationFrame(j)}},[t,e,c.scrollTop]);const d=!!(t&&e>s),{startIndex:m,endIndex:y,topSpacer:g,bottomSpacer:x}=a.useMemo(()=>{if(!d)return{startIndex:0,endIndex:e,topSpacer:0,bottomSpacer:0};const j=c.rowHeight||n,S=Math.max(0,c.scrollTop-c.top),h=Math.max(0,Math.floor(S/j)-r),f=Math.min(e,Math.ceil((S+c.viewport)/j)+r);return{startIndex:h,endIndex:f,topSpacer:h*j,bottomSpacer:Math.max(0,(e-f)*j)}},[e,c,r,n,d]),w=y>=e-Math.max(6,r*2);return{containerRef:l,startIndex:m,endIndex:y,topSpacer:g,bottomSpacer:x,virtualized:d,isNearEnd:w}}const Ho="::",X0={contentVisibility:"auto",containIntrinsicSize:"240px 120px"},J0=a.memo(function({id:t,name:n,category:r,text:s,isSelected:l,onOpen:i}){const c=a.useCallback(()=>{i(t)},[t,i]),u=Bo({name:n})||n||"Untitled",d=r?`${r}:${n}`:n,m=`${(s||"").slice(0,140)}${(s||"").length>140?"":""}`;return o.jsxs("button",{type:"button",role:"listitem",className:`composer-alias-item ${l?"is-selected":""}`,onClick:c,style:X0,"data-virtual-row":"true",children:[o.jsxs("div",{className:"composer-alias-header",children:[o.jsx("div",{className:"composer-alias-name",children:u}),r?o.jsx("span",{className:"composer-alias-category",children:zn(r)}):null]}),o.jsxs("div",{className:"composer-alias-token",children:["$",d||"alias","$"]}),o.jsx("div",{className:"composer-alias-text",children:m||""})]})});function Z0(){return`alias-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,6)}`}function Pn(e){return String(e||"").split(",").map(t=>t.trim()).filter(Boolean)}function vi(e){return(e||[]).map(t=>String(t||"").trim()).filter(Boolean).join(", ")}function e1(e,t){const n=String(t||"").trim();if(!n)return String(e||"");const r=Pn(e);return new Set(r.map(l=>l.toLowerCase())).has(n.toLowerCase())||r.push(n),vi(r)}function t1(e,t){const n=String(t||"").trim().toLowerCase();if(!n)return String(e||"");const r=Pn(e).filter(s=>s.toLowerCase()!==n);return vi(r)}function n1(e,t,n){const r=String(t||"").trim().toLowerCase(),s=String(n||"").trim();if(!r||!s)return String(e||"");const l=Pn(e).map(u=>u.toLowerCase()===r?s:u),i=new Set,c=[];return l.forEach(u=>{const d=String(u||"").trim().toLowerCase();!d||i.has(d)||(i.add(d),c.push(u))}),vi(c)}function Ji(e,t={}){return Object.entries(Ys(e)).map(([n,r],s)=>{const[l,i]=String(n).includes(Ho)?n.split(Ho):["",n],c=i||n,u=t[n]||t[c]||l||"";return{id:`existing-${s}-${n}`,name:c,text:r,category:u}})}function Rf(e){const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.text)=="string"?n.text.trim():"";if(r&&s){const l=String((n==null?void 0:n.category)||"").trim(),i=l?`${l}${Ho}${r}`:r;t[i]=s}}),t}function If(e){const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.category)=="string"?n.category.trim():"";if(r){const l=s?`${s}${Ho}${r}`:r;t[l]=s}}),t}function r1(){var fe;const e=kn(),{aliases:t,aliasCategories:n,categoryList:r,loading:s,saving:l,error:i,persistAliases:c}=Rm(),[u,d]=a.useState(()=>Ji(t,n)),[m,y]=a.useState(()=>Array.isArray(r)?r:[]),[g,x]=a.useState("All"),[w,j]=a.useState("All"),[S,h]=a.useState(""),f=a.useDeferredValue(S),[p,v]=a.useState(""),[k,N]=a.useState(!1),[_,I]=a.useState(!1),[z,T]=a.useState({loading:!1,invalid:[],suggestions:{}}),[O,ae]=a.useState(!1),[q,Se]=a.useState(null),[ve,Q]=a.useState(""),ce=a.useRef(null),P=a.useRef(null),[C,L]=a.useState(!1),[E,V]=a.useState(""),[Y,se]=a.useState(""),re=fi("(min-width: 1024px)");a.useEffect(()=>{if(C)return;const R=Ji(t,n||{});d(R),p&&!R.some(F=>F.id===p)&&(v(""),N(!1))},[n,C]),a.useEffect(()=>{C||Array.isArray(r)&&y(r)},[r,C]),a.useEffect(()=>{if(C)return;const R=Ji(t,n||{});d(R),p&&!R.some(F=>F.id===p)&&(v(""),N(!1))},[t,n,p,C]);const X=a.useMemo(()=>Rf(u),[u]),ie=()=>{const R={id:Z0(),name:"",text:"",category:""};d(F=>[...F,R]),v(R.id),Q(""),L(!0),N(!0)},G=(R,F,H)=>{L(!0),d(K=>K.map((Ee,we)=>we===R?{...Ee,[F]:H}:Ee))},$=R=>{L(!0),d(F=>{var K;const H=F.filter((Ee,we)=>we!==R);return(H.length===0||p===((K=F[R])==null?void 0:K.id))&&(v(""),N(!1)),H})},D=async()=>{Q("");try{const R=new Map;if(u.forEach(H=>{Pn((H==null?void 0:H.text)||"").forEach(Ee=>{const we=String(Ee).toLowerCase();we&&(R.has(we)||R.set(we,{tag:Ee,rows:[]}),R.get(we).rows.push(H.id))})}),R.size){const H=Array.from(R.values()).map(K=>K.tag);try{const K=await Gi(H),Ee=Array.isArray(K==null?void 0:K.invalid)?K.invalid:[],we=new Set(Ee.map(Ye=>String(Ye).toLowerCase()));if(we.size){const Ye=u.map(ze=>{const fn=Pn((ze==null?void 0:ze.text)||"").filter(Tr=>we.has(String(Tr).toLowerCase()));if(!fn.length)return null;const Vn=ze.category?`${ze.category}:${ze.name}`:ze.name;return{id:ze.id,token:Vn,friendlyName:Bo({name:ze.name})||ze.name||"Untitled",category:ze.category||"",invalid:fn}}).filter(Boolean);Se({invalid:Ee,invalidLower:Array.from(we),rows:Ye,suggestions:(K==null?void 0:K.suggestions)||{}}),ae(!0),Q("Fix invalid tags before saving.");return}}catch(K){console.error("Unable to validate tags",K),Q("Unable to validate tags right now.");return}}const F=If(u);await c({items:X,categories:F,categoryList:m}),L(!1),Q("Saved.")}catch{Q("Unable to save right now.")}},le=a.useMemo(()=>{const R=f.trim().toLowerCase(),H=[...u.filter(K=>{const Ee=(K.category||"").trim();if(g===""&&Ee||g!=="All"&&g!==""&&Ee!==g)return!1;const we=$s(K.name||"",K.category||"");if(w!=="All"&&we!==w)return!1;if(!R)return!0;const Ye=Ee?`${Ee}:${K.name}`:K.name;return(K.name||"").toLowerCase().includes(R)||(K.text||"").toLowerCase().includes(R)||(Ee||"").toLowerCase().includes(R)||(Ye||"").toLowerCase().includes(R)})];return H.sort((K,Ee)=>(K.name||"").localeCompare(Ee.name||"")),H},[u,g,w,f]),{containerRef:ue,startIndex:Pe,endIndex:je,topSpacer:Re,bottomSpacer:Te,virtualized:Fe}=wu({itemCount:le.length,enabled:!0,estimateRowHeight:86,overscan:8,minItems:120}),Be=Fe?le.slice(Pe,je):le,U=le.find(R=>R.id===p)||u.find(R=>R.id===p)||null,ke=U?U.category?`${U.category}:${U.name}`:U.name||"alias":"",He=U&&(Bo({name:U.name})||U.name)||"Alias",te=ke?`$${ke}$`:"$alias$",pe=le.length?le:u,oe=U?pe.findIndex(R=>R.id===U.id):-1,he=oe>0?pe[oe-1]:null,be=oe>=0&&oe<pe.length-1?pe[oe+1]:null,Ce=R=>{R&&(v(R.id),N(!0),Q(""))},Me=a.useMemo(()=>{const R=new Set(m||[]);return u.forEach(F=>{F.category&&R.add(F.category)}),Array.from(R).sort((F,H)=>F.localeCompare(H))},[u,m]),Ge=a.useMemo(()=>{const R=new Set;return u.forEach(F=>{const H=(F.category||"").trim();if(g===""&&H||g!=="All"&&g!==""&&H!==g)return;const K=$s(F.name||"",F.category||"");K&&R.add(K)}),Array.from(R).sort((F,H)=>F.localeCompare(H))},[u,g]);a.useEffect(()=>{w!=="All"&&(Ge.includes(w)||j("All"))},[Ge,w]),a.useEffect(()=>{se("")},[p]);const ct=a.useMemo(()=>Pn((U==null?void 0:U.text)||""),[U==null?void 0:U.text]),yt=a.useMemo(()=>{const R=Array.isArray(z==null?void 0:z.invalid)?z.invalid:[];return new Set(R.map(F=>String(F).toLowerCase()))},[z]);a.useEffect(()=>{if(!U||!(k||re))return;const R=ct,F=[],H=new Set;if(R.forEach(we=>{const Ye=String(we).toLowerCase();!Ye||H.has(Ye)||(H.add(Ye),F.push(we))}),!F.length){T({loading:!1,invalid:[],suggestions:{}});return}let K=!1;const Ee=window.setTimeout(async()=>{T(we=>({...we,loading:!0}));try{const we=await Gi(F);if(K)return;T({loading:!1,invalid:Array.isArray(we==null?void 0:we.invalid)?we.invalid:[],suggestions:(we==null?void 0:we.suggestions)||{}})}catch(we){console.error("Failed to validate tags",we),K||T({loading:!1,invalid:[],suggestions:{}})}},260);return()=>{K=!0,window.clearTimeout(Ee)}},[k,re,U,ct]);const ft=R=>{var H,K;const F=String(R||"");if(!F)return!1;try{return(K=(H=navigator.clipboard)==null?void 0:H.writeText)==null||K.call(H,F),!0}catch{return!1}},it=(R="")=>{const F=R?`?q=${encodeURIComponent(R)}`:"";e(`/tags${F}`)},M=()=>{var K;if(!U)return;const R=Pn(Y);if(!R.length){Q("Enter a tag to add.");return}const F=u.findIndex(Ee=>Ee.id===U.id);if(F===-1)return;let H=((K=u[F])==null?void 0:K.text)||"";R.forEach(Ee=>{H=e1(H,Ee)}),G(F,"text",H),se(""),Q(`Added ${R.length} tag${R.length===1?"":"s"}.`)},ee=async()=>{const R=E.trim();if(!R){Q("Enter a category name.");return}const F=Array.from(new Set([...m||[],R]));y(F),V(""),Q("Category added.");const H=Rf(u),K=If(u);L(!0);try{await c({items:H,categories:K,categoryList:F}),L(!1),Q("Category saved.")}catch{Q("Unable to save right now.")}},xe=a.useCallback(R=>{R&&(v(R.id),N(!0),Q(""))},[]),_e=a.useMemo(()=>{const R=new Map;return u.forEach(F=>{F!=null&&F.id&&R.set(F.id,F)}),R},[u]),B=a.useCallback(R=>{const F=_e.get(R);F&&xe(F)},[xe,_e]),J=()=>{re&&v(""),N(!1),Q("")};a.useMemo(()=>{const R=u.length,F=le.length;return s&&R===0?"Loading":R===F?`${R} aliases`:`${F} of ${R} aliases`},[u.length,le.length,s]),a.useEffect(()=>{const R=F=>{var ze,Ze;if(F.defaultPrevented)return;const H=F.target,K=(H==null?void 0:H.tagName)||"",Ee=["INPUT","TEXTAREA","SELECT"].includes(K)||(H==null?void 0:H.isContentEditable),we=String(F.key||"").toLowerCase(),Ye=F.metaKey||F.ctrlKey;if(Ye&&we==="s"){F.preventDefault(),C&&!l&&D();return}if(Ye&&we==="n"){F.preventDefault(),ie();return}if(!Ee&&we==="/"){F.preventDefault(),(Ze=(ze=P.current)==null?void 0:ze.focus)==null||Ze.call(ze);return}we==="escape"&&k&&!re&&(F.preventDefault(),J())};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[ie,J,C,k,D,re,l]);const de=o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:J,children:re?"Clear selection":"Close"}),o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:D,disabled:l||!C,children:l?"Saving":C?"Save":"Saved"})]}),ye=U?o.jsxs("div",{className:"sheet-stack",children:[o.jsxs("div",{className:"alias-editor-toolbar",children:[o.jsxs("div",{className:"alias-editor-heading",children:[o.jsx("div",{className:"alias-editor-title",children:He}),o.jsx("div",{className:"alias-editor-meta",children:te})]}),o.jsxs("div",{className:"alias-editor-actions",children:[o.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>Ce(he),disabled:!he,title:"Previous alias",children:"Prev"}),o.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>Ce(be),disabled:!be,title:"Next alias",children:"Next"}),o.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>{ke&&ft(te)?Q("Token copied."):Q("Copy not available on this browser.")},title:"Copy token",children:"Copy token"})]})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Token"}),o.jsx("div",{className:"composer-token",children:te}),$s(U.name||"",U.category||"")?o.jsxs("div",{className:"sheet-hint",children:["Subcategory: ",fr($s(U.name||"",U.category||""))]}):null]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Friendly name"}),o.jsx("div",{className:"composer-field",children:He})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Alias name"}),o.jsx("input",{ref:ce,type:"text",value:U.name||"",onChange:R=>{const F=u.findIndex(H=>H.id===U.id);F!==-1&&G(F,"name",R.target.value)},placeholder:"e.g. cherry_fruit",className:"sheet-input ui-control ui-input"})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Category"}),o.jsx(tt,{value:U.category||"",onChange:R=>{const F=u.findIndex(H=>H.id===U.id);F!==-1&&G(F,"category",R)},className:"sheet-select",size:"sm",options:[{value:"",label:"Uncategorized"},...Me.filter(Boolean).map(R=>({value:R,label:zn(R)}))]}),o.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>I(!0),children:"Manage categories"})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Expands to"}),o.jsx("textarea",{value:U.text,onChange:R=>{const F=u.findIndex(H=>H.id===U.id);F!==-1&&G(F,"text",R.target.value)},placeholder:"Prompt text for this alias",className:"sheet-textarea ui-control ui-textarea is-compact",rows:6}),o.jsxs("div",{className:"tag-quick-add",children:[o.jsx("input",{type:"text",value:Y,onChange:R=>se(R.target.value),onKeyDown:R=>{R.key==="Enter"&&(R.preventDefault(),M())},placeholder:"Add tags (comma separated)",className:"ui-control ui-input tag-quick-input","aria-label":"Add tags"}),o.jsx("button",{type:"button",className:"ui-button is-compact is-primary",onClick:M,disabled:!Y.trim(),children:"Add"})]}),o.jsxs("div",{className:"tag-editor-actions",children:[o.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>it(""),children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(ur,{size:14}),"Open tag library"]})}),o.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>{T(F=>({...F,loading:!0}));const R=Pn(U.text||"");Gi(R).then(F=>{T({loading:!1,invalid:Array.isArray(F==null?void 0:F.invalid)?F.invalid:[],suggestions:(F==null?void 0:F.suggestions)||{}})}).catch(()=>T({loading:!1,invalid:[],suggestions:{}}))},disabled:z.loading,title:"Validate against danbooru_tags.md",children:z.loading?"Validating":"Validate"})]}),ct.length?o.jsx("div",{className:"tag-chip-list","aria-label":"Alias tags",children:ct.map(R=>{const F=yt.has(String(R).toLowerCase());return o.jsxs("span",{className:`tag-chip ${F?"is-invalid":""}`,children:[o.jsx("code",{className:"tag-chip-code",children:R}),o.jsx("button",{type:"button",className:"tag-chip-remove",onClick:()=>{const H=u.findIndex(K=>K.id===U.id);H!==-1&&G(H,"text",t1(U.text||"",R))},"aria-label":`Remove ${R}`,title:"Remove",children:o.jsx(dr,{size:12})})]},R)})}):o.jsx("div",{className:"sheet-hint",children:"Tip: Use the Tag library to add validated tags quickly."}),!z.loading&&Array.isArray(z.invalid)&&z.invalid.length?o.jsxs("div",{className:"tag-invalid-panel",role:"alert",children:[o.jsxs("div",{className:"tag-invalid-title",children:["Invalid tags (",z.invalid.length,")"]}),o.jsx("div",{className:"tag-invalid-body",children:z.invalid.map(R=>{var H;const F=((H=z==null?void 0:z.suggestions)==null?void 0:H[R])||[];return o.jsxs("div",{className:"tag-invalid-row",children:[o.jsxs("div",{className:"tag-invalid-tag",children:[o.jsx("code",{children:R}),o.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>it(R),children:"Find"})]}),Array.isArray(F)&&F.length?o.jsx("div",{className:"tag-invalid-suggestions",children:F.slice(0,6).map(K=>o.jsx("button",{type:"button",className:"tag-suggestion",onClick:()=>{const Ee=u.findIndex(we=>we.id===U.id);Ee!==-1&&G(Ee,"text",n1(U.text||"",R,K))},title:`Replace ${R} with ${K}`,children:K},`${R}-${K}`))}):o.jsx("div",{className:"sheet-hint",children:"No suggestions found for this tag."})]},R)})})]}):null]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("button",{type:"button",className:"ui-button is-danger",onClick:()=>{const R=u.findIndex(F=>F.id===U.id);R!==-1&&($(R),N(!1))},children:"Delete alias"}),o.jsx("div",{className:"sheet-hint",children:"Deleting removes it from your library. Use Save changes to persist."})]})]}):o.jsx("div",{className:"alias-editor-empty",children:"Select an alias to edit, or create a new one."});return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"page-shell page-stack alias-page",children:[o.jsxs("div",{className:"page-bar",children:[o.jsx("h1",{className:"page-bar-title",children:"Aliases"}),o.jsxs("div",{className:"page-bar-actions",children:[o.jsx(Ft,{size:"xs",onClick:()=>openTagLibrary({query:S||"",targetId:""}),title:"Browse danbooru tags",children:"Tags"}),o.jsx(Ft,{size:"xs",variant:"primary",onClick:ie,children:"Add"})]})]}),o.jsx("div",{className:"library-toolbar screen-sticky",children:o.jsxs("div",{className:"library-toolbar-inner",children:[o.jsxs("div",{className:"composer-filters",children:[o.jsxs("div",{className:"input-with-action",children:[o.jsx("input",{ref:P,type:"search",value:S,onChange:R=>h(R.target.value),className:"composer-search ui-control ui-input",placeholder:"Search aliases","aria-label":"Search aliases"}),o.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>h(""),disabled:!S,children:"Clear"})]}),o.jsx(tt,{className:"composer-subcategory-select",value:g,onChange:x,"aria-label":"Filter by category",size:"sm",options:[{value:"All",label:"Category: All"},{value:"",label:"Uncategorized"},...Me.filter(Boolean).map(R=>({value:R,label:zn(R)}))]}),o.jsx(tt,{className:"composer-subcategory-select",value:w,onChange:j,"aria-label":"Filter by subcategory",size:"sm",options:[{value:"All",label:"Subcategory: All"},...Ge.map(R=>({value:R,label:fr(R)}))]}),C?o.jsx("button",{type:"button",className:"ui-button is-compact is-primary",onClick:D,disabled:l,children:l?"Saving":"Save changes"}):null]}),i?o.jsx("div",{className:"library-toolbar-status is-error",children:"Could not load aliases. Try again later."}):null,ve?o.jsx("div",{className:"library-toolbar-status",children:ve}):null]})}),o.jsxs("div",{className:"alias-layout",children:[o.jsx("div",{className:"alias-list",children:u.length===0&&!s?o.jsx("section",{className:"ui-panel text-center py-16",children:o.jsx("p",{className:"text-base text-[rgba(159,178,215,0.8)]",children:"No aliases yet. Add your first one."})}):o.jsxs("div",{className:"composer-alias-list",role:"list",ref:ue,children:[le.length===0?o.jsx("div",{className:"composer-alias-empty",children:"No aliases match your filters."}):null,Fe&&Re>0?o.jsx("div",{"aria-hidden":!0,style:{height:`${Re}px`}}):null,Be.map(R=>o.jsx(J0,{id:R.id,name:R.name,category:(R.category||"").trim(),text:R.text||"",isSelected:p===R.id,onOpen:B},R.id)),Fe&&Te>0?o.jsx("div",{"aria-hidden":!0,style:{height:`${Te}px`}}):null]})}),o.jsx("aside",{className:"alias-editor-panel",children:o.jsxs("div",{className:"alias-editor-card ui-panel",children:[ye,U?o.jsx("div",{className:"alias-editor-footer",children:de}):null]})})]})]}),o.jsx(Mt,{open:k&&!!U&&!re,onClose:J,title:"Alias",variant:"fullscreen",footer:de,children:ye}),o.jsx(Mt,{open:_,onClose:()=>{I(!1),V(""),Q("")},title:"Categories",variant:"sheet",footer:o.jsx("div",{className:"sheet-hint",children:"Categories help you organize aliases and improve the Insert alias picker."}),children:o.jsxs("div",{className:"sheet-stack",children:[o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Add category"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:E,onChange:R=>V(R.target.value),placeholder:"e.g. styles",className:"sheet-input ui-control ui-input"}),o.jsx("button",{type:"button",className:"ui-button is-primary is-compact",onClick:ee,children:"Add"})]})]}),o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Existing"}),Me.length===0?o.jsx("div",{className:"sheet-hint",children:"No categories yet."}):o.jsx(tt,{className:"sheet-select",value:"",onChange:R=>{R&&(x(R),I(!1))},size:"sm",placeholder:"Select a category",options:Me.filter(Boolean).map(R=>({value:R,label:zn(R)}))})]})]})}),o.jsx(Mt,{open:O,onClose:()=>ae(!1),title:"Fix invalid tags",variant:"fullscreen",footer:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>ae(!1),children:"Close"}),o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>{const R=new Set(((q==null?void 0:q.invalidLower)||[]).map(F=>String(F).toLowerCase()));if(!R.size){ae(!1);return}d(F=>F.map(H=>{const Ee=Pn((H==null?void 0:H.text)||"").filter(Ye=>!R.has(String(Ye).toLowerCase())),we=vi(Ee);return we===((H==null?void 0:H.text)||"")?H:{...H,text:we}})),L(!0),ae(!1),Q("Removed invalid tags. Review and save again.")},children:"Remove invalid tags"})]}),children:o.jsxs("div",{className:"sheet-stack",children:[o.jsx("div",{className:"sheet-section",children:o.jsxs("div",{className:"sheet-hint",children:["These aliases contain tags not found in ",o.jsx("code",{className:"font-mono",children:"danbooru_tags.md"}),". Fix them before saving."]})}),(fe=q==null?void 0:q.rows)!=null&&fe.length?o.jsxs("div",{className:"sheet-section",children:[o.jsx("div",{className:"sheet-label",children:"Aliases with issues"}),o.jsx("div",{className:"composer-alias-list",role:"list",children:q.rows.map(R=>o.jsxs("button",{type:"button",role:"listitem",className:"composer-alias-item",onClick:()=>{v(R.id),N(!0),ae(!1)},children:[o.jsxs("div",{className:"composer-alias-header",children:[o.jsx("div",{className:"composer-alias-name",children:R.friendlyName}),R.category?o.jsx("span",{className:"composer-alias-category",children:zn(R.category)}):null]}),o.jsxs("div",{className:"composer-alias-token",children:["$",R.token,"$"]}),o.jsx("div",{className:"tag-invalid-inline",children:R.invalid.map(F=>o.jsx("span",{className:"tag-chip is-invalid",children:o.jsx("code",{className:"tag-chip-code",children:F})},`${R.id}-${F}`))})]},R.id))})]}):null]})})]})}const s1={contentVisibility:"auto",containIntrinsicSize:"240px 120px"},l1=a.memo(function({tag:t,category:n,count:r,isCollected:s,onSelectTag:l,addToCollection:i,removeFromCollection:c,setStatus:u}){const d=a.useCallback(()=>{const m=String(t||"");if(l){l(m),u(`Added: ${m}`);return}s?(c(m),u(`Removed: ${m}`)):(i(m),u(`Added: ${m}`))},[i,s,l,c,u,t]);return o.jsx("div",{className:"tag-library-row",role:"listitem",style:s1,"data-virtual-row":"true",children:o.jsxs("button",{type:"button",className:`composer-alias-item tag-library-item ${!l&&s?"is-collected":""}`,onClick:d,children:[o.jsxs("div",{className:"composer-alias-header",children:[o.jsx("div",{className:"composer-alias-name tag-library-name",children:o.jsx("code",{className:"tag-library-code",children:t})}),n?o.jsx("span",{className:"composer-alias-category",children:fr(n)}):null]}),o.jsx("div",{className:"composer-alias-token",children:Number(r||0).toLocaleString()})]})})});function o1(e){var n,r;const t=String(e||"");if(!t)return!1;try{return(r=(n=navigator.clipboard)==null?void 0:n.writeText)==null||r.call(n,t),!0}catch{return!1}}function i1({open:e,onClose:t,onSelectTag:n,initialQuery:r="",title:s="Tag library",contextTitle:l="",contextToken:i="",contextText:c="",contextTagCount:u=null,inline:d=!1}){const[m,y]=a.useState(r||""),[g,x]=a.useState(""),[w,j]=a.useState("count"),[S,h]=a.useState([]),[f,p]=a.useState([]),[v,k]=a.useState(0),[N,_]=a.useState(0),[I,z]=a.useState(!1),[T,O]=a.useState(!1),[ae,q]=a.useState(""),[Se,ve]=a.useState(""),Q=a.useRef(null),ce=a.useRef(null),P=a.useRef(new Map),C=a.useRef(new Map),[L,E]=a.useState([]),[V,Y]=a.useState(!1),[se,re]=a.useState(null),[X,ie]=a.useState(null),G=a.useRef(null),$=a.useRef(null),D=a.useRef(null),le=a.useRef(null),ue=a.useRef(null),Pe=f.length<v,je=d||e,{containerRef:Re,startIndex:Te,endIndex:Fe,topSpacer:Be,bottomSpacer:U,virtualized:ke,isNearEnd:He}=wu({itemCount:f.length,enabled:je,estimateRowHeight:74,overscan:8,minItems:90}),te=ke?f.slice(Te,Fe):f,pe=a.useMemo(()=>L.join(", "),[L]),oe=a.useMemo(()=>new Set(L.map(B=>B.toLowerCase())),[L]),he=a.useCallback((B,J,de,ye,fe)=>[B||"",J||"",de||"",String(ye||0),String(fe||0)].join("::"),[]),be=a.useCallback(()=>{const B=P.current;if(B.size<=50)return;const J=Array.from(B.entries());J.sort((de,ye)=>{var fe,R;return(((fe=de[1])==null?void 0:fe.ts)||0)-(((R=ye[1])==null?void 0:R.ts)||0)}),J.slice(0,Math.max(0,J.length-50)).forEach(([de])=>B.delete(de))},[]),Ce=a.useCallback(B=>{const J=String(B||"").trim();J&&E(de=>new Set(de.map(fe=>fe.toLowerCase())).has(J.toLowerCase())?de:[...de,J])},[]),Me=a.useCallback(B=>{const J=String(B||"").trim().toLowerCase();J&&E(de=>de.filter(ye=>ye.toLowerCase()!==J))},[]),Ge=a.useCallback(()=>{E([]),ve("Cleared collected tags.")},[]),ct=a.useCallback(()=>{var J,de;if(!L.length){ve("No tags to copy.");return}if(o1(pe)){ve(`Copied ${L.length} tag${L.length===1?"":"s"}.`);return}const B=D.current;if(B)try{B.value=pe,B.removeAttribute("readonly"),B.select(),B.setSelectionRange(0,pe.length);const ye=document.execCommand&&document.execCommand("copy");if(B.setAttribute("readonly","readonly"),(de=(J=window.getSelection())==null?void 0:J.removeAllRanges)==null||de.call(J),ye){ve(`Copied ${L.length} tag${L.length===1?"":"s"}.`);return}}catch{}ve("Copy not available on this browser.")},[L,pe]),yt=a.useCallback((B,J)=>{E(de=>{const ye=[...de],[fe]=ye.splice(B,1);return ye.splice(J,0,fe),ye})},[]);a.useCallback((B,J)=>{re(J),le.current=B.target,B.dataTransfer.effectAllowed="move",B.dataTransfer.setData("text/plain",J.toString()),requestAnimationFrame(()=>{le.current&&le.current.classList.add("is-dragging")})},[]),a.useCallback(()=>{le.current&&le.current.classList.remove("is-dragging"),se!==null&&X!==null&&se!==X&&yt(se,X),re(null),ie(null),le.current=null},[se,X,yt]),a.useCallback((B,J)=>{B.preventDefault(),B.dataTransfer.dropEffect="move",ie(J)},[]),a.useCallback(()=>{},[]),a.useCallback((B,J)=>{const de=B.touches[0];ue.current={idx:J,startX:de.clientX,startY:de.clientY,moved:!1}},[]),a.useCallback(B=>{if(!ue.current)return;const J=B.touches[0],de=Math.abs(J.clientX-ue.current.startX),ye=Math.abs(J.clientY-ue.current.startY);if(de>10||ye>10){ue.current.moved=!0,re(ue.current.idx),B.preventDefault();const fe=document.querySelectorAll(".collected-tag-chip"),R=J.clientX,F=J.clientY;for(let H=0;H<fe.length;H++){const K=fe[H].getBoundingClientRect();if(R>=K.left&&R<=K.right&&F>=K.top&&F<=K.bottom){ie(H);break}}}},[]),a.useCallback(()=>{var B;(B=ue.current)!=null&&B.moved&&se!==null&&X!==null&&se!==X&&yt(se,X),ue.current=null,re(null),ie(null)},[se,X,yt]);const ft=a.useCallback(async({nextQuery:B,nextCategory:J,nextSort:de}={})=>{var Ye;const ye=typeof B=="string"?B:m,fe=typeof J=="string"?J:g,R=typeof de=="string"?de:w,F=he(ye,fe,R,80,0),H=Date.now(),K=P.current.get(F);if(K&&H-K.ts<5*60*1e3){p(K.items||[]),k(Number(K.total||0)),_(0),q(""),ve(""),z(!1);return}const Ee=C.current.get(F);if(Ee){try{const ze=await Ee;p((ze==null?void 0:ze.items)||[]),k(Number((ze==null?void 0:ze.total)||0)),_(0),q(""),ve("")}catch{}return}z(!0),q(""),ve(""),_(0),Q.current&&Q.current.key!==F&&Q.current.controller.abort();const we=new AbortController;Q.current={controller:we,key:F};try{const ze=Fo({q:ye,category:fe,sort:R,limit:80,offset:0},{signal:we.signal});C.current.set(F,ze);const Ze=await ze;P.current.set(F,{items:(Ze==null?void 0:Ze.items)||[],total:Number((Ze==null?void 0:Ze.total)||0),ts:Date.now()}),be(),p((Ze==null?void 0:Ze.items)||[]),k(Number((Ze==null?void 0:Ze.total)||0))}catch(ze){if((ze==null?void 0:ze.name)==="AbortError")return;console.error("Failed to search tags",ze),q("Unable to load tags right now."),p([]),k(0)}finally{C.current.delete(F),((Ye=Q.current)==null?void 0:Ye.key)===F&&(Q.current=null),z(!1)}},[he,g,m,w,be]),it=a.useCallback(async()=>{var F;if(I||T||!Pe)return;const B=N+80,J=he(m,g,w,80,B),de=Date.now(),ye=P.current.get(J);if(ye&&de-ye.ts<5*60*1e3){p(H=>[...H,...ye.items||[]]),k(Number(ye.total||0)),_(B),O(!1);return}const fe=C.current.get(J);if(fe){try{const H=await fe,K=(H==null?void 0:H.items)||[];p(Ee=>[...Ee,...K]),k(Number((H==null?void 0:H.total)||0)),_(B)}catch{}return}O(!0),q(""),ce.current&&ce.current.key!==J&&ce.current.controller.abort();const R=new AbortController;ce.current={controller:R,key:J};try{const H=Fo({q:m,category:g,sort:w,limit:80,offset:B},{signal:R.signal});C.current.set(J,H);const K=await H,Ee=(K==null?void 0:K.items)||[];P.current.set(J,{items:Ee,total:Number((K==null?void 0:K.total)||0),ts:Date.now()}),be(),p(we=>[...we,...Ee]),k(Number((K==null?void 0:K.total)||0)),_(B)}catch(H){if((H==null?void 0:H.name)==="AbortError")return;console.error("Failed to load more tags",H),q("Unable to load more tags.")}finally{C.current.delete(J),((F=ce.current)==null?void 0:F.key)===J&&(ce.current=null),O(!1)}},[he,Pe,g,I,T,N,m,w,be]);a.useEffect(()=>{if(!je)return;q(""),ve("");let B=!1;return(async()=>{try{const J=await om();if(B)return;h(Array.isArray(J==null?void 0:J.categories)?J.categories:[])}catch(J){console.error("Failed to load tag categories",J),B||h([])}})(),()=>{B=!0}},[je]),a.useEffect(()=>{je&&(y(r||""),x(""),j("count"),p([]),k(0),_(0),z(!1),O(!1),q(""),ve(""),E([]))},[r,je]),a.useEffect(()=>{if(!je)return;const B=window.setTimeout(()=>{ft()},220);return()=>window.clearTimeout(B)},[g,je,m,ft,w]),a.useEffect(()=>()=>{var B,J,de,ye;Q.current&&((J=(B=Q.current.controller)==null?void 0:B.abort)==null||J.call(B)),ce.current&&((ye=(de=ce.current.controller)==null?void 0:de.abort)==null||ye.call(de))},[]),a.useEffect(()=>{if(!je||ke)return;const B=G.current;if(!B||typeof IntersectionObserver>"u")return;const J=new IntersectionObserver(de=>{const ye=de[0];ye!=null&&ye.isIntersecting&&it()},{threshold:.1});return J.observe(B),()=>J.disconnect()},[je,it]),a.useEffect(()=>{ke&&(!Pe||I||T||He&&it())},[ke,Pe,I,T,He,it]);const M=a.useMemo(()=>d?null:o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:t,children:"Done"}),o.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:()=>ft(),disabled:I||T,children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx(tc,{size:14}),"Refresh"]})})]}),[d,I,T,t,ft]),ee=!!(n&&(l||i||c)),xe=Number.isFinite(u)?`${u} tags`:"",_e=o.jsxs("div",{className:`sheet-stack ${d?"tag-library-page":""}`,children:[ee?o.jsxs("div",{className:"tag-library-context",children:[o.jsxs("div",{className:"tag-library-context-head",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"sheet-label",children:"Adding to alias"}),o.jsx("div",{className:"tag-library-context-title",children:l||"Alias"}),i?o.jsx("div",{className:"tag-library-context-token",children:i}):null]}),o.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:t,children:"Back"})]}),o.jsx("div",{className:"tag-library-context-preview",children:c||""}),xe?o.jsx("div",{className:"tag-library-context-meta",children:xe}):null]}):null,o.jsxs("div",{className:"sheet-section",children:[d?null:o.jsx("div",{className:"sheet-label",children:"Browse"}),o.jsxs("div",{className:"composer-filters",children:[o.jsxs("div",{className:"input-with-action",children:[o.jsx("input",{ref:$,type:"search",value:m,onChange:B=>y(B.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),o.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>y(""),disabled:!m,children:"Clear"})]}),o.jsx(tt,{value:g,onChange:x,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:[{value:"",label:"Category: All"},...S.map(B=>({value:B.key,label:`${fr(B.key)} (${Number(B.actual||B.count||0).toLocaleString()})`}))]}),o.jsx(tt,{value:w,onChange:j,className:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]})]}),Se?o.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:Se}):null,ae?o.jsx("div",{className:"text-xs text-[#FF8F70]",children:ae}):null]}),o.jsx("div",{className:"composer-alias-list tag-library-grid",role:"list",ref:Re,children:I?o.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):f.length===0?o.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):o.jsxs(o.Fragment,{children:[ke&&Be>0?o.jsx("div",{"aria-hidden":!0,style:{height:`${Be}px`}}):null,te.map(B=>o.jsx(l1,{tag:B.tag,category:B.category,count:B.count,isCollected:oe.has(String(B.tag||"").toLowerCase()),onSelectTag:n,addToCollection:Ce,removeFromCollection:Me,setStatus:ve},`${B.tag}-${B.category}`)),ke&&U>0?o.jsx("div",{"aria-hidden":!0,style:{height:`${U}px`}}):null,ke?null:o.jsx("div",{ref:G,className:"composer-sentinel"}),T?o.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]});return je?d?o.jsxs("section",{className:"tag-library-surface",children:[s?o.jsx("div",{className:"sheet-label tag-library-page-title",children:s}):null,_e,n?null:o.jsxs("div",{className:"tag-collection-bar","aria-live":"polite",children:[o.jsxs("div",{className:"tag-collection-bar-main",children:[o.jsx("div",{className:"tag-collection-bar-title",children:"Tags"}),o.jsx("div",{className:"tag-collection-bar-count","aria-live":"polite",children:L.length===0?"No tags selected":`${L.length} selected`})]}),o.jsx("button",{type:"button",className:"tag-collection-menu-btn",onClick:()=>Y(!0),"aria-label":"Manage collected tags",children:o.jsx(nw,{size:16})}),o.jsx("textarea",{ref:D,value:pe,onChange:B=>{const J=B.target.value.split(",").map(fe=>fe.trim()).filter(Boolean),de=new Set,ye=[];J.forEach(fe=>{const R=fe.toLowerCase();de.has(R)||(de.add(R),ye.push(fe))}),E(ye)},className:"sr-only","aria-label":"Collected tags text"})]}),n?null:o.jsx(Mt,{open:V,onClose:()=>Y(!1),title:"Collected tags",variant:"sheet",shouldCloseOnOverlayClick:!0,children:o.jsxs("div",{className:"sheet-stack",children:[o.jsxs("div",{className:"sheet-section",children:[o.jsxs("div",{className:"sheet-label",children:["Tags (",L.length,")"]}),o.jsxs("div",{className:"tag-collection-codeblock",children:[o.jsx("pre",{className:"tag-collection-pre",children:pe||""}),o.jsx("button",{type:"button",className:"tag-collection-copy-btn",onClick:ct,disabled:L.length===0,"aria-label":"Copy collected tags",children:o.jsx(rw,{size:16})}),o.jsx("textarea",{ref:D,value:pe,readOnly:!0,className:"sr-only","aria-label":"Collected tags text"})]}),L.length?o.jsx("div",{className:"tag-collection-chips",children:L.map((B,J)=>o.jsxs("span",{className:"collected-tag-chip",onClick:()=>Me(B),role:"button",tabIndex:0,onKeyDown:de=>{de.target===de.currentTarget&&(de.key==="Enter"||de.key===" ")&&(de.preventDefault(),Me(B))},children:[o.jsx("code",{className:"collected-tag-code",children:B}),o.jsx("button",{type:"button",className:"collected-tag-remove","aria-label":`Remove ${B}`,onClick:de=>{de.stopPropagation(),Me(B)},children:o.jsx(dr,{size:12})})]},`${B}-${J}`))}):o.jsx("div",{className:"sheet-hint",children:"No tags collected yet."})]}),o.jsxs("div",{className:"sheet-section flex gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>Y(!1),children:"Close"}),o.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:Ge,disabled:L.length===0,children:"Clear"})]})]})})]}):o.jsx(Mt,{open:e,onClose:t,title:s,variant:"fullscreen",contentClassName:"tag-library-sheet",footer:M,shouldCloseOnOverlayClick:!1,children:_e}):null}function a1(){const e=kn(),[t]=nm(),n=t.get("q")||"",r=a.useMemo(()=>n?`Tag Library  ${n}`:"Tag Library",[n]);return o.jsxs("div",{className:"page-shell page-stack",children:[o.jsxs("div",{className:"page-bar",children:[o.jsx("h1",{className:"page-bar-title",children:r}),o.jsxs("div",{className:"page-bar-actions",children:[o.jsx(Ft,{size:"xs",onClick:()=>e("/aliases"),children:"Aliases"}),o.jsx(Ft,{size:"xs",onClick:()=>e("/compose"),children:"Composer"})]})]}),o.jsx(i1,{inline:!0,initialQuery:n,title:"Browse",onSelectTag:null})]})}const Dm={contentVisibility:"auto",containIntrinsicSize:"260px 140px"},c1=a.memo(function({tag:t,category:n,count:r,isCollected:s,onToggle:l}){const i=a.useCallback(c=>{c.stopPropagation(),l(t)},[l,t]);return o.jsxs("button",{type:"button",className:`composer-alias-item composer-tag-item ${s?"is-collected":""}`,onClick:i,style:Dm,"data-virtual-row":"true",children:[o.jsxs("div",{className:"composer-alias-header",children:[o.jsx("div",{className:"composer-alias-name composer-tag-name",children:o.jsx("code",{className:"composer-tag-code",children:t})}),n?o.jsx("span",{className:"composer-alias-category",children:fr(n)}):null]}),o.jsx("div",{className:"composer-alias-token composer-tag-count",children:Number(r||0).toLocaleString()})]})});function u1({open:e=!1,onClose:t,value:n="",onChange:r,aliasOptions:s=[],aliasCatalog:l=[],fieldLabel:i="Prompt",variant:c="sheet"}){var Pu,_u,Ru;const u=a.useRef(null),d=a.useRef(null),m=a.useRef(null),y=a.useRef(null),[g,x]=a.useState(n),[w,j]=a.useState(""),S=a.useDeferredValue(w),[h,f]=a.useState("All"),[p,v]=a.useState("All"),[k,N]=a.useState(30),[_,I]=a.useState("compose"),z=c==="page",T=z||e,[O,ae]=a.useState(null),[q,Se]=a.useState(null),[ve,Q]=a.useState(null),ce=a.useRef(null),P=a.useRef(null),[C,L]=a.useState(!1),[E,V]=a.useState(null),Y=a.useRef(null),se=a.useRef(null),[re,X]=a.useState(""),[ie,G]=a.useState(""),[$,D]=a.useState("count"),[le,ue]=a.useState([]),[Pe,je]=a.useState([]),[Re,Te]=a.useState(0),[Fe,Be]=a.useState(0),[U,ke]=a.useState(!1),[He,te]=a.useState(!1),[pe,oe]=a.useState(""),he=a.useRef(null),be=a.useRef(null),Ce=a.useRef(new Map),Me=a.useRef(new Map),[Ge,ct]=a.useState([]),[yt,ft]=a.useState(""),[it,M]=a.useState([]),[ee,xe]=a.useState(""),_e=a.useMemo(()=>{if(!g)return{text:"",parts:[]};const b=new Map;if((l||[]).forEach(Ue=>{if(!Ue)return;const Le=String(Ue.token||"").trim().toLowerCase(),Ke=typeof Ue.text=="string"?Ue.text.trim():"";!Le||!Ke||b.set(Le,Ke)}),!b.size||!g.includes("$"))return{text:g,parts:[{text:g,isAlias:!1}]};const A=[],me=/\$([a-z0-9_:-]+)\$/gi;let Ne=0,De;for(;(De=me.exec(g))!==null;){const Ue=De.index;Ue>Ne&&A.push({text:g.slice(Ne,Ue),isAlias:!1});const Le=String(De[1]||"").toLowerCase(),Ke=b.get(Le);typeof Ke=="string"?A.push({text:Ke,isAlias:!0}):A.push({text:De[0],isAlias:!1}),Ne=me.lastIndex}return Ne<g.length&&A.push({text:g.slice(Ne),isAlias:!1}),{text:A.map(Ue=>Ue.text).join(""),parts:A}},[l,g]);a.useEffect(()=>{e&&(x(n),I("compose"),j(""),f("All"),v("All"),N(30),ae(null),Se(null),Q(null),L(!1),V(null),ne(""),X(""),G(""),D("count"),je([]),Te(0),Be(0),ke(!1),te(!1),oe(""))},[e,n]),a.useEffect(()=>{if(O===null||typeof document>"u")return;const b=document.querySelector("main.app-content"),A={htmlOverscroll:document.documentElement.style.overscrollBehavior,bodyOverscroll:document.body.style.overscrollBehavior,bodyOverflow:document.body.style.overflow,scrollOverflow:b==null?void 0:b.style.overflow,scrollTouch:b==null?void 0:b.style.touchAction,scrollOverscroll:b==null?void 0:b.style.overscrollBehavior};return document.documentElement.style.overscrollBehavior="none",document.body.style.overscrollBehavior="none",document.body.style.overflow="hidden",b&&(b.style.overflow="hidden",b.style.touchAction="none",b.style.overscrollBehavior="none"),()=>{document.documentElement.style.overscrollBehavior=A.htmlOverscroll||"",document.body.style.overscrollBehavior=A.bodyOverscroll||"",document.body.style.overflow=A.bodyOverflow||"",b&&(b.style.overflow=A.scrollOverflow||"",b.style.touchAction=A.scrollTouch||"",b.style.overscrollBehavior=A.scrollOverscroll||"")}},[O]);const B=a.useMemo(()=>(Array.isArray(l)?l.filter(b=>b&&b.name):[]).map(b=>({...b,...mu(b)})),[l]),J=a.useMemo(()=>{const b=new Map;return B.forEach(A=>{A!=null&&A.token&&b.set(String(A.token).toLowerCase(),A)}),b},[B]),de=a.useMemo(()=>{const b=new Set(["All"]);return B.forEach(A=>{A.category&&b.add(A.category)}),Array.from(b).sort((A,me)=>A.localeCompare(me))},[B]),ye=a.useMemo(()=>{const b=new Set(["All"]);return B.forEach(A=>{(!h||h==="All"||A.category===h)&&A.subcategory&&b.add(A.subcategory)}),Array.from(b).sort((A,me)=>A.localeCompare(me))},[B,h]),fe=a.useMemo(()=>["All",...de.filter(b=>b!=="All")],[de]),R=a.useMemo(()=>["All",...ye.filter(b=>b!=="All")],[ye]),F=a.useMemo(()=>{const b=S.trim().toLowerCase();return B.filter(A=>{var me,Ne,De,Oe;return h!=="All"&&(A.category||"")!==h||p!=="All"&&(A.subcategory||"other")!==p?!1:b?((me=A.token)==null?void 0:me.toLowerCase().includes(b))||((Ne=A.text)==null?void 0:Ne.toLowerCase().includes(b))||((De=A.name)==null?void 0:De.toLowerCase().includes(b))||((Oe=A.displayName)==null?void 0:Oe.toLowerCase().includes(b)):!0}).sort((A,me)=>{const Ne=(A.subcategory||"").toLowerCase(),De=(me.subcategory||"").toLowerCase();return Ne!==De?Ne.localeCompare(De):A.token.localeCompare(me.token)})},[B,h,p,S]),H=a.useMemo(()=>F.slice(0,k),[F,k]);a.useEffect(()=>{N(30)},[h,p,w,B]),a.useEffect(()=>{v("All")},[h]),a.useEffect(()=>{const b=m.current;if(!b)return;const A=new IntersectionObserver(me=>{me[0].isIntersecting&&k<F.length&&N(De=>Math.min(De+20,F.length))},{threshold:.1});return A.observe(b),()=>A.disconnect()},[k,F.length]);const K=a.useMemo(()=>typeof g!="string"?[]:Iw(g),[g]);a.useEffect(()=>{if(!e||_!=="tags"||le.length>0)return;let b=!1;return(async()=>{try{const A=await om();if(b)return;ue(Array.isArray(A==null?void 0:A.categories)?A.categories:[])}catch(A){console.error("Failed to load tag categories",A),b||ue([])}})(),()=>{b=!0}},[e,_,le.length]);const Ee=a.useCallback((b,A,me,Ne,De)=>[b||"",A||"",me||"",String(Ne||0),String(De||0)].join("::"),[]),we=a.useCallback(()=>{const b=Ce.current;if(b.size<=50)return;const A=Array.from(b.entries());A.sort((me,Ne)=>{var De,Oe;return(((De=me[1])==null?void 0:De.ts)||0)-(((Oe=Ne[1])==null?void 0:Oe.ts)||0)}),A.slice(0,Math.max(0,A.length-50)).forEach(([me])=>b.delete(me))},[]),Ye=a.useCallback(async({nextQuery:b,nextCategory:A,nextSort:me}={})=>{var Iu;const Ne=typeof b=="string"?b:re,De=typeof A=="string"?A:ie,Oe=typeof me=="string"?me:$,Ue=Ee(Ne,De,Oe,80,0),Le=Date.now(),Ke=Ce.current.get(Ue);if(Ke&&Le-Ke.ts<5*60*1e3){je(Ke.items||[]),Te(Number(Ke.total||0)),Be(0),oe(""),ke(!1);return}const bn=Me.current.get(Ue);if(bn){try{const _t=await bn;je((_t==null?void 0:_t.items)||[]),Te(Number((_t==null?void 0:_t.total)||0)),Be(0),oe("")}catch{}return}ke(!0),oe(""),Be(0),he.current&&he.current.key!==Ue&&he.current.controller.abort();const Mr=new AbortController;he.current={controller:Mr,key:Ue};try{const _t=Fo({q:Ne,category:De,sort:Oe,limit:80,offset:0},{signal:Mr.signal});Me.current.set(Ue,_t);const Kt=await _t;Ce.current.set(Ue,{items:(Kt==null?void 0:Kt.items)||[],total:Number((Kt==null?void 0:Kt.total)||0),ts:Date.now()}),we(),je((Kt==null?void 0:Kt.items)||[]),Te(Number((Kt==null?void 0:Kt.total)||0))}catch(_t){if((_t==null?void 0:_t.name)==="AbortError")return;console.error("Failed to search tags",_t),oe("Unable to load tags right now."),je([]),Te(0)}finally{Me.current.delete(Ue),((Iu=he.current)==null?void 0:Iu.key)===Ue&&(he.current=null),ke(!1)}},[Ee,ie,re,$,we]),ze=a.useCallback(async()=>{var Ue;if(U||He||Pe.length>=Re)return;const b=Fe+80,A=Ee(re,ie,$,80,b),me=Date.now(),Ne=Ce.current.get(A);if(Ne&&me-Ne.ts<5*60*1e3){je(Le=>[...Le,...Ne.items||[]]),Te(Number(Ne.total||0)),Be(b),te(!1);return}const De=Me.current.get(A);if(De){try{const Le=await De,Ke=(Le==null?void 0:Le.items)||[];je(bn=>[...bn,...Ke]),Te(Number((Le==null?void 0:Le.total)||0)),Be(b)}catch{}return}te(!0),oe(""),be.current&&be.current.key!==A&&be.current.controller.abort();const Oe=new AbortController;be.current={controller:Oe,key:A};try{const Le=Fo({q:re,category:ie,sort:$,limit:80,offset:b},{signal:Oe.signal});Me.current.set(A,Le);const Ke=await Le,bn=(Ke==null?void 0:Ke.items)||[];Ce.current.set(A,{items:bn,total:Number((Ke==null?void 0:Ke.total)||0),ts:Date.now()}),we(),je(Mr=>[...Mr,...bn]),Te(Number((Ke==null?void 0:Ke.total)||0)),Be(b)}catch(Le){if((Le==null?void 0:Le.name)==="AbortError")return;console.error("Failed to load more tags",Le),oe("Unable to load more tags.")}finally{Me.current.delete(A),((Ue=be.current)==null?void 0:Ue.key)===A&&(be.current=null),te(!1)}},[Ee,ie,U,He,Fe,re,$,Pe.length,Re,we]);a.useEffect(()=>{if(!e||_!=="tags")return;const b=window.setTimeout(()=>{Ye()},220);return()=>window.clearTimeout(b)},[e,_,re,ie,$,Ye]),a.useEffect(()=>()=>{var b,A,me,Ne;he.current&&((A=(b=he.current.controller)==null?void 0:b.abort)==null||A.call(b)),be.current&&((Ne=(me=be.current.controller)==null?void 0:me.abort)==null||Ne.call(me))},[]);const{containerRef:Ze,startIndex:fn,endIndex:Vn,topSpacer:Tr,bottomSpacer:js,virtualized:Ht,isNearEnd:Cl}=wu({itemCount:Pe.length,enabled:e&&_==="tags",estimateRowHeight:70,overscan:8,minItems:90}),Ns=Ht?Pe.slice(fn,Vn):Pe;a.useEffect(()=>{if(!e||_!=="tags"||Ht)return;const b=se.current;if(!b||typeof IntersectionObserver>"u")return;const A=new IntersectionObserver(me=>{const Ne=me[0];Ne!=null&&Ne.isIntersecting&&ze()},{threshold:.1});return A.observe(b),()=>A.disconnect()},[e,_,Ht,ze]),a.useEffect(()=>{Ht&&(U||He||Pe.length>=Re||Cl&&ze())},[Ht,U,He,Pe.length,Re,Cl,ze]);const tn=a.useCallback(b=>{x(A=>{const Ne=typeof b=="function"?b(typeof A=="string"?A:""):String(b||"");return c==="page"&&(r==null||r(Ne)),Ne})},[r,c]),Cn=a.useCallback(b=>{const A=String(b||"").trim();if(A&&(tn(me=>{const Ne=me.length,De=me.length,Oe=me.slice(0,Ne),Ue=me.slice(De),Le=Oe.match(/[^\s]$/),Ke=Ue.match(/^[^\s]/),bn=Le&&Le[0]!==","?", ":"",Mr=Ke&&Ke[0]!==","?", ":"";return Oe+bn+A+Mr+Ue}),u.current))try{u.current.blur()}catch{}},[tn]),[W,ne]=a.useState(""),Ie=a.useCallback(()=>{const b=String(W||"").trim();if(!b)return;const me=b.split(",").map(Ne=>Ne.trim()).filter(Boolean).join(", ");me&&(Cn(me),ne(""),I("compose"))},[W,Cn]),Ae=a.useCallback(()=>{ct([]),ft("Cleared collected tags.")},[]),We=a.useCallback(()=>{if(!Ge.length){ft("No tags to apply.");return}Cn(Ge.join(", ")),ft(`Applied ${Ge.length} tag${Ge.length===1?"":"s"}.`),ct([]),I("compose")},[Ge,Cn]),St=a.useCallback(b=>{const A=String(b||"").trim();A&&ct(me=>{const Ne=A.toLowerCase();return me.some(Oe=>Oe.toLowerCase()===Ne)?(ft(`Removed: ${A}`),me.filter(Oe=>Oe.toLowerCase()!==Ne)):(ft(`Selected: ${A}`),[...me,A])})},[]),bl=a.useCallback(b=>{const A=String(b||"").trim();A&&M(me=>{const Ne=A.toLowerCase();return me.some(Oe=>Oe.toLowerCase()===Ne)?(xe(`Removed: ${A}`),me.filter(Oe=>Oe.toLowerCase()!==Ne)):(xe(`Selected: ${A}`),[...me,A])})},[]),El=a.useCallback(()=>{M([]),xe("Cleared selected aliases.")},[]),Bm=a.useCallback(()=>{if(!it.length){xe("No aliases to apply.");return}const b=it.map(A=>`$${A}$`).join(", ");Cn(b),xe(`Applied ${it.length} alias${it.length===1?"":"es"}.`),M([]),I("compose")},[it,Cn]),Gt=_==="tags"?{kind:"tag",count:Ge.length,status:yt,onClear:Ae,onApply:We}:_==="aliases"?{kind:"alias",count:it.length,status:ee,onClear:El,onApply:Bm}:null,Wn=(Gt==null?void 0:Gt.count)||0,Um=Gt?`${Wn} ${Gt.kind==="alias"?Wn===1?"alias":"aliases":Wn===1?Gt.kind:`${Gt.kind}s`} selected`:"",Vm=!z&&Wn>0,Su=z&&Wn>0,Wm=Su?{"--composer-selection-offset":"var(--bottom-nav-height, 64px)"}:void 0,ju=(b,A,me)=>!Gt||Wn===0?null:o.jsxs("div",{className:`composer-tag-collection-bar ${b||""}`.trim(),style:me,children:[o.jsxs("div",{children:[o.jsx("div",{className:"composer-tag-collection-label",children:Um}),Gt.status?o.jsx("div",{className:"composer-tag-collection-status",children:Gt.status}):null]}),o.jsxs("div",{className:"composer-tag-collection-actions",children:[o.jsx("button",{type:"button",className:"composer-tag-collection-btn",onClick:Gt.onClear,disabled:!Wn,children:"Clear"}),o.jsx("button",{type:"button",className:"composer-tag-collection-btn is-primary",onClick:Gt.onApply,disabled:!Wn,children:A})]})]}),Hm=Vm?ju("is-footer","Insert"):null,Gm=Su?ju("is-floating","Insert",Wm):null,Nu=b=>{tn(A=>zw(A||"",b))},ku=a.useCallback((b,A)=>{if(!(K!=null&&K.length))return;const me=b+A;me<0||me>=K.length||(tn(Ne=>cf(Ne||"",K,b,me)),Q(me))},[K,tn]),Cu=b=>{if(!b)return;let A=b.text;if(b.type==="alias"){const Ne=J.get(b.text.toLowerCase());A=(Ne==null?void 0:Ne.displayName)||b.text}const me=of(g||"",b);V({element:b,displayName:A,weight:(me==null?void 0:me.weight)??1}),L(!0)},Ll=a.useCallback((b,A)=>{b===A||b===null||A===null||K!=null&&K.length&&tn(me=>cf(me||"",K,b,A))},[K,tn]),Km=a.useCallback((b,A)=>{ae(A),ce.current=b.target,b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text/plain",A.toString()),requestAnimationFrame(()=>{ce.current&&ce.current.classList.add("is-dragging")})},[]),Qm=a.useCallback(()=>{ce.current&&ce.current.classList.remove("is-dragging"),O!==null&&q!==null&&O!==q&&Ll(O,q),ae(null),Se(null),ce.current=null},[O,q,Ll]),Ym=a.useCallback((b,A)=>{b.preventDefault(),b.dataTransfer.dropEffect="move",A!==q&&Se(A)},[q]),qm=a.useCallback(()=>{},[]),Xm=a.useCallback((b,A)=>{var Oe,Ue;if(!((Ue=(Oe=b.target)==null?void 0:Oe.closest)==null?void 0:Ue.call(Oe,".composer-token-drag-handle")))return;const Ne=b.touches[0],De=window.setTimeout(()=>{P.current&&(P.current.active=!0,ae(A),Se(A))},240);P.current={idx:A,startX:Ne.clientX,startY:Ne.clientY,active:!1,timer:De}},[]),Jm=a.useCallback(b=>{if(!P.current)return;const A=b.touches[0],me=Math.abs(A.clientX-P.current.startX),Ne=Math.abs(A.clientY-P.current.startY);if(!P.current.active){(me>8||Ne>8)&&(window.clearTimeout(P.current.timer),P.current=null);return}b.preventDefault();const De=document.querySelectorAll(".composer-token-draggable"),Oe=A.clientX,Ue=A.clientY;for(let Le=0;Le<De.length;Le++){const Ke=De[Le].getBoundingClientRect();if(Oe>=Ke.left&&Oe<=Ke.right&&Ue>=Ke.top&&Ue<=Ke.bottom){Se(Le);break}}},[]),Zm=a.useCallback(()=>{var b,A;(b=P.current)!=null&&b.timer&&window.clearTimeout(P.current.timer),(A=P.current)!=null&&A.active&&O!==null&&q!==null&&O!==q&&Ll(O,q),P.current=null,ae(null),Se(null)},[O,q,Ll]),eg=a.useCallback(()=>{var b;(b=P.current)!=null&&b.timer&&window.clearTimeout(P.current.timer),P.current=null,ae(null),Se(null)},[]),tg=()=>{r==null||r(g),t==null||t()},bu=()=>{t==null||t()};if(!T)return null;const Eu=o.jsxs("div",{className:`composer-shell ${z?"is-page":""}`,children:[o.jsx(br,{ariaLabel:"Composer tabs",value:_,onChange:I,items:[{key:"compose",label:"Compose",icon:o.jsx(fu,{size:14})},{key:"aliases",label:"Aliases",icon:o.jsx(Nl,{size:14})},{key:"tags",label:"Tags",icon:o.jsx(ur,{size:14})}]}),o.jsxs("div",{className:`composer-panel composer-panel-compose ${_==="compose"?"is-visible":""}`,children:[o.jsx("div",{className:"composer-editor",children:o.jsxs("div",{className:"composer-input-row",children:[o.jsx("input",{ref:u,type:"text",value:W,onChange:b=>ne(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),Ie())},className:"composer-input ui-control ui-input is-compact",placeholder:"Add prompt text","aria-label":"Add prompt text"}),o.jsx("button",{type:"button",className:"composer-add-btn",onClick:Ie,disabled:!W.trim(),"aria-label":"Add prompt text",children:"+"})]})}),o.jsxs("div",{className:"composer-tokens",children:[o.jsxs("div",{className:"composer-tokens-header",children:[o.jsxs("span",{className:"composer-tokens-label",children:["Elements",o.jsx("span",{className:"composer-tokens-count",children:K.length})]}),o.jsx("span",{className:"composer-tokens-hint",children:"Drag to reorder  Tap to adjust"})]}),K.length?o.jsx("div",{ref:y,className:`composer-tokens-list ${O!==null?"is-dragging":""}`,style:{"--composer-elements":K.length},children:K.map((b,A)=>{let me=b.text;if(b.type==="alias"){const Le=J.get(b.text.toLowerCase());me=(Le==null?void 0:Le.displayName)||b.text}const Ne=O===A,De=q===A&&O!==null&&O!==A,Oe=of(g||"",b),Ue=(Oe==null?void 0:Oe.weight)??1;return o.jsxs("span",{className:`composer-token composer-token-draggable ${b.type==="alias"?"is-alias":"is-tag"} ${Ne?"is-dragging":""} ${De?"is-drop-target":""} ${ve===A?"is-selected":""}`,title:b.type==="alias"?`Alias: $${b.text}$`:`Tag: ${b.text}`,role:"button",tabIndex:0,draggable:!0,onDragStart:Le=>Km(Le,A),onDragEnd:Qm,onDragOver:Le=>Ym(Le,A),onDragLeave:qm,onTouchStart:Le=>Xm(Le,A),onTouchMove:Jm,onTouchEnd:Zm,onTouchCancel:eg,onClick:()=>{O===null&&(Q(A),Cu(b))},onKeyDown:Le=>{if(Le.target===Le.currentTarget&&(Le.key==="Enter"||Le.key===" ")){if(Le.preventDefault(),O!==null)return;Q(A),Cu(b)}},children:[o.jsx("span",{className:"composer-token-order",children:A+1}),o.jsx("span",{className:"composer-token-drag-handle","aria-hidden":"true",children:o.jsx(nc,{size:10})}),o.jsx("span",{className:"composer-token-name",children:me}),b.type==="alias"&&o.jsx("span",{className:"composer-token-type",children:"$"}),Math.abs(Ue-1)>1e-6&&o.jsxs("span",{className:"composer-token-weight",children:[In(Ue),""]}),o.jsxs("div",{className:"composer-token-shift",role:"group","aria-label":"Reorder token",children:[o.jsx("button",{type:"button",className:"composer-token-shift-btn",onClick:Le=>{Le.stopPropagation(),ku(A,-1)},"aria-label":"Move up",disabled:A===0,children:""}),o.jsx("button",{type:"button",className:"composer-token-shift-btn",onClick:Le=>{Le.stopPropagation(),ku(A,1)},"aria-label":"Move down",disabled:A===K.length-1,children:""})]}),o.jsx("button",{type:"button",className:"composer-token-remove",onClick:Le=>{Le.stopPropagation(),Nu(b)},"aria-label":`Remove ${b.text}`,children:o.jsx(dr,{size:9})})]},`${b.type}-${b.text}-${b.start}`)})}):o.jsx("div",{className:"composer-empty",children:"No elements yet."})]}),o.jsxs("div",{className:"composer-expanded",children:[o.jsxs("div",{className:"composer-expanded-header",children:[o.jsx("span",{className:"composer-expanded-label",children:"Expanded prompt"}),o.jsx("span",{className:"composer-expanded-meta",children:_e.text?`${_e.text.length} chars`:"Empty"})]}),o.jsx("div",{className:"composer-expanded-box","aria-label":"Expanded prompt",children:_e.text?_e.parts.map((b,A)=>b.isAlias?o.jsx("span",{className:"composer-expanded-alias",children:b.text},`alias-${A}`):o.jsx("span",{children:b.text},`text-${A}`)):"No prompt yet."})]})]}),o.jsxs("div",{className:`composer-panel composer-panel-aliases ${_==="aliases"?"is-visible":""}`,children:[o.jsxs("div",{className:"composer-filters",children:[o.jsxs("div",{className:"input-with-action",children:[o.jsx("input",{ref:d,type:"text",value:w,onChange:b=>j(b.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),o.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>j(""),disabled:!w,children:"Clear"})]}),o.jsx(tt,{value:h,onChange:f,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:fe.map(b=>({value:b,label:b==="All"?"Category: All":zn(b)}))}),R.length>2&&o.jsx(tt,{value:p,onChange:v,className:"composer-subcategory-select",size:"sm",options:R.map(b=>({value:b,label:b==="All"?"All subcategories":fr(b)}))})]}),o.jsx("div",{className:"composer-alias-list",children:F.length===0?o.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):o.jsxs(o.Fragment,{children:[H.map(b=>o.jsxs("button",{type:"button",onClick:()=>bl(b.token),className:`composer-alias-item ${it.some(A=>A.toLowerCase()===b.token.toLowerCase())?"is-collected":""}`,style:Dm,children:[o.jsxs("div",{className:"composer-alias-header",children:[o.jsx("div",{className:"composer-alias-name",children:b.displayName||b.token}),b.category?o.jsx("span",{className:"composer-alias-category",children:zn(b.category)}):null]}),o.jsxs("div",{className:"composer-alias-token",children:["$",b.token,"$"]}),o.jsx("div",{className:"composer-alias-text",children:b.text})]},b.key)),k<F.length&&o.jsx("div",{ref:m,className:"composer-sentinel"})]})})]}),o.jsxs("div",{className:`composer-panel composer-panel-tags ${_==="tags"?"is-visible":""}`,onClick:b=>b.stopPropagation(),children:[o.jsxs("div",{className:"composer-filters",children:[o.jsxs("div",{className:"input-with-action",children:[o.jsx("input",{ref:Y,type:"search",value:re,onChange:b=>X(b.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),o.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>X(""),disabled:!re,children:"Clear"})]}),o.jsx(tt,{value:ie,onChange:G,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:[{value:"",label:"Category: All"},...le.map(b=>({value:b.key,label:`${fr(b.key)} (${Number(b.actual||b.count||0).toLocaleString()})`}))]}),o.jsx(tt,{value:$,onChange:D,className:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]})]}),pe?o.jsx("div",{className:"composer-tags-error",children:pe}):null,o.jsx("div",{className:"composer-alias-list composer-tags-grid",role:"list",ref:Ze,children:U?o.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):Pe.length===0?o.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):o.jsxs(o.Fragment,{children:[Ht&&Tr>0?o.jsx("div",{"aria-hidden":!0,style:{height:`${Tr}px`}}):null,Ns.map(b=>o.jsx(c1,{tag:b.tag,category:b.category,count:b.count,isCollected:Ge.some(A=>A.toLowerCase()===String(b.tag||"").toLowerCase()),onToggle:St},`${b.tag}-${b.category}`)),Ht&&js>0?o.jsx("div",{"aria-hidden":!0,style:{height:`${js}px`}}):null,Pe.length<Re&&!Ht?o.jsx("div",{ref:se,className:"composer-sentinel"}):null,He?o.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]})]}),Lu=o.jsx(ic,{open:C,onClose:()=>L(!1),title:((Pu=E==null?void 0:E.element)==null?void 0:Pu.type)==="alias"?"Alias strength":"Tag strength",tokenLabel:E?((_u=E.element)==null?void 0:_u.type)==="alias"?`${E.displayName}  $${(Ru=E.element)==null?void 0:Ru.text}$`:E.displayName:"",weight:(E==null?void 0:E.weight)??1,onApply:b=>{E!=null&&E.element&&tn(A=>af(A||"",E.element,b))},onRemoveWeight:()=>{E!=null&&E.element&&tn(b=>af(b||"",E.element,null))},onDeleteToken:()=>{E!=null&&E.element&&Nu(E.element)}}),ng=o.jsx("div",{className:"page-bar composer-bar",children:o.jsx("h1",{className:"page-bar-title",children:i||"Prompt"})});return z?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"page-shell page-stack",children:[ng,Eu]}),Gm,Lu]}):o.jsxs(o.Fragment,{children:[o.jsx(Mt,{open:e,onClose:bu,title:"Composer",variant:"fullscreen",shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,footer:o.jsxs("div",{className:"composer-footer-stack",children:[Hm,o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:bu,children:"Cancel"}),o.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:tg,children:"Apply"})]})]}),children:Eu}),Lu]})}function d1(){const e=kn(),[t]=nm(),{formData:n,handleFormChange:r,aliasOptions:s,aliasCatalog:l,promptFieldName:i,handleGenerate:c,workflowData:u,selectedWorkflow:d,isLoading:m}=zm(),g=t.get("field")||i||"prompt",x=(n==null?void 0:n[g])||"";return a.useEffect(()=>{if(!(typeof document>"u"))return document.body.classList.add("no-pull-refresh"),document.documentElement.classList.add("no-pull-refresh"),()=>{document.body.classList.remove("no-pull-refresh"),document.documentElement.classList.remove("no-pull-refresh")}},[]),a.useEffect(()=>{const w=()=>{!u||!d||m||c()};return window.addEventListener("cozygen:request-render",w),()=>window.removeEventListener("cozygen:request-render",w)},[c,m,d,u]),o.jsx(u1,{open:!0,onClose:()=>e("/controls"),value:x,onChange:w=>r(g,w),aliasOptions:s,aliasCatalog:l,fieldLabel:g,variant:"page"})}function f1(){var h,f;const{authed:e,ready:t,login:n}=di(),r=kn(),l=((f=(h=Wt().state)==null?void 0:h.from)==null?void 0:f.pathname)||"/studio",[i,c]=a.useState(""),[u,d]=a.useState(""),[m,y]=a.useState(""),[g,x]=a.useState(!1),[w,j]=a.useState(!1);a.useEffect(()=>{try{localStorage.getItem("cozygen_idle_logout")&&(j(!0),localStorage.removeItem("cozygen_idle_logout"))}catch{}},[]),a.useEffect(()=>{t&&e&&r(l,{replace:!0})},[t,e,l,r]);const S=async p=>{p.preventDefault(),y(""),x(!0);try{await n(i,u),r(l,{replace:!0})}catch(v){v!=null&&v.unauthorized?y("Invalid username or password."):y("Unable to sign in. Please try again.")}finally{x(!1)}};return o.jsx("div",{className:"login-shell",children:o.jsxs("div",{className:"neon-card login-card",children:[o.jsxs("div",{className:"login-brand",children:[o.jsx(pm,{size:34}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"login-title",children:"Sign in"}),o.jsx("div",{className:"login-subtitle",children:"Continue to CozyGen Studio"})]})]}),o.jsxs("form",{className:"login-form",onSubmit:S,children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"login-username",className:"login-label",children:"Username"}),o.jsx("input",{id:"login-username",type:"text",className:"ui-control ui-input",value:i,onChange:p=>c(p.target.value),autoComplete:"username",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"login-password",className:"login-label",children:"Password"}),o.jsx("input",{id:"login-password",type:"password",className:"ui-control ui-input",value:u,onChange:p=>d(p.target.value),autoComplete:"current-password",required:!0})]}),m?o.jsx("div",{className:"ui-alert",children:m}):w?o.jsx("div",{className:"ui-alert is-warn",children:"You were signed out due to inactivity. Please sign in again."}):null,o.jsx("button",{type:"submit",disabled:g,className:"ui-button is-primary w-full",children:g?"Signing in":"Sign in"})]}),o.jsxs("p",{className:"login-footnote",children:["Access is protected by CozyGen auth. Set ",o.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /"," ",o.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server to enable."]})]})})}function p1({containerRef:e}){const{pathname:t,hash:n}=Wt();return a.useEffect(()=>{if(n)return;const r=e==null?void 0:e.current;if(r&&typeof r.scrollTo=="function"){r.scrollTo({top:0,left:0,behavior:"auto"});return}typeof window<"u"&&window.scrollTo(0,0)},[t,n,e]),null}function h1({children:e}){const{authed:t,ready:n}=di(),r=Wt();return n?t?e:o.jsx(Qa,{to:"/login",state:{from:r},replace:!0}):o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-200",children:o.jsxs("div",{className:"page-loading",children:[o.jsx("span",{className:"loading-spinner lg","aria-hidden":"true"}),o.jsx("span",{className:"sr-only",children:"Checking session"})]})})}function m1(){const{pathname:e}=Wt(),t=kn(),{defaultCreds:n,authed:r}=di(),s=e==="/login",l=a.useRef(null),i=!s,c=i;return a.useEffect(()=>{if(!r)return;const u=d=>{var g;const m=String(((g=d==null?void 0:d.detail)==null?void 0:g.fieldName)||"").trim(),y=m?`?field=${encodeURIComponent(m)}`:"";t(`/compose${y}`)};return window.addEventListener("cozygen:open-composer",u),()=>window.removeEventListener("cozygen:open-composer",u)},[r,t]),o.jsxs("div",{className:"app-shell",children:[!s&&o.jsx(lw,{isMobileAlignedNav:i}),!s&&r&&n&&o.jsxs("div",{className:"flex-shrink-0 bg-amber-500/10 text-amber-200 border-b border-amber-400/50 px-4 py-2 text-sm text-center",children:["Default CozyGen credentials are still in use. Change ",o.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /",o.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server."]}),o.jsx(p1,{containerRef:l}),o.jsxs("div",{className:"app-body",children:[o.jsx("main",{ref:l,className:s?"app-content is-login":"app-content",children:o.jsxs(jx,{children:[o.jsx(rn,{path:"/login",element:o.jsx(f1,{})}),o.jsxs(rn,{element:o.jsx(h1,{children:o.jsx(b0,{children:o.jsx(wx,{})})}),children:[o.jsx(rn,{path:"/",element:o.jsx(Qa,{to:"/studio",replace:!0})}),o.jsx(rn,{path:"/studio",element:o.jsx(L0,{})}),o.jsx(rn,{path:"/controls",element:o.jsx(E0,{})}),o.jsx(rn,{path:"/compose",element:o.jsx(d1,{})}),o.jsx(rn,{path:"/gallery",element:o.jsx(Q0,{})}),o.jsx(rn,{path:"/aliases",element:o.jsx(r1,{})}),o.jsx(rn,{path:"/tags",element:o.jsx(a1,{})})]}),o.jsx(rn,{path:"*",element:o.jsx(Qa,{to:"/studio",replace:!0})})]})}),c?o.jsx(aw,{}):null]})]})}function g1(){return o.jsx(Rx,{children:o.jsx(Jx,{children:o.jsx(m1,{})})})}Zi.createRoot(document.getElementById("root")).render(o.jsx(Qt.StrictMode,{children:o.jsx(g1,{})}));
