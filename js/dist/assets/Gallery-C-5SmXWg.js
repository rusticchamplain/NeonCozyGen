import{j as e,r as n,o as ne,g as ie,p as Y,t as K,v as q,w as W,x as Q,y as J,z as X,A as ae,d as re,B as oe}from"./index-BHgq2Ao1.js";import{B as ce}from"./BottomSheet-GpOlSyzm.js";function de({subfolder:t,crumbs:c=[],dirChips:i=[],onBack:d,onRoot:a,onCrumb:r,onSelectDir:m}){return e.jsxs("div",{className:"space-y-3 text-[#F8F4FF]",children:[e.jsx("div",{className:"flex items-center justify-start gap-2 flex-wrap"}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap text-[#C3C7FF]",role:"navigation","aria-label":"Gallery path",children:c.map((f,g)=>e.jsxs(n.Fragment,{children:[e.jsx("span",{className:"text-[#6A6FA8]",children:"/"}),e.jsx("button",{type:"button",className:"gallery-chip-btn",onClick:()=>r==null?void 0:r(f.path),"aria-current":g===c.length-1?"page":void 0,children:f.name})]},f.path||f.name||g))}),i.length>0?e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:i.map(f=>e.jsx("button",{type:"button",className:"gallery-chip-btn",onClick:()=>m==null?void 0:m(f.subfolder),children:f.filename||f.subfolder||"Collection"},f.subfolder||f.filename))}):null]})}const ue=(t="")=>/\.(mp4|webm|mov|mkv)$/i.test(t),fe=({src:t,poster:c,autoPlay:i})=>{const d=n.useRef(null);return n.useEffect(()=>{const a=d.current;a&&(a.pause(),a.currentTime=0,a.load())},[t]),n.useEffect(()=>{const a=d.current;if(!a)return;let r;const m=()=>{const g=a.play();g&&typeof g.catch=="function"&&g.catch(()=>{})},f=()=>{a.pause()};return i?typeof window<"u"&&"IntersectionObserver"in window?(r=new IntersectionObserver(p=>{p.forEach(o=>{o.isIntersecting?m():f()})},{threshold:.65}),r.observe(a)):m():(f(),a.currentTime=0),()=>{r&&r.disconnect(),f()}},[i,t]),t?e.jsx("video",{ref:d,src:t,poster:c||void 0,muted:!0,playsInline:!0,loop:!0,preload:"metadata",className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40"}):e.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})},Z={contentVisibility:"auto",containIntrinsicSize:"260px 320px"};function he({item:t,onSelect:c,variant:i="grid",autoPlay:d=!1}){if(!t)return null;const a=t.type==="directory",r=t.filename||"",m=t.subfolder||"",f=r||m||"Unknown",g=()=>{c&&c(t)},p=i==="feed"?768:384,o=!a&&r?`/cozygen/thumb?type=output&subfolder=${encodeURIComponent(m)}&filename=${encodeURIComponent(r)}&w=${p}`:null,k=!a&&r?(()=>{const h=t.type&&t.type!=="directory"?t.type:"output",x=t.mtime?`&v=${encodeURIComponent(String(t.mtime))}`:"";return`/view?filename=${encodeURIComponent(r)}&subfolder=${encodeURIComponent(m)}&type=${encodeURIComponent(h)}${x}`})():null,y=ue(r);if(a)return e.jsx("button",{type:"button",onClick:g,className:"gallery-dir-tile",style:Z,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-7 w-7 rounded-lg bg-gradient-to-br from-[#6B5BFF] to-[#FF4F9A] opacity-80 group-hover:opacity-100 flex items-center justify-center text-[11px] text-white",children:"▤"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[11px] font-medium text-[#E5E7FF] truncate",children:f}),e.jsx("div",{className:"text-[10px] text-[#9DA3FFCC] truncate",children:"Collection"})]})]})});if(i==="feed"){const h={contentVisibility:"auto",containIntrinsicSize:"520px 720px"};return e.jsxs("div",{className:"gallery-feed-item",style:h,children:[e.jsxs("button",{type:"button",onClick:g,className:"gallery-feed-media",children:[e.jsx("div",{className:"relative w-full flex items-center justify-center bg-[#020312]",children:y?e.jsx(fe,{src:k,poster:o,autoPlay:d}):o?e.jsx("img",{src:o,alt:f,className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})}),e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#05071680] opacity-0 group-hover:opacity-100 transition-opacity"}),y&&e.jsx("div",{className:"pointer-events-none absolute left-2 top-2 rounded-full bg-[#050716CC] px-2 py-[1px] text-[10px] text-[#CFFAFE] border border-[#3EF0FF80]",children:"Video"})]}),e.jsx("div",{className:"gallery-feed-meta",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"gallery-feed-title",children:f}),m&&e.jsx("div",{className:"gallery-feed-subfolder",children:m})]})})]})}return e.jsxs("button",{type:"button",onClick:g,className:"gallery-tile",style:Z,children:[e.jsxs("div",{className:"gallery-tile-media",children:[o?e.jsx("img",{src:o,alt:f,className:"gallery-tile-img",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"gallery-tile-empty",children:"No preview"}),y&&e.jsx("div",{className:"gallery-badge",children:"Video"})]}),e.jsx("div",{className:"gallery-tile-caption",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"gallery-tile-title",children:f}),y&&e.jsx("span",{className:"gallery-tile-flag",children:"Vid"})]})})]})}const ee=n.memo(he),pe=(t="")=>/\.(mp4|webm|mov|mkv)$/i.test(t),me=t=>{if(!t)return"";const c=t.filename||"",i=t.subfolder||"",d=t.type||"output",a=t.mtime?`&v=${encodeURIComponent(String(t.mtime))}`:"";return`/view?filename=${encodeURIComponent(c)}&subfolder=${encodeURIComponent(i)}&type=${encodeURIComponent(d)}${a}`};function ge({isOpen:t,media:c,onClose:i,onPrev:d,onNext:a}){const r=n.useRef(!1);if(n.useEffect(()=>{if(!t)return;const p=o=>{o.key==="Escape"&&(i==null||i()),o.key==="ArrowLeft"&&(d==null||d()),o.key==="ArrowRight"&&(a==null||a())};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[t,i,a,d]),!c||!t||typeof document>"u")return null;const m=me(c),f=c.subfolder||"Gallery",g=pe(c.filename);return ne.createPortal(e.jsx("div",{className:"react-modal-overlay",role:"presentation",onPointerDown:p=>{r.current=p.target===p.currentTarget},onClick:p=>{r.current&&p.target===p.currentTarget&&(i==null||i())},children:e.jsx("div",{className:"react-modal-content",role:"dialog","aria-modal":"true","aria-label":"Preview",onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:"media-viewer-panel",children:[e.jsxs("header",{className:"media-viewer-head",children:[e.jsxs("div",{className:"media-viewer-meta",children:[e.jsx("div",{className:"media-viewer-title",title:c.filename,children:c.filename}),e.jsxs("div",{className:"media-viewer-sub",children:[e.jsx("span",{className:"media-chip",children:f}),e.jsx("span",{className:`media-chip ${g?"is-clip":"is-still"}`,children:g?"Video":"Image"})]})]}),e.jsxs("div",{className:"media-viewer-actions",children:[e.jsx("button",{type:"button",className:"media-btn ghost",onClick:d,"aria-label":"Previous item",children:"←"}),e.jsx("button",{type:"button",className:"media-btn ghost",onClick:a,"aria-label":"Next item",children:"→"}),e.jsx("a",{href:m,target:"_blank",rel:"noreferrer",className:"media-btn",children:"Open"}),e.jsx("button",{type:"button",className:"media-btn solid",onClick:i,children:"Close"})]})]}),e.jsxs("div",{className:"media-viewer-stage",children:[e.jsx("button",{type:"button",className:"media-stage-nav is-left",onClick:d,"aria-label":"Previous",children:"←"}),e.jsx("div",{className:"media-viewer-frame",children:g?e.jsx("video",{src:m,controls:!0,className:"media-viewer-media",autoPlay:!0}):e.jsx("img",{src:m,alt:c.filename,className:"media-viewer-media"})}),e.jsx("button",{type:"button",className:"media-stage-nav is-right",onClick:a,"aria-label":"Next",children:"→"})]})]})})}),document.body)}const ye=(t="")=>t.startsWith("."),xe=(t="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(t),ve=(t="")=>/\.(mp4|webm|mov|mkv)$/i.test(t);function we(){const t=(l,u="")=>{try{return typeof window<"u"&&localStorage.getItem(l)||u}catch{return u}},c=(l,u)=>{try{typeof window<"u"&&localStorage.setItem(l,u)}catch{}},[i,d]=n.useState(t("galleryPath","")),[a,r]=n.useState([]),[m,f]=n.useState(!1),[g,p]=n.useState(1),[o,k]=n.useState(1),[y,h]=n.useState(()=>{const l=t("galleryPageSize","30"),u=parseInt(l,10);return Number.isFinite(u)?u:30}),[x,E]=n.useState("all"),[v,z]=n.useState(!1),[N,R]=n.useState(""),[C,P]=n.useState(()=>t("galleryRecursive","0")==="1"),[I,A]=n.useState(0);n.useEffect(()=>{let l=!1;const u=new AbortController;return(async()=>{f(!0);try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:gallery:fetch")}catch{}try{const j=await ie(i,g,y,v,C,x,I,{signal:u.signal});if(l)return;j&&j.items?(r(j.items),k(j.total_pages||1)):(r([]),k(1));try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:gallery:ready"),performance.measure("cozygen:gallery:first-paint","cozygen:gallery:fetch","cozygen:gallery:ready"))}catch{}}catch(j){if((j==null?void 0:j.name)==="AbortError")return;console.error("Failed to load gallery",j),l||(r([]),k(1))}finally{!l&&!u.signal.aborted&&f(!1)}})(),c("galleryPath",i),c("galleryPageSize",String(y)),()=>{l=!0,u.abort()}},[i,g,y,I,v,C,x]);const M=n.useMemo(()=>{if(!i)return[];const l=i.replace(/\\/g,"/").split("/").filter(Boolean),u=[];for(let w=0;w<l.length;w++)u.push({name:l[w],path:l.slice(0,w+1).join("/")});return u},[i]),F=n.useMemo(()=>a.filter(l=>l.type==="directory").map(l=>({filename:l.filename,subfolder:l.subfolder})),[a]),O=n.useMemo(()=>{const l=(N||"").trim().toLowerCase();return a.filter(u=>{const w=(u.filename||"").toLowerCase();return!(!v&&ye(w)||u.type!=="directory"&&(x==="image"&&!xe(w)||x==="video"&&!ve(w))||l&&!w.includes(l))})},[a,v,x,N]),U=n.useMemo(()=>O.filter(l=>l.type!=="directory"),[O]),b=n.useCallback(()=>{if(!i)return;const l=i.replace(/\\/g,"/").lastIndexOf("/"),u=l===-1?"":i.slice(0,l);d(u),p(1)},[i]),V=n.useCallback(()=>{d(""),p(1)},[]),S=n.useCallback(l=>{d(l||""),p(1)},[]),_=n.useCallback(l=>{d(l),p(1)},[]),B=n.useCallback(l=>{const u=parseInt(String(l),10)||30;h(u),p(1)},[]),G=n.useCallback(l=>{E(l),p(1)},[]),H=n.useCallback(l=>{const u=!!l;P(u),p(1),c("galleryRecursive",u?"1":"0")},[]),T=n.useCallback(l=>{R(l),p(1)},[]),$=n.useCallback(()=>{A(l=>l+1)},[]);return n.useEffect(()=>{const l=()=>$();return typeof window<"u"&&window.addEventListener&&window.addEventListener("cozygen:queue-finished",l),()=>{typeof window<"u"&&window.removeEventListener&&window.removeEventListener("cozygen:queue-finished",l)}},[$]),n.useEffect(()=>{if(typeof window>"u")return;let l=!1,u,w;const j=()=>{w&&(clearTimeout(w),w=null)},L=(s=8e3)=>{j(),w=window.setTimeout(()=>{l||($(),L(8e3))},s)};return(()=>{if(!("EventSource"in window)){L();return}const s=new URLSearchParams({subfolder:i||"",recursive:C?"1":"0",show_hidden:v?"1":"0"});u=new EventSource(`/cozygen/api/gallery/stream?${s.toString()}`),u.onmessage=()=>{l||$()},u.onerror=()=>{u&&(u.close(),u=null),L()}})(),()=>{l=!0,j(),u&&(u.close(),u=null)}},[i,C,v,$]),{path:i,items:a,loading:m,page:g,totalPages:o,perPage:y,kind:x,showHidden:v,query:N,recursive:C,crumbs:M,dirChips:F,filtered:O,mediaItems:U,setPage:p,setPerPage:B,setShowHidden:z,setQuery:T,setKind:G,setRecursive:H,goBack:b,goRoot:V,goToPath:S,selectDir:_,refresh:$}}function be(t){const[c,i]=n.useState(!1),[d,a]=n.useState(null);n.useEffect(()=>{if(!t||t.length===0){a(null),i(!1);return}a(o=>o==null?o:o>=t.length?t.length-1:o)},[t]);const r=n.useCallback(o=>{if(!t||!t.length||!o)return;const k=t.indexOf(o);k!==-1&&(a(k),i(!0))},[t]),m=n.useCallback(()=>{i(!1),a(null)},[]),f=n.useCallback(()=>{!t||!t.length||a(o=>o==null?o:(o+1)%t.length)},[t]),g=n.useCallback(()=>{!t||!t.length||a(o=>o==null?o:(o-1+t.length)%t.length)},[t]),p=d!=null&&d>=0&&t&&d<t.length?t[d]:null;return{viewerOpen:c,viewerIndex:d,currentMedia:p,open:r,close:m,next:f,prev:g,setViewerOpen:i}}const te="cozygen_gallery_view_mode",se="cozygen_gallery_feed_autoplay";function je(t,c){const i=n.useRef(null),[d,a]=n.useState(0),[r,m]=n.useState({width:0,cols:0,top:0,viewport:typeof window<"u"&&window.innerHeight||800}),f=y=>{if(!y||typeof window>"u")return null;let h=y.parentElement;for(;h;){const x=window.getComputedStyle(h);if(x.overflowY==="auto"||x.overflowY==="scroll")return h;h=h.parentElement}return window};n.useEffect(()=>{if(!c)return;const y=i.current;if(!y||typeof window>"u"||typeof ResizeObserver>"u")return;const h=f(y)||window,x=()=>{const N=y.getBoundingClientRect(),R=N.width||y.clientWidth||1,C=Math.max(1,Math.floor(R/160)),P=h===window?window.scrollY||0:h.scrollTop||0,I=h===window?{top:0}:h.getBoundingClientRect(),A=h===window?N.top+(window.scrollY||0):N.top-I.top+P,M=h===window?window.innerHeight||800:h.clientHeight||800;m(F=>F.width===R&&F.cols===C&&F.top===A&&F.viewport===M?F:{width:R,cols:C,top:A,viewport:M}),a(P)};x();const E=new ResizeObserver(()=>x());E.observe(y),window.addEventListener("resize",x);let v=!1;const z=()=>{v||(v=!0,window.requestAnimationFrame(()=>{v=!1;const N=h===window?window.scrollY||0:h.scrollTop||0;a(N)}))};return h.addEventListener("scroll",z,{passive:!0}),()=>{E.disconnect(),window.removeEventListener("resize",x),h.removeEventListener("scroll",z)}},[c]);const g=c&&r.cols>0&&t.length>60,{visibleItems:p,topSpacer:o,bottomSpacer:k}=n.useMemo(()=>{if(!g)return{visibleItems:t,topSpacer:0,bottomSpacer:0};const y=r.width/r.cols,h=Math.max(180,Math.ceil(y*1.25)+32),x=Math.ceil(t.length/r.cols),E=Math.max(0,d-r.top),v=Math.max(0,Math.floor(E/h)-2),z=Math.min(x,Math.ceil((E+r.viewport)/h)+2),N=v*r.cols,R=Math.min(t.length,z*r.cols);return{visibleItems:t.slice(N,R),topSpacer:v*h,bottomSpacer:Math.max(0,(x-z)*h)}},[t,r,d,g]);return{containerRef:i,visibleItems:p,topSpacer:o,bottomSpacer:k,virtualized:g}}function Ce(){const{path:t,loading:c,page:i,totalPages:d,perPage:a,kind:r,showHidden:m,recursive:f,crumbs:g,dirChips:p,filtered:o,mediaItems:k,setPage:y,setPerPage:h,setShowHidden:x,setKind:E,setRecursive:v,goBack:z,goRoot:N,goToPath:R,selectDir:C,refresh:P}=we(),{viewerOpen:I,currentMedia:A,open:M,close:F,next:O,prev:U}=be(k),[b,V]=n.useState(()=>{if(typeof window>"u")return"grid";const s=window.localStorage.getItem(te);return s==="feed"||s==="grid"?s:"grid"}),[S,_]=n.useState(()=>typeof window>"u"?!1:window.localStorage.getItem(se)==="true");n.useEffect(()=>{try{window.localStorage.setItem(te,b)}catch{}},[b]),n.useEffect(()=>{try{window.localStorage.setItem(se,S?"true":"false")}catch{}},[S]);const B=n.useCallback(s=>{if(s.type==="directory"){C(s.subfolder);return}M(s)},[M,C]),G=b==="grid",[H,T]=n.useState(!1),$=s=>s.type==="directory"?`dir:${s.subfolder||s.filename}`:`${s.subfolder||""}|${s.filename}`;n.useEffect(()=>{try{window.localStorage.setItem("cozygen_gallery_pending","0")}catch{}window.dispatchEvent(new Event("cozygen:gallery-viewed"))},[]);const l=c?"Loading…":`${o.length} items`,{containerRef:u,visibleItems:w,topSpacer:j,bottomSpacer:L,virtualized:D}=je(o,G);return e.jsxs("div",{className:"page-shell gallery-shell",children:[e.jsx("div",{className:"screen-sticky gallery-header",children:e.jsxs("div",{className:"gallery-header-inner space-y-3",children:[e.jsx(de,{subfolder:t,crumbs:g,dirChips:p,onBack:z,onRoot:N,onCrumb:s=>R(s),onSelectDir:s=>C(s)}),e.jsxs("div",{className:"md:hidden flex items-center justify-between gap-2",children:[e.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>T(!0),children:"Filters"}),e.jsxs("div",{className:"gallery-view-toggle",role:"group","aria-label":"View mode",children:[e.jsx("button",{type:"button",className:b==="grid"?"is-active":"",onClick:()=>V("grid"),"aria-pressed":b==="grid",title:"Grid view",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[e.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),e.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),e.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),e.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})}),e.jsx("button",{type:"button",className:b==="feed"?"is-active":"",onClick:()=>V("feed"),"aria-pressed":b==="feed",title:"Feed view",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[e.jsx("rect",{x:"2",y:"1",width:"12",height:"5",rx:"1"}),e.jsx("rect",{x:"2",y:"8",width:"12",height:"5",rx:"1"})]})})]})]}),e.jsx("div",{className:"md:hidden gallery-mobile-meta",children:c?"Loading…":`${l} • Page ${i} of ${d}`}),e.jsxs("div",{className:"gallery-toolbar",children:[e.jsx("div",{className:"gallery-toolbar-left",children:e.jsx("div",{className:"gallery-pills",role:"group","aria-label":"Filter by type",children:[{key:"all",label:"All"},{key:"image",label:"Images"},{key:"video",label:"Videos"}].map(s=>e.jsx("button",{type:"button",className:`gallery-pill ${r===s.key?"is-active":""}`,onClick:()=>E(s.key),"aria-pressed":r===s.key,children:s.label},s.key))})}),e.jsxs("div",{className:"gallery-toolbar-right",children:[e.jsxs("div",{className:"gallery-view-toggle",role:"group","aria-label":"View mode",children:[e.jsx("button",{type:"button",className:b==="grid"?"is-active":"",onClick:()=>V("grid"),"aria-pressed":b==="grid",title:"Grid view",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[e.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),e.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),e.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),e.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})}),e.jsx("button",{type:"button",className:b==="feed"?"is-active":"",onClick:()=>V("feed"),"aria-pressed":b==="feed",title:"Feed view",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[e.jsx("rect",{x:"2",y:"1",width:"12",height:"5",rx:"1"}),e.jsx("rect",{x:"2",y:"8",width:"12",height:"5",rx:"1"})]})})]}),e.jsxs("div",{className:"gallery-options",children:[e.jsx("button",{type:"button",className:`gallery-option-btn ${f?"is-active":""}`,onClick:()=>v(s=>!s),title:f?"Showing subfolders":"This folder only",children:f?e.jsx(Y,{size:16}):e.jsx(K,{size:16})}),e.jsx("button",{type:"button",className:`gallery-option-btn ${m?"is-active":""}`,onClick:()=>x(s=>!s),title:m?"Showing hidden":"Hiding hidden",children:m?e.jsx(q,{size:16}):e.jsx(W,{size:16})}),b==="feed"&&e.jsx("button",{type:"button",className:`gallery-option-btn ${S?"is-active":""}`,onClick:()=>_(s=>!s),title:S?"Autoplay on":"Autoplay off",children:S?e.jsx(Q,{size:16}):e.jsx(J,{size:16})}),e.jsx("button",{type:"button",className:"gallery-option-btn",onClick:P,title:"Refresh",children:e.jsx(X,{size:16})})]})]})]}),e.jsxs("div",{className:"gallery-pagination",children:[e.jsx("div",{className:"gallery-pagination-info",children:c?e.jsx("span",{className:"gallery-loading-text",children:"Loading…"}):e.jsx("span",{children:l})}),e.jsxs("div",{className:"gallery-pagination-controls",children:[e.jsx("button",{type:"button",className:"gallery-page-btn",onClick:()=>y(s=>Math.max(1,s-1)),disabled:i<=1||c,"aria-label":"Previous page",children:e.jsx(ae,{size:16})}),e.jsxs("span",{className:"gallery-page-indicator",children:[i," / ",d]}),e.jsx("button",{type:"button",className:"gallery-page-btn",onClick:()=>y(s=>s<d?s+1:s),disabled:i>=d||c,"aria-label":"Next page",children:e.jsx(re,{size:16})}),e.jsxs("select",{value:a,onChange:s=>h(parseInt(s.target.value,10)||30),className:"gallery-page-size","aria-label":"Items per page",children:[e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:60,children:"60"}),e.jsx("option",{value:120,children:"120"})]})]})]})]})}),c&&o.length===0?e.jsx("div",{className:"gallery-grid-responsive",children:Array.from({length:8}).map((s,le)=>e.jsxs("div",{className:"gallery-skeleton-item",children:[e.jsx("div",{className:"gallery-skeleton-thumb skeleton"}),e.jsx("div",{className:"gallery-skeleton-label skeleton skeleton-text"})]},le))}):o.length===0&&!c?e.jsxs("div",{className:"gallery-empty",children:[e.jsx("div",{className:"gallery-empty-icon",children:e.jsx(oe,{size:48})}),e.jsx("div",{className:"gallery-empty-title",children:"No media found"}),e.jsx("div",{className:"gallery-empty-desc",children:r!=="all"?`No ${r}s match your filters. Try selecting "All" or adjusting your search.`:"This folder is empty. Render something new or navigate to a different folder."})]}):G?e.jsx("div",{className:"w-full overflow-hidden",children:e.jsxs("div",{className:"gallery-grid-responsive",ref:u,children:[D&&j>0?e.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${j}px`}}):null,w.map(s=>e.jsx(ee,{item:s,onSelect:B,variant:"grid",autoPlay:!1},$(s))),D&&L>0?e.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${L}px`}}):null]})}):e.jsx("div",{className:"flex flex-col gap-6 items-center",children:o.filter(s=>s.type!=="directory").map(s=>e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(ee,{item:s,onSelect:B,variant:"feed",autoPlay:S})},$(s)))}),e.jsx(ge,{isOpen:I,media:A,onClose:F,onPrev:U,onNext:O}),e.jsx(ce,{open:H,onClose:()=>T(!1),title:"Gallery filters",footer:e.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>T(!1),children:"Done"}),children:e.jsxs("div",{className:"sheet-stack",children:[e.jsxs("div",{className:"sheet-section",children:[e.jsx("div",{className:"sheet-label",children:"Type"}),e.jsx("div",{className:"gallery-pills",role:"group","aria-label":"Filter by type",children:[{key:"all",label:"All"},{key:"image",label:"Images"},{key:"video",label:"Videos"}].map(s=>e.jsx("button",{type:"button",className:`gallery-pill ${r===s.key?"is-active":""}`,onClick:()=>E(s.key),"aria-pressed":r===s.key,children:s.label},s.key))})]}),e.jsxs("div",{className:"sheet-section",children:[e.jsx("div",{className:"sheet-label",children:"Options"}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:`ui-button is-compact ${f?"is-primary":"is-muted"}`,onClick:()=>v(s=>!s),children:e.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[f?e.jsx(Y,{size:14}):e.jsx(K,{size:14}),e.jsx("span",{children:f?"Subfolders":"This folder"})]})}),e.jsx("button",{type:"button",className:`ui-button is-compact ${m?"is-primary":"is-muted"}`,onClick:()=>x(s=>!s),children:e.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[m?e.jsx(q,{size:14}):e.jsx(W,{size:14}),e.jsx("span",{children:m?"Hidden on":"Hidden off"})]})}),b==="feed"?e.jsx("button",{type:"button",className:`ui-button is-compact ${S?"is-primary":"is-muted"}`,onClick:()=>_(s=>!s),children:e.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[S?e.jsx(Q,{size:14}):e.jsx(J,{size:14}),e.jsx("span",{children:S?"Autoplay":"No autoplay"})]})}):null,e.jsx("button",{type:"button",className:"ui-button is-compact is-ghost",onClick:P,children:e.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[e.jsx(X,{size:14}),e.jsx("span",{children:"Refresh"})]})})]})]}),e.jsxs("div",{className:"sheet-section",children:[e.jsx("div",{className:"sheet-label",children:"Page size"}),e.jsxs("select",{value:a,onChange:s=>h(parseInt(s.target.value,10)||30),className:"sheet-select ui-control ui-select","aria-label":"Items per page",children:[e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:60,children:"60"}),e.jsx("option",{value:120,children:"120"})]}),e.jsx("div",{className:"sheet-hint",children:c?"Loading…":`${l} • Page ${i} of ${d}`}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>y(s=>Math.max(1,s-1)),disabled:i<=1||c,children:"Prev"}),e.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>y(s=>s<d?s+1:s),disabled:i>=d||c,children:"Next"})]})]})]})})]})}export{Ce as default};
