function rg(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function sg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Rf={exports:{}},Wo={},If={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fl=Symbol.for("react.element"),lg=Symbol.for("react.portal"),og=Symbol.for("react.fragment"),ig=Symbol.for("react.strict_mode"),ag=Symbol.for("react.profiler"),cg=Symbol.for("react.provider"),ug=Symbol.for("react.context"),dg=Symbol.for("react.forward_ref"),fg=Symbol.for("react.suspense"),pg=Symbol.for("react.memo"),hg=Symbol.for("react.lazy"),Pu=Symbol.iterator;function mg(e){return e===null||typeof e!="object"?null:(e=Pu&&e[Pu]||e["@@iterator"],typeof e=="function"?e:null)}var zf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Af=Object.assign,Tf={};function ps(e,t,n){this.props=e,this.context=t,this.refs=Tf,this.updater=n||zf}ps.prototype.isReactComponent={};ps.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ps.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Mf(){}Mf.prototype=ps.prototype;function ic(e,t,n){this.props=e,this.context=t,this.refs=Tf,this.updater=n||zf}var ac=ic.prototype=new Mf;ac.constructor=ic;Af(ac,ps.prototype);ac.isPureReactComponent=!0;var _u=Array.isArray,$f=Object.prototype.hasOwnProperty,cc={current:null},Ff={key:!0,ref:!0,__self:!0,__source:!0};function Of(e,t,n){var r,s={},o=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)$f.call(t,r)&&!Ff.hasOwnProperty(r)&&(s[r]=t[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var u=Array(a),d=0;d<a;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:fl,type:e,key:o,ref:i,props:s,_owner:cc.current}}function gg(e,t){return{$$typeof:fl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function uc(e){return typeof e=="object"&&e!==null&&e.$$typeof===fl}function yg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Ru=/\/+/g;function yi(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yg(""+e.key):t.toString(36)}function Yl(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case fl:case lg:i=!0}}if(i)return i=e,s=s(i),e=r===""?"."+yi(i,0):r,_u(s)?(n="",e!=null&&(n=e.replace(Ru,"$&/")+"/"),Yl(s,t,n,"",function(d){return d})):s!=null&&(uc(s)&&(s=gg(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Ru,"$&/")+"/")+e)),t.push(s)),1;if(i=0,r=r===""?".":r+":",_u(e))for(var a=0;a<e.length;a++){o=e[a];var u=r+yi(o,a);i+=Yl(o,t,n,u,s)}else if(u=mg(e),typeof u=="function")for(e=u.call(e),a=0;!(o=e.next()).done;)o=o.value,u=r+yi(o,a++),i+=Yl(o,t,n,u,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function El(e,t,n){if(e==null)return e;var r=[],s=0;return Yl(e,r,"","",function(o){return t.call(n,o,s++)}),r}function vg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pt={current:null},ql={transition:null},xg={ReactCurrentDispatcher:Pt,ReactCurrentBatchConfig:ql,ReactCurrentOwner:cc};function Df(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:El,forEach:function(e,t,n){El(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return El(e,function(){t++}),t},toArray:function(e){return El(e,function(t){return t})||[]},only:function(e){if(!uc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};$e.Component=ps;$e.Fragment=og;$e.Profiler=ag;$e.PureComponent=ic;$e.StrictMode=ig;$e.Suspense=fg;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xg;$e.act=Df;$e.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Af({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=cc.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(u in t)$f.call(t,u)&&!Ff.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&a!==void 0?a[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var d=0;d<u;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:fl,type:e.type,key:s,ref:o,props:r,_owner:i}};$e.createContext=function(e){return e={$$typeof:ug,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:cg,_context:e},e.Consumer=e};$e.createElement=Of;$e.createFactory=function(e){var t=Of.bind(null,e);return t.type=e,t};$e.createRef=function(){return{current:null}};$e.forwardRef=function(e){return{$$typeof:dg,render:e}};$e.isValidElement=uc;$e.lazy=function(e){return{$$typeof:hg,_payload:{_status:-1,_result:e},_init:vg}};$e.memo=function(e,t){return{$$typeof:pg,type:e,compare:t===void 0?null:t}};$e.startTransition=function(e){var t=ql.transition;ql.transition={};try{e()}finally{ql.transition=t}};$e.unstable_act=Df;$e.useCallback=function(e,t){return Pt.current.useCallback(e,t)};$e.useContext=function(e){return Pt.current.useContext(e)};$e.useDebugValue=function(){};$e.useDeferredValue=function(e){return Pt.current.useDeferredValue(e)};$e.useEffect=function(e,t){return Pt.current.useEffect(e,t)};$e.useId=function(){return Pt.current.useId()};$e.useImperativeHandle=function(e,t,n){return Pt.current.useImperativeHandle(e,t,n)};$e.useInsertionEffect=function(e,t){return Pt.current.useInsertionEffect(e,t)};$e.useLayoutEffect=function(e,t){return Pt.current.useLayoutEffect(e,t)};$e.useMemo=function(e,t){return Pt.current.useMemo(e,t)};$e.useReducer=function(e,t,n){return Pt.current.useReducer(e,t,n)};$e.useRef=function(e){return Pt.current.useRef(e)};$e.useState=function(e){return Pt.current.useState(e)};$e.useSyncExternalStore=function(e,t,n){return Pt.current.useSyncExternalStore(e,t,n)};$e.useTransition=function(){return Pt.current.useTransition()};$e.version="18.3.1";If.exports=$e;var c=If.exports;const Qt=sg(c),wg=rg({__proto__:null,default:Qt},[c]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sg=c,jg=Symbol.for("react.element"),Ng=Symbol.for("react.fragment"),kg=Object.prototype.hasOwnProperty,bg=Sg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Cg={key:!0,ref:!0,__self:!0,__source:!0};function Uf(e,t,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)kg.call(t,r)&&!Cg.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:jg,type:e,key:o,ref:i,props:s,_owner:bg.current}}Wo.Fragment=Ng;Wo.jsx=Uf;Wo.jsxs=Uf;Rf.exports=Wo;var l=Rf.exports,Xi={},Bf={exports:{}},Bt={},Vf={exports:{}},Wf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,N){var E=R.length;R.push(N);e:for(;0<E;){var k=E-1>>>1,V=R[k];if(0<s(V,N))R[k]=N,R[E]=V,E=k;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var N=R[0],E=R.pop();if(E!==N){R[0]=E;e:for(var k=0,V=R.length,G=V>>>1;k<G;){var te=2*(k+1)-1,re=R[te],X=te+1,ie=R[X];if(0>s(re,E))X<V&&0>s(ie,re)?(R[k]=ie,R[X]=E,k=X):(R[k]=re,R[te]=E,k=te);else if(X<V&&0>s(ie,E))R[k]=ie,R[X]=E,k=X;else break e}}return N}function s(R,N){var E=R.sortIndex-N.sortIndex;return E!==0?E:R.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var u=[],d=[],g=1,y=null,m=3,x=!1,w=!1,j=!1,S=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(R){for(var N=n(d);N!==null;){if(N.callback===null)r(d);else if(N.startTime<=R)r(d),N.sortIndex=N.expirationTime,t(u,N);else break;N=n(d)}}function v(R){if(j=!1,p(R),!w)if(n(u)!==null)w=!0,ne(b);else{var N=n(d);N!==null&&me(v,N.startTime-R)}}function b(R,N){w=!1,j&&(j=!1,h(I),I=-1),x=!0;var E=m;try{for(p(N),y=n(u);y!==null&&(!(y.expirationTime>N)||R&&!D());){var k=y.callback;if(typeof k=="function"){y.callback=null,m=y.priorityLevel;var V=k(y.expirationTime<=N);N=e.unstable_now(),typeof V=="function"?y.callback=V:y===n(u)&&r(u),p(N)}else r(u);y=n(u)}if(y!==null)var G=!0;else{var te=n(d);te!==null&&me(v,te.startTime-N),G=!1}return G}finally{y=null,m=E,x=!1}}var C=!1,_=null,I=-1,z=5,A=-1;function D(){return!(e.unstable_now()-A<z)}function oe(){if(_!==null){var R=e.unstable_now();A=R;var N=!0;try{N=_(!0,R)}finally{N?q():(C=!1,_=null)}}else C=!1}var q;if(typeof f=="function")q=function(){f(oe)};else if(typeof MessageChannel<"u"){var je=new MessageChannel,ye=je.port2;je.port1.onmessage=oe,q=function(){ye.postMessage(null)}}else q=function(){S(oe,0)};function ne(R){_=R,C||(C=!0,q())}function me(R,N){I=S(function(){R(e.unstable_now())},N)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){w||x||(w=!0,ne(b))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(R){switch(m){case 1:case 2:case 3:var N=3;break;default:N=m}var E=m;m=N;try{return R()}finally{m=E}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,N){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var E=m;m=R;try{return N()}finally{m=E}},e.unstable_scheduleCallback=function(R,N,E){var k=e.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?k+E:k):E=k,R){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=E+V,R={id:g++,callback:N,priorityLevel:R,startTime:E,expirationTime:V,sortIndex:-1},E>k?(R.sortIndex=E,t(d,R),n(u)===null&&R===n(d)&&(j?(h(I),I=-1):j=!0,me(v,E-k))):(R.sortIndex=V,t(u,R),w||x||(w=!0,ne(b))),R},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(R){var N=m;return function(){var E=m;m=N;try{return R.apply(this,arguments)}finally{m=E}}}})(Wf);Vf.exports=Wf;var Eg=Vf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lg=c,Ut=Eg;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hf=new Set,Hs={};function Rr(e,t){ss(e,t),ss(e+"Capture",t)}function ss(e,t){for(Hs[e]=t,e=0;e<t.length;e++)Hf.add(t[e])}var Tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ji=Object.prototype.hasOwnProperty,Pg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Iu={},zu={};function _g(e){return Ji.call(zu,e)?!0:Ji.call(Iu,e)?!1:Pg.test(e)?zu[e]=!0:(Iu[e]=!0,!1)}function Rg(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Ig(e,t,n,r){if(t===null||typeof t>"u"||Rg(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _t(e,t,n,r,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){wt[e]=new _t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];wt[t]=new _t(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){wt[e]=new _t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){wt[e]=new _t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){wt[e]=new _t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){wt[e]=new _t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){wt[e]=new _t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){wt[e]=new _t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){wt[e]=new _t(e,5,!1,e.toLowerCase(),null,!1,!1)});var dc=/[\-:]([a-z])/g;function fc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(dc,fc);wt[t]=new _t(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(dc,fc);wt[t]=new _t(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(dc,fc);wt[t]=new _t(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){wt[e]=new _t(e,1,!1,e.toLowerCase(),null,!1,!1)});wt.xlinkHref=new _t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){wt[e]=new _t(e,1,!1,e.toLowerCase(),null,!0,!0)});function pc(e,t,n,r){var s=wt.hasOwnProperty(t)?wt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Ig(t,n,s,r)&&(n=null),r||s===null?_g(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var On=Lg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ll=Symbol.for("react.element"),Or=Symbol.for("react.portal"),Dr=Symbol.for("react.fragment"),hc=Symbol.for("react.strict_mode"),Zi=Symbol.for("react.profiler"),Gf=Symbol.for("react.provider"),Kf=Symbol.for("react.context"),mc=Symbol.for("react.forward_ref"),ea=Symbol.for("react.suspense"),ta=Symbol.for("react.suspense_list"),gc=Symbol.for("react.memo"),Hn=Symbol.for("react.lazy"),Qf=Symbol.for("react.offscreen"),Au=Symbol.iterator;function xs(e){return e===null||typeof e!="object"?null:(e=Au&&e[Au]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Object.assign,vi;function Ls(e){if(vi===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);vi=t&&t[1]||""}return`
`+vi+e}var xi=!1;function wi(e,t){if(!e||xi)return"";xi=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var u=`
`+s[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=i&&0<=a);break}}}finally{xi=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ls(e):""}function zg(e){switch(e.tag){case 5:return Ls(e.type);case 16:return Ls("Lazy");case 13:return Ls("Suspense");case 19:return Ls("SuspenseList");case 0:case 2:case 15:return e=wi(e.type,!1),e;case 11:return e=wi(e.type.render,!1),e;case 1:return e=wi(e.type,!0),e;default:return""}}function na(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Dr:return"Fragment";case Or:return"Portal";case Zi:return"Profiler";case hc:return"StrictMode";case ea:return"Suspense";case ta:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Kf:return(e.displayName||"Context")+".Consumer";case Gf:return(e._context.displayName||"Context")+".Provider";case mc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case gc:return t=e.displayName||null,t!==null?t:na(e.type)||"Memo";case Hn:t=e._payload,e=e._init;try{return na(e(t))}catch{}}return null}function Ag(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return na(t);case 8:return t===hc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ir(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Yf(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Tg(e){var t=Yf(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pl(e){e._valueTracker||(e._valueTracker=Tg(e))}function qf(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Yf(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ao(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ra(e,t){var n=t.checked;return ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Tu(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ir(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Xf(e,t){t=t.checked,t!=null&&pc(e,"checked",t,!1)}function sa(e,t){Xf(e,t);var n=ir(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?la(e,t.type,n):t.hasOwnProperty("defaultValue")&&la(e,t.type,ir(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Mu(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function la(e,t,n){(t!=="number"||ao(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ps=Array.isArray;function Xr(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ir(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function oa(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $u(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(J(92));if(Ps(n)){if(1<n.length)throw Error(J(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ir(n)}}function Jf(e,t){var n=ir(t.value),r=ir(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Fu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Zf(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ia(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Zf(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _l,ep=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_l=_l||document.createElement("div"),_l.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_l.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Gs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var As={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mg=["Webkit","ms","Moz","O"];Object.keys(As).forEach(function(e){Mg.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),As[t]=As[e]})});function tp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||As.hasOwnProperty(e)&&As[e]?(""+t).trim():t+"px"}function np(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=tp(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var $g=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function aa(e,t){if(t){if($g[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function ca(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ua=null;function yc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var da=null,Jr=null,Zr=null;function Ou(e){if(e=ml(e)){if(typeof da!="function")throw Error(J(280));var t=e.stateNode;t&&(t=Yo(t),da(e.stateNode,e.type,t))}}function rp(e){Jr?Zr?Zr.push(e):Zr=[e]:Jr=e}function sp(){if(Jr){var e=Jr,t=Zr;if(Zr=Jr=null,Ou(e),t)for(e=0;e<t.length;e++)Ou(t[e])}}function lp(e,t){return e(t)}function op(){}var Si=!1;function ip(e,t,n){if(Si)return e(t,n);Si=!0;try{return lp(e,t,n)}finally{Si=!1,(Jr!==null||Zr!==null)&&(op(),sp())}}function Ks(e,t){var n=e.stateNode;if(n===null)return null;var r=Yo(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(J(231,t,typeof n));return n}var fa=!1;if(Tn)try{var ws={};Object.defineProperty(ws,"passive",{get:function(){fa=!0}}),window.addEventListener("test",ws,ws),window.removeEventListener("test",ws,ws)}catch{fa=!1}function Fg(e,t,n,r,s,o,i,a,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(g){this.onError(g)}}var Ts=!1,co=null,uo=!1,pa=null,Og={onError:function(e){Ts=!0,co=e}};function Dg(e,t,n,r,s,o,i,a,u){Ts=!1,co=null,Fg.apply(Og,arguments)}function Ug(e,t,n,r,s,o,i,a,u){if(Dg.apply(this,arguments),Ts){if(Ts){var d=co;Ts=!1,co=null}else throw Error(J(198));uo||(uo=!0,pa=d)}}function Ir(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function ap(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Du(e){if(Ir(e)!==e)throw Error(J(188))}function Bg(e){var t=e.alternate;if(!t){if(t=Ir(e),t===null)throw Error(J(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return Du(s),e;if(o===r)return Du(s),t;o=o.sibling}throw Error(J(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?e:t}function cp(e){return e=Bg(e),e!==null?up(e):null}function up(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=up(e);if(t!==null)return t;e=e.sibling}return null}var dp=Ut.unstable_scheduleCallback,Uu=Ut.unstable_cancelCallback,Vg=Ut.unstable_shouldYield,Wg=Ut.unstable_requestPaint,ct=Ut.unstable_now,Hg=Ut.unstable_getCurrentPriorityLevel,vc=Ut.unstable_ImmediatePriority,fp=Ut.unstable_UserBlockingPriority,fo=Ut.unstable_NormalPriority,Gg=Ut.unstable_LowPriority,pp=Ut.unstable_IdlePriority,Ho=null,xn=null;function Kg(e){if(xn&&typeof xn.onCommitFiberRoot=="function")try{xn.onCommitFiberRoot(Ho,e,void 0,(e.current.flags&128)===128)}catch{}}var on=Math.clz32?Math.clz32:qg,Qg=Math.log,Yg=Math.LN2;function qg(e){return e>>>=0,e===0?32:31-(Qg(e)/Yg|0)|0}var Rl=64,Il=4194304;function _s(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function po(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=_s(a):(o&=i,o!==0&&(r=_s(o)))}else i=n&~s,i!==0?r=_s(i):o!==0&&(r=_s(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-on(t),s=1<<n,r|=e[n],t&=~s;return r}function Xg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-on(o),a=1<<i,u=s[i];u===-1?(!(a&n)||a&r)&&(s[i]=Xg(a,t)):u<=t&&(e.expiredLanes|=a),o&=~a}}function ha(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function hp(){var e=Rl;return Rl<<=1,!(Rl&4194240)&&(Rl=64),e}function ji(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function pl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-on(t),e[t]=n}function Zg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-on(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function xc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-on(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Qe=0;function mp(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var gp,wc,yp,vp,xp,ma=!1,zl=[],Jn=null,Zn=null,er=null,Qs=new Map,Ys=new Map,Kn=[],ey="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bu(e,t){switch(e){case"focusin":case"focusout":Jn=null;break;case"dragenter":case"dragleave":Zn=null;break;case"mouseover":case"mouseout":er=null;break;case"pointerover":case"pointerout":Qs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ys.delete(t.pointerId)}}function Ss(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=ml(t),t!==null&&wc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function ty(e,t,n,r,s){switch(t){case"focusin":return Jn=Ss(Jn,e,t,n,r,s),!0;case"dragenter":return Zn=Ss(Zn,e,t,n,r,s),!0;case"mouseover":return er=Ss(er,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return Qs.set(o,Ss(Qs.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Ys.set(o,Ss(Ys.get(o)||null,e,t,n,r,s)),!0}return!1}function wp(e){var t=wr(e.target);if(t!==null){var n=Ir(t);if(n!==null){if(t=n.tag,t===13){if(t=ap(n),t!==null){e.blockedOn=t,xp(e.priority,function(){yp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ga(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);ua=r,n.target.dispatchEvent(r),ua=null}else return t=ml(n),t!==null&&wc(t),e.blockedOn=n,!1;t.shift()}return!0}function Vu(e,t,n){Xl(e)&&n.delete(t)}function ny(){ma=!1,Jn!==null&&Xl(Jn)&&(Jn=null),Zn!==null&&Xl(Zn)&&(Zn=null),er!==null&&Xl(er)&&(er=null),Qs.forEach(Vu),Ys.forEach(Vu)}function js(e,t){e.blockedOn===t&&(e.blockedOn=null,ma||(ma=!0,Ut.unstable_scheduleCallback(Ut.unstable_NormalPriority,ny)))}function qs(e){function t(s){return js(s,e)}if(0<zl.length){js(zl[0],e);for(var n=1;n<zl.length;n++){var r=zl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Jn!==null&&js(Jn,e),Zn!==null&&js(Zn,e),er!==null&&js(er,e),Qs.forEach(t),Ys.forEach(t),n=0;n<Kn.length;n++)r=Kn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Kn.length&&(n=Kn[0],n.blockedOn===null);)wp(n),n.blockedOn===null&&Kn.shift()}var es=On.ReactCurrentBatchConfig,ho=!0;function ry(e,t,n,r){var s=Qe,o=es.transition;es.transition=null;try{Qe=1,Sc(e,t,n,r)}finally{Qe=s,es.transition=o}}function sy(e,t,n,r){var s=Qe,o=es.transition;es.transition=null;try{Qe=4,Sc(e,t,n,r)}finally{Qe=s,es.transition=o}}function Sc(e,t,n,r){if(ho){var s=ga(e,t,n,r);if(s===null)Ii(e,t,r,mo,n),Bu(e,r);else if(ty(s,e,t,n,r))r.stopPropagation();else if(Bu(e,r),t&4&&-1<ey.indexOf(e)){for(;s!==null;){var o=ml(s);if(o!==null&&gp(o),o=ga(e,t,n,r),o===null&&Ii(e,t,r,mo,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Ii(e,t,r,null,n)}}var mo=null;function ga(e,t,n,r){if(mo=null,e=yc(r),e=wr(e),e!==null)if(t=Ir(e),t===null)e=null;else if(n=t.tag,n===13){if(e=ap(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return mo=e,null}function Sp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hg()){case vc:return 1;case fp:return 4;case fo:case Gg:return 16;case pp:return 536870912;default:return 16}default:return 16}}var Yn=null,jc=null,Jl=null;function jp(){if(Jl)return Jl;var e,t=jc,n=t.length,r,s="value"in Yn?Yn.value:Yn.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===s[o-r];r++);return Jl=s.slice(e,1<r?1-r:void 0)}function Zl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Al(){return!0}function Wu(){return!1}function Vt(e){function t(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Al:Wu,this.isPropagationStopped=Wu,this}return ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Al)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Al)},persist:function(){},isPersistent:Al}),t}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=Vt(hs),hl=ot({},hs,{view:0,detail:0}),ly=Vt(hl),Ni,ki,Ns,Go=ot({},hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ns&&(Ns&&e.type==="mousemove"?(Ni=e.screenX-Ns.screenX,ki=e.screenY-Ns.screenY):ki=Ni=0,Ns=e),Ni)},movementY:function(e){return"movementY"in e?e.movementY:ki}}),Hu=Vt(Go),oy=ot({},Go,{dataTransfer:0}),iy=Vt(oy),ay=ot({},hl,{relatedTarget:0}),bi=Vt(ay),cy=ot({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),uy=Vt(cy),dy=ot({},hs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fy=Vt(dy),py=ot({},hs,{data:0}),Gu=Vt(py),hy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},my={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yy(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gy[e])?!!t[e]:!1}function kc(){return yy}var vy=ot({},hl,{key:function(e){if(e.key){var t=hy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?my[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kc,charCode:function(e){return e.type==="keypress"?Zl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),xy=Vt(vy),wy=ot({},Go,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ku=Vt(wy),Sy=ot({},hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kc}),jy=Vt(Sy),Ny=ot({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),ky=Vt(Ny),by=ot({},Go,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Cy=Vt(by),Ey=[9,13,27,32],bc=Tn&&"CompositionEvent"in window,Ms=null;Tn&&"documentMode"in document&&(Ms=document.documentMode);var Ly=Tn&&"TextEvent"in window&&!Ms,Np=Tn&&(!bc||Ms&&8<Ms&&11>=Ms),Qu=" ",Yu=!1;function kp(e,t){switch(e){case"keyup":return Ey.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ur=!1;function Py(e,t){switch(e){case"compositionend":return bp(t);case"keypress":return t.which!==32?null:(Yu=!0,Qu);case"textInput":return e=t.data,e===Qu&&Yu?null:e;default:return null}}function _y(e,t){if(Ur)return e==="compositionend"||!bc&&kp(e,t)?(e=jp(),Jl=jc=Yn=null,Ur=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Np&&t.locale!=="ko"?null:t.data;default:return null}}var Ry={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ry[e.type]:t==="textarea"}function Cp(e,t,n,r){rp(r),t=go(t,"onChange"),0<t.length&&(n=new Nc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var $s=null,Xs=null;function Iy(e){$p(e,0)}function Ko(e){var t=Wr(e);if(qf(t))return e}function zy(e,t){if(e==="change")return t}var Ep=!1;if(Tn){var Ci;if(Tn){var Ei="oninput"in document;if(!Ei){var Xu=document.createElement("div");Xu.setAttribute("oninput","return;"),Ei=typeof Xu.oninput=="function"}Ci=Ei}else Ci=!1;Ep=Ci&&(!document.documentMode||9<document.documentMode)}function Ju(){$s&&($s.detachEvent("onpropertychange",Lp),Xs=$s=null)}function Lp(e){if(e.propertyName==="value"&&Ko(Xs)){var t=[];Cp(t,Xs,e,yc(e)),ip(Iy,t)}}function Ay(e,t,n){e==="focusin"?(Ju(),$s=t,Xs=n,$s.attachEvent("onpropertychange",Lp)):e==="focusout"&&Ju()}function Ty(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ko(Xs)}function My(e,t){if(e==="click")return Ko(t)}function $y(e,t){if(e==="input"||e==="change")return Ko(t)}function Fy(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var cn=typeof Object.is=="function"?Object.is:Fy;function Js(e,t){if(cn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ji.call(t,s)||!cn(e[s],t[s]))return!1}return!0}function Zu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ed(e,t){var n=Zu(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zu(n)}}function Pp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Pp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _p(){for(var e=window,t=ao();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ao(e.document)}return t}function Cc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Oy(e){var t=_p(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Pp(n.ownerDocument.documentElement,n)){if(r!==null&&Cc(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=ed(n,o);var i=ed(n,r);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Dy=Tn&&"documentMode"in document&&11>=document.documentMode,Br=null,ya=null,Fs=null,va=!1;function td(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;va||Br==null||Br!==ao(r)||(r=Br,"selectionStart"in r&&Cc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fs&&Js(Fs,r)||(Fs=r,r=go(ya,"onSelect"),0<r.length&&(t=new Nc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Br)))}function Tl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Vr={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionend:Tl("Transition","TransitionEnd")},Li={},Rp={};Tn&&(Rp=document.createElement("div").style,"AnimationEvent"in window||(delete Vr.animationend.animation,delete Vr.animationiteration.animation,delete Vr.animationstart.animation),"TransitionEvent"in window||delete Vr.transitionend.transition);function Qo(e){if(Li[e])return Li[e];if(!Vr[e])return e;var t=Vr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Rp)return Li[e]=t[n];return e}var Ip=Qo("animationend"),zp=Qo("animationiteration"),Ap=Qo("animationstart"),Tp=Qo("transitionend"),Mp=new Map,nd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fr(e,t){Mp.set(e,t),Rr(t,[e])}for(var Pi=0;Pi<nd.length;Pi++){var _i=nd[Pi],Uy=_i.toLowerCase(),By=_i[0].toUpperCase()+_i.slice(1);fr(Uy,"on"+By)}fr(Ip,"onAnimationEnd");fr(zp,"onAnimationIteration");fr(Ap,"onAnimationStart");fr("dblclick","onDoubleClick");fr("focusin","onFocus");fr("focusout","onBlur");fr(Tp,"onTransitionEnd");ss("onMouseEnter",["mouseout","mouseover"]);ss("onMouseLeave",["mouseout","mouseover"]);ss("onPointerEnter",["pointerout","pointerover"]);ss("onPointerLeave",["pointerout","pointerover"]);Rr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rs));function rd(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Ug(r,t,void 0,e),e.currentTarget=null}function $p(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var a=r[i],u=a.instance,d=a.currentTarget;if(a=a.listener,u!==o&&s.isPropagationStopped())break e;rd(s,a,d),o=u}else for(i=0;i<r.length;i++){if(a=r[i],u=a.instance,d=a.currentTarget,a=a.listener,u!==o&&s.isPropagationStopped())break e;rd(s,a,d),o=u}}}if(uo)throw e=pa,uo=!1,pa=null,e}function Xe(e,t){var n=t[Na];n===void 0&&(n=t[Na]=new Set);var r=e+"__bubble";n.has(r)||(Fp(t,e,2,!1),n.add(r))}function Ri(e,t,n){var r=0;t&&(r|=4),Fp(n,e,r,t)}var Ml="_reactListening"+Math.random().toString(36).slice(2);function Zs(e){if(!e[Ml]){e[Ml]=!0,Hf.forEach(function(n){n!=="selectionchange"&&(Vy.has(n)||Ri(n,!1,e),Ri(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ml]||(t[Ml]=!0,Ri("selectionchange",!1,t))}}function Fp(e,t,n,r){switch(Sp(t)){case 1:var s=ry;break;case 4:s=sy;break;default:s=Sc}n=s.bind(null,t,n,e),s=void 0,!fa||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Ii(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;i=i.return}for(;a!==null;){if(i=wr(a),i===null)return;if(u=i.tag,u===5||u===6){r=o=i;continue e}a=a.parentNode}}r=r.return}ip(function(){var d=o,g=yc(n),y=[];e:{var m=Mp.get(e);if(m!==void 0){var x=Nc,w=e;switch(e){case"keypress":if(Zl(n)===0)break e;case"keydown":case"keyup":x=xy;break;case"focusin":w="focus",x=bi;break;case"focusout":w="blur",x=bi;break;case"beforeblur":case"afterblur":x=bi;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Hu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=iy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=jy;break;case Ip:case zp:case Ap:x=uy;break;case Tp:x=ky;break;case"scroll":x=ly;break;case"wheel":x=Cy;break;case"copy":case"cut":case"paste":x=fy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Ku}var j=(t&4)!==0,S=!j&&e==="scroll",h=j?m!==null?m+"Capture":null:m;j=[];for(var f=d,p;f!==null;){p=f;var v=p.stateNode;if(p.tag===5&&v!==null&&(p=v,h!==null&&(v=Ks(f,h),v!=null&&j.push(el(f,v,p)))),S)break;f=f.return}0<j.length&&(m=new x(m,w,null,n,g),y.push({event:m,listeners:j}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",m&&n!==ua&&(w=n.relatedTarget||n.fromElement)&&(wr(w)||w[Mn]))break e;if((x||m)&&(m=g.window===g?g:(m=g.ownerDocument)?m.defaultView||m.parentWindow:window,x?(w=n.relatedTarget||n.toElement,x=d,w=w?wr(w):null,w!==null&&(S=Ir(w),w!==S||w.tag!==5&&w.tag!==6)&&(w=null)):(x=null,w=d),x!==w)){if(j=Hu,v="onMouseLeave",h="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(j=Ku,v="onPointerLeave",h="onPointerEnter",f="pointer"),S=x==null?m:Wr(x),p=w==null?m:Wr(w),m=new j(v,f+"leave",x,n,g),m.target=S,m.relatedTarget=p,v=null,wr(g)===d&&(j=new j(h,f+"enter",w,n,g),j.target=p,j.relatedTarget=S,v=j),S=v,x&&w)t:{for(j=x,h=w,f=0,p=j;p;p=Tr(p))f++;for(p=0,v=h;v;v=Tr(v))p++;for(;0<f-p;)j=Tr(j),f--;for(;0<p-f;)h=Tr(h),p--;for(;f--;){if(j===h||h!==null&&j===h.alternate)break t;j=Tr(j),h=Tr(h)}j=null}else j=null;x!==null&&sd(y,m,x,j,!1),w!==null&&S!==null&&sd(y,S,w,j,!0)}}e:{if(m=d?Wr(d):window,x=m.nodeName&&m.nodeName.toLowerCase(),x==="select"||x==="input"&&m.type==="file")var b=zy;else if(qu(m))if(Ep)b=$y;else{b=Ty;var C=Ay}else(x=m.nodeName)&&x.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(b=My);if(b&&(b=b(e,d))){Cp(y,b,n,g);break e}C&&C(e,m,d),e==="focusout"&&(C=m._wrapperState)&&C.controlled&&m.type==="number"&&la(m,"number",m.value)}switch(C=d?Wr(d):window,e){case"focusin":(qu(C)||C.contentEditable==="true")&&(Br=C,ya=d,Fs=null);break;case"focusout":Fs=ya=Br=null;break;case"mousedown":va=!0;break;case"contextmenu":case"mouseup":case"dragend":va=!1,td(y,n,g);break;case"selectionchange":if(Dy)break;case"keydown":case"keyup":td(y,n,g)}var _;if(bc)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Ur?kp(e,n)&&(I="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(Np&&n.locale!=="ko"&&(Ur||I!=="onCompositionStart"?I==="onCompositionEnd"&&Ur&&(_=jp()):(Yn=g,jc="value"in Yn?Yn.value:Yn.textContent,Ur=!0)),C=go(d,I),0<C.length&&(I=new Gu(I,e,null,n,g),y.push({event:I,listeners:C}),_?I.data=_:(_=bp(n),_!==null&&(I.data=_)))),(_=Ly?Py(e,n):_y(e,n))&&(d=go(d,"onBeforeInput"),0<d.length&&(g=new Gu("onBeforeInput","beforeinput",null,n,g),y.push({event:g,listeners:d}),g.data=_))}$p(y,t)})}function el(e,t,n){return{instance:e,listener:t,currentTarget:n}}function go(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Ks(e,n),o!=null&&r.unshift(el(e,o,s)),o=Ks(e,t),o!=null&&r.push(el(e,o,s))),e=e.return}return r}function Tr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function sd(e,t,n,r,s){for(var o=t._reactName,i=[];n!==null&&n!==r;){var a=n,u=a.alternate,d=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&d!==null&&(a=d,s?(u=Ks(n,o),u!=null&&i.unshift(el(n,u,a))):s||(u=Ks(n,o),u!=null&&i.push(el(n,u,a)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var Wy=/\r\n?/g,Hy=/\u0000|\uFFFD/g;function ld(e){return(typeof e=="string"?e:""+e).replace(Wy,`
`).replace(Hy,"")}function $l(e,t,n){if(t=ld(t),ld(e)!==t&&n)throw Error(J(425))}function yo(){}var xa=null,wa=null;function Sa(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ja=typeof setTimeout=="function"?setTimeout:void 0,Gy=typeof clearTimeout=="function"?clearTimeout:void 0,od=typeof Promise=="function"?Promise:void 0,Ky=typeof queueMicrotask=="function"?queueMicrotask:typeof od<"u"?function(e){return od.resolve(null).then(e).catch(Qy)}:ja;function Qy(e){setTimeout(function(){throw e})}function zi(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),qs(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);qs(t)}function tr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function id(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ms=Math.random().toString(36).slice(2),hn="__reactFiber$"+ms,tl="__reactProps$"+ms,Mn="__reactContainer$"+ms,Na="__reactEvents$"+ms,Yy="__reactListeners$"+ms,qy="__reactHandles$"+ms;function wr(e){var t=e[hn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Mn]||n[hn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=id(e);e!==null;){if(n=e[hn])return n;e=id(e)}return t}e=n,n=e.parentNode}return null}function ml(e){return e=e[hn]||e[Mn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Wr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function Yo(e){return e[tl]||null}var ka=[],Hr=-1;function pr(e){return{current:e}}function Je(e){0>Hr||(e.current=ka[Hr],ka[Hr]=null,Hr--)}function Ye(e,t){Hr++,ka[Hr]=e.current,e.current=t}var ar={},bt=pr(ar),At=pr(!1),Cr=ar;function ls(e,t){var n=e.type.contextTypes;if(!n)return ar;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Tt(e){return e=e.childContextTypes,e!=null}function vo(){Je(At),Je(bt)}function ad(e,t,n){if(bt.current!==ar)throw Error(J(168));Ye(bt,t),Ye(At,n)}function Op(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(J(108,Ag(e)||"Unknown",s));return ot({},n,r)}function xo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ar,Cr=bt.current,Ye(bt,e),Ye(At,At.current),!0}function cd(e,t,n){var r=e.stateNode;if(!r)throw Error(J(169));n?(e=Op(e,t,Cr),r.__reactInternalMemoizedMergedChildContext=e,Je(At),Je(bt),Ye(bt,e)):Je(At),Ye(At,n)}var En=null,qo=!1,Ai=!1;function Dp(e){En===null?En=[e]:En.push(e)}function Xy(e){qo=!0,Dp(e)}function hr(){if(!Ai&&En!==null){Ai=!0;var e=0,t=Qe;try{var n=En;for(Qe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}En=null,qo=!1}catch(s){throw En!==null&&(En=En.slice(e+1)),dp(vc,hr),s}finally{Qe=t,Ai=!1}}return null}var Gr=[],Kr=0,wo=null,So=0,Yt=[],qt=0,Er=null,Pn=1,_n="";function yr(e,t){Gr[Kr++]=So,Gr[Kr++]=wo,wo=e,So=t}function Up(e,t,n){Yt[qt++]=Pn,Yt[qt++]=_n,Yt[qt++]=Er,Er=e;var r=Pn;e=_n;var s=32-on(r)-1;r&=~(1<<s),n+=1;var o=32-on(t)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Pn=1<<32-on(t)+s|n<<s|r,_n=o+e}else Pn=1<<o|n<<s|r,_n=e}function Ec(e){e.return!==null&&(yr(e,1),Up(e,1,0))}function Lc(e){for(;e===wo;)wo=Gr[--Kr],Gr[Kr]=null,So=Gr[--Kr],Gr[Kr]=null;for(;e===Er;)Er=Yt[--qt],Yt[qt]=null,_n=Yt[--qt],Yt[qt]=null,Pn=Yt[--qt],Yt[qt]=null}var Dt=null,Ot=null,et=!1,ln=null;function Bp(e,t){var n=Xt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ud(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Dt=e,Ot=tr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Dt=e,Ot=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Er!==null?{id:Pn,overflow:_n}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Xt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Dt=e,Ot=null,!0):!1;default:return!1}}function ba(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ca(e){if(et){var t=Ot;if(t){var n=t;if(!ud(e,t)){if(ba(e))throw Error(J(418));t=tr(n.nextSibling);var r=Dt;t&&ud(e,t)?Bp(r,n):(e.flags=e.flags&-4097|2,et=!1,Dt=e)}}else{if(ba(e))throw Error(J(418));e.flags=e.flags&-4097|2,et=!1,Dt=e}}}function dd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Dt=e}function Fl(e){if(e!==Dt)return!1;if(!et)return dd(e),et=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Sa(e.type,e.memoizedProps)),t&&(t=Ot)){if(ba(e))throw Vp(),Error(J(418));for(;t;)Bp(e,t),t=tr(t.nextSibling)}if(dd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ot=tr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ot=null}}else Ot=Dt?tr(e.stateNode.nextSibling):null;return!0}function Vp(){for(var e=Ot;e;)e=tr(e.nextSibling)}function os(){Ot=Dt=null,et=!1}function Pc(e){ln===null?ln=[e]:ln.push(e)}var Jy=On.ReactCurrentBatchConfig;function ks(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,e))}return e}function Ol(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fd(e){var t=e._init;return t(e._payload)}function Wp(e){function t(h,f){if(e){var p=h.deletions;p===null?(h.deletions=[f],h.flags|=16):p.push(f)}}function n(h,f){if(!e)return null;for(;f!==null;)t(h,f),f=f.sibling;return null}function r(h,f){for(h=new Map;f!==null;)f.key!==null?h.set(f.key,f):h.set(f.index,f),f=f.sibling;return h}function s(h,f){return h=lr(h,f),h.index=0,h.sibling=null,h}function o(h,f,p){return h.index=p,e?(p=h.alternate,p!==null?(p=p.index,p<f?(h.flags|=2,f):p):(h.flags|=2,f)):(h.flags|=1048576,f)}function i(h){return e&&h.alternate===null&&(h.flags|=2),h}function a(h,f,p,v){return f===null||f.tag!==6?(f=Ui(p,h.mode,v),f.return=h,f):(f=s(f,p),f.return=h,f)}function u(h,f,p,v){var b=p.type;return b===Dr?g(h,f,p.props.children,v,p.key):f!==null&&(f.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Hn&&fd(b)===f.type)?(v=s(f,p.props),v.ref=ks(h,f,p),v.return=h,v):(v=oo(p.type,p.key,p.props,null,h.mode,v),v.ref=ks(h,f,p),v.return=h,v)}function d(h,f,p,v){return f===null||f.tag!==4||f.stateNode.containerInfo!==p.containerInfo||f.stateNode.implementation!==p.implementation?(f=Bi(p,h.mode,v),f.return=h,f):(f=s(f,p.children||[]),f.return=h,f)}function g(h,f,p,v,b){return f===null||f.tag!==7?(f=kr(p,h.mode,v,b),f.return=h,f):(f=s(f,p),f.return=h,f)}function y(h,f,p){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Ui(""+f,h.mode,p),f.return=h,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Ll:return p=oo(f.type,f.key,f.props,null,h.mode,p),p.ref=ks(h,null,f),p.return=h,p;case Or:return f=Bi(f,h.mode,p),f.return=h,f;case Hn:var v=f._init;return y(h,v(f._payload),p)}if(Ps(f)||xs(f))return f=kr(f,h.mode,p,null),f.return=h,f;Ol(h,f)}return null}function m(h,f,p,v){var b=f!==null?f.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return b!==null?null:a(h,f,""+p,v);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ll:return p.key===b?u(h,f,p,v):null;case Or:return p.key===b?d(h,f,p,v):null;case Hn:return b=p._init,m(h,f,b(p._payload),v)}if(Ps(p)||xs(p))return b!==null?null:g(h,f,p,v,null);Ol(h,p)}return null}function x(h,f,p,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return h=h.get(p)||null,a(f,h,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Ll:return h=h.get(v.key===null?p:v.key)||null,u(f,h,v,b);case Or:return h=h.get(v.key===null?p:v.key)||null,d(f,h,v,b);case Hn:var C=v._init;return x(h,f,p,C(v._payload),b)}if(Ps(v)||xs(v))return h=h.get(p)||null,g(f,h,v,b,null);Ol(f,v)}return null}function w(h,f,p,v){for(var b=null,C=null,_=f,I=f=0,z=null;_!==null&&I<p.length;I++){_.index>I?(z=_,_=null):z=_.sibling;var A=m(h,_,p[I],v);if(A===null){_===null&&(_=z);break}e&&_&&A.alternate===null&&t(h,_),f=o(A,f,I),C===null?b=A:C.sibling=A,C=A,_=z}if(I===p.length)return n(h,_),et&&yr(h,I),b;if(_===null){for(;I<p.length;I++)_=y(h,p[I],v),_!==null&&(f=o(_,f,I),C===null?b=_:C.sibling=_,C=_);return et&&yr(h,I),b}for(_=r(h,_);I<p.length;I++)z=x(_,h,I,p[I],v),z!==null&&(e&&z.alternate!==null&&_.delete(z.key===null?I:z.key),f=o(z,f,I),C===null?b=z:C.sibling=z,C=z);return e&&_.forEach(function(D){return t(h,D)}),et&&yr(h,I),b}function j(h,f,p,v){var b=xs(p);if(typeof b!="function")throw Error(J(150));if(p=b.call(p),p==null)throw Error(J(151));for(var C=b=null,_=f,I=f=0,z=null,A=p.next();_!==null&&!A.done;I++,A=p.next()){_.index>I?(z=_,_=null):z=_.sibling;var D=m(h,_,A.value,v);if(D===null){_===null&&(_=z);break}e&&_&&D.alternate===null&&t(h,_),f=o(D,f,I),C===null?b=D:C.sibling=D,C=D,_=z}if(A.done)return n(h,_),et&&yr(h,I),b;if(_===null){for(;!A.done;I++,A=p.next())A=y(h,A.value,v),A!==null&&(f=o(A,f,I),C===null?b=A:C.sibling=A,C=A);return et&&yr(h,I),b}for(_=r(h,_);!A.done;I++,A=p.next())A=x(_,h,I,A.value,v),A!==null&&(e&&A.alternate!==null&&_.delete(A.key===null?I:A.key),f=o(A,f,I),C===null?b=A:C.sibling=A,C=A);return e&&_.forEach(function(oe){return t(h,oe)}),et&&yr(h,I),b}function S(h,f,p,v){if(typeof p=="object"&&p!==null&&p.type===Dr&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case Ll:e:{for(var b=p.key,C=f;C!==null;){if(C.key===b){if(b=p.type,b===Dr){if(C.tag===7){n(h,C.sibling),f=s(C,p.props.children),f.return=h,h=f;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Hn&&fd(b)===C.type){n(h,C.sibling),f=s(C,p.props),f.ref=ks(h,C,p),f.return=h,h=f;break e}n(h,C);break}else t(h,C);C=C.sibling}p.type===Dr?(f=kr(p.props.children,h.mode,v,p.key),f.return=h,h=f):(v=oo(p.type,p.key,p.props,null,h.mode,v),v.ref=ks(h,f,p),v.return=h,h=v)}return i(h);case Or:e:{for(C=p.key;f!==null;){if(f.key===C)if(f.tag===4&&f.stateNode.containerInfo===p.containerInfo&&f.stateNode.implementation===p.implementation){n(h,f.sibling),f=s(f,p.children||[]),f.return=h,h=f;break e}else{n(h,f);break}else t(h,f);f=f.sibling}f=Bi(p,h.mode,v),f.return=h,h=f}return i(h);case Hn:return C=p._init,S(h,f,C(p._payload),v)}if(Ps(p))return w(h,f,p,v);if(xs(p))return j(h,f,p,v);Ol(h,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,f!==null&&f.tag===6?(n(h,f.sibling),f=s(f,p),f.return=h,h=f):(n(h,f),f=Ui(p,h.mode,v),f.return=h,h=f),i(h)):n(h,f)}return S}var is=Wp(!0),Hp=Wp(!1),jo=pr(null),No=null,Qr=null,_c=null;function Rc(){_c=Qr=No=null}function Ic(e){var t=jo.current;Je(jo),e._currentValue=t}function Ea(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ts(e,t){No=e,_c=Qr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(zt=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(_c!==e)if(e={context:e,memoizedValue:t,next:null},Qr===null){if(No===null)throw Error(J(308));Qr=e,No.dependencies={lanes:0,firstContext:e}}else Qr=Qr.next=e;return t}var Sr=null;function zc(e){Sr===null?Sr=[e]:Sr.push(e)}function Gp(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,zc(t)):(n.next=s.next,s.next=n),t.interleaved=n,$n(e,r)}function $n(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Gn=!1;function Ac(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function nr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,$n(e,n)}return s=r.interleaved,s===null?(t.next=t,zc(r)):(t.next=s.next,s.next=t),r.interleaved=t,$n(e,n)}function eo(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,xc(e,n)}}function pd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ko(e,t,n,r){var s=e.updateQueue;Gn=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,d=u.next;u.next=null,i===null?o=d:i.next=d,i=u;var g=e.alternate;g!==null&&(g=g.updateQueue,a=g.lastBaseUpdate,a!==i&&(a===null?g.firstBaseUpdate=d:a.next=d,g.lastBaseUpdate=u))}if(o!==null){var y=s.baseState;i=0,g=d=u=null,a=o;do{var m=a.lane,x=a.eventTime;if((r&m)===m){g!==null&&(g=g.next={eventTime:x,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var w=e,j=a;switch(m=t,x=n,j.tag){case 1:if(w=j.payload,typeof w=="function"){y=w.call(x,y,m);break e}y=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=j.payload,m=typeof w=="function"?w.call(x,y,m):w,m==null)break e;y=ot({},y,m);break e;case 2:Gn=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else x={eventTime:x,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},g===null?(d=g=x,u=y):g=g.next=x,i|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(g===null&&(u=y),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=g,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Pr|=i,e.lanes=i,e.memoizedState=y}}function hd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(J(191,s));s.call(r)}}}var gl={},wn=pr(gl),nl=pr(gl),rl=pr(gl);function jr(e){if(e===gl)throw Error(J(174));return e}function Tc(e,t){switch(Ye(rl,t),Ye(nl,e),Ye(wn,gl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ia(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ia(t,e)}Je(wn),Ye(wn,t)}function as(){Je(wn),Je(nl),Je(rl)}function Qp(e){jr(rl.current);var t=jr(wn.current),n=ia(t,e.type);t!==n&&(Ye(nl,e),Ye(wn,n))}function Mc(e){nl.current===e&&(Je(wn),Je(nl))}var rt=pr(0);function bo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ti=[];function $c(){for(var e=0;e<Ti.length;e++)Ti[e]._workInProgressVersionPrimary=null;Ti.length=0}var to=On.ReactCurrentDispatcher,Mi=On.ReactCurrentBatchConfig,Lr=0,st=null,ft=null,gt=null,Co=!1,Os=!1,sl=0,Zy=0;function jt(){throw Error(J(321))}function Fc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!cn(e[n],t[n]))return!1;return!0}function Oc(e,t,n,r,s,o){if(Lr=o,st=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,to.current=e===null||e.memoizedState===null?rv:sv,e=n(r,s),Os){o=0;do{if(Os=!1,sl=0,25<=o)throw Error(J(301));o+=1,gt=ft=null,t.updateQueue=null,to.current=lv,e=n(r,s)}while(Os)}if(to.current=Eo,t=ft!==null&&ft.next!==null,Lr=0,gt=ft=st=null,Co=!1,t)throw Error(J(300));return e}function Dc(){var e=sl!==0;return sl=0,e}function fn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?st.memoizedState=gt=e:gt=gt.next=e,gt}function en(){if(ft===null){var e=st.alternate;e=e!==null?e.memoizedState:null}else e=ft.next;var t=gt===null?st.memoizedState:gt.next;if(t!==null)gt=t,ft=e;else{if(e===null)throw Error(J(310));ft=e,e={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},gt===null?st.memoizedState=gt=e:gt=gt.next=e}return gt}function ll(e,t){return typeof t=="function"?t(e):t}function $i(e){var t=en(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=ft,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,u=null,d=o;do{var g=d.lane;if((Lr&g)===g)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var y={lane:g,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(a=u=y,i=r):u=u.next=y,st.lanes|=g,Pr|=g}d=d.next}while(d!==null&&d!==o);u===null?i=r:u.next=a,cn(r,t.memoizedState)||(zt=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,st.lanes|=o,Pr|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Fi(e){var t=en(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);cn(o,t.memoizedState)||(zt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Yp(){}function qp(e,t){var n=st,r=en(),s=t(),o=!cn(r.memoizedState,s);if(o&&(r.memoizedState=s,zt=!0),r=r.queue,Uc(Zp.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||gt!==null&&gt.memoizedState.tag&1){if(n.flags|=2048,ol(9,Jp.bind(null,n,r,s,t),void 0,null),yt===null)throw Error(J(349));Lr&30||Xp(n,t,s)}return s}function Xp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=st.updateQueue,t===null?(t={lastEffect:null,stores:null},st.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Jp(e,t,n,r){t.value=n,t.getSnapshot=r,eh(t)&&th(e)}function Zp(e,t,n){return n(function(){eh(t)&&th(e)})}function eh(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!cn(e,n)}catch{return!0}}function th(e){var t=$n(e,1);t!==null&&an(t,e,1,-1)}function md(e){var t=fn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:e},t.queue=e,e=e.dispatch=nv.bind(null,st,e),[t.memoizedState,e]}function ol(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=st.updateQueue,t===null?(t={lastEffect:null,stores:null},st.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function nh(){return en().memoizedState}function no(e,t,n,r){var s=fn();st.flags|=e,s.memoizedState=ol(1|t,n,void 0,r===void 0?null:r)}function Xo(e,t,n,r){var s=en();r=r===void 0?null:r;var o=void 0;if(ft!==null){var i=ft.memoizedState;if(o=i.destroy,r!==null&&Fc(r,i.deps)){s.memoizedState=ol(t,n,o,r);return}}st.flags|=e,s.memoizedState=ol(1|t,n,o,r)}function gd(e,t){return no(8390656,8,e,t)}function Uc(e,t){return Xo(2048,8,e,t)}function rh(e,t){return Xo(4,2,e,t)}function sh(e,t){return Xo(4,4,e,t)}function lh(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function oh(e,t,n){return n=n!=null?n.concat([e]):null,Xo(4,4,lh.bind(null,t,e),n)}function Bc(){}function ih(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ah(e,t){var n=en();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Fc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ch(e,t,n){return Lr&21?(cn(n,t)||(n=hp(),st.lanes|=n,Pr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,zt=!0),e.memoizedState=n)}function ev(e,t){var n=Qe;Qe=n!==0&&4>n?n:4,e(!0);var r=Mi.transition;Mi.transition={};try{e(!1),t()}finally{Qe=n,Mi.transition=r}}function uh(){return en().memoizedState}function tv(e,t,n){var r=sr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},dh(e))fh(t,n);else if(n=Gp(e,t,n,r),n!==null){var s=Et();an(n,e,r,s),ph(n,t,r)}}function nv(e,t,n){var r=sr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(dh(e))fh(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,cn(a,i)){var u=t.interleaved;u===null?(s.next=s,zc(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=Gp(e,t,s,r),n!==null&&(s=Et(),an(n,e,r,s),ph(n,t,r))}}function dh(e){var t=e.alternate;return e===st||t!==null&&t===st}function fh(e,t){Os=Co=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ph(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,xc(e,n)}}var Eo={readContext:Zt,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useInsertionEffect:jt,useLayoutEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useMutableSource:jt,useSyncExternalStore:jt,useId:jt,unstable_isNewReconciler:!1},rv={readContext:Zt,useCallback:function(e,t){return fn().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:gd,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,no(4194308,4,lh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return no(4194308,4,e,t)},useInsertionEffect:function(e,t){return no(4,2,e,t)},useMemo:function(e,t){var n=fn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=fn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tv.bind(null,st,e),[r.memoizedState,e]},useRef:function(e){var t=fn();return e={current:e},t.memoizedState=e},useState:md,useDebugValue:Bc,useDeferredValue:function(e){return fn().memoizedState=e},useTransition:function(){var e=md(!1),t=e[0];return e=ev.bind(null,e[1]),fn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=st,s=fn();if(et){if(n===void 0)throw Error(J(407));n=n()}else{if(n=t(),yt===null)throw Error(J(349));Lr&30||Xp(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,gd(Zp.bind(null,r,o,e),[e]),r.flags|=2048,ol(9,Jp.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=fn(),t=yt.identifierPrefix;if(et){var n=_n,r=Pn;n=(r&~(1<<32-on(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=sl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Zy++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},sv={readContext:Zt,useCallback:ih,useContext:Zt,useEffect:Uc,useImperativeHandle:oh,useInsertionEffect:rh,useLayoutEffect:sh,useMemo:ah,useReducer:$i,useRef:nh,useState:function(){return $i(ll)},useDebugValue:Bc,useDeferredValue:function(e){var t=en();return ch(t,ft.memoizedState,e)},useTransition:function(){var e=$i(ll)[0],t=en().memoizedState;return[e,t]},useMutableSource:Yp,useSyncExternalStore:qp,useId:uh,unstable_isNewReconciler:!1},lv={readContext:Zt,useCallback:ih,useContext:Zt,useEffect:Uc,useImperativeHandle:oh,useInsertionEffect:rh,useLayoutEffect:sh,useMemo:ah,useReducer:Fi,useRef:nh,useState:function(){return Fi(ll)},useDebugValue:Bc,useDeferredValue:function(e){var t=en();return ft===null?t.memoizedState=e:ch(t,ft.memoizedState,e)},useTransition:function(){var e=Fi(ll)[0],t=en().memoizedState;return[e,t]},useMutableSource:Yp,useSyncExternalStore:qp,useId:uh,unstable_isNewReconciler:!1};function rn(e,t){if(e&&e.defaultProps){t=ot({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function La(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ot({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Jo={isMounted:function(e){return(e=e._reactInternals)?Ir(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Et(),s=sr(e),o=zn(r,s);o.payload=t,n!=null&&(o.callback=n),t=nr(e,o,s),t!==null&&(an(t,e,s,r),eo(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Et(),s=sr(e),o=zn(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=nr(e,o,s),t!==null&&(an(t,e,s,r),eo(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Et(),r=sr(e),s=zn(n,r);s.tag=2,t!=null&&(s.callback=t),t=nr(e,s,r),t!==null&&(an(t,e,r,n),eo(t,e,r))}};function yd(e,t,n,r,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,i):t.prototype&&t.prototype.isPureReactComponent?!Js(n,r)||!Js(s,o):!0}function hh(e,t,n){var r=!1,s=ar,o=t.contextType;return typeof o=="object"&&o!==null?o=Zt(o):(s=Tt(t)?Cr:bt.current,r=t.contextTypes,o=(r=r!=null)?ls(e,s):ar),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Jo,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function vd(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Jo.enqueueReplaceState(t,t.state,null)}function Pa(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Ac(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Zt(o):(o=Tt(t)?Cr:bt.current,s.context=ls(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(La(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Jo.enqueueReplaceState(s,s.state,null),ko(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do n+=zg(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function Oi(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function _a(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ov=typeof WeakMap=="function"?WeakMap:Map;function mh(e,t,n){n=zn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Po||(Po=!0,Da=r),_a(e,t)},n}function gh(e,t,n){n=zn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){_a(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){_a(e,t),typeof r!="function"&&(rr===null?rr=new Set([this]):rr.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function xd(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new ov;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=wv.bind(null,e,t,n),t.then(e,e))}function wd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Sd(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=zn(-1,1),t.tag=2,nr(n,t,1))),n.lanes|=1),e)}var iv=On.ReactCurrentOwner,zt=!1;function Ct(e,t,n,r){t.child=e===null?Hp(t,null,n,r):is(t,e.child,n,r)}function jd(e,t,n,r,s){n=n.render;var o=t.ref;return ts(t,s),r=Oc(e,t,n,r,o,s),n=Dc(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Fn(e,t,s)):(et&&n&&Ec(t),t.flags|=1,Ct(e,t,r,s),t.child)}function Nd(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!qc(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,yh(e,t,o,r,s)):(e=oo(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Js,n(i,r)&&e.ref===t.ref)return Fn(e,t,s)}return t.flags|=1,e=lr(o,r),e.ref=t.ref,e.return=t,t.child=e}function yh(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(Js(o,r)&&e.ref===t.ref)if(zt=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(zt=!0);else return t.lanes=e.lanes,Fn(e,t,s)}return Ra(e,t,n,r,s)}function vh(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(qr,$t),$t|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ye(qr,$t),$t|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Ye(qr,$t),$t|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ye(qr,$t),$t|=r;return Ct(e,t,s,n),t.child}function xh(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ra(e,t,n,r,s){var o=Tt(n)?Cr:bt.current;return o=ls(t,o),ts(t,s),n=Oc(e,t,n,r,o,s),r=Dc(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Fn(e,t,s)):(et&&r&&Ec(t),t.flags|=1,Ct(e,t,n,s),t.child)}function kd(e,t,n,r,s){if(Tt(n)){var o=!0;xo(t)}else o=!1;if(ts(t,s),t.stateNode===null)ro(e,t),hh(t,n,r),Pa(t,n,r,s),r=!0;else if(e===null){var i=t.stateNode,a=t.memoizedProps;i.props=a;var u=i.context,d=n.contextType;typeof d=="object"&&d!==null?d=Zt(d):(d=Tt(n)?Cr:bt.current,d=ls(t,d));var g=n.getDerivedStateFromProps,y=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function";y||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||u!==d)&&vd(t,i,r,d),Gn=!1;var m=t.memoizedState;i.state=m,ko(t,r,i,s),u=t.memoizedState,a!==r||m!==u||At.current||Gn?(typeof g=="function"&&(La(t,n,g,r),u=t.memoizedState),(a=Gn||yd(t,n,a,r,m,u,d))?(y||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),i.props=r,i.state=u,i.context=d,r=a):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Kp(e,t),a=t.memoizedProps,d=t.type===t.elementType?a:rn(t.type,a),i.props=d,y=t.pendingProps,m=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Zt(u):(u=Tt(n)?Cr:bt.current,u=ls(t,u));var x=n.getDerivedStateFromProps;(g=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==y||m!==u)&&vd(t,i,r,u),Gn=!1,m=t.memoizedState,i.state=m,ko(t,r,i,s);var w=t.memoizedState;a!==y||m!==w||At.current||Gn?(typeof x=="function"&&(La(t,n,x,r),w=t.memoizedState),(d=Gn||yd(t,n,d,r,m,w,u)||!1)?(g||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,w,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,w,u)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),i.props=r,i.state=w,i.context=u,r=d):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),r=!1)}return Ia(e,t,n,r,o,s)}function Ia(e,t,n,r,s,o){xh(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return s&&cd(t,n,!1),Fn(e,t,o);r=t.stateNode,iv.current=t;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=is(t,e.child,null,o),t.child=is(t,null,a,o)):Ct(e,t,a,o),t.memoizedState=r.state,s&&cd(t,n,!0),t.child}function wh(e){var t=e.stateNode;t.pendingContext?ad(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ad(e,t.context,!1),Tc(e,t.containerInfo)}function bd(e,t,n,r,s){return os(),Pc(s),t.flags|=256,Ct(e,t,n,r),t.child}var za={dehydrated:null,treeContext:null,retryLane:0};function Aa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Sh(e,t,n){var r=t.pendingProps,s=rt.current,o=!1,i=(t.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ye(rt,s&1),e===null)return Ca(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,o?(r=t.mode,o=t.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=ti(i,r,0,null),e=kr(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Aa(n),t.memoizedState=za,e):Vc(t,i));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return av(e,t,i,r,a,s,n);if(o){o=r.fallback,i=t.mode,s=e.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=lr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=lr(a,o):(o=kr(o,i,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,i=e.child.memoizedState,i=i===null?Aa(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~n,t.memoizedState=za,r}return o=e.child,e=o.sibling,r=lr(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Vc(e,t){return t=ti({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Dl(e,t,n,r){return r!==null&&Pc(r),is(t,e.child,null,n),e=Vc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function av(e,t,n,r,s,o,i){if(n)return t.flags&256?(t.flags&=-257,r=Oi(Error(J(422))),Dl(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=ti({mode:"visible",children:r.children},s,0,null),o=kr(o,s,i,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&is(t,e.child,null,i),t.child.memoizedState=Aa(i),t.memoizedState=za,o);if(!(t.mode&1))return Dl(e,t,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(J(419)),r=Oi(o,r,void 0),Dl(e,t,i,r)}if(a=(i&e.childLanes)!==0,zt||a){if(r=yt,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,$n(e,s),an(r,e,s,-1))}return Yc(),r=Oi(Error(J(421))),Dl(e,t,i,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Sv.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,Ot=tr(s.nextSibling),Dt=t,et=!0,ln=null,e!==null&&(Yt[qt++]=Pn,Yt[qt++]=_n,Yt[qt++]=Er,Pn=e.id,_n=e.overflow,Er=t),t=Vc(t,r.children),t.flags|=4096,t)}function Cd(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ea(e.return,t,n)}function Di(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function jh(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(Ct(e,t,r.children,n),r=rt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Cd(e,n,t);else if(e.tag===19)Cd(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ye(rt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&bo(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Di(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&bo(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Di(t,!0,n,null,o);break;case"together":Di(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ro(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Fn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Pr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,n=lr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=lr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function cv(e,t,n){switch(t.tag){case 3:wh(t),os();break;case 5:Qp(t);break;case 1:Tt(t.type)&&xo(t);break;case 4:Tc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ye(jo,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ye(rt,rt.current&1),t.flags|=128,null):n&t.child.childLanes?Sh(e,t,n):(Ye(rt,rt.current&1),e=Fn(e,t,n),e!==null?e.sibling:null);Ye(rt,rt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return jh(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ye(rt,rt.current),r)break;return null;case 22:case 23:return t.lanes=0,vh(e,t,n)}return Fn(e,t,n)}var Nh,Ta,kh,bh;Nh=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ta=function(){};kh=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,jr(wn.current);var o=null;switch(n){case"input":s=ra(e,s),r=ra(e,r),o=[];break;case"select":s=ot({},s,{value:void 0}),r=ot({},r,{value:void 0}),o=[];break;case"textarea":s=oa(e,s),r=oa(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=yo)}aa(n,r);var i;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Hs.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var u=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==a&&(u!=null||a!=null))if(d==="style")if(a){for(i in a)!a.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&a[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(o||(o=[]),o.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Hs.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Xe("scroll",e),o||a===u||(o=[])):(o=o||[]).push(d,u))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};bh=function(e,t,n,r){n!==r&&(t.flags|=4)};function bs(e,t){if(!et)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Nt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function uv(e,t,n){var r=t.pendingProps;switch(Lc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(t),null;case 1:return Tt(t.type)&&vo(),Nt(t),null;case 3:return r=t.stateNode,as(),Je(At),Je(bt),$c(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Fl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ln!==null&&(Va(ln),ln=null))),Ta(e,t),Nt(t),null;case 5:Mc(t);var s=jr(rl.current);if(n=t.type,e!==null&&t.stateNode!=null)kh(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(J(166));return Nt(t),null}if(e=jr(wn.current),Fl(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[hn]=t,r[tl]=o,e=(t.mode&1)!==0,n){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(s=0;s<Rs.length;s++)Xe(Rs[s],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":Tu(r,o),Xe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Xe("invalid",r);break;case"textarea":$u(r,o),Xe("invalid",r)}aa(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&$l(r.textContent,a,e),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&$l(r.textContent,a,e),s=["children",""+a]):Hs.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Xe("scroll",r)}switch(n){case"input":Pl(r),Mu(r,o,!0);break;case"textarea":Pl(r),Fu(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=yo)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Zf(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[hn]=t,e[tl]=r,Nh(e,t,!1,!1),t.stateNode=e;e:{switch(i=ca(n,r),n){case"dialog":Xe("cancel",e),Xe("close",e),s=r;break;case"iframe":case"object":case"embed":Xe("load",e),s=r;break;case"video":case"audio":for(s=0;s<Rs.length;s++)Xe(Rs[s],e);s=r;break;case"source":Xe("error",e),s=r;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),s=r;break;case"details":Xe("toggle",e),s=r;break;case"input":Tu(e,r),s=ra(e,r),Xe("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=ot({},r,{value:void 0}),Xe("invalid",e);break;case"textarea":$u(e,r),s=oa(e,r),Xe("invalid",e);break;default:s=r}aa(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="style"?np(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&ep(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Gs(e,u):typeof u=="number"&&Gs(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Hs.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Xe("scroll",e):u!=null&&pc(e,o,u,i))}switch(n){case"input":Pl(e),Mu(e,r,!1);break;case"textarea":Pl(e),Fu(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ir(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Xr(e,!!r.multiple,o,!1):r.defaultValue!=null&&Xr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=yo)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nt(t),null;case 6:if(e&&t.stateNode!=null)bh(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(J(166));if(n=jr(rl.current),jr(wn.current),Fl(t)){if(r=t.stateNode,n=t.memoizedProps,r[hn]=t,(o=r.nodeValue!==n)&&(e=Dt,e!==null))switch(e.tag){case 3:$l(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$l(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[hn]=t,t.stateNode=r}return Nt(t),null;case 13:if(Je(rt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(et&&Ot!==null&&t.mode&1&&!(t.flags&128))Vp(),os(),t.flags|=98560,o=!1;else if(o=Fl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(J(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(J(317));o[hn]=t}else os(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nt(t),o=!1}else ln!==null&&(Va(ln),ln=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||rt.current&1?pt===0&&(pt=3):Yc())),t.updateQueue!==null&&(t.flags|=4),Nt(t),null);case 4:return as(),Ta(e,t),e===null&&Zs(t.stateNode.containerInfo),Nt(t),null;case 10:return Ic(t.type._context),Nt(t),null;case 17:return Tt(t.type)&&vo(),Nt(t),null;case 19:if(Je(rt),o=t.memoizedState,o===null)return Nt(t),null;if(r=(t.flags&128)!==0,i=o.rendering,i===null)if(r)bs(o,!1);else{if(pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=bo(e),i!==null){for(t.flags|=128,bs(o,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ye(rt,rt.current&1|2),t.child}e=e.sibling}o.tail!==null&&ct()>us&&(t.flags|=128,r=!0,bs(o,!1),t.lanes=4194304)}else{if(!r)if(e=bo(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),bs(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!et)return Nt(t),null}else 2*ct()-o.renderingStartTime>us&&n!==1073741824&&(t.flags|=128,r=!0,bs(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(n=o.last,n!==null?n.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=ct(),t.sibling=null,n=rt.current,Ye(rt,r?n&1|2:n&1),t):(Nt(t),null);case 22:case 23:return Qc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?$t&1073741824&&(Nt(t),t.subtreeFlags&6&&(t.flags|=8192)):Nt(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function dv(e,t){switch(Lc(t),t.tag){case 1:return Tt(t.type)&&vo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return as(),Je(At),Je(bt),$c(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Mc(t),null;case 13:if(Je(rt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));os()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Je(rt),null;case 4:return as(),null;case 10:return Ic(t.type._context),null;case 22:case 23:return Qc(),null;case 24:return null;default:return null}}var Ul=!1,kt=!1,fv=typeof WeakSet=="function"?WeakSet:Set,he=null;function Yr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){at(e,t,r)}else n.current=null}function Ma(e,t,n){try{n()}catch(r){at(e,t,r)}}var Ed=!1;function pv(e,t){if(xa=ho,e=_p(),Cc(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,u=-1,d=0,g=0,y=e,m=null;t:for(;;){for(var x;y!==n||s!==0&&y.nodeType!==3||(a=i+s),y!==o||r!==0&&y.nodeType!==3||(u=i+r),y.nodeType===3&&(i+=y.nodeValue.length),(x=y.firstChild)!==null;)m=y,y=x;for(;;){if(y===e)break t;if(m===n&&++d===s&&(a=i),m===o&&++g===r&&(u=i),(x=y.nextSibling)!==null)break;y=m,m=y.parentNode}y=x}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(wa={focusedElem:e,selectionRange:n},ho=!1,he=t;he!==null;)if(t=he,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,he=e;else for(;he!==null;){t=he;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var j=w.memoizedProps,S=w.memoizedState,h=t.stateNode,f=h.getSnapshotBeforeUpdate(t.elementType===t.type?j:rn(t.type,j),S);h.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(v){at(t,t.return,v)}if(e=t.sibling,e!==null){e.return=t.return,he=e;break}he=t.return}return w=Ed,Ed=!1,w}function Ds(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&Ma(t,n,o)}s=s.next}while(s!==r)}}function Zo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function $a(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ch(e){var t=e.alternate;t!==null&&(e.alternate=null,Ch(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[hn],delete t[tl],delete t[Na],delete t[Yy],delete t[qy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Eh(e){return e.tag===5||e.tag===3||e.tag===4}function Ld(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Eh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fa(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=yo));else if(r!==4&&(e=e.child,e!==null))for(Fa(e,t,n),e=e.sibling;e!==null;)Fa(e,t,n),e=e.sibling}function Oa(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Oa(e,t,n),e=e.sibling;e!==null;)Oa(e,t,n),e=e.sibling}var vt=null,sn=!1;function Wn(e,t,n){for(n=n.child;n!==null;)Lh(e,t,n),n=n.sibling}function Lh(e,t,n){if(xn&&typeof xn.onCommitFiberUnmount=="function")try{xn.onCommitFiberUnmount(Ho,n)}catch{}switch(n.tag){case 5:kt||Yr(n,t);case 6:var r=vt,s=sn;vt=null,Wn(e,t,n),vt=r,sn=s,vt!==null&&(sn?(e=vt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):vt.removeChild(n.stateNode));break;case 18:vt!==null&&(sn?(e=vt,n=n.stateNode,e.nodeType===8?zi(e.parentNode,n):e.nodeType===1&&zi(e,n),qs(e)):zi(vt,n.stateNode));break;case 4:r=vt,s=sn,vt=n.stateNode.containerInfo,sn=!0,Wn(e,t,n),vt=r,sn=s;break;case 0:case 11:case 14:case 15:if(!kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Ma(n,t,i),s=s.next}while(s!==r)}Wn(e,t,n);break;case 1:if(!kt&&(Yr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){at(n,t,a)}Wn(e,t,n);break;case 21:Wn(e,t,n);break;case 22:n.mode&1?(kt=(r=kt)||n.memoizedState!==null,Wn(e,t,n),kt=r):Wn(e,t,n);break;default:Wn(e,t,n)}}function Pd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new fv),t.forEach(function(r){var s=jv.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function tn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,i=t,a=i;e:for(;a!==null;){switch(a.tag){case 5:vt=a.stateNode,sn=!1;break e;case 3:vt=a.stateNode.containerInfo,sn=!0;break e;case 4:vt=a.stateNode.containerInfo,sn=!0;break e}a=a.return}if(vt===null)throw Error(J(160));Lh(o,i,s),vt=null,sn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){at(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ph(t,e),t=t.sibling}function Ph(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(tn(t,e),dn(e),r&4){try{Ds(3,e,e.return),Zo(3,e)}catch(j){at(e,e.return,j)}try{Ds(5,e,e.return)}catch(j){at(e,e.return,j)}}break;case 1:tn(t,e),dn(e),r&512&&n!==null&&Yr(n,n.return);break;case 5:if(tn(t,e),dn(e),r&512&&n!==null&&Yr(n,n.return),e.flags&32){var s=e.stateNode;try{Gs(s,"")}catch(j){at(e,e.return,j)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=n!==null?n.memoizedProps:o,a=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Xf(s,o),ca(a,i);var d=ca(a,o);for(i=0;i<u.length;i+=2){var g=u[i],y=u[i+1];g==="style"?np(s,y):g==="dangerouslySetInnerHTML"?ep(s,y):g==="children"?Gs(s,y):pc(s,g,y,d)}switch(a){case"input":sa(s,o);break;case"textarea":Jf(s,o);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var x=o.value;x!=null?Xr(s,!!o.multiple,x,!1):m!==!!o.multiple&&(o.defaultValue!=null?Xr(s,!!o.multiple,o.defaultValue,!0):Xr(s,!!o.multiple,o.multiple?[]:"",!1))}s[tl]=o}catch(j){at(e,e.return,j)}}break;case 6:if(tn(t,e),dn(e),r&4){if(e.stateNode===null)throw Error(J(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(j){at(e,e.return,j)}}break;case 3:if(tn(t,e),dn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qs(t.containerInfo)}catch(j){at(e,e.return,j)}break;case 4:tn(t,e),dn(e);break;case 13:tn(t,e),dn(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Gc=ct())),r&4&&Pd(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(kt=(d=kt)||g,tn(t,e),kt=d):tn(t,e),dn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!g&&e.mode&1)for(he=e,g=e.child;g!==null;){for(y=he=g;he!==null;){switch(m=he,x=m.child,m.tag){case 0:case 11:case 14:case 15:Ds(4,m,m.return);break;case 1:Yr(m,m.return);var w=m.stateNode;if(typeof w.componentWillUnmount=="function"){r=m,n=m.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(j){at(r,n,j)}}break;case 5:Yr(m,m.return);break;case 22:if(m.memoizedState!==null){Rd(y);continue}}x!==null?(x.return=m,he=x):Rd(y)}g=g.sibling}e:for(g=null,y=e;;){if(y.tag===5){if(g===null){g=y;try{s=y.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=y.stateNode,u=y.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=tp("display",i))}catch(j){at(e,e.return,j)}}}else if(y.tag===6){if(g===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(j){at(e,e.return,j)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===e)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===e)break e;for(;y.sibling===null;){if(y.return===null||y.return===e)break e;g===y&&(g=null),y=y.return}g===y&&(g=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:tn(t,e),dn(e),r&4&&Pd(e);break;case 21:break;default:tn(t,e),dn(e)}}function dn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Eh(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Gs(s,""),r.flags&=-33);var o=Ld(e);Oa(e,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=Ld(e);Fa(e,a,i);break;default:throw Error(J(161))}}catch(u){at(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function hv(e,t,n){he=e,_h(e)}function _h(e,t,n){for(var r=(e.mode&1)!==0;he!==null;){var s=he,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Ul;if(!i){var a=s.alternate,u=a!==null&&a.memoizedState!==null||kt;a=Ul;var d=kt;if(Ul=i,(kt=u)&&!d)for(he=s;he!==null;)i=he,u=i.child,i.tag===22&&i.memoizedState!==null?Id(s):u!==null?(u.return=i,he=u):Id(s);for(;o!==null;)he=o,_h(o),o=o.sibling;he=s,Ul=a,kt=d}_d(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,he=o):_d(e)}}function _d(e){for(;he!==null;){var t=he;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:kt||Zo(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!kt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:rn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&hd(t,o,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}hd(t,i,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var g=d.memoizedState;if(g!==null){var y=g.dehydrated;y!==null&&qs(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}kt||t.flags&512&&$a(t)}catch(m){at(t,t.return,m)}}if(t===e){he=null;break}if(n=t.sibling,n!==null){n.return=t.return,he=n;break}he=t.return}}function Rd(e){for(;he!==null;){var t=he;if(t===e){he=null;break}var n=t.sibling;if(n!==null){n.return=t.return,he=n;break}he=t.return}}function Id(e){for(;he!==null;){var t=he;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Zo(4,t)}catch(u){at(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){at(t,s,u)}}var o=t.return;try{$a(t)}catch(u){at(t,o,u)}break;case 5:var i=t.return;try{$a(t)}catch(u){at(t,i,u)}}}catch(u){at(t,t.return,u)}if(t===e){he=null;break}var a=t.sibling;if(a!==null){a.return=t.return,he=a;break}he=t.return}}var mv=Math.ceil,Lo=On.ReactCurrentDispatcher,Wc=On.ReactCurrentOwner,Jt=On.ReactCurrentBatchConfig,Ve=0,yt=null,dt=null,xt=0,$t=0,qr=pr(0),pt=0,il=null,Pr=0,ei=0,Hc=0,Us=null,It=null,Gc=0,us=1/0,Cn=null,Po=!1,Da=null,rr=null,Bl=!1,qn=null,_o=0,Bs=0,Ua=null,so=-1,lo=0;function Et(){return Ve&6?ct():so!==-1?so:so=ct()}function sr(e){return e.mode&1?Ve&2&&xt!==0?xt&-xt:Jy.transition!==null?(lo===0&&(lo=hp()),lo):(e=Qe,e!==0||(e=window.event,e=e===void 0?16:Sp(e.type)),e):1}function an(e,t,n,r){if(50<Bs)throw Bs=0,Ua=null,Error(J(185));pl(e,n,r),(!(Ve&2)||e!==yt)&&(e===yt&&(!(Ve&2)&&(ei|=n),pt===4&&Qn(e,xt)),Mt(e,r),n===1&&Ve===0&&!(t.mode&1)&&(us=ct()+500,qo&&hr()))}function Mt(e,t){var n=e.callbackNode;Jg(e,t);var r=po(e,e===yt?xt:0);if(r===0)n!==null&&Uu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Uu(n),t===1)e.tag===0?Xy(zd.bind(null,e)):Dp(zd.bind(null,e)),Ky(function(){!(Ve&6)&&hr()}),n=null;else{switch(mp(r)){case 1:n=vc;break;case 4:n=fp;break;case 16:n=fo;break;case 536870912:n=pp;break;default:n=fo}n=Fh(n,Rh.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Rh(e,t){if(so=-1,lo=0,Ve&6)throw Error(J(327));var n=e.callbackNode;if(ns()&&e.callbackNode!==n)return null;var r=po(e,e===yt?xt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ro(e,r);else{t=r;var s=Ve;Ve|=2;var o=zh();(yt!==e||xt!==t)&&(Cn=null,us=ct()+500,Nr(e,t));do try{vv();break}catch(a){Ih(e,a)}while(!0);Rc(),Lo.current=o,Ve=s,dt!==null?t=0:(yt=null,xt=0,t=pt)}if(t!==0){if(t===2&&(s=ha(e),s!==0&&(r=s,t=Ba(e,s))),t===1)throw n=il,Nr(e,0),Qn(e,r),Mt(e,ct()),n;if(t===6)Qn(e,r);else{if(s=e.current.alternate,!(r&30)&&!gv(s)&&(t=Ro(e,r),t===2&&(o=ha(e),o!==0&&(r=o,t=Ba(e,o))),t===1))throw n=il,Nr(e,0),Qn(e,r),Mt(e,ct()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(J(345));case 2:vr(e,It,Cn);break;case 3:if(Qn(e,r),(r&130023424)===r&&(t=Gc+500-ct(),10<t)){if(po(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Et(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ja(vr.bind(null,e,It,Cn),t);break}vr(e,It,Cn);break;case 4:if(Qn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var i=31-on(r);o=1<<i,i=t[i],i>s&&(s=i),r&=~o}if(r=s,r=ct()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*mv(r/1960))-r,10<r){e.timeoutHandle=ja(vr.bind(null,e,It,Cn),r);break}vr(e,It,Cn);break;case 5:vr(e,It,Cn);break;default:throw Error(J(329))}}}return Mt(e,ct()),e.callbackNode===n?Rh.bind(null,e):null}function Ba(e,t){var n=Us;return e.current.memoizedState.isDehydrated&&(Nr(e,t).flags|=256),e=Ro(e,t),e!==2&&(t=It,It=n,t!==null&&Va(t)),e}function Va(e){It===null?It=e:It.push.apply(It,e)}function gv(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!cn(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qn(e,t){for(t&=~Hc,t&=~ei,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-on(t),r=1<<n;e[n]=-1,t&=~r}}function zd(e){if(Ve&6)throw Error(J(327));ns();var t=po(e,0);if(!(t&1))return Mt(e,ct()),null;var n=Ro(e,t);if(e.tag!==0&&n===2){var r=ha(e);r!==0&&(t=r,n=Ba(e,r))}if(n===1)throw n=il,Nr(e,0),Qn(e,t),Mt(e,ct()),n;if(n===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vr(e,It,Cn),Mt(e,ct()),null}function Kc(e,t){var n=Ve;Ve|=1;try{return e(t)}finally{Ve=n,Ve===0&&(us=ct()+500,qo&&hr())}}function _r(e){qn!==null&&qn.tag===0&&!(Ve&6)&&ns();var t=Ve;Ve|=1;var n=Jt.transition,r=Qe;try{if(Jt.transition=null,Qe=1,e)return e()}finally{Qe=r,Jt.transition=n,Ve=t,!(Ve&6)&&hr()}}function Qc(){$t=qr.current,Je(qr)}function Nr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Gy(n)),dt!==null)for(n=dt.return;n!==null;){var r=n;switch(Lc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vo();break;case 3:as(),Je(At),Je(bt),$c();break;case 5:Mc(r);break;case 4:as();break;case 13:Je(rt);break;case 19:Je(rt);break;case 10:Ic(r.type._context);break;case 22:case 23:Qc()}n=n.return}if(yt=e,dt=e=lr(e.current,null),xt=$t=t,pt=0,il=null,Hc=ei=Pr=0,It=Us=null,Sr!==null){for(t=0;t<Sr.length;t++)if(n=Sr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}Sr=null}return e}function Ih(e,t){do{var n=dt;try{if(Rc(),to.current=Eo,Co){for(var r=st.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Co=!1}if(Lr=0,gt=ft=st=null,Os=!1,sl=0,Wc.current=null,n===null||n.return===null){pt=1,il=t,dt=null;break}e:{var o=e,i=n.return,a=n,u=t;if(t=xt,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,g=a,y=g.tag;if(!(g.mode&1)&&(y===0||y===11||y===15)){var m=g.alternate;m?(g.updateQueue=m.updateQueue,g.memoizedState=m.memoizedState,g.lanes=m.lanes):(g.updateQueue=null,g.memoizedState=null)}var x=wd(i);if(x!==null){x.flags&=-257,Sd(x,i,a,o,t),x.mode&1&&xd(o,d,t),t=x,u=d;var w=t.updateQueue;if(w===null){var j=new Set;j.add(u),t.updateQueue=j}else w.add(u);break e}else{if(!(t&1)){xd(o,d,t),Yc();break e}u=Error(J(426))}}else if(et&&a.mode&1){var S=wd(i);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Sd(S,i,a,o,t),Pc(cs(u,a));break e}}o=u=cs(u,a),pt!==4&&(pt=2),Us===null?Us=[o]:Us.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var h=mh(o,u,t);pd(o,h);break e;case 1:a=u;var f=o.type,p=o.stateNode;if(!(o.flags&128)&&(typeof f.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(rr===null||!rr.has(p)))){o.flags|=65536,t&=-t,o.lanes|=t;var v=gh(o,a,t);pd(o,v);break e}}o=o.return}while(o!==null)}Th(n)}catch(b){t=b,dt===n&&n!==null&&(dt=n=n.return);continue}break}while(!0)}function zh(){var e=Lo.current;return Lo.current=Eo,e===null?Eo:e}function Yc(){(pt===0||pt===3||pt===2)&&(pt=4),yt===null||!(Pr&268435455)&&!(ei&268435455)||Qn(yt,xt)}function Ro(e,t){var n=Ve;Ve|=2;var r=zh();(yt!==e||xt!==t)&&(Cn=null,Nr(e,t));do try{yv();break}catch(s){Ih(e,s)}while(!0);if(Rc(),Ve=n,Lo.current=r,dt!==null)throw Error(J(261));return yt=null,xt=0,pt}function yv(){for(;dt!==null;)Ah(dt)}function vv(){for(;dt!==null&&!Vg();)Ah(dt)}function Ah(e){var t=$h(e.alternate,e,$t);e.memoizedProps=e.pendingProps,t===null?Th(e):dt=t,Wc.current=null}function Th(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=dv(n,t),n!==null){n.flags&=32767,dt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pt=6,dt=null;return}}else if(n=uv(n,t,$t),n!==null){dt=n;return}if(t=t.sibling,t!==null){dt=t;return}dt=t=e}while(t!==null);pt===0&&(pt=5)}function vr(e,t,n){var r=Qe,s=Jt.transition;try{Jt.transition=null,Qe=1,xv(e,t,n,r)}finally{Jt.transition=s,Qe=r}return null}function xv(e,t,n,r){do ns();while(qn!==null);if(Ve&6)throw Error(J(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Zg(e,o),e===yt&&(dt=yt=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bl||(Bl=!0,Fh(fo,function(){return ns(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Jt.transition,Jt.transition=null;var i=Qe;Qe=1;var a=Ve;Ve|=4,Wc.current=null,pv(e,n),Ph(n,e),Oy(wa),ho=!!xa,wa=xa=null,e.current=n,hv(n),Wg(),Ve=a,Qe=i,Jt.transition=o}else e.current=n;if(Bl&&(Bl=!1,qn=e,_o=s),o=e.pendingLanes,o===0&&(rr=null),Kg(n.stateNode),Mt(e,ct()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Po)throw Po=!1,e=Da,Da=null,e;return _o&1&&e.tag!==0&&ns(),o=e.pendingLanes,o&1?e===Ua?Bs++:(Bs=0,Ua=e):Bs=0,hr(),null}function ns(){if(qn!==null){var e=mp(_o),t=Jt.transition,n=Qe;try{if(Jt.transition=null,Qe=16>e?16:e,qn===null)var r=!1;else{if(e=qn,qn=null,_o=0,Ve&6)throw Error(J(331));var s=Ve;for(Ve|=4,he=e.current;he!==null;){var o=he,i=o.child;if(he.flags&16){var a=o.deletions;if(a!==null){for(var u=0;u<a.length;u++){var d=a[u];for(he=d;he!==null;){var g=he;switch(g.tag){case 0:case 11:case 15:Ds(8,g,o)}var y=g.child;if(y!==null)y.return=g,he=y;else for(;he!==null;){g=he;var m=g.sibling,x=g.return;if(Ch(g),g===d){he=null;break}if(m!==null){m.return=x,he=m;break}he=x}}}var w=o.alternate;if(w!==null){var j=w.child;if(j!==null){w.child=null;do{var S=j.sibling;j.sibling=null,j=S}while(j!==null)}}he=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,he=i;else e:for(;he!==null;){if(o=he,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ds(9,o,o.return)}var h=o.sibling;if(h!==null){h.return=o.return,he=h;break e}he=o.return}}var f=e.current;for(he=f;he!==null;){i=he;var p=i.child;if(i.subtreeFlags&2064&&p!==null)p.return=i,he=p;else e:for(i=f;he!==null;){if(a=he,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Zo(9,a)}}catch(b){at(a,a.return,b)}if(a===i){he=null;break e}var v=a.sibling;if(v!==null){v.return=a.return,he=v;break e}he=a.return}}if(Ve=s,hr(),xn&&typeof xn.onPostCommitFiberRoot=="function")try{xn.onPostCommitFiberRoot(Ho,e)}catch{}r=!0}return r}finally{Qe=n,Jt.transition=t}}return!1}function Ad(e,t,n){t=cs(n,t),t=mh(e,t,1),e=nr(e,t,1),t=Et(),e!==null&&(pl(e,1,t),Mt(e,t))}function at(e,t,n){if(e.tag===3)Ad(e,e,n);else for(;t!==null;){if(t.tag===3){Ad(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(rr===null||!rr.has(r))){e=cs(n,e),e=gh(t,e,1),t=nr(t,e,1),e=Et(),t!==null&&(pl(t,1,e),Mt(t,e));break}}t=t.return}}function wv(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Et(),e.pingedLanes|=e.suspendedLanes&n,yt===e&&(xt&n)===n&&(pt===4||pt===3&&(xt&130023424)===xt&&500>ct()-Gc?Nr(e,0):Hc|=n),Mt(e,t)}function Mh(e,t){t===0&&(e.mode&1?(t=Il,Il<<=1,!(Il&130023424)&&(Il=4194304)):t=1);var n=Et();e=$n(e,t),e!==null&&(pl(e,t,n),Mt(e,n))}function Sv(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Mh(e,n)}function jv(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(t),Mh(e,n)}var $h;$h=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||At.current)zt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return zt=!1,cv(e,t,n);zt=!!(e.flags&131072)}else zt=!1,et&&t.flags&1048576&&Up(t,So,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ro(e,t),e=t.pendingProps;var s=ls(t,bt.current);ts(t,n),s=Oc(null,t,r,e,s,n);var o=Dc();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Tt(r)?(o=!0,xo(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ac(t),s.updater=Jo,t.stateNode=s,s._reactInternals=t,Pa(t,r,e,n),t=Ia(null,t,r,!0,o,n)):(t.tag=0,et&&o&&Ec(t),Ct(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ro(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=kv(r),e=rn(r,e),s){case 0:t=Ra(null,t,r,e,n);break e;case 1:t=kd(null,t,r,e,n);break e;case 11:t=jd(null,t,r,e,n);break e;case 14:t=Nd(null,t,r,rn(r.type,e),n);break e}throw Error(J(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:rn(r,s),Ra(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:rn(r,s),kd(e,t,r,s,n);case 3:e:{if(wh(t),e===null)throw Error(J(387));r=t.pendingProps,o=t.memoizedState,s=o.element,Kp(e,t),ko(t,r,null,n);var i=t.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=cs(Error(J(423)),t),t=bd(e,t,r,n,s);break e}else if(r!==s){s=cs(Error(J(424)),t),t=bd(e,t,r,n,s);break e}else for(Ot=tr(t.stateNode.containerInfo.firstChild),Dt=t,et=!0,ln=null,n=Hp(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(os(),r===s){t=Fn(e,t,n);break e}Ct(e,t,r,n)}t=t.child}return t;case 5:return Qp(t),e===null&&Ca(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,Sa(r,s)?i=null:o!==null&&Sa(r,o)&&(t.flags|=32),xh(e,t),Ct(e,t,i,n),t.child;case 6:return e===null&&Ca(t),null;case 13:return Sh(e,t,n);case 4:return Tc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=is(t,null,r,n):Ct(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:rn(r,s),jd(e,t,r,s,n);case 7:return Ct(e,t,t.pendingProps,n),t.child;case 8:return Ct(e,t,t.pendingProps.children,n),t.child;case 12:return Ct(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,Ye(jo,r._currentValue),r._currentValue=i,o!==null)if(cn(o.value,i)){if(o.children===s.children&&!At.current){t=Fn(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=zn(-1,n&-n),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var g=d.pending;g===null?u.next=u:(u.next=g.next,g.next=u),d.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Ea(o.return,n,t),a.lanes|=n;break}u=u.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(J(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),Ea(i,n,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Ct(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ts(t,n),s=Zt(s),r=r(s),t.flags|=1,Ct(e,t,r,n),t.child;case 14:return r=t.type,s=rn(r,t.pendingProps),s=rn(r.type,s),Nd(e,t,r,s,n);case 15:return yh(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:rn(r,s),ro(e,t),t.tag=1,Tt(r)?(e=!0,xo(t)):e=!1,ts(t,n),hh(t,r,s),Pa(t,r,s,n),Ia(null,t,r,!0,e,n);case 19:return jh(e,t,n);case 22:return vh(e,t,n)}throw Error(J(156,t.tag))};function Fh(e,t){return dp(e,t)}function Nv(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(e,t,n,r){return new Nv(e,t,n,r)}function qc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function kv(e){if(typeof e=="function")return qc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===mc)return 11;if(e===gc)return 14}return 2}function lr(e,t){var n=e.alternate;return n===null?(n=Xt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function oo(e,t,n,r,s,o){var i=2;if(r=e,typeof e=="function")qc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Dr:return kr(n.children,s,o,t);case hc:i=8,s|=8;break;case Zi:return e=Xt(12,n,t,s|2),e.elementType=Zi,e.lanes=o,e;case ea:return e=Xt(13,n,t,s),e.elementType=ea,e.lanes=o,e;case ta:return e=Xt(19,n,t,s),e.elementType=ta,e.lanes=o,e;case Qf:return ti(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Gf:i=10;break e;case Kf:i=9;break e;case mc:i=11;break e;case gc:i=14;break e;case Hn:i=16,r=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=Xt(i,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function kr(e,t,n,r){return e=Xt(7,e,r,t),e.lanes=n,e}function ti(e,t,n,r){return e=Xt(22,e,r,t),e.elementType=Qf,e.lanes=n,e.stateNode={isHidden:!1},e}function Ui(e,t,n){return e=Xt(6,e,null,t),e.lanes=n,e}function Bi(e,t,n){return t=Xt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function bv(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ji(0),this.expirationTimes=ji(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ji(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Xc(e,t,n,r,s,o,i,a,u){return e=new bv(e,t,n,a,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Xt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ac(o),e}function Cv(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Or,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Oh(e){if(!e)return ar;e=e._reactInternals;e:{if(Ir(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Tt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var n=e.type;if(Tt(n))return Op(e,n,t)}return t}function Dh(e,t,n,r,s,o,i,a,u){return e=Xc(n,r,!0,e,s,o,i,a,u),e.context=Oh(null),n=e.current,r=Et(),s=sr(n),o=zn(r,s),o.callback=t??null,nr(n,o,s),e.current.lanes=s,pl(e,s,r),Mt(e,r),e}function ni(e,t,n,r){var s=t.current,o=Et(),i=sr(s);return n=Oh(n),t.context===null?t.context=n:t.pendingContext=n,t=zn(o,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=nr(s,t,i),e!==null&&(an(e,s,i,o),eo(e,s,i)),i}function Io(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Td(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Jc(e,t){Td(e,t),(e=e.alternate)&&Td(e,t)}function Ev(){return null}var Uh=typeof reportError=="function"?reportError:function(e){console.error(e)};function Zc(e){this._internalRoot=e}ri.prototype.render=Zc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));ni(e,t,null,null)};ri.prototype.unmount=Zc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;_r(function(){ni(null,e,null,null)}),t[Mn]=null}};function ri(e){this._internalRoot=e}ri.prototype.unstable_scheduleHydration=function(e){if(e){var t=vp();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Kn.length&&t!==0&&t<Kn[n].priority;n++);Kn.splice(n,0,e),n===0&&wp(e)}};function eu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function si(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Md(){}function Lv(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var d=Io(i);o.call(d)}}var i=Dh(t,r,e,0,null,!1,!1,"",Md);return e._reactRootContainer=i,e[Mn]=i.current,Zs(e.nodeType===8?e.parentNode:e),_r(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Io(u);a.call(d)}}var u=Xc(e,0,!1,null,null,!1,!1,"",Md);return e._reactRootContainer=u,e[Mn]=u.current,Zs(e.nodeType===8?e.parentNode:e),_r(function(){ni(t,u,n,r)}),u}function li(e,t,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var u=Io(i);a.call(u)}}ni(t,i,e,s)}else i=Lv(n,t,e,s,r);return Io(i)}gp=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=_s(t.pendingLanes);n!==0&&(xc(t,n|1),Mt(t,ct()),!(Ve&6)&&(us=ct()+500,hr()))}break;case 13:_r(function(){var r=$n(e,1);if(r!==null){var s=Et();an(r,e,1,s)}}),Jc(e,1)}};wc=function(e){if(e.tag===13){var t=$n(e,134217728);if(t!==null){var n=Et();an(t,e,134217728,n)}Jc(e,134217728)}};yp=function(e){if(e.tag===13){var t=sr(e),n=$n(e,t);if(n!==null){var r=Et();an(n,e,t,r)}Jc(e,t)}};vp=function(){return Qe};xp=function(e,t){var n=Qe;try{return Qe=e,t()}finally{Qe=n}};da=function(e,t,n){switch(t){case"input":if(sa(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Yo(r);if(!s)throw Error(J(90));qf(r),sa(r,s)}}}break;case"textarea":Jf(e,n);break;case"select":t=n.value,t!=null&&Xr(e,!!n.multiple,t,!1)}};lp=Kc;op=_r;var Pv={usingClientEntryPoint:!1,Events:[ml,Wr,Yo,rp,sp,Kc]},Cs={findFiberByHostInstance:wr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_v={bundleType:Cs.bundleType,version:Cs.version,rendererPackageName:Cs.rendererPackageName,rendererConfig:Cs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:On.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=cp(e),e===null?null:e.stateNode},findFiberByHostInstance:Cs.findFiberByHostInstance||Ev,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vl.isDisabled&&Vl.supportsFiber)try{Ho=Vl.inject(_v),xn=Vl}catch{}}Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pv;Bt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!eu(t))throw Error(J(200));return Cv(e,t,null,n)};Bt.createRoot=function(e,t){if(!eu(e))throw Error(J(299));var n=!1,r="",s=Uh;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Xc(e,1,!1,null,null,n,!1,r,s),e[Mn]=t.current,Zs(e.nodeType===8?e.parentNode:e),new Zc(t)};Bt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=cp(t),e=e===null?null:e.stateNode,e};Bt.flushSync=function(e){return _r(e)};Bt.hydrate=function(e,t,n){if(!si(t))throw Error(J(200));return li(null,e,t,!0,n)};Bt.hydrateRoot=function(e,t,n){if(!eu(e))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=Uh;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=Dh(t,null,e,1,n??null,s,!1,o,i),e[Mn]=t.current,Zs(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new ri(t)};Bt.render=function(e,t,n){if(!si(t))throw Error(J(200));return li(null,e,t,!1,n)};Bt.unmountComponentAtNode=function(e){if(!si(e))throw Error(J(40));return e._reactRootContainer?(_r(function(){li(null,null,e,!1,function(){e._reactRootContainer=null,e[Mn]=null})}),!0):!1};Bt.unstable_batchedUpdates=Kc;Bt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!si(n))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return li(e,t,n,!1,r)};Bt.version="18.3.1-next-f1338f8080-20240426";function Bh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bh)}catch(e){console.error(e)}}Bh(),Bf.exports=Bt;var tu=Bf.exports,$d=tu;Xi.createRoot=$d.createRoot,Xi.hydrateRoot=$d.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function al(){return al=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},al.apply(this,arguments)}var Xn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Xn||(Xn={}));const Fd="popstate";function Rv(e){e===void 0&&(e={});function t(s,o){let{pathname:i="/",search:a="",hash:u=""}=zr(s.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),Wa("",{pathname:i,search:a,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){let i=s.document.querySelector("base"),a="";if(i&&i.getAttribute("href")){let u=s.location.href,d=u.indexOf("#");a=d===-1?u:u.slice(0,d)}return a+"#"+(typeof o=="string"?o:zo(o))}function r(s,o){nu(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return zv(t,n,r,e)}function lt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nu(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Iv(){return Math.random().toString(36).substr(2,8)}function Od(e,t){return{usr:e.state,key:e.key,idx:t}}function Wa(e,t,n,r){return n===void 0&&(n=null),al({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?zr(t):t,{state:n,key:t&&t.key||r||Iv()})}function zo(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function zr(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function zv(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,i=s.history,a=Xn.Pop,u=null,d=g();d==null&&(d=0,i.replaceState(al({},i.state,{idx:d}),""));function g(){return(i.state||{idx:null}).idx}function y(){a=Xn.Pop;let S=g(),h=S==null?null:S-d;d=S,u&&u({action:a,location:j.location,delta:h})}function m(S,h){a=Xn.Push;let f=Wa(j.location,S,h);n&&n(f,S),d=g()+1;let p=Od(f,d),v=j.createHref(f);try{i.pushState(p,"",v)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;s.location.assign(v)}o&&u&&u({action:a,location:j.location,delta:1})}function x(S,h){a=Xn.Replace;let f=Wa(j.location,S,h);n&&n(f,S),d=g();let p=Od(f,d),v=j.createHref(f);i.replaceState(p,"",v),o&&u&&u({action:a,location:j.location,delta:0})}function w(S){let h=s.location.origin!=="null"?s.location.origin:s.location.href,f=typeof S=="string"?S:zo(S);return f=f.replace(/ $/,"%20"),lt(h,"No window.location.(origin|href) available to create URL for href: "+f),new URL(f,h)}let j={get action(){return a},get location(){return e(s,i)},listen(S){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Fd,y),u=S,()=>{s.removeEventListener(Fd,y),u=null}},createHref(S){return t(s,S)},createURL:w,encodeLocation(S){let h=w(S);return{pathname:h.pathname,search:h.search,hash:h.hash}},push:m,replace:x,go(S){return i.go(S)}};return j}var Dd;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Dd||(Dd={}));function Av(e,t,n){return n===void 0&&(n="/"),Tv(e,t,n)}function Tv(e,t,n,r){let s=typeof t=="string"?zr(t):t,o=ds(s.pathname||"/",n);if(o==null)return null;let i=Vh(e);Mv(i);let a=null;for(let u=0;a==null&&u<i.length;++u){let d=Kv(o);a=Hv(i[u],d)}return a}function Vh(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,i,a)=>{let u={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};u.relativePath.startsWith("/")&&(lt(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=or([r,u.relativePath]),g=n.concat(u);o.children&&o.children.length>0&&(lt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Vh(o.children,t,g,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:Vv(d,o.index),routesMeta:g})};return e.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))s(o,i);else for(let u of Wh(o.path))s(o,i,u)}),t}function Wh(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let i=Wh(r.join("/")),a=[];return a.push(...i.map(u=>u===""?o:[o,u].join("/"))),s&&a.push(...i),a.map(u=>e.startsWith("/")&&u===""?"/":u)}function Mv(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Wv(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const $v=/^:[\w-]+$/,Fv=3,Ov=2,Dv=1,Uv=10,Bv=-2,Ud=e=>e==="*";function Vv(e,t){let n=e.split("/"),r=n.length;return n.some(Ud)&&(r+=Bv),t&&(r+=Ov),n.filter(s=>!Ud(s)).reduce((s,o)=>s+($v.test(o)?Fv:o===""?Dv:Uv),r)}function Wv(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function Hv(e,t,n){let{routesMeta:r}=e,s={},o="/",i=[];for(let a=0;a<r.length;++a){let u=r[a],d=a===r.length-1,g=o==="/"?t:t.slice(o.length)||"/",y=Ha({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},g),m=u.route;if(!y)return null;Object.assign(s,y.params),i.push({params:s,pathname:or([o,y.pathname]),pathnameBase:Xv(or([o,y.pathnameBase])),route:m}),y.pathnameBase!=="/"&&(o=or([o,y.pathnameBase]))}return i}function Ha(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Gv(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((d,g,y)=>{let{paramName:m,isOptional:x}=g;if(m==="*"){let j=a[y]||"";i=o.slice(0,o.length-j.length).replace(/(.)\/+$/,"$1")}const w=a[y];return x&&!w?d[m]=void 0:d[m]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:i,pattern:e}}function Gv(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),nu(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,u)=>(r.push({paramName:a,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function Kv(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nu(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ds(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Qv(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?zr(e):e;return{pathname:n?n.startsWith("/")?n:Yv(n,t):t,search:Jv(r),hash:Zv(s)}}function Yv(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Vi(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function qv(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function ru(e,t){let n=qv(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function su(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=zr(e):(s=al({},e),lt(!s.pathname||!s.pathname.includes("?"),Vi("?","pathname","search",s)),lt(!s.pathname||!s.pathname.includes("#"),Vi("#","pathname","hash",s)),lt(!s.search||!s.search.includes("#"),Vi("#","search","hash",s)));let o=e===""||s.pathname==="",i=o?"/":s.pathname,a;if(i==null)a=n;else{let y=t.length-1;if(!r&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),y-=1;s.pathname=m.join("/")}a=y>=0?t[y]:"/"}let u=Qv(s,a),d=i&&i!=="/"&&i.endsWith("/"),g=(o||i===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||g)&&(u.pathname+="/"),u}const or=e=>e.join("/").replace(/\/\/+/g,"/"),Xv=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Jv=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Zv=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ex(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Hh=["post","put","patch","delete"];new Set(Hh);const tx=["get",...Hh];new Set(tx);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cl(){return cl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cl.apply(this,arguments)}const oi=c.createContext(null),Gh=c.createContext(null),Dn=c.createContext(null),ii=c.createContext(null),Un=c.createContext({outlet:null,matches:[],isDataRoute:!1}),Kh=c.createContext(null);function nx(e,t){let{relative:n}=t===void 0?{}:t;gs()||lt(!1);let{basename:r,navigator:s}=c.useContext(Dn),{hash:o,pathname:i,search:a}=ai(e,{relative:n}),u=i;return r!=="/"&&(u=i==="/"?r:or([r,i])),s.createHref({pathname:u,search:a,hash:o})}function gs(){return c.useContext(ii)!=null}function Wt(){return gs()||lt(!1),c.useContext(ii).location}function Qh(e){c.useContext(Dn).static||c.useLayoutEffect(e)}function jn(){let{isDataRoute:e}=c.useContext(Un);return e?yx():rx()}function rx(){gs()||lt(!1);let e=c.useContext(oi),{basename:t,future:n,navigator:r}=c.useContext(Dn),{matches:s}=c.useContext(Un),{pathname:o}=Wt(),i=JSON.stringify(ru(s,n.v7_relativeSplatPath)),a=c.useRef(!1);return Qh(()=>{a.current=!0}),c.useCallback(function(d,g){if(g===void 0&&(g={}),!a.current)return;if(typeof d=="number"){r.go(d);return}let y=su(d,JSON.parse(i),o,g.relative==="path");e==null&&t!=="/"&&(y.pathname=y.pathname==="/"?t:or([t,y.pathname])),(g.replace?r.replace:r.push)(y,g.state,g)},[t,r,i,o,e])}const sx=c.createContext(null);function lx(e){let t=c.useContext(Un).outlet;return t&&c.createElement(sx.Provider,{value:e},t)}function ai(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=c.useContext(Dn),{matches:s}=c.useContext(Un),{pathname:o}=Wt(),i=JSON.stringify(ru(s,r.v7_relativeSplatPath));return c.useMemo(()=>su(e,JSON.parse(i),o,n==="path"),[e,i,o,n])}function ox(e,t){return ix(e,t)}function ix(e,t,n,r){gs()||lt(!1);let{navigator:s}=c.useContext(Dn),{matches:o}=c.useContext(Un),i=o[o.length-1],a=i?i.params:{};i&&i.pathname;let u=i?i.pathnameBase:"/";i&&i.route;let d=Wt(),g;if(t){var y;let S=typeof t=="string"?zr(t):t;u==="/"||(y=S.pathname)!=null&&y.startsWith(u)||lt(!1),g=S}else g=d;let m=g.pathname||"/",x=m;if(u!=="/"){let S=u.replace(/^\//,"").split("/");x="/"+m.replace(/^\//,"").split("/").slice(S.length).join("/")}let w=Av(e,{pathname:x}),j=fx(w&&w.map(S=>Object.assign({},S,{params:Object.assign({},a,S.params),pathname:or([u,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?u:or([u,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),o,n,r);return t&&j?c.createElement(ii.Provider,{value:{location:cl({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Xn.Pop}},j):j}function ax(){let e=gx(),t=ex(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return c.createElement(c.Fragment,null,c.createElement("h2",null,"Unexpected Application Error!"),c.createElement("h3",{style:{fontStyle:"italic"}},t),n?c.createElement("pre",{style:s},n):null,null)}const cx=c.createElement(ax,null);class ux extends c.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?c.createElement(Un.Provider,{value:this.props.routeContext},c.createElement(Kh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dx(e){let{routeContext:t,match:n,children:r}=e,s=c.useContext(oi);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),c.createElement(Un.Provider,{value:t},r)}function fx(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,a=(s=n)==null?void 0:s.errors;if(a!=null){let g=i.findIndex(y=>y.route.id&&(a==null?void 0:a[y.route.id])!==void 0);g>=0||lt(!1),i=i.slice(0,Math.min(i.length,g+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let g=0;g<i.length;g++){let y=i[g];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=g),y.route.id){let{loaderData:m,errors:x}=n,w=y.route.loader&&m[y.route.id]===void 0&&(!x||x[y.route.id]===void 0);if(y.route.lazy||w){u=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((g,y,m)=>{let x,w=!1,j=null,S=null;n&&(x=a&&y.route.id?a[y.route.id]:void 0,j=y.route.errorElement||cx,u&&(d<0&&m===0?(vx("route-fallback"),w=!0,S=null):d===m&&(w=!0,S=y.route.hydrateFallbackElement||null)));let h=t.concat(i.slice(0,m+1)),f=()=>{let p;return x?p=j:w?p=S:y.route.Component?p=c.createElement(y.route.Component,null):y.route.element?p=y.route.element:p=g,c.createElement(dx,{match:y,routeContext:{outlet:g,matches:h,isDataRoute:n!=null},children:p})};return n&&(y.route.ErrorBoundary||y.route.errorElement||m===0)?c.createElement(ux,{location:n.location,revalidation:n.revalidation,component:j,error:x,children:f(),routeContext:{outlet:null,matches:h,isDataRoute:!0}}):f()},null)}var Yh=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Yh||{}),qh=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(qh||{});function px(e){let t=c.useContext(oi);return t||lt(!1),t}function hx(e){let t=c.useContext(Gh);return t||lt(!1),t}function mx(e){let t=c.useContext(Un);return t||lt(!1),t}function Xh(e){let t=mx(),n=t.matches[t.matches.length-1];return n.route.id||lt(!1),n.route.id}function gx(){var e;let t=c.useContext(Kh),n=hx(),r=Xh();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function yx(){let{router:e}=px(Yh.UseNavigateStable),t=Xh(qh.UseNavigateStable),n=c.useRef(!1);return Qh(()=>{n.current=!0}),c.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,cl({fromRouteId:t},o)))},[e,t])}const Bd={};function vx(e,t,n){Bd[e]||(Bd[e]=!0)}function xx(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Ga(e){let{to:t,replace:n,state:r,relative:s}=e;gs()||lt(!1);let{future:o,static:i}=c.useContext(Dn),{matches:a}=c.useContext(Un),{pathname:u}=Wt(),d=jn(),g=su(t,ru(a,o.v7_relativeSplatPath),u,s==="path"),y=JSON.stringify(g);return c.useEffect(()=>d(JSON.parse(y),{replace:n,state:r,relative:s}),[d,y,s,n,r]),null}function wx(e){return lx(e.context)}function nn(e){lt(!1)}function Sx(e){let{basename:t="/",children:n=null,location:r,navigationType:s=Xn.Pop,navigator:o,static:i=!1,future:a}=e;gs()&&lt(!1);let u=t.replace(/^\/*/,"/"),d=c.useMemo(()=>({basename:u,navigator:o,static:i,future:cl({v7_relativeSplatPath:!1},a)}),[u,a,o,i]);typeof r=="string"&&(r=zr(r));let{pathname:g="/",search:y="",hash:m="",state:x=null,key:w="default"}=r,j=c.useMemo(()=>{let S=ds(g,u);return S==null?null:{location:{pathname:S,search:y,hash:m,state:x,key:w},navigationType:s}},[u,g,y,m,x,w,s]);return j==null?null:c.createElement(Dn.Provider,{value:d},c.createElement(ii.Provider,{children:n,value:j}))}function jx(e){let{children:t,location:n}=e;return ox(Ka(t),n)}new Promise(()=>{});function Ka(e,t){t===void 0&&(t=[]);let n=[];return c.Children.forEach(e,(r,s)=>{if(!c.isValidElement(r))return;let o=[...t,s];if(r.type===c.Fragment){n.push.apply(n,Ka(r.props.children,o));return}r.type!==nn&&lt(!1),!r.props.index||!r.props.children||lt(!1);let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=Ka(r.props.children,o)),n.push(i)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ao(){return Ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ao.apply(this,arguments)}function Jh(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,o;for(o=0;o<r.length;o++)s=r[o],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Nx(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function kx(e,t){return e.button===0&&(!t||t==="_self")&&!Nx(e)}function Qa(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function bx(e,t){let n=Qa(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(o=>{n.append(s,o)})}),n}const Cx=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ex=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Lx="6";try{window.__reactRouterVersion=Lx}catch{}const Px=c.createContext({isTransitioning:!1}),_x="startTransition",Vd=wg[_x];function Rx(e){let{basename:t,children:n,future:r,window:s}=e,o=c.useRef();o.current==null&&(o.current=Rv({window:s,v5Compat:!0}));let i=o.current,[a,u]=c.useState({action:i.action,location:i.location}),{v7_startTransition:d}=r||{},g=c.useCallback(y=>{d&&Vd?Vd(()=>u(y)):u(y)},[u,d]);return c.useLayoutEffect(()=>i.listen(g),[i,g]),c.useEffect(()=>xx(r),[r]),c.createElement(Sx,{basename:t,children:n,location:a.location,navigationType:a.action,navigator:i,future:r})}const Ix=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zh=c.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:o,replace:i,state:a,target:u,to:d,preventScrollReset:g,viewTransition:y}=t,m=Jh(t,Cx),{basename:x}=c.useContext(Dn),w,j=!1;if(typeof d=="string"&&zx.test(d)&&(w=d,Ix))try{let p=new URL(window.location.href),v=d.startsWith("//")?new URL(p.protocol+d):new URL(d),b=ds(v.pathname,x);v.origin===p.origin&&b!=null?d=b+v.search+v.hash:j=!0}catch{}let S=nx(d,{relative:s}),h=Tx(d,{replace:i,state:a,target:u,preventScrollReset:g,relative:s,viewTransition:y});function f(p){r&&r(p),p.defaultPrevented||h(p)}return c.createElement("a",Ao({},m,{href:w||S,onClick:j||o?r:f,ref:n,target:u}))}),Mr=c.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:s=!1,className:o="",end:i=!1,style:a,to:u,viewTransition:d,children:g}=t,y=Jh(t,Ex),m=ai(u,{relative:y.relative}),x=Wt(),w=c.useContext(Gh),{navigator:j,basename:S}=c.useContext(Dn),h=w!=null&&Mx(m)&&d===!0,f=j.encodeLocation?j.encodeLocation(m).pathname:m.pathname,p=x.pathname,v=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;s||(p=p.toLowerCase(),v=v?v.toLowerCase():null,f=f.toLowerCase()),v&&S&&(v=ds(v,S)||v);const b=f!=="/"&&f.endsWith("/")?f.length-1:f.length;let C=p===f||!i&&p.startsWith(f)&&p.charAt(b)==="/",_=v!=null&&(v===f||!i&&v.startsWith(f)&&v.charAt(f.length)==="/"),I={isActive:C,isPending:_,isTransitioning:h},z=C?r:void 0,A;typeof o=="function"?A=o(I):A=[o,C?"active":null,_?"pending":null,h?"transitioning":null].filter(Boolean).join(" ");let D=typeof a=="function"?a(I):a;return c.createElement(Zh,Ao({},y,{"aria-current":z,className:A,ref:n,style:D,to:u,viewTransition:d}),typeof g=="function"?g(I):g)});var Ya;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ya||(Ya={}));var Wd;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Wd||(Wd={}));function Ax(e){let t=c.useContext(oi);return t||lt(!1),t}function Tx(e,t){let{target:n,replace:r,state:s,preventScrollReset:o,relative:i,viewTransition:a}=t===void 0?{}:t,u=jn(),d=Wt(),g=ai(e,{relative:i});return c.useCallback(y=>{if(kx(y,n)){y.preventDefault();let m=r!==void 0?r:zo(d)===zo(g);u(e,{replace:m,state:s,preventScrollReset:o,relative:i,viewTransition:a})}},[d,u,g,r,s,n,e,o,i,a])}function em(e){let t=c.useRef(Qa(e)),n=c.useRef(!1),r=Wt(),s=c.useMemo(()=>bx(r.search,n.current?null:t.current),[r.search]),o=jn(),i=c.useCallback((a,u)=>{const d=Qa(typeof a=="function"?a(s):a);n.current=!0,o("?"+d,u)},[o,s]);return[s,i]}function Mx(e,t){t===void 0&&(t={});let n=c.useContext(Px);n==null&&lt(!1);let{basename:r}=Ax(Ya.useViewTransitionState),s=ai(e,{relative:t.relative});if(!n.isTransitioning)return!1;let o=ds(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=ds(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Ha(s.pathname,i)!=null||Ha(s.pathname,o)!=null}function tm(){const[e,t]=c.useState(()=>{if(typeof window>"u")return!1;try{return window.localStorage.getItem("cozygen_gallery_pending")==="1"}catch{return!1}});return c.useEffect(()=>{const n=()=>t(!0),r=()=>t(!1),s=o=>{o.key==="cozygen_gallery_pending"&&t(o.newValue==="1")};return window.addEventListener("cozygen:gallery-pending",n),window.addEventListener("cozygen:gallery-viewed",r),window.addEventListener("storage",s),()=>{window.removeEventListener("cozygen:gallery-pending",n),window.removeEventListener("cozygen:gallery-viewed",r),window.removeEventListener("storage",s)}},[]),e}const qa="cozygen_token",To="cozygen:auth-expired";function lu(){try{return typeof window>"u"?null:localStorage.getItem(qa)}catch{return null}}function nm(e){try{if(typeof window>"u")return;e?localStorage.setItem(qa,e):localStorage.removeItem(qa)}catch{}}function io(){nm(null)}function ys(){const e=lu();return e?{Authorization:`Bearer ${e}`}:{}}function $x(e={}){if(io(),!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent(To,{detail:e}))}catch{window.dispatchEvent(new Event(To))}}const yl=async(e,t)=>{if(t.status===401){$x({url:e,status:t.status});const r=new Error("unauthorized");throw r.unauthorized=!0,r.status=401,r}if(!t.ok)throw new Error(`${e} failed`);return(t.headers.get("content-type")||"").includes("application/json")?t.json():t.text()},mr=async(e,t={})=>{const{signal:n}=t,r=await fetch(e,{headers:{...ys()},credentials:"include",signal:n});return yl(e,r)},vl=async(e,t,n={})=>{const{signal:r}=n,s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...ys()},body:JSON.stringify(t),credentials:"include",signal:r});return yl(e,s)};async function Fx(e={}){return mr("/cozygen/workflows",e)}async function Ox(e,t={}){return mr(`/cozygen/workflows/${encodeURIComponent(e)}`,t)}async function Xa(e,t={}){const{refresh:n=!1,cacheBust:r="",...s}=t||{},o=new URLSearchParams({type:String(e||"")});return n&&o.set("refresh","1"),r&&o.set("cache_bust",String(r)),mr(`/cozygen/get_choices?${o.toString()}`,s)}async function ou(e){const t=await fetch("/prompt",{method:"POST",headers:{"Content-Type":"application/json",...ys()},body:JSON.stringify(e),credentials:"include"});return yl("/prompt",t)}async function Dx(e){const t=new FormData;t.append("image",e);const n=await fetch("/cozygen/upload_image",{method:"POST",headers:{...ys()},body:t,credentials:"include"});return yl("/cozygen/upload_image",n)}async function rm(e="",t=1,n=50,r=!1,s=!1,o="all",i="",a={}){const{includeMeta:u=!1,...d}=a||{},g=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),show_hidden:r?"1":"0",recursive:s?"1":"0",kind:o});return u&&g.set("include_meta","1"),i&&g.set("cache_bust",String(i)),mr(`/cozygen/api/gallery?${g.toString()}`,d)}async function Ux({filename:e="",subfolder:t=""}={},n={}){const r=new URLSearchParams({filename:String(e||""),subfolder:String(t||"")}),s=await fetch(`/cozygen/api/gallery/prompt?${r.toString()}`,{headers:{...ys()},credentials:"include",signal:n==null?void 0:n.signal}),i=(s.headers.get("content-type")||"").includes("application/json")?await s.json():await s.text();if(!s.ok){const a=new Error((i==null?void 0:i.error)||"Prompt metadata not found");throw a.status=s.status,a.payload=i,a}return i}async function Bx(){return mr("/cozygen/api/aliases")}async function Vx(e){return vl("/cozygen/api/aliases",e||{})}async function sm(e={}){return mr("/cozygen/api/tags/categories",e)}async function Mo({q:e="",category:t="",sort:n="count",limit:r=80,offset:s=0}={},o={}){const i=new URLSearchParams({q:String(e||""),category:String(t||""),sort:String(n||"count"),limit:String(r||80),offset:String(s||0)});return mr(`/cozygen/api/tags/search?${i.toString()}`,o)}async function Wi(e=[],t={}){return vl("/cozygen/api/tags/validate",{tags:Array.isArray(e)?e:[]},t)}async function Wx(e,t={}){const n=new URLSearchParams;return e&&n.set("workflow",e),mr(`/cozygen/api/workflow_presets?${n.toString()}`,t)}async function Hx(e,t,n={}){return vl("/cozygen/api/workflow_presets",{workflow:e,preset:t},n)}async function Gx(e,t,n={}){return vl("/cozygen/api/workflow_presets",{workflow:e,delete:t},n)}async function Kx(e,t){return vl("/cozygen/api/login",{username:e,password:t})}async function Qx(){return fetch("/cozygen/api/auth_status",{headers:{...ys()},credentials:"include"}).then(e=>yl("/cozygen/api/auth_status",e))}const Yx=30*60*1e3,Hd="cozygen_idle_logout",lm=c.createContext(null);function qx({children:e}){const[t,n]=c.useState(!1),[r,s]=c.useState(null),[o,i]=c.useState(!1),a=c.useRef(null),u=c.useCallback(async()=>{if(!lu()){s(null),i(!1),n(!0);return}try{const x=await Qx();s((x==null?void 0:x.user)||null),i(!!(x!=null&&x.default_credentials))}catch{io(),s(null),i(!1)}finally{n(!0)}},[]);c.useEffect(()=>{u()},[u]);const d=c.useCallback(async(m,x)=>{const w=await Kx(m,x);nm((w==null?void 0:w.token)||""),s((w==null?void 0:w.user)||m),i(!!(w!=null&&w.default_credentials));try{localStorage.removeItem(Hd)}catch{}return w},[]),g=c.useCallback(()=>{io(),s(null),i(!1)},[]);c.useEffect(()=>{if(typeof window>"u")return;const m=()=>{g(),n(!0)};return window.addEventListener(To,m),()=>window.removeEventListener(To,m)},[g]),c.useEffect(()=>{if(!t)return;const m=()=>{a.current&&clearTimeout(a.current);const w=setTimeout(()=>{io(),s(null),i(!1);try{localStorage.setItem(Hd,"1")}catch{}window.location.hash="#/login"},Yx);a.current=w};m();const x=["pointerdown","keydown","visibilitychange"];return x.forEach(w=>window.addEventListener(w,m,{passive:!0})),()=>{a.current&&(clearTimeout(a.current),a.current=null),x.forEach(w=>window.removeEventListener(w,m))}},[t]);const y=c.useMemo(()=>({ready:t,user:r,authed:!!r,defaultCreds:o,login:d,logout:g,refresh:u}),[t,r,o,d,g,u]);return l.jsx(lm.Provider,{value:y,children:e})}function ci(){const e=c.useContext(lm);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function Xx({children:e}){return l.jsx(qx,{children:e})}const om="cozygen_last_render_payload";function im(e){if(e)try{if(typeof window>"u")return;window.localStorage.setItem(om,JSON.stringify(e))}catch{}}function am(){try{if(typeof window>"u")return null;const e=window.localStorage.getItem(om);return e?JSON.parse(e):null}catch{return null}}async function cm(){const e=am();if(!e||!e.workflow)return{success:!1,error:"No previous render to repeat"};try{return window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!0}})),await ou({prompt:e.workflow}),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),{success:!0}}catch(t){return console.error("Failed to requeue prompt",t),window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:!1}})),t!=null&&t.unauthorized?(window.location.hash="#/login",{success:!1,error:"Session expired"}):{success:!1,error:"Failed to queue prompt"}}}function um(){const e=am();return!!(e&&e.workflow)}function ui(e,t=!1){const n=()=>typeof window>"u"||!window.matchMedia?t:window.matchMedia(e).matches,[r,s]=c.useState(n);return c.useEffect(()=>{if(typeof window>"u"||!window.matchMedia)return;const o=window.matchMedia(e),i=()=>s(o.matches);return i(),typeof o.addEventListener=="function"?(o.addEventListener("change",i),()=>o.removeEventListener("change",i)):(o.addListener(i),()=>o.removeListener(i))},[e]),r}const dm=({size:e=32,className:t=""})=>l.jsxs("svg",{width:e,height:e,viewBox:"0 0 32 32",fill:"none",className:t,"aria-hidden":"true",children:[l.jsx("path",{d:"M8 24L20 4",stroke:"url(#logo-gradient)",strokeWidth:"3",strokeLinecap:"round"}),l.jsx("path",{d:"M6 26C6 26 7 24 8 24C9 24 10 25 8 27C6 29 4 28 6 26Z",fill:"url(#logo-warm)"}),l.jsx("circle",{cx:"22",cy:"8",r:"2",fill:"url(#logo-spark)"}),l.jsx("circle",{cx:"26",cy:"12",r:"1.5",fill:"url(#logo-spark)",opacity:"0.8"}),l.jsx("circle",{cx:"24",cy:"16",r:"1",fill:"url(#logo-spark)",opacity:"0.6"}),l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"logo-gradient",x1:"8",y1:"24",x2:"20",y2:"4",gradientUnits:"userSpaceOnUse",children:[l.jsx("stop",{stopColor:"#FF9F7A"}),l.jsx("stop",{offset:"0.5",stopColor:"#9F8CFF"}),l.jsx("stop",{offset:"1",stopColor:"#44E1C5"})]}),l.jsxs("linearGradient",{id:"logo-warm",x1:"4",y1:"24",x2:"10",y2:"28",gradientUnits:"userSpaceOnUse",children:[l.jsx("stop",{stopColor:"#FF9F7A"}),l.jsx("stop",{offset:"1",stopColor:"#FFD666"})]}),l.jsxs("radialGradient",{id:"logo-spark",cx:"0.3",cy:"0.3",r:"0.7",children:[l.jsx("stop",{stopColor:"#FFFFFF"}),l.jsx("stop",{offset:"0.5",stopColor:"#44E1C5"}),l.jsx("stop",{offset:"1",stopColor:"#9F8CFF"})]})]})]}),tt=({children:e,size:t=16,className:n="",...r})=>l.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,"aria-hidden":"true",...r,children:e}),Jx=e=>l.jsxs(tt,{...e,children:[l.jsx("path",{d:"M3 10l9-7 9 7"}),l.jsx("path",{d:"M5 10v10h14V10"}),l.jsx("path",{d:"M9 20v-6h6v6"})]}),iu=e=>l.jsxs(tt,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),l.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor",stroke:"none"}),l.jsx("path",{d:"M21 15l-5-5L5 21"})]}),cr=e=>l.jsxs(tt,{...e,children:[l.jsx("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"}),l.jsx("line",{x1:"7",y1:"7",x2:"7.01",y2:"7",strokeWidth:"3"})]}),xl=e=>l.jsxs(tt,{...e,children:[l.jsx("path",{d:"M14 3H4a2 2 0 00-2 2v10l6 6h10a2 2 0 002-2V9l-6-6z"}),l.jsx("path",{d:"M14 3v6h6"}),l.jsx("path",{d:"M7 7h5"}),l.jsx("path",{d:"M7 11h7"})]}),au=e=>l.jsx(tt,{...e,children:l.jsx("path",{d:"M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"})}),fm=e=>l.jsx(tt,{...e,children:l.jsx("polygon",{points:"5 3 19 12 5 21 5 3",fill:"currentColor",stroke:"none"})}),Gd=e=>l.jsxs(tt,{...e,children:[l.jsx("path",{d:"M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"}),l.jsx("polyline",{points:"16 17 21 12 16 7"}),l.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),cu=e=>l.jsxs(tt,{...e,children:[l.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),l.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),l.jsx("line",{x1:"15",y1:"9",x2:"15",y2:"15"}),l.jsx("circle",{cx:"9",cy:"12",r:"1.5",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"10",r:"1.5",fill:"currentColor",stroke:"none"})]}),Zx=e=>l.jsxs(tt,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),l.jsx("circle",{cx:"12",cy:"12",r:"4"}),l.jsx("line",{x1:"3",y1:"9",x2:"6",y2:"9"})]}),Kd=e=>l.jsxs(tt,{...e,children:[l.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"}),l.jsx("path",{d:"M2 10h20"})]}),Qd=e=>l.jsx(tt,{...e,children:l.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"})}),Yd=e=>l.jsxs(tt,{...e,children:[l.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),l.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),qd=e=>l.jsxs(tt,{...e,children:[l.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"}),l.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}),Xd=e=>l.jsx(tt,{...e,children:l.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})}),Jd=e=>l.jsxs(tt,{...e,children:[l.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),l.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]}),Ja=e=>l.jsxs(tt,{...e,children:[l.jsx("polyline",{points:"23 4 23 10 17 10"}),l.jsx("path",{d:"M20.49 15a9 9 0 11-2.12-9.36L23 10"})]}),pm=e=>l.jsx(tt,{...e,children:l.jsx("polyline",{points:"15 18 9 12 15 6"})}),di=e=>l.jsx(tt,{...e,children:l.jsx("polyline",{points:"9 18 15 12 9 6"})}),Za=e=>l.jsxs(tt,{...e,children:[l.jsx("circle",{cx:"9",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"6",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"9",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"12",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"9",cy:"18",r:"1",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"15",cy:"18",r:"1",fill:"currentColor",stroke:"none"})]}),ur=e=>l.jsxs(tt,{...e,children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),Zd=e=>l.jsxs(tt,{...e,children:[l.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",strokeDasharray:"4 2"}),l.jsx("line",{x1:"9",y1:"12",x2:"15",y2:"12"})]}),ew=e=>l.jsxs(tt,{...e,children:[l.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),l.jsx("polyline",{points:"5 12 12 5 19 12"})]}),tw=e=>l.jsxs(tt,{...e,children:[l.jsx("circle",{cx:"6",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"12",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"}),l.jsx("circle",{cx:"18",cy:"12",r:"1.6",fill:"currentColor",stroke:"none"})]}),nw=e=>l.jsxs(tt,{...e,children:[l.jsx("rect",{x:"9",y:"9",width:"10",height:"10",rx:"2"}),l.jsx("path",{d:"M7 15H6a2 2 0 01-2-2V6a2 2 0 012-2h7"})]}),ef=[{to:"/studio",label:"Studio",Icon:Jx,end:!0},{to:"/controls",label:"Controls",Icon:cu}],rw=[{to:"/gallery",label:"Gallery",Icon:iu},{to:"/tags",label:"Tag Library",Icon:cr},{to:"/aliases",label:"Aliases",Icon:xl}],Es=({isActive:e})=>["slim-nav-link btn-touch",e?"is-active":null].filter(Boolean).join(" ");function sw({isMobileAlignedNav:e=!1}){const[t,n]=c.useState(!1),{pathname:r}=Wt(),s=tm(),{logout:o,user:i}=ci(),[a,u]=c.useState(!1),d=ui("(min-width: 768px)"),g=()=>n(v=>!v),y=()=>n(!1),m=r==="/login",x=d&&!e,w=!m&&x,j=x,S=!d||e;c.useEffect(()=>{const v=b=>{var _;const C=!!((_=b==null?void 0:b.detail)!=null&&_.active);u(C)};return window.addEventListener("cozygen:render-state",v),()=>window.removeEventListener("cozygen:render-state",v)},[]);const h=async()=>{if(a)return;if(r==="/controls"||r==="/compose"){try{window.dispatchEvent(new Event("cozygen:request-render"))}catch{}return}if(!um()){alert("No previous render found yet. Render once from Studio first.");return}u(!0);const C=await cm();u(!1),C!=null&&C.success||alert((C==null?void 0:C.error)||"Failed to render.")},f=()=>{try{o()}catch{}window.location.hash="#/login"},p=[...ef,...rw];return l.jsxs("header",{className:"top-bar",children:[l.jsx("div",{className:"top-bar-shell",children:l.jsxs("div",{className:"brand-row",children:[l.jsxs(Zh,{to:"/studio",className:"brand-mark",onClick:y,children:[l.jsx(dm,{size:28,className:"brand-logo"}),l.jsx("span",{className:"brand-text",children:"CozyGen"})]}),x?l.jsx("nav",{className:"desktop-nav","aria-label":"Main navigation",children:p.map(v=>l.jsx(Mr,{to:v.to,end:v.end,className:Es,children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[l.jsx(v.Icon,{size:16}),l.jsx("span",{children:v.label}),v.to==="/gallery"&&s?l.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})},v.to))}):null,l.jsx("div",{className:"flex-1"}),w?l.jsxs("button",{type:"button",className:`desktop-render-btn ${a?"is-busy":""}`,onClick:h,title:a?"Rendering":"Render","aria-busy":a,"aria-disabled":a,disabled:a,children:[l.jsx("span",{className:"render-icon",children:a?l.jsx("span",{className:"render-spinner","aria-hidden":"true"}):l.jsx(fm,{size:16})}),l.jsx("span",{className:"render-label",children:a?"Rendering":"Render"})]}):null,j?l.jsxs("button",{type:"button",className:"desktop-logout-btn",onClick:f,title:"Sign out",children:[l.jsx("span",{className:"logout-icon",children:l.jsx(Gd,{size:16})}),l.jsx("span",{className:"logout-label",children:"Logout"}),i?l.jsxs("span",{className:"logout-user",children:["@",i]}):null]}):null,S?l.jsx("button",{type:"button",className:`mobile-menu-toggle btn-touch ${t?"is-active":""}`,onClick:g,"aria-expanded":t,"aria-controls":"cozygen-mobile-nav","aria-label":t?"Close menu":"Open menu",children:l.jsx("span",{className:"mobile-menu-icon",children:l.jsx("span",{})})}):null]})}),S?l.jsxs("div",{id:"cozygen-mobile-nav",className:`mobile-nav-drawer ${t?"is-open":""}`,role:"menu",children:[l.jsx("div",{className:"mobile-nav-section",children:ef.map(v=>l.jsx(Mr,{to:v.to,end:v.end,className:Es,onClick:y,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(v.Icon,{size:16}),l.jsx("span",{children:v.label})]})},v.to))}),l.jsxs("div",{className:"mobile-nav-section secondary",children:[l.jsx(Mr,{to:"/gallery",className:Es,onClick:y,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(iu,{size:16}),l.jsx("span",{children:"Gallery"}),s?l.jsx("span",{className:"badge-dot","aria-hidden":"true"}):null]})}),l.jsx(Mr,{to:"/tags",className:Es,onClick:y,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(cr,{size:16}),l.jsx("span",{children:"Tag Library"})]})}),l.jsx(Mr,{to:"/aliases",className:Es,onClick:y,role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(xl,{size:16}),l.jsx("span",{children:"Aliases"})]})}),l.jsx("button",{type:"button",className:"slim-nav-link btn-touch text-left",onClick:()=>{y(),f()},role:"menuitem",children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(Gd,{size:16}),l.jsx("span",{children:"Logout"}),i?l.jsxs("span",{className:"text-[rgba(159,178,215,0.75)] text-xs",children:["@",i]}):null]})})]})]}):null]})}const tf=[{to:"/controls",label:"Controls",Icon:cu},{to:"/compose",label:"Compose",Icon:au},{to:"/gallery",label:"Gallery",Icon:iu}],lw=[{to:"/aliases",label:"Aliases",Icon:xl},{to:"/tags",label:"Tags",Icon:cr}],ow=({isActive:e})=>["bottom-nav-link",e?"is-active":""].filter(Boolean).join(" ");function iw(){const e=Wt(),t=jn(),n=tm(),[r,s]=Qt.useState(!1),[o,i]=Qt.useState(!1),[a,u]=Qt.useState(!1),[d,g]=Qt.useState({}),y=ui("(min-width: 768px)"),m=Qt.useRef(null),x=Qt.useRef(null),w=e.pathname==="/controls",j=e.pathname==="/compose",S=async()=>{if(!(typeof window>"u")&&!o)if(s(!0),setTimeout(()=>s(!1),400),w||j)try{window.dispatchEvent(new CustomEvent("cozygen:request-render"))}catch{}else{if(!um())return;const f=await cm();f.success||console.warn("Requeue failed:",f.error)}};Qt.useEffect(()=>{const f=p=>{var b;const v=!!((b=p==null?void 0:p.detail)!=null&&b.active);i(v),v&&(s(!0),setTimeout(()=>s(!1),400))};return window.addEventListener("cozygen:render-state",f),()=>window.removeEventListener("cozygen:render-state",f)},[]),Qt.useEffect(()=>{if(!a||y)return;const f=p=>{m.current&&m.current.contains(p.target)||x.current&&x.current.contains(p.target)||u(!1)};return window.addEventListener("pointerdown",f),()=>window.removeEventListener("pointerdown",f)},[a,y]),Qt.useEffect(()=>{if(!a||y||!x.current)return;const f=x.current.getBoundingClientRect(),p=f.left+f.width/2,v=window.innerHeight-f.top+8;g({left:`${Math.min(window.innerWidth-80,Math.max(40,p))}px`,bottom:`${v}px`,top:"auto"})},[a,y]),Qt.useEffect(()=>{y&&u(!1)},[y]);const h=y?[...tf,...lw]:tf;return l.jsxs(l.Fragment,{children:[l.jsxs("nav",{className:"bottom-nav","aria-label":"Bottom navigation",children:[h.map(f=>l.jsxs(Mr,{to:f.to,end:f.end,className:ow,children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(f.Icon,{size:20})}),l.jsxs("span",{className:"bottom-nav-label",children:[f.label,f.to==="/gallery"&&n?l.jsx("span",{className:"badge-dot pulse","aria-hidden":"true"}):null]})]},f.to)),y?null:l.jsxs("button",{ref:x,type:"button",className:"bottom-nav-link",onClick:()=>u(f=>!f),"aria-expanded":a,"aria-label":"Open library",children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(cr,{size:20})}),l.jsx("span",{className:"bottom-nav-label",children:"Library"})]},"library"),l.jsxs("button",{type:"button",className:`bottom-nav-link is-action ${r?"is-flash":""} ${o?"is-rendering":""}`,onClick:S,"aria-label":"Render","aria-busy":o,"aria-disabled":o,disabled:o,children:[l.jsx("span",{className:"bottom-nav-icon","aria-hidden":"true",children:l.jsx(fm,{size:20})}),l.jsx("span",{className:"bottom-nav-label",children:"Render"})]},"render")]}),y?null:l.jsxs("div",{ref:m,className:`library-popover ${a?"is-open":""}`,style:d,children:[l.jsxs("button",{type:"button",className:"library-popover-btn",onClick:()=>{u(!1),t("/aliases")},children:[l.jsx(xl,{size:18}),l.jsx("span",{children:"Aliases"})]}),l.jsxs("button",{type:"button",className:"library-popover-btn",onClick:()=>{u(!1),t("/tags")},children:[l.jsx(cr,{size:18}),l.jsx("span",{children:"Tags"})]})]})]})}function aw(e,t){if(!t||t<=0)return null;const n=Number(e)||0,r=Number(t)||0,s=Math.round(n/r*100);return Number.isFinite(s)?Math.max(0,Math.min(100,s)):null}function cw({busy:e=!1,progressValue:t=0,progressMax:n=0,statusText:r="Idle",statusPhase:s="idle",primaryLabel:o="Render",onPrimary:i,primaryDisabled:a=!1,onLogs:u,logsLabel:d="Logs"}){const g=aw(t,n),y=s==="queued"?"rgba(255, 143, 112, 0.95)":s==="running"?"rgba(68, 225, 197, 0.95)":s==="finished"?"rgba(92, 255, 154, 0.95)":s==="error"?"rgba(255, 143, 112, 0.95)":"rgba(159, 178, 215, 0.55)",x={idle:"Idle",queued:"Queued",running:"Running",finished:"Finished",error:"Error"}[s]||"Status",w=e||a;return l.jsxs("div",{className:"dock-bar-inner",children:[l.jsx("button",{type:"button",onClick:i,disabled:w,className:"dock-primary-btn",children:e?"Rendering":o}),l.jsxs("div",{className:"dock-status-row",children:[l.jsxs("span",{className:"dock-status-left",children:[l.jsx("span",{className:"dock-status-dot",style:{background:y}}),l.jsx("span",{className:"dock-status-label",children:x})]}),l.jsxs("span",{className:"dock-status-right",children:[g!=null&&e?l.jsxs("span",{className:"dock-progress",children:[l.jsx("span",{className:"dock-progress-bar","aria-hidden":"true",children:l.jsx("span",{className:"dock-progress-fill",style:{width:`${g}%`}})}),l.jsxs("span",{children:[g,"%"]})]}):null,l.jsx("span",{className:"dock-status-text",children:r||(e?"Working":"Idle")}),u?l.jsx("button",{type:"button",className:"dock-logs-btn",onClick:u,children:d}):null]})]})]})}const hm="jpg,jpeg,png,webp,gif,bmp,tif,tiff",uu=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),mm=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);async function Hi({subfolder:e="",page:t=1,perPage:n=50,exts:r=hm,signal:s}={}){const o=new URLSearchParams({subfolder:e,page:String(t),per_page:String(n),exts:r}),i=await fetch(`/cozygen/input?${o.toString()}`,{signal:s});if(!i.ok)throw new Error(`Input list failed: ${i.status}`);return i.json()}const $o=e=>`/cozygen/input/file?path=${encodeURIComponent(e)}`,ec="output::",fi=(e="")=>e.replace(/\\/g,"/").replace(/^\/+/,"").replace(/\/+$/,""),gm=(e="")=>{const t=e.replace(/\\/g,"/").split("/").filter(Boolean);return t[t.length-1]||""},uw=({subfolder:e="",filename:t=""}={})=>{const n=gm(t);if(!n)return"";const r=fi(e);return`${ec}${r}::${n}`},tc=(e="")=>{if(typeof e!="string"||!e.startsWith(ec))return null;const t=e.slice(ec.length);if(!t)return null;const n=t.lastIndexOf("::"),r=n===-1?t:t.slice(n+2);return r?{subfolder:n===-1?"":t.slice(0,n),filename:r}:null},Fo=({filename:e="",subfolder:t="",type:n="output"}={})=>{const r=gm(e);return r?`/view?${new URLSearchParams({filename:r,subfolder:fi(t),type:n||"output"}).toString()}`:""},nc=(e="")=>e.split("/").slice(0,-1).join("/"),dw=e=>{if(typeof e!="string"||!e)return e!=null&&e.path?nc(e.path):"";const t=tc(e);return t?fi(t.subfolder):nc(e)},nf=(e=[])=>e.map(t=>{const n=t.rel_path||t.name||"",r=t.name||n||"Untitled",s=!!t.is_dir,o=s?"":$o(n);return{...t,name:r,rel_path:n,is_dir:s,is_image:!s&&uu(r),is_video:!s&&mm(r),source:"input",preview_url:o}}),fw=(e=[])=>e.map(t=>{const n=t.filename||"",r=t.subfolder||"",s=t.type==="directory",o=s?r||n:[r,n].filter(Boolean).join("/"),i=n||r||o||"Untitled",a=s?"":Fo({filename:n,subfolder:r,type:t.type});return{...t,name:i,rel_path:o,is_dir:s,is_image:!s&&uu(n),is_video:!s&&mm(n),source:"output",preview_url:a}}),gr={get(e,t){try{return(typeof window<"u"?JSON.parse(localStorage.getItem(e)):null)??t}catch{return t}},set(e,t){try{typeof window<"u"&&localStorage.setItem(e,JSON.stringify(t))}catch{}}};function pw({input:e,value:t,onFormChange:n}){var W;const r=((W=e==null?void 0:e.inputs)==null?void 0:W.param_name)||"Image Input",s=(e==null?void 0:e.class_type)||"CozyGenImageInput",o=`cg_last_input_cwd::${r}`,i=`cg_last_picker_source::${r}`,[a,u]=c.useState(""),[d,g]=c.useState(!1),[y,m]=c.useState(!1),[x,w]=c.useState(gr.get(o,"")),[j,S]=c.useState(1),[h,f]=c.useState(50),[p,v]=c.useState([]),[b,C]=c.useState(1),[_,I]=c.useState(!1),[z,A]=c.useState(""),[D,oe]=c.useState([]),[q,je]=c.useState(!0),ye=c.useRef(null),[ne,me]=c.useState(()=>gr.get(i,"inputs")==="outputs"?"outputs":"inputs"),R=ne,N=c.useCallback(F=>{const O=F==="outputs"?"outputs":"inputs";me(O),gr.set(i,O),w(""),S(1)},[]),E=c.useMemo(()=>{if(a)try{const F=new URL(a,window.location.origin);return(F.searchParams.get("path")||F.searchParams.get("filename")||F.pathname.split("/").pop()||"").split("/").pop()||"No file selected."}catch{}if(!t)return"No file selected.";if(typeof t=="string"){const F=tc(t);return F!=null&&F.filename?F.filename.split("/").pop():t.split("/").pop()}return t!=null&&t.path?t.path.split("/").pop():"No file selected."},[a,t]);c.useEffect(()=>{if(typeof t=="string"&&t){const F=tc(t);F!=null&&F.filename?u(Fo({filename:F.filename,subfolder:F.subfolder,type:"output"})):u($o(t)),g(!1)}else t!=null&&t.url?(u(t.url),g(!1)):(u(""),g(!1))},[t]);const k=c.useCallback(async F=>{const O=await Dx(F),se=`/view?filename=${O.filename}&type=input`;u(se),g(!1),gr.set(o,""),s==="CozyGenImageInput"?n(r,O.filename):n(r,{source:"Upload",path:O.filename,url:se})},[s,n,r]),V=c.useCallback(()=>{u(""),g(!1),s==="CozyGenImageInput"?n(r,""):n(r,{source:"Upload",path:"",url:""})},[s,n,r]),G=c.useCallback(()=>{const O=dw(t)||gr.get(o,"");w(O),S(1),m(!0)},[t]),te=c.useCallback(()=>{m(!1)},[]);c.useEffect(()=>{if(y){if(R!=="inputs"){oe([]);return}(async()=>{try{const F=await Hi({subfolder:"",page:1,perPage:0,exts:""});oe((F.items||[]).filter(O=>O.is_dir))}catch{}})()}},[y,R]),c.useEffect(()=>{if(!y)return;let F=!1;ye.current&&ye.current.abort();const O=new AbortController;ye.current=O;async function se(){I(!0);try{if(R==="outputs"){const ce=await rm(x,j,h,!1,!1,"all","",{signal:O.signal});if(F)return;const Re=fw(ce&&ce.items||[]);F||(v(Re),C(ce&&ce.total_pages||1))}else{const Re=await Hi({subfolder:x,page:j,perPage:h,exts:q?hm:"",signal:O.signal}),Ne=(Re.items||[]).some(Ee=>!Ee.is_dir);if(q&&!Ne){const Ee=await Hi({subfolder:x,page:j,perPage:h,exts:"",signal:O.signal});F||(v(nf(Ee.items||[])),C(Ee.total_pages||1),je(!1));return}F||(v(nf(Re.items||[])),C(Re.total_pages||1))}}catch(ce){if((ce==null?void 0:ce.name)==="AbortError")return;console.error(R==="outputs"?"Failed to load output directory":"Failed to load input directory",ce),F||(v([]),C(1))}finally{F||I(!1)}}return se(),()=>{F=!0,ye.current===O&&(ye.current=null),O.abort()}},[y,x,j,h,q,R]);const re=c.useDeferredValue(z),X=c.useMemo(()=>{const F=re.trim().toLowerCase();let O=p;return q&&(O=O.filter(se=>{if(se.is_dir)return!0;const ce=se.name||se.filename||se.rel_path||"";return uu(String(ce))})),F?O.filter(se=>(se.name||se.filename||se.rel_path||"").toLowerCase().includes(F)):O},[p,re,q]),ie=c.useCallback(F=>{if(!F)return;const O=typeof F=="object"?F:null;if(((O==null?void 0:O.source)||"inputs")==="output"){const Ne=uw({subfolder:(O==null?void 0:O.subfolder)||"",filename:(O==null?void 0:O.filename)||(O==null?void 0:O.name)||""});if(!Ne)return;const Ee=(O==null?void 0:O.preview_url)||Fo({filename:O==null?void 0:O.filename,subfolder:O==null?void 0:O.subfolder,type:O==null?void 0:O.type});u(Ee),g(!1),gr.set(o,fi((O==null?void 0:O.subfolder)||"")),s==="CozyGenImageInput"?n(r,Ne):n(r,{source:"OutputGallery",path:Ne,url:Ee}),m(!1);return}const ce=typeof F=="string"?F:(O==null?void 0:O.rel_path)||(O==null?void 0:O.path)||"";if(!ce)return;const Re=(O==null?void 0:O.preview_url)||$o(ce);u(Re),g(!1),gr.set(o,nc(ce)),s==="CozyGenImageInput"?n(r,ce):n(r,{source:"Server",path:ce,url:Re}),m(!1)},[s,n,r]);return{param:r,previewUrl:a,imgReady:d,setImgReady:g,displayName:E,serverOpen:y,openServer:G,closeServer:te,cwd:x,setCwd:w,page:j,setPage:S,perPage:h,setPerPage:f,totalPages:b,loading:_,search:z,setSearch:A,topDirs:D,imagesOnly:q,setImagesOnly:je,shownEntries:X,pickerSource:R,setPickerSource:N,handleUpload:k,clearImage:V,selectServer:ie}}function Lt({open:e,onClose:t,title:n,children:r,footer:s,variant:o="sheet",className:i="",contentClassName:a="",shouldCloseOnOverlayClick:u=!0,shouldCloseOnEsc:d=!0}){const g=c.useRef(!1),y=c.useRef(null),m=c.useRef(null),x=S=>S?Array.from(S.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(h=>!h.hasAttribute("disabled")&&h.getAttribute("aria-hidden")!=="true"):[],w=c.useMemo(()=>["bottom-sheet-content",o==="fullscreen"?"is-fullscreen":"is-sheet",a].filter(Boolean).join(" "),[a,o]),j=c.useMemo(()=>["bottom-sheet-overlay",i].filter(Boolean).join(" "),[i]);return c.useEffect(()=>{if(!e||!d)return;const S=h=>{h.key==="Escape"&&(t==null||t())};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[e,t,d]),c.useEffect(()=>{if(!e||typeof document>"u")return;const S=y.current;m.current=document.activeElement;const h=()=>{var b;const v=x(S)[0]||S;(b=v==null?void 0:v.focus)==null||b.call(v)},f=p=>{if(p.key!=="Tab"||!S)return;const v=x(S);if(!v.length){p.preventDefault(),S.focus();return}const b=v[0],C=v[v.length-1],_=document.activeElement;p.shiftKey&&_===b?(p.preventDefault(),C.focus()):!p.shiftKey&&_===C&&(p.preventDefault(),b.focus())};return requestAnimationFrame(h),S==null||S.addEventListener("keydown",f),()=>{var v;S==null||S.removeEventListener("keydown",f);const p=m.current;p&&document.contains(p)&&((v=p.focus)==null||v.call(p))}},[e]),!e||typeof document>"u"?null:tu.createPortal(l.jsx("div",{className:j,role:"presentation",onPointerDown:S=>{g.current=S.target===S.currentTarget},onClick:S=>{u&&g.current&&S.target===S.currentTarget&&(t==null||t())},children:l.jsx("div",{ref:y,className:w,role:"dialog","aria-modal":"true","aria-label":n||"Sheet",onClick:S=>S.stopPropagation(),tabIndex:-1,children:l.jsxs("div",{className:"bottom-sheet-panel",children:[l.jsxs("header",{className:"bottom-sheet-head",children:[l.jsx("div",{className:"bottom-sheet-title",children:n||""}),l.jsx("button",{type:"button",className:"bottom-sheet-close",onClick:t,"aria-label":"Close",children:l.jsx(ur,{size:16})})]}),l.jsx("div",{className:"bottom-sheet-body",children:r}),s?l.jsx("footer",{className:"bottom-sheet-foot",children:s}):null]})})}),document.body)}function hw({items:e=[],value:t,onChange:n,ariaLabel:r,role:s="tablist",className:o="",tabClassName:i="",size:a="md",layout:u="equal",wrap:d=!1}){const g=["segmented-tabs",a==="sm"?"is-compact":"",u==="auto"?"is-auto":"",u==="icon"?"is-icon":"",d?"is-wrap":"",o].filter(Boolean).join(" "),y=s==="tablist"?"tab":"button",m=c.useRef([]);c.useEffect(()=>{m.current=m.current.slice(0,e.length)},[e.length]);const x=c.useMemo(()=>e.map((p,v)=>p.disabled?null:v).filter(p=>p!==null),[e]),w=c.useMemo(()=>e.findIndex(p=>p.key===t&&!p.disabled),[e,t]),j=x.length?x[0]:-1,S=w>=0?w:j,h=p=>{var b;const v=m.current[p];(b=v==null?void 0:v.focus)==null||b.call(v)},f=(p,v)=>{var C;if(!e.length)return p;let b=p;for(let _=0;_<e.length;_+=1)if(b=(b+v+e.length)%e.length,!((C=e[b])!=null&&C.disabled))return b;return p};return l.jsx("div",{className:g,role:s,"aria-label":r,children:e.map((p,v)=>{const b=p.key===t,C=p.label?String(p.label):"";return l.jsxs("button",{type:"button",ref:_=>{m.current[v]=_},role:y,"aria-selected":s==="tablist"?b:void 0,"aria-pressed":s!=="tablist"?b:void 0,"aria-controls":s==="tablist"?p.controls:void 0,className:["segmented-tab",b?"is-active":"",p.icon&&!C?"is-icon":"",p.className||"",i].filter(Boolean).join(" "),onClick:()=>{p.disabled||n==null||n(p.key)},onKeyDown:_=>{if(s!=="tablist"||!["ArrowRight","ArrowLeft","Home","End"].includes(_.key)||(_.preventDefault(),!e.length))return;let I=v;_.key==="Home"?I=x.length?x[0]:I:_.key==="End"?I=x.length?x[x.length-1]:I:_.key==="ArrowRight"?I=f(I,1):_.key==="ArrowLeft"&&(I=f(I,-1));const z=e[I];!z||z.disabled||(n==null||n(z.key),h(I))},disabled:p.disabled,title:p.title||C||p.ariaLabel,"aria-label":p.ariaLabel,tabIndex:s==="tablist"?v===S?0:-1:void 0,children:[p.icon?l.jsx("span",{className:"segmented-tab-icon",children:p.icon}):null,C?l.jsx("span",{className:"segmented-tab-label",children:C}):null,p.badge?l.jsx("span",{className:"segmented-tab-badge",children:p.badge}):null]},p.key)})})}const br=c.memo(hw),mw=(e=[])=>(e||[]).map(t=>typeof t=="string"||typeof t=="number"?{value:t,label:String(t)}:{value:(t==null?void 0:t.value)??(t==null?void 0:t.id)??"",label:(t==null?void 0:t.label)??(t==null?void 0:t.name)??String((t==null?void 0:t.value)??""),disabled:!!(t!=null&&t.disabled)}),gw=(e,t)=>{if(!t)return e;const n=t.trim().toLowerCase();return n?e.filter(r=>{const s=String(r.label||"").toLowerCase(),o=String(r.value||"").toLowerCase();return s.includes(n)||o.includes(n)}):e};function yw({value:e,onChange:t,options:n,children:r,placeholder:s,emptyLabel:o="No matches",disabled:i=!1,size:a="md",className:u="",wrapperClassName:d="",searchable:g=!1,searchPlaceholder:y="Search options...",searchValue:m,onSearchChange:x,searchAriaLabel:w="Search options",...j}){const[S,h]=c.useState(""),f=typeof m=="string"?m:S,p=x||h,v=c.useMemo(()=>mw(n),[n]),b=c.useMemo(()=>g?gw(v,f):v,[v,f,g]),C=["ui-control","ui-select",a==="sm"?"is-compact":"",u].filter(Boolean).join(" "),_=()=>r||(b.length?b.map(z=>l.jsx("option",{value:z.value,disabled:z.disabled,children:z.label},String(z.value))):l.jsx("option",{value:"",disabled:!0,children:o})),I=l.jsxs("select",{...j,className:C,value:e??"",onChange:z=>t==null?void 0:t(z.target.value),disabled:i,children:[s?l.jsx("option",{value:"",children:s}):null,_()]});return g?l.jsxs("div",{className:d,children:[l.jsx("input",{type:"search",value:f,onChange:z=>p(z.target.value),placeholder:y,className:"ui-control ui-input is-compact","aria-label":w,disabled:i}),I]}):I}const Ze=c.memo(yw);function vw({open:e,cwd:t,setCwd:n,page:r,setPage:s,perPage:o,setPerPage:i,totalPages:a,topDirs:u,loading:d,imagesOnly:g,setImagesOnly:y,search:m,setSearch:x,shownEntries:w,onSelect:j,onClose:S,pickerSource:h,setPickerSource:f}){if(!e)return null;const p=h||"inputs",v=typeof f=="function",b=()=>{n(""),s(1)},C=D=>{v&&D!==p&&(f(D),n(""),s(1))},_=t.split("/").filter(Boolean),I=p==="outputs"?"Choose output":"Choose input",z=[{key:"",label:"Root"},...u.map(D=>({key:D.rel_path,label:D.name}))],A=D=>{n(D),s(1)};return l.jsx(Lt,{open:e,onClose:S,title:I,variant:"fullscreen",footer:l.jsxs("div",{className:"flex items-center gap-2 w-full",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",disabled:r<=1||d,onClick:()=>s(D=>Math.max(1,D-1)),children:"Prev"}),l.jsxs("div",{className:"text-xs text-center text-[rgba(159,178,215,0.75)] min-w-[92px]",children:[r," / ",a]}),l.jsx("button",{type:"button",className:"ui-button is-muted w-full",disabled:r>=a||d,onClick:()=>s(D=>D<a?D+1:D),children:"Next"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Location"}),l.jsxs("div",{className:"imagepicker-breadcrumb",children:[l.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:b,children:"Root"}),_.map((D,oe)=>{const q=_.slice(0,oe+1).join("/");return l.jsx("button",{type:"button",className:"imagepicker-crumb",onClick:()=>{n(q),s(1)},children:D},q)})]})]}),v?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Source"}),l.jsx(br,{ariaLabel:"Source",value:p,onChange:C,size:"sm",items:[{key:"inputs",label:"Inputs"},{key:"outputs",label:"Outputs"}]})]}):null,l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Filters"}),l.jsxs("div",{className:"composer-filters",children:[l.jsxs("label",{className:"inline-flex items-center gap-2",children:[l.jsx("input",{type:"checkbox",checked:g,onChange:D=>{y(D.target.checked),s(1)}}),l.jsx("span",{className:"text-sm text-[rgba(159,178,215,0.85)]",children:"Images only"})]}),l.jsx("input",{type:"search",value:m,onChange:D=>x(D.target.value),placeholder:"Search files",className:"sheet-input ui-control ui-input","aria-label":"Search files"}),l.jsx(Ze,{className:"sheet-select",value:o,onChange:D=>{const oe=parseInt(D,10)||50;i(oe),s(1)},"aria-label":"Items per page",size:"sm",options:[25,50,100]})]})]}),u.length>0?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Quick folders"}),l.jsx(br,{ariaLabel:"Quick folders",value:t,onChange:A,size:"sm",layout:"auto",wrap:!0,className:"imagepicker-chips",items:z})]}):null,l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Results"}),d?l.jsxs("div",{className:"sheet-hint",children:["Scanning ",p==="outputs"?"output":"input"," folders"]}):w.length===0?l.jsx("div",{className:"sheet-hint",children:"Nothing here yet. Try a different folder or turn off Images only."}):null,l.jsx("div",{className:"imagepicker-grid",children:!d&&w.map(D=>{const oe=`${D.source||"input"}::${D.rel_path||D.name}`,q=D.is_dir?"":D.preview_url||(D.source==="output"?Fo({filename:D.filename,subfolder:D.subfolder,type:D.type}):$o(D.rel_path||""));return l.jsx("button",{type:"button",className:`imagepicker-item ${D.is_dir?"is-dir":""}`,onClick:()=>{D.is_dir?(n(D.rel_path||""),s(1)):j(D)},children:D.is_dir?l.jsxs("div",{className:"imagepicker-dir-row",children:[l.jsx("div",{className:"imagepicker-dir-dot","aria-hidden":"true"}),l.jsx("div",{className:"imagepicker-name",children:D.name})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"imagepicker-thumb",children:q?l.jsx("img",{className:"imagepicker-img",alt:D.name,src:q}):l.jsx("div",{className:"imagepicker-img is-placeholder"})}),l.jsx("div",{className:"imagepicker-name",children:D.name})]})},oe)})})]})]})})}function xw({open:e,onClose:t,title:n,url:r,kind:s="image"}){return r?l.jsx(Lt,{open:e,onClose:t,title:n||"Preview",variant:"fullscreen",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("a",{href:r,target:"_blank",rel:"noreferrer",className:"ui-button is-muted w-full text-center",children:"Open"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Close"})]}),children:l.jsx("div",{className:"url-viewer-stage",children:s==="video"?l.jsx("video",{src:r,controls:!0,className:"url-viewer-media",autoPlay:!0}):l.jsx("img",{src:r,alt:n||"Preview",className:"url-viewer-media"})})}):null}function ww({input:e,value:t,onFormChange:n}){const{previewUrl:r,imgReady:s,setImgReady:o,displayName:i,serverOpen:a,openServer:u,closeServer:d,cwd:g,setCwd:y,page:m,setPage:x,perPage:w,setPerPage:j,totalPages:S,topDirs:h,loading:f,search:p,setSearch:v,imagesOnly:b,setImagesOnly:C,shownEntries:_,pickerSource:I,setPickerSource:z,handleUpload:A,clearImage:D,selectServer:oe}=pw({input:e,value:t,onFormChange:n}),q=c.useRef(null),je=c.useRef(null),[ye,ne]=c.useState(0),[me,R]=c.useState(!1);c.useEffect(()=>{const k=je.current;if(!k)return;const V=te=>{te.preventDefault(),te.stopPropagation()},G=async te=>{var X,ie;V(te);const re=(ie=(X=te.dataTransfer)==null?void 0:X.files)==null?void 0:ie[0];re&&(await A(re),q.current&&(q.current.value=""),ne(W=>W+1))};return["dragenter","dragover","dragleave","drop"].forEach(te=>k.addEventListener(te,te==="drop"?G:V)),()=>{["dragenter","dragover","dragleave","drop"].forEach(te=>k.removeEventListener(te,te==="drop"?G:V))}},[A]);const N=async k=>{var G;const V=(G=k.target.files)==null?void 0:G[0];V&&(await A(V),q.current&&(q.current.value=""),ne(te=>te+1))},E=()=>{q.current&&q.current.click()};return l.jsxs("div",{className:"asset-card",children:[l.jsxs("div",{className:"mb-2 flex items-center justify-between gap-2",children:[l.jsx("h3",{className:"text-sm font-semibold text-[#F8F4FF] truncate",children:i}),l.jsx("span",{className:"text-[11px] text-[#C3C7FFB3] truncate",children:"Image"})]}),l.jsx("div",{ref:je,className:"mb-3 rounded-xl border border-dashed border-[rgba(255,255,255,0.14)] bg-[rgba(255,255,255,0.02)] flex items-center justify-center min-h-[140px] sm:min-h-[180px] overflow-hidden",children:r?l.jsx("button",{type:"button",className:"asset-preview-btn",onClick:()=>R(!0),"aria-label":`Preview ${i}`,title:"Open preview",children:l.jsx("img",{src:r,alt:i,className:`max-h-64 max-w-full object-contain transition-opacity ${s?"opacity-100":"opacity-0"}`,onLoad:()=>o(!0)})}):l.jsx("div",{className:"text-[11px] text-[#9DA3FFCC] text-center px-6",children:"Drop an image here, upload from your device, or choose one from your server."})}),l.jsx("input",{ref:q,type:"file",accept:"image/*",className:"hidden",onChange:N},ye),l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx("button",{type:"button",className:"ui-button is-primary is-compact",onClick:u,children:"Choose"}),l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:E,children:"Upload"}),l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:D,children:"Clear"})]}),l.jsx(vw,{open:a,cwd:g,setCwd:y,page:m,setPage:x,perPage:w,setPerPage:j,totalPages:S,topDirs:h,loading:f,imagesOnly:b,setImagesOnly:C,search:p,setSearch:v,shownEntries:_,pickerSource:I,setPickerSource:z,onSelect:oe,onClose:d}),l.jsx(xw,{open:me,onClose:()=>R(!1),title:i||"Preview",url:r,kind:"image"})]})}function Sw({open:e,onClose:t,title:n,description:r,render:s,index:o=0,total:i=0,children:a}){const[u,d]=c.useState("idle"),g=c.useRef(null),y=c.useRef(null),m=w=>w?Array.from(w.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(j=>!j.hasAttribute("disabled")&&j.getAttribute("aria-hidden")!=="true"):[];if(c.useEffect(()=>{if(u==="queued"){const w=setTimeout(()=>d("idle"),1600);return()=>clearTimeout(w)}},[u]),c.useEffect(()=>{if(!e||typeof document>"u")return;const w=g.current;y.current=document.activeElement;const j=()=>{var p;const f=m(w)[0]||w;(p=f==null?void 0:f.focus)==null||p.call(f)},S=h=>{if(h.key==="Escape"){t==null||t();return}if(h.key!=="Tab"||!w)return;const f=m(w);if(!f.length){h.preventDefault(),w.focus();return}const p=f[0],v=f[f.length-1],b=document.activeElement;h.shiftKey&&b===p?(h.preventDefault(),v.focus()):!h.shiftKey&&b===v&&(h.preventDefault(),p.focus())};return requestAnimationFrame(j),w==null||w.addEventListener("keydown",S),()=>{var f;w==null||w.removeEventListener("keydown",S);const h=y.current;h&&document.contains(h)&&((f=h.focus)==null||f.call(h))}},[e,t]),!e)return null;const x=typeof s=="function"?s():a;return l.jsxs("div",{className:"spotlight-overlay",role:"dialog","aria-modal":"true",children:[l.jsx("div",{className:"spotlight-backdrop",onClick:t}),l.jsxs("div",{className:"spotlight-sheet",ref:g,tabIndex:-1,children:[l.jsxs("div",{className:"spotlight-header",children:[l.jsxs("div",{className:"spotlight-meta",children:[l.jsx("div",{className:"spotlight-kicker",children:"Focused control"}),l.jsx("div",{className:"spotlight-title",children:n||"Control"}),r?l.jsx("div",{className:"spotlight-hint",children:r}):null]}),l.jsx("button",{type:"button",className:"spotlight-close",onClick:t,"aria-label":"Close",children:l.jsx(ur,{size:16})})]}),l.jsx("div",{className:"spotlight-body",children:x}),l.jsx("div",{className:"spotlight-footer",children:l.jsx("div",{className:"spotlight-footer-right",children:l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:t,"aria-label":"Close",children:"Close"})})})]})]})}function jw({open:e,onClose:t,title:n,value:r,onChange:s,placeholder:o="",description:i}){const a=n||"Edit",u=c.useMemo(()=>`sheet-textarea-${Math.random().toString(36).slice(2,9)}`,[]);return l.jsxs(Lt,{open:e,onClose:t,title:a,variant:"fullscreen",footer:l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Done"}),children:[i?l.jsx("div",{className:"text-[12px] text-[rgba(159,178,215,0.75)] mb-3",children:i}):null,l.jsx("textarea",{id:u,value:r??"",onChange:d=>s==null?void 0:s(d.target.value),placeholder:o,className:"sheet-textarea ui-control ui-textarea",rows:12})]})}function Rn(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(2).replace(/\.?0+$/u,""):"1"}function Nw(e=""){const t=String(e||"");if(!t.trim())return[];const n=[];let r=0;for(;r<t.length;){for(;r<t.length&&/[\s,]/.test(t[r]);)r++;if(r>=t.length)break;let s=r,o=r,i="tag",a="";const u=t[r]==="(";if(u&&(s=r,r++),t[r]==="$"){i="alias";const d=r;for(r++;r<t.length&&t[r]!=="$"&&t[r]!==","&&t[r]!==`
`;)a+=t[r],r++;t[r]==="$"&&r++,u||(s=d)}else{i="tag";const d=r;for(;r<t.length&&!(t[r]===","||t[r]==="$"||t[r]===`
`||u&&t[r]===":"||!u&&t[r]==="(");)a+=t[r],r++;a=a.trim(),u||(s=d)}if(u&&t[r]===":"){for(r++;r<t.length&&t[r]!==")"&&t[r]!==","&&t[r]!==`
`;)r++;t[r]===")"&&r++}o=r,a&&n.push({type:i,text:a,start:s,end:o})}return n}function rf(e="",t){if(!t||typeof t.start!="number"||typeof t.end!="number")return null;const r=String(e||"").slice(t.start,t.end);if(!r.startsWith("(")||!r.includes(":"))return null;const s=r.lastIndexOf(":");if(s===-1)return null;const o=r.slice(s+1);if(!o.endsWith(")"))return null;const i=o.slice(0,-1).trim();if(!/^\d+(\.\d+)?$/u.test(i))return null;const a=Number.parseFloat(i);return Number.isFinite(a)?{weight:a,wrapperStart:t.start,wrapperEnd:t.end}:null}function sf(e="",t,n){const r=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return r;const s=n==null?null:Number(n),o=s===null||!Number.isFinite(s)||Math.abs(s-1)<1e-6,i=t.type==="alias"?`$${t.text}$`:t.text;if(o)return r.slice(0,t.start)+i+r.slice(t.end);const a=Rn(s),u=`(${i}:${a})`;return r.slice(0,t.start)+u+r.slice(t.end)}function lf(e="",t,n,r){var m;if(n===r||n===null||r===null||!(t!=null&&t.length))return e;const s=String(e||""),o=t.map(x=>({start:x.start,end:x.end,text:s.slice(x.start,x.end)})),i=o.slice(0,-1).map((x,w)=>{const j=o[w+1];return s.slice(x.end,j.start)}),a=o.length?s.slice(0,o[0].start):"",u=o.length?s.slice(o[o.length-1].end):"",d=[...o],[g]=d.splice(n,1);d.splice(r,0,g);let y=a+(((m=d[0])==null?void 0:m.text)||"");for(let x=1;x<d.length;x++)y+=(i[x-1]??", ")+d[x].text;return y+=u,y}function kw(e="",t){const n=String(e||"");if(!t||typeof t.start!="number"||typeof t.end!="number")return n;const r=n.slice(0,t.start).replace(/[\s,]*$/,""),s=n.slice(t.end).replace(/^[\s,]*/,"");return r?`${r}, ${s}`.trim():s.trim()}function $r(e="",t){if(!t||typeof t.index!="number"||typeof t.length!="number")return null;const n=String(e||""),r=t.index,s=t.index+t.length;if(r<=0||n[r-1]!=="("||n[s]!==":")return null;let o=s+1,i="";for(;o<n.length&&n[o]!==")";)if(i+=n[o],o+=1,i.length>12)return null;if(o>=n.length||n[o]!==")")return null;const a=i.trim();if(!/^\d+(\.\d+)?$/u.test(a))return null;const u=Number.parseFloat(a);return Number.isFinite(u)?{weight:u,wrapperStart:r-1,wrapperEnd:o+1}:null}function Wl(e="",t,n){const r=String(e||"");if(!t||typeof t.index!="number"||typeof t.length!="number")return r;const s=t.index,o=t.index+t.length,i=$r(r,t),a=n==null?null:Number(n),u=a===null||!Number.isFinite(a)||Math.abs(a-1)<1e-6;if(i){if(u)return r.slice(0,i.wrapperStart)+r.slice(s,o)+r.slice(i.wrapperEnd);const g=Rn(a);return r.slice(0,o+1)+g+r.slice(i.wrapperEnd-1)}if(u)return r;const d=Rn(a);return r.slice(0,s)+"("+r.slice(s,o)+":"+d+")"+r.slice(o)}function Hl(e,t,n){const r=Number(e);return Number.isFinite(r)?Math.max(t,Math.min(n,r)):t}function rc({open:e,onClose:t,title:n="Alias strength",tokenLabel:r="",weight:s=1,onApply:o,onRemoveWeight:i,onDeleteToken:a}){const u=c.useMemo(()=>Hl(s||1,.2,2),[s]),[d,g]=c.useState(u);c.useEffect(()=>{e&&g(u)},[e,u]);const y=Rn(d);return l.jsx(Lt,{open:e,onClose:t,title:n,footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:t,children:"Cancel"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>{o==null||o(d),t==null||t()},children:"Done"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Alias"}),l.jsx("div",{className:"sheet-hint",children:r||""})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Strength"}),l.jsxs("div",{className:"flex items-center justify-between gap-3",children:[l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>g(m=>Hl(m-.05,.2,2)),children:""}),l.jsxs("div",{className:"text-sm text-[rgba(237,242,255,0.92)] tabular-nums",children:[y,""]}),l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>g(m=>Hl(m+.05,.2,2)),children:"+"})]}),l.jsx("input",{type:"range",min:.2,max:2,step:.05,value:d,onChange:m=>g(Hl(m.target.value,.2,2)),className:"w-full","aria-label":"Alias strength"}),l.jsx("div",{className:"sheet-hint",children:"1.0 is normal. Increase to emphasize or reduce to soften."})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Actions"}),l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>g(1),children:"Reset to 1.0"}),l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>{i==null||i(),t==null||t()},children:"Remove strength"}),l.jsx("button",{type:"button",className:"ui-button is-danger is-compact",onClick:()=>{a==null||a(),t==null||t()},children:"Remove alias"})]})]})]})})}function xr(e){const t=String(e||"").trim();if(!t)return"";const n=t.toLowerCase(),r={scifi:"Sci-Fi",sci:"Sci",ui:"UI",vfx:"VFX",hdr:"HDR",dof:"DoF",bokeh:"Bokeh",vhs:"VHS",jpeg:"JPEG",jpg:"JPG",png:"PNG",gif:"GIF",webp:"WebP",api:"API",nsfw:"NSFW",sfw:"SFW",sfx:"SFX",fx:"FX",lora:"LoRA",loras:"LoRAs",ip:"IP",egirl:"E-girl",i2v:"I2V",t2i:"T2I",img2img:"Img2Img",txt2img:"Txt2Img",tts:"TTS",asmr:"ASMR",ai:"AI",highleg:"High-Leg","one-piece":"One-Piece","three-quarter":"Three-Quarter"};return r[n]?r[n]:/^\d+$/.test(n)?n:n==="3d"?"3D":n==="2d"?"2D":n.length===1?n.toUpperCase():n.charAt(0).toUpperCase()+n.slice(1)}function bw(e=""){const t=String(e||"").trim().toLowerCase();return t?t.startsWith("flirty_")?"flirty":t.startsWith("action_")||t.startsWith("dynamic_")||t.startsWith("stealth_")||t.startsWith("athletic_")||t.startsWith("running_")||t.startsWith("walking_")?"action":t.startsWith("sleepy_")||t.startsWith("relaxed_")||t.startsWith("reclining_")||t.startsWith("sitting_")||t.startsWith("kneeling_")?"rest":t.startsWith("happy_")||t.startsWith("sad_")||t.startsWith("angry_")||t.startsWith("nervous_")||t.startsWith("smug_")||t.startsWith("surprised_")||t.startsWith("scared_")||t.startsWith("tipsy_")?"emotion":t.startsWith("composed_")||t.startsWith("contemplative_")||t.startsWith("looking_")?"posed":"everyday":""}function Cw(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return n==="lingerie"?"lingerie":n==="swimwear"||n==="swim"?"swimwear":n==="costumes"||n==="tech"?"costumes":n==="uniform"?"uniform":n==="formal"?"formal":n==="alt"?"alt":n==="casual"||n==="street"||n==="lounge"||n==="sporty"||n==="dress"?"everyday":n||"everyday"}function Ew(e=""){const t=String(e||"").trim().toLowerCase();if(!t)return"";const n=t.split("_")[0]||"";return["fire","candlelight","embers"].includes(n)?"fire":["moonlight"].includes(n)?"night":["neon"].includes(n)?"neon":["studio","stage","sidelighting","dim"].includes(n)?"studio":["golden","sunbeam","dappled"].includes(n)?"natural":["lens","light"].includes(n)?"effects":n||"other"}function Is(e="",t=""){const n=String(e||"").trim(),r=String(t||"").trim().toLowerCase();if(!n)return"";if(r==="outfit")return Cw(n)||"everyday";if(r==="pose")return bw(n)||"everyday";if(r==="lighting")return Ew(n)||"effects";const s=n.indexOf("_");return s<=0?"":n.slice(0,s).trim()}function ym(e=""){const t=String(e||"").trim();return t?t.includes(":")?t.split(":").slice(1).join(":"):t:""}function Oo({token:e="",name:t=""}={}){const n=String(t||"").trim()||ym(e);if(!n)return"";let s=n.replace(/_(\d+)$/u,"").split("_").filter(Boolean);if(s.length===0)return n;const o=[];for(let y=0;y<s.length;y++){const m=s[y],x=s[y+1];if(m&&x&&m.toLowerCase()==="one"&&x.toLowerCase()==="piece"){o.push("one-piece"),y+=1;continue}if(m&&x&&m.toLowerCase()==="three"&&x.toLowerCase()==="quarter"){o.push("three-quarter"),y+=1;continue}o.push(m)}if(s=o,Array.from(new Set(s.map(y=>String(y).toLowerCase()))).length===1)return xr(s[0]);const a=s[0],u=s.slice(1),d=xr(a),g=u.map(xr).join(" ").trim();return g?g.toLowerCase()===d.toLowerCase()?u.length===1&&String(u[0]).toLowerCase()===String(a).toLowerCase()?d||n:s.map(xr).join(" ").trim()||n:`${d} - ${g}`:s.map(xr).join(" ").trim()||n}function du(e){if(!e)return{subcategory:"",displayName:""};const t=e.name||"",n=e.token||"",r=ym(n)||t,s=Is(r,e.category)||"other",o=Oo({token:n,name:t})||n||t||"Alias";return{subcategory:s,displayName:o}}function In(e=""){const t=String(e||"").trim();return t?t==="All"?"All":{action:"Actions",camera:"Camera",body:"Body",char:"Characters",mood:"Mood",outfit:"Outfits",pose:"Poses",prop:"Props",scene:"Scenes",weather:"Weather",style:"Style",hair:"Hair",lighting:"Lighting"}[t]||xr(t):""}function dr(e=""){const t=String(e||"").trim();return t?t==="All"?"All":t.split(/[_-]+/u).filter(Boolean).map(n=>xr(n)).join(" ").trim():""}const Lw={contentVisibility:"auto",containIntrinsicSize:"240px 120px"};function Pw({name:e,label:t,description:n,value:r,onChange:s,onEnter:o,disabled:i=!1,multiline:a=!1,aliasOptions:u=[],aliasCatalog:d=[],onOpenComposer:g}){var mt,ut;const y=c.useRef(null),m=c.useRef(null),x=c.useRef({start:null,end:null}),w=c.useRef(null),j=c.useRef(null),[S,h]=c.useState(null),[f,p]=c.useState(null),[v,b]=c.useState(!1),[C,_]=c.useState(""),I=c.useDeferredValue(C),[z,A]=c.useState("All"),[D,oe]=c.useState("All"),[q]=c.useState([]),je=c.useRef(null),[ye,ne]=c.useState(!1),[me,R]=c.useState(!1),[N,E]=c.useState(null),k=typeof r=="string"?r:String(r??"");c.useMemo(()=>Array.isArray(u)?u.filter(Boolean):[],[u]);const V=c.useMemo(()=>(Array.isArray(d)?d.filter(M=>M&&M.name):[]).map(M=>({...M,...du(M)})),[d]),G=c.useMemo(()=>V,[V]),te=M=>{const Z=M.target.value;s==null||s(Z)},re=M=>{if(!a&&M.key==="Enter"){M.preventDefault(),o==null||o(M.target.value,M);return}},X=c.useMemo(()=>{const M=new Map;return G.forEach(Z=>{Z!=null&&Z.token&&M.set(String(Z.token).toLowerCase(),Z)}),M},[G]),ie=c.useMemo(()=>{const M=new Set(["All"]);return V.forEach(Z=>{Z.category&&M.add(Z.category)}),Array.from(M).sort((Z,xe)=>Z.localeCompare(xe))},[V]),W=c.useMemo(()=>{const M=new Set(["All"]);return G.forEach(Z=>{(!z||z==="All"||Z.category===z)&&Z.subcategory&&M.add(Z.subcategory)}),Array.from(M).sort((Z,xe)=>Z.localeCompare(xe))},[G,z]);c.useEffect(()=>{oe("All")},[z]);const F=c.useMemo(()=>{const M=k||"";if(!M||!M.includes("$"))return[];const Z=[],xe=/\$([a-z0-9_:-]+)\$/gi;let Ie;for(;Ie=xe.exec(M);)Z.push({token:Ie[1],index:Ie.index,length:Ie[0].length});return Z},[k]),O=()=>{try{const M=y.current;M?x.current={start:M.selectionStart??null,end:M.selectionEnd??null}:x.current={start:null,end:null}}catch{x.current={start:null,end:null}}m.current&&m.current.scrollIntoView({block:"center",behavior:"smooth"}),b(!0)},se=c.useMemo(()=>{const M=I.trim().toLowerCase();return G.filter(Z=>{var xe,Ie,U,Y;return z!=="All"&&(Z.category||"")!==z||D!=="All"&&(Z.subcategory||"other")!==D?!1:M?((xe=Z.token)==null?void 0:xe.toLowerCase().includes(M))||((Ie=Z.text)==null?void 0:Ie.toLowerCase().includes(M))||((U=Z.name)==null?void 0:U.toLowerCase().includes(M))||((Y=Z.displayName)==null?void 0:Y.toLowerCase().includes(M)):!0}).sort((Z,xe)=>{const Ie=(Z.subcategory||"").toLowerCase(),U=(xe.subcategory||"").toLowerCase();return Ie!==U?Ie.localeCompare(U):Z.token.localeCompare(xe.token)})},[G,z,D,I]),[ce,Re]=c.useState(30),Ne=c.useMemo(()=>se.slice(0,ce),[se,ce]);c.useEffect(()=>{Re(30)},[z,D,C,V]),c.useEffect(()=>{oe("All")},[z]);const Ee=(M,{closeAfter:Z=!0}={})=>{var nt,Nn;const xe=y.current,Ie=`$${M}$`,U=k||"",Y=(nt=x.current)==null?void 0:nt.start,ae=(Nn=x.current)==null?void 0:Nn.end,we=(xe==null?void 0:xe.selectionStart)??(typeof Y=="number"?Y:U.length),de=(xe==null?void 0:xe.selectionEnd)??(typeof ae=="number"?ae:U.length),P=U.slice(0,we),$=U.slice(de),H=P.match(/[^\s]$/),K=$.match(/^[^\s]/),be=H&&H[0]!==","?", ":"",Se=K&&K[0]!==","?", ":"",qe=P+be+Ie+Se+$;s==null||s(qe);const Te=(P+be+Ie+Se).length;x.current={start:Te,end:Te},Z&&(b(!1),requestAnimationFrame(()=>{var kn;(kn=xe==null?void 0:xe.blur)==null||kn.call(xe)}))},Me=M=>{const Z=k||"",xe=$r(Z,M),Ie=xe?xe.wrapperStart:M.index,U=xe?xe.wrapperEnd:M.index+M.length,Y=Z.slice(0,Ie).replace(/[\s,]*$/,""),ae=Z.slice(U).replace(/^[\s,]*/,""),we=Y?`${Y} ${ae}`.trim():ae.trim();s==null||s(we)},Ke=M=>{if(!M)return;const Z=X.get(M.token.toLowerCase()),xe=(Z==null?void 0:Z.displayName)||M.token,Ie=$r(k||"",M);E({tokenObj:M,displayName:xe,weight:(Ie==null?void 0:Ie.weight)??1}),R(!0),requestAnimationFrame(()=>{var U,Y;return(Y=(U=y.current)==null?void 0:U.blur)==null?void 0:Y.call(U)})},le=c.useMemo(()=>(M,Z)=>{var $;if(M===Z||M===null||Z===null||!(F!=null&&F.length))return;const xe=k||"",Ie=F.map(H=>{const K=$r(xe,H),be=K?K.wrapperStart:H.index,Se=K?K.wrapperEnd:H.index+H.length;return{start:be,end:Se,text:xe.slice(be,Se)||`$${H.token}$`}}),U=Ie.slice(0,-1).map((H,K)=>{const be=Ie[K+1];return xe.slice(H.end,be.start)}),Y=Ie.length?xe.slice(0,Ie[0].start):"",ae=Ie.length?xe.slice(Ie[Ie.length-1].end):"",we=[...Ie],[de]=we.splice(M,1);we.splice(Z,0,de);let P=Y+((($=we[0])==null?void 0:$.text)||"");for(let H=1;H<we.length;H+=1)P+=(U[H-1]??", ")+we[H].text;P+=ae,s==null||s(P)},[s,F,k]),fe=(M,Z)=>{h(Z),w.current=M.currentTarget,M.dataTransfer.effectAllowed="move",M.dataTransfer.setData("text/plain",String(Z)),requestAnimationFrame(()=>{w.current&&w.current.classList.add("is-dragging")})},Pe=(M,Z)=>{M.preventDefault(),M.dataTransfer.dropEffect="move",Z!==f&&p(Z)},We=M=>{M!==f&&p(M)},Q=M=>{S!==null&&M!==null&&S!==M&&le(S,M),h(null),p(null),w.current=null},ue=()=>{w.current&&w.current.classList.remove("is-dragging"),Q(f)},ve=(M,Z)=>{M.preventDefault(),Q(Z)},ge=(M,Z)=>{var U,Y;if(!((Y=(U=M.target)==null?void 0:U.closest)==null?void 0:Y.call(U,".token-chip-drag-handle")))return;const Ie=M.touches[0];j.current={idx:Z,startX:Ie.clientX,startY:Ie.clientY,moved:!1}},ke=M=>{if(!j.current)return;const Z=M.touches[0],xe=Math.abs(Z.clientX-j.current.startX),Ie=Math.abs(Z.clientY-j.current.startY);if(xe<=10&&Ie<=10)return;j.current.moved=!0,h(j.current.idx),M.preventDefault();const U=m.current,Y=U?U.querySelectorAll(".token-chip-draggable"):document.querySelectorAll(".token-chip-draggable"),ae=Z.clientX,we=Z.clientY;for(let de=0;de<Y.length;de++){const P=Y[de].getBoundingClientRect();if(ae>=P.left&&ae<=P.right&&we>=P.top&&we<=P.bottom){p(de);break}}},Le=()=>{var M;(M=j.current)!=null&&M.moved&&S!==null&&f!==null&&S!==f&&le(S,f),j.current=null,h(null),p(null)},Fe={id:e,name:e,value:k,onChange:te,disabled:i,className:"ui-control ui-input pr-10 text-[13px] sm:text-sm",placeholder:"","aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0},He=()=>{b(!1),requestAnimationFrame(()=>{var M,Z;(Z=(M=y.current)==null?void 0:M.blur)==null||Z.call(M)})},it=(()=>{const M=String(e||"").toLowerCase(),Z=String(t||"").toLowerCase();return!!`${M} ${Z}`.trim().includes("prompt")})(),ht=()=>l.jsx(Lt,{open:v,onClose:He,title:it?"Insert alias":"Aliases",footer:l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:He,children:"Done"}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Search"}),l.jsxs("div",{className:"composer-filters",children:[l.jsx("input",{ref:je,type:"text",value:C,onChange:M=>_(M.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),l.jsx(Ze,{value:z,onChange:A,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:["All",...ie.filter(M=>M!=="All")].map(M=>({value:M,label:M==="All"?"Category: All":In(M)}))}),W.length>2?l.jsx(Ze,{value:D,onChange:oe,className:"composer-subcategory-select",size:"sm",options:W.map(M=>({value:M,label:M==="All"?"All subcategories":dr(M)}))}):null]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Results"}),l.jsx("div",{className:"composer-alias-list",children:se.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):l.jsxs(l.Fragment,{children:[Ne.map(M=>l.jsxs("button",{type:"button",onClick:()=>Ee(M.token,{closeAfter:!it}),className:"composer-alias-item",style:Lw,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:M.displayName||M.token}),M.category?l.jsx("span",{className:"composer-alias-category",children:In(M.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",M.token,"$"]}),l.jsx("div",{className:"composer-alias-text",children:M.text})]},M.key)),ce<se.length?l.jsxs("button",{type:"button",onClick:()=>Re(M=>Math.min(M+30,se.length)),className:"ui-button is-muted w-full",children:["Show more (",se.length-ce," left)"]}):null]})})]})]})});return a?l.jsxs("div",{className:"relative space-y-2",ref:m,children:[g&&!it?l.jsxs("div",{className:"stringinput-toolbar",children:[l.jsx("button",{type:"button",className:"ui-button is-muted is-compact",onClick:()=>g(e),children:"Open composer"}),V.length?l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:O,children:"Aliases"}):null,l.jsx("button",{type:"button",className:"ui-button is-ghost is-compact",onClick:()=>ne(!0),children:"Expand"})]}):null,l.jsx("textarea",{ref:y,...Fe,rows:3,wrap:"soft",onKeyDown:re,className:Fe.className+" resize-none min-h-[88px] max-h-[160px] leading-relaxed overflow-y-auto overflow-x-hidden break-words whitespace-pre-wrap",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"anywhere"}}),g&&it?l.jsx("div",{className:"stringinput-underbar",children:l.jsxs("div",{className:"stringinput-underbar-actions",children:[l.jsx("button",{type:"button",className:"stringinput-action-link",onClick:()=>g(e),children:"Open composer"}),V.length?l.jsx("button",{type:"button",className:"stringinput-action-link",onClick:O,children:"Insert alias"}):null]})}):null,l.jsx(jw,{open:ye,onClose:()=>ne(!1),title:t||e,value:k,onChange:s,description:n}),F.length?l.jsxs("div",{className:"stringinput-tokens",children:[l.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",l.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),l.jsx("div",{className:"stringinput-tokens-list",children:F.map((M,Z)=>{var we;const xe=X.get(M.token.toLowerCase()),Ie=(xe==null?void 0:xe.displayName)||M.token,U=S===Z,Y=f===Z&&S!==null&&S!==Z,ae=((we=$r(k||"",M))==null?void 0:we.weight)??1;return l.jsxs("div",{className:`token-chip token-chip-draggable ${U?"is-dragging":""} ${Y?"is-drop-target":""}`,title:`$${M.token}$`,role:"button",tabIndex:0,draggable:!0,onDragStart:de=>fe(de,Z),onDragEnd:ue,onDragEnter:()=>We(Z),onDragOver:de=>Pe(de,Z),onDrop:de=>ve(de,Z),onTouchStart:de=>ge(de,Z),onTouchMove:ke,onTouchEnd:Le,onClick:()=>{S===null&&Ke(M)},onKeyDown:de=>{(de.key==="Enter"||de.key===" ")&&(de.preventDefault(),Ke(M))},children:[l.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:l.jsx(Za,{size:14})}),l.jsx("span",{className:"token-chip-label",children:Ie}),Math.abs(ae-1)>1e-6?l.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${Rn(ae)}x`,children:["",Rn(ae)]}):null,l.jsx("button",{type:"button",className:"token-chip-remove",onClick:de=>{de.stopPropagation(),Me(M)},"aria-label":`Remove ${M.token}`,children:l.jsx(ur,{size:12})})]},`${M.token}-${M.index}`)})})]}):null,l.jsx(rc,{open:me,onClose:()=>R(!1),title:"Alias strength",tokenLabel:N?`${N.displayName}  $${(mt=N.tokenObj)==null?void 0:mt.token}$`:"",weight:(N==null?void 0:N.weight)??1,onApply:M=>{N!=null&&N.tokenObj&&(s==null||s(Wl(k||"",N.tokenObj,M)))},onRemoveWeight:()=>{N!=null&&N.tokenObj&&(s==null||s(Wl(k||"",N.tokenObj,null)))},onDeleteToken:()=>{N!=null&&N.tokenObj&&Me(N.tokenObj)}}),v?l.jsx(ht,{}):null]}):l.jsxs("div",{className:"relative space-y-2",ref:m,children:[l.jsx("input",{...Fe,type:"text",inputMode:"text",autoComplete:"off",onKeyDown:re,className:Fe.className+" min-h-[44px]",ref:y}),F.length?l.jsxs("div",{className:"stringinput-tokens",children:[l.jsxs("div",{className:"stringinput-tokens-label",children:["Active aliases ",l.jsx("span",{className:"stringinput-tokens-hint",children:"(drag to reorder)"})]}),l.jsx("div",{className:"stringinput-tokens-list",children:F.map((M,Z)=>{var we;const xe=X.get(M.token.toLowerCase()),Ie=(xe==null?void 0:xe.displayName)||M.token,U=S===Z,Y=f===Z&&S!==null&&S!==Z,ae=((we=$r(k||"",M))==null?void 0:we.weight)??1;return l.jsxs("div",{className:`token-chip token-chip-draggable ${U?"is-dragging":""} ${Y?"is-drop-target":""}`,title:`$${M.token}$`,onClick:()=>{S===null&&Ke(M)},role:"button",tabIndex:0,draggable:!0,onDragStart:de=>fe(de,Z),onDragEnd:ue,onDragEnter:()=>We(Z),onDragOver:de=>Pe(de,Z),onDrop:de=>ve(de,Z),onTouchStart:de=>ge(de,Z),onTouchMove:ke,onTouchEnd:Le,onKeyDown:de=>{(de.key==="Enter"||de.key===" ")&&(de.preventDefault(),Ke(M))},children:[l.jsx("span",{className:"token-chip-drag-handle","aria-hidden":"true",children:l.jsx(Za,{size:14})}),l.jsx("span",{className:"token-chip-label",children:Ie}),Math.abs(ae-1)>1e-6?l.jsxs("span",{className:"token-chip-weight","aria-label":`Strength ${Rn(ae)}x`,children:["",Rn(ae)]}):null,l.jsx("button",{type:"button",className:"token-chip-remove",onClick:de=>{de.stopPropagation(),Me(M)},"aria-label":`Remove ${M.token}`,children:l.jsx(ur,{size:12})})]},`${M.token}-${M.index}`)})})]}):null,l.jsx(rc,{open:me,onClose:()=>R(!1),title:"Alias strength",tokenLabel:N?`${N.displayName}  $${(ut=N.tokenObj)==null?void 0:ut.token}$`:"",weight:(N==null?void 0:N.weight)??1,onApply:M=>{N!=null&&N.tokenObj&&(s==null||s(Wl(k||"",N.tokenObj,M)))},onRemoveWeight:()=>{N!=null&&N.tokenObj&&(s==null||s(Wl(k||"",N.tokenObj,null)))},onDeleteToken:()=>{N!=null&&N.tokenObj&&Me(N.tokenObj)}}),V.length?l.jsx("button",{type:"button",className:"stringinput-trailing ui-button is-ghost is-compact",onClick:()=>g?g(e):O(),title:g?"Open prompt composer":"Insert alias","aria-label":g?"Open prompt composer":"Insert alias",children:g?l.jsx(au,{size:16}):l.jsx(cr,{size:16})}):null,l.jsx(ht,{})]})}const of=c.memo(Pw),af=e=>e==null?void 0:String(e).trim().replace(/[^A-Za-z0-9_-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||void 0;function _w({name:e,label:t,description:n,value:r,onChange:s,disabled:o=!1,min:i,max:a,step:u,isFloat:d=!1,inputId:g}){const y=u??(d?.01:1),m=g??af(e),x=S=>{if(S===""||S===null||S===void 0)return"";const h=d?parseFloat(S):parseInt(S,10);return Number.isNaN(h)?"":h},w=S=>{const h=S.target.value,f=x(h);s==null||s(f)},j=S=>{if(S.key!=="ArrowUp"&&S.key!=="ArrowDown")return;S.preventDefault();const h=typeof r=="number"?r:x(String(r??""))||0,f=S.key==="ArrowUp"?y:-y;let p=h+f;if(typeof i=="number"&&(p=Math.max(i,p)),typeof a=="number"&&(p=Math.min(a,p)),d){const v=typeof y=="number"?(String(y).split(".")[1]||"").length:2;p=parseFloat(p.toFixed(Math.max(v,2)))}s==null||s(p)};return l.jsxs("div",{className:"w-full flex items-center gap-2",children:[l.jsx("input",{id:m,name:e,type:"number",inputMode:d?"decimal":"numeric",value:r??"",onChange:w,onKeyDown:j,disabled:o,min:i,max:a,step:y,"aria-label":t||e,"aria-describedby":n?`${m||af(e)||e}-description`:void 0,className:"ui-control ui-input"}),typeof i=="number"||typeof a=="number"?l.jsxs("div",{className:"hidden sm:flex flex-col text-[10px] text-[#6A6FA8] text-right leading-tight",children:[typeof i=="number"&&l.jsxs("span",{children:["min ",i]}),typeof a=="number"&&l.jsxs("span",{children:["max ",a]})]}):null]})}const Vs=c.memo(_w);function Rw({name:e,label:t,description:n,value:r,onChange:s,disabled:o=!1}){const i=!!r,a=()=>{o||s==null||s(!i)},u=d=>{(d.key===" "||d.key==="Enter")&&(d.preventDefault(),a())};return l.jsxs("button",{id:e,type:"button",role:"switch","aria-checked":i,"aria-label":t||e,"aria-describedby":n?`${e}-description`:void 0,onClick:a,onKeyDown:u,disabled:o,className:`ui-switch ${i?"is-on":""}`,children:[l.jsx("span",{className:"ui-switch-track",children:l.jsx("span",{className:"ui-switch-knob"})}),l.jsx("span",{className:"ui-switch-state",children:i?"On":"Off"})]})}const cf=c.memo(Rw),Iw=/\.(safetensors|ckpt|pt|pth)$/i,zw=/\.([a-z0-9]{2,16})$/i,Aw=e=>/[a-z]/i.test(e),pi=e=>e.replace(/\\/g,"/"),vm=e=>{const{folder:t,base:n}=Tw(e);if(!n)return e;if(!t)return n;const r=t.split(/\s+/).filter(Boolean),s=r[r.length-1]||"";if(s&&n.toLowerCase().startsWith(s.toLowerCase())){const o=n.slice(s.length);return o?`${t}${o}`:t}return`${t} ${n}`.trim()};function xm(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const r=pi(t).split("/").filter(Boolean).pop()||"";return Iw.test(r)}function fs(e){if(typeof e!="string")return!1;const t=e.trim();if(!t)return!1;const s=(pi(t).split("/").filter(Boolean).pop()||"").match(zw);return s?Aw(s[1]):!1}function hi(e){if(typeof e!="string")return{folderPath:"",base:"",filename:""};const t=pi(e.trim());if(!t)return{folderPath:"",base:"",filename:""};const n=t.split("/").filter(Boolean),r=n.pop()||"",s=r.replace(/\.[^.]+$/,"");return{folderPath:n.join("/"),base:s,filename:r}}function Tw(e){if(typeof e!="string")return{folder:"",base:""};const n=pi(e.trim()).split("/").filter(Boolean),s=(n.pop()||"").replace(/\.[^.]+$/,"");return{folder:n.join(" ").trim(),base:s}}function Mw(e){return xm(e)?vm(e):e}function $w(e){return fs(e)?vm(e):e}function pn(e){if(!fs(e))return e;const{base:t}=hi(e);return t||$w(e)}function Fw(e,t){try{if(typeof window>"u"||!e)return null;const n=e.getItem(t);return n?JSON.parse(n):null}catch{return null}}function mi(e,t,n){try{if(typeof window>"u"||!e)return;e.setItem(t,JSON.stringify(n))}catch{}}function un(){try{return typeof window>"u"?null:window.sessionStorage||null}catch{return null}}function vs(){try{return typeof window>"u"?null:window.localStorage||null}catch{return null}}const wm=750,An=new Map,mn=new Map,gn=new Map,rs=new Map,yn=new Map,vn=new Map;function Sm(e){var t;if(mn.has(e)&&(clearTimeout(mn.get(e)),mn.delete(e)),gn.has(e)){try{(t=window.cancelIdleCallback)==null||t.call(window,gn.get(e))}catch{}gn.delete(e)}An.has(e)&&(mi(un(),e,An.get(e)),An.delete(e))}function Ow(e){var r;if(mn.has(e)&&(clearTimeout(mn.get(e)),mn.delete(e)),gn.has(e)){try{(r=window.cancelIdleCallback)==null||r.call(window,gn.get(e))}catch{}gn.delete(e)}const t=()=>{An.has(e)&&(mi(un(),e,An.get(e)),An.delete(e))},n=setTimeout(()=>{mn.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const s=window.requestIdleCallback(()=>{gn.delete(e),t()},{timeout:2500});gn.set(e,s);return}}catch{}t()},wm);mn.set(e,n)}function Dw(){Array.from(mn.values()).forEach(e=>clearTimeout(e)),mn.clear(),Array.from(gn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),gn.clear(),Array.from(An.entries()).forEach(([e,t])=>{mi(un(),e,t)}),An.clear(),Array.from(yn.values()).forEach(e=>clearTimeout(e)),yn.clear(),Array.from(vn.values()).forEach(e=>{var t;try{(t=window.cancelIdleCallback)==null||t.call(window,e)}catch{}}),vn.clear(),Array.from(rs.entries()).forEach(([e,t])=>{try{const n=un();n&&n.setItem(e,t)}catch{}}),rs.clear()}if(typeof window<"u"&&!window.__cozygenFormStateFlush){const e=()=>Dw();window.addEventListener("beforeunload",e),window.addEventListener("pagehide",e),window.__cozygenFormStateFlush=!0}function Uw(e){var r;if(!e)return{};const t=`${e}_formData`,n=Fw(un(),t);if(n&&typeof n=="object")return n;try{const s=vs();(r=s==null?void 0:s.removeItem)==null||r.call(s,t)}catch{}return{}}function Do(e,t,n={}){var o;if(!e)return;const{immediate:r=!1}=n||{},s=`${e}_formData`;if(r){Sm(s),mi(un(),s,t||{});try{const i=vs();(o=i==null?void 0:i.removeItem)==null||o.call(i,s)}catch{}return}An.set(s,t||{}),Ow(s)}function Bw(e){e&&Sm(`${e}_formData`)}function Vw(e,t,n=wm){var o;if(rs.set(e,t),yn.has(e)&&(clearTimeout(yn.get(e)),yn.delete(e)),vn.has(e)){try{(o=window.cancelIdleCallback)==null||o.call(window,vn.get(e))}catch{}vn.delete(e)}const r=()=>{const i=rs.get(e);rs.delete(e);try{const a=un();a&&a.setItem(e,i)}catch{}},s=setTimeout(()=>{yn.delete(e);try{if(typeof window<"u"&&typeof window.requestIdleCallback=="function"){const i=window.requestIdleCallback(()=>{vn.delete(e),r()},{timeout:2e3});vn.set(e,i);return}}catch{}r()},n);yn.set(e,s)}function Ww(e,t={}){var s,o;const{immediate:n=!1}=t||{},r="cozygen_last_param";if(n){if(yn.has(r)&&(clearTimeout(yn.get(r)),yn.delete(r)),vn.has(r)){try{(s=window.cancelIdleCallback)==null||s.call(window,vn.get(r))}catch{}vn.delete(r)}rs.delete(r);try{const i=un();i&&i.setItem(r,e||"");const a=vs();(o=a==null?void 0:a.removeItem)==null||o.call(a,r)}catch{}return}Vw(r,e||"")}function Hw(){var t,n;const e="cozygen_last_param";try{const r=un(),s=((t=r==null?void 0:r.getItem)==null?void 0:t.call(r,e))||"";if(s)return s;const o=vs();(n=o==null?void 0:o.removeItem)==null||n.call(o,e)}catch{}return""}function jm(e,t){const n=e?String(e):"global",r=t?String(t):"";return`cozygen_dropdown_folder:${n}:${r}`}function uf(e,t){var r,s;const n=jm(e,t);try{const o=un(),i=((r=o==null?void 0:o.getItem)==null?void 0:r.call(o,n))||"";if(i)return i;const a=vs();(s=a==null?void 0:a.removeItem)==null||s.call(a,n)}catch{}return""}function Gw(e,t,n){var s;const r=jm(e,t);try{const o=un();o&&o.setItem(r,String(n||""));const i=vs();(s=i==null?void 0:i.removeItem)==null||s.call(i,r)}catch{}}function Kw({workflowName:e,name:t,label:n,description:r,value:s,onChange:o,disabled:i=!1,options:a=[]}){const u=s??"",[d,g]=c.useState(()=>uf(e,t)||"All");c.useEffect(()=>{const v=uf(e,t);g(v||"All")},[e,t]);const y=c.useMemo(()=>(a||[]).map(v=>typeof v=="string"?{value:v,label:v}:{value:v.value??v.name??"",label:v.label??v.name??String(v.value??"")}),[a]),m=v=>{const b=typeof(v==null?void 0:v.value)=="string"||typeof(v==null?void 0:v.value)=="number"?String(v.value):"",C=typeof(v==null?void 0:v.label)=="string"||typeof(v==null?void 0:v.label)=="number"?String(v.label):"";return fs(b)?b:fs(C)?C:""},x=c.useMemo(()=>y.map(v=>{const b=m(v);if(!b)return{opt:v,path:"",base:"",folderPath:""};const{folderPath:C,base:_}=hi(b);return{opt:v,path:b,base:_,folderPath:C||"root"}}),[y]),w=c.useMemo(()=>{const v=new Set(["All"]);return x.forEach(({path:b,folderPath:C})=>{b&&v.add(C||"root")}),Array.from(v).sort((b,C)=>b.localeCompare(C))},[x]),j=w.length>2;c.useEffect(()=>{if(!j){d!=="All"&&g("All");return}w.includes(d)||g("All")},[w,d,j]),c.useEffect(()=>{Gw(e,t,d)},[e,t,d]);const S=c.useMemo(()=>{const v=new Map;return x.forEach(({base:b})=>{if(!b)return;const C=b.toLowerCase();v.set(C,(v.get(C)||0)+1)}),v},[x]),h=c.useMemo(()=>{const v=[],b=j&&d==="All";return x.forEach(({opt:C,path:_,base:I,folderPath:z})=>{if(!_){v.push(C);return}const A=z||"root";if(j&&d!=="All"&&A!==d)return;let D=I||pn(_)||C.label;if(b&&I){const oe=I.toLowerCase();if(S.get(oe)>1){const q=A==="root"?"root":A.split("/").pop()||A;D=`${D} (${q})`}}v.push({...C,label:D})}),v.sort((C,_)=>String(C.label||"").localeCompare(String(_.label||"")))},[x,S,d,j]),f=c.useMemo(()=>u===""||u===null||u===void 0?!0:h.some(v=>String(v.value)===String(u)),[h,u]),p=v=>{const b=v&&v.target?v.target.value:v;o==null||o(b)};return l.jsxs("div",{className:"w-full space-y-2",children:[j?l.jsx("div",{className:"relative w-full",children:l.jsx(Ze,{value:d,onChange:g,disabled:i,"aria-label":`Choose folder for ${n||t}`,size:"sm",options:w.map(v=>({value:v,label:v}))})}):null,l.jsx("div",{className:"relative w-full",children:l.jsx(Ze,{id:t,name:t,value:u,onChange:p,disabled:i,"aria-label":n||t,"aria-describedby":r?`${t}-description`:void 0,placeholder:h.length>0&&(u===void 0||u==="")?"Select...":void 0,emptyLabel:"No matches",options:[...!f&&u!==""?[{value:u,label:pn(String(u))}]:[],...h]},`${t||"field"}:${d}`)})]})}const sc=c.memo(Kw);function df(e=[]){return e.map(t=>typeof t=="string"?{value:t,label:t}:{value:t.value??t.name??"",label:t.label??t.name??String(t.value??"")})}function ff(e,t){if(!e)return null;const n=String(e);if(t==="high"){const r=n.match(/(.+)-high(\.[^.]*)?$/i);return r?r[1]:null}if(t==="low"){const r=n.match(/(.+)-low(\.[^.]*)?$/i);return r?r[1]:null}return null}function Qw(e){return e?e.replace(/[_-]+/g," ").replace(/\s+/g," ").trim().replace(/^./,t=>t.toUpperCase()):""}const Yw=(...e)=>e.flat().map(n=>String(n??"").trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")).filter(Boolean).join("-")||"field";function qw({name:e,label:t,description:n,highParam:r,lowParam:s,highChoices:o=[],lowChoices:i=[],formData:a={},onChangeParam:u,highStrengthParam:d,lowStrengthParam:g,strengthValue:y,onChangeStrength:m,highStrengthValue:x,lowStrengthValue:w,onChangeHighStrength:j,onChangeLowStrength:S,disabled:h=!1}){const f=c.useMemo(()=>df(o),[o]),p=c.useMemo(()=>df(i),[i]),v=c.useMemo(()=>{const X=new Map;p.forEach(W=>{const F=ff(W.value,"low");F&&(X.has(F)||X.set(F,W))});const ie=[];return f.forEach(W=>{const F=ff(W.value,"high");if(!F)return;const O=X.get(F);O&&ie.push({base:F,label:Qw(F),highValue:W.value,lowValue:O.value})}),ie.sort((W,F)=>W.label.localeCompare(F.label)),ie},[f,p]),b=c.useMemo(()=>{const X=a[r],ie=a[s];if(!X||!ie)return"";const W=v.find(F=>F.highValue===X&&F.lowValue===ie);return W?W.base:""},[a,r,s,v]),C=d||g||`${e}_strength`,_=c.useMemo(()=>Yw(e||"lora",C||"strength"),[e,C]),I=!!(d||g),z=!!(d&&g),A=(X,ie=1)=>typeof X=="number"?X:ie,D=A(typeof y=="number"?y:typeof x=="number"?x:typeof w=="number"?w:void 0,1),oe=A(typeof x=="number"?x:void 0,D),q=A(typeof w=="number"?w:void 0,z?D:oe),je=z&&Math.abs(oe-q)>1e-4,[ye,ne]=c.useState(je);c.useEffect(()=>{ne(je)},[je,r,s]);const me=X=>{if(!u)return;const ie=v.find(W=>W.base===X);ie&&(u(r,ie.highValue),u(s,ie.lowValue))};if(v.length===0)return l.jsxs("div",{className:"text-[11px] text-[#9DA3FFCC]",children:["No matching ",l.jsx("span",{className:"font-semibold",children:"-high"})," /"," ",l.jsx("span",{className:"font-semibold",children:"-low"})," LoRA pairs found."]});const R=`${_}-linked`,N=`${_}-high`,E=`${_}-low`,k=z?"Linked":"Strength",V=z?"Applies to high + low":d||g||"",G=(X,ie)=>{const W=Array.isArray(X)?X:[X];let F=!1;W.forEach(O=>{if(O==="high"&&typeof j=="function"){j(ie);return}if(O==="low"&&typeof S=="function"){S(ie);return}typeof m=="function"&&!F&&(m(ie),F=!0)})},te=X=>{(d||!d&&!g)&&G("high",X),g&&G("low",X)},re=()=>{z&&ne(X=>{const ie=!X;return ie||te(typeof oe=="number"?oe:typeof q=="number"?q:D),ie})};return l.jsxs("div",{className:"space-y-2",children:[l.jsx(sc,{name:`${e}_pair`,label:t,description:n,value:b||"",onChange:me,disabled:h,options:v.map(X=>({value:X.base,label:X.label}))}),I&&l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-[10px] uppercase tracking-[0.16em] text-[#9DA3FFCC]",children:"Strength"}),z&&l.jsx("button",{type:"button",className:"text-[10px] font-semibold tracking-[0.12em] uppercase text-[#E5E7FF]",onClick:re,disabled:h,children:ye?"Link values":"Split values"})]}),ye&&z?l.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:gap-3",children:[l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:N,className:"lora-strength-label is-high",children:[l.jsx("span",{className:"lora-strength-label-pill",children:"High"}),l.jsxs("span",{className:"lora-strength-label-text",children:["High strength",d&&l.jsx("span",{className:"lora-strength-label-hint",children:d})]})]}),l.jsx(Vs,{name:`${C}_high`,label:"High strength",description:"",value:oe,onChange:X=>G("high",X),disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:N})]}),l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:E,className:"lora-strength-label is-low",children:[l.jsx("span",{className:"lora-strength-label-pill",children:"Low"}),l.jsxs("span",{className:"lora-strength-label-text",children:["Low strength",g&&l.jsx("span",{className:"lora-strength-label-hint",children:g})]})]}),l.jsx(Vs,{name:`${C}_low`,label:"Low strength",description:"",value:q,onChange:X=>G("low",X),disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:E})]})]}):l.jsxs("div",{className:"flex-1 max-w-[220px]",children:[l.jsxs("label",{htmlFor:R,className:"lora-strength-label is-linked",children:[l.jsx("span",{className:"lora-strength-label-pill",children:k}),l.jsxs("span",{className:"lora-strength-label-text",children:["LoRA strength",V&&l.jsx("span",{className:"lora-strength-label-hint",children:V})]})]}),l.jsx(Vs,{name:C,label:"LoRA strength",description:"",value:D,onChange:te,disabled:h,isFloat:!0,min:0,max:2,step:.05,inputId:R})]})]})]})}function Xw(e,t){if(e.disabled!==t.disabled||e.name!==t.name||e.label!==t.label||e.description!==t.description||e.highParam!==t.highParam||e.lowParam!==t.lowParam||e.highStrengthParam!==t.highStrengthParam||e.lowStrengthParam!==t.lowStrengthParam||e.strengthValue!==t.strengthValue||e.highStrengthValue!==t.highStrengthValue||e.lowStrengthValue!==t.lowStrengthValue||e.highChoices!==t.highChoices||e.lowChoices!==t.lowChoices||e.onChangeParam!==t.onChangeParam||e.onChangeStrength!==t.onChangeStrength||e.onChangeHighStrength!==t.onChangeHighStrength||e.onChangeLowStrength!==t.onChangeLowStrength)return!1;const n=e.formData||{},r=t.formData||{};return!(n[e.highParam]!==r[t.highParam]||n[e.lowParam]!==r[t.lowParam])}const pf=c.memo(qw,Xw);function Jw({id:e,label:t,description:n,preview:r,expanded:s=!1,onToggle:o,children:i,trailing:a,className:u=""}){const d=typeof o=="function",g=e?`${e}-description`:void 0,y=e?`${e}-panel`:void 0,m=typeof t=="string"?t.trim().replace(/\s+/gu," ").replace(/:\s*$/u,""):t,x=typeof n=="string"?n.trim().replace(/\s+/gu," "):n,w=typeof r=="string"||typeof r=="number"?String(r):void 0,j=d?"button":"div",S=d?{type:"button",onClick:o,"aria-expanded":s,"aria-controls":y,"aria-describedby":x?g:void 0}:{};return l.jsxs("div",{className:["field-row",u].filter(Boolean).join(" "),children:[l.jsxs(j,{...S,className:["field-row-head",d?"is-collapsible":"is-static",s?"is-expanded":""].filter(Boolean).join(" "),children:[l.jsxs("div",{className:"field-row-main",children:[l.jsx("div",{className:"field-row-label",children:m}),x?l.jsx("div",{id:g,className:"field-row-description",children:x}):null]}),l.jsxs("div",{className:"field-row-trailing",children:[a?l.jsx("div",{className:"field-row-trailing-control",children:a}):null,r?l.jsx("div",{className:"field-row-preview",title:w,children:r}):null,d?l.jsx("div",{className:"field-row-chevron","aria-hidden":"true",children:l.jsx(di,{size:16})}):null]})]}),d&&s?l.jsx("div",{id:y,className:"field-row-body",children:i}):null]})}const Gi=c.memo(Jw),Zw=16,e0=[" - "," ","-","_"],Nm=e=>[...new Set(e.filter(Boolean))],Uo=(e,t)=>{const n=String(e||"").trim(),r=e0.map(s=>`${n}${s}${t}`);return r.push(`${n}${t}`),Nm(r)},hf=(e,t)=>{const n=Uo(`${e} Strength`,t),r=Uo(e,t).map(s=>`${s} Strength`);return Nm([...n,...r])},mf=e=>String(e||"").toLowerCase().replace(/[\s_-]+/g,""),Gl=(e,t=[])=>{if(!e)return null;const n=Array.isArray(t)?t:[t];for(const s of n){if(!s)continue;const o=e.get(s);if(o)return{name:s,input:o}}const r=new Map;n.forEach(s=>{s&&r.set(mf(s),s)});for(const[s,o]of e.entries()){const i=mf(s);if(r.has(i))return{name:s,input:o}}return null},t0=Array.from({length:Zw},(e,t)=>{const n=t+1,r=Uo("Lora High",n),s=Uo("Lora Low",n),o=hf("Lora High",n),i=hf("Lora Low",n);return{id:`video_lora_${n}`,label:`Video LoRA ${n}`,highParam:r[0],lowParam:s[0],highParamAliases:r,lowParamAliases:s,highStrengthParam:o[0],lowStrengthParam:i[0],highStrengthParamAliases:o,lowStrengthParamAliases:i}});function n0(e){var r,s;const t=((r=e==null?void 0:e.inputs)==null?void 0:r.param_type)||((s=e==null?void 0:e.inputs)==null?void 0:s.Param_type),n=String(t||"STRING").toUpperCase();return["NUMBER","FLOAT","INT"].includes(n)?"NUMBER":["BOOLEAN","BOOL"].includes(n)?"BOOLEAN":["DROPDOWN","CHOICE","SELECT"].includes(n)?"DROPDOWN":"STRING"}function r0(e){const t=(e==null?void 0:e.inputs)||{};return t.label||t.display_name||t.title||t.param_name||(e==null?void 0:e.title)||(e==null?void 0:e.class_type)||"Parameter"}function s0(e){const t=(e==null?void 0:e.inputs)||{};return t.description||t.help||t.tooltip||t.doc||""}function Fr(e){const t=(e==null?void 0:e.inputs)||{};return t.param_name||t.name||t.key||t.id||`param_${(e==null?void 0:e.id)||"unknown"}`}function zs(e){const t=(e==null?void 0:e.inputs)||{},n=t.choices||t.options||[],r=t.default_value??t.value??t.default_choice??(n&&n.length?n[0]:"")??"";return{paramName:Fr(e),label:r0(e),description:s0(e),paramType:n0(e),multiline:!!t.multiline,min:typeof t.min=="number"?t.min:void 0,max:typeof t.max=="number"?t.max:void 0,step:typeof t.step=="number"?t.step:void 0,choices:n,defaultValue:r}}function l0({inputs:e=[],formData:t={},onFormChange:n,workflowName:r,onParamEdited:s,onSpotlight:o,compactControls:i=!0,collapseAllKey:a=0,collapseAllCollapsed:u=!0,lastEditedParam:d="",spotlightName:g="",onCloseSpotlight:y=()=>{},onVisibleParamsChange:m=()=>{},aliasOptions:x=[],aliasCatalog:w=[],onOpenComposer:j}){const[S,h]=c.useState({}),[f,p]=c.useState(0),v=c.useRef(t);c.useEffect(()=>{v.current=t},[t]);const b=c.useCallback((N,E)=>{if((N==null?void 0:N.paramType)==="BOOLEAN")return E?"On":"Off";if(E==null||E==="")return"Empty";if(typeof E=="string"){const k=E.trim();if(!k)return"Empty";const V=240,G=140,te=k.length>V?k.slice(0,V):k,X=/[\r\n\t]/.test(te)||/\s{2,}/u.test(te)?te.replace(/\s+/gu," ").trim():te;if(X.length>G)return`${X.slice(0,G)}`;const ie=Mw(X);return k.length>V?`${ie}`:ie}return String(E)},[]),C=c.useCallback((N,E)=>{!n||!N||(n(N,E),s==null||s(N),h(k=>(k==null?void 0:k[N])===!1?k:{...k,[N]:!1}))},[n,s]),_=c.useCallback(N=>{N&&h(E=>({...E,[N]:!(E!=null&&E[N])}))},[]),I=c.useMemo(()=>e||[],[e]),z=c.useMemo(()=>{const N=new Map;return(I||[]).forEach(E=>{const k=Fr(E);k&&N.set(k,V=>C(k,V))}),N},[C,I]),A=c.useMemo(()=>{const N=new Map;return(I||[]).forEach(E=>{const k=Fr(E);k&&N.set(k,(V,G)=>{var te,re;C(k,V),(re=(te=G==null?void 0:G.target)==null?void 0:te.blur)==null||re.call(te),g===k&&(y==null||y())})}),N},[C,y,g,I]),D=c.useMemo(()=>{const N=new Map;return(I||[]).forEach(E=>{const k=Fr(E);k&&N.set(k,()=>_(k))}),N},[_,I]);c.useEffect(()=>{const N={};(e||[]).forEach(E=>{const k=Fr(E);k&&(N[k]=u)}),d&&(N[d]=!1),h(N)},[a,u,e,d]);const oe=c.useMemo(()=>{const N=new Map;return(e||[]).forEach(E=>{const k=Fr(E);k&&N.set(k,E)}),N},[e]),q=c.useMemo(()=>{const N=[];return t0.forEach(E=>{const k=Gl(oe,E.highParamAliases||E.highParam),V=Gl(oe,E.lowParamAliases||E.lowParam);if(!k||!V)return;const G=k.input,te=V.input,re=zs(G),X=zs(te);if(re.paramType!=="DROPDOWN"||X.paramType!=="DROPDOWN")return;const ie=re.choices||[],W=X.choices||[];if(!ie.length||!W.length)return;const F=Gl(oe,E.highStrengthParamAliases||E.highStrengthParam),O=Gl(oe,E.lowStrengthParamAliases||E.lowStrengthParam);N.push({...E,highParam:k.name,lowParam:V.name,highStrengthParam:F==null?void 0:F.name,lowStrengthParam:O==null?void 0:O.name,highInput:G,lowInput:te,highCfg:re,lowCfg:X})}),N},[oe]),je=c.useMemo(()=>{const N=new Map;return q.forEach(E=>{N.set(E.highParam,E)}),N},[q]),ye=c.useMemo(()=>{const N=new Set;return q.forEach(E=>{N.add(E.highParam),N.add(E.lowParam),E.highStrengthParam&&N.add(E.highStrengthParam),E.lowStrengthParam&&N.add(E.lowStrengthParam)}),N},[q]),ne=c.useMemo(()=>{const N=[];return(I||[]).forEach(E=>{const k=zs(E),V=k.paramName,G=je.get(V);if(G){N.push({name:V,label:G.label||k.label,description:k.description,render:te=>{const re=te||v.current||{},X=G.highStrengthParam?re[G.highStrengthParam]:void 0,ie=G.lowStrengthParam?re[G.lowStrengthParam]:void 0,W=X??ie??1;return l.jsx(pf,{name:G.id||G.highParam,label:G.label||k.label,highParam:G.highParam,lowParam:G.lowParam,highChoices:G.highCfg.choices,lowChoices:G.lowCfg.choices,formData:re,onChangeParam:C,highStrengthParam:G.highStrengthParam,lowStrengthParam:G.lowStrengthParam,strengthValue:W,highStrengthValue:X,lowStrengthValue:ie,onChangeHighStrength:G.highStrengthParam?z.get(G.highStrengthParam):void 0,onChangeLowStrength:G.lowStrengthParam?z.get(G.lowStrengthParam):void 0,disabled:!1},`lora-${V}-${f}`)}});return}ye.has(V)||N.push({name:V,label:k.label,description:k.description,render:te=>{const re=te||v.current||{},X={name:V,label:k.label,description:k.description,value:re[V],defaultValue:k.defaultValue,disabled:!1};return k.paramType==="NUMBER"?l.jsx(Vs,{...X,onChange:z.get(V),min:k.min,max:k.max,step:k.step,isFloat:!0},`field-${V}-number-${f}`):k.paramType==="BOOLEAN"?l.jsx(cf,{...X,onChange:z.get(V)},`field-${V}-bool-${f}`):k.paramType==="DROPDOWN"?l.jsx(sc,{...X,workflowName:r,onChange:z.get(V),options:k.choices||[]},`field-${V}-dropdown-${f}`):l.jsx(of,{...X,aliasOptions:x,aliasCatalog:w,onOpenComposer:j,onChange:z.get(V),onEnter:A.get(V),multiline:k.multiline},`field-${V}-string-${f}`)}})}),N},[I,je,ye,f,r,x,w,j,C,z,A,g,y]),me=c.useMemo(()=>{const N=new Map;return ne.forEach(E=>N.set(E.name,E)),N},[ne]);c.useEffect(()=>{m==null||m(ne.map(N=>N.name))},[ne,m]);const R=c.useCallback(N=>{const E=ne.map(re=>re.name),k=me.get(N);if(!k)return;const V=E.indexOf(N),G=V>0?E[V-1]:null,te=V>=0&&V<E.length-1?E[V+1]:null;p(re=>re+1),o==null||o({name:N,label:k.label,description:k.description,render:re=>k.render(re||v.current),order:E,index:V>=0?V:0,total:E.length,onPrev:G?()=>R(G):null,onNext:te?()=>R(te):null})},[me,o,ne]);return l.jsx("div",{className:"settings-list",children:I.map(N=>{const E=zs(N),k=E.paramName,V=je.get(k);if(V){const{id:O,label:se,highParam:ce,lowParam:Re,highStrengthParam:Ne,lowStrengthParam:Ee,highCfg:Me,lowCfg:Ke}=V,le=Ne?t[Ne]:void 0,fe=Ee?t[Ee]:void 0,Pe=le??fe??1,We=k?`param-${k}`:void 0,Q=i?S[k]??!0:!!S[k],ue=Q?b(E,[t[ce],t[Re]].filter(Boolean).join("  ")):null,ve=(ge=t)=>{const ke=Ne?ge==null?void 0:ge[Ne]:void 0,Le=Ee?ge==null?void 0:ge[Ee]:void 0,Fe=ke??Le??Pe;return l.jsx(pf,{name:O||ce,label:se||E.label,highParam:ce,lowParam:Re,highChoices:Me.choices,lowChoices:Ke.choices,formData:ge,onChangeParam:C,highStrengthParam:Ne,lowStrengthParam:Ee,strengthValue:Fe,highStrengthValue:ke,lowStrengthValue:Le,onChangeHighStrength:Ne?z.get(Ne):void 0,onChangeLowStrength:Ee?z.get(Ee):void 0,disabled:!1},`lora-${k}`)};return l.jsx("div",{id:We,"data-param-name":k,"data-param-label":se||E.label,"data-param-type":"lora_pair",className:"settings-row",children:l.jsx(Gi,{id:k,label:se||E.label,description:E.description,preview:ue,expanded:!Q,onToggle:D.get(k),children:Q?null:ve(t)})},`lora_pair_${O||ce}`)}if(ye.has(k))return null;const G=t[k],re={name:k,label:E.label,description:E.description,value:G,disabled:!1,defaultValue:E.defaultValue},X=(O=t,se=!1)=>{const ce={...re,value:O==null?void 0:O[k]};return E.paramType==="NUMBER"?l.jsx(Vs,{...ce,inputId:k,onChange:z.get(k),min:E.min,max:E.max,step:E.step,isFloat:!0},`field-${k}-number-${f}`):E.paramType==="BOOLEAN"?l.jsx(cf,{...ce,onChange:z.get(k)},`field-${k}-bool-${f}`):E.paramType==="DROPDOWN"?l.jsx(sc,{...ce,workflowName:r,onChange:z.get(k),options:E.choices||[]},`field-${k}-dropdown-${f}`):l.jsx(of,{...ce,aliasOptions:x,aliasCatalog:w,onOpenComposer:j,onChange:z.get(k),onEnter:A.get(k),multiline:E.multiline||g===k||se},`field-${k}-string-${f}`)},ie=k?`param-${k}`:void 0,W=i?S[k]??!0:!!S[k];if(E.paramType==="BOOLEAN")return l.jsx("div",{id:ie,"data-param-name":k,"data-param-label":E.label,"data-param-type":"single",className:"settings-row",children:l.jsx(Gi,{id:k,label:E.label,description:E.description,trailing:X(t,!0)})},k);const F=W?b(E,G):null;return l.jsx("div",{id:ie,"data-param-name":k,"data-param-label":E.label,"data-param-type":"single",className:"settings-row",children:l.jsx(Gi,{id:k,label:E.label,description:E.description,preview:F,expanded:!W,onToggle:D.get(k),children:W?null:X(t,!0)})},k)})})}function o0(e){return(e||[]).map(t=>{var n;if(["CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"].includes(t.class_type)){let r=t.class_type.replace("CozyGen","").replace("Input","").toUpperCase();return r==="CHOICE"&&(r="DROPDOWN"),{...t,inputs:{...t.inputs,param_type:r,Multiline:((n=t.inputs)==null?void 0:n.display_multiline)||!1}}}return t})}function i0({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:o=!1,collapseAllState:i=null,onSpotlight:a,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:g,aliasOptions:y=[],aliasCatalog:m=[],onOpenComposer:x}){const w=c.useMemo(()=>o0((t||[]).filter(j=>j.class_type!=="CozyGenImageInput")),[t]);return l.jsx("section",{className:"settings-surface scroll-mt-24",ref:s,children:l.jsx(l0,{workflowName:e,inputs:w,formData:n,onFormChange:r,compactControls:o,collapseAllKey:(i==null?void 0:i.key)??0,collapseAllCollapsed:(i==null?void 0:i.collapsed)??!0,onSpotlight:a,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:g,aliasOptions:y,aliasCatalog:m,onOpenComposer:x})})}function a0({workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,parameterSectionRef:s,compactControls:o=!0,collapseAllState:i=null,onSpotlight:a,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:g,aliasOptions:y=[],aliasCatalog:m=[],onOpenComposer:x}){return l.jsx(i0,{workflowName:e,dynamicInputs:t,formData:n,onFormChange:r,sectionRef:s,compactControls:o,collapseAllState:i,onSpotlight:a,spotlightName:u,onCloseSpotlight:d,onVisibleParamsChange:g,aliasOptions:y,aliasCatalog:m,onOpenComposer:x})}const gf=c.forwardRef(function({title:t,kicker:n,meta:r,defaultOpen:s=!0,variant:o="card",className:i="",bodyClassName:a,children:u},d){const g=o==="bare",y=(g?["collapsible-section","collapsible-section--bare",i]:["ui-panel","collapsible-card","sectioned-card",i]).filter(Boolean).join(" "),m=(g?["collapsible-section-body",a||"space-y-4"]:["collapsible-card-body",a||"space-y-4"]).filter(Boolean).join(" "),x=r!=null?l.jsx("div",{className:"collapsible-card-summary-meta",children:r}):null;return l.jsxs("details",{ref:d,className:y,open:s,children:[l.jsxs("summary",{className:g?"collapsible-section-summary":"collapsible-card-summary",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[n?l.jsx("span",{className:"ui-kicker",children:n}):null,l.jsx("span",{className:"text-sm font-semibold tracking-wide",children:t})]}),x,g?l.jsx("span",{className:"collapsible-section-chevron","aria-hidden":"true",children:l.jsx(di,{size:16})}):null]}),l.jsx("div",{className:m,children:u})]})});function yf(e){try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return""}}function c0({open:e,onClose:t,logs:n=[],onClear:r}){const s=c.useMemo(()=>(n||[]).map(o=>`[${yf(o.ts)}] ${String(o.level||"info").toUpperCase()} ${o.message}`).join(`
`),[n]);return l.jsx(Lt,{open:e,onClose:t,title:"Run logs",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>{var o,i;try{(i=(o=navigator.clipboard)==null?void 0:o.writeText)==null||i.call(o,s||"")}catch{}},children:"Copy"}),l.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:r,children:"Clear"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:t,children:"Close"})]}),children:l.jsx("pre",{className:"runlog-pre",children:n!=null&&n.length?n.map((o,i)=>l.jsxs("div",{className:`runlog-line is-${o.level||"info"}`,children:[l.jsx("span",{className:"runlog-ts",children:yf(o.ts)}),l.jsx("span",{className:"runlog-msg",children:o.message})]},`${o.ts}-${i}`)):"No logs yet."})})}const Ft=c.forwardRef(function({as:t,href:n,variant:r,size:s="md",iconOnly:o=!1,active:i=!1,pressed:a,className:u="",type:d,...g},y){const m=t||(n?"a":"button"),x=s==="sm"?"is-compact":s==="xs"?"is-tiny":s==="icon"?"is-icon":"",w=r?`is-${r}`:"",h=["ui-button",x,w,o?"is-icon":"",i?"is-active":"",u].filter(Boolean).join(" "),f={ref:y,className:h,"aria-pressed":a,...g};return m==="button"?l.jsx("button",{...f,type:d||"button"}):l.jsx(m,{...f,href:n})}),u0="cozygen_field_order_v1";function d0(e,t){if(!e)return t;try{const n=JSON.parse(e);return n&&typeof n=="object"?n:t}catch{return t}}function f0(){if(typeof window>"u")return{};try{return d0(window.localStorage.getItem(u0),{})}catch{return{}}}function p0(e){if(Array.isArray(e))return{order:e.filter(Boolean),hidden:{}};if(!e||typeof e!="object")return{order:[],hidden:{}};const t=Array.isArray(e.order)?e.order.filter(Boolean):[],n=e.hidden&&typeof e.hidden=="object"?e.hidden:{};return{order:t,hidden:n}}function h0(e){if(!e)return{order:[],hidden:{}};const n=f0()[e];return p0(n)}function m0(e,t){let n=Array.isArray(t)?t:[];if(!e||n.length===0)return n;const{order:r,hidden:s}=h0(e);if(r&&r.length){const o=new Map;n.forEach(a=>{var d;const u=(d=a==null?void 0:a.inputs)==null?void 0:d.param_name;u&&!o.has(u)&&o.set(u,a)});const i=[];r.forEach(a=>{const u=o.get(a);u&&(i.push(u),o.delete(a))}),n.forEach(a=>{var d;const u=(d=a==null?void 0:a.inputs)==null?void 0:d.param_name;if(!u){i.push(a);return}o.has(u)&&(i.push(a),o.delete(u))}),n=i}return n=n.filter(o=>{var a;const i=(a=o==null?void 0:o.inputs)==null?void 0:a.param_name;return i?!s[i]:!0}),n}function g0(){const[e,t]=c.useState([]),[n,r]=c.useState(null),[s,o]=c.useState(!0),[i,a]=c.useState(null);c.useEffect(()=>{let d=!1;async function g(){o(!0),a(null);try{const y=await Fx();if(d)return;const m=(y==null?void 0:y.workflows)||[];t(m);let x=null;try{if(x=typeof window<"u"?sessionStorage.getItem("selectedWorkflow"):null,typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{x=null}if(x&&m.includes(x))r(x);else if(m.length>0){r(m[0]);try{typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",m[0])}catch{}}else r(null)}catch(y){if(d)return;console.error("Failed to load workflows",y),a(y)}finally{d||o(!1)}}return g(),()=>{d=!0}},[]);const u=c.useCallback(d=>{r(d);try{if(typeof window<"u"&&sessionStorage.setItem("selectedWorkflow",d),typeof window<"u")try{localStorage.removeItem("selectedWorkflow")}catch{}}catch{}},[]);return{workflows:e,selectedWorkflow:n,selectWorkflow:u,loading:s,error:i}}const y0={clip_name1:"clip",clip_name2:"clip",unet_name:"unet",vae_name:"vae",sampler_name:"sampler",scheduler:"scheduler"},v0=["CozyGenDynamicInput","CozyGenImageInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput","CozyGenChoiceInput"];function x0(e){const[t,n]=c.useState(null),[r,s]=c.useState([]),[o,i]=c.useState({}),[a,u]=c.useState(!1),[d,g]=c.useState(null);c.useEffect(()=>{if(!e){n(null),s([]),i({});return}let w=!1;const j=new AbortController;async function S(){u(!0),g(null);try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:workflow:load")}catch{}try{const h=await Ox(e,{signal:j.signal});if(w)return;for(const C in h){const _=h[C];_.class_type==="CozyGenImageInput"&&!_.inputs.param_name&&(_.inputs.param_name="Image Input"),h[C].id=C}n(h);const f=Object.values(h).filter(C=>v0.includes(C.class_type)),p=await Promise.all(f.map(async C=>{const _=C.class_type==="CozyGenDynamicInput"&&C.inputs.param_type==="DROPDOWN",I=C.class_type==="CozyGenChoiceInput";if(_||I){const z=C.inputs.param_name;let A=C.inputs.choice_type||C.properties&&C.properties.choice_type;if(!A&&_&&(A=y0[z]),A)try{const D=await Xa(A,{signal:j.signal,refresh:A==="loras"});C.inputs.choices=D.choices||[]}catch(D){(D==null?void 0:D.name)!=="AbortError"&&console.error(`Choices for ${z} failed`,D),C.inputs.choices=[]}}return C}));if(w)return;s(p);const v=Uw(e),b={};p.forEach(C=>{const _=C.inputs.param_name;if(!_)return;if(v[_]!==void 0){b[_]=v[_];return}let I;if(["CozyGenDynamicInput","CozyGenFloatInput","CozyGenIntInput","CozyGenStringInput"].includes(C.class_type)){if(I=C.inputs.default_value,C.class_type==="CozyGenIntInput"){const z=parseInt(I,10);I=Number.isNaN(z)?0:z}else if(C.class_type==="CozyGenFloatInput"){const z=parseFloat(I);I=Number.isNaN(z)?0:z}}else if(C.class_type==="CozyGenChoiceInput"){const z=C.inputs.choices||[];I=z.length?z[0]:""}else C.class_type,I="";b[_]=I}),i(b);try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:workflow:ready"),performance.measure(`cozygen:workflow:ready:${e||"unknown"}`,"cozygen:workflow:load","cozygen:workflow:ready"))}catch{}}catch(h){if(w)return;console.error("Failed to load workflow",h),g(h),n(null),s([])}finally{w||u(!1)}}return S(),()=>{Bw(e),w=!0,j.abort()}},[e]);const y=c.useMemo(()=>r.filter(w=>w.class_type==="CozyGenImageInput"),[r]),m=y[0]||null,x=c.useCallback((w,j)=>{i(S=>{const h={...S,[w]:j};return e&&Do(e,h),h})},[e]);return{workflowData:t,dynamicInputs:r,imageInputs:y,primaryImageInput:m,formData:o,setFormData:i,handleFormChange:x,loading:a,error:d}}const vf="::";function Ws(e){const t={};return Object.entries(e||{}).forEach(([n,r])=>{const s=String(n||"").trim();if(!s||typeof r!="string")return;const o=r.trim();o&&(t[s]=o)}),t}function fu(e){const t=new Map;return Object.entries(Ws(e)).forEach(([n,r])=>{const s=n.toLowerCase();t.set(s,r),s.includes(vf)&&t.set(s.replace(vf,":"),r)}),t}function km(e,t){if(typeof e!="string"||!e.includes("$"))return e;const n=t instanceof Map?t:fu(t);return n.size?e.replace(/\$([a-z0-9_:-]+)\$/gi,(r,s)=>{const o=n.get(s.toLowerCase());return typeof o=="string"?o:r}):e}function w0(e,t){const n=t instanceof Map?t:fu(t);if(!n.size||!e||typeof e!="object")return e;let r=!1;const s={};return Object.entries(e).forEach(([o,i])=>{if(typeof i=="string"){const a=km(i,n);s[o]=a,a!==i&&(r=!0)}else s[o]=i}),r?s:e}function bm(e){return e?JSON.parse(JSON.stringify(e)):{}}function S0(e,t,n){const r=bm(e),s={...n||{}};if(!t||!Array.isArray(t))return{workflow:r,formData:s};for(const o of t){if(!o||!o.id||!o.inputs||!r[o.id])continue;const i=o.inputs.param_name;if(!i||o.class_type==="CozyGenImageInput")continue;let a=s[i];const u=r[o.id];if(!u||!u.inputs)continue;const d=o.class_type;a===void 0&&(d==="CozyGenChoiceInput"?a=o.inputs.value??o.inputs.default_choice??(o.inputs.choices&&o.inputs.choices[0])??"":a=o.inputs.default_value),a===void 0&&(a=""),s[i]=a,d==="CozyGenFloatInput"||d==="CozyGenIntInput"||d==="CozyGenStringInput"||d==="CozyGenDynamicInput"?u.inputs.default_value=a:d==="CozyGenChoiceInput"&&(u.inputs.value=a)}return{workflow:r,formData:s}}function pu(){const[e,t]=c.useState(()=>typeof document>"u"?!0:document.visibilityState!=="hidden");return c.useEffect(()=>{if(typeof document>"u")return;const n=()=>{t(document.visibilityState!=="hidden")};return document.addEventListener("visibilitychange",n),()=>document.removeEventListener("visibilitychange",n)},[]),e}function j0({selectedWorkflow:e,workflowData:t,dynamicInputs:n,imageInputs:r,formData:s,setFormData:o,promptAliases:i=null}){const a=pu(),[u,d]=c.useState(!1),[g,y]=c.useState(!1),[m,x]=c.useState(0),[w,j]=c.useState(0),[S,h]=c.useState("Idle"),[f,p]=c.useState("idle"),[v,b]=c.useState([]),C=c.useRef({ts:0,value:0,max:0}),_=c.useRef(null),I=c.useRef({value:0,max:0}),z=c.useRef(null),A=c.useRef(null),D=c.useRef(t),oe=c.useRef(s),q=c.useRef(!1),je=c.useRef(0),ye=c.useRef(0),ne=c.useRef("idle"),me=c.useRef(null),R=c.useRef(null);c.useEffect(()=>{D.current=t},[t]),c.useEffect(()=>{q.current=g},[g]),c.useEffect(()=>{je.current=m},[m]),c.useEffect(()=>{ye.current=w},[w]),c.useEffect(()=>{ne.current=f},[f]),c.useEffect(()=>{oe.current=s},[s]);const N=()=>{me.current&&(clearTimeout(me.current),me.current=null)},E=()=>{R.current&&(clearTimeout(R.current),R.current=null)},k=()=>{A.current&&(clearTimeout(A.current),A.current=null)},V=()=>{_.current&&(cancelAnimationFrame(_.current),_.current=null)},G=c.useCallback((O,se,ce=null)=>{const Re={ts:Date.now(),level:O||"info",message:String(se||""),extra:ce||null};b(Ne=>{const Ee=[...Ne||[],Re];return Ee.length>250?Ee.slice(Ee.length-250):Ee})},[]),te=c.useCallback(()=>b([]),[]),re=()=>{if(!(typeof window>"u"||typeof window.dispatchEvent!="function"))try{window.dispatchEvent(new CustomEvent("cozygen:queue-finished"))}catch{}},X=()=>{E(),R.current=setTimeout(()=>{q.current||(p("idle"),h("Idle"),x(0),j(0))},8e3)},ie=c.useCallback(()=>{N(),d(!1),y(!1),x(0),j(0),h("Finished"),p("finished"),G("success","Finished"),X(),re()},[G]),W=c.useCallback((O="Error")=>{N(),d(!1),y(!1),h(O),p("error"),G("error",O||"Error"),X()},[G]);c.useEffect(()=>{N(),!(!g||!w||w<=0||m<w)&&(me.current=setTimeout(()=>{const O=q.current,se=je.current,ce=ye.current,Re=ne.current;O&&ce>0&&se>=ce&&Re!=="finished"&&Re!=="error"&&ie()},800))},[g,m,w,ie]),c.useEffect(()=>{if(typeof window>"u"||!a&&!g)return;let O=!1,se=1e3;const ce=()=>{if(O||!a&&!q.current)return;const Re=window.location.protocol==="https:"?"wss":"ws",Ne=window.location.host,Ee=lu(),Me=`${Re}://${Ne}/ws${Ee?`?token=${encodeURIComponent(Ee)}`:""}`,Ke=new WebSocket(Me);z.current=Ke,Ke.onopen=()=>{se=1e3},Ke.onmessage=le=>{var We,Q,ue;if(typeof le.data!="string")return;let fe;try{fe=JSON.parse(le.data)}catch{return}const Pe=fe.type;if(Pe==="cozygen_batch_ready"){ie();return}if(Pe==="execution_success"||Pe==="execution_finished"){q.current&&ie();return}if(Pe==="execution_error"||Pe==="execution_interrupted"){G("error","Execution error"),W("Execution error");return}if(Pe==="status"){const ve=fe.data||{},ge=ve.status||ve,ke=ge.exec_info||ve.exec_info||ge;if(ke&&q.current){const Le=ke.queue_remaining??ke.queue_pending??ke.queue_remaining_items??0;(ke.queue_running??ke.running??0)===0&&Le===0&&ie()}return}if(Pe==="executing"){E(),p("running");const ve=(We=fe.data)==null?void 0:We.node,ge=D.current;if(ve&&ge&&ge[ve]){const ke=ge[ve],Le=ke.title||ke.class_type||"Node";G("info",`Executing: ${Le}`,{nodeId:ve}),h(`Executing: ${Le}`)}else G("info","Executing"),h("Executing");return}if(Pe==="progress"){const ve=((Q=fe.data)==null?void 0:Q.value)??0,ge=((ue=fe.data)==null?void 0:ue.max)??0;I.current={value:ve,max:ge},_.current||(_.current=window.requestAnimationFrame(()=>{_.current=null;const He=I.current;x(He.value),j(He.max)}));const ke=Date.now(),Le=C.current;ke-Le.ts>2500&&(ve!==Le.value||ge!==Le.max)&&ge>0&&(C.current={ts:ke,value:ve,max:ge},G("info",`Progress: ${ve}/${ge}`));return}},Ke.onclose=()=>{O||!a&&!q.current||(k(),A.current=setTimeout(ce,se),se=Math.min(Math.ceil(se*1.6),15e3))}};return ce(),()=>{O=!0,N(),E(),k(),V(),z.current&&(z.current.onclose=null,z.current.close())}},[G,W,ie,a,g]);const F=c.useCallback(async(O={})=>{if(!t)return;const{overrides:se=null,persistFormState:ce=!0}=O||{};N(),E(),d(!0),y(!0),h("Queuing prompt"),p("queued"),x(0),j(0),G("info","Queuing prompt",{workflow:e||""});const Re=oe.current||{},Ne=se?{...Re,...se||{}}:Re,Ee=w0(Ne,i||{}),{workflow:Me,formData:Ke}=S0(t,n||[],Ee||{}),le={...Ke,...Ne};ce&&e&&Do(e,le),ce&&o(le);const fe=r||[];for(const Pe of fe){if(!Pe||!Pe.id||!Pe.inputs)continue;const We=Pe.inputs.param_name;if(!We)continue;const Q=le[We];if(!Q){alert(`Please upload or select an image for "${We}" before generating.`),W("Missing image input");return}Me[Pe.id]&&Me[Pe.id].inputs&&(Me[Pe.id].inputs.image_filename=Q)}try{let Pe=Me;if(i){const We=Q=>{if(typeof Q=="string")return km(Q,i);if(Array.isArray(Q))return Q.map(ue=>We(ue));if(Q&&typeof Q=="object"){const ue=Array.isArray(Q)?[]:{};return Object.entries(Q).forEach(([ve,ge])=>{ue[ve]=We(ge)}),ue}return Q};try{Pe=We(Me)}catch{Pe=Me}}im({workflowName:e,workflow:Pe,timestamp:Date.now()}),await ou({prompt:Pe}),G("info","Prompt queued")}catch(Pe){console.error("Failed to queue prompt",Pe),Pe!=null&&Pe.unauthorized?(G("error","Session expired. Please sign in again."),W("Session expired. Please sign in again."),window.location.hash="#/login"):(G("error","Error queuing prompt"),W("Error queuing prompt"))}},[t,n,r,i,e,o,W,G]);return{isLoading:u,progressValue:m,progressMax:w,statusText:S,statusPhase:f,handleGenerate:F,logEntries:v,clearLogs:te}}const Cm="cozygen_prompt_aliases",Em="cozygen_alias_categories",Lm="cozygen_alias_category_list";function xf(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Cm);return e?JSON.parse(e)||{}:{}}catch{return{}}}function Ki(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Cm,JSON.stringify(e||{}))}catch{}}function wf(){if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Em);return e?JSON.parse(e)||{}:{}}catch{return{}}}function Qi(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Em,JSON.stringify(e||{}))}catch{}}function Sf(){if(typeof window>"u")return[];try{const e=window.localStorage.getItem(Lm);return Array.isArray(JSON.parse(e))?JSON.parse(e):[]}catch{return[]}}function Yi(e){if(!(typeof window>"u"))try{window.localStorage.setItem(Lm,JSON.stringify(e||[]))}catch{}}function Pm(){const[e,t]=c.useState(()=>xf()),[n,r]=c.useState(()=>wf()),[s,o]=c.useState(()=>Sf()),[i,a]=c.useState(!1),[u,d]=c.useState(!1),[g,y]=c.useState(null),m=c.useCallback(async()=>{a(!0),y(null);try{const S=await Bx(),h=Ws((S==null?void 0:S.items)||S||{}),f=(S==null?void 0:S.categories)||{},p=Array.isArray(S==null?void 0:S.categoryList)?S.categoryList:[];t(h),r(f),o(p),Ki(h),Qi(f),Yi(p)}catch(S){console.error("Failed to load prompt aliases",S),y(S);const h=Ws(xf()),f=wf(),p=Sf();t(h),r(f),o(p)}finally{a(!1)}},[]),x=c.useCallback(async S=>{const h=(S==null?void 0:S.items)||S||{},f=(S==null?void 0:S.categories)||n||{},p=Array.isArray(S==null?void 0:S.categoryList)&&S.categoryList.length?S.categoryList:s.length?s:Array.from(new Set(Object.values(f).filter(Boolean))),v=Ws(h||{});d(!0),y(null);try{await Vx({items:v,categories:f,categoryList:p}),t(v),r(f),o(p),Ki(v),Qi(f),Yi(p)}catch(b){throw console.error("Failed to save prompt aliases",b),y(b),Ki(v),Qi(f),Yi(p),b}finally{d(!1)}},[n,s]);c.useEffect(()=>{m()},[m]);const w=c.useMemo(()=>{const S=fu(e),h=new Map(S);return Object.entries(n||{}).forEach(([f,p])=>{const v=String(p||"").trim();v&&(e!=null&&e[f])&&h.set(`${v}:${f}`,e[f])}),h},[e,n]),j=c.useMemo(()=>{const S=new Set,h=[];return w.forEach((f,p)=>{let v=p.includes("::")?p.replace("::",":"):p;const b=v.split(":");b.length>=3&&b[0]&&b[1]&&b[0].toLowerCase()===b[1].toLowerCase()&&(v=[b[0],...b.slice(2)].join(":"));const C=v.toLowerCase();S.has(C)||(S.add(C),h.push(v))}),h},[w]);return{aliases:e,aliasCategories:n,categoryList:s,aliasLookup:w,aliasOptions:j,loading:i,saving:u,error:g,refreshAliases:m,persistAliases:x}}const _m=c.createContext(null);function Rm(){const e=c.useContext(_m);if(!e)throw new Error("useStudioContext must be used within a StudioProvider");return e}function N0({children:e}){const{workflows:t,selectedWorkflow:n,selectWorkflow:r,loading:s,error:o}=g0(),{workflowData:i,dynamicInputs:a,imageInputs:u,primaryImageInput:d,formData:g,setFormData:y,handleFormChange:m,loading:x,error:w}=x0(n),j=Pm(),S=c.useMemo(()=>{const oe=[];return Object.entries(j.aliases||{}).forEach(([q,je])=>{const ye=String(q).split("::"),ne=ye.length>1,me=j.aliasCategories&&j.aliasCategories[q]||(ne?ye[0]:""),R=ne?ye.slice(1).join("::"):q,N={key:q,name:R,category:me,text:je,token:me?`${me}:${R}`:R};oe.push({...N,...du(N)})}),oe},[j.aliases,j.aliasCategories]),h=c.useMemo(()=>m0(n,a),[n,a]),f=c.useMemo(()=>{const oe=(h||a||[]).filter(R=>(R==null?void 0:R.class_type)!=="CozyGenImageInput"),q=/\b(checkpoint|ckpt|lora|model|vae|embedding|clip|sampler|scheduler|seed)\b/i,je=R=>{const N=String((R==null?void 0:R.paramName)||"").toLowerCase(),E=String((R==null?void 0:R.label)||"").toLowerCase(),k=`${N} ${E}`,V=g==null?void 0:g[R==null?void 0:R.paramName],G=typeof V=="string"?V:"";let te=0;return k.includes("prompt")&&(te+=100),k.includes("negative")&&k.includes("prompt")&&(te-=15),R!=null&&R.multiline&&(te+=10),G.includes("$")&&(te+=20),q.test(k)&&(te-=200),xm(G)&&(te-=200),te};if(typeof(g==null?void 0:g.prompt)=="string")return"prompt";const ye=oe.map(R=>zs(R)).filter(R=>(R==null?void 0:R.paramType)==="STRING"&&(R==null?void 0:R.paramName));if(!ye.length)return"prompt";let ne=ye[0],me=je(ne);for(let R=1;R<ye.length;R+=1){const N=ye[R],E=je(N);E>me&&(ne=N,me=E)}return(ne==null?void 0:ne.paramName)||"prompt"},[a,g,h]),{isLoading:p,progressValue:v,progressMax:b,statusText:C,statusPhase:_,handleGenerate:I,logEntries:z,clearLogs:A}=j0({selectedWorkflow:n,workflowData:i,dynamicInputs:a,imageInputs:u,formData:g,setFormData:y,promptAliases:j.aliasLookup});c.useEffect(()=>{if(_==="finished"&&!(typeof window>"u")){try{window.localStorage.setItem("cozygen_gallery_pending","1")}catch{}window.dispatchEvent(new Event("cozygen:gallery-pending"))}},[_]),c.useEffect(()=>{if(typeof window>"u")return;const oe=_==="queued"||_==="running"||p;try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:oe}}))}catch{}},[_,p]);const D=c.useMemo(()=>({workflows:t,selectedWorkflow:n,selectWorkflow:r,workflowsLoading:s,workflowsError:o,workflowData:i,dynamicInputs:a,orderedDynamicInputs:h,imageInputs:u,primaryImageInput:d,formData:g,setFormData:y,handleFormChange:m,workflowLoading:x,workflowError:w,promptFieldName:f,aliasOptions:j.aliasOptions,aliasCatalog:S,aliasLookup:j.aliasLookup,aliasCategories:j.aliasCategories,aliasLoading:j.loading,aliasSaving:j.saving,aliasError:j.error,refreshAliases:j.refreshAliases,persistAliases:j.persistAliases,isLoading:p,progressValue:v,progressMax:b,statusText:C,statusPhase:_,handleGenerate:I,logEntries:z,clearLogs:A}),[t,n,r,s,o,i,a,h,u,d,g,y,m,x,w,f,j.aliasOptions,j.aliasLookup,j.aliasCategories,S,j.loading,j.saving,j.error,j.refreshAliases,j.persistAliases,p,v,b,C,_,I,z,A]);return l.jsx(_m.Provider,{value:D,children:e})}const k0=(e="")=>{if(!e||e==="root")return"root";const t=e.split("/").filter(Boolean);return t[t.length-1]||e},b0=c.memo(function({workflows:t=[],selectedWorkflow:n,onWorkflowChange:r,workflowData:s,presets:o=[],presetName:i="",onPresetNameChange:a,selectedPresetId:u="",onPresetSelect:d,onPresetSave:g,onPresetDelete:y,presetStatus:m}){const x=Array.isArray(t)?t:[],w=Array.isArray(o)?o:[],j=w.length,S=j?`${j} saved`:"No presets yet",h=ui("(min-width: 768px)"),[f,p]=c.useState(!1),[v,b]=c.useState(!1),[C,_]=c.useState("All");c.useEffect(()=>{p(!1),b(!1)},[h]);const I=c.useMemo(()=>x.map(N=>{const E=String(N||"");if(!fs(E))return{value:E,isFile:!1,base:"",folderPath:""};const{folderPath:k,base:V}=hi(E);return{value:E,isFile:!0,base:V,folderPath:k||"root"}}),[x]),z=c.useMemo(()=>{const N=new Set(["All"]);return I.forEach(E=>{E.isFile&&E.folderPath&&N.add(E.folderPath)}),Array.from(N).sort((E,k)=>E.localeCompare(k))},[I]),A=z.length>2;c.useEffect(()=>{if(!A){C!=="All"&&_("All");return}z.includes(C)||_("All")},[A,C,z]);const D=c.useMemo(()=>{const N=new Map;return I.forEach(E=>{if(!E.isFile||!E.base)return;const k=E.base.toLowerCase();N.set(k,(N.get(k)||0)+1)}),N},[I]),oe=c.useMemo(()=>{const N=[],E=A&&C==="All";return I.forEach(k=>{if(!k.isFile){N.push({value:k.value,label:k.value});return}if(A&&C!=="All"&&k.folderPath!==C)return;let V=k.base||pn(k.value)||k.value;if(E&&k.base){const G=k.base.toLowerCase();D.get(G)>1&&(V=`${V} (${k0(k.folderPath)})`)}N.push({value:k.value,label:V})}),N},[I,C,D,A]),q=c.useMemo(()=>n?oe.some(N=>String(N.value)===String(n)):!0,[oe,n]),je=c.useMemo(()=>!n||q?oe:[{value:n,label:pn(String(n))},...oe],[q,n,oe]),ye=()=>{p(!1),b(!1)},ne=()=>{if(!h){b(!0);return}p(N=>!N)},me=()=>{g(),ye()},R=()=>{y(),ye()};return l.jsxs("div",{className:"controls-context",children:[l.jsxs("div",{className:"controls-context-row",children:[l.jsxs("div",{className:"controls-context-field",children:[l.jsx("label",{className:"controls-context-label",htmlFor:"workflow-select",children:"Workflow"}),A?l.jsx(Ze,{value:C,onChange:_,className:"controls-context-select mb-2","aria-label":"Workflow folder filter",size:"sm",options:z.map(N=>({value:N,label:N}))}):null,l.jsx(Ze,{id:"workflow-select",value:n||"",onChange:r,className:"controls-context-select","aria-label":"Workflow",size:"sm",placeholder:"Select workflow...",options:je})]}),l.jsxs("div",{className:"controls-context-field",children:[l.jsx("label",{className:"controls-context-label",htmlFor:"preset-select",children:"Preset"}),l.jsx(Ze,{id:"preset-select",value:u||"",onChange:d,className:"controls-context-select","aria-label":"Workflow preset",disabled:!s,size:"sm",placeholder:"Presets...",options:w.map(N=>({value:N.id,label:N.name}))})]}),l.jsx("div",{className:"controls-context-actions",children:l.jsxs("div",{className:"controls-context-menu",children:[l.jsx(Ft,{variant:"ghost",size:"xs",onClick:ne,"aria-haspopup":h?"menu":"dialog","aria-expanded":h?f:v,"aria-label":"Manage presets",children:"Manage presets"}),h&&f?l.jsxs("div",{className:"controls-context-menu-items",role:"menu",children:[l.jsxs("div",{className:"controls-context-menu-row",children:[l.jsx("input",{type:"text",value:i,onChange:N=>a(N.target.value),className:"controls-context-input ui-control ui-input is-compact",placeholder:"Preset name","aria-label":"Preset name",disabled:!s}),l.jsx("button",{type:"button",className:"controls-context-menu-btn",onClick:me,disabled:!s||!i.trim(),role:"menuitem",children:"Save"})]}),l.jsx("button",{type:"button",className:"controls-context-menu-btn is-danger",onClick:R,disabled:!s||!u,role:"menuitem",children:"Delete"})]}):null]})})]}),l.jsxs("div",{className:"controls-context-meta",children:[l.jsx("span",{children:S}),m?l.jsx("span",{className:"controls-context-status",children:m}):null]}),!h&&v?l.jsx(Lt,{open:v,onClose:ye,title:"Manage presets",children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Preset"}),l.jsx(Ze,{value:u||"",onChange:handlePresetSelect,className:"sheet-select","aria-label":"Select preset",size:"sm",options:[{value:"",label:"New preset"},...w.map(N=>({value:N.id,label:N.name}))]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Preset name"}),l.jsx("input",{type:"text",value:i,onChange:N=>a(N.target.value),className:"sheet-input ui-control ui-input",placeholder:"Preset name","aria-label":"Preset name",disabled:!s})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Actions"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:me,disabled:!s||!i.trim(),children:"Save"}),l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:R,disabled:!s||!u,children:"Delete"})]})]})]})}):null]})});function C0(){const e=jn(),{workflows:t=[],selectedWorkflow:n,selectWorkflow:r,workflowData:s,dynamicInputs:o=[],imageInputs:i=[],formData:a,setFormData:u,handleFormChange:d,aliasOptions:g,aliasCatalog:y,isLoading:m,progressValue:x,progressMax:w,statusText:j,statusPhase:S,handleGenerate:h,logEntries:f,clearLogs:p,promptFieldName:v,orderedDynamicInputs:b}=Rm(),C=c.useRef(null),_=c.useRef(null),[I,z]=c.useState(()=>Hw()),[A,D]=c.useState(null),oe=(A==null?void 0:A.name)||"",q=c.useCallback(()=>D(null),[]),[je,ye]=c.useState(!1),[ne,me]=c.useState([]),[R,N]=c.useState([]),[E,k]=c.useState(""),[V,G]=c.useState(""),[te,re]=c.useState(""),X=c.useRef(new Map),ie=c.useCallback((Q="")=>{const ve=`?field=${encodeURIComponent(Q||v||"prompt")}`;e(`/compose${ve}`)},[e,v]),W=c.useCallback(Q=>{!Q||Q===n||(n&&Do(n,a||{},{immediate:!0}),k(""),G(""),re(""),r(Q))},[a,n,r]),F=c.useMemo(()=>{const ue=[...b||[],...i||[]].map(ve=>{var ge;return(ge=ve==null?void 0:ve.inputs)==null?void 0:ge.param_name}).filter(ve=>ve&&typeof ve=="string");return new Set(ue)},[b,i]),O=c.useCallback(Q=>{G(Q);const ue=R.find(ke=>ke.id===Q);if(k((ue==null?void 0:ue.name)||""),!Q||!(ue!=null&&ue.values)||!n){Q||re("");return}const ve=F,ge={};Object.entries(ue.values).forEach(([ke,Le])=>{(!ve.size||ve.has(ke))&&(ge[ke]=Le)}),u(ke=>{const Le={...ke,...ge};return Do(n,Le,{immediate:!0}),Le}),re(`Applied "${ue.name}".`)},[F,R,n,u]),se=i||[],ce=!!(s&&n),Re=se.length>0,Ne=c.useCallback((Q,ue)=>{const ve=X.current;ue&&Q&&ve.set(Q,ue);const ge=ne.length?ne:(ue==null?void 0:ue.order)||[],ke=ge.length,Le=ke>0?ge.indexOf(Q):-1,Fe=Le>0?ge[Le-1]:null,He=Le>=0&&Le<ke-1?ge[Le+1]:null,it=Fe?ve.get(Fe):null,ht=He?ve.get(He):null;return{...ue,index:Le>=0?Le:0,total:ke,onPrev:it?()=>D(Ne(Fe,it)):null,onNext:ht?()=>D(Ne(He,ht)):null,onRender:h}},[ne,h]),Ee=c.useCallback(Q=>{const ue=Q||[];me(ve=>ve.length===ue.length&&ve.every((ge,ke)=>ge===ue[ke])?ve:ue)},[]),Me=c.useCallback(Q=>{const ue=Q||"";z(ue),Ww(ue)},[]),Ke=c.useCallback(Q=>{Q!=null&&Q.name&&D(Ne(Q.name,Q))},[Ne]),le=c.useCallback(async Q=>{if(!Q){N([]),G("");return}try{const ue=await Wx(Q),ve=Array.isArray(ue==null?void 0:ue.presets)?ue.presets:[];N(ve),G(ge=>ge&&ve.some(ke=>ke.id===ge)?ge:"")}catch(ue){console.error("Failed to load workflow presets",ue),N([]),re("Presets unavailable.")}},[]);c.useEffect(()=>{le(n)},[n,le]);const fe=c.useCallback(async()=>{if(!n)return;const Q=E.trim();if(!Q){re("Name a preset to save.");return}const ue={},ve=F;Object.entries(a||{}).forEach(([Le,Fe])=>{(!ve.size||ve.has(Le))&&(ue[Le]=Fe)});const ge=R.find(Le=>Le.id===V),ke=ge&&ge.name.toLowerCase()===Q.toLowerCase()?ge.id:void 0;try{const Le=await Hx(n,{id:ke,name:Q,values:ue}),Fe=Array.isArray(Le==null?void 0:Le.presets)?Le.presets:[],He=Le==null?void 0:Le.preset;N(Fe),He!=null&&He.id&&G(He.id),re(`Saved "${Q}".`)}catch(Le){console.error("Failed to save preset",Le),re("Save failed.")}},[F,a,E,R,V,n]),Pe=c.useCallback(async()=>{if(!(!n||!V))try{const Q=await Gx(n,V),ue=Array.isArray(Q==null?void 0:Q.presets)?Q.presets:[];N(ue),G(""),re("Preset deleted.")}catch(Q){console.error("Failed to delete preset",Q),re("Delete failed.")}},[V,n]),We=c.useCallback(()=>{var Q;return(Q=A==null?void 0:A.render)==null?void 0:Q.call(A,a)},[A,a]);return c.useEffect(()=>{const Q=()=>{!ce||m||h()};return window.addEventListener("cozygen:request-render",Q),()=>window.removeEventListener("cozygen:request-render",Q)},[h,ce,m]),!t||t.length===0?l.jsx("div",{className:"page-shell",children:l.jsx("div",{className:"neon-card px-3 py-3 sm:px-4 sm:py-4",children:l.jsx("p",{className:"text-sm text-[#9DA3FFCC]",children:"No workflows found. Drop a workflow file in CozyGen and refresh."})})}):l.jsxs("div",{className:"page-shell page-stack has-dock controls-page",children:[l.jsxs("div",{className:"page-bar controls-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Controls"}),l.jsx("div",{className:"page-bar-actions",children:I?l.jsxs("span",{className:"controls-meta",children:["Last: ",I]}):null})]}),l.jsxs("section",{className:"controls-board",children:[l.jsxs(gf,{title:l.jsxs(l.Fragment,{children:[l.jsx(cu,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Parameters"]}),bodyClassName:"control-shell controls-body",defaultOpen:!0,className:"controls-panel",children:[l.jsx(b0,{workflows:t,selectedWorkflow:n,onWorkflowChange:W,workflowData:s,presets:R,presetName:E,onPresetNameChange:k,selectedPresetId:V,onPresetSelect:O,onPresetSave:fe,onPresetDelete:Pe,presetStatus:te}),s?l.jsx(a0,{workflowName:n,dynamicInputs:b,formData:a,onFormChange:d,parameterSectionRef:C,compactControls:!0,lastEditedParam:I,spotlightName:oe,onCloseSpotlight:q,onVisibleParamsChange:Ee,aliasOptions:g,aliasCatalog:y,onOpenComposer:ie,onParamEdited:Me,onSpotlight:Ke}):l.jsxs("div",{className:"empty-state-inline",children:[l.jsx("span",{className:"empty-state-arrow",children:l.jsx(ew,{size:20})}),l.jsx("span",{children:"Select a workflow above to get started"})]})]}),Re?l.jsx(gf,{ref:_,className:"scroll-mt-24 controls-panel controls-subpanel",title:l.jsxs(l.Fragment,{children:[l.jsx(Zx,{size:18,className:"inline-block mr-2 align-text-bottom"}),"Images"]}),defaultOpen:!1,variant:"bare",children:s?l.jsx("div",{className:"grid grid-cols-1 gap-3 lg:grid-cols-2",children:se.map(Q=>l.jsx(ww,{input:Q,value:a[Q.inputs.param_name]||"",onFormChange:d},Q.id))}):null}):null]}),l.jsxs("div",{className:"controls-status-strip",children:[l.jsxs("div",{className:"controls-status-left",children:[l.jsx("span",{className:`controls-status-dot is-${S||"idle"}`,"aria-hidden":"true"}),l.jsxs("div",{className:"controls-status-text",children:[l.jsx("span",{className:"controls-status-phase",children:S||"idle"}),l.jsx("span",{className:"controls-status-msg",children:j||"Idle"})]})]}),l.jsxs("div",{className:"controls-status-right",children:[m&&w>0?l.jsx("div",{className:"controls-status-meter","aria-label":"Progress",children:l.jsx("div",{className:"controls-status-meter-fill",style:{width:`${Math.max(0,Math.min(100,Math.round((x||0)/w*100)))}%`}})}):null,l.jsx("button",{type:"button",className:"controls-status-btn",onClick:()=>ye(!0),children:"Logs"})]})]}),l.jsx("section",{className:"dock-panel",children:l.jsx(cw,{busy:m,progressValue:x,progressMax:w,statusText:j,statusPhase:S,primaryLabel:"Render",onPrimary:h,primaryDisabled:!ce,onLogs:()=>ye(!0)})}),l.jsx(Sw,{open:!!A,onClose:q,title:A==null?void 0:A.label,description:A==null?void 0:A.description,render:We,index:(A==null?void 0:A.index)??0,total:(A==null?void 0:A.total)??0,onPrev:(A==null?void 0:A.onPrev)||null,onNext:(A==null?void 0:A.onNext)||null,onRender:(A==null?void 0:A.onRender)||null,children:null}),l.jsx(c0,{open:je,onClose:()=>ye(!1),logs:f,onClear:p})]})}function E0(){return l.jsx("div",{className:"page-shell page-stack",children:l.jsxs("section",{className:"home-hero",children:[l.jsx("span",{className:"home-hero-orb is-warm","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-orb is-cool","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-spark","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-beam","aria-hidden":"true"}),l.jsx("span",{className:"home-hero-ring","aria-hidden":"true"}),l.jsxs("div",{className:"home-hero-inner home-hero-full",children:[l.jsx("div",{className:"home-hero-kicker",children:"CozyGen Studio"}),l.jsx("h1",{className:"home-hero-title",children:"Creative studio for prompt-first storytelling"}),l.jsx("p",{className:"home-hero-description",children:"CozyGen is a quiet, cinematic workspace for people who sketch with wordsshape the mood, stage the scene, then send it down the render runway without losing your flow."}),l.jsxs("div",{className:"home-info-grid",children:[l.jsxs("article",{className:"home-info-card",children:[l.jsx("h3",{children:"Control as composition"}),l.jsx("p",{children:"Dial the palette, tempo, and texture in one place. The controls read like a creative brief, not a checklist."})]}),l.jsxs("article",{className:"home-info-card",children:[l.jsx("h3",{children:"Alias & tag storyboards"}),l.jsx("p",{children:"Save characters, atmospheres, and motifs as building blocks, then arrange them like panels in a storyboard."})]}),l.jsxs("article",{className:"home-info-card",children:[l.jsx("h3",{children:"Gallery inspiration"}),l.jsx("p",{children:"Pin your strongest frames, compare variations, and carry the aesthetic through to your next scene."})]}),l.jsxs("article",{className:"home-info-card",children:[l.jsx("h3",{children:"Render runway"}),l.jsx("p",{children:"Stack iterations like takes on a set. Keep composing while the queue runs in the background."})]})]})]})]})})}function L0({subfolder:e,crumbs:t=[],dirChips:n=[],onBack:r,onRoot:s,onCrumb:o,onSelectDir:i}){return l.jsxs("div",{className:"gallery-nav",children:[l.jsx("div",{className:"gallery-crumbs",role:"navigation","aria-label":"Gallery path",children:t.map((a,u)=>l.jsxs(c.Fragment,{children:[l.jsx("span",{className:"text-[#6A6FA8]",children:"/"}),l.jsx("button",{type:"button",className:"gallery-chip-btn",onClick:()=>o==null?void 0:o(a.path),"aria-current":u===t.length-1?"page":void 0,children:a.name})]},a.path||a.name||u))}),n.length>0?l.jsx("div",{className:"gallery-dir-chips",children:n.map(a=>l.jsx("button",{type:"button",className:"gallery-chip-btn",onClick:()=>i==null?void 0:i(a.subfolder),children:a.filename||a.subfolder||"Collection"},a.subfolder||a.filename))}):null]})}const P0=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),_0=({src:e,poster:t,autoPlay:n})=>{const r=c.useRef(null),s=pu();return c.useEffect(()=>{const o=r.current;o&&(o.pause(),o.currentTime=0,o.load())},[e]),c.useEffect(()=>{const o=r.current;if(!o)return;let i;const a=()=>{const d=o.play();d&&typeof d.catch=="function"&&d.catch(()=>{})},u=()=>{o.pause()};return n?s?typeof window<"u"&&"IntersectionObserver"in window?(i=new IntersectionObserver(g=>{g.forEach(y=>{y.isIntersecting?a():u()})},{threshold:.65}),i.observe(o)):a():u():(u(),o.currentTime=0),()=>{i&&i.disconnect(),u()}},[n,e,s]),e?l.jsx("video",{ref:r,src:e,poster:t||void 0,muted:!0,playsInline:!0,loop:!0,preload:n?"metadata":"none",className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40"}):l.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})},jf={contentVisibility:"auto",containIntrinsicSize:"260px 320px"};function R0({item:e,onSelect:t,variant:n="grid",autoPlay:r=!1}){if(!e)return null;const s=e.type==="directory",o=e.filename||"",i=e.subfolder||"",a=o||i||"Unknown",u=!!(e!=null&&e.meta&&(e.meta.model||e.meta.prompt||Array.isArray(e.meta.loras)&&e.meta.loras.length)),d=()=>{t&&t(e)},g=n==="feed"?768:384,y=!s&&o?`/cozygen/thumb?type=output&subfolder=${encodeURIComponent(i)}&filename=${encodeURIComponent(o)}&w=`:null,m=y?`${y}${g}`:null,x=y?n==="feed"?`${y}384 384w, ${y}768 768w`:`${y}192 192w, ${y}384 384w`:null,w=n==="feed"?"(max-width: 768px) 92vw, 768px":"(max-width: 640px) 45vw, (max-width: 1024px) 30vw, 240px",j=!s&&o?(()=>{const h=e.type&&e.type!=="directory"?e.type:"output",f=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(o)}&subfolder=${encodeURIComponent(i)}&type=${encodeURIComponent(h)}${f}`})():null,S=P0(o);if(s)return l.jsx("button",{type:"button",onClick:d,className:"gallery-dir-tile",style:jf,children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"h-7 w-7 rounded-lg bg-gradient-to-br from-[#6B5BFF] to-[#FF4F9A] opacity-80 group-hover:opacity-100 flex items-center justify-center text-[11px] text-white",children:""}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-[11px] font-medium text-[#E5E7FF] truncate",children:a}),l.jsx("div",{className:"text-[10px] text-[#9DA3FFCC] truncate",children:"Collection"})]})]})});if(n==="feed"){const h={contentVisibility:"auto",containIntrinsicSize:"520px 720px"};return l.jsxs("div",{className:"gallery-feed-item",style:h,children:[l.jsxs("button",{type:"button",onClick:d,className:"gallery-feed-media",children:[u?l.jsx("span",{className:"gallery-meta-badge",role:"img","aria-label":"Metadata available",title:"Metadata available",children:"i"}):null,l.jsx("div",{className:"relative w-full flex items-center justify-center bg-[#020312]",children:S?l.jsx(_0,{src:j,poster:m,autoPlay:r}):m?l.jsx("img",{src:m,srcSet:x||void 0,sizes:w,alt:a,className:"w-full h-auto max-h-[80vh] rounded-2xl object-contain bg-black/40",loading:"lazy",decoding:"async"}):l.jsx("div",{className:"flex items-center justify-center py-16 text-[11px] text-[#9DA3FFCC]",children:"No preview available"})}),l.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#05071680] opacity-0 group-hover:opacity-100 transition-opacity"}),S&&l.jsx("div",{className:"pointer-events-none absolute left-2 top-2 rounded-md bg-[#050716CC] px-2 py-[1px] text-[10px] text-[#CFFAFE] border border-[#3EF0FF80]",children:"Video"})]}),l.jsx("div",{className:"gallery-feed-meta",children:l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"gallery-feed-title",children:a}),i&&l.jsx("div",{className:"gallery-feed-subfolder",children:i})]})})]})}return l.jsxs("button",{type:"button",onClick:d,className:"gallery-tile",style:jf,children:[l.jsxs("div",{className:"gallery-tile-media",children:[u?l.jsx("span",{className:"gallery-meta-badge",role:"img","aria-label":"Metadata available",title:"Metadata available",children:"i"}):null,m?l.jsx("img",{src:m,srcSet:x||void 0,sizes:w,alt:a,className:"gallery-tile-img",loading:"lazy",decoding:"async"}):l.jsx("div",{className:"gallery-tile-empty",children:"No preview"}),S&&l.jsx("div",{className:"gallery-badge",children:"Video"})]}),l.jsx("div",{className:"gallery-tile-caption",children:l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsx("div",{className:"gallery-tile-title",children:a}),S&&l.jsx("span",{className:"gallery-tile-flag",children:"Vid"})]})})]})}const Nf=c.memo(R0),hu=["seed","noise_seed"],Im=["ckpt_name","checkpoint","ckpt","model_name"],lc=["lora_name"],zm=["width","image_width"],Am=["height","image_height"],wl=e=>String(e||"").toLowerCase(),ul=e=>(e==null?void 0:e.class_type)==="CozyGenDynamicInput"||(e==null?void 0:e.class_type)==="CozyGenChoiceInput",dl=e=>{var t;return wl((t=e==null?void 0:e.inputs)==null?void 0:t.choice_type)},Bo=(e,t)=>{e!=null&&e.inputs&&("default_value"in e.inputs&&(e.inputs.default_value=t),"value"in e.inputs&&(e.inputs.value=t))},Tm=e=>wl(e==null?void 0:e.class_type).includes("checkpoint"),Mm=e=>wl(e==null?void 0:e.class_type).includes("lora"),$m=e=>wl(e==null?void 0:e.class_type).includes("seed"),mu=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;const t=parseInt(String(e),10);return Number.isFinite(t)?t:null},Sn=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;const t=parseInt(String(e),10);return Number.isFinite(t)?t:null},Kl=e=>e!=null&&e.inputs?"default_value"in e.inputs?Sn(e.inputs.default_value):"value"in e.inputs?Sn(e.inputs.value):null:null,oc=e=>{var t;return wl((t=e==null?void 0:e.inputs)==null?void 0:t.param_name)},Ql=(e,t)=>{if(!(e!=null&&e.inputs))return!1;let n=!1;return"default_value"in e.inputs&&Sn(e.inputs.default_value)!==null&&(e.inputs.default_value=t,n=!0),"value"in e.inputs&&Sn(e.inputs.value)!==null&&(e.inputs.value=t,n=!0),n},kf=(e,t)=>{if(!(e!=null&&e.inputs))return!1;let n=!1;return hu.forEach(r=>{if(!(r in e.inputs))return;const s=e.inputs[r];Array.isArray(s)||mu(s)!==null&&(e.inputs[r]=t,n=!0)}),n},I0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(hu.forEach(s=>{if(!(s in r.inputs))return;const o=r.inputs[s];if(Array.isArray(o)&&o.length){n.add(o[0]);return}mu(o)!==null&&(r.inputs[s]=t)}),$m(r)&&kf(r,t))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&kf(s,t)})},z0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(ul(r)&&dl(r)==="checkpoints"&&Bo(r,t),Tm(r)&&Im.forEach(s=>{if(!(s in r.inputs))return;const o=r.inputs[s];if(Array.isArray(o)&&o.length){n.add(o[0]);return}(typeof o=="string"||typeof o=="number")&&(r.inputs[s]=t)}))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&ul(s)&&dl(s)==="checkpoints"&&Bo(s,t)})},A0=(e,t)=>{const n=new Set;Object.values(e||{}).forEach(r=>{r!=null&&r.inputs&&(ul(r)&&dl(r)==="loras"&&Bo(r,t),(Mm(r)||lc.some(s=>s in r.inputs))&&lc.forEach(s=>{if(!(s in r.inputs))return;const o=r.inputs[s];if(Array.isArray(o)&&o.length){n.add(o[0]);return}(typeof o=="string"||typeof o=="number")&&(r.inputs[s]=t)}))}),n.forEach(r=>{const s=e==null?void 0:e[r];s&&ul(s)&&dl(s)==="loras"&&Bo(s,t)})},T0=(e,t,n)=>{if(t===null&&n===null)return;const r=new Set,s=new Set;Object.values(e||{}).forEach(o=>{if(!(o!=null&&o.inputs))return;const i=o.inputs,a=oc(o);t!==null&&a==="width"&&Ql(o,t),n!==null&&a==="height"&&Ql(o,n),t!==null&&zm.forEach(u=>{if(!(u in i))return;const d=i[u];if(Array.isArray(d)&&d.length){r.add(d[0]);return}Sn(d)!==null&&(i[u]=t)}),n!==null&&Am.forEach(u=>{if(!(u in i))return;const d=i[u];if(Array.isArray(d)&&d.length){s.add(d[0]);return}Sn(d)!==null&&(i[u]=n)})}),r.forEach(o=>{const i=e==null?void 0:e[o];i&&Ql(i,t)}),s.forEach(o=>{const i=e==null?void 0:e[o];i&&Ql(i,n)})};function M0(e){const t={hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null},n=new Set,r=new Set;return Object.values(e||{}).forEach(s=>{const o=(s==null?void 0:s.inputs)||{};if(o){if(hu.forEach(i=>{i in o&&(t.hasSeed=!0)}),Tm(s)&&(t.hasCheckpoint=!0,Im.forEach(i=>{const a=o[i];typeof a=="string"&&a&&n.add(a)})),Mm(s)||lc.some(i=>i in o)){t.hasLora=!0;const i=o.lora_name;typeof i=="string"&&i&&r.add(i)}if(ul(s)){const i=dl(s),a=o.default_value??o.value;i==="checkpoints"&&(t.hasCheckpoint=!0,typeof a=="string"&&a&&n.add(a)),i==="loras"&&(t.hasLora=!0,typeof a=="string"&&a&&r.add(a))}if($m(s)&&"seed"in o&&(t.hasSeed=!0),t.width===null&&oc(s)==="width"){const i=Kl(s);i!==null&&(t.width=i)}if(t.height===null&&oc(s)==="height"){const i=Kl(s);i!==null&&(t.height=i)}t.width===null&&zm.forEach(i=>{if(!(i in o)||t.width!==null)return;const a=o[i];if(Array.isArray(a)&&a.length){const d=e==null?void 0:e[a[0]],g=Kl(d);g!==null&&(t.width=g);return}const u=Sn(a);u!==null&&(t.width=u)}),t.height===null&&Am.forEach(i=>{if(!(i in o)||t.height!==null)return;const a=o[i];if(Array.isArray(a)&&a.length){const d=e==null?void 0:e[a[0]],g=Kl(d);g!==null&&(t.height=g);return}const u=Sn(a);u!==null&&(t.height=u)})}}),t.checkpoint=n.values().next().value||"",t.loras=Array.from(r),t.hasSize=t.width!==null||t.height!==null,t}function $0(e,t={}){if(!e)return e;const n=bm(e),{seedMode:r="keep",seedValue:s=null,checkpoint:o=null,lora:i=null,width:a=null,height:u=null}=t;if(r&&r!=="keep"){const y=r==="random"?-1:mu(s);y!==null&&I0(n,y)}o&&z0(n,o),i&&A0(n,i);const d=Sn(a),g=Sn(u);return(d!==null||g!==null)&&T0(n,d,g),n}const F0=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e),O0=e=>{if(!e)return"";const t=e.filename||"",n=e.subfolder||"",r=e.type||"output",s=e.mtime?`&v=${encodeURIComponent(String(e.mtime))}`:"";return`/view?filename=${encodeURIComponent(t)}&subfolder=${encodeURIComponent(n)}&type=${encodeURIComponent(r)}${s}`},bf=e=>{if(!fs(e))return null;const{folderPath:t,base:n}=hi(e);return{folderPath:t||"root",base:n||""}},Cf=(e="")=>{if(!e||e==="root")return"root";const t=e.split("/").filter(Boolean);return t[t.length-1]||e};function D0({isOpen:e,media:t,onClose:n,onPrev:r,onNext:s,total:o=0,canPrev:i=!1,canNext:a=!1}){var Nl;const u=c.useRef(!1),d=c.useRef(null),[g,y]=c.useState(!1),[m,x]=c.useState(!1),w=c.useRef(null),j=c.useRef(null),S=c.useRef(!1),h=c.useRef(null),[f,p]=c.useState(!1),[v,b]=c.useState("random"),[C,_]=c.useState(""),[I,z]=c.useState(""),[A,D]=c.useState(""),[oe,q]=c.useState(""),[je,ye]=c.useState(""),[ne,me]=c.useState("All"),[R,N]=c.useState("All"),[E,k]=c.useState({hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null}),[V,G]=c.useState(!1),[te,re]=c.useState(""),[X,ie]=c.useState(!1),[W,F]=c.useState(""),[O,se]=c.useState([]),[ce,Re]=c.useState([]),Ne=c.useRef(null),Ee=c.useRef(null),Me=B=>B?Array.from(B.querySelectorAll('a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])')).filter(ee=>!ee.hasAttribute("disabled")&&ee.getAttribute("aria-hidden")!=="true"):[];c.useEffect(()=>{if(!e)return;const B=ee=>{ee.key==="Escape"&&(n==null||n()),ee.key==="ArrowLeft"&&i&&(r==null||r()),ee.key==="ArrowRight"&&a&&(s==null||s())};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[e,n,s,r,i,a]),c.useEffect(()=>{e&&(y(!1),p(!1),b("random"),_(""),z(""),D(""),q(""),ye(""),me("All"),N("All"),k({hasSeed:!1,hasCheckpoint:!1,hasLora:!1,checkpoint:"",loras:[],hasSize:!1,width:null,height:null}),G(!1),re(""),ie(!1),F(""),se([]),Re([]),Ne.current=null,Ee.current&&(Ee.current.abort(),Ee.current=null),S.current=!0,h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{S.current=!1,h.current=null},250))},[e,t]),c.useEffect(()=>()=>{h.current&&(clearTimeout(h.current),h.current=null)},[]),c.useEffect(()=>{if(!e||typeof document>"u")return;const B=w.current;j.current=document.activeElement;const ee=()=>{var St;const Ae=Me(B),Ue=d.current||Ae[0]||B;(St=Ue==null?void 0:Ue.focus)==null||St.call(Ue)},ze=Ae=>{if(Ae.key!=="Tab"||!B)return;const Ue=Me(B);if(!Ue.length){Ae.preventDefault(),B.focus();return}const St=Ue[0],kl=Ue[Ue.length-1],bl=document.activeElement;Ae.shiftKey&&bl===St?(Ae.preventDefault(),kl.focus()):!Ae.shiftKey&&bl===kl&&(Ae.preventDefault(),St.focus())};return requestAnimationFrame(ee),B==null||B.addEventListener("keydown",ze),()=>{var Ue;B==null||B.removeEventListener("keydown",ze);const Ae=j.current;Ae&&document.contains(Ae)&&((Ue=Ae.focus)==null||Ue.call(Ae))}},[e]);const Ke=!!t,le=t?O0(t):"",fe=(t==null?void 0:t.subfolder)||"Gallery",Pe=F0((t==null?void 0:t.filename)||""),We=o>1,Q=(t==null?void 0:t.meta)||{},ue=[Q!=null&&Q.model?{label:"Model",value:Q.model}:null,Q!=null&&Q.prompt?{label:"Prompt",value:Q.prompt,isPrompt:!0}:null,Array.isArray(Q==null?void 0:Q.loras)&&Q.loras.length?{label:"LoRAs",value:Q.loras.join(", ")}:null].filter(Boolean),ve=!!((Nl=t==null?void 0:t.meta)!=null&&Nl.has_prompt||ue.length),ge=typeof(t==null?void 0:t.filename)=="string"&&t.filename.toLowerCase().endsWith(".png"),ke=Ke&&ve&&ge,Le=c.useMemo(()=>[{key:"random",label:"Random"},{key:"keep",label:"Keep"},{key:"custom",label:"Custom"}],[]),Fe=c.useMemo(()=>{if(v!=="custom")return null;const B=parseInt(String(C),10);return Number.isFinite(B)?B:null},[C,v]),He=v!=="custom"||Fe!==null,it=c.useMemo(()=>{if(!String(I||"").trim())return null;const B=parseInt(String(I),10);return Number.isFinite(B)&&B>0?B:null},[I]),ht=c.useMemo(()=>{if(!String(A||"").trim())return null;const B=parseInt(String(A),10);return Number.isFinite(B)&&B>0?B:null},[A]),mt=(!String(I||"").trim()||it!==null)&&(!String(A||"").trim()||ht!==null),ut=!!String(I||"").trim()&&it===null,M=!!String(A||"").trim()&&ht===null,Z=E.checkpoint||(Q==null?void 0:Q.model)||"",xe=Array.isArray(E.loras)?E.loras:[],Ie=Z?pn(Z):"",U=xe.length?xe.map(B=>pn(B)).join(", "):"",Y=c.useMemo(()=>(O||[]).map(B=>{const ee=String(B||"");return{value:ee,meta:bf(ee)}}),[O]),ae=c.useMemo(()=>(ce||[]).map(B=>{const ee=String(B||"");return{value:ee,meta:bf(ee)}}),[ce]),we=c.useMemo(()=>{const B=new Set(["All"]);return Y.forEach(({meta:ee})=>{ee!=null&&ee.folderPath&&B.add(ee.folderPath)}),Array.from(B).sort((ee,ze)=>ee.localeCompare(ze))},[Y]),de=c.useMemo(()=>{const B=new Set(["All"]);return ae.forEach(({meta:ee})=>{ee!=null&&ee.folderPath&&B.add(ee.folderPath)}),Array.from(B).sort((ee,ze)=>ee.localeCompare(ze))},[ae]),P=we.length>2,$=de.length>2;c.useEffect(()=>{if(!P){ne!=="All"&&me("All");return}we.includes(ne)||me("All")},[ne,we,P]),c.useEffect(()=>{if(!$){R!=="All"&&N("All");return}de.includes(R)||N("All")},[R,de,$]);const H=c.useMemo(()=>{const B=new Map;return Y.forEach(({meta:ee})=>{if(!(ee!=null&&ee.base))return;const ze=ee.base.toLowerCase();B.set(ze,(B.get(ze)||0)+1)}),B},[Y]),K=c.useMemo(()=>{const B=new Map;return ae.forEach(({meta:ee})=>{if(!(ee!=null&&ee.base))return;const ze=ee.base.toLowerCase();B.set(ze,(B.get(ze)||0)+1)}),B},[ae]),be=c.useMemo(()=>{const B=[],ee=P&&ne==="All";return Y.forEach(({value:ze,meta:Ae})=>{if(!Ae){B.push({value:ze,label:ze});return}if(P&&ne!=="All"&&Ae.folderPath!==ne)return;let Ue=Ae.base||pn(ze)||ze;if(ee&&Ae.base){const St=Ae.base.toLowerCase();H.get(St)>1&&(Ue=`${Ue} (${Cf(Ae.folderPath)})`)}B.push({value:ze,label:Ue})}),B},[Y,ne,H,P]),Se=c.useMemo(()=>{const B=[],ee=$&&R==="All";return ae.forEach(({value:ze,meta:Ae})=>{if(!Ae){B.push({value:ze,label:ze});return}if($&&R!=="All"&&Ae.folderPath!==R)return;let Ue=Ae.base||pn(ze)||ze;if(ee&&Ae.base){const St=Ae.base.toLowerCase();K.get(St)>1&&(Ue=`${Ue} (${Cf(Ae.folderPath)})`)}B.push({value:ze,label:Ue})}),B},[ae,R,K,$]),qe=c.useMemo(()=>oe?be.some(B=>String(B.value)===String(oe)):!0,[be,oe]),Te=c.useMemo(()=>je?Se.some(B=>String(B.value)===String(je)):!0,[Se,je]),nt=c.useMemo(()=>!oe||qe?be:[{value:oe,label:pn(String(oe))},...be],[oe,qe,be]),Nn=c.useMemo(()=>!je||Te?Se:[{value:je,label:pn(String(je))},...Se],[je,Te,Se]),kn=c.useCallback(async B=>{const ee=B==null?void 0:B.hasCheckpoint,ze=B==null?void 0:B.hasLora;if(!ee&&!ze)return;Ee.current&&Ee.current.abort();const Ae=new AbortController;Ee.current=Ae,ie(!0),F("");try{const[Ue,St]=await Promise.all([ee&&!O.length?Xa("checkpoints",{signal:Ae.signal}):null,ze&&!ce.length?Xa("loras",{signal:Ae.signal}):null]);Ue!=null&&Ue.choices&&se(Ue.choices),St!=null&&St.choices&&Re(St.choices)}catch(Ue){if((Ue==null?void 0:Ue.name)==="AbortError")return;F("Unable to load model choices right now.")}finally{Ee.current===Ae&&(Ee.current=null),ie(!1)}},[O.length,ce.length]),Bn=c.useCallback(async()=>{var B;if(!t)throw new Error("media_missing");if(Ne.current)return{prompt:Ne.current,info:E};G(!0),re("");try{const ee=await Ux({filename:t.filename,subfolder:t.subfolder||""}),ze=ee==null?void 0:ee.prompt;if(!ze)throw new Error("prompt_missing");const Ae=M0(ze);return Ne.current=ze,k(Ae),{prompt:ze,info:Ae}}catch(ee){const ze=((B=ee==null?void 0:ee.payload)==null?void 0:B.error)||(ee==null?void 0:ee.message)||"Unable to load prompt metadata.";throw re(ze),ee}finally{G(!1)}},[t==null?void 0:t.filename,t==null?void 0:t.subfolder,E]),Sl=c.useCallback(async()=>{if(ke){p(!0),me("All"),N("All");try{const B=await Bn(),ee=B==null?void 0:B.info;z(ze=>String(ze||"").trim()?ze:(ee==null?void 0:ee.width)!==null&&(ee==null?void 0:ee.width)!==void 0?String(ee.width):""),D(ze=>String(ze||"").trim()?ze:(ee==null?void 0:ee.height)!==null&&(ee==null?void 0:ee.height)!==void 0?String(ee.height):""),await kn(B==null?void 0:B.info)}catch{}}},[ke,kn,Bn]),Ht=B=>{if(!(typeof window>"u"))try{window.dispatchEvent(new CustomEvent("cozygen:render-state",{detail:{active:B}}))}catch{}},jl=async()=>{var B;if(!(!t||m||!ke)){if(!He){alert("Enter a valid seed value.");return}if(!mt){alert("Enter valid width and height values.");return}x(!0),Ht(!0);try{const{prompt:ee}=await Bn(),Ae=$0(ee,{seedMode:v,seedValue:v==="custom"?Fe:null,checkpoint:oe||null,lora:je||null,width:it,height:ht});im({workflowName:t.filename||"gallery",workflow:Ae,timestamp:Date.now()}),await ou({prompt:Ae}),Ht(!1),p(!1)}catch(ee){if(Ht(!1),ee!=null&&ee.unauthorized){window.location.hash="#/login";return}const ze=((B=ee==null?void 0:ee.payload)==null?void 0:B.error)||(ee==null?void 0:ee.message)||"Unable to re-run this item.";alert(ze)}finally{x(!1)}}};return!t||!e||typeof document>"u"?null:tu.createPortal(l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"react-modal-overlay",role:"presentation",onPointerDown:B=>{u.current=B.target===B.currentTarget},onClick:B=>{u.current&&B.target===B.currentTarget&&(S.current||n==null||n())},children:l.jsx("div",{className:"react-modal-content",ref:w,role:"dialog","aria-modal":"true","aria-label":"Preview",onClick:B=>B.stopPropagation(),tabIndex:-1,children:l.jsxs("div",{className:"media-viewer-panel",children:[l.jsxs("header",{className:"media-viewer-head",children:[l.jsxs("div",{className:"media-viewer-head-bar bottom-sheet-head",children:[l.jsxs("div",{className:"media-viewer-meta",children:[l.jsx("div",{className:"media-viewer-title",title:t.filename,children:t.filename}),l.jsxs("div",{className:"media-viewer-sub",children:[l.jsx("span",{className:"media-chip",children:fe}),l.jsx("span",{className:`media-chip ${Pe?"is-clip":"is-still"}`,children:Pe?"Video":"Image"})]})]}),l.jsx("button",{ref:d,type:"button",className:"bottom-sheet-close media-viewer-close",onClick:n,"aria-label":"Close",children:l.jsx(ur,{size:16})})]}),l.jsxs("div",{className:"media-viewer-actions",children:[ke?l.jsx(Ft,{variant:"ghost",size:"sm",onClick:Sl,disabled:m,"aria-label":"Re-run generation",children:m?"Re-running":"Re-run"}):null,ue.length?l.jsx(Ft,{variant:"ghost",size:"sm",onClick:()=>y(B=>!B),"aria-expanded":g,"aria-label":g?"Hide metadata":"Show metadata",children:g?"Hide metadata":"Metadata"}):null,l.jsx(Ft,{as:"a",href:le,target:"_blank",rel:"noreferrer",variant:"ghost",size:"sm",children:"Open"})]})]}),g&&ue.length?l.jsx("div",{className:"media-viewer-info","aria-label":"Generation metadata",children:ue.map(B=>l.jsxs("div",{className:"media-info-row",children:[l.jsx("span",{className:"media-info-label",children:B.label}),l.jsx("span",{className:`media-info-value ${B.isPrompt?"is-prompt":""}`,children:B.value})]},B.label))}):null,l.jsxs("div",{className:"media-viewer-stage",children:[We?l.jsx("button",{type:"button",className:`media-stage-nav is-left ${i?"":"is-disabled"}`,onClick:r,"aria-label":"Previous",disabled:!i,children:l.jsx(pm,{size:18})}):null,l.jsx("div",{className:"media-viewer-frame",children:Pe?l.jsx("video",{src:le,controls:!0,className:"media-viewer-media",autoPlay:!0,muted:!0,playsInline:!0}):l.jsx("img",{src:le,alt:t.filename,className:"media-viewer-media",decoding:"async"})}),We?l.jsx("button",{type:"button",className:`media-stage-nav is-right ${a?"":"is-disabled"}`,onClick:s,"aria-label":"Next",disabled:!a,children:l.jsx(di,{size:18})}):null]})]})})}),l.jsx(Lt,{open:f,onClose:()=>p(!1),title:"Re-run options",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>p(!1),disabled:m,children:"Cancel"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:jl,disabled:m||V||!!te||!He||!mt,children:m?"Re-running":"Run"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[V?l.jsx("div",{className:"composer-alias-empty",children:"Loading prompt"}):null,te?l.jsx("div",{className:"text-xs text-[#FF8F70]",children:te}):null,l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Seed"}),l.jsx(br,{ariaLabel:"Seed mode",value:v,onChange:b,size:"sm",items:Le}),v==="custom"?l.jsx("input",{type:"number",inputMode:"numeric",className:"ui-control ui-input mt-2",placeholder:"Enter seed",value:C,onChange:B=>_(B.target.value)}):null,l.jsx("div",{className:"sheet-hint text-xs text-[#9DA3FFCC]",children:v==="random"?"Randomize each run":"Keep or customize the seed used in the prompt."})]}),E.hasSize?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Size"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"number",inputMode:"numeric",min:1,step:1,className:"ui-control ui-input flex-1",placeholder:"Width",value:I,onChange:B=>z(B.target.value),"aria-label":"Width","aria-invalid":ut}),l.jsx("span",{className:"text-xs text-[#9DA3FF99]","aria-hidden":"true",children:""}),l.jsx("input",{type:"number",inputMode:"numeric",min:1,step:1,className:"ui-control ui-input flex-1",placeholder:"Height",value:A,onChange:B=>D(B.target.value),"aria-label":"Height","aria-invalid":M})]})]}):null,E.hasCheckpoint?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Checkpoint"}),P?l.jsx(Ze,{value:ne,onChange:me,className:"sheet-select","aria-label":"Checkpoint folder filter",size:"sm",options:we.map(B=>({value:B,label:B}))}):null,l.jsx(Ze,{value:oe,onChange:q,className:`sheet-select ${P?"mt-2":""}`,"aria-label":"Checkpoint override",size:"sm",options:[{value:"",label:Ie?`Keep current (${Ie})`:"Keep current"},...nt]})]}):null,E.hasLora?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"LoRA"}),$?l.jsx(Ze,{value:R,onChange:N,className:"sheet-select","aria-label":"LoRA folder filter",size:"sm",options:de.map(B=>({value:B,label:B}))}):null,l.jsx(Ze,{value:je,onChange:ye,className:`sheet-select ${$?"mt-2":""}`,"aria-label":"LoRA override",size:"sm",options:[{value:"",label:U?`Keep current (${U})`:"Keep current"},...Nn]})]}):null,X?l.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:"Loading model choices"}):null,W?l.jsx("div",{className:"text-xs text-[#FF8F70]",children:W}):null]})})]}),document.body)}const U0=(e="")=>e.startsWith("."),B0=(e="")=>/\.(png|jpe?g|gif|webp|bmp|tif?f)$/i.test(e),V0=(e="")=>/\.(mp4|webm|mov|mkv)$/i.test(e);function W0(){const e=pu(),t=(W,F="")=>{try{return typeof window<"u"&&localStorage.getItem(W)||F}catch{return F}},n=(W,F)=>{try{typeof window<"u"&&localStorage.setItem(W,F)}catch{}},[r,s]=c.useState(t("galleryPath","")),[o,i]=c.useState([]),[a,u]=c.useState(!1),[d,g]=c.useState(!1),[y,m]=c.useState(""),[x,w]=c.useState(1),[j,S]=c.useState(1),[h,f]=c.useState(()=>{const W=t("galleryPageSize","30"),F=parseInt(W,10);return Number.isFinite(F)?F:30}),[p,v]=c.useState("all"),[b,C]=c.useState(!1),[_,I]=c.useState(""),[z,A]=c.useState(()=>t("galleryRecursive","0")==="1"),[D,oe]=c.useState(0);c.useEffect(()=>{let W=!1;const F=new AbortController;return(async()=>{u(!0),m("");try{typeof performance<"u"&&performance.mark&&performance.mark("cozygen:gallery:fetch")}catch{}try{const se=await rm(r,x,h,b,z,p,D,{signal:F.signal,includeMeta:!0});if(W)return;se&&se.items?(i(se.items),S(se.total_pages||1),m("")):(i([]),S(1));try{typeof performance<"u"&&performance.measure&&(performance.mark("cozygen:gallery:ready"),performance.measure("cozygen:gallery:first-paint","cozygen:gallery:fetch","cozygen:gallery:ready"))}catch{}}catch(se){if((se==null?void 0:se.name)==="AbortError")return;console.error("Failed to load gallery",se),W||m("Unable to load gallery right now."),W||(i([]),S(1))}finally{!W&&!F.signal.aborted&&(u(!1),g(!0))}})(),n("galleryPath",r),n("galleryPageSize",String(h)),()=>{W=!0,F.abort()}},[r,x,h,D,b,z,p]);const q=c.useMemo(()=>{if(!r)return[];const W=r.replace(/\\/g,"/").split("/").filter(Boolean),F=[];for(let O=0;O<W.length;O++)F.push({name:W[O],path:W.slice(0,O+1).join("/")});return F},[r]),je=c.useMemo(()=>o.filter(W=>W.type==="directory").map(W=>({filename:W.filename,subfolder:W.subfolder})),[o]),ye=c.useMemo(()=>{const W=(_||"").trim().toLowerCase();return o.filter(F=>{const O=(F.filename||"").toLowerCase();return!(!b&&U0(O)||F.type!=="directory"&&(p==="image"&&!B0(O)||p==="video"&&!V0(O))||W&&!O.includes(W))})},[o,b,p,_]),ne=c.useMemo(()=>ye.filter(W=>W.type!=="directory"),[ye]),me=c.useCallback(()=>{if(!r)return;const W=r.replace(/\\/g,"/").lastIndexOf("/"),F=W===-1?"":r.slice(0,W);s(F),w(1)},[r]),R=c.useCallback(()=>{s(""),w(1)},[]),N=c.useCallback(W=>{s(W||""),w(1)},[]),E=c.useCallback(W=>{s(W),w(1)},[]),k=c.useCallback(W=>{const F=parseInt(String(W),10)||30;f(F),w(1)},[]),V=c.useCallback(W=>{v(W),w(1)},[]),G=c.useCallback(W=>{const F=!!W;A(F),w(1),n("galleryRecursive",F?"1":"0")},[]),te=c.useCallback(W=>{I(W),w(1)},[]),re=c.useCallback(()=>{oe(W=>W+1)},[]),X=c.useRef(null),ie=c.useCallback(()=>{X.current||(X.current=window.setTimeout(()=>{X.current=null,re()},400))},[re]);return c.useEffect(()=>{const W=()=>re();return typeof window<"u"&&window.addEventListener&&window.addEventListener("cozygen:queue-finished",W),()=>{typeof window<"u"&&window.removeEventListener&&window.removeEventListener("cozygen:queue-finished",W)}},[re]),c.useEffect(()=>{if(typeof window>"u"||!e)return;let W=!1,F,O,se=8e3;const ce=()=>{O&&(clearTimeout(O),O=null)},Re=(Ee=8e3)=>{ce(),O=window.setTimeout(()=>{W||(ie(),Re(se))},Ee)};return(()=>{if(!("EventSource"in window)){Re();return}const Ee=new URLSearchParams({subfolder:r||"",recursive:z?"1":"0",show_hidden:b?"1":"0"});F=new EventSource(`/cozygen/api/gallery/stream?${Ee.toString()}`),F.onmessage=()=>{W||ie()},F.onerror=()=>{F&&(F.close(),F=null),se=Math.min(Math.ceil(se*1.4),2e4),Re()}})(),()=>{W=!0,ce(),X.current&&(clearTimeout(X.current),X.current=null),F&&(F.close(),F=null)}},[r,z,b,ie,e]),c.useEffect(()=>{e&&re()},[e,re]),{path:r,items:o,loading:a,hasLoaded:d,error:y,page:x,totalPages:j,perPage:h,kind:p,showHidden:b,query:_,recursive:z,crumbs:q,dirChips:je,filtered:ye,mediaItems:ne,setPage:w,setPerPage:k,setShowHidden:C,setQuery:te,setKind:V,setRecursive:G,goBack:me,goRoot:R,goToPath:N,selectDir:E,refresh:re}}function H0(e){const[t,n]=c.useState(!1),[r,s]=c.useState(null);c.useEffect(()=>{if(!e||e.length===0){s(null),n(!1);return}s(x=>x==null?x:x>=e.length?e.length-1:x)},[e]);const o=c.useCallback(x=>{if(!e||!e.length||!x)return;const w=e.indexOf(x);w!==-1&&(s(w),n(!0))},[e]),i=c.useCallback(()=>{n(!1),s(null)},[]),a=c.useCallback(()=>{!e||!e.length||s(x=>x==null||x>=e.length-1?x:x+1)},[e]),u=c.useCallback(()=>{!e||!e.length||s(x=>x==null||x<=0?x:x-1)},[e]),d=r!=null&&r>=0&&e&&r<e.length?e[r]:null,g=(e==null?void 0:e.length)||0,y=r!==null&&r>0,m=r!==null&&r<g-1;return{viewerOpen:t,viewerIndex:r,currentMedia:d,total:g,canPrev:y,canNext:m,open:o,close:i,next:a,prev:u,setViewerOpen:n}}const Ef="cozygen_gallery_view_mode",Lf="cozygen_gallery_feed_autoplay";function G0(e,t){const n=c.useRef(null),[r,s]=c.useState(0),[o,i]=c.useState({width:0,cols:0,top:0,viewport:typeof window<"u"&&window.innerHeight||800}),a=m=>{if(!m||typeof window>"u")return null;let x=m.parentElement;for(;x;){const w=window.getComputedStyle(x);if(w.overflowY==="auto"||w.overflowY==="scroll")return x;x=x.parentElement}return window};c.useEffect(()=>{if(!t)return;const m=n.current;if(!m||typeof window>"u"||typeof ResizeObserver>"u")return;const x=a(m)||window,w=()=>{const f=m.getBoundingClientRect(),p=f.width||m.clientWidth||1,v=Math.max(1,Math.floor(p/160)),b=x===window?window.scrollY||0:x.scrollTop||0,C=x===window?{top:0}:x.getBoundingClientRect(),_=x===window?f.top+(window.scrollY||0):f.top-C.top+b,I=x===window?window.innerHeight||800:x.clientHeight||800;i(z=>z.width===p&&z.cols===v&&z.top===_&&z.viewport===I?z:{width:p,cols:v,top:_,viewport:I}),s(b)};w();const j=new ResizeObserver(()=>w());j.observe(m),window.addEventListener("resize",w);let S=!1;const h=()=>{S||(S=!0,window.requestAnimationFrame(()=>{S=!1;const f=x===window?window.scrollY||0:x.scrollTop||0;s(f)}))};return x.addEventListener("scroll",h,{passive:!0}),()=>{j.disconnect(),window.removeEventListener("resize",w),x.removeEventListener("scroll",h)}},[t]);const u=t&&o.cols>0&&e.length>60,{visibleItems:d,topSpacer:g,bottomSpacer:y}=c.useMemo(()=>{if(!u)return{visibleItems:e,topSpacer:0,bottomSpacer:0};const m=o.width/o.cols,x=Math.max(180,Math.ceil(m*1.25)+32),w=Math.ceil(e.length/o.cols),j=Math.max(0,r-o.top),S=Math.max(0,Math.floor(j/x)-2),h=Math.min(w,Math.ceil((j+o.viewport)/x)+2),f=S*o.cols,p=Math.min(e.length,h*o.cols);return{visibleItems:e.slice(f,p),topSpacer:S*x,bottomSpacer:Math.max(0,(w-h)*x)}},[e,o,r,u]);return{containerRef:n,visibleItems:d,topSpacer:g,bottomSpacer:y,virtualized:u}}function K0(){const{path:e,loading:t,hasLoaded:n,page:r,totalPages:s,perPage:o,kind:i,showHidden:a,recursive:u,error:d,crumbs:g,dirChips:y,filtered:m,mediaItems:x,setPage:w,setPerPage:j,setShowHidden:S,setKind:h,setRecursive:f,goBack:p,goRoot:v,goToPath:b,selectDir:C,refresh:_}=W0(),{viewerOpen:I,currentMedia:z,total:A,canPrev:D,canNext:oe,open:q,close:je,next:ye,prev:ne}=H0(x),[me,R]=c.useState(()=>{if(typeof window>"u")return"grid";const le=window.localStorage.getItem(Ef);return le==="feed"||le==="grid"?le:"grid"}),[N,E]=c.useState(()=>typeof window>"u"?!1:window.localStorage.getItem(Lf)==="true");c.useEffect(()=>{try{window.localStorage.setItem(Ef,me)}catch{}},[me]),c.useEffect(()=>{try{window.localStorage.setItem(Lf,N?"true":"false")}catch{}},[N]);const k=c.useCallback(le=>{if(le.type==="directory"){C(le.subfolder);return}q(le)},[q,C]),V=me==="grid",[G,te]=c.useState(!1),re=c.useMemo(()=>[{key:"all",label:"All"},{key:"image",label:"Images"},{key:"video",label:"Videos"}],[]),X=c.useMemo(()=>[{key:"grid",ariaLabel:"Grid view",icon:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("rect",{x:"1",y:"1",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"9",y:"1",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"1",y:"9",width:"6",height:"6",rx:"1"}),l.jsx("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1"})]})},{key:"feed",ariaLabel:"Feed view",icon:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("rect",{x:"2",y:"1",width:"12",height:"5",rx:"1"}),l.jsx("rect",{x:"2",y:"8",width:"12",height:"5",rx:"1"})]})}],[]),ie=le=>le.type==="directory"?`dir:${le.subfolder||le.filename}`:`${le.subfolder||""}|${le.filename}`;c.useEffect(()=>{try{window.localStorage.setItem("cozygen_gallery_pending","0")}catch{}window.dispatchEvent(new Event("cozygen:gallery-viewed"))},[]);const W=t&&!n,F=t&&n,O=`${m.length} items`,se=W?"Loading":O,ce=!!d,{containerRef:Re,visibleItems:Ne,topSpacer:Ee,bottomSpacer:Me,virtualized:Ke}=G0(m,V);return l.jsxs("div",{className:"page-shell gallery-shell",children:[l.jsx("div",{className:"screen-sticky gallery-header",children:l.jsxs("div",{className:"gallery-header-inner",children:[l.jsxs("div",{className:"page-bar gallery-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Gallery"}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx("span",{className:"gallery-status",children:se}),l.jsx(br,{ariaLabel:"View mode",value:me,onChange:R,layout:"icon",size:"sm",items:X}),l.jsx(Ft,{size:"xs",className:"gallery-filter-btn",onClick:()=>te(!0),children:"Filters"})]})]}),l.jsx("div",{className:"gallery-nav-row",children:l.jsx(L0,{subfolder:e,crumbs:g,dirChips:y,onBack:p,onRoot:v,onCrumb:le=>b(le),onSelectDir:le=>C(le)})}),l.jsxs("div",{className:"gallery-toolbar",children:[l.jsx("div",{className:"gallery-toolbar-left",children:l.jsx(br,{ariaLabel:"Filter by type",value:i,onChange:h,size:"sm",items:re})}),l.jsx("div",{className:"gallery-toolbar-right",children:l.jsxs("div",{className:"gallery-options",children:[l.jsx(Ft,{size:"icon",active:u,pressed:u,onClick:()=>f(le=>!le),title:u?"Showing subfolders":"This folder only","aria-label":"Toggle subfolders",children:u?l.jsx(Kd,{size:16}):l.jsx(Qd,{size:16})}),l.jsx(Ft,{size:"icon",active:a,pressed:a,onClick:()=>S(le=>!le),title:a?"Showing hidden":"Hiding hidden","aria-label":"Toggle hidden items",children:a?l.jsx(Yd,{size:16}):l.jsx(qd,{size:16})}),me==="feed"&&l.jsx(Ft,{size:"icon",active:N,pressed:N,onClick:()=>E(le=>!le),title:N?"Autoplay on":"Autoplay off","aria-label":"Toggle autoplay",children:N?l.jsx(Xd,{size:16}):l.jsx(Jd,{size:16})}),l.jsx(Ft,{size:"icon",onClick:_,title:"Refresh","aria-label":"Refresh gallery",children:l.jsx(Ja,{size:16})})]})})]}),l.jsxs("div",{className:"gallery-pagination",children:[l.jsxs("div",{className:"gallery-pagination-info",children:[F?l.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):null,l.jsx("span",{className:W?"gallery-loading-text":"",children:se})]}),l.jsxs("div",{className:"gallery-pagination-controls",children:[l.jsx("button",{type:"button",className:"gallery-page-btn",onClick:()=>w(le=>Math.max(1,le-1)),disabled:r<=1||t,"aria-label":"Previous page",children:l.jsx(pm,{size:16})}),l.jsxs("span",{className:"gallery-page-indicator",children:[r," / ",s]}),l.jsx("button",{type:"button",className:"gallery-page-btn",onClick:()=>w(le=>le<s?le+1:le),disabled:r>=s||t,"aria-label":"Next page",children:l.jsx(di,{size:16})}),l.jsx(Ze,{value:o,onChange:le=>j(parseInt(le,10)||30),className:"gallery-page-size","aria-label":"Items per page",size:"sm",options:[15,30,60,120]})]})]})]})}),W&&m.length===0?l.jsx("div",{className:"gallery-grid-responsive",children:Array.from({length:8}).map((le,fe)=>l.jsxs("div",{className:"gallery-skeleton-item",children:[l.jsx("div",{className:"gallery-skeleton-thumb skeleton"}),l.jsx("div",{className:"gallery-skeleton-label skeleton skeleton-text"})]},fe))}):ce&&m.length===0?l.jsxs("div",{className:"gallery-empty",role:"alert",children:[l.jsx("div",{className:"gallery-empty-icon",children:l.jsx(Zd,{size:48})}),l.jsx("div",{className:"gallery-empty-title",children:"Gallery unavailable"}),l.jsx("div",{className:"gallery-empty-desc",children:d}),l.jsx("button",{type:"button",className:"ui-button is-primary is-compact mt-4",onClick:_,children:"Retry"})]}):m.length===0?l.jsxs("div",{className:"gallery-empty",children:[l.jsx("div",{className:"gallery-empty-icon",children:l.jsx(Zd,{size:48})}),l.jsx("div",{className:"gallery-empty-title",children:"No media found"}),l.jsx("div",{className:"gallery-empty-desc",children:i!=="all"?`No ${i}s match your filters. Try selecting "All" or adjusting your search.`:"This folder is empty. Render something new or navigate to a different folder."})]}):V?l.jsx("div",{className:"w-full overflow-hidden",children:l.jsxs("div",{className:"gallery-grid-responsive",ref:Re,children:[Ke&&Ee>0?l.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${Ee}px`}}):null,Ne.map(le=>l.jsx(Nf,{item:le,onSelect:k,variant:"grid",autoPlay:!1},ie(le))),Ke&&Me>0?l.jsx("div",{"aria-hidden":!0,style:{gridColumn:"1 / -1",height:`${Me}px`}}):null]})}):l.jsx("div",{className:"flex flex-col gap-6 items-center",children:x.map(le=>l.jsx("div",{className:"w-full flex justify-center",children:l.jsx(Nf,{item:le,onSelect:k,variant:"feed",autoPlay:N})},ie(le)))}),l.jsx(D0,{isOpen:I,media:z,onClose:je,onPrev:ne,onNext:ye,total:A,canPrev:D,canNext:oe}),l.jsx(Lt,{open:G,onClose:()=>te(!1),title:"Gallery filters",footer:l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>te(!1),children:"Done"}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Type"}),l.jsx(br,{ariaLabel:"Filter by type",value:i,onChange:h,size:"sm",items:re})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Options"}),l.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[l.jsx("button",{type:"button",className:`ui-button is-compact ${u?"is-primary":"is-muted"}`,onClick:()=>f(le=>!le),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[u?l.jsx(Kd,{size:14}):l.jsx(Qd,{size:14}),l.jsx("span",{children:u?"Subfolders":"This folder"})]})}),l.jsx("button",{type:"button",className:`ui-button is-compact ${a?"is-primary":"is-muted"}`,onClick:()=>S(le=>!le),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[a?l.jsx(Yd,{size:14}):l.jsx(qd,{size:14}),l.jsx("span",{children:a?"Hidden on":"Hidden off"})]})}),me==="feed"?l.jsx("button",{type:"button",className:`ui-button is-compact ${N?"is-primary":"is-muted"}`,onClick:()=>E(le=>!le),children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[N?l.jsx(Xd,{size:14}):l.jsx(Jd,{size:14}),l.jsx("span",{children:N?"Autoplay":"No autoplay"})]})}):null,l.jsx("button",{type:"button",className:"ui-button is-compact is-ghost",onClick:_,children:l.jsxs("span",{className:"inline-flex items-center gap-1.5",children:[l.jsx(Ja,{size:14}),l.jsx("span",{children:"Refresh"})]})})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Page size"}),l.jsx(Ze,{value:o,onChange:le=>j(parseInt(le,10)||30),className:"sheet-select","aria-label":"Items per page",size:"sm",options:[15,30,60,120]}),l.jsxs("div",{className:"sheet-hint",children:[F?l.jsx("span",{className:"loading-spinner","aria-hidden":"true"}):null,l.jsxs("span",{children:[se,"  Page ",r," of ",s]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>w(le=>Math.max(1,le-1)),disabled:r<=1||t,children:"Prev"}),l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>w(le=>le<s?le+1:le),disabled:r>=s||t,children:"Next"})]})]})]})})]})}const Q0=()=>typeof window>"u"?800:window.innerHeight||800,Y0=e=>{if(!e||typeof window>"u")return null;let t=e.parentElement;for(;t;){const n=window.getComputedStyle(t);if(n.overflowY==="auto"||n.overflowY==="scroll")return t;t=t.parentElement}return window};function gu({itemCount:e,enabled:t=!0,estimateRowHeight:n=72,overscan:r=6,minItems:s=80}={}){const o=c.useRef(null),i=c.useRef(n),[a,u]=c.useState({top:0,scrollTop:0,viewport:Q0(),rowHeight:n});c.useEffect(()=>{if(!t)return;const j=o.current;if(!j||typeof window>"u"||typeof ResizeObserver>"u")return;const S=Y0(j)||window,h=()=>{const b=j.getBoundingClientRect(),C=S===window?window.scrollY||0:S.scrollTop||0,_=S===window?{top:0}:S.getBoundingClientRect(),I=S===window?b.top+(window.scrollY||0):b.top-_.top+C,z=S===window?window.innerHeight||800:S.clientHeight||800;u(A=>A.top===I&&A.scrollTop===C&&A.viewport===z&&A.rowHeight===i.current?A:{top:I,scrollTop:C,viewport:z,rowHeight:i.current})};h();const f=new ResizeObserver(()=>h());f.observe(j),window.addEventListener("resize",h);let p=!1;const v=()=>{p||(p=!0,window.requestAnimationFrame(()=>{p=!1;const b=S===window?window.scrollY||0:S.scrollTop||0;u(C=>C.scrollTop===b&&C.rowHeight===i.current?C:{...C,scrollTop:b,rowHeight:i.current})}))};return S.addEventListener("scroll",v,{passive:!0}),()=>{f.disconnect(),window.removeEventListener("resize",h),S.removeEventListener("scroll",v)}},[t]),c.useEffect(()=>{if(!t||typeof window>"u")return;let j=0;const S=()=>{const h=o.current;if(!h)return;const f=h.querySelector('[data-virtual-row="true"]');if(!f)return;const p=f.getBoundingClientRect(),v=Math.max(24,Math.round(p.height||0));v&&Math.abs(v-i.current)>2&&(i.current=v,u(b=>({...b,rowHeight:v})))};return j=window.requestAnimationFrame(S),()=>{j&&window.cancelAnimationFrame(j)}},[t,e,a.scrollTop]);const d=!!(t&&e>s),{startIndex:g,endIndex:y,topSpacer:m,bottomSpacer:x}=c.useMemo(()=>{if(!d)return{startIndex:0,endIndex:e,topSpacer:0,bottomSpacer:0};const j=a.rowHeight||n,S=Math.max(0,a.scrollTop-a.top),h=Math.max(0,Math.floor(S/j)-r),f=Math.min(e,Math.ceil((S+a.viewport)/j)+r);return{startIndex:h,endIndex:f,topSpacer:h*j,bottomSpacer:Math.max(0,(e-f)*j)}},[e,a,r,n,d]),w=y>=e-Math.max(6,r*2);return{containerRef:o,startIndex:g,endIndex:y,topSpacer:m,bottomSpacer:x,virtualized:d,isNearEnd:w}}const Vo="::",q0={contentVisibility:"auto",containIntrinsicSize:"240px 120px"},X0=c.memo(function({id:t,name:n,category:r,text:s,isSelected:o,onOpen:i}){const a=c.useCallback(()=>{i(t)},[t,i]),u=Oo({name:n})||n||"Untitled",d=r?`${r}:${n}`:n,g=`${(s||"").slice(0,140)}${(s||"").length>140?"":""}`;return l.jsxs("button",{type:"button",role:"listitem",className:`composer-alias-item ${o?"is-selected":""}`,onClick:a,style:q0,"data-virtual-row":"true",children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:u}),r?l.jsx("span",{className:"composer-alias-category",children:In(r)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",d||"alias","$"]}),l.jsx("div",{className:"composer-alias-text",children:g||""})]})});function J0(){return`alias-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,6)}`}function Ln(e){return String(e||"").split(",").map(t=>t.trim()).filter(Boolean)}function gi(e){return(e||[]).map(t=>String(t||"").trim()).filter(Boolean).join(", ")}function Z0(e,t){const n=String(t||"").trim();if(!n)return String(e||"");const r=Ln(e);return new Set(r.map(o=>o.toLowerCase())).has(n.toLowerCase())||r.push(n),gi(r)}function e1(e,t){const n=String(t||"").trim().toLowerCase();if(!n)return String(e||"");const r=Ln(e).filter(s=>s.toLowerCase()!==n);return gi(r)}function t1(e,t,n){const r=String(t||"").trim().toLowerCase(),s=String(n||"").trim();if(!r||!s)return String(e||"");const o=Ln(e).map(u=>u.toLowerCase()===r?s:u),i=new Set,a=[];return o.forEach(u=>{const d=String(u||"").trim().toLowerCase();!d||i.has(d)||(i.add(d),a.push(u))}),gi(a)}function qi(e,t={}){return Object.entries(Ws(e)).map(([n,r],s)=>{const[o,i]=String(n).includes(Vo)?n.split(Vo):["",n],a=i||n,u=t[n]||t[a]||o||"";return{id:`existing-${s}-${n}`,name:a,text:r,category:u}})}function Pf(e){const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.text)=="string"?n.text.trim():"";if(r&&s){const o=String((n==null?void 0:n.category)||"").trim(),i=o?`${o}${Vo}${r}`:r;t[i]=s}}),t}function _f(e){const t={};return e.forEach(n=>{const r=String((n==null?void 0:n.name)||"").trim(),s=typeof(n==null?void 0:n.category)=="string"?n.category.trim():"";if(r){const o=s?`${s}${Vo}${r}`:r;t[o]=s}}),t}function n1(){var de;const e=jn(),{aliases:t,aliasCategories:n,categoryList:r,loading:s,saving:o,error:i,persistAliases:a}=Pm(),[u,d]=c.useState(()=>qi(t,n)),[g,y]=c.useState(()=>Array.isArray(r)?r:[]),[m,x]=c.useState("All"),[w,j]=c.useState("All"),[S,h]=c.useState(""),f=c.useDeferredValue(S),[p,v]=c.useState(""),[b,C]=c.useState(!1),[_,I]=c.useState(!1),[z,A]=c.useState({loading:!1,invalid:[],suggestions:{}}),[D,oe]=c.useState(!1),[q,je]=c.useState(null),[ye,ne]=c.useState(""),me=c.useRef(null),R=c.useRef(null),[N,E]=c.useState(!1),[k,V]=c.useState(""),[G,te]=c.useState(""),re=ui("(min-width: 1024px)");c.useEffect(()=>{if(N)return;const P=qi(t,n||{});d(P),p&&!P.some($=>$.id===p)&&(v(""),C(!1))},[n,N]),c.useEffect(()=>{N||Array.isArray(r)&&y(r)},[r,N]),c.useEffect(()=>{if(N)return;const P=qi(t,n||{});d(P),p&&!P.some($=>$.id===p)&&(v(""),C(!1))},[t,n,p,N]);const X=c.useMemo(()=>Pf(u),[u]),ie=()=>{const P={id:J0(),name:"",text:"",category:""};d($=>[...$,P]),v(P.id),ne(""),E(!0),C(!0)},W=(P,$,H)=>{E(!0),d(K=>K.map((be,Se)=>Se===P?{...be,[$]:H}:be))},F=P=>{E(!0),d($=>{var K;const H=$.filter((be,Se)=>Se!==P);return(H.length===0||p===((K=$[P])==null?void 0:K.id))&&(v(""),C(!1)),H})},O=async()=>{ne("");try{const P=new Map;if(u.forEach(H=>{Ln((H==null?void 0:H.text)||"").forEach(be=>{const Se=String(be).toLowerCase();Se&&(P.has(Se)||P.set(Se,{tag:be,rows:[]}),P.get(Se).rows.push(H.id))})}),P.size){const H=Array.from(P.values()).map(K=>K.tag);try{const K=await Wi(H),be=Array.isArray(K==null?void 0:K.invalid)?K.invalid:[],Se=new Set(be.map(qe=>String(qe).toLowerCase()));if(Se.size){const qe=u.map(Te=>{const Nn=Ln((Te==null?void 0:Te.text)||"").filter(Bn=>Se.has(String(Bn).toLowerCase()));if(!Nn.length)return null;const kn=Te.category?`${Te.category}:${Te.name}`:Te.name;return{id:Te.id,token:kn,friendlyName:Oo({name:Te.name})||Te.name||"Untitled",category:Te.category||"",invalid:Nn}}).filter(Boolean);je({invalid:be,invalidLower:Array.from(Se),rows:qe,suggestions:(K==null?void 0:K.suggestions)||{}}),oe(!0),ne("Fix invalid tags before saving.");return}}catch(K){console.error("Unable to validate tags",K),ne("Unable to validate tags right now.");return}}const $=_f(u);await a({items:X,categories:$,categoryList:g}),E(!1),ne("Saved.")}catch{ne("Unable to save right now.")}},se=c.useMemo(()=>{const P=f.trim().toLowerCase(),H=[...u.filter(K=>{const be=(K.category||"").trim();if(m===""&&be||m!=="All"&&m!==""&&be!==m)return!1;const Se=Is(K.name||"",K.category||"");if(w!=="All"&&Se!==w)return!1;if(!P)return!0;const qe=be?`${be}:${K.name}`:K.name;return(K.name||"").toLowerCase().includes(P)||(K.text||"").toLowerCase().includes(P)||(be||"").toLowerCase().includes(P)||(qe||"").toLowerCase().includes(P)})];return H.sort((K,be)=>(K.name||"").localeCompare(be.name||"")),H},[u,m,w,f]),{containerRef:ce,startIndex:Re,endIndex:Ne,topSpacer:Ee,bottomSpacer:Me,virtualized:Ke}=gu({itemCount:se.length,enabled:!0,estimateRowHeight:86,overscan:8,minItems:120}),le=Ke?se.slice(Re,Ne):se,fe=se.find(P=>P.id===p)||u.find(P=>P.id===p)||null,Pe=fe?fe.category?`${fe.category}:${fe.name}`:fe.name||"alias":"",We=fe&&(Oo({name:fe.name})||fe.name)||"Alias",Q=Pe?`$${Pe}$`:"$alias$",ue=se.length?se:u,ve=fe?ue.findIndex(P=>P.id===fe.id):-1,ge=ve>0?ue[ve-1]:null,ke=ve>=0&&ve<ue.length-1?ue[ve+1]:null,Le=P=>{P&&(v(P.id),C(!0),ne(""))},Fe=c.useMemo(()=>{const P=new Set(g||[]);return u.forEach($=>{$.category&&P.add($.category)}),Array.from(P).sort(($,H)=>$.localeCompare(H))},[u,g]),He=c.useMemo(()=>{const P=new Set;return u.forEach($=>{const H=($.category||"").trim();if(m===""&&H||m!=="All"&&m!==""&&H!==m)return;const K=Is($.name||"",$.category||"");K&&P.add(K)}),Array.from(P).sort(($,H)=>$.localeCompare(H))},[u,m]);c.useEffect(()=>{w!=="All"&&(He.includes(w)||j("All"))},[He,w]),c.useEffect(()=>{te("")},[p]);const it=c.useMemo(()=>Ln((fe==null?void 0:fe.text)||""),[fe==null?void 0:fe.text]),ht=c.useMemo(()=>{const P=Array.isArray(z==null?void 0:z.invalid)?z.invalid:[];return new Set(P.map($=>String($).toLowerCase()))},[z]);c.useEffect(()=>{if(!fe||!(b||re))return;const P=it,$=[],H=new Set;if(P.forEach(Se=>{const qe=String(Se).toLowerCase();!qe||H.has(qe)||(H.add(qe),$.push(Se))}),!$.length){A({loading:!1,invalid:[],suggestions:{}});return}let K=!1;const be=window.setTimeout(async()=>{A(Se=>({...Se,loading:!0}));try{const Se=await Wi($);if(K)return;A({loading:!1,invalid:Array.isArray(Se==null?void 0:Se.invalid)?Se.invalid:[],suggestions:(Se==null?void 0:Se.suggestions)||{}})}catch(Se){console.error("Failed to validate tags",Se),K||A({loading:!1,invalid:[],suggestions:{}})}},260);return()=>{K=!0,window.clearTimeout(be)}},[b,re,fe,it]);const mt=P=>{var H,K;const $=String(P||"");if(!$)return!1;try{return(K=(H=navigator.clipboard)==null?void 0:H.writeText)==null||K.call(H,$),!0}catch{return!1}},ut=(P="")=>{const $=P?`?q=${encodeURIComponent(P)}`:"";e(`/tags${$}`)},M=()=>{var K;if(!fe)return;const P=Ln(G);if(!P.length){ne("Enter a tag to add.");return}const $=u.findIndex(be=>be.id===fe.id);if($===-1)return;let H=((K=u[$])==null?void 0:K.text)||"";P.forEach(be=>{H=Z0(H,be)}),W($,"text",H),te(""),ne(`Added ${P.length} tag${P.length===1?"":"s"}.`)},Z=async()=>{const P=k.trim();if(!P){ne("Enter a category name.");return}const $=Array.from(new Set([...g||[],P]));y($),V(""),ne("Category added.");const H=Pf(u),K=_f(u);E(!0);try{await a({items:H,categories:K,categoryList:$}),E(!1),ne("Category saved.")}catch{ne("Unable to save right now.")}},xe=c.useCallback(P=>{P&&(v(P.id),C(!0),ne(""))},[]),Ie=c.useMemo(()=>{const P=new Map;return u.forEach($=>{$!=null&&$.id&&P.set($.id,$)}),P},[u]),U=c.useCallback(P=>{const $=Ie.get(P);$&&xe($)},[xe,Ie]),Y=()=>{re&&v(""),C(!1),ne("")};c.useMemo(()=>{const P=u.length,$=se.length;return s&&P===0?"Loading":P===$?`${P} aliases`:`${$} of ${P} aliases`},[u.length,se.length,s]),c.useEffect(()=>{const P=$=>{var Te,nt;if($.defaultPrevented)return;const H=$.target,K=(H==null?void 0:H.tagName)||"",be=["INPUT","TEXTAREA","SELECT"].includes(K)||(H==null?void 0:H.isContentEditable),Se=String($.key||"").toLowerCase(),qe=$.metaKey||$.ctrlKey;if(qe&&Se==="s"){$.preventDefault(),N&&!o&&O();return}if(qe&&Se==="n"){$.preventDefault(),ie();return}if(!be&&Se==="/"){$.preventDefault(),(nt=(Te=R.current)==null?void 0:Te.focus)==null||nt.call(Te);return}Se==="escape"&&b&&!re&&($.preventDefault(),Y())};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[ie,Y,N,b,O,re,o]);const ae=l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:Y,children:re?"Clear selection":"Close"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:O,disabled:o||!N,children:o?"Saving":N?"Save":"Saved"})]}),we=fe?l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"alias-editor-toolbar",children:[l.jsxs("div",{className:"alias-editor-heading",children:[l.jsx("div",{className:"alias-editor-title",children:We}),l.jsx("div",{className:"alias-editor-meta",children:Q})]}),l.jsxs("div",{className:"alias-editor-actions",children:[l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>Le(ge),disabled:!ge,title:"Previous alias",children:"Prev"}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>Le(ke),disabled:!ke,title:"Next alias",children:"Next"}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>{Pe&&mt(Q)?ne("Token copied."):ne("Copy not available on this browser.")},title:"Copy token",children:"Copy token"})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Token"}),l.jsx("div",{className:"composer-token",children:Q}),Is(fe.name||"",fe.category||"")?l.jsxs("div",{className:"sheet-hint",children:["Subcategory: ",dr(Is(fe.name||"",fe.category||""))]}):null]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Friendly name"}),l.jsx("div",{className:"composer-field",children:We})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Alias name"}),l.jsx("input",{ref:me,type:"text",value:fe.name||"",onChange:P=>{const $=u.findIndex(H=>H.id===fe.id);$!==-1&&W($,"name",P.target.value)},placeholder:"e.g. cherry_fruit",className:"sheet-input ui-control ui-input"})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Category"}),l.jsx(Ze,{value:fe.category||"",onChange:P=>{const $=u.findIndex(H=>H.id===fe.id);$!==-1&&W($,"category",P)},className:"sheet-select",size:"sm",options:[{value:"",label:"Uncategorized"},...Fe.filter(Boolean).map(P=>({value:P,label:In(P)}))]}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>I(!0),children:"Manage categories"})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Expands to"}),l.jsx("textarea",{value:fe.text,onChange:P=>{const $=u.findIndex(H=>H.id===fe.id);$!==-1&&W($,"text",P.target.value)},placeholder:"Prompt text for this alias",className:"sheet-textarea ui-control ui-textarea is-compact",rows:6}),l.jsxs("div",{className:"tag-quick-add",children:[l.jsx("input",{type:"text",value:G,onChange:P=>te(P.target.value),onKeyDown:P=>{P.key==="Enter"&&(P.preventDefault(),M())},placeholder:"Add tags (comma separated)",className:"ui-control ui-input tag-quick-input","aria-label":"Add tags"}),l.jsx("button",{type:"button",className:"ui-button is-compact is-primary",onClick:M,disabled:!G.trim(),children:"Add"})]}),l.jsxs("div",{className:"tag-editor-actions",children:[l.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>ut(""),children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(cr,{size:14}),"Open tag library"]})}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:()=>{A($=>({...$,loading:!0}));const P=Ln(fe.text||"");Wi(P).then($=>{A({loading:!1,invalid:Array.isArray($==null?void 0:$.invalid)?$.invalid:[],suggestions:($==null?void 0:$.suggestions)||{}})}).catch(()=>A({loading:!1,invalid:[],suggestions:{}}))},disabled:z.loading,title:"Validate against danbooru_tags.md",children:z.loading?"Validating":"Validate"})]}),it.length?l.jsx("div",{className:"tag-chip-list","aria-label":"Alias tags",children:it.map(P=>{const $=ht.has(String(P).toLowerCase());return l.jsxs("span",{className:`tag-chip ${$?"is-invalid":""}`,children:[l.jsx("code",{className:"tag-chip-code",children:P}),l.jsx("button",{type:"button",className:"tag-chip-remove",onClick:()=>{const H=u.findIndex(K=>K.id===fe.id);H!==-1&&W(H,"text",e1(fe.text||"",P))},"aria-label":`Remove ${P}`,title:"Remove",children:l.jsx(ur,{size:12})})]},P)})}):l.jsx("div",{className:"sheet-hint",children:"Tip: Use the Tag library to add validated tags quickly."}),!z.loading&&Array.isArray(z.invalid)&&z.invalid.length?l.jsxs("div",{className:"tag-invalid-panel",role:"alert",children:[l.jsxs("div",{className:"tag-invalid-title",children:["Invalid tags (",z.invalid.length,")"]}),l.jsx("div",{className:"tag-invalid-body",children:z.invalid.map(P=>{var H;const $=((H=z==null?void 0:z.suggestions)==null?void 0:H[P])||[];return l.jsxs("div",{className:"tag-invalid-row",children:[l.jsxs("div",{className:"tag-invalid-tag",children:[l.jsx("code",{children:P}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-ghost",onClick:()=>ut(P),children:"Find"})]}),Array.isArray($)&&$.length?l.jsx("div",{className:"tag-invalid-suggestions",children:$.slice(0,6).map(K=>l.jsx("button",{type:"button",className:"tag-suggestion",onClick:()=>{const be=u.findIndex(Se=>Se.id===fe.id);be!==-1&&W(be,"text",t1(fe.text||"",P,K))},title:`Replace ${P} with ${K}`,children:K},`${P}-${K}`))}):l.jsx("div",{className:"sheet-hint",children:"No suggestions found for this tag."})]},P)})})]}):null]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("button",{type:"button",className:"ui-button is-danger",onClick:()=>{const P=u.findIndex($=>$.id===fe.id);P!==-1&&(F(P),C(!1))},children:"Delete alias"}),l.jsx("div",{className:"sheet-hint",children:"Deleting removes it from your library. Use Save changes to persist."})]})]}):l.jsx("div",{className:"alias-editor-empty",children:"Select an alias to edit, or create a new one."});return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"page-shell page-stack alias-page",children:[l.jsxs("div",{className:"page-bar",children:[l.jsx("h1",{className:"page-bar-title",children:"Aliases"}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx(Ft,{size:"xs",onClick:()=>openTagLibrary({query:S||"",targetId:""}),title:"Browse danbooru tags",children:"Tags"}),l.jsx(Ft,{size:"xs",variant:"primary",onClick:ie,children:"Add"})]})]}),l.jsx("div",{className:"library-toolbar screen-sticky",children:l.jsxs("div",{className:"library-toolbar-inner",children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:R,type:"search",value:S,onChange:P=>h(P.target.value),className:"composer-search ui-control ui-input",placeholder:"Search aliases","aria-label":"Search aliases"}),l.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>h(""),disabled:!S,children:"Clear"})]}),l.jsx(Ze,{className:"composer-subcategory-select",value:m,onChange:x,"aria-label":"Filter by category",size:"sm",options:[{value:"All",label:"Category: All"},{value:"",label:"Uncategorized"},...Fe.filter(Boolean).map(P=>({value:P,label:In(P)}))]}),l.jsx(Ze,{className:"composer-subcategory-select",value:w,onChange:j,"aria-label":"Filter by subcategory",size:"sm",options:[{value:"All",label:"Subcategory: All"},...He.map(P=>({value:P,label:dr(P)}))]}),N?l.jsx("button",{type:"button",className:"ui-button is-compact is-primary",onClick:O,disabled:o,children:o?"Saving":"Save changes"}):null]}),i?l.jsx("div",{className:"library-toolbar-status is-error",children:"Could not load aliases. Try again later."}):null,ye?l.jsx("div",{className:"library-toolbar-status",children:ye}):null]})}),l.jsxs("div",{className:"alias-layout",children:[l.jsx("div",{className:"alias-list",children:u.length===0&&!s?l.jsx("section",{className:"ui-panel text-center py-16",children:l.jsx("p",{className:"text-base text-[rgba(159,178,215,0.8)]",children:"No aliases yet. Add your first one."})}):l.jsxs("div",{className:"composer-alias-list",role:"list",ref:ce,children:[se.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases match your filters."}):null,Ke&&Ee>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${Ee}px`}}):null,le.map(P=>l.jsx(X0,{id:P.id,name:P.name,category:(P.category||"").trim(),text:P.text||"",isSelected:p===P.id,onOpen:U},P.id)),Ke&&Me>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${Me}px`}}):null]})}),l.jsx("aside",{className:"alias-editor-panel",children:l.jsxs("div",{className:"alias-editor-card ui-panel",children:[we,fe?l.jsx("div",{className:"alias-editor-footer",children:ae}):null]})})]})]}),l.jsx(Lt,{open:b&&!!fe&&!re,onClose:Y,title:"Alias",variant:"fullscreen",footer:ae,children:we}),l.jsx(Lt,{open:_,onClose:()=>{I(!1),V(""),ne("")},title:"Categories",variant:"sheet",footer:l.jsx("div",{className:"sheet-hint",children:"Categories help you organize aliases and improve the Insert alias picker."}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Add category"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:k,onChange:P=>V(P.target.value),placeholder:"e.g. styles",className:"sheet-input ui-control ui-input"}),l.jsx("button",{type:"button",className:"ui-button is-primary is-compact",onClick:Z,children:"Add"})]})]}),l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Existing"}),Fe.length===0?l.jsx("div",{className:"sheet-hint",children:"No categories yet."}):l.jsx(Ze,{className:"sheet-select",value:"",onChange:P=>{P&&(x(P),I(!1))},size:"sm",placeholder:"Select a category",options:Fe.filter(Boolean).map(P=>({value:P,label:In(P)}))})]})]})}),l.jsx(Lt,{open:D,onClose:()=>oe(!1),title:"Fix invalid tags",variant:"fullscreen",footer:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>oe(!1),children:"Close"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:()=>{const P=new Set(((q==null?void 0:q.invalidLower)||[]).map($=>String($).toLowerCase()));if(!P.size){oe(!1);return}d($=>$.map(H=>{const be=Ln((H==null?void 0:H.text)||"").filter(qe=>!P.has(String(qe).toLowerCase())),Se=gi(be);return Se===((H==null?void 0:H.text)||"")?H:{...H,text:Se}})),E(!0),oe(!1),ne("Removed invalid tags. Review and save again.")},children:"Remove invalid tags"})]}),children:l.jsxs("div",{className:"sheet-stack",children:[l.jsx("div",{className:"sheet-section",children:l.jsxs("div",{className:"sheet-hint",children:["These aliases contain tags not found in ",l.jsx("code",{className:"font-mono",children:"danbooru_tags.md"}),". Fix them before saving."]})}),(de=q==null?void 0:q.rows)!=null&&de.length?l.jsxs("div",{className:"sheet-section",children:[l.jsx("div",{className:"sheet-label",children:"Aliases with issues"}),l.jsx("div",{className:"composer-alias-list",role:"list",children:q.rows.map(P=>l.jsxs("button",{type:"button",role:"listitem",className:"composer-alias-item",onClick:()=>{v(P.id),C(!0),oe(!1)},children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:P.friendlyName}),P.category?l.jsx("span",{className:"composer-alias-category",children:In(P.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",P.token,"$"]}),l.jsx("div",{className:"tag-invalid-inline",children:P.invalid.map($=>l.jsx("span",{className:"tag-chip is-invalid",children:l.jsx("code",{className:"tag-chip-code",children:$})},`${P.id}-${$}`))})]},P.id))})]}):null]})})]})}const r1={contentVisibility:"auto",containIntrinsicSize:"240px 120px"},s1=c.memo(function({tag:t,category:n,count:r,isCollected:s,onSelectTag:o,addToCollection:i,removeFromCollection:a,setStatus:u}){const d=c.useCallback(()=>{const g=String(t||"");if(o){o(g),u(`Added: ${g}`);return}s?(a(g),u(`Removed: ${g}`)):(i(g),u(`Added: ${g}`))},[i,s,o,a,u,t]);return l.jsx("div",{className:"tag-library-row",role:"listitem",style:r1,"data-virtual-row":"true",children:l.jsxs("button",{type:"button",className:`composer-alias-item tag-library-item ${!o&&s?"is-collected":""}`,onClick:d,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name tag-library-name",children:l.jsx("code",{className:"tag-library-code",children:t})}),n?l.jsx("span",{className:"composer-alias-category",children:dr(n)}):null]}),l.jsx("div",{className:"composer-alias-token",children:Number(r||0).toLocaleString()})]})})});function l1(e){var n,r;const t=String(e||"");if(!t)return!1;try{return(r=(n=navigator.clipboard)==null?void 0:n.writeText)==null||r.call(n,t),!0}catch{return!1}}function o1({open:e,onClose:t,onSelectTag:n,initialQuery:r="",title:s="Tag library",contextTitle:o="",contextToken:i="",contextText:a="",contextTagCount:u=null,inline:d=!1}){const[g,y]=c.useState(r||""),[m,x]=c.useState(""),[w,j]=c.useState("count"),[S,h]=c.useState([]),[f,p]=c.useState([]),[v,b]=c.useState(0),[C,_]=c.useState(0),[I,z]=c.useState(!1),[A,D]=c.useState(!1),[oe,q]=c.useState(""),[je,ye]=c.useState(""),ne=c.useRef(null),me=c.useRef(null),R=c.useRef(new Map),N=c.useRef(new Map),[E,k]=c.useState([]),[V,G]=c.useState(!1),[te,re]=c.useState(null),[X,ie]=c.useState(null),W=c.useRef(null),F=c.useRef(null),O=c.useRef(null),se=c.useRef(null),ce=c.useRef(null),Re=f.length<v,Ne=d||e,{containerRef:Ee,startIndex:Me,endIndex:Ke,topSpacer:le,bottomSpacer:fe,virtualized:Pe,isNearEnd:We}=gu({itemCount:f.length,enabled:Ne,estimateRowHeight:74,overscan:8,minItems:90}),Q=Pe?f.slice(Me,Ke):f,ue=c.useMemo(()=>E.join(", "),[E]),ve=c.useMemo(()=>new Set(E.map(U=>U.toLowerCase())),[E]),ge=c.useCallback((U,Y,ae,we,de)=>[U||"",Y||"",ae||"",String(we||0),String(de||0)].join("::"),[]),ke=c.useCallback(()=>{const U=R.current;if(U.size<=50)return;const Y=Array.from(U.entries());Y.sort((ae,we)=>{var de,P;return(((de=ae[1])==null?void 0:de.ts)||0)-(((P=we[1])==null?void 0:P.ts)||0)}),Y.slice(0,Math.max(0,Y.length-50)).forEach(([ae])=>U.delete(ae))},[]),Le=c.useCallback(U=>{const Y=String(U||"").trim();Y&&k(ae=>new Set(ae.map(de=>de.toLowerCase())).has(Y.toLowerCase())?ae:[...ae,Y])},[]),Fe=c.useCallback(U=>{const Y=String(U||"").trim().toLowerCase();Y&&k(ae=>ae.filter(we=>we.toLowerCase()!==Y))},[]),He=c.useCallback(()=>{k([]),ye("Cleared collected tags.")},[]),it=c.useCallback(()=>{var Y,ae;if(!E.length){ye("No tags to copy.");return}if(l1(ue)){ye(`Copied ${E.length} tag${E.length===1?"":"s"}.`);return}const U=O.current;if(U)try{U.value=ue,U.removeAttribute("readonly"),U.select(),U.setSelectionRange(0,ue.length);const we=document.execCommand&&document.execCommand("copy");if(U.setAttribute("readonly","readonly"),(ae=(Y=window.getSelection())==null?void 0:Y.removeAllRanges)==null||ae.call(Y),we){ye(`Copied ${E.length} tag${E.length===1?"":"s"}.`);return}}catch{}ye("Copy not available on this browser.")},[E,ue]),ht=c.useCallback((U,Y)=>{k(ae=>{const we=[...ae],[de]=we.splice(U,1);return we.splice(Y,0,de),we})},[]);c.useCallback((U,Y)=>{re(Y),se.current=U.target,U.dataTransfer.effectAllowed="move",U.dataTransfer.setData("text/plain",Y.toString()),requestAnimationFrame(()=>{se.current&&se.current.classList.add("is-dragging")})},[]),c.useCallback(()=>{se.current&&se.current.classList.remove("is-dragging"),te!==null&&X!==null&&te!==X&&ht(te,X),re(null),ie(null),se.current=null},[te,X,ht]),c.useCallback((U,Y)=>{U.preventDefault(),U.dataTransfer.dropEffect="move",ie(Y)},[]),c.useCallback(()=>{},[]),c.useCallback((U,Y)=>{const ae=U.touches[0];ce.current={idx:Y,startX:ae.clientX,startY:ae.clientY,moved:!1}},[]),c.useCallback(U=>{if(!ce.current)return;const Y=U.touches[0],ae=Math.abs(Y.clientX-ce.current.startX),we=Math.abs(Y.clientY-ce.current.startY);if(ae>10||we>10){ce.current.moved=!0,re(ce.current.idx),U.preventDefault();const de=document.querySelectorAll(".collected-tag-chip"),P=Y.clientX,$=Y.clientY;for(let H=0;H<de.length;H++){const K=de[H].getBoundingClientRect();if(P>=K.left&&P<=K.right&&$>=K.top&&$<=K.bottom){ie(H);break}}}},[]),c.useCallback(()=>{var U;(U=ce.current)!=null&&U.moved&&te!==null&&X!==null&&te!==X&&ht(te,X),ce.current=null,re(null),ie(null)},[te,X,ht]);const mt=c.useCallback(async({nextQuery:U,nextCategory:Y,nextSort:ae}={})=>{var qe;const we=typeof U=="string"?U:g,de=typeof Y=="string"?Y:m,P=typeof ae=="string"?ae:w,$=ge(we,de,P,80,0),H=Date.now(),K=R.current.get($);if(K&&H-K.ts<5*60*1e3){p(K.items||[]),b(Number(K.total||0)),_(0),q(""),ye(""),z(!1);return}const be=N.current.get($);if(be){try{const Te=await be;p((Te==null?void 0:Te.items)||[]),b(Number((Te==null?void 0:Te.total)||0)),_(0),q(""),ye("")}catch{}return}z(!0),q(""),ye(""),_(0),ne.current&&ne.current.key!==$&&ne.current.controller.abort();const Se=new AbortController;ne.current={controller:Se,key:$};try{const Te=Mo({q:we,category:de,sort:P,limit:80,offset:0},{signal:Se.signal});N.current.set($,Te);const nt=await Te;R.current.set($,{items:(nt==null?void 0:nt.items)||[],total:Number((nt==null?void 0:nt.total)||0),ts:Date.now()}),ke(),p((nt==null?void 0:nt.items)||[]),b(Number((nt==null?void 0:nt.total)||0))}catch(Te){if((Te==null?void 0:Te.name)==="AbortError")return;console.error("Failed to search tags",Te),q("Unable to load tags right now."),p([]),b(0)}finally{N.current.delete($),((qe=ne.current)==null?void 0:qe.key)===$&&(ne.current=null),z(!1)}},[ge,m,g,w,ke]),ut=c.useCallback(async()=>{var $;if(I||A||!Re)return;const U=C+80,Y=ge(g,m,w,80,U),ae=Date.now(),we=R.current.get(Y);if(we&&ae-we.ts<5*60*1e3){p(H=>[...H,...we.items||[]]),b(Number(we.total||0)),_(U),D(!1);return}const de=N.current.get(Y);if(de){try{const H=await de,K=(H==null?void 0:H.items)||[];p(be=>[...be,...K]),b(Number((H==null?void 0:H.total)||0)),_(U)}catch{}return}D(!0),q(""),me.current&&me.current.key!==Y&&me.current.controller.abort();const P=new AbortController;me.current={controller:P,key:Y};try{const H=Mo({q:g,category:m,sort:w,limit:80,offset:U},{signal:P.signal});N.current.set(Y,H);const K=await H,be=(K==null?void 0:K.items)||[];R.current.set(Y,{items:be,total:Number((K==null?void 0:K.total)||0),ts:Date.now()}),ke(),p(Se=>[...Se,...be]),b(Number((K==null?void 0:K.total)||0)),_(U)}catch(H){if((H==null?void 0:H.name)==="AbortError")return;console.error("Failed to load more tags",H),q("Unable to load more tags.")}finally{N.current.delete(Y),(($=me.current)==null?void 0:$.key)===Y&&(me.current=null),D(!1)}},[ge,Re,m,I,A,C,g,w,ke]);c.useEffect(()=>{if(!Ne)return;q(""),ye("");let U=!1;return(async()=>{try{const Y=await sm();if(U)return;h(Array.isArray(Y==null?void 0:Y.categories)?Y.categories:[])}catch(Y){console.error("Failed to load tag categories",Y),U||h([])}})(),()=>{U=!0}},[Ne]),c.useEffect(()=>{Ne&&(y(r||""),x(""),j("count"),p([]),b(0),_(0),z(!1),D(!1),q(""),ye(""),k([]))},[r,Ne]),c.useEffect(()=>{if(!Ne)return;const U=window.setTimeout(()=>{mt()},220);return()=>window.clearTimeout(U)},[m,Ne,g,mt,w]),c.useEffect(()=>()=>{var U,Y,ae,we;ne.current&&((Y=(U=ne.current.controller)==null?void 0:U.abort)==null||Y.call(U)),me.current&&((we=(ae=me.current.controller)==null?void 0:ae.abort)==null||we.call(ae))},[]),c.useEffect(()=>{if(!Ne||Pe)return;const U=W.current;if(!U||typeof IntersectionObserver>"u")return;const Y=new IntersectionObserver(ae=>{const we=ae[0];we!=null&&we.isIntersecting&&ut()},{threshold:.1});return Y.observe(U),()=>Y.disconnect()},[Ne,ut]),c.useEffect(()=>{Pe&&(!Re||I||A||We&&ut())},[Pe,Re,I,A,We,ut]);const M=c.useMemo(()=>d?null:l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:t,children:"Done"}),l.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:()=>mt(),disabled:I||A,children:l.jsxs("span",{className:"inline-flex items-center gap-2",children:[l.jsx(Ja,{size:14}),"Refresh"]})})]}),[d,I,A,t,mt]),Z=!!(n&&(o||i||a)),xe=Number.isFinite(u)?`${u} tags`:"",Ie=l.jsxs("div",{className:`sheet-stack ${d?"tag-library-page":""}`,children:[Z?l.jsxs("div",{className:"tag-library-context",children:[l.jsxs("div",{className:"tag-library-context-head",children:[l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"sheet-label",children:"Adding to alias"}),l.jsx("div",{className:"tag-library-context-title",children:o||"Alias"}),i?l.jsx("div",{className:"tag-library-context-token",children:i}):null]}),l.jsx("button",{type:"button",className:"ui-button is-tiny is-muted",onClick:t,children:"Back"})]}),l.jsx("div",{className:"tag-library-context-preview",children:a||""}),xe?l.jsx("div",{className:"tag-library-context-meta",children:xe}):null]}):null,l.jsxs("div",{className:"sheet-section",children:[d?null:l.jsx("div",{className:"sheet-label",children:"Browse"}),l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:F,type:"search",value:g,onChange:U=>y(U.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),l.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>y(""),disabled:!g,children:"Clear"})]}),l.jsx(Ze,{value:m,onChange:x,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:[{value:"",label:"Category: All"},...S.map(U=>({value:U.key,label:`${dr(U.key)} (${Number(U.actual||U.count||0).toLocaleString()})`}))]}),l.jsx(Ze,{value:w,onChange:j,className:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]})]}),je?l.jsx("div",{className:"text-xs text-[#9DA3FFCC]",children:je}):null,oe?l.jsx("div",{className:"text-xs text-[#FF8F70]",children:oe}):null]}),l.jsx("div",{className:"composer-alias-list tag-library-grid",role:"list",ref:Ee,children:I?l.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):f.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):l.jsxs(l.Fragment,{children:[Pe&&le>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${le}px`}}):null,Q.map(U=>l.jsx(s1,{tag:U.tag,category:U.category,count:U.count,isCollected:ve.has(String(U.tag||"").toLowerCase()),onSelectTag:n,addToCollection:Le,removeFromCollection:Fe,setStatus:ye},`${U.tag}-${U.category}`)),Pe&&fe>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${fe}px`}}):null,Pe?null:l.jsx("div",{ref:W,className:"composer-sentinel"}),A?l.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]});return Ne?d?l.jsxs("section",{className:"tag-library-surface",children:[s?l.jsx("div",{className:"sheet-label tag-library-page-title",children:s}):null,Ie,n?null:l.jsxs("div",{className:"tag-collection-bar","aria-live":"polite",children:[l.jsxs("div",{className:"tag-collection-bar-main",children:[l.jsx("div",{className:"tag-collection-bar-title",children:"Tags"}),l.jsx("div",{className:"tag-collection-bar-count","aria-live":"polite",children:E.length===0?"No tags selected":`${E.length} selected`})]}),l.jsx("button",{type:"button",className:"tag-collection-menu-btn",onClick:()=>G(!0),"aria-label":"Manage collected tags",children:l.jsx(tw,{size:16})}),l.jsx("textarea",{ref:O,value:ue,onChange:U=>{const Y=U.target.value.split(",").map(de=>de.trim()).filter(Boolean),ae=new Set,we=[];Y.forEach(de=>{const P=de.toLowerCase();ae.has(P)||(ae.add(P),we.push(de))}),k(we)},className:"sr-only","aria-label":"Collected tags text"})]}),n?null:l.jsx(Lt,{open:V,onClose:()=>G(!1),title:"Collected tags",variant:"sheet",shouldCloseOnOverlayClick:!0,children:l.jsxs("div",{className:"sheet-stack",children:[l.jsxs("div",{className:"sheet-section",children:[l.jsxs("div",{className:"sheet-label",children:["Tags (",E.length,")"]}),l.jsxs("div",{className:"tag-collection-codeblock",children:[l.jsx("pre",{className:"tag-collection-pre",children:ue||""}),l.jsx("button",{type:"button",className:"tag-collection-copy-btn",onClick:it,disabled:E.length===0,"aria-label":"Copy collected tags",children:l.jsx(nw,{size:16})}),l.jsx("textarea",{ref:O,value:ue,readOnly:!0,className:"sr-only","aria-label":"Collected tags text"})]}),E.length?l.jsx("div",{className:"tag-collection-chips",children:E.map((U,Y)=>l.jsxs("span",{className:"collected-tag-chip",onClick:()=>Fe(U),role:"button",tabIndex:0,onKeyDown:ae=>{ae.target===ae.currentTarget&&(ae.key==="Enter"||ae.key===" ")&&(ae.preventDefault(),Fe(U))},children:[l.jsx("code",{className:"collected-tag-code",children:U}),l.jsx("button",{type:"button",className:"collected-tag-remove","aria-label":`Remove ${U}`,onClick:ae=>{ae.stopPropagation(),Fe(U)},children:l.jsx(ur,{size:12})})]},`${U}-${Y}`))}):l.jsx("div",{className:"sheet-hint",children:"No tags collected yet."})]}),l.jsxs("div",{className:"sheet-section flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:()=>G(!1),children:"Close"}),l.jsx("button",{type:"button",className:"ui-button is-ghost w-full",onClick:He,disabled:E.length===0,children:"Clear"})]})]})})]}):l.jsx(Lt,{open:e,onClose:t,title:s,variant:"fullscreen",contentClassName:"tag-library-sheet",footer:M,shouldCloseOnOverlayClick:!1,children:Ie}):null}function i1(){const e=jn(),[t]=em(),n=t.get("q")||"",r=c.useMemo(()=>n?`Tag Library  ${n}`:"Tag Library",[n]);return l.jsxs("div",{className:"page-shell page-stack",children:[l.jsxs("div",{className:"page-bar",children:[l.jsx("h1",{className:"page-bar-title",children:r}),l.jsxs("div",{className:"page-bar-actions",children:[l.jsx(Ft,{size:"xs",onClick:()=>e("/aliases"),children:"Aliases"}),l.jsx(Ft,{size:"xs",onClick:()=>e("/compose"),children:"Composer"})]})]}),l.jsx(o1,{inline:!0,initialQuery:n,title:"Browse",onSelectTag:null})]})}const Fm={contentVisibility:"auto",containIntrinsicSize:"260px 140px"},a1=c.memo(function({tag:t,category:n,count:r,isCollected:s,onToggle:o}){const i=c.useCallback(a=>{a.stopPropagation(),o(t)},[o,t]);return l.jsxs("button",{type:"button",className:`composer-alias-item composer-tag-item ${s?"is-collected":""}`,onClick:i,style:Fm,"data-virtual-row":"true",children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name composer-tag-name",children:l.jsx("code",{className:"composer-tag-code",children:t})}),n?l.jsx("span",{className:"composer-alias-category",children:dr(n)}):null]}),l.jsx("div",{className:"composer-alias-token composer-tag-count",children:Number(r||0).toLocaleString()})]})});function c1({open:e=!1,onClose:t,value:n="",onChange:r,aliasOptions:s=[],aliasCatalog:o=[],fieldLabel:i="Prompt",variant:a="sheet"}){var bu,Cu,Eu;const u=c.useRef(null),d=c.useRef(null),g=c.useRef(null),y=c.useRef(null),[m,x]=c.useState(n),[w,j]=c.useState(""),S=c.useDeferredValue(w),[h,f]=c.useState("All"),[p,v]=c.useState("All"),[b,C]=c.useState(30),[_,I]=c.useState("compose"),z=a==="page",A=z||e,[D,oe]=c.useState(null),[q,je]=c.useState(null),[ye,ne]=c.useState(null),me=c.useRef(null),R=c.useRef(null),[N,E]=c.useState(!1),[k,V]=c.useState(null),G=c.useRef(null),te=c.useRef(null),[re,X]=c.useState(""),[ie,W]=c.useState(""),[F,O]=c.useState("count"),[se,ce]=c.useState([]),[Re,Ne]=c.useState([]),[Ee,Me]=c.useState(0),[Ke,le]=c.useState(0),[fe,Pe]=c.useState(!1),[We,Q]=c.useState(!1),[ue,ve]=c.useState(""),ge=c.useRef(null),ke=c.useRef(null),Le=c.useRef(new Map),Fe=c.useRef(new Map),[He,it]=c.useState([]),[ht,mt]=c.useState(""),[ut,M]=c.useState([]),[Z,xe]=c.useState(""),Ie=c.useMemo(()=>{if(!m)return{text:"",parts:[]};const L=new Map;if((o||[]).forEach(Be=>{if(!Be)return;const _e=String(Be.token||"").trim().toLowerCase(),Ge=typeof Be.text=="string"?Be.text.trim():"";!_e||!Ge||L.set(_e,Ge)}),!L.size||!m.includes("$"))return{text:m,parts:[{text:m,isAlias:!1}]};const T=[],pe=/\$([a-z0-9_:-]+)\$/gi;let Ce=0,De;for(;(De=pe.exec(m))!==null;){const Be=De.index;Be>Ce&&T.push({text:m.slice(Ce,Be),isAlias:!1});const _e=String(De[1]||"").toLowerCase(),Ge=L.get(_e);typeof Ge=="string"?T.push({text:Ge,isAlias:!0}):T.push({text:De[0],isAlias:!1}),Ce=pe.lastIndex}return Ce<m.length&&T.push({text:m.slice(Ce),isAlias:!1}),{text:T.map(Be=>Be.text).join(""),parts:T}},[o,m]);c.useEffect(()=>{e&&(x(n),I("compose"),j(""),f("All"),v("All"),C(30),oe(null),je(null),ne(null),E(!1),V(null),Ae(""),X(""),W(""),O("count"),Ne([]),Me(0),le(0),Pe(!1),Q(!1),ve(""))},[e,n]),c.useEffect(()=>{if(D===null||typeof document>"u")return;const L=document.querySelector("main.app-content"),T={htmlOverscroll:document.documentElement.style.overscrollBehavior,bodyOverscroll:document.body.style.overscrollBehavior,bodyOverflow:document.body.style.overflow,scrollOverflow:L==null?void 0:L.style.overflow,scrollTouch:L==null?void 0:L.style.touchAction,scrollOverscroll:L==null?void 0:L.style.overscrollBehavior};return document.documentElement.style.overscrollBehavior="none",document.body.style.overscrollBehavior="none",document.body.style.overflow="hidden",L&&(L.style.overflow="hidden",L.style.touchAction="none",L.style.overscrollBehavior="none"),()=>{document.documentElement.style.overscrollBehavior=T.htmlOverscroll||"",document.body.style.overscrollBehavior=T.bodyOverscroll||"",document.body.style.overflow=T.bodyOverflow||"",L&&(L.style.overflow=T.scrollOverflow||"",L.style.touchAction=T.scrollTouch||"",L.style.overscrollBehavior=T.scrollOverscroll||"")}},[D]);const U=c.useMemo(()=>(Array.isArray(o)?o.filter(L=>L&&L.name):[]).map(L=>({...L,...du(L)})),[o]),Y=c.useMemo(()=>{const L=new Map;return U.forEach(T=>{T!=null&&T.token&&L.set(String(T.token).toLowerCase(),T)}),L},[U]),ae=c.useMemo(()=>{const L=new Set(["All"]);return U.forEach(T=>{T.category&&L.add(T.category)}),Array.from(L).sort((T,pe)=>T.localeCompare(pe))},[U]),we=c.useMemo(()=>{const L=new Set(["All"]);return U.forEach(T=>{(!h||h==="All"||T.category===h)&&T.subcategory&&L.add(T.subcategory)}),Array.from(L).sort((T,pe)=>T.localeCompare(pe))},[U,h]),de=c.useMemo(()=>["All",...ae.filter(L=>L!=="All")],[ae]),P=c.useMemo(()=>["All",...we.filter(L=>L!=="All")],[we]),$=c.useMemo(()=>{const L=S.trim().toLowerCase();return U.filter(T=>{var pe,Ce,De,Oe;return h!=="All"&&(T.category||"")!==h||p!=="All"&&(T.subcategory||"other")!==p?!1:L?((pe=T.token)==null?void 0:pe.toLowerCase().includes(L))||((Ce=T.text)==null?void 0:Ce.toLowerCase().includes(L))||((De=T.name)==null?void 0:De.toLowerCase().includes(L))||((Oe=T.displayName)==null?void 0:Oe.toLowerCase().includes(L)):!0}).sort((T,pe)=>{const Ce=(T.subcategory||"").toLowerCase(),De=(pe.subcategory||"").toLowerCase();return Ce!==De?Ce.localeCompare(De):T.token.localeCompare(pe.token)})},[U,h,p,S]),H=c.useMemo(()=>$.slice(0,b),[$,b]);c.useEffect(()=>{C(30)},[h,p,w,U]),c.useEffect(()=>{v("All")},[h]),c.useEffect(()=>{const L=g.current;if(!L)return;const T=new IntersectionObserver(pe=>{pe[0].isIntersecting&&b<$.length&&C(De=>Math.min(De+20,$.length))},{threshold:.1});return T.observe(L),()=>T.disconnect()},[b,$.length]);const K=c.useMemo(()=>typeof m!="string"?[]:Nw(m),[m]);c.useEffect(()=>{if(!e||_!=="tags"||se.length>0)return;let L=!1;return(async()=>{try{const T=await sm();if(L)return;ce(Array.isArray(T==null?void 0:T.categories)?T.categories:[])}catch(T){console.error("Failed to load tag categories",T),L||ce([])}})(),()=>{L=!0}},[e,_,se.length]);const be=c.useCallback((L,T,pe,Ce,De)=>[L||"",T||"",pe||"",String(Ce||0),String(De||0)].join("::"),[]),Se=c.useCallback(()=>{const L=Le.current;if(L.size<=50)return;const T=Array.from(L.entries());T.sort((pe,Ce)=>{var De,Oe;return(((De=pe[1])==null?void 0:De.ts)||0)-(((Oe=Ce[1])==null?void 0:Oe.ts)||0)}),T.slice(0,Math.max(0,T.length-50)).forEach(([pe])=>L.delete(pe))},[]),qe=c.useCallback(async({nextQuery:L,nextCategory:T,nextSort:pe}={})=>{var Lu;const Ce=typeof L=="string"?L:re,De=typeof T=="string"?T:ie,Oe=typeof pe=="string"?pe:F,Be=be(Ce,De,Oe,80,0),_e=Date.now(),Ge=Le.current.get(Be);if(Ge&&_e-Ge.ts<5*60*1e3){Ne(Ge.items||[]),Me(Number(Ge.total||0)),le(0),ve(""),Pe(!1);return}const bn=Fe.current.get(Be);if(bn){try{const Rt=await bn;Ne((Rt==null?void 0:Rt.items)||[]),Me(Number((Rt==null?void 0:Rt.total)||0)),le(0),ve("")}catch{}return}Pe(!0),ve(""),le(0),ge.current&&ge.current.key!==Be&&ge.current.controller.abort();const Ar=new AbortController;ge.current={controller:Ar,key:Be};try{const Rt=Mo({q:Ce,category:De,sort:Oe,limit:80,offset:0},{signal:Ar.signal});Fe.current.set(Be,Rt);const Kt=await Rt;Le.current.set(Be,{items:(Kt==null?void 0:Kt.items)||[],total:Number((Kt==null?void 0:Kt.total)||0),ts:Date.now()}),Se(),Ne((Kt==null?void 0:Kt.items)||[]),Me(Number((Kt==null?void 0:Kt.total)||0))}catch(Rt){if((Rt==null?void 0:Rt.name)==="AbortError")return;console.error("Failed to search tags",Rt),ve("Unable to load tags right now."),Ne([]),Me(0)}finally{Fe.current.delete(Be),((Lu=ge.current)==null?void 0:Lu.key)===Be&&(ge.current=null),Pe(!1)}},[be,ie,re,F,Se]),Te=c.useCallback(async()=>{var Be;if(fe||We||Re.length>=Ee)return;const L=Ke+80,T=be(re,ie,F,80,L),pe=Date.now(),Ce=Le.current.get(T);if(Ce&&pe-Ce.ts<5*60*1e3){Ne(_e=>[..._e,...Ce.items||[]]),Me(Number(Ce.total||0)),le(L),Q(!1);return}const De=Fe.current.get(T);if(De){try{const _e=await De,Ge=(_e==null?void 0:_e.items)||[];Ne(bn=>[...bn,...Ge]),Me(Number((_e==null?void 0:_e.total)||0)),le(L)}catch{}return}Q(!0),ve(""),ke.current&&ke.current.key!==T&&ke.current.controller.abort();const Oe=new AbortController;ke.current={controller:Oe,key:T};try{const _e=Mo({q:re,category:ie,sort:F,limit:80,offset:L},{signal:Oe.signal});Fe.current.set(T,_e);const Ge=await _e,bn=(Ge==null?void 0:Ge.items)||[];Le.current.set(T,{items:bn,total:Number((Ge==null?void 0:Ge.total)||0),ts:Date.now()}),Se(),Ne(Ar=>[...Ar,...bn]),Me(Number((Ge==null?void 0:Ge.total)||0)),le(L)}catch(_e){if((_e==null?void 0:_e.name)==="AbortError")return;console.error("Failed to load more tags",_e),ve("Unable to load more tags.")}finally{Fe.current.delete(T),((Be=ke.current)==null?void 0:Be.key)===T&&(ke.current=null),Q(!1)}},[be,ie,fe,We,Ke,re,F,Re.length,Ee,Se]);c.useEffect(()=>{if(!e||_!=="tags")return;const L=window.setTimeout(()=>{qe()},220);return()=>window.clearTimeout(L)},[e,_,re,ie,F,qe]),c.useEffect(()=>()=>{var L,T,pe,Ce;ge.current&&((T=(L=ge.current.controller)==null?void 0:L.abort)==null||T.call(L)),ke.current&&((Ce=(pe=ke.current.controller)==null?void 0:pe.abort)==null||Ce.call(pe))},[]);const{containerRef:nt,startIndex:Nn,endIndex:kn,topSpacer:Bn,bottomSpacer:Sl,virtualized:Ht,isNearEnd:jl}=gu({itemCount:Re.length,enabled:e&&_==="tags",estimateRowHeight:70,overscan:8,minItems:90}),Nl=Ht?Re.slice(Nn,kn):Re;c.useEffect(()=>{if(!e||_!=="tags"||Ht)return;const L=te.current;if(!L||typeof IntersectionObserver>"u")return;const T=new IntersectionObserver(pe=>{const Ce=pe[0];Ce!=null&&Ce.isIntersecting&&Te()},{threshold:.1});return T.observe(L),()=>T.disconnect()},[e,_,Ht,Te]),c.useEffect(()=>{Ht&&(fe||We||Re.length>=Ee||jl&&Te())},[Ht,fe,We,Re.length,Ee,jl,Te]);const B=c.useCallback(L=>{x(T=>{const Ce=typeof L=="function"?L(typeof T=="string"?T:""):String(L||"");return a==="page"&&(r==null||r(Ce)),Ce})},[r,a]),ee=c.useCallback(L=>{const T=String(L||"").trim();if(T&&(B(pe=>{const Ce=pe.length,De=pe.length,Oe=pe.slice(0,Ce),Be=pe.slice(De),_e=Oe.match(/[^\s]$/),Ge=Be.match(/^[^\s]/),bn=_e&&_e[0]!==","?", ":"",Ar=Ge&&Ge[0]!==","?", ":"";return Oe+bn+T+Ar+Be}),u.current))try{u.current.blur()}catch{}},[B]),[ze,Ae]=c.useState(""),Ue=c.useCallback(()=>{const L=String(ze||"").trim();if(!L)return;const pe=L.split(",").map(Ce=>Ce.trim()).filter(Boolean).join(", ");pe&&(ee(pe),Ae(""),I("compose"))},[ze,ee]),St=c.useCallback(()=>{it([]),mt("Cleared collected tags.")},[]),kl=c.useCallback(()=>{if(!He.length){mt("No tags to apply.");return}ee(He.join(", ")),mt(`Applied ${He.length} tag${He.length===1?"":"s"}.`),it([]),I("compose")},[He,ee]),bl=c.useCallback(L=>{const T=String(L||"").trim();T&&it(pe=>{const Ce=T.toLowerCase();return pe.some(Oe=>Oe.toLowerCase()===Ce)?(mt(`Removed: ${T}`),pe.filter(Oe=>Oe.toLowerCase()!==Ce)):(mt(`Selected: ${T}`),[...pe,T])})},[]),Om=c.useCallback(L=>{const T=String(L||"").trim();T&&M(pe=>{const Ce=T.toLowerCase();return pe.some(Oe=>Oe.toLowerCase()===Ce)?(xe(`Removed: ${T}`),pe.filter(Oe=>Oe.toLowerCase()!==Ce)):(xe(`Selected: ${T}`),[...pe,T])})},[]),Dm=c.useCallback(()=>{M([]),xe("Cleared selected aliases.")},[]),Um=c.useCallback(()=>{if(!ut.length){xe("No aliases to apply.");return}const L=ut.map(T=>`$${T}$`).join(", ");ee(L),xe(`Applied ${ut.length} alias${ut.length===1?"":"es"}.`),M([]),I("compose")},[ut,ee]),Gt=_==="tags"?{kind:"tag",count:He.length,status:ht,onClear:St,onApply:kl}:_==="aliases"?{kind:"alias",count:ut.length,status:Z,onClear:Dm,onApply:Um}:null,Vn=(Gt==null?void 0:Gt.count)||0,Bm=Gt?`${Vn} ${Gt.kind==="alias"?Vn===1?"alias":"aliases":Vn===1?Gt.kind:`${Gt.kind}s`} selected`:"",Vm=!z&&Vn>0,yu=z&&Vn>0,Wm=yu?{"--composer-selection-offset":"var(--bottom-nav-height, 64px)"}:void 0,vu=(L,T,pe)=>!Gt||Vn===0?null:l.jsxs("div",{className:`composer-tag-collection-bar ${L||""}`.trim(),style:pe,children:[l.jsxs("div",{children:[l.jsx("div",{className:"composer-tag-collection-label",children:Bm}),Gt.status?l.jsx("div",{className:"composer-tag-collection-status",children:Gt.status}):null]}),l.jsxs("div",{className:"composer-tag-collection-actions",children:[l.jsx("button",{type:"button",className:"composer-tag-collection-btn",onClick:Gt.onClear,disabled:!Vn,children:"Clear"}),l.jsx("button",{type:"button",className:"composer-tag-collection-btn is-primary",onClick:Gt.onApply,disabled:!Vn,children:T})]})]}),Hm=Vm?vu("is-footer","Insert"):null,Gm=yu?vu("is-floating","Insert",Wm):null,xu=L=>{B(T=>kw(T||"",L))},wu=c.useCallback((L,T)=>{if(!(K!=null&&K.length))return;const pe=L+T;pe<0||pe>=K.length||(B(Ce=>lf(Ce||"",K,L,pe)),ne(pe))},[K,B]),Su=L=>{if(!L)return;let T=L.text;if(L.type==="alias"){const Ce=Y.get(L.text.toLowerCase());T=(Ce==null?void 0:Ce.displayName)||L.text}const pe=rf(m||"",L);V({element:L,displayName:T,weight:(pe==null?void 0:pe.weight)??1}),E(!0)},Cl=c.useCallback((L,T)=>{L===T||L===null||T===null||K!=null&&K.length&&B(pe=>lf(pe||"",K,L,T))},[K,B]),Km=c.useCallback((L,T)=>{oe(T),me.current=L.target,L.dataTransfer.effectAllowed="move",L.dataTransfer.setData("text/plain",T.toString()),requestAnimationFrame(()=>{me.current&&me.current.classList.add("is-dragging")})},[]),Qm=c.useCallback(()=>{me.current&&me.current.classList.remove("is-dragging"),D!==null&&q!==null&&D!==q&&Cl(D,q),oe(null),je(null),me.current=null},[D,q,Cl]),Ym=c.useCallback((L,T)=>{L.preventDefault(),L.dataTransfer.dropEffect="move",T!==q&&je(T)},[q]),qm=c.useCallback(()=>{},[]),Xm=c.useCallback((L,T)=>{var Oe,Be;if(!((Be=(Oe=L.target)==null?void 0:Oe.closest)==null?void 0:Be.call(Oe,".composer-token-drag-handle")))return;const Ce=L.touches[0],De=window.setTimeout(()=>{R.current&&(R.current.active=!0,oe(T),je(T))},240);R.current={idx:T,startX:Ce.clientX,startY:Ce.clientY,active:!1,timer:De}},[]),Jm=c.useCallback(L=>{if(!R.current)return;const T=L.touches[0],pe=Math.abs(T.clientX-R.current.startX),Ce=Math.abs(T.clientY-R.current.startY);if(!R.current.active){(pe>8||Ce>8)&&(window.clearTimeout(R.current.timer),R.current=null);return}L.preventDefault();const De=document.querySelectorAll(".composer-token-draggable"),Oe=T.clientX,Be=T.clientY;for(let _e=0;_e<De.length;_e++){const Ge=De[_e].getBoundingClientRect();if(Oe>=Ge.left&&Oe<=Ge.right&&Be>=Ge.top&&Be<=Ge.bottom){je(_e);break}}},[]),Zm=c.useCallback(()=>{var L,T;(L=R.current)!=null&&L.timer&&window.clearTimeout(R.current.timer),(T=R.current)!=null&&T.active&&D!==null&&q!==null&&D!==q&&Cl(D,q),R.current=null,oe(null),je(null)},[D,q,Cl]),eg=c.useCallback(()=>{var L;(L=R.current)!=null&&L.timer&&window.clearTimeout(R.current.timer),R.current=null,oe(null),je(null)},[]),tg=()=>{r==null||r(m),t==null||t()},ju=()=>{t==null||t()};if(!A)return null;const Nu=l.jsxs("div",{className:`composer-shell ${z?"is-page":""}`,children:[l.jsx(br,{ariaLabel:"Composer tabs",value:_,onChange:I,items:[{key:"compose",label:"Compose",icon:l.jsx(au,{size:14})},{key:"aliases",label:"Aliases",icon:l.jsx(xl,{size:14})},{key:"tags",label:"Tags",icon:l.jsx(cr,{size:14})}]}),l.jsxs("div",{className:`composer-panel composer-panel-compose ${_==="compose"?"is-visible":""}`,children:[l.jsx("div",{className:"composer-editor",children:l.jsxs("div",{className:"composer-input-row",children:[l.jsx("input",{ref:u,type:"text",value:ze,onChange:L=>Ae(L.target.value),onKeyDown:L=>{L.key==="Enter"&&(L.preventDefault(),Ue())},className:"composer-input ui-control ui-input is-compact",placeholder:"Add prompt text","aria-label":"Add prompt text"}),l.jsx("button",{type:"button",className:"composer-add-btn",onClick:Ue,disabled:!ze.trim(),"aria-label":"Add prompt text",children:"+"})]})}),l.jsxs("div",{className:"composer-tokens",children:[l.jsxs("div",{className:"composer-tokens-header",children:[l.jsxs("span",{className:"composer-tokens-label",children:["Elements",l.jsx("span",{className:"composer-tokens-count",children:K.length})]}),l.jsx("span",{className:"composer-tokens-hint",children:"Drag to reorder  Tap to adjust"})]}),K.length?l.jsx("div",{ref:y,className:`composer-tokens-list ${D!==null?"is-dragging":""}`,style:{"--composer-elements":K.length},children:K.map((L,T)=>{let pe=L.text;if(L.type==="alias"){const _e=Y.get(L.text.toLowerCase());pe=(_e==null?void 0:_e.displayName)||L.text}const Ce=D===T,De=q===T&&D!==null&&D!==T,Oe=rf(m||"",L),Be=(Oe==null?void 0:Oe.weight)??1;return l.jsxs("span",{className:`composer-token composer-token-draggable ${L.type==="alias"?"is-alias":"is-tag"} ${Ce?"is-dragging":""} ${De?"is-drop-target":""} ${ye===T?"is-selected":""}`,title:L.type==="alias"?`Alias: $${L.text}$`:`Tag: ${L.text}`,role:"button",tabIndex:0,draggable:!0,onDragStart:_e=>Km(_e,T),onDragEnd:Qm,onDragOver:_e=>Ym(_e,T),onDragLeave:qm,onTouchStart:_e=>Xm(_e,T),onTouchMove:Jm,onTouchEnd:Zm,onTouchCancel:eg,onClick:()=>{D===null&&(ne(T),Su(L))},onKeyDown:_e=>{if(_e.target===_e.currentTarget&&(_e.key==="Enter"||_e.key===" ")){if(_e.preventDefault(),D!==null)return;ne(T),Su(L)}},children:[l.jsx("span",{className:"composer-token-order",children:T+1}),l.jsx("span",{className:"composer-token-drag-handle","aria-hidden":"true",children:l.jsx(Za,{size:10})}),l.jsx("span",{className:"composer-token-name",children:pe}),L.type==="alias"&&l.jsx("span",{className:"composer-token-type",children:"$"}),Math.abs(Be-1)>1e-6&&l.jsxs("span",{className:"composer-token-weight",children:[Rn(Be),""]}),l.jsxs("div",{className:"composer-token-shift",role:"group","aria-label":"Reorder token",children:[l.jsx("button",{type:"button",className:"composer-token-shift-btn",onClick:_e=>{_e.stopPropagation(),wu(T,-1)},"aria-label":"Move up",disabled:T===0,children:""}),l.jsx("button",{type:"button",className:"composer-token-shift-btn",onClick:_e=>{_e.stopPropagation(),wu(T,1)},"aria-label":"Move down",disabled:T===K.length-1,children:""})]}),l.jsx("button",{type:"button",className:"composer-token-remove",onClick:_e=>{_e.stopPropagation(),xu(L)},"aria-label":`Remove ${L.text}`,children:l.jsx(ur,{size:9})})]},`${L.type}-${L.text}-${L.start}`)})}):l.jsx("div",{className:"composer-empty",children:"No elements yet."})]}),l.jsxs("div",{className:"composer-expanded",children:[l.jsxs("div",{className:"composer-expanded-header",children:[l.jsx("span",{className:"composer-expanded-label",children:"Expanded prompt"}),l.jsx("span",{className:"composer-expanded-meta",children:Ie.text?`${Ie.text.length} chars`:"Empty"})]}),l.jsx("div",{className:"composer-expanded-box","aria-label":"Expanded prompt",children:Ie.text?Ie.parts.map((L,T)=>L.isAlias?l.jsx("span",{className:"composer-expanded-alias",children:L.text},`alias-${T}`):l.jsx("span",{children:L.text},`text-${T}`)):"No prompt yet."})]})]}),l.jsxs("div",{className:`composer-panel composer-panel-aliases ${_==="aliases"?"is-visible":""}`,children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:d,type:"text",value:w,onChange:L=>j(L.target.value),placeholder:"Search aliases",className:"composer-search ui-control ui-input","aria-label":"Search aliases"}),l.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>j(""),disabled:!w,children:"Clear"})]}),l.jsx(Ze,{value:h,onChange:f,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:de.map(L=>({value:L,label:L==="All"?"Category: All":In(L)}))}),P.length>2&&l.jsx(Ze,{value:p,onChange:v,className:"composer-subcategory-select",size:"sm",options:P.map(L=>({value:L,label:L==="All"?"All subcategories":dr(L)}))})]}),l.jsx("div",{className:"composer-alias-list",children:$.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No aliases found."}):l.jsxs(l.Fragment,{children:[H.map(L=>l.jsxs("button",{type:"button",onClick:()=>Om(L.token),className:`composer-alias-item ${ut.some(T=>T.toLowerCase()===L.token.toLowerCase())?"is-collected":""}`,style:Fm,children:[l.jsxs("div",{className:"composer-alias-header",children:[l.jsx("div",{className:"composer-alias-name",children:L.displayName||L.token}),L.category?l.jsx("span",{className:"composer-alias-category",children:In(L.category)}):null]}),l.jsxs("div",{className:"composer-alias-token",children:["$",L.token,"$"]}),l.jsx("div",{className:"composer-alias-text",children:L.text})]},L.key)),b<$.length&&l.jsx("div",{ref:g,className:"composer-sentinel"})]})})]}),l.jsxs("div",{className:`composer-panel composer-panel-tags ${_==="tags"?"is-visible":""}`,onClick:L=>L.stopPropagation(),children:[l.jsxs("div",{className:"composer-filters",children:[l.jsxs("div",{className:"input-with-action",children:[l.jsx("input",{ref:G,type:"search",value:re,onChange:L=>X(L.target.value),placeholder:"Search tags (e.g. smile, city, sword)",className:"composer-search ui-control ui-input","aria-label":"Search tags"}),l.jsx("button",{type:"button",className:"input-action-btn",onClick:()=>X(""),disabled:!re,children:"Clear"})]}),l.jsx(Ze,{value:ie,onChange:W,className:"composer-subcategory-select","aria-label":"Filter by category",size:"sm",options:[{value:"",label:"Category: All"},...se.map(L=>({value:L.key,label:`${dr(L.key)} (${Number(L.actual||L.count||0).toLocaleString()})`}))]}),l.jsx(Ze,{value:F,onChange:O,className:"composer-subcategory-select","aria-label":"Sort tags",size:"sm",options:[{value:"count",label:"Sort: Popular"},{value:"alpha",label:"Sort: AZ"}]})]}),ue?l.jsx("div",{className:"composer-tags-error",children:ue}):null,l.jsx("div",{className:"composer-alias-list composer-tags-grid",role:"list",ref:nt,children:fe?l.jsx("div",{className:"composer-alias-empty",children:"Loading tags"}):Re.length===0?l.jsx("div",{className:"composer-alias-empty",children:"No tags found."}):l.jsxs(l.Fragment,{children:[Ht&&Bn>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${Bn}px`}}):null,Nl.map(L=>l.jsx(a1,{tag:L.tag,category:L.category,count:L.count,isCollected:He.some(T=>T.toLowerCase()===String(L.tag||"").toLowerCase()),onToggle:bl},`${L.tag}-${L.category}`)),Ht&&Sl>0?l.jsx("div",{"aria-hidden":!0,style:{height:`${Sl}px`}}):null,Re.length<Ee&&!Ht?l.jsx("div",{ref:te,className:"composer-sentinel"}):null,We?l.jsx("div",{className:"composer-alias-empty",children:"Loading more"}):null]})})]})]}),ku=l.jsx(rc,{open:N,onClose:()=>E(!1),title:((bu=k==null?void 0:k.element)==null?void 0:bu.type)==="alias"?"Alias strength":"Tag strength",tokenLabel:k?((Cu=k.element)==null?void 0:Cu.type)==="alias"?`${k.displayName}  $${(Eu=k.element)==null?void 0:Eu.text}$`:k.displayName:"",weight:(k==null?void 0:k.weight)??1,onApply:L=>{k!=null&&k.element&&B(T=>sf(T||"",k.element,L))},onRemoveWeight:()=>{k!=null&&k.element&&B(L=>sf(L||"",k.element,null))},onDeleteToken:()=>{k!=null&&k.element&&xu(k.element)}}),ng=l.jsx("div",{className:"page-bar composer-bar",children:l.jsx("h1",{className:"page-bar-title",children:i||"Prompt"})});return z?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"page-shell page-stack",children:[ng,Nu]}),Gm,ku]}):l.jsxs(l.Fragment,{children:[l.jsx(Lt,{open:e,onClose:ju,title:"Composer",variant:"fullscreen",shouldCloseOnOverlayClick:!1,shouldCloseOnEsc:!1,footer:l.jsxs("div",{className:"composer-footer-stack",children:[Hm,l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"ui-button is-muted w-full",onClick:ju,children:"Cancel"}),l.jsx("button",{type:"button",className:"ui-button is-primary w-full",onClick:tg,children:"Apply"})]})]}),children:Nu}),ku]})}function u1(){const e=jn(),[t]=em(),{formData:n,handleFormChange:r,aliasOptions:s,aliasCatalog:o,promptFieldName:i,handleGenerate:a,workflowData:u,selectedWorkflow:d,isLoading:g}=Rm(),m=t.get("field")||i||"prompt",x=(n==null?void 0:n[m])||"";return c.useEffect(()=>{if(!(typeof document>"u"))return document.body.classList.add("no-pull-refresh"),document.documentElement.classList.add("no-pull-refresh"),()=>{document.body.classList.remove("no-pull-refresh"),document.documentElement.classList.remove("no-pull-refresh")}},[]),c.useEffect(()=>{const w=()=>{!u||!d||g||a()};return window.addEventListener("cozygen:request-render",w),()=>window.removeEventListener("cozygen:request-render",w)},[a,g,d,u]),l.jsx(c1,{open:!0,onClose:()=>e("/controls"),value:x,onChange:w=>r(m,w),aliasOptions:s,aliasCatalog:o,fieldLabel:m,variant:"page"})}function d1(){var h,f;const{authed:e,ready:t,login:n}=ci(),r=jn(),o=((f=(h=Wt().state)==null?void 0:h.from)==null?void 0:f.pathname)||"/studio",[i,a]=c.useState(""),[u,d]=c.useState(""),[g,y]=c.useState(""),[m,x]=c.useState(!1),[w,j]=c.useState(!1);c.useEffect(()=>{try{localStorage.getItem("cozygen_idle_logout")&&(j(!0),localStorage.removeItem("cozygen_idle_logout"))}catch{}},[]),c.useEffect(()=>{t&&e&&r(o,{replace:!0})},[t,e,o,r]);const S=async p=>{p.preventDefault(),y(""),x(!0);try{await n(i,u),r(o,{replace:!0})}catch(v){v!=null&&v.unauthorized?y("Invalid username or password."):y("Unable to sign in. Please try again.")}finally{x(!1)}};return l.jsx("div",{className:"login-shell",children:l.jsxs("div",{className:"neon-card login-card",children:[l.jsxs("div",{className:"login-brand",children:[l.jsx(dm,{size:34}),l.jsxs("div",{className:"min-w-0",children:[l.jsx("div",{className:"login-title",children:"Sign in"}),l.jsx("div",{className:"login-subtitle",children:"Continue to CozyGen Studio"})]})]}),l.jsxs("form",{className:"login-form",onSubmit:S,children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"login-username",className:"login-label",children:"Username"}),l.jsx("input",{id:"login-username",type:"text",className:"ui-control ui-input",value:i,onChange:p=>a(p.target.value),autoComplete:"username",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"login-password",className:"login-label",children:"Password"}),l.jsx("input",{id:"login-password",type:"password",className:"ui-control ui-input",value:u,onChange:p=>d(p.target.value),autoComplete:"current-password",required:!0})]}),g?l.jsx("div",{className:"ui-alert",children:g}):w?l.jsx("div",{className:"ui-alert is-warn",children:"You were signed out due to inactivity. Please sign in again."}):null,l.jsx("button",{type:"submit",disabled:m,className:"ui-button is-primary w-full",children:m?"Signing in":"Sign in"})]}),l.jsxs("p",{className:"login-footnote",children:["Access is protected by CozyGen auth. Set ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /"," ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server to enable."]})]})})}function f1({containerRef:e}){const{pathname:t,hash:n}=Wt();return c.useEffect(()=>{if(n)return;const r=e==null?void 0:e.current;if(r&&typeof r.scrollTo=="function"){r.scrollTo({top:0,left:0,behavior:"auto"});return}typeof window<"u"&&window.scrollTo(0,0)},[t,n,e]),null}function p1({children:e}){const{authed:t,ready:n}=ci(),r=Wt();return n?t?e:l.jsx(Ga,{to:"/login",state:{from:r},replace:!0}):l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-200",children:l.jsxs("div",{className:"page-loading",children:[l.jsx("span",{className:"loading-spinner lg","aria-hidden":"true"}),l.jsx("span",{className:"sr-only",children:"Checking session"})]})})}function h1(){const{pathname:e}=Wt(),t=jn(),{defaultCreds:n,authed:r}=ci(),s=e==="/login",o=c.useRef(null),i=!s,a=i;return c.useEffect(()=>{if(!r)return;const u=d=>{var m;const g=String(((m=d==null?void 0:d.detail)==null?void 0:m.fieldName)||"").trim(),y=g?`?field=${encodeURIComponent(g)}`:"";t(`/compose${y}`)};return window.addEventListener("cozygen:open-composer",u),()=>window.removeEventListener("cozygen:open-composer",u)},[r,t]),l.jsxs("div",{className:"app-shell",children:[!s&&l.jsx(sw,{isMobileAlignedNav:i}),!s&&r&&n&&l.jsxs("div",{className:"flex-shrink-0 bg-amber-500/10 text-amber-200 border-b border-amber-400/50 px-4 py-2 text-sm text-center",children:["Default CozyGen credentials are still in use. Change ",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_USER"})," /",l.jsx("code",{className:"font-mono",children:"COZYGEN_AUTH_PASS"})," on the server."]}),l.jsx(f1,{containerRef:o}),l.jsxs("div",{className:"app-body",children:[l.jsx("main",{ref:o,className:s?"app-content is-login":"app-content",children:l.jsxs(jx,{children:[l.jsx(nn,{path:"/login",element:l.jsx(d1,{})}),l.jsxs(nn,{element:l.jsx(p1,{children:l.jsx(N0,{children:l.jsx(wx,{})})}),children:[l.jsx(nn,{path:"/",element:l.jsx(Ga,{to:"/studio",replace:!0})}),l.jsx(nn,{path:"/studio",element:l.jsx(E0,{})}),l.jsx(nn,{path:"/controls",element:l.jsx(C0,{})}),l.jsx(nn,{path:"/compose",element:l.jsx(u1,{})}),l.jsx(nn,{path:"/gallery",element:l.jsx(K0,{})}),l.jsx(nn,{path:"/aliases",element:l.jsx(n1,{})}),l.jsx(nn,{path:"/tags",element:l.jsx(i1,{})})]}),l.jsx(nn,{path:"*",element:l.jsx(Ga,{to:"/studio",replace:!0})})]})}),a?l.jsx(iw,{}):null]})]})}function m1(){return l.jsx(Rx,{children:l.jsx(Xx,{children:l.jsx(h1,{})})})}Xi.createRoot(document.getElementById("root")).render(l.jsx(Qt.StrictMode,{children:l.jsx(m1,{})}));
