import{r as p,F as z,G as J}from"./index-BHgq2Ao1.js";function w(r){const t=String(r||"").trim();if(!t)return"";const e=t.toLowerCase(),n={scifi:"Sci-Fi",sci:"Sci",ui:"UI",vfx:"VFX",hdr:"HDR",dof:"DoF",bokeh:"Bokeh",vhs:"VHS",jpeg:"JPEG",jpg:"JPG",png:"PNG",gif:"GIF",webp:"WebP",api:"API",nsfw:"NSFW",sfw:"SFW",sfx:"SFX",fx:"FX",lora:"LoRA",loras:"LoRAs",ip:"IP",egirl:"E-girl",i2v:"I2V",t2i:"T2I",img2img:"Img2Img",txt2img:"Txt2Img",tts:"TTS",asmr:"ASMR",ai:"AI",highleg:"High-Leg","one-piece":"One-Piece","three-quarter":"Three-Quarter"};return n[e]?n[e]:/^\d+$/.test(e)?e:e==="3d"?"3D":e==="2d"?"2D":e.length===1?e.toUpperCase():e.charAt(0).toUpperCase()+e.slice(1)}function $(r=""){const t=String(r||"").trim().toLowerCase();return t?t.startsWith("flirty_")?"flirty":t.startsWith("action_")||t.startsWith("dynamic_")||t.startsWith("stealth_")||t.startsWith("athletic_")||t.startsWith("running_")||t.startsWith("walking_")?"action":t.startsWith("sleepy_")||t.startsWith("relaxed_")||t.startsWith("reclining_")||t.startsWith("sitting_")||t.startsWith("kneeling_")?"rest":t.startsWith("happy_")||t.startsWith("sad_")||t.startsWith("angry_")||t.startsWith("nervous_")||t.startsWith("smug_")||t.startsWith("surprised_")||t.startsWith("scared_")||t.startsWith("tipsy_")?"emotion":t.startsWith("composed_")||t.startsWith("contemplative_")||t.startsWith("looking_")?"posed":"everyday":""}function B(r=""){const t=String(r||"").trim().toLowerCase();if(!t)return"";const e=t.split("_")[0]||"";return e==="lingerie"?"lingerie":e==="swimwear"||e==="swim"?"swimwear":e==="costumes"||e==="tech"?"costumes":e==="uniform"?"uniform":e==="formal"?"formal":e==="alt"?"alt":e==="casual"||e==="street"||e==="lounge"||e==="sporty"||e==="dress"?"everyday":e||"everyday"}function G(r=""){const t=String(r||"").trim().toLowerCase();if(!t)return"";const e=t.split("_")[0]||"";return["fire","candlelight","embers"].includes(e)?"fire":["moonlight"].includes(e)?"night":["neon"].includes(e)?"neon":["studio","stage","sidelighting","dim"].includes(e)?"studio":["golden","sunbeam","dappled"].includes(e)?"natural":["lens","light"].includes(e)?"effects":e||"other"}function R(r="",t=""){const e=String(r||"").trim(),n=String(t||"").trim().toLowerCase();if(!e)return"";if(n==="outfit")return B(e)||"everyday";if(n==="pose")return $(e)||"everyday";if(n==="lighting")return G(e)||"effects";const s=e.indexOf("_");return s<=0?"":e.slice(0,s).trim()}function x(r=""){const t=String(r||"").trim();return t?t.includes(":")?t.split(":").slice(1).join(":"):t:""}function q({token:r="",name:t=""}={}){const e=String(t||"").trim()||x(r);if(!e)return"";let s=e.replace(/_(\d+)$/u,"").split("_").filter(Boolean);if(s.length===0)return e;const o=[];for(let u=0;u<s.length;u++){const m=s[u],L=s[u+1];if(m&&L&&m.toLowerCase()==="one"&&L.toLowerCase()==="piece"){o.push("one-piece"),u+=1;continue}if(m&&L&&m.toLowerCase()==="three"&&L.toLowerCase()==="quarter"){o.push("three-quarter"),u+=1;continue}o.push(m)}if(s=o,Array.from(new Set(s.map(u=>String(u).toLowerCase()))).length===1)return w(s[0]);const h=s[0],S=s.slice(1),y=w(h),_=S.map(w).join(" ").trim();return _?_.toLowerCase()===y.toLowerCase()?S.length===1&&String(S[0]).toLowerCase()===String(h).toLowerCase()?y||e:s.map(w).join(" ").trim()||e:`${y} - ${_}`:s.map(w).join(" ").trim()||e}function Y(r){if(!r)return{subcategory:"",displayName:""};const t=r.name||"",e=r.token||"",n=x(e)||t,s=R(n,r.category)||"other",o=q({token:e,name:t})||e||t||"Alias";return{subcategory:s,displayName:o}}function U(r=""){const t=String(r||"").trim();return t?t==="All"?"All":{action:"Actions",camera:"Camera",body:"Body",char:"Characters",mood:"Mood",outfit:"Outfits",pose:"Poses",prop:"Props",scene:"Scenes",weather:"Weather",style:"Style",hair:"Hair",lighting:"Lighting"}[t]||w(t):""}function V(r=""){const t=String(r||"").trim();return t?t==="All"?"All":t.split(/[_-]+/u).filter(Boolean).map(e=>w(e)).join(" ").trim():""}const v="::";function A(r){const t={};return Object.entries(r||{}).forEach(([e,n])=>{const s=String(e||"").trim();if(!s||typeof n!="string")return;const o=n.trim();o&&(t[s]=o)}),t}function E(r){const t=new Map;return Object.entries(A(r)).forEach(([e,n])=>{const s=e.toLowerCase();t.set(s,n),s.includes(v)&&t.set(s.replace(v,":"),n)}),t}function H(r,t){if(typeof r!="string"||!r.includes("$"))return r;const e=t instanceof Map?t:E(t);return e.size?r.replace(/\$([a-z0-9_:-]+)\$/gi,(n,s)=>{const o=e.get(s.toLowerCase());return typeof o=="string"?o:n}):r}function X(r,t){const e=t instanceof Map?t:E(t);if(!e.size||!r||typeof r!="object")return r;let n=!1;const s={};return Object.entries(r).forEach(([o,d])=>{if(typeof d=="string"){const h=H(d,e);s[o]=h,h!==d&&(n=!0)}else s[o]=d}),n?s:r}const F="cozygen_prompt_aliases",N="cozygen_alias_categories",M="cozygen_alias_category_list";function j(){if(typeof window>"u")return{};try{const r=window.localStorage.getItem(F);return r?JSON.parse(r)||{}:{}}catch{return{}}}function b(r){if(!(typeof window>"u"))try{window.localStorage.setItem(F,JSON.stringify(r||{}))}catch{}}function P(){if(typeof window>"u")return{};try{const r=window.localStorage.getItem(N);return r?JSON.parse(r)||{}:{}}catch{return{}}}function W(r){if(!(typeof window>"u"))try{window.localStorage.setItem(N,JSON.stringify(r||{}))}catch{}}function k(){if(typeof window>"u")return[];try{const r=window.localStorage.getItem(M);return Array.isArray(JSON.parse(r))?JSON.parse(r):[]}catch{return[]}}function O(r){if(!(typeof window>"u"))try{window.localStorage.setItem(M,JSON.stringify(r||[]))}catch{}}function Q(){const[r,t]=p.useState(()=>j()),[e,n]=p.useState(()=>P()),[s,o]=p.useState(()=>k()),[d,h]=p.useState(!1),[S,y]=p.useState(!1),[_,u]=p.useState(null),m=p.useCallback(async()=>{h(!0),u(null);try{const i=await z(),l=A((i==null?void 0:i.items)||i||{}),a=(i==null?void 0:i.categories)||{},c=Array.isArray(i==null?void 0:i.categoryList)?i.categoryList:[];t(l),n(a),o(c),b(l),W(a),O(c)}catch(i){console.error("Failed to load prompt aliases",i),u(i);const l=A(j()),a=P(),c=k();t(l),n(a),o(c)}finally{h(!1)}},[]),L=p.useCallback(async i=>{const l=(i==null?void 0:i.items)||i||{},a=(i==null?void 0:i.categories)||e||{},c=Array.isArray(i==null?void 0:i.categoryList)&&i.categoryList.length?i.categoryList:s.length?s:Array.from(new Set(Object.values(a).filter(Boolean))),f=A(l||{});y(!0),u(null);try{await J({items:f,categories:a,categoryList:c}),t(f),n(a),o(c),b(f),W(a),O(c)}catch(g){throw console.error("Failed to save prompt aliases",g),u(g),b(f),W(a),O(c),g}finally{y(!1)}},[e,s]);p.useEffect(()=>{m()},[m]);const C=p.useMemo(()=>{const i=E(r),l=new Map(i);return Object.entries(e||{}).forEach(([a,c])=>{const f=String(c||"").trim();f&&(r!=null&&r[a])&&l.set(`${f}:${a}`,r[a])}),l},[r,e]),T=p.useMemo(()=>{const i=new Set,l=[];return C.forEach((a,c)=>{let f=c.includes("::")?c.replace("::",":"):c;const g=f.split(":");g.length>=3&&g[0]&&g[1]&&g[0].toLowerCase()===g[1].toLowerCase()&&(f=[g[0],...g.slice(2)].join(":"));const I=f.toLowerCase();i.has(I)||(i.add(I),l.push(f))}),l},[C]);return{aliases:r,aliasCategories:e,categoryList:s,aliasLookup:C,aliasOptions:T,loading:d,saving:S,error:_,refreshAliases:m,persistAliases:L}}export{V as a,X as b,H as c,R as d,q as e,U as f,A as n,Y as p,Q as u};
